(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();var Gn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Eu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Fm={exports:{}},gh={};var xv;function q_(){if(xv)return gh;xv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,o,s){var a=null;if(s!==void 0&&(a=""+s),o.key!==void 0&&(a=""+o.key),"key"in o){s={};for(var u in o)u!=="key"&&(s[u]=o[u])}else s=o;return o=s.ref,{$$typeof:n,type:r,key:a,ref:o!==void 0?o:null,props:s}}return gh.Fragment=e,gh.jsx=t,gh.jsxs=t,gh}var Sv;function U_(){return Sv||(Sv=1,Fm.exports=q_()),Fm.exports}var W=U_(),zm={exports:{}},Wn={};var _v;function H_(){if(_v)return Wn;_v=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),i=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),h=Symbol.iterator;function f(B){return B===null||typeof B!="object"?null:(B=h&&B[h]||B["@@iterator"],typeof B=="function"?B:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function v(B,O,H){this.props=B,this.context=O,this.refs=b,this.updater=H||g}v.prototype.isReactComponent={},v.prototype.setState=function(B,O){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,O,"setState")},v.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function w(){}w.prototype=v.prototype;function S(B,O,H){this.props=B,this.context=O,this.refs=b,this.updater=H||g}var N=S.prototype=new w;N.constructor=S,y(N,v.prototype),N.isPureReactComponent=!0;var D=Array.isArray;function F(){}var G={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function U(B,O,H){var X=H.ref;return{$$typeof:n,type:B,key:O,ref:X!==void 0?X:null,props:H}}function q(B,O){return U(B.type,O,B.props)}function R(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function I(B){var O={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(H){return O[H]})}var T=/\/+/g;function L(B,O){return typeof B=="object"&&B!==null&&B.key!=null?I(""+B.key):O.toString(36)}function E(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(F,F):(B.status="pending",B.then(function(O){B.status==="pending"&&(B.status="fulfilled",B.value=O)},function(O){B.status==="pending"&&(B.status="rejected",B.reason=O)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function x(B,O,H,X,et){var V=typeof B;(V==="undefined"||V==="boolean")&&(B=null);var tt=!1;if(B===null)tt=!0;else switch(V){case"bigint":case"string":case"number":tt=!0;break;case"object":switch(B.$$typeof){case n:case e:tt=!0;break;case c:return tt=B._init,x(tt(B._payload),O,H,X,et)}}if(tt)return et=et(B),tt=X===""?"."+L(B,0):X,D(et)?(H="",tt!=null&&(H=tt.replace(T,"$&/")+"/"),x(et,O,H,"",function(Z){return Z})):et!=null&&(R(et)&&(et=q(et,H+(et.key==null||B&&B.key===et.key?"":(""+et.key).replace(T,"$&/")+"/")+tt)),O.push(et)),1;tt=0;var $=X===""?".":X+":";if(D(B))for(var z=0;z<B.length;z++)X=B[z],V=$+L(X,z),tt+=x(X,O,H,V,et);else if(z=f(B),typeof z=="function")for(B=z.call(B),z=0;!(X=B.next()).done;)X=X.value,V=$+L(X,z++),tt+=x(X,O,H,V,et);else if(V==="object"){if(typeof B.then=="function")return x(E(B),O,H,X,et);throw O=String(B),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return tt}function k(B,O,H){if(B==null)return B;var X=[],et=0;return x(B,X,"","",function(V){return O.call(H,V,et++)}),X}function A(B){if(B._status===-1){var O=B._result;O=O(),O.then(function(H){(B._status===0||B._status===-1)&&(B._status=1,B._result=H)},function(H){(B._status===0||B._status===-1)&&(B._status=2,B._result=H)}),B._status===-1&&(B._status=0,B._result=O)}if(B._status===1)return B._result.default;throw B._result}var C=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},j={map:k,forEach:function(B,O,H){k(B,function(){O.apply(this,arguments)},H)},count:function(B){var O=0;return k(B,function(){O++}),O},toArray:function(B){return k(B,function(O){return O})||[]},only:function(B){if(!R(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return Wn.Activity=p,Wn.Children=j,Wn.Component=v,Wn.Fragment=t,Wn.Profiler=o,Wn.PureComponent=S,Wn.StrictMode=r,Wn.Suspense=l,Wn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=G,Wn.__COMPILER_RUNTIME={__proto__:null,c:function(B){return G.H.useMemoCache(B)}},Wn.cache=function(B){return function(){return B.apply(null,arguments)}},Wn.cacheSignal=function(){return null},Wn.cloneElement=function(B,O,H){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var X=y({},B.props),et=B.key;if(O!=null)for(V in O.key!==void 0&&(et=""+O.key),O)!P.call(O,V)||V==="key"||V==="__self"||V==="__source"||V==="ref"&&O.ref===void 0||(X[V]=O[V]);var V=arguments.length-2;if(V===1)X.children=H;else if(1<V){for(var tt=Array(V),$=0;$<V;$++)tt[$]=arguments[$+2];X.children=tt}return U(B.type,et,X)},Wn.createContext=function(B){return B={$$typeof:a,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:s,_context:B},B},Wn.createElement=function(B,O,H){var X,et={},V=null;if(O!=null)for(X in O.key!==void 0&&(V=""+O.key),O)P.call(O,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(et[X]=O[X]);var tt=arguments.length-2;if(tt===1)et.children=H;else if(1<tt){for(var $=Array(tt),z=0;z<tt;z++)$[z]=arguments[z+2];et.children=$}if(B&&B.defaultProps)for(X in tt=B.defaultProps,tt)et[X]===void 0&&(et[X]=tt[X]);return U(B,V,et)},Wn.createRef=function(){return{current:null}},Wn.forwardRef=function(B){return{$$typeof:u,render:B}},Wn.isValidElement=R,Wn.lazy=function(B){return{$$typeof:c,_payload:{_status:-1,_result:B},_init:A}},Wn.memo=function(B,O){return{$$typeof:i,type:B,compare:O===void 0?null:O}},Wn.startTransition=function(B){var O=G.T,H={};G.T=H;try{var X=B(),et=G.S;et!==null&&et(H,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(F,C)}catch(V){C(V)}finally{O!==null&&H.types!==null&&(O.types=H.types),G.T=O}},Wn.unstable_useCacheRefresh=function(){return G.H.useCacheRefresh()},Wn.use=function(B){return G.H.use(B)},Wn.useActionState=function(B,O,H){return G.H.useActionState(B,O,H)},Wn.useCallback=function(B,O){return G.H.useCallback(B,O)},Wn.useContext=function(B){return G.H.useContext(B)},Wn.useDebugValue=function(){},Wn.useDeferredValue=function(B,O){return G.H.useDeferredValue(B,O)},Wn.useEffect=function(B,O){return G.H.useEffect(B,O)},Wn.useEffectEvent=function(B){return G.H.useEffectEvent(B)},Wn.useId=function(){return G.H.useId()},Wn.useImperativeHandle=function(B,O,H){return G.H.useImperativeHandle(B,O,H)},Wn.useInsertionEffect=function(B,O){return G.H.useInsertionEffect(B,O)},Wn.useLayoutEffect=function(B,O){return G.H.useLayoutEffect(B,O)},Wn.useMemo=function(B,O){return G.H.useMemo(B,O)},Wn.useOptimistic=function(B,O){return G.H.useOptimistic(B,O)},Wn.useReducer=function(B,O,H){return G.H.useReducer(B,O,H)},Wn.useRef=function(B){return G.H.useRef(B)},Wn.useState=function(B){return G.H.useState(B)},Wn.useSyncExternalStore=function(B,O,H){return G.H.useSyncExternalStore(B,O,H)},Wn.useTransition=function(){return G.H.useTransition()},Wn.version="19.2.0",Wn}var kv;function mb(){return kv||(kv=1,zm.exports=H_()),zm.exports}var jt=mb();const Ye=Eu(jt);var qm={exports:{}},bh={},Um={exports:{}},Hm={};var Av;function $_(){return Av||(Av=1,(function(n){function e(x,k){var A=x.length;x.push(k);t:for(;0<A;){var C=A-1>>>1,j=x[C];if(0<o(j,k))x[C]=k,x[A]=j,A=C;else break t}}function t(x){return x.length===0?null:x[0]}function r(x){if(x.length===0)return null;var k=x[0],A=x.pop();if(A!==k){x[0]=A;t:for(var C=0,j=x.length,B=j>>>1;C<B;){var O=2*(C+1)-1,H=x[O],X=O+1,et=x[X];if(0>o(H,A))X<j&&0>o(et,H)?(x[C]=et,x[X]=A,C=X):(x[C]=H,x[O]=A,C=O);else if(X<j&&0>o(et,A))x[C]=et,x[X]=A,C=X;else break t}}return k}function o(x,k){var A=x.sortIndex-k.sortIndex;return A!==0?A:x.id-k.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();n.unstable_now=function(){return a.now()-u}}var l=[],i=[],c=1,p=null,h=3,f=!1,g=!1,y=!1,b=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function N(x){for(var k=t(i);k!==null;){if(k.callback===null)r(i);else if(k.startTime<=x)r(i),k.sortIndex=k.expirationTime,e(l,k);else break;k=t(i)}}function D(x){if(y=!1,N(x),!g)if(t(l)!==null)g=!0,F||(F=!0,I());else{var k=t(i);k!==null&&E(D,k.startTime-x)}}var F=!1,G=-1,P=5,U=-1;function q(){return b?!0:!(n.unstable_now()-U<P)}function R(){if(b=!1,F){var x=n.unstable_now();U=x;var k=!0;try{t:{g=!1,y&&(y=!1,w(G),G=-1),f=!0;var A=h;try{e:{for(N(x),p=t(l);p!==null&&!(p.expirationTime>x&&q());){var C=p.callback;if(typeof C=="function"){p.callback=null,h=p.priorityLevel;var j=C(p.expirationTime<=x);if(x=n.unstable_now(),typeof j=="function"){p.callback=j,N(x),k=!0;break e}p===t(l)&&r(l),N(x)}else r(l);p=t(l)}if(p!==null)k=!0;else{var B=t(i);B!==null&&E(D,B.startTime-x),k=!1}}break t}finally{p=null,h=A,f=!1}k=void 0}}finally{k?I():F=!1}}}var I;if(typeof S=="function")I=function(){S(R)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,L=T.port2;T.port1.onmessage=R,I=function(){L.postMessage(null)}}else I=function(){v(R,0)};function E(x,k){G=v(function(){x(n.unstable_now())},k)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(x){x.callback=null},n.unstable_forceFrameRate=function(x){0>x||125<x?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<x?Math.floor(1e3/x):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_next=function(x){switch(h){case 1:case 2:case 3:var k=3;break;default:k=h}var A=h;h=k;try{return x()}finally{h=A}},n.unstable_requestPaint=function(){b=!0},n.unstable_runWithPriority=function(x,k){switch(x){case 1:case 2:case 3:case 4:case 5:break;default:x=3}var A=h;h=x;try{return k()}finally{h=A}},n.unstable_scheduleCallback=function(x,k,A){var C=n.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?C+A:C):A=C,x){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=A+j,x={id:c++,callback:k,priorityLevel:x,startTime:A,expirationTime:j,sortIndex:-1},A>C?(x.sortIndex=A,e(i,x),t(l)===null&&x===t(i)&&(y?(w(G),G=-1):y=!0,E(D,A-C))):(x.sortIndex=j,e(l,x),g||f||(g=!0,F||(F=!0,I()))),x},n.unstable_shouldYield=q,n.unstable_wrapCallback=function(x){var k=h;return function(){var A=h;h=k;try{return x.apply(this,arguments)}finally{h=A}}}})(Hm)),Hm}var Cv;function V_(){return Cv||(Cv=1,Um.exports=$_()),Um.exports}var $m={exports:{}},js={};var Ev;function W_(){if(Ev)return js;Ev=1;var n=mb();function e(l){var i="https://react.dev/errors/"+l;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+l+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function s(l,i,c){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:p==null?null:""+p,children:l,containerInfo:i,implementation:c}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(l,i){if(l==="font")return"";if(typeof i=="string")return i==="use-credentials"?i:""}return js.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,js.createPortal=function(l,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)throw Error(e(299));return s(l,i,null,c)},js.flushSync=function(l){var i=a.T,c=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=i,r.p=c,r.d.f()}},js.preconnect=function(l,i){typeof l=="string"&&(i?(i=i.crossOrigin,i=typeof i=="string"?i==="use-credentials"?i:"":void 0):i=null,r.d.C(l,i))},js.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},js.preinit=function(l,i){if(typeof l=="string"&&i&&typeof i.as=="string"){var c=i.as,p=u(c,i.crossOrigin),h=typeof i.integrity=="string"?i.integrity:void 0,f=typeof i.fetchPriority=="string"?i.fetchPriority:void 0;c==="style"?r.d.S(l,typeof i.precedence=="string"?i.precedence:void 0,{crossOrigin:p,integrity:h,fetchPriority:f}):c==="script"&&r.d.X(l,{crossOrigin:p,integrity:h,fetchPriority:f,nonce:typeof i.nonce=="string"?i.nonce:void 0})}},js.preinitModule=function(l,i){if(typeof l=="string")if(typeof i=="object"&&i!==null){if(i.as==null||i.as==="script"){var c=u(i.as,i.crossOrigin);r.d.M(l,{crossOrigin:c,integrity:typeof i.integrity=="string"?i.integrity:void 0,nonce:typeof i.nonce=="string"?i.nonce:void 0})}}else i==null&&r.d.M(l)},js.preload=function(l,i){if(typeof l=="string"&&typeof i=="object"&&i!==null&&typeof i.as=="string"){var c=i.as,p=u(c,i.crossOrigin);r.d.L(l,c,{crossOrigin:p,integrity:typeof i.integrity=="string"?i.integrity:void 0,nonce:typeof i.nonce=="string"?i.nonce:void 0,type:typeof i.type=="string"?i.type:void 0,fetchPriority:typeof i.fetchPriority=="string"?i.fetchPriority:void 0,referrerPolicy:typeof i.referrerPolicy=="string"?i.referrerPolicy:void 0,imageSrcSet:typeof i.imageSrcSet=="string"?i.imageSrcSet:void 0,imageSizes:typeof i.imageSizes=="string"?i.imageSizes:void 0,media:typeof i.media=="string"?i.media:void 0})}},js.preloadModule=function(l,i){if(typeof l=="string")if(i){var c=u(i.as,i.crossOrigin);r.d.m(l,{as:typeof i.as=="string"&&i.as!=="script"?i.as:void 0,crossOrigin:c,integrity:typeof i.integrity=="string"?i.integrity:void 0})}else r.d.m(l)},js.requestFormReset=function(l){r.d.r(l)},js.unstable_batchedUpdates=function(l,i){return l(i)},js.useFormState=function(l,i,c){return a.H.useFormState(l,i,c)},js.useFormStatus=function(){return a.H.useHostTransitionStatus()},js.version="19.2.0",js}var Nv;function I3(){if(Nv)return $m.exports;Nv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),$m.exports=W_(),$m.exports}var Tv;function G_(){if(Tv)return bh;Tv=1;var n=V_(),e=mb(),t=I3();function r(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function s(d){var m=d,_=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,(m.flags&4098)!==0&&(_=m.return),d=m.return;while(d)}return m.tag===3?_:null}function a(d){if(d.tag===13){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function u(d){if(d.tag===31){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function l(d){if(s(d)!==d)throw Error(r(188))}function i(d){var m=d.alternate;if(!m){if(m=s(d),m===null)throw Error(r(188));return m!==d?null:d}for(var _=d,M=m;;){var K=_.return;if(K===null)break;var J=K.alternate;if(J===null){if(M=K.return,M!==null){_=M;continue}break}if(K.child===J.child){for(J=K.child;J;){if(J===_)return l(K),d;if(J===M)return l(K),m;J=J.sibling}throw Error(r(188))}if(_.return!==M.return)_=K,M=J;else{for(var pt=!1,kt=K.child;kt;){if(kt===_){pt=!0,_=K,M=J;break}if(kt===M){pt=!0,M=K,_=J;break}kt=kt.sibling}if(!pt){for(kt=J.child;kt;){if(kt===_){pt=!0,_=J,M=K;break}if(kt===M){pt=!0,M=J,_=K;break}kt=kt.sibling}if(!pt)throw Error(r(189))}}if(_.alternate!==M)throw Error(r(190))}if(_.tag!==3)throw Error(r(188));return _.stateNode.current===_?d:m}function c(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d;for(d=d.child;d!==null;){if(m=c(d),m!==null)return m;d=d.sibling}return null}var p=Object.assign,h=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),q=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function I(d){return d===null||typeof d!="object"?null:(d=R&&d[R]||d["@@iterator"],typeof d=="function"?d:null)}var T=Symbol.for("react.client.reference");function L(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===T?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case y:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case D:return"Suspense";case F:return"SuspenseList";case U:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case g:return"Portal";case S:return d.displayName||"Context";case w:return(d._context.displayName||"Context")+".Consumer";case N:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case G:return m=d.displayName||null,m!==null?m:L(d.type)||"Memo";case P:m=d._payload,d=d._init;try{return L(d(m))}catch{}}return null}var E=Array.isArray,x=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,k=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A={pending:!1,data:null,method:null,action:null},C=[],j=-1;function B(d){return{current:d}}function O(d){0>j||(d.current=C[j],C[j]=null,j--)}function H(d,m){j++,C[j]=d.current,d.current=m}var X=B(null),et=B(null),V=B(null),tt=B(null);function $(d,m){switch(H(V,m),H(et,d),H(X,null),m.nodeType){case 9:case 11:d=(d=m.documentElement)&&(d=d.namespaceURI)?$y(d):0;break;default:if(d=m.tagName,m=m.namespaceURI)m=$y(m),d=Vy(m,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}O(X),H(X,d)}function z(){O(X),O(et),O(V)}function Z(d){d.memoizedState!==null&&H(tt,d);var m=X.current,_=Vy(m,d.type);m!==_&&(H(et,d),H(X,_))}function it(d){et.current===d&&(O(X),O(et)),tt.current===d&&(O(tt),hh._currentValue=A)}var mt,lt;function at(d){if(mt===void 0)try{throw Error()}catch(_){var m=_.stack.trim().match(/\n( *(at )?)/);mt=m&&m[1]||"",lt=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+mt+d+lt}var rt=!1;function ct(d,m){if(!d||rt)return"";rt=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var M={DetermineComponentFrameRoot:function(){try{if(m){var je=function(){throw Error()};if(Object.defineProperty(je.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(je,[])}catch(he){var oe=he}Reflect.construct(d,[],je)}else{try{je.call()}catch(he){oe=he}d.call(je.prototype)}}else{try{throw Error()}catch(he){oe=he}(je=d())&&typeof je.catch=="function"&&je.catch(function(){})}}catch(he){if(he&&oe&&typeof he.stack=="string")return[he.stack,oe.stack]}return[null,null]}};M.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var K=Object.getOwnPropertyDescriptor(M.DetermineComponentFrameRoot,"name");K&&K.configurable&&Object.defineProperty(M.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var J=M.DetermineComponentFrameRoot(),pt=J[0],kt=J[1];if(pt&&kt){var Pt=pt.split(`
`),se=kt.split(`
`);for(K=M=0;M<Pt.length&&!Pt[M].includes("DetermineComponentFrameRoot");)M++;for(;K<se.length&&!se[K].includes("DetermineComponentFrameRoot");)K++;if(M===Pt.length||K===se.length)for(M=Pt.length-1,K=se.length-1;1<=M&&0<=K&&Pt[M]!==se[K];)K--;for(;1<=M&&0<=K;M--,K--)if(Pt[M]!==se[K]){if(M!==1||K!==1)do if(M--,K--,0>K||Pt[M]!==se[K]){var ve=`
`+Pt[M].replace(" at new "," at ");return d.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",d.displayName)),ve}while(1<=M&&0<=K);break}}}finally{rt=!1,Error.prepareStackTrace=_}return(_=d?d.displayName||d.name:"")?at(_):""}function ot(d,m){switch(d.tag){case 26:case 27:case 5:return at(d.type);case 16:return at("Lazy");case 13:return d.child!==m&&m!==null?at("Suspense Fallback"):at("Suspense");case 19:return at("SuspenseList");case 0:case 15:return ct(d.type,!1);case 11:return ct(d.type.render,!1);case 1:return ct(d.type,!0);case 31:return at("Activity");default:return""}}function dt(d){try{var m="",_=null;do m+=ot(d,_),_=d,d=d.return;while(d);return m}catch(M){return`
Error generating stack: `+M.message+`
`+M.stack}}var ft=Object.prototype.hasOwnProperty,gt=n.unstable_scheduleCallback,wt=n.unstable_cancelCallback,yt=n.unstable_shouldYield,Et=n.unstable_requestPaint,Mt=n.unstable_now,qt=n.unstable_getCurrentPriorityLevel,Tt=n.unstable_ImmediatePriority,It=n.unstable_UserBlockingPriority,Vt=n.unstable_NormalPriority,Kt=n.unstable_LowPriority,ne=n.unstable_IdlePriority,ae=n.log,Oe=n.unstable_setDisableYieldValue,le=null,Jt=null;function ue(d){if(typeof ae=="function"&&Oe(d),Jt&&typeof Jt.setStrictMode=="function")try{Jt.setStrictMode(le,d)}catch{}}var ge=Math.clz32?Math.clz32:Be,fe=Math.log,qe=Math.LN2;function Be(d){return d>>>=0,d===0?32:31-(fe(d)/qe|0)|0}var ke=256,Je=262144,Fe=4194304;function Me(d){var m=d&42;if(m!==0)return m;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return d&261888;case 262144:case 524288:case 1048576:case 2097152:return d&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function Ke(d,m,_){var M=d.pendingLanes;if(M===0)return 0;var K=0,J=d.suspendedLanes,pt=d.pingedLanes;d=d.warmLanes;var kt=M&134217727;return kt!==0?(M=kt&~J,M!==0?K=Me(M):(pt&=kt,pt!==0?K=Me(pt):_||(_=kt&~d,_!==0&&(K=Me(_))))):(kt=M&~J,kt!==0?K=Me(kt):pt!==0?K=Me(pt):_||(_=M&~d,_!==0&&(K=Me(_)))),K===0?0:m!==0&&m!==K&&(m&J)===0&&(J=K&-K,_=m&-m,J>=_||J===32&&(_&4194048)!==0)?m:K}function En(d,m){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&m)===0}function Xe(d,m){switch(d){case 1:case 2:case 4:case 8:case 64:return m+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sn(){var d=Fe;return Fe<<=1,(Fe&62914560)===0&&(Fe=4194304),d}function Nn(d){for(var m=[],_=0;31>_;_++)m.push(d);return m}function Te(d,m){d.pendingLanes|=m,m!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function _n(d,m,_,M,K,J){var pt=d.pendingLanes;d.pendingLanes=_,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=_,d.entangledLanes&=_,d.errorRecoveryDisabledLanes&=_,d.shellSuspendCounter=0;var kt=d.entanglements,Pt=d.expirationTimes,se=d.hiddenUpdates;for(_=pt&~_;0<_;){var ve=31-ge(_),je=1<<ve;kt[ve]=0,Pt[ve]=-1;var oe=se[ve];if(oe!==null)for(se[ve]=null,ve=0;ve<oe.length;ve++){var he=oe[ve];he!==null&&(he.lane&=-536870913)}_&=~je}M!==0&&Pn(d,M,0),J!==0&&K===0&&d.tag!==0&&(d.suspendedLanes|=J&~(pt&~m))}function Pn(d,m,_){d.pendingLanes|=m,d.suspendedLanes&=~m;var M=31-ge(m);d.entangledLanes|=m,d.entanglements[M]=d.entanglements[M]|1073741824|_&261930}function on(d,m){var _=d.entangledLanes|=m;for(d=d.entanglements;_;){var M=31-ge(_),K=1<<M;K&m|d[M]&m&&(d[M]|=m),_&=~K}}function Dt(d,m){var _=m&-m;return _=(_&42)!==0?1:Ht(_),(_&(d.suspendedLanes|m))!==0?0:_}function Ht(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function re(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function we(){var d=k.p;return d!==0?d:(d=window.event,d===void 0?32:pv(d.type))}function nn(d,m){var _=k.p;try{return k.p=d,m()}finally{k.p=_}}var Ie=Math.random().toString(36).slice(2),Ue="__reactFiber$"+Ie,He="__reactProps$"+Ie,Ge="__reactContainer$"+Ie,Ve="__reactEvents$"+Ie,an="__reactListeners$"+Ie,kn="__reactHandles$"+Ie,qn="__reactResources$"+Ie,Qt="__reactMarker$"+Ie;function de(d){delete d[Ue],delete d[He],delete d[Ve],delete d[an],delete d[kn]}function Ee(d){var m=d[Ue];if(m)return m;for(var _=d.parentNode;_;){if(m=_[Ge]||_[Ue]){if(_=m.alternate,m.child!==null||_!==null&&_.child!==null)for(d=Qy(d);d!==null;){if(_=d[Ue])return _;d=Qy(d)}return m}d=_,_=d.parentNode}return null}function Pe(d){if(d=d[Ue]||d[Ge]){var m=d.tag;if(m===5||m===6||m===13||m===31||m===26||m===27||m===3)return d}return null}function _t(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d.stateNode;throw Error(r(33))}function Bt(d){var m=d[qn];return m||(m=d[qn]={hoistableStyles:new Map,hoistableScripts:new Map}),m}function Gt(d){d[Qt]=!0}var pe=new Set,Ne={};function ye(d,m){xe(d,m),xe(d+"Capture",m)}function xe(d,m){for(Ne[d]=m,d=0;d<m.length;d++)pe.add(m[d])}var mn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$e={},vn={};function Ze(d){return ft.call(vn,d)?!0:ft.call($e,d)?!1:mn.test(d)?vn[d]=!0:($e[d]=!0,!1)}function Tn(d,m,_){if(Ze(m))if(_===null)d.removeAttribute(m);else{switch(typeof _){case"undefined":case"function":case"symbol":d.removeAttribute(m);return;case"boolean":var M=m.toLowerCase().slice(0,5);if(M!=="data-"&&M!=="aria-"){d.removeAttribute(m);return}}d.setAttribute(m,""+_)}}function Bn(d,m,_){if(_===null)d.removeAttribute(m);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(m);return}d.setAttribute(m,""+_)}}function In(d,m,_,M){if(M===null)d.removeAttribute(_);else{switch(typeof M){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(_);return}d.setAttributeNS(m,_,""+M)}}function Qe(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function mr(d){var m=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function sr(d,m,_){var M=Object.getOwnPropertyDescriptor(d.constructor.prototype,m);if(!d.hasOwnProperty(m)&&typeof M<"u"&&typeof M.get=="function"&&typeof M.set=="function"){var K=M.get,J=M.set;return Object.defineProperty(d,m,{configurable:!0,get:function(){return K.call(this)},set:function(pt){_=""+pt,J.call(this,pt)}}),Object.defineProperty(d,m,{enumerable:M.enumerable}),{getValue:function(){return _},setValue:function(pt){_=""+pt},stopTracking:function(){d._valueTracker=null,delete d[m]}}}}function Dr(d){if(!d._valueTracker){var m=mr(d)?"checked":"value";d._valueTracker=sr(d,m,""+d[m])}}function xi(d){if(!d)return!1;var m=d._valueTracker;if(!m)return!0;var _=m.getValue(),M="";return d&&(M=mr(d)?d.checked?"true":"false":d.value),d=M,d!==_?(m.setValue(d),!0):!1}function ir(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var yr=/[\n"\\]/g;function ur(d){return d.replace(yr,function(m){return"\\"+m.charCodeAt(0).toString(16)+" "})}function Un(d,m,_,M,K,J,pt,kt){d.name="",pt!=null&&typeof pt!="function"&&typeof pt!="symbol"&&typeof pt!="boolean"?d.type=pt:d.removeAttribute("type"),m!=null?pt==="number"?(m===0&&d.value===""||d.value!=m)&&(d.value=""+Qe(m)):d.value!==""+Qe(m)&&(d.value=""+Qe(m)):pt!=="submit"&&pt!=="reset"||d.removeAttribute("value"),m!=null?ar(d,pt,Qe(m)):_!=null?ar(d,pt,Qe(_)):M!=null&&d.removeAttribute("value"),K==null&&J!=null&&(d.defaultChecked=!!J),K!=null&&(d.checked=K&&typeof K!="function"&&typeof K!="symbol"),kt!=null&&typeof kt!="function"&&typeof kt!="symbol"&&typeof kt!="boolean"?d.name=""+Qe(kt):d.removeAttribute("name")}function tn(d,m,_,M,K,J,pt,kt){if(J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"&&(d.type=J),m!=null||_!=null){if(!(J!=="submit"&&J!=="reset"||m!=null)){Dr(d);return}_=_!=null?""+Qe(_):"",m=m!=null?""+Qe(m):_,kt||m===d.value||(d.value=m),d.defaultValue=m}M=M??K,M=typeof M!="function"&&typeof M!="symbol"&&!!M,d.checked=kt?d.checked:!!M,d.defaultChecked=!!M,pt!=null&&typeof pt!="function"&&typeof pt!="symbol"&&typeof pt!="boolean"&&(d.name=pt),Dr(d)}function ar(d,m,_){m==="number"&&ir(d.ownerDocument)===d||d.defaultValue===""+_||(d.defaultValue=""+_)}function tr(d,m,_,M){if(d=d.options,m){m={};for(var K=0;K<_.length;K++)m["$"+_[K]]=!0;for(_=0;_<d.length;_++)K=m.hasOwnProperty("$"+d[_].value),d[_].selected!==K&&(d[_].selected=K),K&&M&&(d[_].defaultSelected=!0)}else{for(_=""+Qe(_),m=null,K=0;K<d.length;K++){if(d[K].value===_){d[K].selected=!0,M&&(d[K].defaultSelected=!0);return}m!==null||d[K].disabled||(m=d[K])}m!==null&&(m.selected=!0)}}function Ur(d,m,_){if(m!=null&&(m=""+Qe(m),m!==d.value&&(d.value=m),_==null)){d.defaultValue!==m&&(d.defaultValue=m);return}d.defaultValue=_!=null?""+Qe(_):""}function Kn(d,m,_,M){if(m==null){if(M!=null){if(_!=null)throw Error(r(92));if(E(M)){if(1<M.length)throw Error(r(93));M=M[0]}_=M}_==null&&(_=""),m=_}_=Qe(m),d.defaultValue=_,M=d.textContent,M===_&&M!==""&&M!==null&&(d.value=M),Dr(d)}function Zn(d,m){if(m){var _=d.firstChild;if(_&&_===d.lastChild&&_.nodeType===3){_.nodeValue=m;return}}d.textContent=m}var cr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ri(d,m,_){var M=m.indexOf("--")===0;_==null||typeof _=="boolean"||_===""?M?d.setProperty(m,""):m==="float"?d.cssFloat="":d[m]="":M?d.setProperty(m,_):typeof _!="number"||_===0||cr.has(m)?m==="float"?d.cssFloat=_:d[m]=(""+_).trim():d[m]=_+"px"}function or(d,m,_){if(m!=null&&typeof m!="object")throw Error(r(62));if(d=d.style,_!=null){for(var M in _)!_.hasOwnProperty(M)||m!=null&&m.hasOwnProperty(M)||(M.indexOf("--")===0?d.setProperty(M,""):M==="float"?d.cssFloat="":d[M]="");for(var K in m)M=m[K],m.hasOwnProperty(K)&&_[K]!==M&&ri(d,K,M)}else for(var J in m)m.hasOwnProperty(J)&&ri(d,J,m[J])}function Mr(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Br(d){return Hr.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}function hi(){}var Lr=null;function ns(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var fs=null,fn=null;function vs(d){var m=Pe(d);if(m&&(d=m.stateNode)){var _=d[He]||null;t:switch(d=m.stateNode,m.type){case"input":if(Un(d,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name),m=_.name,_.type==="radio"&&m!=null){for(_=d;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll('input[name="'+ur(""+m)+'"][type="radio"]'),m=0;m<_.length;m++){var M=_[m];if(M!==d&&M.form===d.form){var K=M[He]||null;if(!K)throw Error(r(90));Un(M,K.value,K.defaultValue,K.defaultValue,K.checked,K.defaultChecked,K.type,K.name)}}for(m=0;m<_.length;m++)M=_[m],M.form===d.form&&xi(M)}break t;case"textarea":Ur(d,_.value,_.defaultValue);break t;case"select":m=_.value,m!=null&&tr(d,!!_.multiple,m,!1)}}}var Xs=!1;function No(d,m,_){if(Xs)return d(m,_);Xs=!0;try{var M=d(m);return M}finally{if(Xs=!1,(fs!==null||fn!==null)&&(Bd(),fs&&(m=fs,d=fn,fn=fs=null,vs(m),d)))for(m=0;m<d.length;m++)vs(d[m])}}function Yi(d,m){var _=d.stateNode;if(_===null)return null;var M=_[He]||null;if(M===null)return null;_=M[m];t:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(M=!M.disabled)||(d=d.type,M=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!M;break t;default:d=!1}if(d)return null;if(_&&typeof _!="function")throw Error(r(231,m,typeof _));return _}var di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ta=!1;if(di)try{var Xi={};Object.defineProperty(Xi,"passive",{get:function(){Ta=!0}}),window.addEventListener("test",Xi,Xi),window.removeEventListener("test",Xi,Xi)}catch{Ta=!1}var Ki=null,Fs=null,Es=null;function To(){if(Es)return Es;var d,m=Fs,_=m.length,M,K="value"in Ki?Ki.value:Ki.textContent,J=K.length;for(d=0;d<_&&m[d]===K[d];d++);var pt=_-d;for(M=1;M<=pt&&m[_-M]===K[J-M];M++);return Es=K.slice(d,1<M?1-M:void 0)}function ut(d){var m=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&m===13&&(d=13)):d=m,d===10&&(d=13),32<=d||d===13?d:0}function At(){return!0}function Ft(){return!1}function ce(d){function m(_,M,K,J,pt){this._reactName=_,this._targetInst=K,this.type=M,this.nativeEvent=J,this.target=pt,this.currentTarget=null;for(var kt in d)d.hasOwnProperty(kt)&&(_=d[kt],this[kt]=_?_(J):J[kt]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?At:Ft,this.isPropagationStopped=Ft,this}return p(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=At)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=At)},persist:function(){},isPersistent:At}),m}var An={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},en=ce(An),Hn=p({},An,{view:0,detail:0}),Qn=ce(Hn),qr,Jn,Xr,Si=p({},Hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dn,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Xr&&(Xr&&d.type==="mousemove"?(qr=d.screenX-Xr.screenX,Jn=d.screenY-Xr.screenY):Jn=qr=0,Xr=d),qr)},movementY:function(d){return"movementY"in d?d.movementY:Jn}}),ii=ce(Si),Kr=p({},Si,{dataTransfer:0}),$r=ce(Kr),zs=p({},Hn,{relatedTarget:0}),qi=ce(zs),Ks=p({},An,{animationName:0,elapsedTime:0,pseudoElement:0}),nt=ce(Ks),bt=p({},An,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),Lt=ce(bt),zt=p({},An,{data:0}),Yt=ce(zt),Se={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Re={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},un={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(d){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(d):(d=un[d])?!!m[d]:!1}function Dn(){return gn}var $n=p({},Hn,{key:function(d){if(d.key){var m=Se[d.key]||d.key;if(m!=="Unidentified")return m}return d.type==="keypress"?(d=ut(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Re[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dn,charCode:function(d){return d.type==="keypress"?ut(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?ut(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),vr=ce($n),pi=p({},Si,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ni=ce(pi),Zr=p({},Hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dn}),Ui=ce(Zr),Oi=p({},An,{propertyName:0,elapsedTime:0,pseudoElement:0}),rs=ce(Oi),Ka=p({},Si,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),ma=ce(Ka),Za=p({},An,{newState:0,oldState:0}),Mu=ce(Za),zl=[9,13,27,32],ja=di&&"CompositionEvent"in window,ga=null;di&&"documentMode"in document&&(ga=document.documentMode);var il=di&&"TextEvent"in window&&!ga,Qa=di&&(!ja||ga&&8<ga&&11>=ga),Zi=" ",jo=!1;function Mo(d,m){switch(d){case"keyup":return zl.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ql(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Ma=!1;function ws(d,m){switch(d){case"compositionend":return ql(m);case"keypress":return m.which!==32?null:(jo=!0,Zi);case"textInput":return d=m.data,d===Zi&&jo?null:d;default:return null}}function Ja(d,m){if(Ma)return d==="compositionend"||!ja&&Mo(d,m)?(d=To(),Es=Fs=Ki=null,Ma=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Qa&&m.locale!=="ko"?null:m.data;default:return null}}var Ul={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lu(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m==="input"?!!Ul[d.type]:m==="textarea"}function qs(d,m,_,M){fs?fn?fn.push(M):fn=[M]:fs=M,m=$d(m,"onChange"),0<m.length&&(_=new en("onChange","change",null,_,M),d.push({event:_,listeners:m}))}var ba=null,to=null;function Ou(d){Py(d,0)}function ya(d){var m=_t(d);if(xi(m))return d}function Lo(d,m){if(d==="change")return m}var Ns=!1;if(di){var xs;if(di){var La="oninput"in document;if(!La){var Oa=document.createElement("div");Oa.setAttribute("oninput","return;"),La=typeof Oa.oninput=="function"}xs=La}else xs=!1;Ns=xs&&(!document.documentMode||9<document.documentMode)}function eo(){ba&&(ba.detachEvent("onpropertychange",Hl),to=ba=null)}function Hl(d){if(d.propertyName==="value"&&ya(to)){var m=[];qs(m,to,d,ns(d)),No(Ou,m)}}function $l(d,m,_){d==="focusin"?(eo(),ba=m,to=_,ba.attachEvent("onpropertychange",Hl)):d==="focusout"&&eo()}function Ti(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return ya(to)}function wc(d,m){if(d==="click")return ya(m)}function Ra(d,m){if(d==="input"||d==="change")return ya(m)}function Ia(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var is=typeof Object.is=="function"?Object.is:Ia;function no(d,m){if(is(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var _=Object.keys(d),M=Object.keys(m);if(_.length!==M.length)return!1;for(M=0;M<_.length;M++){var K=_[M];if(!ft.call(m,K)||!is(d[K],m[K]))return!1}return!0}function Vl(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Wl(d,m){var _=Vl(d);d=0;for(var M;_;){if(_.nodeType===3){if(M=d+_.textContent.length,d<=m&&M>=m)return{node:_,offset:m-d};d=M}t:{for(;_;){if(_.nextSibling){_=_.nextSibling;break t}_=_.parentNode}_=void 0}_=Vl(_)}}function ro(d,m){return d&&m?d===m?!0:d&&d.nodeType===3?!1:m&&m.nodeType===3?ro(d,m.parentNode):"contains"in d?d.contains(m):d.compareDocumentPosition?!!(d.compareDocumentPosition(m)&16):!1:!1}function io(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var m=ir(d.document);m instanceof d.HTMLIFrameElement;){try{var _=typeof m.contentWindow.location.href=="string"}catch{_=!1}if(_)d=m.contentWindow;else break;m=ir(d.document)}return m}function Da(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m&&(m==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||m==="textarea"||d.contentEditable==="true")}var sl=di&&"documentMode"in document&&11>=document.documentMode,Us=null,so=null,hs=null,Zs=!1;function Nr(d,m,_){var M=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;Zs||Us==null||Us!==ir(M)||(M=Us,"selectionStart"in M&&Da(M)?M={start:M.selectionStart,end:M.selectionEnd}:(M=(M.ownerDocument&&M.ownerDocument.defaultView||window).getSelection(),M={anchorNode:M.anchorNode,anchorOffset:M.anchorOffset,focusNode:M.focusNode,focusOffset:M.focusOffset}),hs&&no(hs,M)||(hs=M,M=$d(so,"onSelect"),0<M.length&&(m=new en("onSelect","select",null,m,_),d.push({event:m,listeners:M}),m.target=Us)))}function wr(d,m){var _={};return _[d.toLowerCase()]=m.toLowerCase(),_["Webkit"+d]="webkit"+m,_["Moz"+d]="moz"+m,_}var Qr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionrun:wr("Transition","TransitionRun"),transitionstart:wr("Transition","TransitionStart"),transitioncancel:wr("Transition","TransitionCancel"),transitionend:wr("Transition","TransitionEnd")},ji={},Ba={};di&&(Ba=document.createElement("div").style,"AnimationEvent"in window||(delete Qr.animationend.animation,delete Qr.animationiteration.animation,delete Qr.animationstart.animation),"TransitionEvent"in window||delete Qr.transitionend.transition);function va(d){if(ji[d])return ji[d];if(!Qr[d])return d;var m=Qr[d],_;for(_ in m)if(m.hasOwnProperty(_)&&_ in Ba)return ji[d]=m[_];return d}var al=va("animationend"),Ru=va("animationiteration"),If=va("animationstart"),dd=va("transitionrun"),pd=va("transitionstart"),md=va("transitioncancel"),Df=va("transitionend"),Bf=new Map,ol="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ol.push("scrollEnd");function Qs(d,m){Bf.set(d,m),ye(m,[d])}var Iu=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var m=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(m))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)},Hs=[],ll=0,xc=0;function Du(){for(var d=ll,m=xc=ll=0;m<d;){var _=Hs[m];Hs[m++]=null;var M=Hs[m];Hs[m++]=null;var K=Hs[m];Hs[m++]=null;var J=Hs[m];if(Hs[m++]=null,M!==null&&K!==null){var pt=M.pending;pt===null?K.next=K:(K.next=pt.next,pt.next=K),M.pending=K}J!==0&&Pu(_,K,J)}}function Bu(d,m,_,M){Hs[ll++]=d,Hs[ll++]=m,Hs[ll++]=_,Hs[ll++]=M,xc|=M,d.lanes|=M,d=d.alternate,d!==null&&(d.lanes|=M)}function Sc(d,m,_,M){return Bu(d,m,_,M),ds(d)}function ao(d,m){return Bu(d,null,null,m),ds(d)}function Pu(d,m,_){d.lanes|=_;var M=d.alternate;M!==null&&(M.lanes|=_);for(var K=!1,J=d.return;J!==null;)J.childLanes|=_,M=J.alternate,M!==null&&(M.childLanes|=_),J.tag===22&&(d=J.stateNode,d===null||d._visibility&1||(K=!0)),d=J,J=J.return;return d.tag===3?(J=d.stateNode,K&&m!==null&&(K=31-ge(_),d=J.hiddenUpdates,M=d[K],M===null?d[K]=[m]:M.push(m),m.lane=_|536870912),J):null}function ds(d){if(50<sh)throw sh=0,um=null,Error(r(185));for(var m=d.return;m!==null;)d=m,m=d.return;return d.tag===3?d.stateNode:null}var ss={};function _c(d,m,_,M){this.tag=d,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ps(d,m,_,M){return new _c(d,m,_,M)}function kc(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Js(d,m){var _=d.alternate;return _===null?(_=ps(d.tag,m,d.key,d.mode),_.elementType=d.elementType,_.type=d.type,_.stateNode=d.stateNode,_.alternate=d,d.alternate=_):(_.pendingProps=m,_.type=d.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=d.flags&65011712,_.childLanes=d.childLanes,_.lanes=d.lanes,_.child=d.child,_.memoizedProps=d.memoizedProps,_.memoizedState=d.memoizedState,_.updateQueue=d.updateQueue,m=d.dependencies,_.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},_.sibling=d.sibling,_.index=d.index,_.ref=d.ref,_.refCleanup=d.refCleanup,_}function Fu(d,m){d.flags&=65011714;var _=d.alternate;return _===null?(d.childLanes=0,d.lanes=m,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=_.childLanes,d.lanes=_.lanes,d.child=_.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=_.memoizedProps,d.memoizedState=_.memoizedState,d.updateQueue=_.updateQueue,d.type=_.type,m=_.dependencies,d.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),d}function Gl(d,m,_,M,K,J){var pt=0;if(M=d,typeof d=="function")kc(d)&&(pt=1);else if(typeof d=="string")pt=T_(d,_,X.current)?26:d==="html"||d==="head"||d==="body"?27:5;else t:switch(d){case U:return d=ps(31,_,m,K),d.elementType=U,d.lanes=J,d;case y:return Oo(_.children,K,J,m);case b:pt=8,K|=24;break;case v:return d=ps(12,_,m,K|2),d.elementType=v,d.lanes=J,d;case D:return d=ps(13,_,m,K),d.elementType=D,d.lanes=J,d;case F:return d=ps(19,_,m,K),d.elementType=F,d.lanes=J,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case S:pt=10;break t;case w:pt=9;break t;case N:pt=11;break t;case G:pt=14;break t;case P:pt=16,M=null;break t}pt=29,_=Error(r(130,d===null?"null":typeof d,"")),M=null}return m=ps(pt,_,m,K),m.elementType=d,m.type=M,m.lanes=J,m}function Oo(d,m,_,M){return d=ps(7,d,M,m),d.lanes=_,d}function zu(d,m,_){return d=ps(6,d,null,m),d.lanes=_,d}function Ac(d){var m=ps(18,null,null,0);return m.stateNode=d,m}function Yl(d,m,_){return m=ps(4,d.children!==null?d.children:[],d.key,m),m.lanes=_,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}var Cc=new WeakMap;function ta(d,m){if(typeof d=="object"&&d!==null){var _=Cc.get(d);return _!==void 0?_:(m={value:d,source:m,stack:dt(m)},Cc.set(d,m),m)}return{value:d,source:m,stack:dt(m)}}var Xl=[],ul=0,Ec=null,qu=0,ea=[],na=0,Ro=null,ra=1,ia="";function $s(d,m){Xl[ul++]=qu,Xl[ul++]=Ec,Ec=d,qu=m}function gd(d,m,_){ea[na++]=ra,ea[na++]=ia,ea[na++]=Ro,Ro=d;var M=ra;d=ia;var K=32-ge(M)-1;M&=~(1<<K),_+=1;var J=32-ge(m)+K;if(30<J){var pt=K-K%5;J=(M&(1<<pt)-1).toString(32),M>>=pt,K-=pt,ra=1<<32-ge(m)+K|_<<K|M,ia=J+d}else ra=1<<J|_<<K|M,ia=d}function Pf(d){d.return!==null&&($s(d,1),gd(d,1,0))}function Nc(d){for(;d===Ec;)Ec=Xl[--ul],Xl[ul]=null,qu=Xl[--ul],Xl[ul]=null;for(;d===Ro;)Ro=ea[--na],ea[na]=null,ia=ea[--na],ea[na]=null,ra=ea[--na],ea[na]=null}function bd(d,m){ea[na++]=ra,ea[na++]=ia,ea[na++]=Ro,ra=m.id,ia=m.overflow,Ro=d}var as=null,si=null,fr=!1,Ss=null,_i=!1,wa=Error(r(519));function Io(d){var m=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kl(ta(m,d)),wa}function Ff(d){var m=d.stateNode,_=d.type,M=d.memoizedProps;switch(m[Ue]=d,m[He]=M,_){case"dialog":dr("cancel",m),dr("close",m);break;case"iframe":case"object":case"embed":dr("load",m);break;case"video":case"audio":for(_=0;_<oh.length;_++)dr(oh[_],m);break;case"source":dr("error",m);break;case"img":case"image":case"link":dr("error",m),dr("load",m);break;case"details":dr("toggle",m);break;case"input":dr("invalid",m),tn(m,M.value,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name,!0);break;case"select":dr("invalid",m);break;case"textarea":dr("invalid",m),Kn(m,M.value,M.defaultValue,M.children)}_=M.children,typeof _!="string"&&typeof _!="number"&&typeof _!="bigint"||m.textContent===""+_||M.suppressHydrationWarning===!0||Uy(m.textContent,_)?(M.popover!=null&&(dr("beforetoggle",m),dr("toggle",m)),M.onScroll!=null&&dr("scroll",m),M.onScrollEnd!=null&&dr("scrollend",m),M.onClick!=null&&(m.onclick=hi),m=!0):m=!1,m||Io(d,!0)}function oo(d){for(as=d.return;as;)switch(as.tag){case 5:case 31:case 13:_i=!1;return;case 27:case 3:_i=!0;return;default:as=as.return}}function os(d){if(d!==as)return!1;if(!fr)return oo(d),fr=!0,!1;var m=d.tag,_;if((_=m!==3&&m!==27)&&((_=m===5)&&(_=d.type,_=!(_!=="form"&&_!=="button")||km(d.type,d.memoizedProps)),_=!_),_&&si&&Io(d),oo(d),m===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));si=Zy(d)}else if(m===31){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));si=Zy(d)}else m===27?(m=si,cu(d.type)?(d=Tm,Tm=null,si=d):si=m):si=as?qa(d.stateNode.nextSibling):null;return!0}function cl(){si=as=null,fr=!1}function zf(){var d=Ss;return d!==null&&(ca===null?ca=d:ca.push.apply(ca,d),Ss=null),d}function Kl(d){Ss===null?Ss=[d]:Ss.push(d)}var Tc=B(null),Do=null,Pa=null;function Bo(d,m,_){H(Tc,m._currentValue),m._currentValue=_}function sa(d){d._currentValue=Tc.current,O(Tc)}function Zl(d,m,_){for(;d!==null;){var M=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,M!==null&&(M.childLanes|=m)):M!==null&&(M.childLanes&m)!==m&&(M.childLanes|=m),d===_)break;d=d.return}}function fl(d,m,_,M){var K=d.child;for(K!==null&&(K.return=d);K!==null;){var J=K.dependencies;if(J!==null){var pt=K.child;J=J.firstContext;t:for(;J!==null;){var kt=J;J=K;for(var Pt=0;Pt<m.length;Pt++)if(kt.context===m[Pt]){J.lanes|=_,kt=J.alternate,kt!==null&&(kt.lanes|=_),Zl(J.return,_,d),M||(pt=null);break t}J=kt.next}}else if(K.tag===18){if(pt=K.return,pt===null)throw Error(r(341));pt.lanes|=_,J=pt.alternate,J!==null&&(J.lanes|=_),Zl(pt,_,d),pt=null}else pt=K.child;if(pt!==null)pt.return=K;else for(pt=K;pt!==null;){if(pt===d){pt=null;break}if(K=pt.sibling,K!==null){K.return=pt.return,pt=K;break}pt=pt.return}K=pt}}function Po(d,m,_,M){d=null;for(var K=m,J=!1;K!==null;){if(!J){if((K.flags&524288)!==0)J=!0;else if((K.flags&262144)!==0)break}if(K.tag===10){var pt=K.alternate;if(pt===null)throw Error(r(387));if(pt=pt.memoizedProps,pt!==null){var kt=K.type;is(K.pendingProps.value,pt.value)||(d!==null?d.push(kt):d=[kt])}}else if(K===tt.current){if(pt=K.alternate,pt===null)throw Error(r(387));pt.memoizedState.memoizedState!==K.memoizedState.memoizedState&&(d!==null?d.push(hh):d=[hh])}K=K.return}d!==null&&fl(m,d,_,M),m.flags|=262144}function jc(d){for(d=d.firstContext;d!==null;){if(!is(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function Fo(d){Do=d,Pa=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function ls(d){return yd(Do,d)}function Mc(d,m){return Do===null&&Fo(d),yd(d,m)}function yd(d,m){var _=m._currentValue;if(m={context:m,memoizedValue:_,next:null},Pa===null){if(d===null)throw Error(r(308));Pa=m,d.dependencies={lanes:0,firstContext:m},d.flags|=524288}else Pa=Pa.next=m;return _}var N0=typeof AbortController<"u"?AbortController:function(){var d=[],m=this.signal={aborted:!1,addEventListener:function(_,M){d.push(M)}};this.abort=function(){m.aborted=!0,d.forEach(function(_){return _()})}},T0=n.unstable_scheduleCallback,j0=n.unstable_NormalPriority,Mi={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ql(){return{controller:new N0,data:new Map,refCount:0}}function Uu(d){d.refCount--,d.refCount===0&&T0(j0,function(){d.controller.abort()})}var Hu=null,Lc=0,Y=0,Q=null;function st(d,m){if(Hu===null){var _=Hu=[];Lc=0,Y=mm(),Q={status:"pending",value:void 0,then:function(M){_.push(M)}}}return Lc++,m.then(ht,ht),m}function ht(){if(--Lc===0&&Hu!==null){Q!==null&&(Q.status="fulfilled");var d=Hu;Hu=null,Y=0,Q=null;for(var m=0;m<d.length;m++)(0,d[m])()}}function vt(d,m){var _=[],M={status:"pending",value:null,reason:null,then:function(K){_.push(K)}};return d.then(function(){M.status="fulfilled",M.value=m;for(var K=0;K<_.length;K++)(0,_[K])(m)},function(K){for(M.status="rejected",M.reason=K,K=0;K<_.length;K++)(0,_[K])(void 0)}),M}var xt=x.S;x.S=function(d,m){hy=Mt(),typeof m=="object"&&m!==null&&typeof m.then=="function"&&st(d,m),xt!==null&&xt(d,m)};var St=B(null);function Ct(){var d=St.current;return d!==null?d:oi.pooledCache}function Nt(d,m){m===null?H(St,St.current):H(St,m.pool)}function Rt(){var d=Ct();return d===null?null:{parent:Mi._currentValue,pool:d}}var Ut=Error(r(460)),ee=Error(r(474)),Ot=Error(r(542)),Wt={then:function(){}};function Zt(d){return d=d.status,d==="fulfilled"||d==="rejected"}function be(d,m,_){switch(_=d[_],_===void 0?d.push(m):_!==m&&(m.then(hi,hi),m=_),m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,De(d),d;default:if(typeof m.status=="string")m.then(hi,hi);else{if(d=oi,d!==null&&100<d.shellSuspendCounter)throw Error(r(482));d=m,d.status="pending",d.then(function(M){if(m.status==="pending"){var K=m;K.status="fulfilled",K.value=M}},function(M){if(m.status==="pending"){var K=m;K.status="rejected",K.reason=M}})}switch(m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,De(d),d}throw me=m,Ut}}function te(d){try{var m=d._init;return m(d._payload)}catch(_){throw _!==null&&typeof _=="object"&&typeof _.then=="function"?(me=_,Ut):_}}var me=null;function _e(){if(me===null)throw Error(r(459));var d=me;return me=null,d}function De(d){if(d===Ut||d===Ot)throw Error(r(483))}var Le=null,hn=0;function rn(d){var m=hn;return hn+=1,Le===null&&(Le=[]),be(Le,d,m)}function Fn(d,m){m=m.props.ref,d.ref=m!==void 0?m:null}function ln(d,m){throw m.$$typeof===h?Error(r(525)):(d=Object.prototype.toString.call(m),Error(r(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d)))}function lr(d){function m(Xt,$t){if(d){var ie=Xt.deletions;ie===null?(Xt.deletions=[$t],Xt.flags|=16):ie.push($t)}}function _(Xt,$t){if(!d)return null;for(;$t!==null;)m(Xt,$t),$t=$t.sibling;return null}function M(Xt){for(var $t=new Map;Xt!==null;)Xt.key!==null?$t.set(Xt.key,Xt):$t.set(Xt.index,Xt),Xt=Xt.sibling;return $t}function K(Xt,$t){return Xt=Js(Xt,$t),Xt.index=0,Xt.sibling=null,Xt}function J(Xt,$t,ie){return Xt.index=ie,d?(ie=Xt.alternate,ie!==null?(ie=ie.index,ie<$t?(Xt.flags|=67108866,$t):ie):(Xt.flags|=67108866,$t)):(Xt.flags|=1048576,$t)}function pt(Xt){return d&&Xt.alternate===null&&(Xt.flags|=67108866),Xt}function kt(Xt,$t,ie,Ae){return $t===null||$t.tag!==6?($t=zu(ie,Xt.mode,Ae),$t.return=Xt,$t):($t=K($t,ie),$t.return=Xt,$t)}function Pt(Xt,$t,ie,Ae){var Mn=ie.type;return Mn===y?ve(Xt,$t,ie.props.children,Ae,ie.key):$t!==null&&($t.elementType===Mn||typeof Mn=="object"&&Mn!==null&&Mn.$$typeof===P&&te(Mn)===$t.type)?($t=K($t,ie.props),Fn($t,ie),$t.return=Xt,$t):($t=Gl(ie.type,ie.key,ie.props,null,Xt.mode,Ae),Fn($t,ie),$t.return=Xt,$t)}function se(Xt,$t,ie,Ae){return $t===null||$t.tag!==4||$t.stateNode.containerInfo!==ie.containerInfo||$t.stateNode.implementation!==ie.implementation?($t=Yl(ie,Xt.mode,Ae),$t.return=Xt,$t):($t=K($t,ie.children||[]),$t.return=Xt,$t)}function ve(Xt,$t,ie,Ae,Mn){return $t===null||$t.tag!==7?($t=Oo(ie,Xt.mode,Ae,Mn),$t.return=Xt,$t):($t=K($t,ie),$t.return=Xt,$t)}function je(Xt,$t,ie){if(typeof $t=="string"&&$t!==""||typeof $t=="number"||typeof $t=="bigint")return $t=zu(""+$t,Xt.mode,ie),$t.return=Xt,$t;if(typeof $t=="object"&&$t!==null){switch($t.$$typeof){case f:return ie=Gl($t.type,$t.key,$t.props,null,Xt.mode,ie),Fn(ie,$t),ie.return=Xt,ie;case g:return $t=Yl($t,Xt.mode,ie),$t.return=Xt,$t;case P:return $t=te($t),je(Xt,$t,ie)}if(E($t)||I($t))return $t=Oo($t,Xt.mode,ie,null),$t.return=Xt,$t;if(typeof $t.then=="function")return je(Xt,rn($t),ie);if($t.$$typeof===S)return je(Xt,Mc(Xt,$t),ie);ln(Xt,$t)}return null}function oe(Xt,$t,ie,Ae){var Mn=$t!==null?$t.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Mn!==null?null:kt(Xt,$t,""+ie,Ae);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case f:return ie.key===Mn?Pt(Xt,$t,ie,Ae):null;case g:return ie.key===Mn?se(Xt,$t,ie,Ae):null;case P:return ie=te(ie),oe(Xt,$t,ie,Ae)}if(E(ie)||I(ie))return Mn!==null?null:ve(Xt,$t,ie,Ae,null);if(typeof ie.then=="function")return oe(Xt,$t,rn(ie),Ae);if(ie.$$typeof===S)return oe(Xt,$t,Mc(Xt,ie),Ae);ln(Xt,ie)}return null}function he(Xt,$t,ie,Ae,Mn){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return Xt=Xt.get(ie)||null,kt($t,Xt,""+Ae,Mn);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case f:return Xt=Xt.get(Ae.key===null?ie:Ae.key)||null,Pt($t,Xt,Ae,Mn);case g:return Xt=Xt.get(Ae.key===null?ie:Ae.key)||null,se($t,Xt,Ae,Mn);case P:return Ae=te(Ae),he(Xt,$t,ie,Ae,Mn)}if(E(Ae)||I(Ae))return Xt=Xt.get(ie)||null,ve($t,Xt,Ae,Mn,null);if(typeof Ae.then=="function")return he(Xt,$t,ie,rn(Ae),Mn);if(Ae.$$typeof===S)return he(Xt,$t,ie,Mc($t,Ae),Mn);ln($t,Ae)}return null}function cn(Xt,$t,ie,Ae){for(var Mn=null,Or=null,bn=$t,er=$t=0,br=null;bn!==null&&er<ie.length;er++){bn.index>er?(br=bn,bn=null):br=bn.sibling;var Rr=oe(Xt,bn,ie[er],Ae);if(Rr===null){bn===null&&(bn=br);break}d&&bn&&Rr.alternate===null&&m(Xt,bn),$t=J(Rr,$t,er),Or===null?Mn=Rr:Or.sibling=Rr,Or=Rr,bn=br}if(er===ie.length)return _(Xt,bn),fr&&$s(Xt,er),Mn;if(bn===null){for(;er<ie.length;er++)bn=je(Xt,ie[er],Ae),bn!==null&&($t=J(bn,$t,er),Or===null?Mn=bn:Or.sibling=bn,Or=bn);return fr&&$s(Xt,er),Mn}for(bn=M(bn);er<ie.length;er++)br=he(bn,Xt,er,ie[er],Ae),br!==null&&(d&&br.alternate!==null&&bn.delete(br.key===null?er:br.key),$t=J(br,$t,er),Or===null?Mn=br:Or.sibling=br,Or=br);return d&&bn.forEach(function(mu){return m(Xt,mu)}),fr&&$s(Xt,er),Mn}function Rn(Xt,$t,ie,Ae){if(ie==null)throw Error(r(151));for(var Mn=null,Or=null,bn=$t,er=$t=0,br=null,Rr=ie.next();bn!==null&&!Rr.done;er++,Rr=ie.next()){bn.index>er?(br=bn,bn=null):br=bn.sibling;var mu=oe(Xt,bn,Rr.value,Ae);if(mu===null){bn===null&&(bn=br);break}d&&bn&&mu.alternate===null&&m(Xt,bn),$t=J(mu,$t,er),Or===null?Mn=mu:Or.sibling=mu,Or=mu,bn=br}if(Rr.done)return _(Xt,bn),fr&&$s(Xt,er),Mn;if(bn===null){for(;!Rr.done;er++,Rr=ie.next())Rr=je(Xt,Rr.value,Ae),Rr!==null&&($t=J(Rr,$t,er),Or===null?Mn=Rr:Or.sibling=Rr,Or=Rr);return fr&&$s(Xt,er),Mn}for(bn=M(bn);!Rr.done;er++,Rr=ie.next())Rr=he(bn,Xt,er,Rr.value,Ae),Rr!==null&&(d&&Rr.alternate!==null&&bn.delete(Rr.key===null?er:Rr.key),$t=J(Rr,$t,er),Or===null?Mn=Rr:Or.sibling=Rr,Or=Rr);return d&&bn.forEach(function(z_){return m(Xt,z_)}),fr&&$s(Xt,er),Mn}function ni(Xt,$t,ie,Ae){if(typeof ie=="object"&&ie!==null&&ie.type===y&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case f:t:{for(var Mn=ie.key;$t!==null;){if($t.key===Mn){if(Mn=ie.type,Mn===y){if($t.tag===7){_(Xt,$t.sibling),Ae=K($t,ie.props.children),Ae.return=Xt,Xt=Ae;break t}}else if($t.elementType===Mn||typeof Mn=="object"&&Mn!==null&&Mn.$$typeof===P&&te(Mn)===$t.type){_(Xt,$t.sibling),Ae=K($t,ie.props),Fn(Ae,ie),Ae.return=Xt,Xt=Ae;break t}_(Xt,$t);break}else m(Xt,$t);$t=$t.sibling}ie.type===y?(Ae=Oo(ie.props.children,Xt.mode,Ae,ie.key),Ae.return=Xt,Xt=Ae):(Ae=Gl(ie.type,ie.key,ie.props,null,Xt.mode,Ae),Fn(Ae,ie),Ae.return=Xt,Xt=Ae)}return pt(Xt);case g:t:{for(Mn=ie.key;$t!==null;){if($t.key===Mn)if($t.tag===4&&$t.stateNode.containerInfo===ie.containerInfo&&$t.stateNode.implementation===ie.implementation){_(Xt,$t.sibling),Ae=K($t,ie.children||[]),Ae.return=Xt,Xt=Ae;break t}else{_(Xt,$t);break}else m(Xt,$t);$t=$t.sibling}Ae=Yl(ie,Xt.mode,Ae),Ae.return=Xt,Xt=Ae}return pt(Xt);case P:return ie=te(ie),ni(Xt,$t,ie,Ae)}if(E(ie))return cn(Xt,$t,ie,Ae);if(I(ie)){if(Mn=I(ie),typeof Mn!="function")throw Error(r(150));return ie=Mn.call(ie),Rn(Xt,$t,ie,Ae)}if(typeof ie.then=="function")return ni(Xt,$t,rn(ie),Ae);if(ie.$$typeof===S)return ni(Xt,$t,Mc(Xt,ie),Ae);ln(Xt,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,$t!==null&&$t.tag===6?(_(Xt,$t.sibling),Ae=K($t,ie),Ae.return=Xt,Xt=Ae):(_(Xt,$t),Ae=zu(ie,Xt.mode,Ae),Ae.return=Xt,Xt=Ae),pt(Xt)):_(Xt,$t)}return function(Xt,$t,ie,Ae){try{hn=0;var Mn=ni(Xt,$t,ie,Ae);return Le=null,Mn}catch(bn){if(bn===Ut||bn===Ot)throw bn;var Or=ps(29,bn,null,Xt.mode);return Or.lanes=Ae,Or.return=Xt,Or}finally{}}}var ai=lr(!0),Vn=lr(!1),sn=!1;function We(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mi(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Ln(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function Xn(d,m,_){var M=d.updateQueue;if(M===null)return null;if(M=M.shared,(zr&2)!==0){var K=M.pending;return K===null?m.next=m:(m.next=K.next,K.next=m),M.pending=m,m=ds(d),Pu(d,null,_),m}return Bu(d,M,m,_),ds(d)}function Pr(d,m,_){if(m=m.updateQueue,m!==null&&(m=m.shared,(_&4194048)!==0)){var M=m.lanes;M&=d.pendingLanes,_|=M,m.lanes=_,on(d,_)}}function Hi(d,m){var _=d.updateQueue,M=d.alternate;if(M!==null&&(M=M.updateQueue,_===M)){var K=null,J=null;if(_=_.firstBaseUpdate,_!==null){do{var pt={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};J===null?K=J=pt:J=J.next=pt,_=_.next}while(_!==null);J===null?K=J=m:J=J.next=m}else K=J=m;_={baseState:M.baseState,firstBaseUpdate:K,lastBaseUpdate:J,shared:M.shared,callbacks:M.callbacks},d.updateQueue=_;return}d=_.lastBaseUpdate,d===null?_.firstBaseUpdate=m:d.next=m,_.lastBaseUpdate=m}var us=!1;function Jr(){if(us){var d=Q;if(d!==null)throw d}}function Ri(d,m,_,M){us=!1;var K=d.updateQueue;sn=!1;var J=K.firstBaseUpdate,pt=K.lastBaseUpdate,kt=K.shared.pending;if(kt!==null){K.shared.pending=null;var Pt=kt,se=Pt.next;Pt.next=null,pt===null?J=se:pt.next=se,pt=Pt;var ve=d.alternate;ve!==null&&(ve=ve.updateQueue,kt=ve.lastBaseUpdate,kt!==pt&&(kt===null?ve.firstBaseUpdate=se:kt.next=se,ve.lastBaseUpdate=Pt))}if(J!==null){var je=K.baseState;pt=0,ve=se=Pt=null,kt=J;do{var oe=kt.lane&-536870913,he=oe!==kt.lane;if(he?(gr&oe)===oe:(M&oe)===oe){oe!==0&&oe===Y&&(us=!0),ve!==null&&(ve=ve.next={lane:0,tag:kt.tag,payload:kt.payload,callback:null,next:null});t:{var cn=d,Rn=kt;oe=m;var ni=_;switch(Rn.tag){case 1:if(cn=Rn.payload,typeof cn=="function"){je=cn.call(ni,je,oe);break t}je=cn;break t;case 3:cn.flags=cn.flags&-65537|128;case 0:if(cn=Rn.payload,oe=typeof cn=="function"?cn.call(ni,je,oe):cn,oe==null)break t;je=p({},je,oe);break t;case 2:sn=!0}}oe=kt.callback,oe!==null&&(d.flags|=64,he&&(d.flags|=8192),he=K.callbacks,he===null?K.callbacks=[oe]:he.push(oe))}else he={lane:oe,tag:kt.tag,payload:kt.payload,callback:kt.callback,next:null},ve===null?(se=ve=he,Pt=je):ve=ve.next=he,pt|=oe;if(kt=kt.next,kt===null){if(kt=K.shared.pending,kt===null)break;he=kt,kt=he.next,he.next=null,K.lastBaseUpdate=he,K.shared.pending=null}}while(!0);ve===null&&(Pt=je),K.baseState=Pt,K.firstBaseUpdate=se,K.lastBaseUpdate=ve,J===null&&(K.shared.lanes=0),su|=pt,d.lanes=pt,d.memoizedState=je}}function ms(d,m){if(typeof d!="function")throw Error(r(191,d));d.call(m)}function Ii(d,m){var _=d.callbacks;if(_!==null)for(d.callbacks=null,d=0;d<_.length;d++)ms(_[d],m)}var rr=B(null),_r=B(0);function gi(d,m){d=xl,H(_r,d),H(rr,m),xl=d|m.baseLanes}function Tr(){H(_r,xl),H(rr,rr.current)}function $i(){xl=_r.current,O(rr),O(_r)}var bi=B(null),kr=null;function Li(d){var m=d.alternate;H(xr,xr.current&1),H(bi,d),kr===null&&(m===null||rr.current!==null||m.memoizedState!==null)&&(kr=d)}function Fr(d){H(xr,xr.current),H(bi,d),kr===null&&(kr=d)}function Di(d){d.tag===22?(H(xr,xr.current),H(bi,d),kr===null&&(kr=d)):Bi()}function Bi(){H(xr,xr.current),H(bi,bi.current)}function Vr(d){O(bi),kr===d&&(kr=null),O(xr)}var xr=B(0);function gs(d){for(var m=d;m!==null;){if(m.tag===13){var _=m.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||Em(_)||Nm(_)))return m}else if(m.tag===19&&(m.memoizedProps.revealOrder==="forwards"||m.memoizedProps.revealOrder==="backwards"||m.memoizedProps.revealOrder==="unstable_legacy-backwards"||m.memoizedProps.revealOrder==="together")){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var ki=0,Cn=null,jn=null,Ar=null,Ts=!1,aa=!1,_s=!1,Pi=0,zo=0,qo=null,Oc=0;function ti(){throw Error(r(321))}function qf(d,m){if(m===null)return!1;for(var _=0;_<m.length&&_<d.length;_++)if(!is(d[_],m[_]))return!1;return!0}function Uf(d,m,_,M,K,J){return ki=J,Cn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,x.H=d===null||d.memoizedState===null?_2:P0,_s=!1,J=_(M,K),_s=!1,aa&&(J=lo(m,_,M,K)),Rc(d),J}function Rc(d){x.H=Kf;var m=jn!==null&&jn.next!==null;if(ki=0,Ar=jn=Cn=null,Ts=!1,zo=0,qo=null,m)throw Error(r(300));d===null||Ji||(d=d.dependencies,d!==null&&jc(d)&&(Ji=!0))}function lo(d,m,_,M){Cn=d;var K=0;do{if(aa&&(qo=null),zo=0,aa=!1,25<=K)throw Error(r(301));if(K+=1,Ar=jn=null,d.updateQueue!=null){var J=d.updateQueue;J.lastEffect=null,J.events=null,J.stores=null,J.memoCache!=null&&(J.memoCache.index=0)}x.H=k2,J=m(_,M)}while(aa);return J}function M0(){var d=x.H,m=d.useState()[0];return m=typeof m.then=="function"?Uo(m):m,d=d.useState()[0],(jn!==null?jn.memoizedState:null)!==d&&(Cn.flags|=1024),m}function Hf(){var d=Pi!==0;return Pi=0,d}function $f(d,m,_){m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~_}function Ic(d){if(Ts){for(d=d.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}Ts=!1}ki=0,Ar=jn=Cn=null,aa=!1,zo=Pi=0,qo=null}function Qi(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?Cn.memoizedState=Ar=d:Ar=Ar.next=d,Ar}function Ai(){if(jn===null){var d=Cn.alternate;d=d!==null?d.memoizedState:null}else d=jn.next;var m=Ar===null?Cn.memoizedState:Ar.next;if(m!==null)Ar=m,jn=d;else{if(d===null)throw Cn.alternate===null?Error(r(467)):Error(r(310));jn=d,d={memoizedState:jn.memoizedState,baseState:jn.baseState,baseQueue:jn.baseQueue,queue:jn.queue,next:null},Ar===null?Cn.memoizedState=Ar=d:Ar=Ar.next=d}return Ar}function $u(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Uo(d){var m=zo;return zo+=1,qo===null&&(qo=[]),d=be(qo,d,m),m=Cn,(Ar===null?m.memoizedState:Ar.next)===null&&(m=m.alternate,x.H=m===null||m.memoizedState===null?_2:P0),d}function Jl(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Uo(d);if(d.$$typeof===S)return ls(d)}throw Error(r(438,String(d)))}function hl(d){var m=null,_=Cn.updateQueue;if(_!==null&&(m=_.memoCache),m==null){var M=Cn.alternate;M!==null&&(M=M.updateQueue,M!==null&&(M=M.memoCache,M!=null&&(m={data:M.data.map(function(K){return K.slice()}),index:0})))}if(m==null&&(m={data:[],index:0}),_===null&&(_=$u(),Cn.updateQueue=_),_.memoCache=m,_=m.data[m.index],_===void 0)for(_=m.data[m.index]=Array(d),M=0;M<d;M++)_[M]=q;return m.index++,_}function Fa(d,m){return typeof m=="function"?m(d):m}function Dc(d){var m=Ai();return tu(m,jn,d)}function tu(d,m,_){var M=d.queue;if(M===null)throw Error(r(311));M.lastRenderedReducer=_;var K=d.baseQueue,J=M.pending;if(J!==null){if(K!==null){var pt=K.next;K.next=J.next,J.next=pt}m.baseQueue=K=J,M.pending=null}if(J=d.baseState,K===null)d.memoizedState=J;else{m=K.next;var kt=pt=null,Pt=null,se=m,ve=!1;do{var je=se.lane&-536870913;if(je!==se.lane?(gr&je)===je:(ki&je)===je){var oe=se.revertLane;if(oe===0)Pt!==null&&(Pt=Pt.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),je===Y&&(ve=!0);else if((ki&oe)===oe){se=se.next,oe===Y&&(ve=!0);continue}else je={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},Pt===null?(kt=Pt=je,pt=J):Pt=Pt.next=je,Cn.lanes|=oe,su|=oe;je=se.action,_s&&_(J,je),J=se.hasEagerState?se.eagerState:_(J,je)}else oe={lane:je,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},Pt===null?(kt=Pt=oe,pt=J):Pt=Pt.next=oe,Cn.lanes|=je,su|=je;se=se.next}while(se!==null&&se!==m);if(Pt===null?pt=J:Pt.next=kt,!is(J,d.memoizedState)&&(Ji=!0,ve&&(_=Q,_!==null)))throw _;d.memoizedState=J,d.baseState=pt,d.baseQueue=Pt,M.lastRenderedState=J}return K===null&&(M.lanes=0),[d.memoizedState,M.dispatch]}function Bc(d){var m=Ai(),_=m.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=d;var M=_.dispatch,K=_.pending,J=m.memoizedState;if(K!==null){_.pending=null;var pt=K=K.next;do J=d(J,pt.action),pt=pt.next;while(pt!==K);is(J,m.memoizedState)||(Ji=!0),m.memoizedState=J,m.baseQueue===null&&(m.baseState=J),_.lastRenderedState=J}return[J,M]}function Pc(d,m,_){var M=Cn,K=Ai(),J=fr;if(J){if(_===void 0)throw Error(r(407));_=_()}else _=m();var pt=!is((jn||K).memoizedState,_);if(pt&&(K.memoizedState=_,Ji=!0),K=K.queue,L0(Wf.bind(null,M,K,d),[d]),K.getSnapshot!==m||pt||Ar!==null&&Ar.memoizedState.tag&1){if(M.flags|=2048,pl(9,{destroy:void 0},Vf.bind(null,M,K,_,m),null),oi===null)throw Error(r(349));J||(ki&127)!==0||uo(M,m,_)}return _}function uo(d,m,_){d.flags|=16384,d={getSnapshot:m,value:_},m=Cn.updateQueue,m===null?(m=$u(),Cn.updateQueue=m,m.stores=[d]):(_=m.stores,_===null?m.stores=[d]:_.push(d))}function Vf(d,m,_,M){m.value=_,m.getSnapshot=M,vd(m)&&Gf(d)}function Wf(d,m,_){return _(function(){vd(m)&&Gf(d)})}function vd(d){var m=d.getSnapshot;d=d.value;try{var _=m();return!is(d,_)}catch{return!0}}function Gf(d){var m=ao(d,2);m!==null&&fa(m,d,2)}function Ho(d){var m=Qi();if(typeof d=="function"){var _=d;if(d=_(),_s){ue(!0);try{_()}finally{ue(!1)}}}return m.memoizedState=m.baseState=d,m.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:d},m}function wd(d,m,_,M){return d.baseState=_,tu(d,jn,typeof M=="function"?M:Fa)}function xd(d,m,_,M,K){if(Ad(d))throw Error(r(485));if(d=m.action,d!==null){var J={payload:K,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(pt){J.listeners.push(pt)}};x.T!==null?_(!0):J.isTransition=!1,M(J),_=m.pending,_===null?(J.next=m.pending=J,Sd(m,J)):(J.next=_.next,m.pending=_.next=J)}}function Sd(d,m){var _=m.action,M=m.payload,K=d.state;if(m.isTransition){var J=x.T,pt={};x.T=pt;try{var kt=_(K,M),Pt=x.S;Pt!==null&&Pt(pt,kt),Yf(d,m,kt)}catch(se){dl(d,m,se)}finally{J!==null&&pt.types!==null&&(J.types=pt.types),x.T=J}}else try{J=_(K,M),Yf(d,m,J)}catch(se){dl(d,m,se)}}function Yf(d,m,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(M){_d(d,m,M)},function(M){return dl(d,m,M)}):_d(d,m,_)}function _d(d,m,_){m.status="fulfilled",m.value=_,Fc(m),d.state=_,m=d.pending,m!==null&&(_=m.next,_===m?d.pending=null:(_=_.next,m.next=_,Sd(d,_)))}function dl(d,m,_){var M=d.pending;if(d.pending=null,M!==null){M=M.next;do m.status="rejected",m.reason=_,Fc(m),m=m.next;while(m!==M)}d.action=null}function Fc(d){d=d.listeners;for(var m=0;m<d.length;m++)(0,d[m])()}function Vu(d,m){return m}function za(d,m){if(fr){var _=oi.formState;if(_!==null){t:{var M=Cn;if(fr){if(si){e:{for(var K=si,J=_i;K.nodeType!==8;){if(!J){K=null;break e}if(K=qa(K.nextSibling),K===null){K=null;break e}}J=K.data,K=J==="F!"||J==="F"?K:null}if(K){si=qa(K.nextSibling),M=K.data==="F!";break t}}Io(M)}M=!1}M&&(m=_[0])}}return _=Qi(),_.memoizedState=_.baseState=m,M={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vu,lastRenderedState:m},_.queue=M,_=w2.bind(null,Cn,M),M.dispatch=_,M=Ho(!1),J=B0.bind(null,Cn,!1,M.queue),M=Qi(),K={state:m,dispatch:null,action:d,pending:null},M.queue=K,_=xd.bind(null,Cn,K,J,_),K.dispatch=_,M.memoizedState=d,[m,_,!1]}function co(d){var m=Ai();return fo(m,jn,d)}function fo(d,m,_){if(m=tu(d,m,Vu)[0],d=Dc(Fa)[0],typeof m=="object"&&m!==null&&typeof m.then=="function")try{var M=Uo(m)}catch(pt){throw pt===Ut?Ot:pt}else M=m;m=Ai();var K=m.queue,J=K.dispatch;return _!==m.memoizedState&&(Cn.flags|=2048,pl(9,{destroy:void 0},zc.bind(null,K,_),null)),[M,J,d]}function zc(d,m){d.action=m}function qc(d){var m=Ai(),_=jn;if(_!==null)return fo(m,_,d);Ai(),m=m.memoizedState,_=Ai();var M=_.queue.dispatch;return _.memoizedState=d,[m,M,!1]}function pl(d,m,_,M){return d={tag:d,create:_,deps:M,inst:m,next:null},m=Cn.updateQueue,m===null&&(m=$u(),Cn.updateQueue=m),_=m.lastEffect,_===null?m.lastEffect=d.next=d:(M=_.next,_.next=d,d.next=M,m.lastEffect=d),d}function kd(){return Ai().memoizedState}function eu(d,m,_,M){var K=Qi();Cn.flags|=d,K.memoizedState=pl(1|m,{destroy:void 0},_,M===void 0?null:M)}function nu(d,m,_,M){var K=Ai();M=M===void 0?null:M;var J=K.memoizedState.inst;jn!==null&&M!==null&&qf(M,jn.memoizedState.deps)?K.memoizedState=pl(m,J,_,M):(Cn.flags|=d,K.memoizedState=pl(1|m,J,_,M))}function a2(d,m){eu(8390656,8,d,m)}function L0(d,m){nu(2048,8,d,m)}function RS(d){Cn.flags|=4;var m=Cn.updateQueue;if(m===null)m=$u(),Cn.updateQueue=m,m.events=[d];else{var _=m.events;_===null?m.events=[d]:_.push(d)}}function o2(d){var m=Ai().memoizedState;return RS({ref:m,nextImpl:d}),function(){if((zr&2)!==0)throw Error(r(440));return m.impl.apply(void 0,arguments)}}function l2(d,m){return nu(4,2,d,m)}function u2(d,m){return nu(4,4,d,m)}function c2(d,m){if(typeof m=="function"){d=d();var _=m(d);return function(){typeof _=="function"?_():m(null)}}if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function f2(d,m,_){_=_!=null?_.concat([d]):null,nu(4,4,c2.bind(null,m,d),_)}function O0(){}function h2(d,m){var _=Ai();m=m===void 0?null:m;var M=_.memoizedState;return m!==null&&qf(m,M[1])?M[0]:(_.memoizedState=[d,m],d)}function d2(d,m){var _=Ai();m=m===void 0?null:m;var M=_.memoizedState;if(m!==null&&qf(m,M[1]))return M[0];if(M=d(),_s){ue(!0);try{d()}finally{ue(!1)}}return _.memoizedState=[M,m],M}function R0(d,m,_){return _===void 0||(ki&1073741824)!==0&&(gr&261930)===0?d.memoizedState=m:(d.memoizedState=_,d=py(),Cn.lanes|=d,su|=d,_)}function p2(d,m,_,M){return is(_,m)?_:rr.current!==null?(d=R0(d,_,M),is(d,m)||(Ji=!0),d):(ki&42)===0||(ki&1073741824)!==0&&(gr&261930)===0?(Ji=!0,d.memoizedState=_):(d=py(),Cn.lanes|=d,su|=d,m)}function m2(d,m,_,M,K){var J=k.p;k.p=J!==0&&8>J?J:8;var pt=x.T,kt={};x.T=kt,B0(d,!1,m,_);try{var Pt=K(),se=x.S;if(se!==null&&se(kt,Pt),Pt!==null&&typeof Pt=="object"&&typeof Pt.then=="function"){var ve=vt(Pt,M);Xf(d,m,ve,_a(d))}else Xf(d,m,M,_a(d))}catch(je){Xf(d,m,{then:function(){},status:"rejected",reason:je},_a())}finally{k.p=J,pt!==null&&kt.types!==null&&(pt.types=kt.types),x.T=pt}}function IS(){}function I0(d,m,_,M){if(d.tag!==5)throw Error(r(476));var K=g2(d).queue;m2(d,K,m,A,_===null?IS:function(){return b2(d),_(M)})}function g2(d){var m=d.memoizedState;if(m!==null)return m;m={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:A},next:null};var _={};return m.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:_},next:null},d.memoizedState=m,d=d.alternate,d!==null&&(d.memoizedState=m),m}function b2(d){var m=g2(d);m.next===null&&(m=d.alternate.memoizedState),Xf(d,m.next.queue,{},_a())}function D0(){return ls(hh)}function y2(){return Ai().memoizedState}function v2(){return Ai().memoizedState}function DS(d){for(var m=d.return;m!==null;){switch(m.tag){case 24:case 3:var _=_a();d=Ln(_);var M=Xn(m,d,_);M!==null&&(fa(M,m,_),Pr(M,m,_)),m={cache:Ql()},d.payload=m;return}m=m.return}}function BS(d,m,_){var M=_a();_={lane:M,revertLane:0,gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null},Ad(d)?x2(m,_):(_=Sc(d,m,_,M),_!==null&&(fa(_,d,M),S2(_,m,M)))}function w2(d,m,_){var M=_a();Xf(d,m,_,M)}function Xf(d,m,_,M){var K={lane:M,revertLane:0,gesture:null,action:_,hasEagerState:!1,eagerState:null,next:null};if(Ad(d))x2(m,K);else{var J=d.alternate;if(d.lanes===0&&(J===null||J.lanes===0)&&(J=m.lastRenderedReducer,J!==null))try{var pt=m.lastRenderedState,kt=J(pt,_);if(K.hasEagerState=!0,K.eagerState=kt,is(kt,pt))return Bu(d,m,K,0),oi===null&&Du(),!1}catch{}finally{}if(_=Sc(d,m,K,M),_!==null)return fa(_,d,M),S2(_,m,M),!0}return!1}function B0(d,m,_,M){if(M={lane:2,revertLane:mm(),gesture:null,action:M,hasEagerState:!1,eagerState:null,next:null},Ad(d)){if(m)throw Error(r(479))}else m=Sc(d,_,M,2),m!==null&&fa(m,d,2)}function Ad(d){var m=d.alternate;return d===Cn||m!==null&&m===Cn}function x2(d,m){aa=Ts=!0;var _=d.pending;_===null?m.next=m:(m.next=_.next,_.next=m),d.pending=m}function S2(d,m,_){if((_&4194048)!==0){var M=m.lanes;M&=d.pendingLanes,_|=M,m.lanes=_,on(d,_)}}var Kf={readContext:ls,use:Jl,useCallback:ti,useContext:ti,useEffect:ti,useImperativeHandle:ti,useLayoutEffect:ti,useInsertionEffect:ti,useMemo:ti,useReducer:ti,useRef:ti,useState:ti,useDebugValue:ti,useDeferredValue:ti,useTransition:ti,useSyncExternalStore:ti,useId:ti,useHostTransitionStatus:ti,useFormState:ti,useActionState:ti,useOptimistic:ti,useMemoCache:ti,useCacheRefresh:ti};Kf.useEffectEvent=ti;var _2={readContext:ls,use:Jl,useCallback:function(d,m){return Qi().memoizedState=[d,m===void 0?null:m],d},useContext:ls,useEffect:a2,useImperativeHandle:function(d,m,_){_=_!=null?_.concat([d]):null,eu(4194308,4,c2.bind(null,m,d),_)},useLayoutEffect:function(d,m){return eu(4194308,4,d,m)},useInsertionEffect:function(d,m){eu(4,2,d,m)},useMemo:function(d,m){var _=Qi();m=m===void 0?null:m;var M=d();if(_s){ue(!0);try{d()}finally{ue(!1)}}return _.memoizedState=[M,m],M},useReducer:function(d,m,_){var M=Qi();if(_!==void 0){var K=_(m);if(_s){ue(!0);try{_(m)}finally{ue(!1)}}}else K=m;return M.memoizedState=M.baseState=K,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:K},M.queue=d,d=d.dispatch=BS.bind(null,Cn,d),[M.memoizedState,d]},useRef:function(d){var m=Qi();return d={current:d},m.memoizedState=d},useState:function(d){d=Ho(d);var m=d.queue,_=w2.bind(null,Cn,m);return m.dispatch=_,[d.memoizedState,_]},useDebugValue:O0,useDeferredValue:function(d,m){var _=Qi();return R0(_,d,m)},useTransition:function(){var d=Ho(!1);return d=m2.bind(null,Cn,d.queue,!0,!1),Qi().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,m,_){var M=Cn,K=Qi();if(fr){if(_===void 0)throw Error(r(407));_=_()}else{if(_=m(),oi===null)throw Error(r(349));(gr&127)!==0||uo(M,m,_)}K.memoizedState=_;var J={value:_,getSnapshot:m};return K.queue=J,a2(Wf.bind(null,M,J,d),[d]),M.flags|=2048,pl(9,{destroy:void 0},Vf.bind(null,M,J,_,m),null),_},useId:function(){var d=Qi(),m=oi.identifierPrefix;if(fr){var _=ia,M=ra;_=(M&~(1<<32-ge(M)-1)).toString(32)+_,m="_"+m+"R_"+_,_=Pi++,0<_&&(m+="H"+_.toString(32)),m+="_"}else _=Oc++,m="_"+m+"r_"+_.toString(32)+"_";return d.memoizedState=m},useHostTransitionStatus:D0,useFormState:za,useActionState:za,useOptimistic:function(d){var m=Qi();m.memoizedState=m.baseState=d;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return m.queue=_,m=B0.bind(null,Cn,!0,_),_.dispatch=m,[d,m]},useMemoCache:hl,useCacheRefresh:function(){return Qi().memoizedState=DS.bind(null,Cn)},useEffectEvent:function(d){var m=Qi(),_={impl:d};return m.memoizedState=_,function(){if((zr&2)!==0)throw Error(r(440));return _.impl.apply(void 0,arguments)}}},P0={readContext:ls,use:Jl,useCallback:h2,useContext:ls,useEffect:L0,useImperativeHandle:f2,useInsertionEffect:l2,useLayoutEffect:u2,useMemo:d2,useReducer:Dc,useRef:kd,useState:function(){return Dc(Fa)},useDebugValue:O0,useDeferredValue:function(d,m){var _=Ai();return p2(_,jn.memoizedState,d,m)},useTransition:function(){var d=Dc(Fa)[0],m=Ai().memoizedState;return[typeof d=="boolean"?d:Uo(d),m]},useSyncExternalStore:Pc,useId:y2,useHostTransitionStatus:D0,useFormState:co,useActionState:co,useOptimistic:function(d,m){var _=Ai();return wd(_,jn,d,m)},useMemoCache:hl,useCacheRefresh:v2};P0.useEffectEvent=o2;var k2={readContext:ls,use:Jl,useCallback:h2,useContext:ls,useEffect:L0,useImperativeHandle:f2,useInsertionEffect:l2,useLayoutEffect:u2,useMemo:d2,useReducer:Bc,useRef:kd,useState:function(){return Bc(Fa)},useDebugValue:O0,useDeferredValue:function(d,m){var _=Ai();return jn===null?R0(_,d,m):p2(_,jn.memoizedState,d,m)},useTransition:function(){var d=Bc(Fa)[0],m=Ai().memoizedState;return[typeof d=="boolean"?d:Uo(d),m]},useSyncExternalStore:Pc,useId:y2,useHostTransitionStatus:D0,useFormState:qc,useActionState:qc,useOptimistic:function(d,m){var _=Ai();return jn!==null?wd(_,jn,d,m):(_.baseState=d,[d,_.queue.dispatch])},useMemoCache:hl,useCacheRefresh:v2};k2.useEffectEvent=o2;function F0(d,m,_,M){m=d.memoizedState,_=_(M,m),_=_==null?m:p({},m,_),d.memoizedState=_,d.lanes===0&&(d.updateQueue.baseState=_)}var z0={enqueueSetState:function(d,m,_){d=d._reactInternals;var M=_a(),K=Ln(M);K.payload=m,_!=null&&(K.callback=_),m=Xn(d,K,M),m!==null&&(fa(m,d,M),Pr(m,d,M))},enqueueReplaceState:function(d,m,_){d=d._reactInternals;var M=_a(),K=Ln(M);K.tag=1,K.payload=m,_!=null&&(K.callback=_),m=Xn(d,K,M),m!==null&&(fa(m,d,M),Pr(m,d,M))},enqueueForceUpdate:function(d,m){d=d._reactInternals;var _=_a(),M=Ln(_);M.tag=2,m!=null&&(M.callback=m),m=Xn(d,M,_),m!==null&&(fa(m,d,_),Pr(m,d,_))}};function A2(d,m,_,M,K,J,pt){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(M,J,pt):m.prototype&&m.prototype.isPureReactComponent?!no(_,M)||!no(K,J):!0}function C2(d,m,_,M){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(_,M),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(_,M),m.state!==d&&z0.enqueueReplaceState(m,m.state,null)}function Wu(d,m){var _=m;if("ref"in m){_={};for(var M in m)M!=="ref"&&(_[M]=m[M])}if(d=d.defaultProps){_===m&&(_=p({},_));for(var K in d)_[K]===void 0&&(_[K]=d[K])}return _}function E2(d){Iu(d)}function N2(d){console.error(d)}function T2(d){Iu(d)}function Cd(d,m){try{var _=d.onUncaughtError;_(m.value,{componentStack:m.stack})}catch(M){setTimeout(function(){throw M})}}function j2(d,m,_){try{var M=d.onCaughtError;M(_.value,{componentStack:_.stack,errorBoundary:m.tag===1?m.stateNode:null})}catch(K){setTimeout(function(){throw K})}}function q0(d,m,_){return _=Ln(_),_.tag=3,_.payload={element:null},_.callback=function(){Cd(d,m)},_}function M2(d){return d=Ln(d),d.tag=3,d}function L2(d,m,_,M){var K=_.type.getDerivedStateFromError;if(typeof K=="function"){var J=M.value;d.payload=function(){return K(J)},d.callback=function(){j2(m,_,M)}}var pt=_.stateNode;pt!==null&&typeof pt.componentDidCatch=="function"&&(d.callback=function(){j2(m,_,M),typeof K!="function"&&(au===null?au=new Set([this]):au.add(this));var kt=M.stack;this.componentDidCatch(M.value,{componentStack:kt!==null?kt:""})})}function PS(d,m,_,M,K){if(_.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){if(m=_.alternate,m!==null&&Po(m,_,K,!0),_=bi.current,_!==null){switch(_.tag){case 31:case 13:return kr===null?Pd():_.alternate===null&&Fi===0&&(Fi=3),_.flags&=-257,_.flags|=65536,_.lanes=K,M===Wt?_.flags|=16384:(m=_.updateQueue,m===null?_.updateQueue=new Set([M]):m.add(M),hm(d,M,K)),!1;case 22:return _.flags|=65536,M===Wt?_.flags|=16384:(m=_.updateQueue,m===null?(m={transitions:null,markerInstances:null,retryQueue:new Set([M])},_.updateQueue=m):(_=m.retryQueue,_===null?m.retryQueue=new Set([M]):_.add(M)),hm(d,M,K)),!1}throw Error(r(435,_.tag))}return hm(d,M,K),Pd(),!1}if(fr)return m=bi.current,m!==null?((m.flags&65536)===0&&(m.flags|=256),m.flags|=65536,m.lanes=K,M!==wa&&(d=Error(r(422),{cause:M}),Kl(ta(d,_)))):(M!==wa&&(m=Error(r(423),{cause:M}),Kl(ta(m,_))),d=d.current.alternate,d.flags|=65536,K&=-K,d.lanes|=K,M=ta(M,_),K=q0(d.stateNode,M,K),Hi(d,K),Fi!==4&&(Fi=2)),!1;var J=Error(r(520),{cause:M});if(J=ta(J,_),ih===null?ih=[J]:ih.push(J),Fi!==4&&(Fi=2),m===null)return!0;M=ta(M,_),_=m;do{switch(_.tag){case 3:return _.flags|=65536,d=K&-K,_.lanes|=d,d=q0(_.stateNode,M,d),Hi(_,d),!1;case 1:if(m=_.type,J=_.stateNode,(_.flags&128)===0&&(typeof m.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(au===null||!au.has(J))))return _.flags|=65536,K&=-K,_.lanes|=K,K=M2(K),L2(K,d,_,M),Hi(_,K),!1}_=_.return}while(_!==null);return!1}var U0=Error(r(461)),Ji=!1;function ks(d,m,_,M){m.child=d===null?Vn(m,null,_,M):ai(m,d.child,_,M)}function O2(d,m,_,M,K){_=_.render;var J=m.ref;if("ref"in M){var pt={};for(var kt in M)kt!=="ref"&&(pt[kt]=M[kt])}else pt=M;return Fo(m),M=Uf(d,m,_,pt,J,K),kt=Hf(),d!==null&&!Ji?($f(d,m,K),ml(d,m,K)):(fr&&kt&&Pf(m),m.flags|=1,ks(d,m,M,K),m.child)}function R2(d,m,_,M,K){if(d===null){var J=_.type;return typeof J=="function"&&!kc(J)&&J.defaultProps===void 0&&_.compare===null?(m.tag=15,m.type=J,I2(d,m,J,M,K)):(d=Gl(_.type,null,M,m,m.mode,K),d.ref=m.ref,d.return=m,m.child=d)}if(J=d.child,!K0(d,K)){var pt=J.memoizedProps;if(_=_.compare,_=_!==null?_:no,_(pt,M)&&d.ref===m.ref)return ml(d,m,K)}return m.flags|=1,d=Js(J,M),d.ref=m.ref,d.return=m,m.child=d}function I2(d,m,_,M,K){if(d!==null){var J=d.memoizedProps;if(no(J,M)&&d.ref===m.ref)if(Ji=!1,m.pendingProps=M=J,K0(d,K))(d.flags&131072)!==0&&(Ji=!0);else return m.lanes=d.lanes,ml(d,m,K)}return H0(d,m,_,M,K)}function D2(d,m,_,M){var K=M.children,J=d!==null?d.memoizedState:null;if(d===null&&m.stateNode===null&&(m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),M.mode==="hidden"){if((m.flags&128)!==0){if(J=J!==null?J.baseLanes|_:_,d!==null){for(M=m.child=d.child,K=0;M!==null;)K=K|M.lanes|M.childLanes,M=M.sibling;M=K&~J}else M=0,m.child=null;return B2(d,m,J,_,M)}if((_&536870912)!==0)m.memoizedState={baseLanes:0,cachePool:null},d!==null&&Nt(m,J!==null?J.cachePool:null),J!==null?gi(m,J):Tr(),Di(m);else return M=m.lanes=536870912,B2(d,m,J!==null?J.baseLanes|_:_,_,M)}else J!==null?(Nt(m,J.cachePool),gi(m,J),Bi(),m.memoizedState=null):(d!==null&&Nt(m,null),Tr(),Bi());return ks(d,m,K,_),m.child}function Zf(d,m){return d!==null&&d.tag===22||m.stateNode!==null||(m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.sibling}function B2(d,m,_,M,K){var J=Ct();return J=J===null?null:{parent:Mi._currentValue,pool:J},m.memoizedState={baseLanes:_,cachePool:J},d!==null&&Nt(m,null),Tr(),Di(m),d!==null&&Po(d,m,M,!0),m.childLanes=K,null}function Ed(d,m){return m=Td({mode:m.mode,children:m.children},d.mode),m.ref=d.ref,d.child=m,m.return=d,m}function P2(d,m,_){return ai(m,d.child,null,_),d=Ed(m,m.pendingProps),d.flags|=2,Vr(m),m.memoizedState=null,d}function FS(d,m,_){var M=m.pendingProps,K=(m.flags&128)!==0;if(m.flags&=-129,d===null){if(fr){if(M.mode==="hidden")return d=Ed(m,M),m.lanes=536870912,Zf(null,d);if(Fr(m),(d=si)?(d=Ky(d,_i),d=d!==null&&d.data==="&"?d:null,d!==null&&(m.memoizedState={dehydrated:d,treeContext:Ro!==null?{id:ra,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},_=Ac(d),_.return=m,m.child=_,as=m,si=null)):d=null,d===null)throw Io(m);return m.lanes=536870912,null}return Ed(m,M)}var J=d.memoizedState;if(J!==null){var pt=J.dehydrated;if(Fr(m),K)if(m.flags&256)m.flags&=-257,m=P2(d,m,_);else if(m.memoizedState!==null)m.child=d.child,m.flags|=128,m=null;else throw Error(r(558));else if(Ji||Po(d,m,_,!1),K=(_&d.childLanes)!==0,Ji||K){if(M=oi,M!==null&&(pt=Dt(M,_),pt!==0&&pt!==J.retryLane))throw J.retryLane=pt,ao(d,pt),fa(M,d,pt),U0;Pd(),m=P2(d,m,_)}else d=J.treeContext,si=qa(pt.nextSibling),as=m,fr=!0,Ss=null,_i=!1,d!==null&&bd(m,d),m=Ed(m,M),m.flags|=4096;return m}return d=Js(d.child,{mode:M.mode,children:M.children}),d.ref=m.ref,m.child=d,d.return=m,d}function Nd(d,m){var _=m.ref;if(_===null)d!==null&&d.ref!==null&&(m.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(r(284));(d===null||d.ref!==_)&&(m.flags|=4194816)}}function H0(d,m,_,M,K){return Fo(m),_=Uf(d,m,_,M,void 0,K),M=Hf(),d!==null&&!Ji?($f(d,m,K),ml(d,m,K)):(fr&&M&&Pf(m),m.flags|=1,ks(d,m,_,K),m.child)}function F2(d,m,_,M,K,J){return Fo(m),m.updateQueue=null,_=lo(m,M,_,K),Rc(d),M=Hf(),d!==null&&!Ji?($f(d,m,J),ml(d,m,J)):(fr&&M&&Pf(m),m.flags|=1,ks(d,m,_,J),m.child)}function z2(d,m,_,M,K){if(Fo(m),m.stateNode===null){var J=ss,pt=_.contextType;typeof pt=="object"&&pt!==null&&(J=ls(pt)),J=new _(M,J),m.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,J.updater=z0,m.stateNode=J,J._reactInternals=m,J=m.stateNode,J.props=M,J.state=m.memoizedState,J.refs={},We(m),pt=_.contextType,J.context=typeof pt=="object"&&pt!==null?ls(pt):ss,J.state=m.memoizedState,pt=_.getDerivedStateFromProps,typeof pt=="function"&&(F0(m,_,pt,M),J.state=m.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(pt=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),pt!==J.state&&z0.enqueueReplaceState(J,J.state,null),Ri(m,M,J,K),Jr(),J.state=m.memoizedState),typeof J.componentDidMount=="function"&&(m.flags|=4194308),M=!0}else if(d===null){J=m.stateNode;var kt=m.memoizedProps,Pt=Wu(_,kt);J.props=Pt;var se=J.context,ve=_.contextType;pt=ss,typeof ve=="object"&&ve!==null&&(pt=ls(ve));var je=_.getDerivedStateFromProps;ve=typeof je=="function"||typeof J.getSnapshotBeforeUpdate=="function",kt=m.pendingProps!==kt,ve||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(kt||se!==pt)&&C2(m,J,M,pt),sn=!1;var oe=m.memoizedState;J.state=oe,Ri(m,M,J,K),Jr(),se=m.memoizedState,kt||oe!==se||sn?(typeof je=="function"&&(F0(m,_,je,M),se=m.memoizedState),(Pt=sn||A2(m,_,Pt,M,oe,se,pt))?(ve||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(m.flags|=4194308)):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=M,m.memoizedState=se),J.props=M,J.state=se,J.context=pt,M=Pt):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),M=!1)}else{J=m.stateNode,mi(d,m),pt=m.memoizedProps,ve=Wu(_,pt),J.props=ve,je=m.pendingProps,oe=J.context,se=_.contextType,Pt=ss,typeof se=="object"&&se!==null&&(Pt=ls(se)),kt=_.getDerivedStateFromProps,(se=typeof kt=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(pt!==je||oe!==Pt)&&C2(m,J,M,Pt),sn=!1,oe=m.memoizedState,J.state=oe,Ri(m,M,J,K),Jr();var he=m.memoizedState;pt!==je||oe!==he||sn||d!==null&&d.dependencies!==null&&jc(d.dependencies)?(typeof kt=="function"&&(F0(m,_,kt,M),he=m.memoizedState),(ve=sn||A2(m,_,ve,M,oe,he,Pt)||d!==null&&d.dependencies!==null&&jc(d.dependencies))?(se||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(M,he,Pt),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(M,he,Pt)),typeof J.componentDidUpdate=="function"&&(m.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof J.componentDidUpdate!="function"||pt===d.memoizedProps&&oe===d.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||pt===d.memoizedProps&&oe===d.memoizedState||(m.flags|=1024),m.memoizedProps=M,m.memoizedState=he),J.props=M,J.state=he,J.context=Pt,M=ve):(typeof J.componentDidUpdate!="function"||pt===d.memoizedProps&&oe===d.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||pt===d.memoizedProps&&oe===d.memoizedState||(m.flags|=1024),M=!1)}return J=M,Nd(d,m),M=(m.flags&128)!==0,J||M?(J=m.stateNode,_=M&&typeof _.getDerivedStateFromError!="function"?null:J.render(),m.flags|=1,d!==null&&M?(m.child=ai(m,d.child,null,K),m.child=ai(m,null,_,K)):ks(d,m,_,K),m.memoizedState=J.state,d=m.child):d=ml(d,m,K),d}function q2(d,m,_,M){return cl(),m.flags|=256,ks(d,m,_,M),m.child}var $0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function V0(d){return{baseLanes:d,cachePool:Rt()}}function W0(d,m,_){return d=d!==null?d.childLanes&~_:0,m&&(d|=Sa),d}function U2(d,m,_){var M=m.pendingProps,K=!1,J=(m.flags&128)!==0,pt;if((pt=J)||(pt=d!==null&&d.memoizedState===null?!1:(xr.current&2)!==0),pt&&(K=!0,m.flags&=-129),pt=(m.flags&32)!==0,m.flags&=-33,d===null){if(fr){if(K?Li(m):Bi(),(d=si)?(d=Ky(d,_i),d=d!==null&&d.data!=="&"?d:null,d!==null&&(m.memoizedState={dehydrated:d,treeContext:Ro!==null?{id:ra,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},_=Ac(d),_.return=m,m.child=_,as=m,si=null)):d=null,d===null)throw Io(m);return Nm(d)?m.lanes=32:m.lanes=536870912,null}var kt=M.children;return M=M.fallback,K?(Bi(),K=m.mode,kt=Td({mode:"hidden",children:kt},K),M=Oo(M,K,_,null),kt.return=m,M.return=m,kt.sibling=M,m.child=kt,M=m.child,M.memoizedState=V0(_),M.childLanes=W0(d,pt,_),m.memoizedState=$0,Zf(null,M)):(Li(m),G0(m,kt))}var Pt=d.memoizedState;if(Pt!==null&&(kt=Pt.dehydrated,kt!==null)){if(J)m.flags&256?(Li(m),m.flags&=-257,m=Y0(d,m,_)):m.memoizedState!==null?(Bi(),m.child=d.child,m.flags|=128,m=null):(Bi(),kt=M.fallback,K=m.mode,M=Td({mode:"visible",children:M.children},K),kt=Oo(kt,K,_,null),kt.flags|=2,M.return=m,kt.return=m,M.sibling=kt,m.child=M,ai(m,d.child,null,_),M=m.child,M.memoizedState=V0(_),M.childLanes=W0(d,pt,_),m.memoizedState=$0,m=Zf(null,M));else if(Li(m),Nm(kt)){if(pt=kt.nextSibling&&kt.nextSibling.dataset,pt)var se=pt.dgst;pt=se,M=Error(r(419)),M.stack="",M.digest=pt,Kl({value:M,source:null,stack:null}),m=Y0(d,m,_)}else if(Ji||Po(d,m,_,!1),pt=(_&d.childLanes)!==0,Ji||pt){if(pt=oi,pt!==null&&(M=Dt(pt,_),M!==0&&M!==Pt.retryLane))throw Pt.retryLane=M,ao(d,M),fa(pt,d,M),U0;Em(kt)||Pd(),m=Y0(d,m,_)}else Em(kt)?(m.flags|=192,m.child=d.child,m=null):(d=Pt.treeContext,si=qa(kt.nextSibling),as=m,fr=!0,Ss=null,_i=!1,d!==null&&bd(m,d),m=G0(m,M.children),m.flags|=4096);return m}return K?(Bi(),kt=M.fallback,K=m.mode,Pt=d.child,se=Pt.sibling,M=Js(Pt,{mode:"hidden",children:M.children}),M.subtreeFlags=Pt.subtreeFlags&65011712,se!==null?kt=Js(se,kt):(kt=Oo(kt,K,_,null),kt.flags|=2),kt.return=m,M.return=m,M.sibling=kt,m.child=M,Zf(null,M),M=m.child,kt=d.child.memoizedState,kt===null?kt=V0(_):(K=kt.cachePool,K!==null?(Pt=Mi._currentValue,K=K.parent!==Pt?{parent:Pt,pool:Pt}:K):K=Rt(),kt={baseLanes:kt.baseLanes|_,cachePool:K}),M.memoizedState=kt,M.childLanes=W0(d,pt,_),m.memoizedState=$0,Zf(d.child,M)):(Li(m),_=d.child,d=_.sibling,_=Js(_,{mode:"visible",children:M.children}),_.return=m,_.sibling=null,d!==null&&(pt=m.deletions,pt===null?(m.deletions=[d],m.flags|=16):pt.push(d)),m.child=_,m.memoizedState=null,_)}function G0(d,m){return m=Td({mode:"visible",children:m},d.mode),m.return=d,d.child=m}function Td(d,m){return d=ps(22,d,null,m),d.lanes=0,d}function Y0(d,m,_){return ai(m,d.child,null,_),d=G0(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function H2(d,m,_){d.lanes|=m;var M=d.alternate;M!==null&&(M.lanes|=m),Zl(d.return,m,_)}function X0(d,m,_,M,K,J){var pt=d.memoizedState;pt===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:M,tail:_,tailMode:K,treeForkCount:J}:(pt.isBackwards=m,pt.rendering=null,pt.renderingStartTime=0,pt.last=M,pt.tail=_,pt.tailMode=K,pt.treeForkCount=J)}function $2(d,m,_){var M=m.pendingProps,K=M.revealOrder,J=M.tail;M=M.children;var pt=xr.current,kt=(pt&2)!==0;if(kt?(pt=pt&1|2,m.flags|=128):pt&=1,H(xr,pt),ks(d,m,M,_),M=fr?qu:0,!kt&&d!==null&&(d.flags&128)!==0)t:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&H2(d,_,m);else if(d.tag===19)H2(d,_,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break t;for(;d.sibling===null;){if(d.return===null||d.return===m)break t;d=d.return}d.sibling.return=d.return,d=d.sibling}switch(K){case"forwards":for(_=m.child,K=null;_!==null;)d=_.alternate,d!==null&&gs(d)===null&&(K=_),_=_.sibling;_=K,_===null?(K=m.child,m.child=null):(K=_.sibling,_.sibling=null),X0(m,!1,K,_,J,M);break;case"backwards":case"unstable_legacy-backwards":for(_=null,K=m.child,m.child=null;K!==null;){if(d=K.alternate,d!==null&&gs(d)===null){m.child=K;break}d=K.sibling,K.sibling=_,_=K,K=d}X0(m,!0,_,null,J,M);break;case"together":X0(m,!1,null,null,void 0,M);break;default:m.memoizedState=null}return m.child}function ml(d,m,_){if(d!==null&&(m.dependencies=d.dependencies),su|=m.lanes,(_&m.childLanes)===0)if(d!==null){if(Po(d,m,_,!1),(_&m.childLanes)===0)return null}else return null;if(d!==null&&m.child!==d.child)throw Error(r(153));if(m.child!==null){for(d=m.child,_=Js(d,d.pendingProps),m.child=_,_.return=m;d.sibling!==null;)d=d.sibling,_=_.sibling=Js(d,d.pendingProps),_.return=m;_.sibling=null}return m.child}function K0(d,m){return(d.lanes&m)!==0?!0:(d=d.dependencies,!!(d!==null&&jc(d)))}function zS(d,m,_){switch(m.tag){case 3:$(m,m.stateNode.containerInfo),Bo(m,Mi,d.memoizedState.cache),cl();break;case 27:case 5:Z(m);break;case 4:$(m,m.stateNode.containerInfo);break;case 10:Bo(m,m.type,m.memoizedProps.value);break;case 31:if(m.memoizedState!==null)return m.flags|=128,Fr(m),null;break;case 13:var M=m.memoizedState;if(M!==null)return M.dehydrated!==null?(Li(m),m.flags|=128,null):(_&m.child.childLanes)!==0?U2(d,m,_):(Li(m),d=ml(d,m,_),d!==null?d.sibling:null);Li(m);break;case 19:var K=(d.flags&128)!==0;if(M=(_&m.childLanes)!==0,M||(Po(d,m,_,!1),M=(_&m.childLanes)!==0),K){if(M)return $2(d,m,_);m.flags|=128}if(K=m.memoizedState,K!==null&&(K.rendering=null,K.tail=null,K.lastEffect=null),H(xr,xr.current),M)break;return null;case 22:return m.lanes=0,D2(d,m,_,m.pendingProps);case 24:Bo(m,Mi,d.memoizedState.cache)}return ml(d,m,_)}function V2(d,m,_){if(d!==null)if(d.memoizedProps!==m.pendingProps)Ji=!0;else{if(!K0(d,_)&&(m.flags&128)===0)return Ji=!1,zS(d,m,_);Ji=(d.flags&131072)!==0}else Ji=!1,fr&&(m.flags&1048576)!==0&&gd(m,qu,m.index);switch(m.lanes=0,m.tag){case 16:t:{var M=m.pendingProps;if(d=te(m.elementType),m.type=d,typeof d=="function")kc(d)?(M=Wu(d,M),m.tag=1,m=z2(null,m,d,M,_)):(m.tag=0,m=H0(null,m,d,M,_));else{if(d!=null){var K=d.$$typeof;if(K===N){m.tag=11,m=O2(null,m,d,M,_);break t}else if(K===G){m.tag=14,m=R2(null,m,d,M,_);break t}}throw m=L(d)||d,Error(r(306,m,""))}}return m;case 0:return H0(d,m,m.type,m.pendingProps,_);case 1:return M=m.type,K=Wu(M,m.pendingProps),z2(d,m,M,K,_);case 3:t:{if($(m,m.stateNode.containerInfo),d===null)throw Error(r(387));M=m.pendingProps;var J=m.memoizedState;K=J.element,mi(d,m),Ri(m,M,null,_);var pt=m.memoizedState;if(M=pt.cache,Bo(m,Mi,M),M!==J.cache&&fl(m,[Mi],_,!0),Jr(),M=pt.element,J.isDehydrated)if(J={element:M,isDehydrated:!1,cache:pt.cache},m.updateQueue.baseState=J,m.memoizedState=J,m.flags&256){m=q2(d,m,M,_);break t}else if(M!==K){K=ta(Error(r(424)),m),Kl(K),m=q2(d,m,M,_);break t}else{switch(d=m.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(si=qa(d.firstChild),as=m,fr=!0,Ss=null,_i=!0,_=Vn(m,null,M,_),m.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling}else{if(cl(),M===K){m=ml(d,m,_);break t}ks(d,m,M,_)}m=m.child}return m;case 26:return Nd(d,m),d===null?(_=nv(m.type,null,m.pendingProps,null))?m.memoizedState=_:fr||(_=m.type,d=m.pendingProps,M=Vd(V.current).createElement(_),M[Ue]=m,M[He]=d,As(M,_,d),Gt(M),m.stateNode=M):m.memoizedState=nv(m.type,d.memoizedProps,m.pendingProps,d.memoizedState),null;case 27:return Z(m),d===null&&fr&&(M=m.stateNode=Jy(m.type,m.pendingProps,V.current),as=m,_i=!0,K=si,cu(m.type)?(Tm=K,si=qa(M.firstChild)):si=K),ks(d,m,m.pendingProps.children,_),Nd(d,m),d===null&&(m.flags|=4194304),m.child;case 5:return d===null&&fr&&((K=M=si)&&(M=g_(M,m.type,m.pendingProps,_i),M!==null?(m.stateNode=M,as=m,si=qa(M.firstChild),_i=!1,K=!0):K=!1),K||Io(m)),Z(m),K=m.type,J=m.pendingProps,pt=d!==null?d.memoizedProps:null,M=J.children,km(K,J)?M=null:pt!==null&&km(K,pt)&&(m.flags|=32),m.memoizedState!==null&&(K=Uf(d,m,M0,null,null,_),hh._currentValue=K),Nd(d,m),ks(d,m,M,_),m.child;case 6:return d===null&&fr&&((d=_=si)&&(_=b_(_,m.pendingProps,_i),_!==null?(m.stateNode=_,as=m,si=null,d=!0):d=!1),d||Io(m)),null;case 13:return U2(d,m,_);case 4:return $(m,m.stateNode.containerInfo),M=m.pendingProps,d===null?m.child=ai(m,null,M,_):ks(d,m,M,_),m.child;case 11:return O2(d,m,m.type,m.pendingProps,_);case 7:return ks(d,m,m.pendingProps,_),m.child;case 8:return ks(d,m,m.pendingProps.children,_),m.child;case 12:return ks(d,m,m.pendingProps.children,_),m.child;case 10:return M=m.pendingProps,Bo(m,m.type,M.value),ks(d,m,M.children,_),m.child;case 9:return K=m.type._context,M=m.pendingProps.children,Fo(m),K=ls(K),M=M(K),m.flags|=1,ks(d,m,M,_),m.child;case 14:return R2(d,m,m.type,m.pendingProps,_);case 15:return I2(d,m,m.type,m.pendingProps,_);case 19:return $2(d,m,_);case 31:return FS(d,m,_);case 22:return D2(d,m,_,m.pendingProps);case 24:return Fo(m),M=ls(Mi),d===null?(K=Ct(),K===null&&(K=oi,J=Ql(),K.pooledCache=J,J.refCount++,J!==null&&(K.pooledCacheLanes|=_),K=J),m.memoizedState={parent:M,cache:K},We(m),Bo(m,Mi,K)):((d.lanes&_)!==0&&(mi(d,m),Ri(m,null,null,_),Jr()),K=d.memoizedState,J=m.memoizedState,K.parent!==M?(K={parent:M,cache:M},m.memoizedState=K,m.lanes===0&&(m.memoizedState=m.updateQueue.baseState=K),Bo(m,Mi,M)):(M=J.cache,Bo(m,Mi,M),M!==K.cache&&fl(m,[Mi],_,!0))),ks(d,m,m.pendingProps.children,_),m.child;case 29:throw m.pendingProps}throw Error(r(156,m.tag))}function gl(d){d.flags|=4}function Z0(d,m,_,M,K){if((m=(d.mode&32)!==0)&&(m=!1),m){if(d.flags|=16777216,(K&335544128)===K)if(d.stateNode.complete)d.flags|=8192;else if(yy())d.flags|=8192;else throw me=Wt,ee}else d.flags&=-16777217}function W2(d,m){if(m.type!=="stylesheet"||(m.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!ov(m))if(yy())d.flags|=8192;else throw me=Wt,ee}function jd(d,m){m!==null&&(d.flags|=4),d.flags&16384&&(m=d.tag!==22?Sn():536870912,d.lanes|=m,Vc|=m)}function Qf(d,m){if(!fr)switch(d.tailMode){case"hidden":m=d.tail;for(var _=null;m!==null;)m.alternate!==null&&(_=m),m=m.sibling;_===null?d.tail=null:_.sibling=null;break;case"collapsed":_=d.tail;for(var M=null;_!==null;)_.alternate!==null&&(M=_),_=_.sibling;M===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:M.sibling=null}}function yi(d){var m=d.alternate!==null&&d.alternate.child===d.child,_=0,M=0;if(m)for(var K=d.child;K!==null;)_|=K.lanes|K.childLanes,M|=K.subtreeFlags&65011712,M|=K.flags&65011712,K.return=d,K=K.sibling;else for(K=d.child;K!==null;)_|=K.lanes|K.childLanes,M|=K.subtreeFlags,M|=K.flags,K.return=d,K=K.sibling;return d.subtreeFlags|=M,d.childLanes=_,m}function qS(d,m,_){var M=m.pendingProps;switch(Nc(m),m.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yi(m),null;case 1:return yi(m),null;case 3:return _=m.stateNode,M=null,d!==null&&(M=d.memoizedState.cache),m.memoizedState.cache!==M&&(m.flags|=2048),sa(Mi),z(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(d===null||d.child===null)&&(os(m)?gl(m):d===null||d.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,zf())),yi(m),null;case 26:var K=m.type,J=m.memoizedState;return d===null?(gl(m),J!==null?(yi(m),W2(m,J)):(yi(m),Z0(m,K,null,M,_))):J?J!==d.memoizedState?(gl(m),yi(m),W2(m,J)):(yi(m),m.flags&=-16777217):(d=d.memoizedProps,d!==M&&gl(m),yi(m),Z0(m,K,d,M,_)),null;case 27:if(it(m),_=V.current,K=m.type,d!==null&&m.stateNode!=null)d.memoizedProps!==M&&gl(m);else{if(!M){if(m.stateNode===null)throw Error(r(166));return yi(m),null}d=X.current,os(m)?Ff(m):(d=Jy(K,M,_),m.stateNode=d,gl(m))}return yi(m),null;case 5:if(it(m),K=m.type,d!==null&&m.stateNode!=null)d.memoizedProps!==M&&gl(m);else{if(!M){if(m.stateNode===null)throw Error(r(166));return yi(m),null}if(J=X.current,os(m))Ff(m);else{var pt=Vd(V.current);switch(J){case 1:J=pt.createElementNS("http://www.w3.org/2000/svg",K);break;case 2:J=pt.createElementNS("http://www.w3.org/1998/Math/MathML",K);break;default:switch(K){case"svg":J=pt.createElementNS("http://www.w3.org/2000/svg",K);break;case"math":J=pt.createElementNS("http://www.w3.org/1998/Math/MathML",K);break;case"script":J=pt.createElement("div"),J.innerHTML="<script><\/script>",J=J.removeChild(J.firstChild);break;case"select":J=typeof M.is=="string"?pt.createElement("select",{is:M.is}):pt.createElement("select"),M.multiple?J.multiple=!0:M.size&&(J.size=M.size);break;default:J=typeof M.is=="string"?pt.createElement(K,{is:M.is}):pt.createElement(K)}}J[Ue]=m,J[He]=M;t:for(pt=m.child;pt!==null;){if(pt.tag===5||pt.tag===6)J.appendChild(pt.stateNode);else if(pt.tag!==4&&pt.tag!==27&&pt.child!==null){pt.child.return=pt,pt=pt.child;continue}if(pt===m)break t;for(;pt.sibling===null;){if(pt.return===null||pt.return===m)break t;pt=pt.return}pt.sibling.return=pt.return,pt=pt.sibling}m.stateNode=J;t:switch(As(J,K,M),K){case"button":case"input":case"select":case"textarea":M=!!M.autoFocus;break t;case"img":M=!0;break t;default:M=!1}M&&gl(m)}}return yi(m),Z0(m,m.type,d===null?null:d.memoizedProps,m.pendingProps,_),null;case 6:if(d&&m.stateNode!=null)d.memoizedProps!==M&&gl(m);else{if(typeof M!="string"&&m.stateNode===null)throw Error(r(166));if(d=V.current,os(m)){if(d=m.stateNode,_=m.memoizedProps,M=null,K=as,K!==null)switch(K.tag){case 27:case 5:M=K.memoizedProps}d[Ue]=m,d=!!(d.nodeValue===_||M!==null&&M.suppressHydrationWarning===!0||Uy(d.nodeValue,_)),d||Io(m,!0)}else d=Vd(d).createTextNode(M),d[Ue]=m,m.stateNode=d}return yi(m),null;case 31:if(_=m.memoizedState,d===null||d.memoizedState!==null){if(M=os(m),_!==null){if(d===null){if(!M)throw Error(r(318));if(d=m.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(557));d[Ue]=m}else cl(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;yi(m),d=!1}else _=zf(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=_),d=!0;if(!d)return m.flags&256?(Vr(m),m):(Vr(m),null);if((m.flags&128)!==0)throw Error(r(558))}return yi(m),null;case 13:if(M=m.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(K=os(m),M!==null&&M.dehydrated!==null){if(d===null){if(!K)throw Error(r(318));if(K=m.memoizedState,K=K!==null?K.dehydrated:null,!K)throw Error(r(317));K[Ue]=m}else cl(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;yi(m),K=!1}else K=zf(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=K),K=!0;if(!K)return m.flags&256?(Vr(m),m):(Vr(m),null)}return Vr(m),(m.flags&128)!==0?(m.lanes=_,m):(_=M!==null,d=d!==null&&d.memoizedState!==null,_&&(M=m.child,K=null,M.alternate!==null&&M.alternate.memoizedState!==null&&M.alternate.memoizedState.cachePool!==null&&(K=M.alternate.memoizedState.cachePool.pool),J=null,M.memoizedState!==null&&M.memoizedState.cachePool!==null&&(J=M.memoizedState.cachePool.pool),J!==K&&(M.flags|=2048)),_!==d&&_&&(m.child.flags|=8192),jd(m,m.updateQueue),yi(m),null);case 4:return z(),d===null&&vm(m.stateNode.containerInfo),yi(m),null;case 10:return sa(m.type),yi(m),null;case 19:if(O(xr),M=m.memoizedState,M===null)return yi(m),null;if(K=(m.flags&128)!==0,J=M.rendering,J===null)if(K)Qf(M,!1);else{if(Fi!==0||d!==null&&(d.flags&128)!==0)for(d=m.child;d!==null;){if(J=gs(d),J!==null){for(m.flags|=128,Qf(M,!1),d=J.updateQueue,m.updateQueue=d,jd(m,d),m.subtreeFlags=0,d=_,_=m.child;_!==null;)Fu(_,d),_=_.sibling;return H(xr,xr.current&1|2),fr&&$s(m,M.treeForkCount),m.child}d=d.sibling}M.tail!==null&&Mt()>Id&&(m.flags|=128,K=!0,Qf(M,!1),m.lanes=4194304)}else{if(!K)if(d=gs(J),d!==null){if(m.flags|=128,K=!0,d=d.updateQueue,m.updateQueue=d,jd(m,d),Qf(M,!0),M.tail===null&&M.tailMode==="hidden"&&!J.alternate&&!fr)return yi(m),null}else 2*Mt()-M.renderingStartTime>Id&&_!==536870912&&(m.flags|=128,K=!0,Qf(M,!1),m.lanes=4194304);M.isBackwards?(J.sibling=m.child,m.child=J):(d=M.last,d!==null?d.sibling=J:m.child=J,M.last=J)}return M.tail!==null?(d=M.tail,M.rendering=d,M.tail=d.sibling,M.renderingStartTime=Mt(),d.sibling=null,_=xr.current,H(xr,K?_&1|2:_&1),fr&&$s(m,M.treeForkCount),d):(yi(m),null);case 22:case 23:return Vr(m),$i(),M=m.memoizedState!==null,d!==null?d.memoizedState!==null!==M&&(m.flags|=8192):M&&(m.flags|=8192),M?(_&536870912)!==0&&(m.flags&128)===0&&(yi(m),m.subtreeFlags&6&&(m.flags|=8192)):yi(m),_=m.updateQueue,_!==null&&jd(m,_.retryQueue),_=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),M=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(M=m.memoizedState.cachePool.pool),M!==_&&(m.flags|=2048),d!==null&&O(St),null;case 24:return _=null,d!==null&&(_=d.memoizedState.cache),m.memoizedState.cache!==_&&(m.flags|=2048),sa(Mi),yi(m),null;case 25:return null;case 30:return null}throw Error(r(156,m.tag))}function US(d,m){switch(Nc(m),m.tag){case 1:return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return sa(Mi),z(),d=m.flags,(d&65536)!==0&&(d&128)===0?(m.flags=d&-65537|128,m):null;case 26:case 27:case 5:return it(m),null;case 31:if(m.memoizedState!==null){if(Vr(m),m.alternate===null)throw Error(r(340));cl()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 13:if(Vr(m),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(r(340));cl()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return O(xr),null;case 4:return z(),null;case 10:return sa(m.type),null;case 22:case 23:return Vr(m),$i(),d!==null&&O(St),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 24:return sa(Mi),null;case 25:return null;default:return null}}function G2(d,m){switch(Nc(m),m.tag){case 3:sa(Mi),z();break;case 26:case 27:case 5:it(m);break;case 4:z();break;case 31:m.memoizedState!==null&&Vr(m);break;case 13:Vr(m);break;case 19:O(xr);break;case 10:sa(m.type);break;case 22:case 23:Vr(m),$i(),d!==null&&O(St);break;case 24:sa(Mi)}}function Jf(d,m){try{var _=m.updateQueue,M=_!==null?_.lastEffect:null;if(M!==null){var K=M.next;_=K;do{if((_.tag&d)===d){M=void 0;var J=_.create,pt=_.inst;M=J(),pt.destroy=M}_=_.next}while(_!==K)}}catch(kt){Gr(m,m.return,kt)}}function ru(d,m,_){try{var M=m.updateQueue,K=M!==null?M.lastEffect:null;if(K!==null){var J=K.next;M=J;do{if((M.tag&d)===d){var pt=M.inst,kt=pt.destroy;if(kt!==void 0){pt.destroy=void 0,K=m;var Pt=_,se=kt;try{se()}catch(ve){Gr(K,Pt,ve)}}}M=M.next}while(M!==J)}}catch(ve){Gr(m,m.return,ve)}}function Y2(d){var m=d.updateQueue;if(m!==null){var _=d.stateNode;try{Ii(m,_)}catch(M){Gr(d,d.return,M)}}}function X2(d,m,_){_.props=Wu(d.type,d.memoizedProps),_.state=d.memoizedState;try{_.componentWillUnmount()}catch(M){Gr(d,m,M)}}function th(d,m){try{var _=d.ref;if(_!==null){switch(d.tag){case 26:case 27:case 5:var M=d.stateNode;break;case 30:M=d.stateNode;break;default:M=d.stateNode}typeof _=="function"?d.refCleanup=_(M):_.current=M}}catch(K){Gr(d,m,K)}}function $o(d,m){var _=d.ref,M=d.refCleanup;if(_!==null)if(typeof M=="function")try{M()}catch(K){Gr(d,m,K)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(K){Gr(d,m,K)}else _.current=null}function K2(d){var m=d.type,_=d.memoizedProps,M=d.stateNode;try{t:switch(m){case"button":case"input":case"select":case"textarea":_.autoFocus&&M.focus();break t;case"img":_.src?M.src=_.src:_.srcSet&&(M.srcset=_.srcSet)}}catch(K){Gr(d,d.return,K)}}function Q0(d,m,_){try{var M=d.stateNode;c_(M,d.type,_,m),M[He]=m}catch(K){Gr(d,d.return,K)}}function Z2(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&cu(d.type)||d.tag===4}function J0(d){t:for(;;){for(;d.sibling===null;){if(d.return===null||Z2(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&cu(d.type)||d.flags&2||d.child===null||d.tag===4)continue t;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function tm(d,m,_){var M=d.tag;if(M===5||M===6)d=d.stateNode,m?(_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_).insertBefore(d,m):(m=_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_,m.appendChild(d),_=_._reactRootContainer,_!=null||m.onclick!==null||(m.onclick=hi));else if(M!==4&&(M===27&&cu(d.type)&&(_=d.stateNode,m=null),d=d.child,d!==null))for(tm(d,m,_),d=d.sibling;d!==null;)tm(d,m,_),d=d.sibling}function Md(d,m,_){var M=d.tag;if(M===5||M===6)d=d.stateNode,m?_.insertBefore(d,m):_.appendChild(d);else if(M!==4&&(M===27&&cu(d.type)&&(_=d.stateNode),d=d.child,d!==null))for(Md(d,m,_),d=d.sibling;d!==null;)Md(d,m,_),d=d.sibling}function Q2(d){var m=d.stateNode,_=d.memoizedProps;try{for(var M=d.type,K=m.attributes;K.length;)m.removeAttributeNode(K[0]);As(m,M,_),m[Ue]=d,m[He]=_}catch(J){Gr(d,d.return,J)}}var bl=!1,ts=!1,em=!1,J2=typeof WeakSet=="function"?WeakSet:Set,bs=null;function HS(d,m){if(d=d.containerInfo,Sm=Qd,d=io(d),Da(d)){if("selectionStart"in d)var _={start:d.selectionStart,end:d.selectionEnd};else t:{_=(_=d.ownerDocument)&&_.defaultView||window;var M=_.getSelection&&_.getSelection();if(M&&M.rangeCount!==0){_=M.anchorNode;var K=M.anchorOffset,J=M.focusNode;M=M.focusOffset;try{_.nodeType,J.nodeType}catch{_=null;break t}var pt=0,kt=-1,Pt=-1,se=0,ve=0,je=d,oe=null;e:for(;;){for(var he;je!==_||K!==0&&je.nodeType!==3||(kt=pt+K),je!==J||M!==0&&je.nodeType!==3||(Pt=pt+M),je.nodeType===3&&(pt+=je.nodeValue.length),(he=je.firstChild)!==null;)oe=je,je=he;for(;;){if(je===d)break e;if(oe===_&&++se===K&&(kt=pt),oe===J&&++ve===M&&(Pt=pt),(he=je.nextSibling)!==null)break;je=oe,oe=je.parentNode}je=he}_=kt===-1||Pt===-1?null:{start:kt,end:Pt}}else _=null}_=_||{start:0,end:0}}else _=null;for(_m={focusedElem:d,selectionRange:_},Qd=!1,bs=m;bs!==null;)if(m=bs,d=m.child,(m.subtreeFlags&1028)!==0&&d!==null)d.return=m,bs=d;else for(;bs!==null;){switch(m=bs,J=m.alternate,d=m.flags,m.tag){case 0:if((d&4)!==0&&(d=m.updateQueue,d=d!==null?d.events:null,d!==null))for(_=0;_<d.length;_++)K=d[_],K.ref.impl=K.nextImpl;break;case 11:case 15:break;case 1:if((d&1024)!==0&&J!==null){d=void 0,_=m,K=J.memoizedProps,J=J.memoizedState,M=_.stateNode;try{var cn=Wu(_.type,K);d=M.getSnapshotBeforeUpdate(cn,J),M.__reactInternalSnapshotBeforeUpdate=d}catch(Rn){Gr(_,_.return,Rn)}}break;case 3:if((d&1024)!==0){if(d=m.stateNode.containerInfo,_=d.nodeType,_===9)Cm(d);else if(_===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":Cm(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(r(163))}if(d=m.sibling,d!==null){d.return=m.return,bs=d;break}bs=m.return}}function ty(d,m,_){var M=_.flags;switch(_.tag){case 0:case 11:case 15:vl(d,_),M&4&&Jf(5,_);break;case 1:if(vl(d,_),M&4)if(d=_.stateNode,m===null)try{d.componentDidMount()}catch(pt){Gr(_,_.return,pt)}else{var K=Wu(_.type,m.memoizedProps);m=m.memoizedState;try{d.componentDidUpdate(K,m,d.__reactInternalSnapshotBeforeUpdate)}catch(pt){Gr(_,_.return,pt)}}M&64&&Y2(_),M&512&&th(_,_.return);break;case 3:if(vl(d,_),M&64&&(d=_.updateQueue,d!==null)){if(m=null,_.child!==null)switch(_.child.tag){case 27:case 5:m=_.child.stateNode;break;case 1:m=_.child.stateNode}try{Ii(d,m)}catch(pt){Gr(_,_.return,pt)}}break;case 27:m===null&&M&4&&Q2(_);case 26:case 5:vl(d,_),m===null&&M&4&&K2(_),M&512&&th(_,_.return);break;case 12:vl(d,_);break;case 31:vl(d,_),M&4&&ry(d,_);break;case 13:vl(d,_),M&4&&iy(d,_),M&64&&(d=_.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(_=QS.bind(null,_),y_(d,_))));break;case 22:if(M=_.memoizedState!==null||bl,!M){m=m!==null&&m.memoizedState!==null||ts,K=bl;var J=ts;bl=M,(ts=m)&&!J?wl(d,_,(_.subtreeFlags&8772)!==0):vl(d,_),bl=K,ts=J}break;case 30:break;default:vl(d,_)}}function ey(d){var m=d.alternate;m!==null&&(d.alternate=null,ey(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&de(m)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Ci=null,oa=!1;function yl(d,m,_){for(_=_.child;_!==null;)ny(d,m,_),_=_.sibling}function ny(d,m,_){if(Jt&&typeof Jt.onCommitFiberUnmount=="function")try{Jt.onCommitFiberUnmount(le,_)}catch{}switch(_.tag){case 26:ts||$o(_,m),yl(d,m,_),_.memoizedState?_.memoizedState.count--:_.stateNode&&(_=_.stateNode,_.parentNode.removeChild(_));break;case 27:ts||$o(_,m);var M=Ci,K=oa;cu(_.type)&&(Ci=_.stateNode,oa=!1),yl(d,m,_),uh(_.stateNode),Ci=M,oa=K;break;case 5:ts||$o(_,m);case 6:if(M=Ci,K=oa,Ci=null,yl(d,m,_),Ci=M,oa=K,Ci!==null)if(oa)try{(Ci.nodeType===9?Ci.body:Ci.nodeName==="HTML"?Ci.ownerDocument.body:Ci).removeChild(_.stateNode)}catch(J){Gr(_,m,J)}else try{Ci.removeChild(_.stateNode)}catch(J){Gr(_,m,J)}break;case 18:Ci!==null&&(oa?(d=Ci,Yy(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,_.stateNode),Jc(d)):Yy(Ci,_.stateNode));break;case 4:M=Ci,K=oa,Ci=_.stateNode.containerInfo,oa=!0,yl(d,m,_),Ci=M,oa=K;break;case 0:case 11:case 14:case 15:ru(2,_,m),ts||ru(4,_,m),yl(d,m,_);break;case 1:ts||($o(_,m),M=_.stateNode,typeof M.componentWillUnmount=="function"&&X2(_,m,M)),yl(d,m,_);break;case 21:yl(d,m,_);break;case 22:ts=(M=ts)||_.memoizedState!==null,yl(d,m,_),ts=M;break;default:yl(d,m,_)}}function ry(d,m){if(m.memoizedState===null&&(d=m.alternate,d!==null&&(d=d.memoizedState,d!==null))){d=d.dehydrated;try{Jc(d)}catch(_){Gr(m,m.return,_)}}}function iy(d,m){if(m.memoizedState===null&&(d=m.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{Jc(d)}catch(_){Gr(m,m.return,_)}}function $S(d){switch(d.tag){case 31:case 13:case 19:var m=d.stateNode;return m===null&&(m=d.stateNode=new J2),m;case 22:return d=d.stateNode,m=d._retryCache,m===null&&(m=d._retryCache=new J2),m;default:throw Error(r(435,d.tag))}}function Ld(d,m){var _=$S(d);m.forEach(function(M){if(!_.has(M)){_.add(M);var K=JS.bind(null,d,M);M.then(K,K)}})}function la(d,m){var _=m.deletions;if(_!==null)for(var M=0;M<_.length;M++){var K=_[M],J=d,pt=m,kt=pt;t:for(;kt!==null;){switch(kt.tag){case 27:if(cu(kt.type)){Ci=kt.stateNode,oa=!1;break t}break;case 5:Ci=kt.stateNode,oa=!1;break t;case 3:case 4:Ci=kt.stateNode.containerInfo,oa=!0;break t}kt=kt.return}if(Ci===null)throw Error(r(160));ny(J,pt,K),Ci=null,oa=!1,J=K.alternate,J!==null&&(J.return=null),K.return=null}if(m.subtreeFlags&13886)for(m=m.child;m!==null;)sy(m,d),m=m.sibling}var ho=null;function sy(d,m){var _=d.alternate,M=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:la(m,d),ua(d),M&4&&(ru(3,d,d.return),Jf(3,d),ru(5,d,d.return));break;case 1:la(m,d),ua(d),M&512&&(ts||_===null||$o(_,_.return)),M&64&&bl&&(d=d.updateQueue,d!==null&&(M=d.callbacks,M!==null&&(_=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=_===null?M:_.concat(M))));break;case 26:var K=ho;if(la(m,d),ua(d),M&512&&(ts||_===null||$o(_,_.return)),M&4){var J=_!==null?_.memoizedState:null;if(M=d.memoizedState,_===null)if(M===null)if(d.stateNode===null){t:{M=d.type,_=d.memoizedProps,K=K.ownerDocument||K;e:switch(M){case"title":J=K.getElementsByTagName("title")[0],(!J||J[Qt]||J[Ue]||J.namespaceURI==="http://www.w3.org/2000/svg"||J.hasAttribute("itemprop"))&&(J=K.createElement(M),K.head.insertBefore(J,K.querySelector("head > title"))),As(J,M,_),J[Ue]=d,Gt(J),M=J;break t;case"link":var pt=sv("link","href",K).get(M+(_.href||""));if(pt){for(var kt=0;kt<pt.length;kt++)if(J=pt[kt],J.getAttribute("href")===(_.href==null||_.href===""?null:_.href)&&J.getAttribute("rel")===(_.rel==null?null:_.rel)&&J.getAttribute("title")===(_.title==null?null:_.title)&&J.getAttribute("crossorigin")===(_.crossOrigin==null?null:_.crossOrigin)){pt.splice(kt,1);break e}}J=K.createElement(M),As(J,M,_),K.head.appendChild(J);break;case"meta":if(pt=sv("meta","content",K).get(M+(_.content||""))){for(kt=0;kt<pt.length;kt++)if(J=pt[kt],J.getAttribute("content")===(_.content==null?null:""+_.content)&&J.getAttribute("name")===(_.name==null?null:_.name)&&J.getAttribute("property")===(_.property==null?null:_.property)&&J.getAttribute("http-equiv")===(_.httpEquiv==null?null:_.httpEquiv)&&J.getAttribute("charset")===(_.charSet==null?null:_.charSet)){pt.splice(kt,1);break e}}J=K.createElement(M),As(J,M,_),K.head.appendChild(J);break;default:throw Error(r(468,M))}J[Ue]=d,Gt(J),M=J}d.stateNode=M}else av(K,d.type,d.stateNode);else d.stateNode=iv(K,M,d.memoizedProps);else J!==M?(J===null?_.stateNode!==null&&(_=_.stateNode,_.parentNode.removeChild(_)):J.count--,M===null?av(K,d.type,d.stateNode):iv(K,M,d.memoizedProps)):M===null&&d.stateNode!==null&&Q0(d,d.memoizedProps,_.memoizedProps)}break;case 27:la(m,d),ua(d),M&512&&(ts||_===null||$o(_,_.return)),_!==null&&M&4&&Q0(d,d.memoizedProps,_.memoizedProps);break;case 5:if(la(m,d),ua(d),M&512&&(ts||_===null||$o(_,_.return)),d.flags&32){K=d.stateNode;try{Zn(K,"")}catch(cn){Gr(d,d.return,cn)}}M&4&&d.stateNode!=null&&(K=d.memoizedProps,Q0(d,K,_!==null?_.memoizedProps:K)),M&1024&&(em=!0);break;case 6:if(la(m,d),ua(d),M&4){if(d.stateNode===null)throw Error(r(162));M=d.memoizedProps,_=d.stateNode;try{_.nodeValue=M}catch(cn){Gr(d,d.return,cn)}}break;case 3:if(Yd=null,K=ho,ho=Wd(m.containerInfo),la(m,d),ho=K,ua(d),M&4&&_!==null&&_.memoizedState.isDehydrated)try{Jc(m.containerInfo)}catch(cn){Gr(d,d.return,cn)}em&&(em=!1,ay(d));break;case 4:M=ho,ho=Wd(d.stateNode.containerInfo),la(m,d),ua(d),ho=M;break;case 12:la(m,d),ua(d);break;case 31:la(m,d),ua(d),M&4&&(M=d.updateQueue,M!==null&&(d.updateQueue=null,Ld(d,M)));break;case 13:la(m,d),ua(d),d.child.flags&8192&&d.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(Rd=Mt()),M&4&&(M=d.updateQueue,M!==null&&(d.updateQueue=null,Ld(d,M)));break;case 22:K=d.memoizedState!==null;var Pt=_!==null&&_.memoizedState!==null,se=bl,ve=ts;if(bl=se||K,ts=ve||Pt,la(m,d),ts=ve,bl=se,ua(d),M&8192)t:for(m=d.stateNode,m._visibility=K?m._visibility&-2:m._visibility|1,K&&(_===null||Pt||bl||ts||Gu(d)),_=null,m=d;;){if(m.tag===5||m.tag===26){if(_===null){Pt=_=m;try{if(J=Pt.stateNode,K)pt=J.style,typeof pt.setProperty=="function"?pt.setProperty("display","none","important"):pt.display="none";else{kt=Pt.stateNode;var je=Pt.memoizedProps.style,oe=je!=null&&je.hasOwnProperty("display")?je.display:null;kt.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(cn){Gr(Pt,Pt.return,cn)}}}else if(m.tag===6){if(_===null){Pt=m;try{Pt.stateNode.nodeValue=K?"":Pt.memoizedProps}catch(cn){Gr(Pt,Pt.return,cn)}}}else if(m.tag===18){if(_===null){Pt=m;try{var he=Pt.stateNode;K?Xy(he,!0):Xy(Pt.stateNode,!1)}catch(cn){Gr(Pt,Pt.return,cn)}}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===d)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break t;for(;m.sibling===null;){if(m.return===null||m.return===d)break t;_===m&&(_=null),m=m.return}_===m&&(_=null),m.sibling.return=m.return,m=m.sibling}M&4&&(M=d.updateQueue,M!==null&&(_=M.retryQueue,_!==null&&(M.retryQueue=null,Ld(d,_))));break;case 19:la(m,d),ua(d),M&4&&(M=d.updateQueue,M!==null&&(d.updateQueue=null,Ld(d,M)));break;case 30:break;case 21:break;default:la(m,d),ua(d)}}function ua(d){var m=d.flags;if(m&2){try{for(var _,M=d.return;M!==null;){if(Z2(M)){_=M;break}M=M.return}if(_==null)throw Error(r(160));switch(_.tag){case 27:var K=_.stateNode,J=J0(d);Md(d,J,K);break;case 5:var pt=_.stateNode;_.flags&32&&(Zn(pt,""),_.flags&=-33);var kt=J0(d);Md(d,kt,pt);break;case 3:case 4:var Pt=_.stateNode.containerInfo,se=J0(d);tm(d,se,Pt);break;default:throw Error(r(161))}}catch(ve){Gr(d,d.return,ve)}d.flags&=-3}m&4096&&(d.flags&=-4097)}function ay(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var m=d;ay(m),m.tag===5&&m.flags&1024&&m.stateNode.reset(),d=d.sibling}}function vl(d,m){if(m.subtreeFlags&8772)for(m=m.child;m!==null;)ty(d,m.alternate,m),m=m.sibling}function Gu(d){for(d=d.child;d!==null;){var m=d;switch(m.tag){case 0:case 11:case 14:case 15:ru(4,m,m.return),Gu(m);break;case 1:$o(m,m.return);var _=m.stateNode;typeof _.componentWillUnmount=="function"&&X2(m,m.return,_),Gu(m);break;case 27:uh(m.stateNode);case 26:case 5:$o(m,m.return),Gu(m);break;case 22:m.memoizedState===null&&Gu(m);break;case 30:Gu(m);break;default:Gu(m)}d=d.sibling}}function wl(d,m,_){for(_=_&&(m.subtreeFlags&8772)!==0,m=m.child;m!==null;){var M=m.alternate,K=d,J=m,pt=J.flags;switch(J.tag){case 0:case 11:case 15:wl(K,J,_),Jf(4,J);break;case 1:if(wl(K,J,_),M=J,K=M.stateNode,typeof K.componentDidMount=="function")try{K.componentDidMount()}catch(se){Gr(M,M.return,se)}if(M=J,K=M.updateQueue,K!==null){var kt=M.stateNode;try{var Pt=K.shared.hiddenCallbacks;if(Pt!==null)for(K.shared.hiddenCallbacks=null,K=0;K<Pt.length;K++)ms(Pt[K],kt)}catch(se){Gr(M,M.return,se)}}_&&pt&64&&Y2(J),th(J,J.return);break;case 27:Q2(J);case 26:case 5:wl(K,J,_),_&&M===null&&pt&4&&K2(J),th(J,J.return);break;case 12:wl(K,J,_);break;case 31:wl(K,J,_),_&&pt&4&&ry(K,J);break;case 13:wl(K,J,_),_&&pt&4&&iy(K,J);break;case 22:J.memoizedState===null&&wl(K,J,_),th(J,J.return);break;case 30:break;default:wl(K,J,_)}m=m.sibling}}function nm(d,m){var _=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),d=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(d=m.memoizedState.cachePool.pool),d!==_&&(d!=null&&d.refCount++,_!=null&&Uu(_))}function rm(d,m){d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&Uu(d))}function po(d,m,_,M){if(m.subtreeFlags&10256)for(m=m.child;m!==null;)oy(d,m,_,M),m=m.sibling}function oy(d,m,_,M){var K=m.flags;switch(m.tag){case 0:case 11:case 15:po(d,m,_,M),K&2048&&Jf(9,m);break;case 1:po(d,m,_,M);break;case 3:po(d,m,_,M),K&2048&&(d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&Uu(d)));break;case 12:if(K&2048){po(d,m,_,M),d=m.stateNode;try{var J=m.memoizedProps,pt=J.id,kt=J.onPostCommit;typeof kt=="function"&&kt(pt,m.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(Pt){Gr(m,m.return,Pt)}}else po(d,m,_,M);break;case 31:po(d,m,_,M);break;case 13:po(d,m,_,M);break;case 23:break;case 22:J=m.stateNode,pt=m.alternate,m.memoizedState!==null?J._visibility&2?po(d,m,_,M):eh(d,m):J._visibility&2?po(d,m,_,M):(J._visibility|=2,Uc(d,m,_,M,(m.subtreeFlags&10256)!==0||!1)),K&2048&&nm(pt,m);break;case 24:po(d,m,_,M),K&2048&&rm(m.alternate,m);break;default:po(d,m,_,M)}}function Uc(d,m,_,M,K){for(K=K&&((m.subtreeFlags&10256)!==0||!1),m=m.child;m!==null;){var J=d,pt=m,kt=_,Pt=M,se=pt.flags;switch(pt.tag){case 0:case 11:case 15:Uc(J,pt,kt,Pt,K),Jf(8,pt);break;case 23:break;case 22:var ve=pt.stateNode;pt.memoizedState!==null?ve._visibility&2?Uc(J,pt,kt,Pt,K):eh(J,pt):(ve._visibility|=2,Uc(J,pt,kt,Pt,K)),K&&se&2048&&nm(pt.alternate,pt);break;case 24:Uc(J,pt,kt,Pt,K),K&&se&2048&&rm(pt.alternate,pt);break;default:Uc(J,pt,kt,Pt,K)}m=m.sibling}}function eh(d,m){if(m.subtreeFlags&10256)for(m=m.child;m!==null;){var _=d,M=m,K=M.flags;switch(M.tag){case 22:eh(_,M),K&2048&&nm(M.alternate,M);break;case 24:eh(_,M),K&2048&&rm(M.alternate,M);break;default:eh(_,M)}m=m.sibling}}var nh=8192;function Hc(d,m,_){if(d.subtreeFlags&nh)for(d=d.child;d!==null;)ly(d,m,_),d=d.sibling}function ly(d,m,_){switch(d.tag){case 26:Hc(d,m,_),d.flags&nh&&d.memoizedState!==null&&j_(_,ho,d.memoizedState,d.memoizedProps);break;case 5:Hc(d,m,_);break;case 3:case 4:var M=ho;ho=Wd(d.stateNode.containerInfo),Hc(d,m,_),ho=M;break;case 22:d.memoizedState===null&&(M=d.alternate,M!==null&&M.memoizedState!==null?(M=nh,nh=16777216,Hc(d,m,_),nh=M):Hc(d,m,_));break;default:Hc(d,m,_)}}function uy(d){var m=d.alternate;if(m!==null&&(d=m.child,d!==null)){m.child=null;do m=d.sibling,d.sibling=null,d=m;while(d!==null)}}function rh(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var _=0;_<m.length;_++){var M=m[_];bs=M,fy(M,d)}uy(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)cy(d),d=d.sibling}function cy(d){switch(d.tag){case 0:case 11:case 15:rh(d),d.flags&2048&&ru(9,d,d.return);break;case 3:rh(d);break;case 12:rh(d);break;case 22:var m=d.stateNode;d.memoizedState!==null&&m._visibility&2&&(d.return===null||d.return.tag!==13)?(m._visibility&=-3,Od(d)):rh(d);break;default:rh(d)}}function Od(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var _=0;_<m.length;_++){var M=m[_];bs=M,fy(M,d)}uy(d)}for(d=d.child;d!==null;){switch(m=d,m.tag){case 0:case 11:case 15:ru(8,m,m.return),Od(m);break;case 22:_=m.stateNode,_._visibility&2&&(_._visibility&=-3,Od(m));break;default:Od(m)}d=d.sibling}}function fy(d,m){for(;bs!==null;){var _=bs;switch(_.tag){case 0:case 11:case 15:ru(8,_,m);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var M=_.memoizedState.cachePool.pool;M!=null&&M.refCount++}break;case 24:Uu(_.memoizedState.cache)}if(M=_.child,M!==null)M.return=_,bs=M;else t:for(_=d;bs!==null;){M=bs;var K=M.sibling,J=M.return;if(ey(M),M===_){bs=null;break t}if(K!==null){K.return=J,bs=K;break t}bs=J}}}var VS={getCacheForType:function(d){var m=ls(Mi),_=m.data.get(d);return _===void 0&&(_=d(),m.data.set(d,_)),_},cacheSignal:function(){return ls(Mi).controller.signal}},WS=typeof WeakMap=="function"?WeakMap:Map,zr=0,oi=null,hr=null,gr=0,Wr=0,xa=null,iu=!1,$c=!1,im=!1,xl=0,Fi=0,su=0,Yu=0,sm=0,Sa=0,Vc=0,ih=null,ca=null,am=!1,Rd=0,hy=0,Id=1/0,Dd=null,au=null,cs=0,ou=null,Wc=null,Sl=0,om=0,lm=null,dy=null,sh=0,um=null;function _a(){return(zr&2)!==0&&gr!==0?gr&-gr:x.T!==null?mm():we()}function py(){if(Sa===0)if((gr&536870912)===0||fr){var d=Je;Je<<=1,(Je&3932160)===0&&(Je=262144),Sa=d}else Sa=536870912;return d=bi.current,d!==null&&(d.flags|=32),Sa}function fa(d,m,_){(d===oi&&(Wr===2||Wr===9)||d.cancelPendingCommit!==null)&&(Gc(d,0),lu(d,gr,Sa,!1)),Te(d,_),((zr&2)===0||d!==oi)&&(d===oi&&((zr&2)===0&&(Yu|=_),Fi===4&&lu(d,gr,Sa,!1)),Vo(d))}function my(d,m,_){if((zr&6)!==0)throw Error(r(327));var M=!_&&(m&127)===0&&(m&d.expiredLanes)===0||En(d,m),K=M?XS(d,m):fm(d,m,!0),J=M;do{if(K===0){$c&&!M&&lu(d,m,0,!1);break}else{if(_=d.current.alternate,J&&!GS(_)){K=fm(d,m,!1),J=!1;continue}if(K===2){if(J=m,d.errorRecoveryDisabledLanes&J)var pt=0;else pt=d.pendingLanes&-536870913,pt=pt!==0?pt:pt&536870912?536870912:0;if(pt!==0){m=pt;t:{var kt=d;K=ih;var Pt=kt.current.memoizedState.isDehydrated;if(Pt&&(Gc(kt,pt).flags|=256),pt=fm(kt,pt,!1),pt!==2){if(im&&!Pt){kt.errorRecoveryDisabledLanes|=J,Yu|=J,K=4;break t}J=ca,ca=K,J!==null&&(ca===null?ca=J:ca.push.apply(ca,J))}K=pt}if(J=!1,K!==2)continue}}if(K===1){Gc(d,0),lu(d,m,0,!0);break}t:{switch(M=d,J=K,J){case 0:case 1:throw Error(r(345));case 4:if((m&4194048)!==m)break;case 6:lu(M,m,Sa,!iu);break t;case 2:ca=null;break;case 3:case 5:break;default:throw Error(r(329))}if((m&62914560)===m&&(K=Rd+300-Mt(),10<K)){if(lu(M,m,Sa,!iu),Ke(M,0,!0)!==0)break t;Sl=m,M.timeoutHandle=Wy(gy.bind(null,M,_,ca,Dd,am,m,Sa,Yu,Vc,iu,J,"Throttled",-0,0),K);break t}gy(M,_,ca,Dd,am,m,Sa,Yu,Vc,iu,J,null,-0,0)}}break}while(!0);Vo(d)}function gy(d,m,_,M,K,J,pt,kt,Pt,se,ve,je,oe,he){if(d.timeoutHandle=-1,je=m.subtreeFlags,je&8192||(je&16785408)===16785408){je={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hi},ly(m,J,je);var cn=(J&62914560)===J?Rd-Mt():(J&4194048)===J?hy-Mt():0;if(cn=M_(je,cn),cn!==null){Sl=J,d.cancelPendingCommit=cn(ky.bind(null,d,m,J,_,M,K,pt,kt,Pt,ve,je,null,oe,he)),lu(d,J,pt,!se);return}}ky(d,m,J,_,M,K,pt,kt,Pt)}function GS(d){for(var m=d;;){var _=m.tag;if((_===0||_===11||_===15)&&m.flags&16384&&(_=m.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var M=0;M<_.length;M++){var K=_[M],J=K.getSnapshot;K=K.value;try{if(!is(J(),K))return!1}catch{return!1}}if(_=m.child,m.subtreeFlags&16384&&_!==null)_.return=m,m=_;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function lu(d,m,_,M){m&=~sm,m&=~Yu,d.suspendedLanes|=m,d.pingedLanes&=~m,M&&(d.warmLanes|=m),M=d.expirationTimes;for(var K=m;0<K;){var J=31-ge(K),pt=1<<J;M[J]=-1,K&=~pt}_!==0&&Pn(d,_,m)}function Bd(){return(zr&6)===0?(ah(0),!1):!0}function cm(){if(hr!==null){if(Wr===0)var d=hr.return;else d=hr,Pa=Do=null,Ic(d),Le=null,hn=0,d=hr;for(;d!==null;)G2(d.alternate,d),d=d.return;hr=null}}function Gc(d,m){var _=d.timeoutHandle;_!==-1&&(d.timeoutHandle=-1,d_(_)),_=d.cancelPendingCommit,_!==null&&(d.cancelPendingCommit=null,_()),Sl=0,cm(),oi=d,hr=_=Js(d.current,null),gr=m,Wr=0,xa=null,iu=!1,$c=En(d,m),im=!1,Vc=Sa=sm=Yu=su=Fi=0,ca=ih=null,am=!1,(m&8)!==0&&(m|=m&32);var M=d.entangledLanes;if(M!==0)for(d=d.entanglements,M&=m;0<M;){var K=31-ge(M),J=1<<K;m|=d[K],M&=~J}return xl=m,Du(),_}function by(d,m){Cn=null,x.H=Kf,m===Ut||m===Ot?(m=_e(),Wr=3):m===ee?(m=_e(),Wr=4):Wr=m===U0?8:m!==null&&typeof m=="object"&&typeof m.then=="function"?6:1,xa=m,hr===null&&(Fi=1,Cd(d,ta(m,d.current)))}function yy(){var d=bi.current;return d===null?!0:(gr&4194048)===gr?kr===null:(gr&62914560)===gr||(gr&536870912)!==0?d===kr:!1}function vy(){var d=x.H;return x.H=Kf,d===null?Kf:d}function wy(){var d=x.A;return x.A=VS,d}function Pd(){Fi=4,iu||(gr&4194048)!==gr&&bi.current!==null||($c=!0),(su&134217727)===0&&(Yu&134217727)===0||oi===null||lu(oi,gr,Sa,!1)}function fm(d,m,_){var M=zr;zr|=2;var K=vy(),J=wy();(oi!==d||gr!==m)&&(Dd=null,Gc(d,m)),m=!1;var pt=Fi;t:do try{if(Wr!==0&&hr!==null){var kt=hr,Pt=xa;switch(Wr){case 8:cm(),pt=6;break t;case 3:case 2:case 9:case 6:bi.current===null&&(m=!0);var se=Wr;if(Wr=0,xa=null,Yc(d,kt,Pt,se),_&&$c){pt=0;break t}break;default:se=Wr,Wr=0,xa=null,Yc(d,kt,Pt,se)}}YS(),pt=Fi;break}catch(ve){by(d,ve)}while(!0);return m&&d.shellSuspendCounter++,Pa=Do=null,zr=M,x.H=K,x.A=J,hr===null&&(oi=null,gr=0,Du()),pt}function YS(){for(;hr!==null;)xy(hr)}function XS(d,m){var _=zr;zr|=2;var M=vy(),K=wy();oi!==d||gr!==m?(Dd=null,Id=Mt()+500,Gc(d,m)):$c=En(d,m);t:do try{if(Wr!==0&&hr!==null){m=hr;var J=xa;e:switch(Wr){case 1:Wr=0,xa=null,Yc(d,m,J,1);break;case 2:case 9:if(Zt(J)){Wr=0,xa=null,Sy(m);break}m=function(){Wr!==2&&Wr!==9||oi!==d||(Wr=7),Vo(d)},J.then(m,m);break t;case 3:Wr=7;break t;case 4:Wr=5;break t;case 7:Zt(J)?(Wr=0,xa=null,Sy(m)):(Wr=0,xa=null,Yc(d,m,J,7));break;case 5:var pt=null;switch(hr.tag){case 26:pt=hr.memoizedState;case 5:case 27:var kt=hr;if(pt?ov(pt):kt.stateNode.complete){Wr=0,xa=null;var Pt=kt.sibling;if(Pt!==null)hr=Pt;else{var se=kt.return;se!==null?(hr=se,Fd(se)):hr=null}break e}}Wr=0,xa=null,Yc(d,m,J,5);break;case 6:Wr=0,xa=null,Yc(d,m,J,6);break;case 8:cm(),Fi=6;break t;default:throw Error(r(462))}}KS();break}catch(ve){by(d,ve)}while(!0);return Pa=Do=null,x.H=M,x.A=K,zr=_,hr!==null?0:(oi=null,gr=0,Du(),Fi)}function KS(){for(;hr!==null&&!yt();)xy(hr)}function xy(d){var m=V2(d.alternate,d,xl);d.memoizedProps=d.pendingProps,m===null?Fd(d):hr=m}function Sy(d){var m=d,_=m.alternate;switch(m.tag){case 15:case 0:m=F2(_,m,m.pendingProps,m.type,void 0,gr);break;case 11:m=F2(_,m,m.pendingProps,m.type.render,m.ref,gr);break;case 5:Ic(m);default:G2(_,m),m=hr=Fu(m,xl),m=V2(_,m,xl)}d.memoizedProps=d.pendingProps,m===null?Fd(d):hr=m}function Yc(d,m,_,M){Pa=Do=null,Ic(m),Le=null,hn=0;var K=m.return;try{if(PS(d,K,m,_,gr)){Fi=1,Cd(d,ta(_,d.current)),hr=null;return}}catch(J){if(K!==null)throw hr=K,J;Fi=1,Cd(d,ta(_,d.current)),hr=null;return}m.flags&32768?(fr||M===1?d=!0:$c||(gr&536870912)!==0?d=!1:(iu=d=!0,(M===2||M===9||M===3||M===6)&&(M=bi.current,M!==null&&M.tag===13&&(M.flags|=16384))),_y(m,d)):Fd(m)}function Fd(d){var m=d;do{if((m.flags&32768)!==0){_y(m,iu);return}d=m.return;var _=qS(m.alternate,m,xl);if(_!==null){hr=_;return}if(m=m.sibling,m!==null){hr=m;return}hr=m=d}while(m!==null);Fi===0&&(Fi=5)}function _y(d,m){do{var _=US(d.alternate,d);if(_!==null){_.flags&=32767,hr=_;return}if(_=d.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!m&&(d=d.sibling,d!==null)){hr=d;return}hr=d=_}while(d!==null);Fi=6,hr=null}function ky(d,m,_,M,K,J,pt,kt,Pt){d.cancelPendingCommit=null;do zd();while(cs!==0);if((zr&6)!==0)throw Error(r(327));if(m!==null){if(m===d.current)throw Error(r(177));if(J=m.lanes|m.childLanes,J|=xc,_n(d,_,J,pt,kt,Pt),d===oi&&(hr=oi=null,gr=0),Wc=m,ou=d,Sl=_,om=J,lm=K,dy=M,(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,t_(Vt,function(){return Ty(),null})):(d.callbackNode=null,d.callbackPriority=0),M=(m.flags&13878)!==0,(m.subtreeFlags&13878)!==0||M){M=x.T,x.T=null,K=k.p,k.p=2,pt=zr,zr|=4;try{HS(d,m,_)}finally{zr=pt,k.p=K,x.T=M}}cs=1,Ay(),Cy(),Ey()}}function Ay(){if(cs===1){cs=0;var d=ou,m=Wc,_=(m.flags&13878)!==0;if((m.subtreeFlags&13878)!==0||_){_=x.T,x.T=null;var M=k.p;k.p=2;var K=zr;zr|=4;try{sy(m,d);var J=_m,pt=io(d.containerInfo),kt=J.focusedElem,Pt=J.selectionRange;if(pt!==kt&&kt&&kt.ownerDocument&&ro(kt.ownerDocument.documentElement,kt)){if(Pt!==null&&Da(kt)){var se=Pt.start,ve=Pt.end;if(ve===void 0&&(ve=se),"selectionStart"in kt)kt.selectionStart=se,kt.selectionEnd=Math.min(ve,kt.value.length);else{var je=kt.ownerDocument||document,oe=je&&je.defaultView||window;if(oe.getSelection){var he=oe.getSelection(),cn=kt.textContent.length,Rn=Math.min(Pt.start,cn),ni=Pt.end===void 0?Rn:Math.min(Pt.end,cn);!he.extend&&Rn>ni&&(pt=ni,ni=Rn,Rn=pt);var Xt=Wl(kt,Rn),$t=Wl(kt,ni);if(Xt&&$t&&(he.rangeCount!==1||he.anchorNode!==Xt.node||he.anchorOffset!==Xt.offset||he.focusNode!==$t.node||he.focusOffset!==$t.offset)){var ie=je.createRange();ie.setStart(Xt.node,Xt.offset),he.removeAllRanges(),Rn>ni?(he.addRange(ie),he.extend($t.node,$t.offset)):(ie.setEnd($t.node,$t.offset),he.addRange(ie))}}}}for(je=[],he=kt;he=he.parentNode;)he.nodeType===1&&je.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof kt.focus=="function"&&kt.focus(),kt=0;kt<je.length;kt++){var Ae=je[kt];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}Qd=!!Sm,_m=Sm=null}finally{zr=K,k.p=M,x.T=_}}d.current=m,cs=2}}function Cy(){if(cs===2){cs=0;var d=ou,m=Wc,_=(m.flags&8772)!==0;if((m.subtreeFlags&8772)!==0||_){_=x.T,x.T=null;var M=k.p;k.p=2;var K=zr;zr|=4;try{ty(d,m.alternate,m)}finally{zr=K,k.p=M,x.T=_}}cs=3}}function Ey(){if(cs===4||cs===3){cs=0,Et();var d=ou,m=Wc,_=Sl,M=dy;(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?cs=5:(cs=0,Wc=ou=null,Ny(d,d.pendingLanes));var K=d.pendingLanes;if(K===0&&(au=null),re(_),m=m.stateNode,Jt&&typeof Jt.onCommitFiberRoot=="function")try{Jt.onCommitFiberRoot(le,m,void 0,(m.current.flags&128)===128)}catch{}if(M!==null){m=x.T,K=k.p,k.p=2,x.T=null;try{for(var J=d.onRecoverableError,pt=0;pt<M.length;pt++){var kt=M[pt];J(kt.value,{componentStack:kt.stack})}}finally{x.T=m,k.p=K}}(Sl&3)!==0&&zd(),Vo(d),K=d.pendingLanes,(_&261930)!==0&&(K&42)!==0?d===um?sh++:(sh=0,um=d):sh=0,ah(0)}}function Ny(d,m){(d.pooledCacheLanes&=m)===0&&(m=d.pooledCache,m!=null&&(d.pooledCache=null,Uu(m)))}function zd(){return Ay(),Cy(),Ey(),Ty()}function Ty(){if(cs!==5)return!1;var d=ou,m=om;om=0;var _=re(Sl),M=x.T,K=k.p;try{k.p=32>_?32:_,x.T=null,_=lm,lm=null;var J=ou,pt=Sl;if(cs=0,Wc=ou=null,Sl=0,(zr&6)!==0)throw Error(r(331));var kt=zr;if(zr|=4,cy(J.current),oy(J,J.current,pt,_),zr=kt,ah(0,!1),Jt&&typeof Jt.onPostCommitFiberRoot=="function")try{Jt.onPostCommitFiberRoot(le,J)}catch{}return!0}finally{k.p=K,x.T=M,Ny(d,m)}}function jy(d,m,_){m=ta(_,m),m=q0(d.stateNode,m,2),d=Xn(d,m,2),d!==null&&(Te(d,2),Vo(d))}function Gr(d,m,_){if(d.tag===3)jy(d,d,_);else for(;m!==null;){if(m.tag===3){jy(m,d,_);break}else if(m.tag===1){var M=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(au===null||!au.has(M))){d=ta(_,d),_=M2(2),M=Xn(m,_,2),M!==null&&(L2(_,M,m,d),Te(M,2),Vo(M));break}}m=m.return}}function hm(d,m,_){var M=d.pingCache;if(M===null){M=d.pingCache=new WS;var K=new Set;M.set(m,K)}else K=M.get(m),K===void 0&&(K=new Set,M.set(m,K));K.has(_)||(im=!0,K.add(_),d=ZS.bind(null,d,m,_),m.then(d,d))}function ZS(d,m,_){var M=d.pingCache;M!==null&&M.delete(m),d.pingedLanes|=d.suspendedLanes&_,d.warmLanes&=~_,oi===d&&(gr&_)===_&&(Fi===4||Fi===3&&(gr&62914560)===gr&&300>Mt()-Rd?(zr&2)===0&&Gc(d,0):sm|=_,Vc===gr&&(Vc=0)),Vo(d)}function My(d,m){m===0&&(m=Sn()),d=ao(d,m),d!==null&&(Te(d,m),Vo(d))}function QS(d){var m=d.memoizedState,_=0;m!==null&&(_=m.retryLane),My(d,_)}function JS(d,m){var _=0;switch(d.tag){case 31:case 13:var M=d.stateNode,K=d.memoizedState;K!==null&&(_=K.retryLane);break;case 19:M=d.stateNode;break;case 22:M=d.stateNode._retryCache;break;default:throw Error(r(314))}M!==null&&M.delete(m),My(d,_)}function t_(d,m){return gt(d,m)}var qd=null,Xc=null,dm=!1,Ud=!1,pm=!1,uu=0;function Vo(d){d!==Xc&&d.next===null&&(Xc===null?qd=Xc=d:Xc=Xc.next=d),Ud=!0,dm||(dm=!0,n_())}function ah(d,m){if(!pm&&Ud){pm=!0;do for(var _=!1,M=qd;M!==null;){if(d!==0){var K=M.pendingLanes;if(K===0)var J=0;else{var pt=M.suspendedLanes,kt=M.pingedLanes;J=(1<<31-ge(42|d)+1)-1,J&=K&~(pt&~kt),J=J&201326741?J&201326741|1:J?J|2:0}J!==0&&(_=!0,Iy(M,J))}else J=gr,J=Ke(M,M===oi?J:0,M.cancelPendingCommit!==null||M.timeoutHandle!==-1),(J&3)===0||En(M,J)||(_=!0,Iy(M,J));M=M.next}while(_);pm=!1}}function e_(){Ly()}function Ly(){Ud=dm=!1;var d=0;uu!==0&&h_()&&(d=uu);for(var m=Mt(),_=null,M=qd;M!==null;){var K=M.next,J=Oy(M,m);J===0?(M.next=null,_===null?qd=K:_.next=K,K===null&&(Xc=_)):(_=M,(d!==0||(J&3)!==0)&&(Ud=!0)),M=K}cs!==0&&cs!==5||ah(d),uu!==0&&(uu=0)}function Oy(d,m){for(var _=d.suspendedLanes,M=d.pingedLanes,K=d.expirationTimes,J=d.pendingLanes&-62914561;0<J;){var pt=31-ge(J),kt=1<<pt,Pt=K[pt];Pt===-1?((kt&_)===0||(kt&M)!==0)&&(K[pt]=Xe(kt,m)):Pt<=m&&(d.expiredLanes|=kt),J&=~kt}if(m=oi,_=gr,_=Ke(d,d===m?_:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),M=d.callbackNode,_===0||d===m&&(Wr===2||Wr===9)||d.cancelPendingCommit!==null)return M!==null&&M!==null&&wt(M),d.callbackNode=null,d.callbackPriority=0;if((_&3)===0||En(d,_)){if(m=_&-_,m===d.callbackPriority)return m;switch(M!==null&&wt(M),re(_)){case 2:case 8:_=It;break;case 32:_=Vt;break;case 268435456:_=ne;break;default:_=Vt}return M=Ry.bind(null,d),_=gt(_,M),d.callbackPriority=m,d.callbackNode=_,m}return M!==null&&M!==null&&wt(M),d.callbackPriority=2,d.callbackNode=null,2}function Ry(d,m){if(cs!==0&&cs!==5)return d.callbackNode=null,d.callbackPriority=0,null;var _=d.callbackNode;if(zd()&&d.callbackNode!==_)return null;var M=gr;return M=Ke(d,d===oi?M:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),M===0?null:(my(d,M,m),Oy(d,Mt()),d.callbackNode!=null&&d.callbackNode===_?Ry.bind(null,d):null)}function Iy(d,m){if(zd())return null;my(d,m,!0)}function n_(){p_(function(){(zr&6)!==0?gt(Tt,e_):Ly()})}function mm(){if(uu===0){var d=Y;d===0&&(d=ke,ke<<=1,(ke&261888)===0&&(ke=256)),uu=d}return uu}function Dy(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:Br(""+d)}function By(d,m){var _=m.ownerDocument.createElement("input");return _.name=m.name,_.value=m.value,d.id&&_.setAttribute("form",d.id),m.parentNode.insertBefore(_,m),d=new FormData(d),_.parentNode.removeChild(_),d}function r_(d,m,_,M,K){if(m==="submit"&&_&&_.stateNode===K){var J=Dy((K[He]||null).action),pt=M.submitter;pt&&(m=(m=pt[He]||null)?Dy(m.formAction):pt.getAttribute("formAction"),m!==null&&(J=m,pt=null));var kt=new en("action","action",null,M,K);d.push({event:kt,listeners:[{instance:null,listener:function(){if(M.defaultPrevented){if(uu!==0){var Pt=pt?By(K,pt):new FormData(K);I0(_,{pending:!0,data:Pt,method:K.method,action:J},null,Pt)}}else typeof J=="function"&&(kt.preventDefault(),Pt=pt?By(K,pt):new FormData(K),I0(_,{pending:!0,data:Pt,method:K.method,action:J},J,Pt))},currentTarget:K}]})}}for(var gm=0;gm<ol.length;gm++){var bm=ol[gm],i_=bm.toLowerCase(),s_=bm[0].toUpperCase()+bm.slice(1);Qs(i_,"on"+s_)}Qs(al,"onAnimationEnd"),Qs(Ru,"onAnimationIteration"),Qs(If,"onAnimationStart"),Qs("dblclick","onDoubleClick"),Qs("focusin","onFocus"),Qs("focusout","onBlur"),Qs(dd,"onTransitionRun"),Qs(pd,"onTransitionStart"),Qs(md,"onTransitionCancel"),Qs(Df,"onTransitionEnd"),xe("onMouseEnter",["mouseout","mouseover"]),xe("onMouseLeave",["mouseout","mouseover"]),xe("onPointerEnter",["pointerout","pointerover"]),xe("onPointerLeave",["pointerout","pointerover"]),ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),a_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(oh));function Py(d,m){m=(m&4)!==0;for(var _=0;_<d.length;_++){var M=d[_],K=M.event;M=M.listeners;t:{var J=void 0;if(m)for(var pt=M.length-1;0<=pt;pt--){var kt=M[pt],Pt=kt.instance,se=kt.currentTarget;if(kt=kt.listener,Pt!==J&&K.isPropagationStopped())break t;J=kt,K.currentTarget=se;try{J(K)}catch(ve){Iu(ve)}K.currentTarget=null,J=Pt}else for(pt=0;pt<M.length;pt++){if(kt=M[pt],Pt=kt.instance,se=kt.currentTarget,kt=kt.listener,Pt!==J&&K.isPropagationStopped())break t;J=kt,K.currentTarget=se;try{J(K)}catch(ve){Iu(ve)}K.currentTarget=null,J=Pt}}}}function dr(d,m){var _=m[Ve];_===void 0&&(_=m[Ve]=new Set);var M=d+"__bubble";_.has(M)||(Fy(m,d,2,!1),_.add(M))}function ym(d,m,_){var M=0;m&&(M|=4),Fy(_,d,M,m)}var Hd="_reactListening"+Math.random().toString(36).slice(2);function vm(d){if(!d[Hd]){d[Hd]=!0,pe.forEach(function(_){_!=="selectionchange"&&(a_.has(_)||ym(_,!1,d),ym(_,!0,d))});var m=d.nodeType===9?d:d.ownerDocument;m===null||m[Hd]||(m[Hd]=!0,ym("selectionchange",!1,m))}}function Fy(d,m,_,M){switch(pv(m)){case 2:var K=R_;break;case 8:K=I_;break;default:K=Rm}_=K.bind(null,m,_,d),K=void 0,!Ta||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(K=!0),M?K!==void 0?d.addEventListener(m,_,{capture:!0,passive:K}):d.addEventListener(m,_,!0):K!==void 0?d.addEventListener(m,_,{passive:K}):d.addEventListener(m,_,!1)}function wm(d,m,_,M,K){var J=M;if((m&1)===0&&(m&2)===0&&M!==null)t:for(;;){if(M===null)return;var pt=M.tag;if(pt===3||pt===4){var kt=M.stateNode.containerInfo;if(kt===K)break;if(pt===4)for(pt=M.return;pt!==null;){var Pt=pt.tag;if((Pt===3||Pt===4)&&pt.stateNode.containerInfo===K)return;pt=pt.return}for(;kt!==null;){if(pt=Ee(kt),pt===null)return;if(Pt=pt.tag,Pt===5||Pt===6||Pt===26||Pt===27){M=J=pt;continue t}kt=kt.parentNode}}M=M.return}No(function(){var se=J,ve=ns(_),je=[];t:{var oe=Bf.get(d);if(oe!==void 0){var he=en,cn=d;switch(d){case"keypress":if(ut(_)===0)break t;case"keydown":case"keyup":he=vr;break;case"focusin":cn="focus",he=qi;break;case"focusout":cn="blur",he=qi;break;case"beforeblur":case"afterblur":he=qi;break;case"click":if(_.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=ii;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=$r;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=Ui;break;case al:case Ru:case If:he=nt;break;case Df:he=rs;break;case"scroll":case"scrollend":he=Qn;break;case"wheel":he=ma;break;case"copy":case"cut":case"paste":he=Lt;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=Ni;break;case"toggle":case"beforetoggle":he=Mu}var Rn=(m&4)!==0,ni=!Rn&&(d==="scroll"||d==="scrollend"),Xt=Rn?oe!==null?oe+"Capture":null:oe;Rn=[];for(var $t=se,ie;$t!==null;){var Ae=$t;if(ie=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||ie===null||Xt===null||(Ae=Yi($t,Xt),Ae!=null&&Rn.push(lh($t,Ae,ie))),ni)break;$t=$t.return}0<Rn.length&&(oe=new he(oe,cn,null,_,ve),je.push({event:oe,listeners:Rn}))}}if((m&7)===0){t:{if(oe=d==="mouseover"||d==="pointerover",he=d==="mouseout"||d==="pointerout",oe&&_!==Lr&&(cn=_.relatedTarget||_.fromElement)&&(Ee(cn)||cn[Ge]))break t;if((he||oe)&&(oe=ve.window===ve?ve:(oe=ve.ownerDocument)?oe.defaultView||oe.parentWindow:window,he?(cn=_.relatedTarget||_.toElement,he=se,cn=cn?Ee(cn):null,cn!==null&&(ni=s(cn),Rn=cn.tag,cn!==ni||Rn!==5&&Rn!==27&&Rn!==6)&&(cn=null)):(he=null,cn=se),he!==cn)){if(Rn=ii,Ae="onMouseLeave",Xt="onMouseEnter",$t="mouse",(d==="pointerout"||d==="pointerover")&&(Rn=Ni,Ae="onPointerLeave",Xt="onPointerEnter",$t="pointer"),ni=he==null?oe:_t(he),ie=cn==null?oe:_t(cn),oe=new Rn(Ae,$t+"leave",he,_,ve),oe.target=ni,oe.relatedTarget=ie,Ae=null,Ee(ve)===se&&(Rn=new Rn(Xt,$t+"enter",cn,_,ve),Rn.target=ie,Rn.relatedTarget=ni,Ae=Rn),ni=Ae,he&&cn)e:{for(Rn=o_,Xt=he,$t=cn,ie=0,Ae=Xt;Ae;Ae=Rn(Ae))ie++;Ae=0;for(var Mn=$t;Mn;Mn=Rn(Mn))Ae++;for(;0<ie-Ae;)Xt=Rn(Xt),ie--;for(;0<Ae-ie;)$t=Rn($t),Ae--;for(;ie--;){if(Xt===$t||$t!==null&&Xt===$t.alternate){Rn=Xt;break e}Xt=Rn(Xt),$t=Rn($t)}Rn=null}else Rn=null;he!==null&&zy(je,oe,he,Rn,!1),cn!==null&&ni!==null&&zy(je,ni,cn,Rn,!0)}}t:{if(oe=se?_t(se):window,he=oe.nodeName&&oe.nodeName.toLowerCase(),he==="select"||he==="input"&&oe.type==="file")var Or=Lo;else if(Lu(oe))if(Ns)Or=Ra;else{Or=Ti;var bn=$l}else he=oe.nodeName,!he||he.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?se&&Mr(se.elementType)&&(Or=Lo):Or=wc;if(Or&&(Or=Or(d,se))){qs(je,Or,_,ve);break t}bn&&bn(d,oe,se),d==="focusout"&&se&&oe.type==="number"&&se.memoizedProps.value!=null&&ar(oe,"number",oe.value)}switch(bn=se?_t(se):window,d){case"focusin":(Lu(bn)||bn.contentEditable==="true")&&(Us=bn,so=se,hs=null);break;case"focusout":hs=so=Us=null;break;case"mousedown":Zs=!0;break;case"contextmenu":case"mouseup":case"dragend":Zs=!1,Nr(je,_,ve);break;case"selectionchange":if(sl)break;case"keydown":case"keyup":Nr(je,_,ve)}var er;if(ja)t:{switch(d){case"compositionstart":var br="onCompositionStart";break t;case"compositionend":br="onCompositionEnd";break t;case"compositionupdate":br="onCompositionUpdate";break t}br=void 0}else Ma?Mo(d,_)&&(br="onCompositionEnd"):d==="keydown"&&_.keyCode===229&&(br="onCompositionStart");br&&(Qa&&_.locale!=="ko"&&(Ma||br!=="onCompositionStart"?br==="onCompositionEnd"&&Ma&&(er=To()):(Ki=ve,Fs="value"in Ki?Ki.value:Ki.textContent,Ma=!0)),bn=$d(se,br),0<bn.length&&(br=new Yt(br,d,null,_,ve),je.push({event:br,listeners:bn}),er?br.data=er:(er=ql(_),er!==null&&(br.data=er)))),(er=il?ws(d,_):Ja(d,_))&&(br=$d(se,"onBeforeInput"),0<br.length&&(bn=new Yt("onBeforeInput","beforeinput",null,_,ve),je.push({event:bn,listeners:br}),bn.data=er)),r_(je,d,se,_,ve)}Py(je,m)})}function lh(d,m,_){return{instance:d,listener:m,currentTarget:_}}function $d(d,m){for(var _=m+"Capture",M=[];d!==null;){var K=d,J=K.stateNode;if(K=K.tag,K!==5&&K!==26&&K!==27||J===null||(K=Yi(d,_),K!=null&&M.unshift(lh(d,K,J)),K=Yi(d,m),K!=null&&M.push(lh(d,K,J))),d.tag===3)return M;d=d.return}return[]}function o_(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function zy(d,m,_,M,K){for(var J=m._reactName,pt=[];_!==null&&_!==M;){var kt=_,Pt=kt.alternate,se=kt.stateNode;if(kt=kt.tag,Pt!==null&&Pt===M)break;kt!==5&&kt!==26&&kt!==27||se===null||(Pt=se,K?(se=Yi(_,J),se!=null&&pt.unshift(lh(_,se,Pt))):K||(se=Yi(_,J),se!=null&&pt.push(lh(_,se,Pt)))),_=_.return}pt.length!==0&&d.push({event:m,listeners:pt})}var l_=/\r\n?/g,u_=/\u0000|\uFFFD/g;function qy(d){return(typeof d=="string"?d:""+d).replace(l_,`
`).replace(u_,"")}function Uy(d,m){return m=qy(m),qy(d)===m}function ei(d,m,_,M,K,J){switch(_){case"children":typeof M=="string"?m==="body"||m==="textarea"&&M===""||Zn(d,M):(typeof M=="number"||typeof M=="bigint")&&m!=="body"&&Zn(d,""+M);break;case"className":Bn(d,"class",M);break;case"tabIndex":Bn(d,"tabindex",M);break;case"dir":case"role":case"viewBox":case"width":case"height":Bn(d,_,M);break;case"style":or(d,M,J);break;case"data":if(m!=="object"){Bn(d,"data",M);break}case"src":case"href":if(M===""&&(m!=="a"||_!=="href")){d.removeAttribute(_);break}if(M==null||typeof M=="function"||typeof M=="symbol"||typeof M=="boolean"){d.removeAttribute(_);break}M=Br(""+M),d.setAttribute(_,M);break;case"action":case"formAction":if(typeof M=="function"){d.setAttribute(_,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof J=="function"&&(_==="formAction"?(m!=="input"&&ei(d,m,"name",K.name,K,null),ei(d,m,"formEncType",K.formEncType,K,null),ei(d,m,"formMethod",K.formMethod,K,null),ei(d,m,"formTarget",K.formTarget,K,null)):(ei(d,m,"encType",K.encType,K,null),ei(d,m,"method",K.method,K,null),ei(d,m,"target",K.target,K,null)));if(M==null||typeof M=="symbol"||typeof M=="boolean"){d.removeAttribute(_);break}M=Br(""+M),d.setAttribute(_,M);break;case"onClick":M!=null&&(d.onclick=hi);break;case"onScroll":M!=null&&dr("scroll",d);break;case"onScrollEnd":M!=null&&dr("scrollend",d);break;case"dangerouslySetInnerHTML":if(M!=null){if(typeof M!="object"||!("__html"in M))throw Error(r(61));if(_=M.__html,_!=null){if(K.children!=null)throw Error(r(60));d.innerHTML=_}}break;case"multiple":d.multiple=M&&typeof M!="function"&&typeof M!="symbol";break;case"muted":d.muted=M&&typeof M!="function"&&typeof M!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(M==null||typeof M=="function"||typeof M=="boolean"||typeof M=="symbol"){d.removeAttribute("xlink:href");break}_=Br(""+M),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",_);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":M!=null&&typeof M!="function"&&typeof M!="symbol"?d.setAttribute(_,""+M):d.removeAttribute(_);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":M&&typeof M!="function"&&typeof M!="symbol"?d.setAttribute(_,""):d.removeAttribute(_);break;case"capture":case"download":M===!0?d.setAttribute(_,""):M!==!1&&M!=null&&typeof M!="function"&&typeof M!="symbol"?d.setAttribute(_,M):d.removeAttribute(_);break;case"cols":case"rows":case"size":case"span":M!=null&&typeof M!="function"&&typeof M!="symbol"&&!isNaN(M)&&1<=M?d.setAttribute(_,M):d.removeAttribute(_);break;case"rowSpan":case"start":M==null||typeof M=="function"||typeof M=="symbol"||isNaN(M)?d.removeAttribute(_):d.setAttribute(_,M);break;case"popover":dr("beforetoggle",d),dr("toggle",d),Tn(d,"popover",M);break;case"xlinkActuate":In(d,"http://www.w3.org/1999/xlink","xlink:actuate",M);break;case"xlinkArcrole":In(d,"http://www.w3.org/1999/xlink","xlink:arcrole",M);break;case"xlinkRole":In(d,"http://www.w3.org/1999/xlink","xlink:role",M);break;case"xlinkShow":In(d,"http://www.w3.org/1999/xlink","xlink:show",M);break;case"xlinkTitle":In(d,"http://www.w3.org/1999/xlink","xlink:title",M);break;case"xlinkType":In(d,"http://www.w3.org/1999/xlink","xlink:type",M);break;case"xmlBase":In(d,"http://www.w3.org/XML/1998/namespace","xml:base",M);break;case"xmlLang":In(d,"http://www.w3.org/XML/1998/namespace","xml:lang",M);break;case"xmlSpace":In(d,"http://www.w3.org/XML/1998/namespace","xml:space",M);break;case"is":Tn(d,"is",M);break;case"innerText":case"textContent":break;default:(!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(_=Sr.get(_)||_,Tn(d,_,M))}}function xm(d,m,_,M,K,J){switch(_){case"style":or(d,M,J);break;case"dangerouslySetInnerHTML":if(M!=null){if(typeof M!="object"||!("__html"in M))throw Error(r(61));if(_=M.__html,_!=null){if(K.children!=null)throw Error(r(60));d.innerHTML=_}}break;case"children":typeof M=="string"?Zn(d,M):(typeof M=="number"||typeof M=="bigint")&&Zn(d,""+M);break;case"onScroll":M!=null&&dr("scroll",d);break;case"onScrollEnd":M!=null&&dr("scrollend",d);break;case"onClick":M!=null&&(d.onclick=hi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ne.hasOwnProperty(_))t:{if(_[0]==="o"&&_[1]==="n"&&(K=_.endsWith("Capture"),m=_.slice(2,K?_.length-7:void 0),J=d[He]||null,J=J!=null?J[_]:null,typeof J=="function"&&d.removeEventListener(m,J,K),typeof M=="function")){typeof J!="function"&&J!==null&&(_ in d?d[_]=null:d.hasAttribute(_)&&d.removeAttribute(_)),d.addEventListener(m,M,K);break t}_ in d?d[_]=M:M===!0?d.setAttribute(_,""):Tn(d,_,M)}}}function As(d,m,_){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dr("error",d),dr("load",d);var M=!1,K=!1,J;for(J in _)if(_.hasOwnProperty(J)){var pt=_[J];if(pt!=null)switch(J){case"src":M=!0;break;case"srcSet":K=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,m));default:ei(d,m,J,pt,_,null)}}K&&ei(d,m,"srcSet",_.srcSet,_,null),M&&ei(d,m,"src",_.src,_,null);return;case"input":dr("invalid",d);var kt=J=pt=K=null,Pt=null,se=null;for(M in _)if(_.hasOwnProperty(M)){var ve=_[M];if(ve!=null)switch(M){case"name":K=ve;break;case"type":pt=ve;break;case"checked":Pt=ve;break;case"defaultChecked":se=ve;break;case"value":J=ve;break;case"defaultValue":kt=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,m));break;default:ei(d,m,M,ve,_,null)}}tn(d,J,kt,Pt,se,pt,K,!1);return;case"select":dr("invalid",d),M=pt=J=null;for(K in _)if(_.hasOwnProperty(K)&&(kt=_[K],kt!=null))switch(K){case"value":J=kt;break;case"defaultValue":pt=kt;break;case"multiple":M=kt;default:ei(d,m,K,kt,_,null)}m=J,_=pt,d.multiple=!!M,m!=null?tr(d,!!M,m,!1):_!=null&&tr(d,!!M,_,!0);return;case"textarea":dr("invalid",d),J=K=M=null;for(pt in _)if(_.hasOwnProperty(pt)&&(kt=_[pt],kt!=null))switch(pt){case"value":M=kt;break;case"defaultValue":K=kt;break;case"children":J=kt;break;case"dangerouslySetInnerHTML":if(kt!=null)throw Error(r(91));break;default:ei(d,m,pt,kt,_,null)}Kn(d,M,K,J);return;case"option":for(Pt in _)if(_.hasOwnProperty(Pt)&&(M=_[Pt],M!=null))switch(Pt){case"selected":d.selected=M&&typeof M!="function"&&typeof M!="symbol";break;default:ei(d,m,Pt,M,_,null)}return;case"dialog":dr("beforetoggle",d),dr("toggle",d),dr("cancel",d),dr("close",d);break;case"iframe":case"object":dr("load",d);break;case"video":case"audio":for(M=0;M<oh.length;M++)dr(oh[M],d);break;case"image":dr("error",d),dr("load",d);break;case"details":dr("toggle",d);break;case"embed":case"source":case"link":dr("error",d),dr("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in _)if(_.hasOwnProperty(se)&&(M=_[se],M!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,m));default:ei(d,m,se,M,_,null)}return;default:if(Mr(m)){for(ve in _)_.hasOwnProperty(ve)&&(M=_[ve],M!==void 0&&xm(d,m,ve,M,_,void 0));return}}for(kt in _)_.hasOwnProperty(kt)&&(M=_[kt],M!=null&&ei(d,m,kt,M,_,null))}function c_(d,m,_,M){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var K=null,J=null,pt=null,kt=null,Pt=null,se=null,ve=null;for(he in _){var je=_[he];if(_.hasOwnProperty(he)&&je!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":Pt=je;default:M.hasOwnProperty(he)||ei(d,m,he,null,M,je)}}for(var oe in M){var he=M[oe];if(je=_[oe],M.hasOwnProperty(oe)&&(he!=null||je!=null))switch(oe){case"type":J=he;break;case"name":K=he;break;case"checked":se=he;break;case"defaultChecked":ve=he;break;case"value":pt=he;break;case"defaultValue":kt=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,m));break;default:he!==je&&ei(d,m,oe,he,M,je)}}Un(d,pt,kt,Pt,se,ve,J,K);return;case"select":he=pt=kt=oe=null;for(J in _)if(Pt=_[J],_.hasOwnProperty(J)&&Pt!=null)switch(J){case"value":break;case"multiple":he=Pt;default:M.hasOwnProperty(J)||ei(d,m,J,null,M,Pt)}for(K in M)if(J=M[K],Pt=_[K],M.hasOwnProperty(K)&&(J!=null||Pt!=null))switch(K){case"value":oe=J;break;case"defaultValue":kt=J;break;case"multiple":pt=J;default:J!==Pt&&ei(d,m,K,J,M,Pt)}m=kt,_=pt,M=he,oe!=null?tr(d,!!_,oe,!1):!!M!=!!_&&(m!=null?tr(d,!!_,m,!0):tr(d,!!_,_?[]:"",!1));return;case"textarea":he=oe=null;for(kt in _)if(K=_[kt],_.hasOwnProperty(kt)&&K!=null&&!M.hasOwnProperty(kt))switch(kt){case"value":break;case"children":break;default:ei(d,m,kt,null,M,K)}for(pt in M)if(K=M[pt],J=_[pt],M.hasOwnProperty(pt)&&(K!=null||J!=null))switch(pt){case"value":oe=K;break;case"defaultValue":he=K;break;case"children":break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(r(91));break;default:K!==J&&ei(d,m,pt,K,M,J)}Ur(d,oe,he);return;case"option":for(var cn in _)if(oe=_[cn],_.hasOwnProperty(cn)&&oe!=null&&!M.hasOwnProperty(cn))switch(cn){case"selected":d.selected=!1;break;default:ei(d,m,cn,null,M,oe)}for(Pt in M)if(oe=M[Pt],he=_[Pt],M.hasOwnProperty(Pt)&&oe!==he&&(oe!=null||he!=null))switch(Pt){case"selected":d.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:ei(d,m,Pt,oe,M,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Rn in _)oe=_[Rn],_.hasOwnProperty(Rn)&&oe!=null&&!M.hasOwnProperty(Rn)&&ei(d,m,Rn,null,M,oe);for(se in M)if(oe=M[se],he=_[se],M.hasOwnProperty(se)&&oe!==he&&(oe!=null||he!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(r(137,m));break;default:ei(d,m,se,oe,M,he)}return;default:if(Mr(m)){for(var ni in _)oe=_[ni],_.hasOwnProperty(ni)&&oe!==void 0&&!M.hasOwnProperty(ni)&&xm(d,m,ni,void 0,M,oe);for(ve in M)oe=M[ve],he=_[ve],!M.hasOwnProperty(ve)||oe===he||oe===void 0&&he===void 0||xm(d,m,ve,oe,M,he);return}}for(var Xt in _)oe=_[Xt],_.hasOwnProperty(Xt)&&oe!=null&&!M.hasOwnProperty(Xt)&&ei(d,m,Xt,null,M,oe);for(je in M)oe=M[je],he=_[je],!M.hasOwnProperty(je)||oe===he||oe==null&&he==null||ei(d,m,je,oe,M,he)}function Hy(d){switch(d){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function f_(){if(typeof performance.getEntriesByType=="function"){for(var d=0,m=0,_=performance.getEntriesByType("resource"),M=0;M<_.length;M++){var K=_[M],J=K.transferSize,pt=K.initiatorType,kt=K.duration;if(J&&kt&&Hy(pt)){for(pt=0,kt=K.responseEnd,M+=1;M<_.length;M++){var Pt=_[M],se=Pt.startTime;if(se>kt)break;var ve=Pt.transferSize,je=Pt.initiatorType;ve&&Hy(je)&&(Pt=Pt.responseEnd,pt+=ve*(Pt<kt?1:(kt-se)/(Pt-se)))}if(--M,m+=8*(J+pt)/(K.duration/1e3),d++,10<d)break}}if(0<d)return m/d/1e6}return navigator.connection&&(d=navigator.connection.downlink,typeof d=="number")?d:5}var Sm=null,_m=null;function Vd(d){return d.nodeType===9?d:d.ownerDocument}function $y(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Vy(d,m){if(d===0)switch(m){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&m==="foreignObject"?0:d}function km(d,m){return d==="textarea"||d==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.children=="bigint"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var Am=null;function h_(){var d=window.event;return d&&d.type==="popstate"?d===Am?!1:(Am=d,!0):(Am=null,!1)}var Wy=typeof setTimeout=="function"?setTimeout:void 0,d_=typeof clearTimeout=="function"?clearTimeout:void 0,Gy=typeof Promise=="function"?Promise:void 0,p_=typeof queueMicrotask=="function"?queueMicrotask:typeof Gy<"u"?function(d){return Gy.resolve(null).then(d).catch(m_)}:Wy;function m_(d){setTimeout(function(){throw d})}function cu(d){return d==="head"}function Yy(d,m){var _=m,M=0;do{var K=_.nextSibling;if(d.removeChild(_),K&&K.nodeType===8)if(_=K.data,_==="/$"||_==="/&"){if(M===0){d.removeChild(K),Jc(m);return}M--}else if(_==="$"||_==="$?"||_==="$~"||_==="$!"||_==="&")M++;else if(_==="html")uh(d.ownerDocument.documentElement);else if(_==="head"){_=d.ownerDocument.head,uh(_);for(var J=_.firstChild;J;){var pt=J.nextSibling,kt=J.nodeName;J[Qt]||kt==="SCRIPT"||kt==="STYLE"||kt==="LINK"&&J.rel.toLowerCase()==="stylesheet"||_.removeChild(J),J=pt}}else _==="body"&&uh(d.ownerDocument.body);_=K}while(_);Jc(m)}function Xy(d,m){var _=d;d=0;do{var M=_.nextSibling;if(_.nodeType===1?m?(_._stashedDisplay=_.style.display,_.style.display="none"):(_.style.display=_._stashedDisplay||"",_.getAttribute("style")===""&&_.removeAttribute("style")):_.nodeType===3&&(m?(_._stashedText=_.nodeValue,_.nodeValue=""):_.nodeValue=_._stashedText||""),M&&M.nodeType===8)if(_=M.data,_==="/$"){if(d===0)break;d--}else _!=="$"&&_!=="$?"&&_!=="$~"&&_!=="$!"||d++;_=M}while(_)}function Cm(d){var m=d.firstChild;for(m&&m.nodeType===10&&(m=m.nextSibling);m;){var _=m;switch(m=m.nextSibling,_.nodeName){case"HTML":case"HEAD":case"BODY":Cm(_),de(_);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(_.rel.toLowerCase()==="stylesheet")continue}d.removeChild(_)}}function g_(d,m,_,M){for(;d.nodeType===1;){var K=_;if(d.nodeName.toLowerCase()!==m.toLowerCase()){if(!M&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(M){if(!d[Qt])switch(m){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(J=d.getAttribute("rel"),J==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(J!==K.rel||d.getAttribute("href")!==(K.href==null||K.href===""?null:K.href)||d.getAttribute("crossorigin")!==(K.crossOrigin==null?null:K.crossOrigin)||d.getAttribute("title")!==(K.title==null?null:K.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(J=d.getAttribute("src"),(J!==(K.src==null?null:K.src)||d.getAttribute("type")!==(K.type==null?null:K.type)||d.getAttribute("crossorigin")!==(K.crossOrigin==null?null:K.crossOrigin))&&J&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(m==="input"&&d.type==="hidden"){var J=K.name==null?null:""+K.name;if(K.type==="hidden"&&d.getAttribute("name")===J)return d}else return d;if(d=qa(d.nextSibling),d===null)break}return null}function b_(d,m,_){if(m==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!_||(d=qa(d.nextSibling),d===null))return null;return d}function Ky(d,m){for(;d.nodeType!==8;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!m||(d=qa(d.nextSibling),d===null))return null;return d}function Em(d){return d.data==="$?"||d.data==="$~"}function Nm(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState!=="loading"}function y_(d,m){var _=d.ownerDocument;if(d.data==="$~")d._reactRetry=m;else if(d.data!=="$?"||_.readyState!=="loading")m();else{var M=function(){m(),_.removeEventListener("DOMContentLoaded",M)};_.addEventListener("DOMContentLoaded",M),d._reactRetry=M}}function qa(d){for(;d!=null;d=d.nextSibling){var m=d.nodeType;if(m===1||m===3)break;if(m===8){if(m=d.data,m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"||m==="F!"||m==="F")break;if(m==="/$"||m==="/&")return null}}return d}var Tm=null;function Zy(d){d=d.nextSibling;for(var m=0;d;){if(d.nodeType===8){var _=d.data;if(_==="/$"||_==="/&"){if(m===0)return qa(d.nextSibling);m--}else _!=="$"&&_!=="$!"&&_!=="$?"&&_!=="$~"&&_!=="&"||m++}d=d.nextSibling}return null}function Qy(d){d=d.previousSibling;for(var m=0;d;){if(d.nodeType===8){var _=d.data;if(_==="$"||_==="$!"||_==="$?"||_==="$~"||_==="&"){if(m===0)return d;m--}else _!=="/$"&&_!=="/&"||m++}d=d.previousSibling}return null}function Jy(d,m,_){switch(m=Vd(_),d){case"html":if(d=m.documentElement,!d)throw Error(r(452));return d;case"head":if(d=m.head,!d)throw Error(r(453));return d;case"body":if(d=m.body,!d)throw Error(r(454));return d;default:throw Error(r(451))}}function uh(d){for(var m=d.attributes;m.length;)d.removeAttributeNode(m[0]);de(d)}var Ua=new Map,tv=new Set;function Wd(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var _l=k.d;k.d={f:v_,r:w_,D:x_,C:S_,L:__,m:k_,X:C_,S:A_,M:E_};function v_(){var d=_l.f(),m=Bd();return d||m}function w_(d){var m=Pe(d);m!==null&&m.tag===5&&m.type==="form"?b2(m):_l.r(d)}var Kc=typeof document>"u"?null:document;function ev(d,m,_){var M=Kc;if(M&&typeof m=="string"&&m){var K=ur(m);K='link[rel="'+d+'"][href="'+K+'"]',typeof _=="string"&&(K+='[crossorigin="'+_+'"]'),tv.has(K)||(tv.add(K),d={rel:d,crossOrigin:_,href:m},M.querySelector(K)===null&&(m=M.createElement("link"),As(m,"link",d),Gt(m),M.head.appendChild(m)))}}function x_(d){_l.D(d),ev("dns-prefetch",d,null)}function S_(d,m){_l.C(d,m),ev("preconnect",d,m)}function __(d,m,_){_l.L(d,m,_);var M=Kc;if(M&&d&&m){var K='link[rel="preload"][as="'+ur(m)+'"]';m==="image"&&_&&_.imageSrcSet?(K+='[imagesrcset="'+ur(_.imageSrcSet)+'"]',typeof _.imageSizes=="string"&&(K+='[imagesizes="'+ur(_.imageSizes)+'"]')):K+='[href="'+ur(d)+'"]';var J=K;switch(m){case"style":J=Zc(d);break;case"script":J=Qc(d)}Ua.has(J)||(d=p({rel:"preload",href:m==="image"&&_&&_.imageSrcSet?void 0:d,as:m},_),Ua.set(J,d),M.querySelector(K)!==null||m==="style"&&M.querySelector(ch(J))||m==="script"&&M.querySelector(fh(J))||(m=M.createElement("link"),As(m,"link",d),Gt(m),M.head.appendChild(m)))}}function k_(d,m){_l.m(d,m);var _=Kc;if(_&&d){var M=m&&typeof m.as=="string"?m.as:"script",K='link[rel="modulepreload"][as="'+ur(M)+'"][href="'+ur(d)+'"]',J=K;switch(M){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":J=Qc(d)}if(!Ua.has(J)&&(d=p({rel:"modulepreload",href:d},m),Ua.set(J,d),_.querySelector(K)===null)){switch(M){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(_.querySelector(fh(J)))return}M=_.createElement("link"),As(M,"link",d),Gt(M),_.head.appendChild(M)}}}function A_(d,m,_){_l.S(d,m,_);var M=Kc;if(M&&d){var K=Bt(M).hoistableStyles,J=Zc(d);m=m||"default";var pt=K.get(J);if(!pt){var kt={loading:0,preload:null};if(pt=M.querySelector(ch(J)))kt.loading=5;else{d=p({rel:"stylesheet",href:d,"data-precedence":m},_),(_=Ua.get(J))&&jm(d,_);var Pt=pt=M.createElement("link");Gt(Pt),As(Pt,"link",d),Pt._p=new Promise(function(se,ve){Pt.onload=se,Pt.onerror=ve}),Pt.addEventListener("load",function(){kt.loading|=1}),Pt.addEventListener("error",function(){kt.loading|=2}),kt.loading|=4,Gd(pt,m,M)}pt={type:"stylesheet",instance:pt,count:1,state:kt},K.set(J,pt)}}}function C_(d,m){_l.X(d,m);var _=Kc;if(_&&d){var M=Bt(_).hoistableScripts,K=Qc(d),J=M.get(K);J||(J=_.querySelector(fh(K)),J||(d=p({src:d,async:!0},m),(m=Ua.get(K))&&Mm(d,m),J=_.createElement("script"),Gt(J),As(J,"link",d),_.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},M.set(K,J))}}function E_(d,m){_l.M(d,m);var _=Kc;if(_&&d){var M=Bt(_).hoistableScripts,K=Qc(d),J=M.get(K);J||(J=_.querySelector(fh(K)),J||(d=p({src:d,async:!0,type:"module"},m),(m=Ua.get(K))&&Mm(d,m),J=_.createElement("script"),Gt(J),As(J,"link",d),_.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},M.set(K,J))}}function nv(d,m,_,M){var K=(K=V.current)?Wd(K):null;if(!K)throw Error(r(446));switch(d){case"meta":case"title":return null;case"style":return typeof _.precedence=="string"&&typeof _.href=="string"?(m=Zc(_.href),_=Bt(K).hoistableStyles,M=_.get(m),M||(M={type:"style",instance:null,count:0,state:null},_.set(m,M)),M):{type:"void",instance:null,count:0,state:null};case"link":if(_.rel==="stylesheet"&&typeof _.href=="string"&&typeof _.precedence=="string"){d=Zc(_.href);var J=Bt(K).hoistableStyles,pt=J.get(d);if(pt||(K=K.ownerDocument||K,pt={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},J.set(d,pt),(J=K.querySelector(ch(d)))&&!J._p&&(pt.instance=J,pt.state.loading=5),Ua.has(d)||(_={rel:"preload",as:"style",href:_.href,crossOrigin:_.crossOrigin,integrity:_.integrity,media:_.media,hrefLang:_.hrefLang,referrerPolicy:_.referrerPolicy},Ua.set(d,_),J||N_(K,d,_,pt.state))),m&&M===null)throw Error(r(528,""));return pt}if(m&&M!==null)throw Error(r(529,""));return null;case"script":return m=_.async,_=_.src,typeof _=="string"&&m&&typeof m!="function"&&typeof m!="symbol"?(m=Qc(_),_=Bt(K).hoistableScripts,M=_.get(m),M||(M={type:"script",instance:null,count:0,state:null},_.set(m,M)),M):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,d))}}function Zc(d){return'href="'+ur(d)+'"'}function ch(d){return'link[rel="stylesheet"]['+d+"]"}function rv(d){return p({},d,{"data-precedence":d.precedence,precedence:null})}function N_(d,m,_,M){d.querySelector('link[rel="preload"][as="style"]['+m+"]")?M.loading=1:(m=d.createElement("link"),M.preload=m,m.addEventListener("load",function(){return M.loading|=1}),m.addEventListener("error",function(){return M.loading|=2}),As(m,"link",_),Gt(m),d.head.appendChild(m))}function Qc(d){return'[src="'+ur(d)+'"]'}function fh(d){return"script[async]"+d}function iv(d,m,_){if(m.count++,m.instance===null)switch(m.type){case"style":var M=d.querySelector('style[data-href~="'+ur(_.href)+'"]');if(M)return m.instance=M,Gt(M),M;var K=p({},_,{"data-href":_.href,"data-precedence":_.precedence,href:null,precedence:null});return M=(d.ownerDocument||d).createElement("style"),Gt(M),As(M,"style",K),Gd(M,_.precedence,d),m.instance=M;case"stylesheet":K=Zc(_.href);var J=d.querySelector(ch(K));if(J)return m.state.loading|=4,m.instance=J,Gt(J),J;M=rv(_),(K=Ua.get(K))&&jm(M,K),J=(d.ownerDocument||d).createElement("link"),Gt(J);var pt=J;return pt._p=new Promise(function(kt,Pt){pt.onload=kt,pt.onerror=Pt}),As(J,"link",M),m.state.loading|=4,Gd(J,_.precedence,d),m.instance=J;case"script":return J=Qc(_.src),(K=d.querySelector(fh(J)))?(m.instance=K,Gt(K),K):(M=_,(K=Ua.get(J))&&(M=p({},_),Mm(M,K)),d=d.ownerDocument||d,K=d.createElement("script"),Gt(K),As(K,"link",M),d.head.appendChild(K),m.instance=K);case"void":return null;default:throw Error(r(443,m.type))}else m.type==="stylesheet"&&(m.state.loading&4)===0&&(M=m.instance,m.state.loading|=4,Gd(M,_.precedence,d));return m.instance}function Gd(d,m,_){for(var M=_.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),K=M.length?M[M.length-1]:null,J=K,pt=0;pt<M.length;pt++){var kt=M[pt];if(kt.dataset.precedence===m)J=kt;else if(J!==K)break}J?J.parentNode.insertBefore(d,J.nextSibling):(m=_.nodeType===9?_.head:_,m.insertBefore(d,m.firstChild))}function jm(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.title==null&&(d.title=m.title)}function Mm(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.integrity==null&&(d.integrity=m.integrity)}var Yd=null;function sv(d,m,_){if(Yd===null){var M=new Map,K=Yd=new Map;K.set(_,M)}else K=Yd,M=K.get(_),M||(M=new Map,K.set(_,M));if(M.has(d))return M;for(M.set(d,null),_=_.getElementsByTagName(d),K=0;K<_.length;K++){var J=_[K];if(!(J[Qt]||J[Ue]||d==="link"&&J.getAttribute("rel")==="stylesheet")&&J.namespaceURI!=="http://www.w3.org/2000/svg"){var pt=J.getAttribute(m)||"";pt=d+pt;var kt=M.get(pt);kt?kt.push(J):M.set(pt,[J])}}return M}function av(d,m,_){d=d.ownerDocument||d,d.head.insertBefore(_,m==="title"?d.querySelector("head > title"):null)}function T_(d,m,_){if(_===1||m.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof m.precedence!="string"||typeof m.href!="string"||m.href==="")break;return!0;case"link":if(typeof m.rel!="string"||typeof m.href!="string"||m.href===""||m.onLoad||m.onError)break;switch(m.rel){case"stylesheet":return d=m.disabled,typeof m.precedence=="string"&&d==null;default:return!0}case"script":if(m.async&&typeof m.async!="function"&&typeof m.async!="symbol"&&!m.onLoad&&!m.onError&&m.src&&typeof m.src=="string")return!0}return!1}function ov(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}function j_(d,m,_,M){if(_.type==="stylesheet"&&(typeof M.media!="string"||matchMedia(M.media).matches!==!1)&&(_.state.loading&4)===0){if(_.instance===null){var K=Zc(M.href),J=m.querySelector(ch(K));if(J){m=J._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(d.count++,d=Xd.bind(d),m.then(d,d)),_.state.loading|=4,_.instance=J,Gt(J);return}J=m.ownerDocument||m,M=rv(M),(K=Ua.get(K))&&jm(M,K),J=J.createElement("link"),Gt(J);var pt=J;pt._p=new Promise(function(kt,Pt){pt.onload=kt,pt.onerror=Pt}),As(J,"link",M),_.instance=J}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(_,m),(m=_.state.preload)&&(_.state.loading&3)===0&&(d.count++,_=Xd.bind(d),m.addEventListener("load",_),m.addEventListener("error",_))}}var Lm=0;function M_(d,m){return d.stylesheets&&d.count===0&&Zd(d,d.stylesheets),0<d.count||0<d.imgCount?function(_){var M=setTimeout(function(){if(d.stylesheets&&Zd(d,d.stylesheets),d.unsuspend){var J=d.unsuspend;d.unsuspend=null,J()}},6e4+m);0<d.imgBytes&&Lm===0&&(Lm=62500*f_());var K=setTimeout(function(){if(d.waitingForImages=!1,d.count===0&&(d.stylesheets&&Zd(d,d.stylesheets),d.unsuspend)){var J=d.unsuspend;d.unsuspend=null,J()}},(d.imgBytes>Lm?50:800)+m);return d.unsuspend=_,function(){d.unsuspend=null,clearTimeout(M),clearTimeout(K)}}:null}function Xd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Zd(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var Kd=null;function Zd(d,m){d.stylesheets=null,d.unsuspend!==null&&(d.count++,Kd=new Map,m.forEach(L_,d),Kd=null,Xd.call(d))}function L_(d,m){if(!(m.state.loading&4)){var _=Kd.get(d);if(_)var M=_.get(null);else{_=new Map,Kd.set(d,_);for(var K=d.querySelectorAll("link[data-precedence],style[data-precedence]"),J=0;J<K.length;J++){var pt=K[J];(pt.nodeName==="LINK"||pt.getAttribute("media")!=="not all")&&(_.set(pt.dataset.precedence,pt),M=pt)}M&&_.set(null,M)}K=m.instance,pt=K.getAttribute("data-precedence"),J=_.get(pt)||M,J===M&&_.set(null,K),_.set(pt,K),this.count++,M=Xd.bind(this),K.addEventListener("load",M),K.addEventListener("error",M),J?J.parentNode.insertBefore(K,J.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(K,d.firstChild)),m.state.loading|=4}}var hh={$$typeof:S,Provider:null,Consumer:null,_currentValue:A,_currentValue2:A,_threadCount:0};function O_(d,m,_,M,K,J,pt,kt,Pt){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nn(0),this.hiddenUpdates=Nn(null),this.identifierPrefix=M,this.onUncaughtError=K,this.onCaughtError=J,this.onRecoverableError=pt,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Pt,this.incompleteTransitions=new Map}function lv(d,m,_,M,K,J,pt,kt,Pt,se,ve,je){return d=new O_(d,m,_,pt,Pt,se,ve,je,kt),m=1,J===!0&&(m|=24),J=ps(3,null,null,m),d.current=J,J.stateNode=d,m=Ql(),m.refCount++,d.pooledCache=m,m.refCount++,J.memoizedState={element:M,isDehydrated:_,cache:m},We(J),d}function uv(d){return d?(d=ss,d):ss}function cv(d,m,_,M,K,J){K=uv(K),M.context===null?M.context=K:M.pendingContext=K,M=Ln(m),M.payload={element:_},J=J===void 0?null:J,J!==null&&(M.callback=J),_=Xn(d,M,m),_!==null&&(fa(_,d,m),Pr(_,d,m))}function fv(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var _=d.retryLane;d.retryLane=_!==0&&_<m?_:m}}function Om(d,m){fv(d,m),(d=d.alternate)&&fv(d,m)}function hv(d){if(d.tag===13||d.tag===31){var m=ao(d,67108864);m!==null&&fa(m,d,67108864),Om(d,67108864)}}function dv(d){if(d.tag===13||d.tag===31){var m=_a();m=Ht(m);var _=ao(d,m);_!==null&&fa(_,d,m),Om(d,m)}}var Qd=!0;function R_(d,m,_,M){var K=x.T;x.T=null;var J=k.p;try{k.p=2,Rm(d,m,_,M)}finally{k.p=J,x.T=K}}function I_(d,m,_,M){var K=x.T;x.T=null;var J=k.p;try{k.p=8,Rm(d,m,_,M)}finally{k.p=J,x.T=K}}function Rm(d,m,_,M){if(Qd){var K=Im(M);if(K===null)wm(d,m,M,Jd,_),mv(d,M);else if(B_(K,d,m,_,M))M.stopPropagation();else if(mv(d,M),m&4&&-1<D_.indexOf(d)){for(;K!==null;){var J=Pe(K);if(J!==null)switch(J.tag){case 3:if(J=J.stateNode,J.current.memoizedState.isDehydrated){var pt=Me(J.pendingLanes);if(pt!==0){var kt=J;for(kt.pendingLanes|=2,kt.entangledLanes|=2;pt;){var Pt=1<<31-ge(pt);kt.entanglements[1]|=Pt,pt&=~Pt}Vo(J),(zr&6)===0&&(Id=Mt()+500,ah(0))}}break;case 31:case 13:kt=ao(J,2),kt!==null&&fa(kt,J,2),Bd(),Om(J,2)}if(J=Im(M),J===null&&wm(d,m,M,Jd,_),J===K)break;K=J}K!==null&&M.stopPropagation()}else wm(d,m,M,null,_)}}function Im(d){return d=ns(d),Dm(d)}var Jd=null;function Dm(d){if(Jd=null,d=Ee(d),d!==null){var m=s(d);if(m===null)d=null;else{var _=m.tag;if(_===13){if(d=a(m),d!==null)return d;d=null}else if(_===31){if(d=u(m),d!==null)return d;d=null}else if(_===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;d=null}else m!==d&&(d=null)}}return Jd=d,null}function pv(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(qt()){case Tt:return 2;case It:return 8;case Vt:case Kt:return 32;case ne:return 268435456;default:return 32}default:return 32}}var Bm=!1,fu=null,hu=null,du=null,dh=new Map,ph=new Map,pu=[],D_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mv(d,m){switch(d){case"focusin":case"focusout":fu=null;break;case"dragenter":case"dragleave":hu=null;break;case"mouseover":case"mouseout":du=null;break;case"pointerover":case"pointerout":dh.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":ph.delete(m.pointerId)}}function mh(d,m,_,M,K,J){return d===null||d.nativeEvent!==J?(d={blockedOn:m,domEventName:_,eventSystemFlags:M,nativeEvent:J,targetContainers:[K]},m!==null&&(m=Pe(m),m!==null&&hv(m)),d):(d.eventSystemFlags|=M,m=d.targetContainers,K!==null&&m.indexOf(K)===-1&&m.push(K),d)}function B_(d,m,_,M,K){switch(m){case"focusin":return fu=mh(fu,d,m,_,M,K),!0;case"dragenter":return hu=mh(hu,d,m,_,M,K),!0;case"mouseover":return du=mh(du,d,m,_,M,K),!0;case"pointerover":var J=K.pointerId;return dh.set(J,mh(dh.get(J)||null,d,m,_,M,K)),!0;case"gotpointercapture":return J=K.pointerId,ph.set(J,mh(ph.get(J)||null,d,m,_,M,K)),!0}return!1}function gv(d){var m=Ee(d.target);if(m!==null){var _=s(m);if(_!==null){if(m=_.tag,m===13){if(m=a(_),m!==null){d.blockedOn=m,nn(d.priority,function(){dv(_)});return}}else if(m===31){if(m=u(_),m!==null){d.blockedOn=m,nn(d.priority,function(){dv(_)});return}}else if(m===3&&_.stateNode.current.memoizedState.isDehydrated){d.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}d.blockedOn=null}function tp(d){if(d.blockedOn!==null)return!1;for(var m=d.targetContainers;0<m.length;){var _=Im(d.nativeEvent);if(_===null){_=d.nativeEvent;var M=new _.constructor(_.type,_);Lr=M,_.target.dispatchEvent(M),Lr=null}else return m=Pe(_),m!==null&&hv(m),d.blockedOn=_,!1;m.shift()}return!0}function bv(d,m,_){tp(d)&&_.delete(m)}function P_(){Bm=!1,fu!==null&&tp(fu)&&(fu=null),hu!==null&&tp(hu)&&(hu=null),du!==null&&tp(du)&&(du=null),dh.forEach(bv),ph.forEach(bv)}function ep(d,m){d.blockedOn===m&&(d.blockedOn=null,Bm||(Bm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,P_)))}var np=null;function yv(d){np!==d&&(np=d,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){np===d&&(np=null);for(var m=0;m<d.length;m+=3){var _=d[m],M=d[m+1],K=d[m+2];if(typeof M!="function"){if(Dm(M||_)===null)continue;break}var J=Pe(_);J!==null&&(d.splice(m,3),m-=3,I0(J,{pending:!0,data:K,method:_.method,action:M},M,K))}}))}function Jc(d){function m(Pt){return ep(Pt,d)}fu!==null&&ep(fu,d),hu!==null&&ep(hu,d),du!==null&&ep(du,d),dh.forEach(m),ph.forEach(m);for(var _=0;_<pu.length;_++){var M=pu[_];M.blockedOn===d&&(M.blockedOn=null)}for(;0<pu.length&&(_=pu[0],_.blockedOn===null);)gv(_),_.blockedOn===null&&pu.shift();if(_=(d.ownerDocument||d).$$reactFormReplay,_!=null)for(M=0;M<_.length;M+=3){var K=_[M],J=_[M+1],pt=K[He]||null;if(typeof J=="function")pt||yv(_);else if(pt){var kt=null;if(J&&J.hasAttribute("formAction")){if(K=J,pt=J[He]||null)kt=pt.formAction;else if(Dm(K)!==null)continue}else kt=pt.action;typeof kt=="function"?_[M+1]=kt:(_.splice(M,3),M-=3),yv(_)}}}function vv(){function d(J){J.canIntercept&&J.info==="react-transition"&&J.intercept({handler:function(){return new Promise(function(pt){return K=pt})},focusReset:"manual",scroll:"manual"})}function m(){K!==null&&(K(),K=null),M||setTimeout(_,20)}function _(){if(!M&&!navigation.transition){var J=navigation.currentEntry;J&&J.url!=null&&navigation.navigate(J.url,{state:J.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var M=!1,K=null;return navigation.addEventListener("navigate",d),navigation.addEventListener("navigatesuccess",m),navigation.addEventListener("navigateerror",m),setTimeout(_,100),function(){M=!0,navigation.removeEventListener("navigate",d),navigation.removeEventListener("navigatesuccess",m),navigation.removeEventListener("navigateerror",m),K!==null&&(K(),K=null)}}}function Pm(d){this._internalRoot=d}rp.prototype.render=Pm.prototype.render=function(d){var m=this._internalRoot;if(m===null)throw Error(r(409));var _=m.current,M=_a();cv(_,M,d,m,null,null)},rp.prototype.unmount=Pm.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var m=d.containerInfo;cv(d.current,2,null,d,null,null),Bd(),m[Ge]=null}};function rp(d){this._internalRoot=d}rp.prototype.unstable_scheduleHydration=function(d){if(d){var m=we();d={blockedOn:null,target:d,priority:m};for(var _=0;_<pu.length&&m!==0&&m<pu[_].priority;_++);pu.splice(_,0,d),_===0&&gv(d)}};var wv=e.version;if(wv!=="19.2.0")throw Error(r(527,wv,"19.2.0"));k.findDOMNode=function(d){var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(r(188)):(d=Object.keys(d).join(","),Error(r(268,d)));return d=i(m),d=d!==null?c(d):null,d=d===null?null:d.stateNode,d};var F_={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:x,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ip=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ip.isDisabled&&ip.supportsFiber)try{le=ip.inject(F_),Jt=ip}catch{}}return bh.createRoot=function(d,m){if(!o(d))throw Error(r(299));var _=!1,M="",K=E2,J=N2,pt=T2;return m!=null&&(m.unstable_strictMode===!0&&(_=!0),m.identifierPrefix!==void 0&&(M=m.identifierPrefix),m.onUncaughtError!==void 0&&(K=m.onUncaughtError),m.onCaughtError!==void 0&&(J=m.onCaughtError),m.onRecoverableError!==void 0&&(pt=m.onRecoverableError)),m=lv(d,1,!1,null,null,_,M,null,K,J,pt,vv),d[Ge]=m.current,vm(d),new Pm(m)},bh.hydrateRoot=function(d,m,_){if(!o(d))throw Error(r(299));var M=!1,K="",J=E2,pt=N2,kt=T2,Pt=null;return _!=null&&(_.unstable_strictMode===!0&&(M=!0),_.identifierPrefix!==void 0&&(K=_.identifierPrefix),_.onUncaughtError!==void 0&&(J=_.onUncaughtError),_.onCaughtError!==void 0&&(pt=_.onCaughtError),_.onRecoverableError!==void 0&&(kt=_.onRecoverableError),_.formState!==void 0&&(Pt=_.formState)),m=lv(d,1,!0,m,_??null,M,K,Pt,J,pt,kt,vv),m.context=uv(null),_=m.current,M=_a(),M=Ht(M),K=Ln(M),K.callback=null,Xn(_,K,M),_=M,m.current.lanes=_,Te(m,_),Vo(m),d[Ge]=m.current,vm(d),new rp(m)},bh.version="19.2.0",bh}var jv;function Y_(){if(jv)return qm.exports;jv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qm.exports=G_(),qm.exports}var X_=Y_();const K_=Eu(X_),Z_="modulepreload",Q_=function(n){return"/Student-Retention-Add-in/react/dist/"+n},Mv={},Mh=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let l=function(i){return Promise.all(i.map(c=>Promise.resolve(c).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),u=a?.nonce||a?.getAttribute("nonce");o=l(t.map(i=>{if(i=Q_(i),i in Mv)return;Mv[i]=!0;const c=i.endsWith(".css"),p=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${p}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Z_,c||(h.as="script"),h.crossOrigin="",h.href=i,u&&h.setAttribute("nonce",u),document.head.appendChild(h),c)return new Promise((f,g)=>{h.addEventListener("load",f),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${i}`)))})}))}function s(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return o.then(a=>{for(const u of a||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})};function Ll(n,e="default"){const t=Number(n);if(isNaN(t))return"N/A";const r=Math.floor(t),o=t-r;let s=r;s>59&&(s-=1);const u=Date.UTC(1899,11,31)+s*864e5+Math.round(o*864e5),l=new Date(u);if(isNaN(l.getTime()))return"N/A";if(e==="long")return l.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"});const i=String(l.getUTCMonth()+1).padStart(2,"0"),c=String(l.getUTCDate()).padStart(2,"0"),p=String(l.getUTCFullYear()).slice(-2);if(e==="short")return`${i}/${c}/${p}`;let h=l.getUTCHours();const f=String(l.getUTCMinutes()).padStart(2,"0"),g=h>=12?"PM":"AM";return h=h%12,h=h||12,`${i}/${c}/${p} ${h}:${f} ${g}`}function D3(n){if(!n||typeof n!="string")return n;if(n.includes(",")){const[e,t]=n.split(",").map(r=>r.trim());if(t&&e)return`${t} ${e}`}else{const e=n.trim().split(/\s+/);if(e.length===2)return`${e[1]}, ${e[0]}`}return n}function Lv(n){if(!n||typeof n!="object")return n;const e={};return Object.keys(n).forEach(t=>{const r=String(t).toLowerCase().replace(/\s+/g,"");e[r]=n[t]}),e}function Ov(n=new Date){try{const e=new Date(n),t=new Intl.DateTimeFormat("en-US",{timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).formatToParts(e),r=c=>t.find(p=>p.type===c)?.value||"",o=r("month"),s=r("day"),a=r("year").slice(-2),u=r("hour").padStart(2,"0"),l=r("minute"),i=r("dayPeriod");return`${o}/${s}/${a} ${u}:${l} ${i}`}catch{return String(n)}}function B3(){return W.jsx("style",{children:`
        .bounce {
          animation: bounce 0.5s;
        }
        @keyframes bounce {
          0%   { transform: scale(1); }
          20%  { transform: scale(1.15); }
          40%  { transform: scale(0.95); }
          60%  { transform: scale(1.10); }
          80%  { transform: scale(0.98); }
          100% { transform: scale(1); }
        }
      `})}const o0=({isOpen:n,onClose:e,children:t,borderRadius:r="20px",className:o="",padding:s,style:a,overlayStyle:u,...l})=>{if(!n)return null;const i=c=>{c.target===c.currentTarget&&e&&e(c)};return W.jsx("div",{className:`modal-overlay ${o}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999,background:"rgba(30,30,30,0.5)",display:"flex",alignItems:"center",justifyContent:"center",width:"100vw",height:"100vh",backdropFilter:"blur(2px) saturate(140%)",WebkitBackdropFilter:"blur(2px) saturate(140%)",...u},onClick:i,...l,children:W.jsx("div",{className:"modal-container",style:{minWidth:280,maxWidth:500,maxHeight:500,borderRadius:r,padding:s,background:"rgba(255,255,255,0.85)",boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)",backdropFilter:"blur(15px) saturate(140%)",WebkitBackdropFilter:"blur(15px) saturate(140%)",border:"1px solid rgba(255,255,255,0.18)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"0 auto",overflow:"auto",position:"relative",...a},onClick:c=>c.stopPropagation(),children:t})})},J_=({isOpen:n,onClose:e,daysOut:t})=>{const r=typeof t=="number"&&!isNaN(t),o=r?14-t:null,s=r&&o<0,a=r&&o===0,u=o===null?"N/A":`${o} ${o===1?"day":"days"}`,l=o===null?"N/A":(()=>{const i=new Date;return i.setDate(i.getDate()+o),i.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})();return W.jsx(o0,{isOpen:n,onClose:e,padding:"16px",borderRadius:"12px",style:{maxWidth:420,textAlign:"center"},children:W.jsxs("div",{style:{width:"100%"},children:[W.jsx("h3",{style:{margin:0,marginBottom:8,fontSize:18,fontWeight:700},children:r?s?W.jsx("span",{style:{textDecoration:"line-through"},children:`${t} Days Out`}):`${t} Days Out`:"N/A Days Out"}),W.jsx("p",{style:{margin:"8px 0"},children:s?W.jsxs(W.Fragment,{children:["The Student has ",W.jsx("strong",{children:"no days"})," left to submit work."]}):a?W.jsxs(W.Fragment,{children:["The student has to submit work by ",W.jsx("strong",{children:"TODAY"}),"."]}):W.jsxs(W.Fragment,{children:["The student has ",W.jsx("strong",{children:u})," left."]})}),r&&o>0&&W.jsxs("p",{style:{margin:"8px 0"},children:["They have until ",W.jsx("strong",{children:l})," to submit work."]})]})})},t7=n=>{if(!n||typeof n!="string")return"--";const e=n.split(" ");return e.length===1?e[0].charAt(0).toUpperCase():(e[0].charAt(0)+e[e.length-1].charAt(0)).toUpperCase()};function e7({student:n,selectedRowCount:e=1}){const t=n||{},r=e>1,o=t.StudentName||"Select a Student",s=o.includes(",")?D3(o):o,a=t7(s),u=t.Assigned,l=t.DaysOut??"--";let i="bg-gray-200",c="text-gray-800",p="text-gray-500";typeof l=="number"&&(l===0?(i="bg-green-300",c="text-black",p="text-black"):l>=14?(i="bg-red-400",c="text-black",p="text-black"):l>=10?(i="bg-red-300",c="text-black",p="text-black"):l>=5?(i="bg-yellow-200",c="text-gray-800",p="text-gray-500"):(i="bg-green-200",c="text-gray-800",p="text-gray-500"));let h=t.Grade??null,f=h;if(h!==null&&typeof h=="string"&&h.trim()!==""){const tt=h.match(/^(\d+(?:\.\d+)?)\s*%?$/);tt&&(f=Number(tt[1]))}let g="bg-gray-200",y="text-gray-800",b="text-gray-500",v=h;if(typeof f=="number"&&!isNaN(f)){const tt=Math.round(f);tt>=90?(g="bg-green-300",y="text-black",b="text-black"):tt>=70?(g="bg-green-200",y="text-gray-800",b="text-gray-500"):tt>=60?(g="bg-yellow-200",y="text-gray-800",b="text-gray-500"):(g="bg-red-300",y="text-black",b="text-black"),v=`${tt}%`}(h===null||typeof h=="string"&&h.trim()==="")&&(v="--",g="bg-gray-200",y="text-gray-800",b="text-gray-500");const w=(t.Gender||"").toLowerCase(),S=w==="male"?{background:"#1278FF",color:"#FFFFFF"}:w==="female"?{background:"#ed72b5",color:"#FFFFFF"}:{background:"#6b7280",color:"#FFFFFF"},N=t.Gradebook,D=tt=>{if(!tt)return!1;const $=tt.ExpectedStartDate??tt.expectedStartDate??tt.ExpectedStart??tt.startDate;if(!$)return!1;const z=Date.parse($);if(isNaN(z))return!1;const Z=Date.now(),it=1e3*60*60*24,mt=Math.floor((Z-z)/it);return mt>=0&&mt<=31},F=t.ExpectedStartDate??t.expectedStartDate??t.ExpectedStart??t.startDate??null;let G=null;if(F){const tt=Date.parse(F);isNaN(tt)||(G=new Date(tt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}))}const P=D(t)||t.IsNew===!0||t.isNew===!0||t.New===!0||t.newStudent===!0,U=String(t.Hold??t.hold??"").toLowerCase()==="yes",R=(tt=>{const $=tt?.ProfilePicture??tt?.profilePicture??tt?.ProfileImage??tt?.ProfilePic;if(!$)return null;if(typeof $=="string"&&$.trim())return $.trim();if(typeof $=="object"&&$!==null){const z=$.Value??$.value??$.url??$.Url;return typeof z=="string"&&z.trim()?z.trim():null}return null})(t),[I,T]=Ye.useState(!1),L=typeof N=="string"&&/^https?:\/\/\S+$/i.test(N),E=()=>{L&&(console.log("Gradebook URL clicked:",N),window.Office&&window.Office.context&&window.Office.context.ui&&window.Office.context.ui.openBrowserWindow?window.Office.context.ui.openBrowserWindow(N):window.open(N,"_blank"))},[x,k]=Ye.useState(!1),[A,C]=Ye.useState(!1),[j,B]=Ye.useState(!1),[O,H]=Ye.useState(!1),X=Ye.useRef(null),[et,V]=Ye.useState("text-lg");return Ye.useLayoutEffect(()=>{V("text-lg")},[s]),Ye.useLayoutEffect(()=>{et==="text-lg"&&X.current&&X.current.scrollHeight>X.current.clientHeight&&V("text-sm")},[et,s]),r?W.jsx("div",{className:"p-4 bg-white border-b border-gray-200",children:W.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[W.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center text-white text-xl font-bold shrink-0",children:e}),W.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Students Selected"})]})}):W.jsxs("div",{className:"p-4 bg-white border-b border-gray-200",children:[W.jsx(B3,{}),W.jsxs("div",{className:"flex items-center justify-between space-x-4 min-w-0",children:[W.jsxs("div",{className:"flex items-center space-x-4 min-w-0",children:[W.jsxs("button",{type:"button",className:`relative w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold shrink-0 focus:outline-none${j?" bounce":""}`,style:S,onClick:()=>{R&&!I?H(!0):(B(!0),setTimeout(()=>B(!1),500))},"aria-label":R&&!I?"View profile photo":"Bounce avatar",title:P&&!G?"New student":void 0,children:[R&&!I?W.jsx("img",{src:R,alt:s?`${s} profile`:"Student profile",onError:()=>T(!0),className:"w-full h-full object-cover rounded-full",style:{display:"block"}}):a,P&&W.jsx("span",{"aria-label":`New student${G?`: ${G}`:""}`,role:"status",title:G||"New student",style:{position:"absolute",bottom:0,right:0,transform:"translate(25%, 25%)",background:"#10B981",color:"#ffffff",borderRadius:9999,fontSize:10,padding:"2px 6px",fontWeight:700,boxShadow:"0 1px 2px rgba(0,0,0,0.12)",pointerEvents:"auto",lineHeight:1,zIndex:10},tabIndex:0,children:"NEW"}),U&&W.jsx("span",{"aria-label":"Hold",role:"status",title:"Hold",style:{position:"absolute",bottom:0,left:0,transform:"translate(-25%, 25%)",background:"#ef4444",color:"#ffffff",borderRadius:9999,fontSize:10,padding:"2px 6px",fontWeight:700,boxShadow:"0 1px 2px rgba(0,0,0,0.12)",pointerEvents:"auto",lineHeight:1,zIndex:10},tabIndex:0,children:"HOLD"})]}),W.jsxs("div",{className:"min-w-0",children:[W.jsx("h2",{ref:X,className:`${et} font-bold text-gray-800 break-words`,style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:s}),u&&W.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold rounded-full bg-gray-200 text-gray-800 mt-1 inline-block truncate max-w-[120px]",children:u})]})]}),W.jsxs("div",{className:"flex space-x-2 flex-shrink-0",children:[W.jsxs("button",{type:"button",className:`p-2 text-center rounded-lg ${i} ${c} w-20 focus:outline-none`,onClick:()=>C(!0),"aria-label":"Show days out details",title:"Show days out details",children:[W.jsx("div",{className:"text-xl font-bold",children:l}),W.jsx("div",{className:`text-xs font-medium uppercase ${p}`,children:l===0?"Engaged":l===1?"Day Out":"Days Out"})]}),W.jsxs("button",{type:"button",className:`p-2 text-center rounded-lg ${g} ${y} w-20 transition-colors duration-150 border border-gray-300 hover:border-blue-400`,style:{outline:"none",position:"relative",cursor:L?"pointer":"not-allowed"},onClick:E,disabled:!L,title:L?"Open Gradebook":"No Gradebook link",onMouseEnter:()=>{L||k(!0)},onMouseLeave:()=>k(!1),children:[W.jsx("div",{className:"text-xl font-bold",children:v}),W.jsx("div",{className:`text-xs font-medium uppercase ${b}`,children:"Grade"}),!L&&x&&W.jsx("span",{style:{position:"absolute",top:2,right:2,background:"#f87171",color:"#fff",borderRadius:"6px",fontSize:"10px",padding:"2px 6px",fontWeight:"bold",zIndex:2,opacity:x?1:0,pointerEvents:"none",transition:"opacity 0.15s"},"aria-label":"No gradebook link",children:"No Link"})]})]})]}),O&&R&&!I&&W.jsx("div",{onClick:()=>H(!1),style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,cursor:"pointer"},"aria-label":"Close enlarged photo",role:"button",tabIndex:0,onKeyDown:tt=>{(tt.key==="Escape"||tt.key==="Enter"||tt.key===" ")&&H(!1)},children:W.jsx("img",{src:R,alt:s?`${s} profile photo enlarged`:"Student profile photo enlarged",style:{maxWidth:"90vw",maxHeight:"90vh",objectFit:"contain",borderRadius:"8px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.5)"},onClick:tt=>tt.stopPropagation()})}),W.jsx(J_,{isOpen:A,onClose:()=>C(!1),daysOut:typeof l=="number"?l:Number.isFinite(Number(l))?Number(l):null})]})}const n7=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r7=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),Rv=n=>{const e=r7(n);return e.charAt(0).toUpperCase()+e.slice(1)},P3=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),i7=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var s7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const a7=jt.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:o="",children:s,iconNode:a,...u},l)=>jt.createElement("svg",{ref:l,...s7,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:P3("lucide",o),...!s&&!i7(u)&&{"aria-hidden":"true"},...u},[...a.map(([i,c])=>jt.createElement(i,c)),...Array.isArray(s)?s:[s]]));const Er=(n,e)=>{const t=jt.forwardRef(({className:r,...o},s)=>jt.createElement(a7,{ref:s,iconNode:e,className:P3(`lucide-${n7(Rv(n))}`,`lucide-${n}`,r),...o}));return t.displayName=Rv(n),t};const o7=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],l7=Er("activity",o7);const u7=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],gb=Er("arrow-left",u7);const c7=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],f7=Er("briefcase",c7);const h7=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Iv=Er("calendar-days",h7);const d7=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Dv=Er("check",d7);const p7=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],m7=Er("chevron-down",p7);const g7=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],b7=Er("chevron-left",g7);const y7=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],F3=Er("chevron-right",y7);const v7=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],w7=Er("chevron-up",v7);const x7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],S7=Er("circle-alert",x7);const _7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Bv=Er("circle-check",_7);const k7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pv=Er("circle",k7);const A7=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],z3=Er("clipboard",A7);const C7=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],E7=Er("clock",C7);const N7=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],T7=Er("cloud-upload",N7);const j7=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Fv=Er("file-text",j7);const M7=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],L7=Er("file",M7);const O7=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Vm=Er("folder-open",O7);const R7=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Wm=Er("folder",R7);const I7=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],D7=Er("graduation-cap",I7);const B7=[["path",{d:"M13.5 8h-3",key:"xvov4w"}],["path",{d:"m15 2-1 2h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h3",key:"16uttc"}],["path",{d:"M16.899 22A5 5 0 0 0 7.1 22",key:"1d0ppr"}],["path",{d:"m9 2 3 6",key:"1o7bd9"}],["circle",{cx:"12",cy:"15",r:"3",key:"g36mzq"}]],zv=Er("id-card-lanyard",B7);const P7=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],bf=Er("info",P7);const F7=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Gm=Er("loader-circle",F7);const z7=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],q7=Er("log-in",z7);const U7=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],H7=Er("lock",U7);const $7=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],qv=Er("mail",$7);const V7=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],W7=Er("pencil",V7);const G7=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Uv=Er("phone",G7);const Y7=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],X7=Er("plus",Y7);const K7=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Z7=Er("table",K7);const Q7=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],J7=Er("trash-2",Q7);const tk=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ek=Er("user-check",tk);const nk=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],rk=Er("user",nk);const ik=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],sk=Er("x",ik),ak=async n=>{if(n){if(navigator&&navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(n);return}catch(e){console.warn("Clipboard API failed, attempting fallback...",e)}try{const e=document.createElement("textarea");e.value=n,e.style.position="fixed",e.style.left="-9999px",e.style.top="0",e.setAttribute("readonly",""),document.body.appendChild(e),e.focus(),e.select();const t=document.execCommand("copy");document.body.removeChild(e),t||console.error("Fallback copy failed.")}catch(e){console.error("All copy methods failed",e)}}},q3=n=>{if(!n)return"";try{return new Date(n).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"})}catch{return n}},Hv=n=>!n||!/\d/.test(n)?null:n,ok=n=>n?!isNaN(n)&&!isNaN(parseFloat(n))?Ll(n,"long"):q3(n):"",lk=n=>{if(!n)return null;const e=/\b(19|20)\d{2}\b/,t=n.match(e);if(t){const r=t.index+t[0].length;return n.substring(r).trim()||null}return n},uk=n=>{if(!n)return n;const e=/\b(in|with)\b/i,t=n.match(e);let r=n,o=null;if(t){const i=t.index+t[0].length;r=n.substring(0,i);const c=n.substring(i);c&&(o=W.jsx("strong",{children:c},"suffix"))}const s=[],a=/(\bSpanish\b)/gi;let u=0,l;for(;(l=a.exec(r))!==null;)l.index>u&&s.push(r.substring(u,l.index)),s.push(W.jsx("strong",{children:l[0]},`span-${l.index}`)),u=a.lastIndex;return u<r.length&&s.push(r.substring(u)),W.jsxs("span",{children:[s,o]})},ck=`
.hover-bg:hover {
  background: #e5e7eb;
}
`;function Ms({label:n,value:e,displayValue:t,id:r,Icon:o}){const[s,a]=jt.useState(!1);if(!e)return null;const u=async()=>{await ak(e),a(!0),setTimeout(()=>a(!1),1200)};return W.jsxs(W.Fragment,{children:[W.jsx("style",{children:ck}),W.jsxs("div",{id:r,style:{padding:"0.5rem",borderRadius:"0.5rem",cursor:"pointer",position:"relative",transition:"background 0.15s",display:"flex",alignItems:"center",gap:"0.5rem",overflow:"hidden"},className:"hover-bg",onClick:u,children:[W.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(34,197,94,0.25)",opacity:s?1:0,pointerEvents:"none",transition:"opacity 0.7s ease"}}),o&&W.jsx(o,{size:18,color:"#6b7280",style:{flexShrink:0}}),W.jsxs("div",{style:{flex:1},children:[W.jsx("label",{style:{fontSize:"0.75rem",color:"#6b7280"},children:n}),W.jsx("p",{style:{fontWeight:600,color:"#1f2937",margin:0},children:t||e})]})]})]})}function Ym({student:n}){const[e,t]=jt.useState(0),r=3,o=()=>t(c=>Math.max(0,c-1)),s=()=>t(c=>Math.min(r-1,c+1)),a=()=>e===0?"Details":`Details - ${e+1}`,u=n.ProgVersDescrip,l=lk(u),i=uk(l);return W.jsxs(W.Fragment,{children:[W.jsx("div",{className:"sticky-header space-y-4 mb-1 pl-2",children:W.jsxs("div",{className:"flex justify-between items-center",children:[W.jsx("h3",{className:"text-lg font-bold text-gray-800",children:a()}),W.jsxs("div",{className:"flex items-center gap-2",children:[W.jsx("div",{className:"relative",children:W.jsx("button",{id:"nav-left-details-button",className:`bg-gray-500 text-white w-8 h-8 rounded-full shadow-lg flex items-center justify-center hover:bg-gray-600 transition-opacity ${e===0?"opacity-50 cursor-not-allowed":"opacity-100"}`,"aria-label":"Previous",title:"Previous",type:"button",onClick:o,disabled:e===0,children:W.jsx(b7,{className:"h-4 w-4"})})}),W.jsx("div",{className:"relative",children:W.jsx("button",{id:"nav-right-details-button",className:`bg-gray-500 text-white w-8 h-8 rounded-full shadow-lg flex items-center justify-center hover:bg-gray-600 transition-opacity ${e===r-1?"opacity-50 cursor-not-allowed":"opacity-100"}`,"aria-label":"Next",title:"Next",type:"button",onClick:s,disabled:e===r-1,children:W.jsx(F3,{className:"h-4 w-4"})})})]})]})}),W.jsx("div",{id:"panel-details",style:{padding:"0.25rem 1rem 1rem 0.25rem",display:"flex",flexDirection:"column",gap:"1rem"},children:W.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e===0&&W.jsxs(W.Fragment,{children:[W.jsx(Ms,{label:"Student Number",value:n.StudentNumber,id:"copy-student-id",Icon:zv}),W.jsx(Ms,{label:"Primary Phone",value:Hv(n.Phone),id:"copy-primary-phone",Icon:Uv}),W.jsx(Ms,{label:"Other Phone",value:Hv(n.OtherPhone),id:"copy-other-phone",Icon:Uv}),W.jsx(Ms,{label:"Student Email",value:n.StudentEmail,id:"copy-student-email",Icon:qv}),W.jsx(Ms,{label:"Personal Email",value:n.PersonalEmail,id:"copy-personal-email",Icon:qv}),W.jsx(Ms,{label:"Last LDA",value:ok(n.LDA),id:"copy-last-lda",Icon:Iv})]}),e===1&&W.jsxs(W.Fragment,{children:[W.jsx(Ms,{label:"System Student ID",value:n.ID,id:"copy-systudent-id",Icon:zv}),W.jsx(Ms,{label:"Program",value:l,displayValue:i,id:"copy-program",Icon:f7}),W.jsx(Ms,{label:"Instructor",value:n.Instructor,id:"copy-instructor",Icon:rk}),W.jsx(Ms,{label:"Shift",value:n.Shift,id:"copy-shift",Icon:E7}),W.jsx(Ms,{label:"Expected Start Date",value:Ll(n.ExpectedStartDate,"long"),id:"copy-exp-start-date",Icon:Iv}),W.jsx(Ms,{label:"Graduation Date",value:Ll(n.GradDate,"long"),id:"copy-grad-date",Icon:D7})]}),e===2&&W.jsxs(W.Fragment,{children:[W.jsx(Ms,{label:"Last Login",value:q3(n.last_login),id:"copy-last-login",Icon:q7}),W.jsx(Ms,{label:"Admissions Rep",value:n.AdmissionsRep,id:"copy-adm-rep",Icon:ek}),W.jsx(Ms,{label:"Hold Status",value:n.Hold,id:"copy-hold",Icon:H7}),W.jsx(Ms,{label:"SAP Status",value:n.AdSAPStatus,id:"copy-sap-status",Icon:l7})]})]})})]})}var fk=I3();const hk=({label:n,spanClass:e})=>W.jsx("span",{className:`relative inline-flex items-center px-1 py-1 rounded-full text-xs leading-none ${e}`,children:W.jsx("span",{className:"relative z-10",children:n})}),dk=({tag:n,onClick:e,index:t=0,animate:r=!1})=>{const o=t*36,s=r?{animation:`fallDown 320ms cubic-bezier(.22,.9,.17,1) ${o}ms both`}:void 0;return W.jsx("a",{href:"#",className:"px-2 py-1 text-xs text-gray-700 rounded-md flex items-center hover:brightness-95 fall-item",title:n.title,onClick:a=>{a.preventDefault(),e(n.label)},style:s,children:W.jsx(hk,{label:n.label,spanClass:n.spanClass})})},pk=({show:n,onTagClick:e,id:t,tags:r,anchorRef:o,onClose:s,forceClose:a=!1})=>{const[u,l]=jt.useState({top:0,left:0,width:220}),i=jt.useRef(null),[c,p]=jt.useState(!1),[h,f]=jt.useState(!1);return jt.useEffect(()=>{if(n)p(!0),setTimeout(()=>f(!0),10);else if(a)f(!1),p(!1);else{f(!1);const g=setTimeout(()=>p(!1),180);return()=>clearTimeout(g)}},[n,a]),jt.useEffect(()=>{if(n&&o.current){const g=o.current.getBoundingClientRect();l({top:g.bottom+window.scrollY+4,left:g.left+window.scrollX,width:g.width||220})}},[n,o]),jt.useEffect(()=>{if(!n)return;function g(y){i.current&&!i.current.contains(y.target)&&o.current&&!o.current.contains(y.target)&&s?.()}return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[n,s,o]),c?fk.createPortal(W.jsxs("div",{ref:i,id:t,className:`glass-dropdown rounded-lg flex flex-col gap-1 items-stretch bg-gray/60 transition-opacity duration-180 ${h?"opacity-100":"opacity-0 pointer-events-none"}`,style:{position:"absolute",minWidth:"100px",maxHeight:"250px",boxShadow:"0 8px 24px 0 rgb(0 0 0 / 0.08)",overflowY:"auto",borderRadius:"1rem",padding:"0rem 0",zIndex:9999,backdropFilter:"blur(8px)",WebkitBackdropFilter:"blur(8px)",...u},children:[W.jsx("style",{children:`
          .glass-dropdown {
            scrollbar-width: none;
          }
          .glass-dropdown:hover {
            scrollbar-width: thin;
            scrollbar-color: rgba(0,0,0,0.1) transparent;
          }
          .glass-dropdown::-webkit-scrollbar {
            width: 0px;
            background: transparent;
          }
          .glass-dropdown:hover::-webkit-scrollbar {
            width: 6px;
            background: transparent;
          }
          .glass-dropdown::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.1);
            border-radius: 8px;
          }

          /* fall-down animation for tag items */
          .fall-item {
            will-change: transform, opacity;
          }
          @keyframes fallDown {
            from {
              transform: translateY(-12px);
              opacity: 0;
            }
            to {
              transform: translateY(0);
              opacity: 1;
            }
          }
          /* Respect reduced motion preferences */
          @media (prefers-reduced-motion: reduce) {
            .fall-item {
              animation-duration: 0.001ms !important;
              animation-delay: 0ms !important;
            }
          }
        `}),r.map((g,y)=>W.jsx(dk,{tag:g,onClick:e,index:y,animate:h},g.label))]}),document.body):null},U3=({dropdownId:n,onTagClick:e,showDropdown:t,setShowDropdown:r,dropdownTarget:o,setDropdownTarget:s,targetName:a,tags:u,forceCloseDropdown:l=!1})=>{const i=jt.useRef(null);return W.jsxs("div",{className:"relative w-full",children:[W.jsx("button",{ref:i,id:`${n}-button`,type:"button",className:"px-2 py-1 text-xs font-semibold rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300",onClick:()=>{r(c=>!c),s(a)},"aria-expanded":t&&o===a,"aria-controls":n,children:"Insert Tag"}),W.jsx(pk,{show:t&&o===a,onTagClick:e,id:n,tags:u,anchorRef:i,onClose:()=>r(!1),forceClose:l})]})},mk=["January","February","March","April","May","June","July","August","September","October","November","December"],gk=({onDateSelect:n})=>{const e=new Date,[t,r]=jt.useState(e.getMonth()),[o,s]=jt.useState(e.getFullYear()),[a,u]=jt.useState(null),l=new Date(o,t+1,0).getDate(),i=new Date(o,t,1).getDay(),c=[];for(let y=0;y<i;y++)c.push(null);for(let y=1;y<=l;y++)c.push(y);const p=y=>{u(new Date(o,t,y))},h=()=>{a&&n&&n(a)},f=()=>{t===0?(r(11),s(o-1)):r(t-1),u(null)},g=()=>{t===11?(r(0),s(o+1)):r(t+1),u(null)};return W.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 w-72",children:[W.jsxs("div",{className:"flex justify-between items-center mb-2",children:[W.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200",onClick:f,"aria-label":"Previous Month",children:"<"}),W.jsxs("h3",{className:"font-bold",children:[mk[t]," ",o]}),W.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200",onClick:g,"aria-label":"Next Month",children:">"})]}),W.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center text-sm",children:[W.jsx("div",{className:"font-bold text-gray-500",children:"S"}),W.jsx("div",{className:"font-bold text-gray-500",children:"M"}),W.jsx("div",{className:"font-bold text-gray-500",children:"T"}),W.jsx("div",{className:"font-bold text-gray-500",children:"W"}),W.jsx("div",{className:"font-bold text-gray-500",children:"T"}),W.jsx("div",{className:"font-bold text-gray-500",children:"F"}),W.jsx("div",{className:"font-bold text-gray-500",children:"S"}),c.map((y,b)=>y?W.jsx("button",{className:`p-1 rounded-full hover:bg-blue-200 ${a&&a.getDate()===y&&a.getMonth()===t&&a.getFullYear()===o?"bg-blue-600 text-white":""}`,onClick:()=>p(y),children:y},y):W.jsx("div",{},`empty-${b}`))]}),W.jsx("div",{className:"flex justify-end mt-4",children:W.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded disabled:bg-gray-400",disabled:!a,onClick:h,children:"OK"})})]})},bk=["hung up","hanged up","promise","requested","up to date","will catch up","will come","will complete","will engage","will pass","will submit","will work","will be in class","waiting for instructor","waiting for professor","waiting for teacher","waiting on instructor","waiting on professor","waiting on teacher"],yk=n=>{if(!n||typeof n!="string")return{matched:!1,tag:null,lda:{dates:[],keywords:[]}};const e=n.toLowerCase(),t=bk.some(l=>e.includes(l.toLowerCase()));let r=qh(n||""),o=Array.isArray(r.dates)?r.dates:[],s=Array.isArray(r.keywords)?r.keywords:[];if(/^\s*\d+(\.\d+)?\s*$/.test(n||""))try{const l=Number(n.trim());if(!Number.isNaN(l)){const i=Ll(l);let c=null;if(i instanceof Date&&!isNaN(i.getTime())){const p=String(i.getMonth()+1).padStart(2,"0"),h=String(i.getDate()).padStart(2,"0"),f=String(i.getFullYear()).slice(-2);c=`${p}/${h}/${f}`}else typeof i=="string"&&i.trim().length>0&&(c=i.trim());if(c){const p=qh(c);p&&Array.isArray(p.dates)&&p.dates.length>0&&(o=Array.from(new Set([...Array.isArray(o)?o:[],...p.dates]))),p&&Array.isArray(p.keywords)&&p.keywords.length>0&&(s=Array.from(new Set([...Array.isArray(s)?s:[],...p.keywords])))}}}catch{}const u=[];return t&&u.push("Contacted"),Array.isArray(o)&&o.length>0&&u.push(...o.map(l=>`LDA ${l}`)),u.length===0?{matched:!1,tag:null,lda:{dates:o,keywords:s}}:{matched:!0,tag:u.join(", "),lda:{dates:o,keywords:s}}};function qh(n){if(!n||typeof n!="string")return{dates:[],keywords:[]};if(/^\s*\d+(\.\d+)?\s*$/.test(n))try{const g=Number(n.trim());if(!Number.isNaN(g)){const y=Ll(g,"short");if(typeof y=="string"&&y.trim().length>0)return{dates:[y.trim()],keywords:[n.trim()]}}}catch{}const t=["Tomorrow","next week","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","weekend","weekends"],r="\\b\\d{1,2}[\\/\\-]\\d{1,2}(?:[\\/\\-]\\d{2,4})?\\b",o="\\b(?:January|February|March|April|May|June|July|August|September|October|November|December|Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Sept|Oct|Nov|Dec)\\s+\\d{1,2}(?:st|nd|rd|th)?(?:[,\\s]+\\d{2,4})?\\b",s=`\\b(?:${t.map(g=>g.replace(/[.*+?^${}()|[\\]\\\\]/g,"\\$&")).join("|")})\\b`,a=new RegExp(`${r}|${o}|${s}`,"gi"),u=[],l=[];let i;const c=new Date,p=g=>{const y=String(g.getMonth()+1).padStart(2,"0"),b=String(g.getDate()).padStart(2,"0"),v=String(g.getFullYear()).slice(-2);return`${y}/${b}/${v}`},h=g=>({sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6})[g.toLowerCase()],f={january:1,jan:1,february:2,feb:2,march:3,mar:3,april:4,apr:4,may:5,june:6,jun:6,july:7,jul:7,august:8,aug:8,september:9,sep:9,sept:9,october:10,oct:10,november:11,nov:11,december:12,dec:12};for(;(i=a.exec(n))!==null;){const g=i[0];l.push(g);const y=g.match(/^(\d{1,2})[\/\-](\d{1,2})(?:[\/\-](\d{2,4}))?$/);if(y){let S=parseInt(y[1],10),N=parseInt(y[2],10),D=y[3],F;D?D.length===2?F=2e3+parseInt(D,10):F=parseInt(D,10):F=c.getFullYear();const G=new Date(F,S-1,N);isNaN(G.getTime())||u.push(p(G));continue}const b=g.match(/^([A-Za-z]+)\s+(\d{1,2})(?:st|nd|rd|th)?(?:[,\s]+(\d{2,4}))?$/i);if(b){const S=b[1].toLowerCase(),N=parseInt(b[2],10),D=b[3],F=f[S];if(F&&!Number.isNaN(N)){let G;D?D.length===2?G=2e3+parseInt(D,10):G=parseInt(D,10):G=c.getFullYear();const P=new Date(G,F-1,N);isNaN(P.getTime())||u.push(p(P))}continue}const v=g.toLowerCase();if(v==="tomorrow"){const S=new Date(c);S.setDate(S.getDate()+1),u.push(p(S));continue}if(v==="next week"){const S=new Date(c);S.setDate(S.getDate()+7),u.push(p(S));continue}if(v==="weekend"||v==="weekends"){const S=new Date(c),D=(6+7-S.getDay())%7||7;S.setDate(S.getDate()+D),u.push(p(S));continue}const w=h(g);if(typeof w=="number"){const S=new Date(c),N=(w+7-S.getDay())%7||7;S.setDate(S.getDate()+N),u.push(p(S));continue}}return{dates:Array.from(new Set(u)),keywords:Array.from(new Set(l.map(g=>g)))}}function H3({isOpen:n,onClose:e,phone:t,otherPhone:r,email:o,onSelect:s}){const a=u=>{s&&s(u),e&&e()};return W.jsx(o0,{isOpen:n,onClose:e,padding:"12px",overlayStyle:{background:"rgba(0,0,0,0.35)",backdropFilter:"blur(5px) saturate(140%)",WebkitBackdropFilter:"blur(5px) saturate(140%)"},children:W.jsxs("div",{className:"w-full h-full flex flex-col rounded-lg p-4",children:[W.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select DNC Type"}),W.jsxs("div",{id:"dnc-options-container",className:"space-y-2",children:[W.jsxs("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md border",onClick:()=>a("DNC - Phone"),children:["DNC - ",W.jsx("span",{className:"font-bold",children:"Phone:"})," ",t]}),W.jsxs("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md border",onClick:()=>a("DNC - Other Phone"),children:["DNC - ",W.jsx("span",{className:"font-bold",children:"Other Phone:"})," ",r]}),W.jsxs("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md border",onClick:()=>a("DNC - Email"),children:["DNC - ",W.jsx("span",{className:"font-bold",children:"Email:"})," ",o]}),W.jsxs("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md border",onClick:()=>a("DNC"),children:["DNC - ",W.jsx("span",{className:"font-bold",children:"All:"})," All Contact Methods"]})]})]})})}function $3({isOpen:n,onClose:e,onSelect:t}){const r=o=>{if(o&&t){const s=String(o.getMonth()+1).padStart(2,"0"),a=String(o.getDate()).padStart(2,"0"),u=String(o.getFullYear()).slice(-2);t(`LDA ${s}/${a}/${u}`)}e&&e()};return W.jsx(o0,{isOpen:n,onClose:e,padding:"12px",children:W.jsxs("div",{className:"rounded-lg w-auto mx-auto",children:[W.jsx("h3",{className:"font-bold mb-2",id:"month-year",children:"Select LDA Date"}),W.jsx(gk,{onDateSelect:r})]})})}function V3(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var o=n.length;for(e=0;e<o;e++)n[e]&&(t=V3(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function Ju(){for(var n,e,t=0,r="",o=arguments.length;t<o;t++)(n=arguments[t])&&(e=V3(n))&&(r&&(r+=" "),r+=e);return r}function vk(n){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}vk(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var ed=n=>typeof n=="number"&&!isNaN(n),ec=n=>typeof n=="string",Ol=n=>typeof n=="function",wk=n=>ec(n)||ed(n),dg=n=>ec(n)||Ol(n)?n:null,xk=(n,e)=>n===!1||ed(n)&&n>0?n:e,pg=n=>jt.isValidElement(n)||ec(n)||Ol(n)||ed(n);function Sk(n,e,t=300){let{scrollHeight:r,style:o}=n;requestAnimationFrame(()=>{o.minHeight="initial",o.height=r+"px",o.transition=`all ${t}ms`,requestAnimationFrame(()=>{o.height="0",o.padding="0",o.margin="0",setTimeout(e,t)})})}function W3({enter:n,exit:e,appendPosition:t=!1,collapse:r=!0,collapseDuration:o=300}){return function({children:s,position:a,preventExitTransition:u,done:l,nodeRef:i,isIn:c,playToast:p}){let h=t?`${n}--${a}`:n,f=t?`${e}--${a}`:e,g=jt.useRef(0);return jt.useLayoutEffect(()=>{let y=i.current,b=h.split(" "),v=w=>{w.target===i.current&&(p(),y.removeEventListener("animationend",v),y.removeEventListener("animationcancel",v),g.current===0&&w.type!=="animationcancel"&&y.classList.remove(...b))};y.classList.add(...b),y.addEventListener("animationend",v),y.addEventListener("animationcancel",v)},[]),jt.useEffect(()=>{let y=i.current,b=()=>{y.removeEventListener("animationend",b),r?Sk(y,l,o):l()};c||(u?b():(g.current=1,y.className+=` ${f}`,y.addEventListener("animationend",b)))},[c]),Ye.createElement(Ye.Fragment,null,s)}}function $v(n,e){return{content:G3(n.content,n.props),containerId:n.props.containerId,id:n.props.toastId,theme:n.props.theme,type:n.props.type,data:n.props.data||{},isLoading:n.props.isLoading,icon:n.props.icon,reason:n.removalReason,status:e}}function G3(n,e,t=!1){return jt.isValidElement(n)&&!ec(n.type)?jt.cloneElement(n,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):Ol(n)?n({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):n}function _k({closeToast:n,theme:e,ariaLabel:t="close"}){return Ye.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:r=>{r.stopPropagation(),n(!0)},"aria-label":t},Ye.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ye.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function kk({delay:n,isRunning:e,closeToast:t,type:r="default",hide:o,className:s,controlledProgress:a,progress:u,rtl:l,isIn:i,theme:c}){let p=o||a&&u===0,h={animationDuration:`${n}ms`,animationPlayState:e?"running":"paused"};a&&(h.transform=`scaleX(${u})`);let f=Ju("Toastify__progress-bar",a?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${c}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":l}),g=Ol(s)?s({rtl:l,type:r,defaultClassName:f}):Ju(f,s),y={[a&&u>=1?"onTransitionEnd":"onAnimationEnd"]:a&&u<1?null:()=>{i&&t()}};return Ye.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":p},Ye.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${c} Toastify__progress-bar--${r}`}),Ye.createElement("div",{role:"progressbar","aria-hidden":p?"true":"false","aria-label":"notification timer",className:g,style:h,...y}))}var Ak=1,Y3=()=>`${Ak++}`;function Ck(n,e,t){let r=1,o=0,s=[],a=[],u=e,l=new Map,i=new Set,c=w=>(i.add(w),()=>i.delete(w)),p=()=>{a=Array.from(l.values()),i.forEach(w=>w())},h=({containerId:w,toastId:S,updateId:N})=>{let D=w?w!==n:n!==1,F=l.has(S)&&N==null;return D||F},f=(w,S)=>{l.forEach(N=>{var D;(S==null||S===N.props.toastId)&&((D=N.toggle)==null||D.call(N,w))})},g=w=>{var S,N;(N=(S=w.props)==null?void 0:S.onClose)==null||N.call(S,w.removalReason),w.isActive=!1},y=w=>{if(w==null)l.forEach(g);else{let S=l.get(w);S&&g(S)}p()},b=()=>{o-=s.length,s=[]},v=w=>{var S,N;let{toastId:D,updateId:F}=w.props,G=F==null;w.staleId&&l.delete(w.staleId),w.isActive=!0,l.set(D,w),p(),t($v(w,G?"added":"updated")),G&&((N=(S=w.props).onOpen)==null||N.call(S))};return{id:n,props:u,observe:c,toggle:f,removeToast:y,toasts:l,clearQueue:b,buildToast:(w,S)=>{if(h(S))return;let{toastId:N,updateId:D,data:F,staleId:G,delay:P}=S,U=D==null;U&&o++;let q={...u,style:u.toastStyle,key:r++,...Object.fromEntries(Object.entries(S).filter(([I,T])=>T!=null)),toastId:N,updateId:D,data:F,isIn:!1,className:dg(S.className||u.toastClassName),progressClassName:dg(S.progressClassName||u.progressClassName),autoClose:S.isLoading?!1:xk(S.autoClose,u.autoClose),closeToast(I){l.get(N).removalReason=I,y(N)},deleteToast(){let I=l.get(N);if(I!=null){if(t($v(I,"removed")),l.delete(N),o--,o<0&&(o=0),s.length>0){v(s.shift());return}p()}}};q.closeButton=u.closeButton,S.closeButton===!1||pg(S.closeButton)?q.closeButton=S.closeButton:S.closeButton===!0&&(q.closeButton=pg(u.closeButton)?u.closeButton:!0);let R={content:w,props:q,staleId:G};u.limit&&u.limit>0&&o>u.limit&&U?s.push(R):ed(P)?setTimeout(()=>{v(R)},P):v(R)},setProps(w){u=w},setToggle:(w,S)=>{let N=l.get(w);N&&(N.toggle=S)},isToastActive:w=>{var S;return(S=l.get(w))==null?void 0:S.isActive},getSnapshot:()=>a}}var Gs=new Map,Uh=[],mg=new Set,Ek=n=>mg.forEach(e=>e(n)),X3=()=>Gs.size>0;function Nk(){Uh.forEach(n=>Z3(n.content,n.options)),Uh=[]}var Tk=(n,{containerId:e})=>{var t;return(t=Gs.get(e||1))==null?void 0:t.toasts.get(n)};function K3(n,e){var t;if(e)return!!((t=Gs.get(e))!=null&&t.isToastActive(n));let r=!1;return Gs.forEach(o=>{o.isToastActive(n)&&(r=!0)}),r}function jk(n){if(!X3()){Uh=Uh.filter(e=>n!=null&&e.options.toastId!==n);return}if(n==null||wk(n))Gs.forEach(e=>{e.removeToast(n)});else if(n&&("containerId"in n||"id"in n)){let e=Gs.get(n.containerId);e?e.removeToast(n.id):Gs.forEach(t=>{t.removeToast(n.id)})}}var Mk=(n={})=>{Gs.forEach(e=>{e.props.limit&&(!n.containerId||e.id===n.containerId)&&e.clearQueue()})};function Z3(n,e){pg(n)&&(X3()||Uh.push({content:n,options:e}),Gs.forEach(t=>{t.buildToast(n,e)}))}function Lk(n){var e;(e=Gs.get(n.containerId||1))==null||e.setToggle(n.id,n.fn)}function Q3(n,e){Gs.forEach(t=>{(e==null||!(e!=null&&e.containerId)||e?.containerId===t.id)&&t.toggle(n,e?.id)})}function Ok(n){let e=n.containerId||1;return{subscribe(t){let r=Ck(e,n,Ek);Gs.set(e,r);let o=r.observe(t);return Nk(),()=>{o(),Gs.delete(e)}},setProps(t){var r;(r=Gs.get(e))==null||r.setProps(t)},getSnapshot(){var t;return(t=Gs.get(e))==null?void 0:t.getSnapshot()}}}function Rk(n){return mg.add(n),()=>{mg.delete(n)}}function Ik(n){return n&&(ec(n.toastId)||ed(n.toastId))?n.toastId:Y3()}function nd(n,e){return Z3(n,e),e.toastId}function l0(n,e){return{...e,type:e&&e.type||n,toastId:Ik(e)}}function u0(n){return(e,t)=>nd(e,l0(n,t))}function jr(n,e){return nd(n,l0("default",e))}jr.loading=(n,e)=>nd(n,l0("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function Dk(n,{pending:e,error:t,success:r},o){let s;e&&(s=ec(e)?jr.loading(e,o):jr.loading(e.render,{...o,...e}));let a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(i,c,p)=>{if(c==null){jr.dismiss(s);return}let h={type:i,...a,...o,data:p},f=ec(c)?{render:c}:c;return s?jr.update(s,{...h,...f}):jr(f.render,{...h,...f}),p},l=Ol(n)?n():n;return l.then(i=>u("success",r,i)).catch(i=>u("error",t,i)),l}jr.promise=Dk;jr.success=u0("success");jr.info=u0("info");jr.error=u0("error");jr.warning=u0("warning");jr.warn=jr.warning;jr.dark=(n,e)=>nd(n,l0("default",{theme:"dark",...e}));function Bk(n){jk(n)}jr.dismiss=Bk;jr.clearWaitingQueue=Mk;jr.isActive=K3;jr.update=(n,e={})=>{let t=Tk(n,e);if(t){let{props:r,content:o}=t,s={delay:100,...r,...e,toastId:e.toastId||n,updateId:Y3()};s.toastId!==n&&(s.staleId=n);let a=s.render||o;delete s.render,nd(a,s)}};jr.done=n=>{jr.update(n,{progress:1})};jr.onChange=Rk;jr.play=n=>Q3(!0,n);jr.pause=n=>Q3(!1,n);function Pk(n){var e;let{subscribe:t,getSnapshot:r,setProps:o}=jt.useRef(Ok(n)).current;o(n);let s=(e=jt.useSyncExternalStore(t,r,r))==null?void 0:e.slice();function a(u){if(!s)return[];let l=new Map;return n.newestOnTop&&s.reverse(),s.forEach(i=>{let{position:c}=i.props;l.has(c)||l.set(c,[]),l.get(c).push(i)}),Array.from(l,i=>u(i[0],i[1]))}return{getToastToRender:a,isToastActive:K3,count:s?.length}}function Fk(n){let[e,t]=jt.useState(!1),[r,o]=jt.useState(!1),s=jt.useRef(null),a=jt.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:u,pauseOnHover:l,closeToast:i,onClick:c,closeOnClick:p}=n;Lk({id:n.toastId,containerId:n.containerId,fn:t}),jt.useEffect(()=>{if(n.pauseOnFocusLoss)return h(),()=>{f()}},[n.pauseOnFocusLoss]);function h(){document.hasFocus()||v(),window.addEventListener("focus",b),window.addEventListener("blur",v)}function f(){window.removeEventListener("focus",b),window.removeEventListener("blur",v)}function g(G){if(n.draggable===!0||n.draggable===G.pointerType){w();let P=s.current;a.canCloseOnClick=!0,a.canDrag=!0,P.style.transition="none",n.draggableDirection==="x"?(a.start=G.clientX,a.removalDistance=P.offsetWidth*(n.draggablePercent/100)):(a.start=G.clientY,a.removalDistance=P.offsetHeight*(n.draggablePercent===80?n.draggablePercent*1.5:n.draggablePercent)/100)}}function y(G){let{top:P,bottom:U,left:q,right:R}=s.current.getBoundingClientRect();G.nativeEvent.type!=="touchend"&&n.pauseOnHover&&G.clientX>=q&&G.clientX<=R&&G.clientY>=P&&G.clientY<=U?v():b()}function b(){t(!0)}function v(){t(!1)}function w(){a.didMove=!1,document.addEventListener("pointermove",N),document.addEventListener("pointerup",D)}function S(){document.removeEventListener("pointermove",N),document.removeEventListener("pointerup",D)}function N(G){let P=s.current;if(a.canDrag&&P){a.didMove=!0,e&&v(),n.draggableDirection==="x"?a.delta=G.clientX-a.start:a.delta=G.clientY-a.start,a.start!==G.clientX&&(a.canCloseOnClick=!1);let U=n.draggableDirection==="x"?`${a.delta}px, var(--y)`:`0, calc(${a.delta}px + var(--y))`;P.style.transform=`translate3d(${U},0)`,P.style.opacity=`${1-Math.abs(a.delta/a.removalDistance)}`}}function D(){S();let G=s.current;if(a.canDrag&&a.didMove&&G){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance){o(!0),n.closeToast(!0),n.collapseAll();return}G.style.transition="transform 0.2s, opacity 0.2s",G.style.removeProperty("transform"),G.style.removeProperty("opacity")}}let F={onPointerDown:g,onPointerUp:y};return u&&l&&(F.onMouseEnter=v,n.stacked||(F.onMouseLeave=b)),p&&(F.onClick=G=>{c&&c(G),a.canCloseOnClick&&i(!0)}),{playToast:b,pauseToast:v,isRunning:e,preventExitTransition:r,toastRef:s,eventHandlers:F}}var zk=typeof window<"u"?jt.useLayoutEffect:jt.useEffect,c0=({theme:n,type:e,isLoading:t,...r})=>Ye.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:n==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...r});function qk(n){return Ye.createElement(c0,{...n},Ye.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Uk(n){return Ye.createElement(c0,{...n},Ye.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Hk(n){return Ye.createElement(c0,{...n},Ye.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function $k(n){return Ye.createElement(c0,{...n},Ye.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Vk(){return Ye.createElement("div",{className:"Toastify__spinner"})}var gg={info:Uk,warning:qk,success:Hk,error:$k,spinner:Vk},Wk=n=>n in gg;function Gk({theme:n,type:e,isLoading:t,icon:r}){let o=null,s={theme:n,type:e};return r===!1||(Ol(r)?o=r({...s,isLoading:t}):jt.isValidElement(r)?o=jt.cloneElement(r,s):t?o=gg.spinner():Wk(e)&&(o=gg[e](s))),o}var Yk=n=>{let{isRunning:e,preventExitTransition:t,toastRef:r,eventHandlers:o,playToast:s}=Fk(n),{closeButton:a,children:u,autoClose:l,onClick:i,type:c,hideProgressBar:p,closeToast:h,transition:f,position:g,className:y,style:b,progressClassName:v,updateId:w,role:S,progress:N,rtl:D,toastId:F,deleteToast:G,isIn:P,isLoading:U,closeOnClick:q,theme:R,ariaLabel:I}=n,T=Ju("Toastify__toast",`Toastify__toast-theme--${R}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":D},{"Toastify__toast--close-on-click":q}),L=Ol(y)?y({rtl:D,position:g,type:c,defaultClassName:T}):Ju(T,y),E=Gk(n),x=!!N||!l,k={closeToast:h,type:c,theme:R},A=null;return a===!1||(Ol(a)?A=a(k):jt.isValidElement(a)?A=jt.cloneElement(a,k):A=_k(k)),Ye.createElement(f,{isIn:P,done:G,position:g,preventExitTransition:t,nodeRef:r,playToast:s},Ye.createElement("div",{id:F,tabIndex:0,onClick:i,"data-in":P,className:L,...o,style:b,ref:r,...P&&{role:S,"aria-label":I}},E!=null&&Ye.createElement("div",{className:Ju("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!U})},E),G3(u,n,!e),A,!n.customProgressBar&&Ye.createElement(kk,{...w&&!x?{key:`p-${w}`}:{},rtl:D,theme:R,delay:l,isRunning:e,isIn:P,closeToast:h,hide:p,type:c,className:v,controlledProgress:x,progress:N||0})))},J3=(n,e=!1)=>({enter:`Toastify--animate Toastify__${n}-enter`,exit:`Toastify--animate Toastify__${n}-exit`,appendPosition:e}),Xk=W3(J3("bounce",!0)),Kk=W3(J3("slide",!0)),Zk={position:"top-right",transition:Xk,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:n=>n.altKey&&n.code==="KeyT"};function Qk(n){let e={...Zk,...n},t=n.stacked,[r,o]=jt.useState(!0),s=jt.useRef(null),{getToastToRender:a,isToastActive:u,count:l}=Pk(e),{className:i,style:c,rtl:p,containerId:h,hotKeys:f}=e;function g(b){let v=Ju("Toastify__toast-container",`Toastify__toast-container--${b}`,{"Toastify__toast-container--rtl":p});return Ol(i)?i({position:b,rtl:p,defaultClassName:v}):Ju(v,dg(i))}function y(){t&&(o(!0),jr.play())}return zk(()=>{var b;if(t){let v=s.current.querySelectorAll('[data-in="true"]'),w=12,S=(b=e.position)==null?void 0:b.includes("top"),N=0,D=0;Array.from(v).reverse().forEach((F,G)=>{let P=F;P.classList.add("Toastify__toast--stacked"),G>0&&(P.dataset.collapsed=`${r}`),P.dataset.pos||(P.dataset.pos=S?"top":"bot");let U=N*(r?.2:1)+(r?0:w*G);P.style.setProperty("--y",`${S?U:U*-1}px`),P.style.setProperty("--g",`${w}`),P.style.setProperty("--s",`${1-(r?D:0)}`),N+=P.offsetHeight,D+=.025})}},[r,l,t]),jt.useEffect(()=>{function b(v){var w;let S=s.current;f(v)&&((w=S.querySelector('[tabIndex="0"]'))==null||w.focus(),o(!1),jr.pause()),v.key==="Escape"&&(document.activeElement===S||S!=null&&S.contains(document.activeElement))&&(o(!0),jr.play())}return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[f]),Ye.createElement("section",{ref:s,className:"Toastify",id:h,onMouseEnter:()=>{t&&(o(!1),jr.pause())},onMouseLeave:y,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},a((b,v)=>{let w=v.length?{...c}:{...c,pointerEvents:"none"};return Ye.createElement("div",{tabIndex:-1,className:g(b),"data-stacked":t,style:w,key:`c-${b}`},v.map(({content:S,props:N})=>Ye.createElement(Yk,{...N,stacked:t,collapseAll:y,isIn:u(N.toastId,N.containerId),key:`t-${N.key}`},S)))}))}const f0={HISTORY:"Student History",MISSING_ASSIGNMENT:"Missing Assignments"},t4={StudentName:["Student Name","Student"],ID:["Student ID","SyStudentID","Student Identifier","Student Number","Student identifier"],Gender:["Gender"],Phone:["Phone Number","Contact"],CreatedBy:["Created By","Author","Advisor"],OtherPhone:["Other Phone","Alt Phone"],StudentEmail:["Email","Student Email"],PersonalEmail:["Other Email"],Assigned:["Advisor"],ExpectedStartDate:["Expected Start Date","Start Date","ExpStartDate"],Grade:["Current Grade","Grade %","Grade"],LDA:["Last Date of Attendance","LDA"],DaysOut:["Days Out"],Gradebook:["Gradebook","gradeBookLink","Grade Book"],MissingAssignments:["Missing Assignments","Missing"],Outreach:["Outreach","Comments","Notes","Comment"]},Jk={StudentName:["Student Name","Student"],title:["Assignment Title","Title","Assignment"],dueDate:["Due Date","Deadline"],score:["Score","Points"],submissionLink:["Submission Link","Submission","Submit Link"],assignmentLink:["Assignment Link","Assignment URL","Assignment Page","Link"],Gradebook:["Gradebook","gradeBookLink","Grade Book"]},t9={timestamp:["Timestamp","Date","Time","Created At"],comment:["Comment","Notes","History","Entry"],createdBy:["Created By","Author","Advisor"],tag:["Tag","Category","Type","Tags"],StudentID:["Student ID","SyStudentID","Student Identifier","Student Number","Student identifier"],commentID:["Comment ID","History ID","Entry ID","commentID"]},Hh=(n="")=>{try{return String(n??"").normalize("NFKC").toLowerCase().replace(new RegExp("\\p{White_Space}+","gu"),"")}catch{return String(n??"").toLowerCase().replace(/\s+/g,"")}},bb=n=>{const e={};return Object.entries(n).forEach(([t,r])=>{(Array.isArray(r)?r:[r]).forEach(s=>{e[Hh(s)]=t}),e[Hh(t)]=t}),e},Zo=bb(t4);bb(Jk);bb(t9);const e9=(n,e)=>n[Hh(e)]??(typeof e=="string"?e.trim():e),Ml=(n,e,t=Zo,r=t4)=>{if(!Array.isArray(n)||!n.length)return-1;for(let a=0;a<n.length;a++)if(e9(t,n[a])===e)return a;const o=r[e]?[e,...r[e]]:[e],s=new Set(o.map(Hh));for(let a=0;a<n.length;a++)if(s.has(Hh(n[a])))return a;return-1};function Lh(n){return n==null?"":String(n).replace(/\s/g,"").toLowerCase()}function Vv(n){if(!n||typeof n!="string")return null;const e=n.trim(),t=/=\s*HYPERLINK\s*\(\s*["']?([^"',)]+)["']?\s*,/i,r=e.match(t);return r&&r[1]?r[1].trim():/^https?:\/\//i.test(e)?e:null}function Wv(n){if(typeof n!="number"||n<0)return"";let e="",t=n+1;for(;t>0;){const r=(t-1)%26;e=String.fromCharCode(65+r)+e,t=Math.floor((t-1)/26)}return e}async function n9(n,e,t,r){if(console.log("ExcelAPI.editRow: start",{sheet:n,columnId:e,rowId:t}),n.trim()==="")return console.log("ExcelAPI.editRow: finished - invalid parameters"),{success:!1,message:"Parameter 'sheet' is required and must be a non-empty string."};try{let o=!1,s="";return await Excel.run(async a=>{const u=a.workbook.worksheets.getItem(n),l=u.getUsedRange();l.load(["values","columnCount","rowCount"]),await a.sync();const i=l.values[0],c=Ml(i,e,Zo);if(c===-1)throw new Error(`ID column "${e}" not found.`);let p=-1;for(let g=1;g<l.rowCount;g++)if(l.values[g][c]==t){p=g;break}if(p===-1)throw new Error(`Row with ID "${t}" not found.`);for(const[g,y]of Object.entries(r)){const b=Ml(i,g,Zo);b!==-1&&(u.getCell(p,b).values=[[y]])}await a.sync();const h=u.getRangeByIndexes(p,0,1,l.columnCount);h.load("values"),await a.sync();const f=h.values[0];o=Object.entries(r).every(([g,y])=>{const b=Ml(i,g,Zo);return b!==-1&&f[b]==y}),o||(s="Double check failed: Row was not updated as expected.")}),o?(console.log("ExcelAPI.editRow: finished - success"),{success:!0,message:"Row updated successfully."}):{success:!1,message:s}}catch(o){return console.log("ExcelAPI.editRow: finished - error",o?.message),{success:!1,message:o.message}}}async function r9(n,e){if(console.log("ExcelAPI.insertRow: start",{sheet:n}),n.trim()==="")return console.log("ExcelAPI.insertRow: finished - invalid parameters"),{success:!1,message:"Parameter 'sheet' is required and must be a non-empty string."};try{let t=!1,r="";return await Excel.run(async o=>{const s=o.workbook.worksheets.getItem(n),a=s.getUsedRange();a.load(["values","columnCount","rowCount"]),await o.sync();const u=a.values[0],l=Array(a.columnCount).fill("");for(const[p,h]of Object.entries(e)){const f=Ml(u,p,Zo);f!==-1&&(l[f]=h)}s.getRangeByIndexes(a.rowCount,0,1,a.columnCount).values=[l],await o.sync();const i=s.getRangeByIndexes(a.rowCount,0,1,a.columnCount);i.load("values"),await o.sync();const c=i.values[0];t=Object.entries(e).every(([p,h])=>{const f=Ml(u,p,Zo);return f!==-1&&c[f]==h}),t||(r="Double check failed: Row was not inserted as expected.")}),t?(console.log("ExcelAPI.insertRow: finished - success"),{success:!0,message:"Row inserted successfully."}):{success:!1,message:r}}catch(t){return console.log("ExcelAPI.insertRow: finished - error",t?.message),{success:!1,message:t.message}}}async function i9(n,e,t){if(console.log("ExcelAPI.deleteRow: start",{sheet:n,columnId:e,rowId:t}),n.trim()==="")return{success:!1,message:"Parameter 'sheet' is required and must be a non-empty string."};try{let r=!1,o="";return await Excel.run(async s=>{const a=s.workbook.worksheets.getItem(n),u=a.getUsedRange();u.load(["values","columnCount","rowCount"]),await s.sync();const l=u.values[0],i=Ml(l,e,Zo);if(i===-1)throw new Error(`ID column "${e}" not found.`);let c=-1;for(let h=1;h<u.rowCount;h++)if(u.values[h][i]==t){c=h;break}if(c===-1)throw new Error(`Row with ID "${t}" not found.`);a.getRangeByIndexes(c,0,1,u.columnCount).delete(Excel.DeleteShiftDirection.up),await s.sync();const p=a.getUsedRange();p.load("values"),await s.sync(),r=p.values.slice(1).every(h=>h[i]!=t),r||(o="Double check failed: Row was not deleted as expected.")}),r?(console.log("ExcelAPI.deleteRow: finished - success"),{success:!0,message:"Row deleted successfully."}):{success:!1,message:o}}catch(r){return console.log("ExcelAPI.deleteRow: finished - error",r?.message),{success:!1,message:r.message}}}async function s9(n,e=null){console.log("ExcelAPI.onSelectionChanged: start");let t,r=null;const o=250;let s=0;return await Excel.run(async a=>{t=a.workbook.worksheets.getActiveWorksheet().onSelectionChanged.add(async l=>{s++;const i=s;r&&clearTimeout(r),r=setTimeout(async()=>{if(i===s)try{await Excel.run(async c=>{const p=c.workbook.worksheets.getActiveWorksheet(),h=c.workbook.getSelectedRange();h.load("address");const f=await e4(c,p,h,e);if(i!==s){console.log("ExcelAPI: Discarding stale selection data for ID:",i);return}if(!f||!f.success){n({});return}n({address:f.address,data:f.data||{},values:f.values||[],rowCount:f.rowCount||1,allRows:f.allRows||[],hiddenRowCount:f.hiddenRowCount||0})})}catch(c){console.error("onSelectionChanged processing error:",c)}},o)}),await a.sync()}),console.log("ExcelAPI.onSelectionChanged: finished - handler registered"),{remove:async()=>{r&&clearTimeout(r),t&&await Excel.run(async a=>{t.remove(),await a.sync()})}}}async function e4(n,e,t,r=null){let o;typeof t=="string"?o=e.getRange(t):o=t,o.load(["address","rowIndex","rowCount"]);const s=e.getUsedRangeOrNullObject();if(s.load(["values","formulas","rowIndex","columnIndex","columnCount","isNullObject"]),await n.sync(),!s||s.isNullObject||!s.values||s.values.length===0)return{success:!1,message:"No used range / headers found.",address:o.address};const a=s.values[0].map(F=>F==null?"":String(F)),u=typeof s.columnIndex=="number"?s.columnIndex:0,l=s.columnCount||a.length,i=o.rowIndex,c=o.rowCount||1,p=e.getRangeByIndexes(i,u,c,l);p.load("values"),await n.sync();const h=[];for(let F=0;F<c;F++){const G=e.getRangeByIndexes(i+F,u,1,1);G.load("rowHidden"),h.push(G)}await n.sync();const f=typeof s.rowIndex=="number"?s.rowIndex:0,g=(F,G)=>{const P=s.formulas&&s.formulas[G]?s.formulas[G]:[],U={};for(let q=0;q<l;q++){const R=a[q]!==void 0&&a[q]!==null?String(a[q]):"";let I=R;if(r&&typeof r=="object"){const E=Lh(R),x=Object.keys(r).find(k=>{if(!k)return!1;if(Lh(k)===E)return!0;const C=r[k];return(Array.isArray(C)?C:typeof C=="string"?[C]:[]).some(B=>Lh(B)===E)});x&&(I=x)}(!I||I==="")&&(I=`Column${u+q}`);let T=F[q]!==void 0?F[q]:null;const L=P&&P[q]!==void 0?P[q]:null;if(typeof L=="string"&&L.trim().startsWith("=")){const E=Vv(L);E&&(T=E)}else if(typeof T=="string"&&T.trim()!==""){const E=T.trim();if(E.startsWith("=")){const x=Vv(E);x&&(T=x)}}U[I]=T}return U},y=[];for(let F=0;F<c;F++){if(h[F]&&h[F].rowHidden)continue;const P=i+F-f,U=p.values&&p.values[F]?p.values[F]:[],q=g(U,P);y.push(q)}const b={};a.forEach((F,G)=>{b[F]=G});let v=0;for(let F=0;F<c;F++)if(!h[F]||!h[F].rowHidden){v=F;break}const w=p.values&&p.values[v]?p.values[v]:[],S=y.length>0?y[0]:{},N=i+v-f,D=s.formulas&&s.formulas[N]?s.formulas[N]:[];return{success:!0,address:o.address,rowIndex:i,rowCount:y.length,originalRowCount:c,hiddenRowCount:c-y.length,startCol:u,columnCount:l,headers:b,values:w,formulas:D,data:S,allRows:y}}async function a9(n,e,t){if(n.trim()==="")throw new Error("Parameter 'sheet' is required and must be a non-empty string.");console.log("ExcelAPI.checkRow: start",{sheet:n,columnId:e,rowId:t});try{let r=!1;return await Excel.run(async o=>{const a=o.workbook.worksheets.getItem(n).getUsedRange();a.load(["values","rowCount","columnCount"]),await o.sync();const u=a.values[0],l=Ml(u,e,Zo);if(l===-1){r=!1;return}for(let i=1;i<a.rowCount;i++)if(a.values[i][l]==t){r=!0;break}}),console.log("ExcelAPI.checkRow: finished - result",r),r}catch(r){throw console.error("ExcelAPI.checkRow: finished - error",r&&r.message?r.message:r),new Error(r.message||String(r))}}async function o9(n,e,t,r="yellow"){if(!(typeof window.Excel>"u")&&!(typeof n!="number"||typeof e!="number"||typeof t!="number"))try{await Excel.run(async o=>{const s=o.workbook.worksheets.getActiveWorksheet();let a=e-(t-1);a<0&&(a=0);const u=e-a+1;if(u<=0)return;const l=s.getRangeByIndexes(n,a,1,u);l.format.fill.color=r,await o.sync()})}catch{}}async function bg(n,e=null,t=null){if(console.log("ExcelAPI.loadSheet: start",{sheet:n},{identifierColumn:e}),!n||typeof n!="string"||n.trim()==="")return console.log("ExcelAPI.loadSheet: finished - invalid parameters"),{success:!1,message:"Parameter 'sheet' is required and must be a non-empty string."};try{let r=null;return await Excel.run(async o=>{const s=o.workbook.worksheets.getItemOrNullObject(n);if(s.load("isNullObject"),await o.sync(),s.isNullObject)throw new Error(`Worksheet "${n}" not found.`);const a=s.getUsedRangeOrNullObject();if(a.load(["values","formulas","rowCount","columnCount","address","isNullObject"]),await o.sync(),a.isNullObject)r={rowCount:0,columnCount:0,headers:{},data:[]};else{const u=a.values||[],l=a.rowCount||u.length,i=a.columnCount||(u[0]?u[0].length:0),c=u.length?u[0].map(b=>b==null?"":String(b)):[],p={};c.forEach((b,v)=>{p[b]=v});const h=e&&typeof e=="string"?c.findIndex(b=>Lh(b)===Lh(e)):-1,f=/=HYPERLINK\("([^"]+)"/i,g=a.formulas||[];let y;if(h!==-1){y={};for(let b=1;b<u.length;b++){const v=u[b]||[],w=g[b]||[],S={};for(let F=0;F<i;F++){const G=c[F]!==""?c[F]:`Column${F}`;if(S[G]=v[F]!==void 0?v[F]:null,F<w.length){const P=w[F];if(P&&typeof P=="string"){const U=P.match(f);U&&U[1]&&(S[`${G} Link`]=U[1])}}}let N=v[h];if(h<w.length){const F=w[h];if(F&&typeof F=="string"){const G=F.match(f);G&&G[1]&&(N=G[1])}}const D=N==null?`Row${b}`:String(N);y[D]||(y[D]=[]),y[D].push(S)}}else{y=[];for(let b=1;b<u.length;b++){const v=u[b]||[],w=g[b]||[],S={};for(let N=0;N<i;N++){const D=c[N]!==""?c[N]:`Column${N}`;if(S[D]=v[N]!==void 0?v[N]:null,N<w.length){const F=w[N];if(F&&typeof F=="string"){const G=F.match(f);G&&G[1]&&(S[`${D} Link`]=G[1])}}}y.push(S)}}if(t!=null)if(h!==-1){const b=String(t);y=y[b]||[]}else{const b=t;y=(Array.isArray(y)?y:[]).filter(v=>Object.values(v).some(w=>w==b))}r={rowCount:l,columnCount:i,address:a.address,headers:p,data:y}}}),console.log("ExcelAPI.loadSheet: finished - success"),r}catch(r){return console.log("ExcelAPI.loadSheet: finished - error",r?.message),{success:!1,message:r?.message||String(r)}}}async function l9(n,e=null,t={}){const r=typeof n=="function",o=r?n:null,s=r?e:n;try{return await Excel.run(async u=>{console.log("ExcelAPI.getSelectedRange: start");const l=u.workbook.worksheets.getActiveWorksheet(),i=u.workbook.getSelectedRange();i.load(["address","rowIndex"]),await u.sync();const c=await e4(u,l,i,s);if(!c||!c.success){if(o){try{o({})}catch{}return{remove:async()=>{}}}return{success:!1,message:c?.message||"Failed to load range"}}const p=Object.assign({},c,{singleRow:c.data||null,rows:c.data?[c.data]:[]});if(o){try{o({address:c.address,data:c.data||{},values:c.values||[],rowCount:c.rowCount||1,allRows:c.allRows||[],hiddenRowCount:c.hiddenRowCount||0})}catch(h){console.error("getSelectedRange callback error:",h)}return{remove:async()=>{}}}else return console.log("ExcelAPI.getSelectedRange: payload succeeded"),p})}catch(a){if(console.error("ExcelAPI.getSelectedRange: error",a),r&&typeof o=="function"){try{o({})}catch{}return{remove:async()=>{}}}return{success:!1,message:a&&a.message?a.message:String(a)}}}async function u9(n,e,t=null,r=null,o=null){if(console.log("ExcelAPI.onChanged: start",{sheet:e,identifierColumn:t}),typeof n!="function")throw new Error("Parameter 'callback' is required and must be a function.");let s;return await Excel.run(async a=>{let u;u=a.workbook.worksheets.getActiveWorksheet(),s=u.onChanged.add(async l=>{try{if(console.log("ExcelAPI.onChanged: change event fired",{sheet:e,address:l&&l.address}),l&&l.source){const v=l.source,w=typeof v=="string"&&v.toLowerCase()==="local",S=typeof Excel<"u"&&Excel.EventSource&&v===Excel.EventSource.local;if(!w&&!S)return}const i=u.getRange(l.address);i.load(["address","rowIndex","columnIndex","rowCount","columnCount","values","formulas"]);const c=u.getUsedRangeOrNullObject();if(c.load(["values","rowIndex","columnIndex","columnCount","rowCount","isNullObject"]),await a.sync(),c.isNullObject||!c.values||c.values.length===0){const v=[];for(let w=0;w<(i.rowCount||0);w++)for(let S=0;S<(i.columnCount||0);S++){const N=i.rowIndex+w,D=i.columnIndex+S,F=`${Wv(D)}${N+1}`;v.push({address:F,rowIndex:N,colIndex:D,header:null,value:i.values&&i.values[w]?i.values[w][S]:null,identifier:null})}try{n({address:i.address,changes:v})}catch{}return}const p=c.values[0].map(v=>v==null?"":String(v)),h=typeof c.rowIndex=="number"?c.rowIndex:0,f=typeof c.columnIndex=="number"?c.columnIndex:0;let g=-1;t&&typeof t=="string"&&(g=Ml(p,t,Zo));const y=[];for(let v=0;v<(i.rowCount||0);v++)for(let w=0;w<(i.columnCount||0);w++){const S=i.columnIndex+w-f,N=i.rowIndex+v-h,D=i.rowIndex+v,F=i.columnIndex+w,G=S>=0&&S<p.length?p[S]:`Column${f+S}`;let P=null;if(g!==-1){const R=g,I=i.rowIndex+v-h;if(I>=1&&I<c.values.length){const T=c.values[I]||[];P=T[R]!==void 0?T[R]:null}else if(i.columnIndex<=f+g&&f+g<i.columnIndex+i.columnCount){const T=f+g-i.columnIndex;P=i.values&&i.values[v]?i.values[v][T]:null}else P=null}const U=`${Wv(F)}${D+1}`,q=i.values&&i.values[v]?i.values[v][w]:null;y.push({address:U,rowIndex:D,colIndex:F,header:G,value:q,identifier:P})}let b=y;if(g!==-1){const v=f+g;b=y.filter(w=>w.colIndex===v)}if(b.length===0)return;if(g!==-1&&Array.isArray(o)&&o.length>0){const v=o.map(w=>{if(!w||typeof w!="string")return{name:w,relIdx:-1,absIdx:-1};const S=Ml(p,w,Zo);return{name:w,relIdx:S,absIdx:S!==-1?f+S:-1}});b.forEach(w=>{const S=w.rowIndex-i.rowIndex,N=w.rowIndex-h,D={};for(const F of v){let G=null;if(F.relIdx!==-1)if(N>=1&&N<c.values.length){const P=c.values[N]||[];G=P[F.relIdx]!==void 0?P[F.relIdx]:null}else if(F.absIdx!==-1&&i.columnIndex<=F.absIdx&&F.absIdx<i.columnIndex+i.columnCount&&S>=0&&S<(i.values?i.values.length:0)){const P=F.absIdx-i.columnIndex;G=i.values&&i.values[S]?i.values[S][P]:null}else G=null;else G=null;D[F.name]=G}w.otherValues=D})}try{n({address:i.address,changes:b})}catch(v){console.error("onChanged callback error:",v)}}catch(i){console.error("onChanged handler error:",i)}}),await a.sync()}),console.log("ExcelAPI.onChanged: finished - handler registered"),{remove:async()=>{s&&await Excel.run(async a=>{s.remove(),await a.sync()})}}}function n4(n){let e=n;try{e||(typeof SSO<"u"&&SSO&&typeof SSO.getUserName=="function"&&(e=SSO.getUserName()),!e&&typeof window<"u"&&(e=window.localStorage.getItem("ssoUserName")||window.localStorage.getItem("SSO_USER")))}catch{}return e||"Unknown"}function yg(n=null,e=null,t=null){let r="";try{r=n!=null?String(n).replace(/\D/g,""):""}catch{r=""}let o=r.slice(-4);o?o.length<4&&(o=o.padStart(4,"0")):o="0000";let s;try{let u=e?new Date(e):new Date;isNaN(u.getTime())&&(u=new Date);const l=u.getFullYear(),i=String(l).slice(-2).padStart(2,"0"),c=String(u.getMonth()+1).padStart(2,"0"),p=String(u.getDate()).padStart(2,"0");s=`${i}${c}${p}`}catch{const l=new Date,i=l.getFullYear();s=`${String(i).slice(-2).padStart(2,"0")}${String(l.getMonth()+1).padStart(2,"0")}${String(l.getDate()).padStart(2,"0")}`}let a="";try{if(t==null||String(t).trim()===""){const u=Math.floor(Math.random()*1e4);a=String(u).padStart(4,"0")}else a=String(t).split("").map(i=>String(i.charCodeAt(0))).join("").replace(/\D/g,"").slice(-4),a?a.length<4&&(a=a.padStart(4,"0")):a="0000"}catch{const l=Math.floor(Math.random()*1e4);a=String(l).padStart(4,"0")}return`${o}${s}${a}`}async function vg(n,e="",t=null,r=null,o=null){if(!n)return;const s=n4(t);try{const a=String(e||"").toLowerCase().includes("outreach");let u=!1;if(a&&(u=await f9(r)),u){const l=yg(r,new Date,"Outreach"),i={Comment:String(n),Timestamp:Ov(new Date),CreatedBy:String(s),Tag:e},c=await r4(l,i);try{console.log(`${s} edited today's Outreach comment for ${o?String(o):"Unknown Student"}`)}catch{}return $p().catch(()=>{}),c}else{const l=await r9(f0.HISTORY,{ID:r??0,Student:o?String(o):"Unknown Student",Comment:String(n),Timestamp:Ov(new Date),CreatedBy:String(s),Tag:e,commentID:yg(r,new Date,e)});try{console.log(`${s} inserted a new comment for ${o?String(o):"Unknown Student"}`)}catch{}return $p().catch(()=>{}),l}}catch(a){try{console.error("Comment insert/edit failed:",a)}catch{}}}async function $p(){try{if(typeof window<"u"&&typeof window.refreshStudentViewData=="function"){await window.refreshStudentViewData();return}const n=await Mh(()=>Promise.resolve().then(()=>W9),void 0);n&&typeof n.refreshData=="function"&&await n.refreshData()}catch{}}async function r4(n,e){const t=await n9(f0.HISTORY,"commentID",n,e);return $p().catch(()=>{}),t}async function c9(n,e=null){if(n==null)return;const t=n4(e);try{const r=await i9(f0.HISTORY,"commentID",n);try{console.log(`${t} deleted comment ${String(n)} : 'Unknown Student'}`)}catch{}return $p().catch(()=>{}),r}catch(r){try{console.error("Comment delete failed:",r)}catch{}throw r}}async function f9(n=null){try{const e=yg(n,new Date,"Outreach");return await a9(f0.HISTORY,"commentID",e)===!0}catch(e){try{console.error("checkTodaysOutreach failed:",e)}catch{}return!1}}const h9=async n=>{if(n){if(navigator&&navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(n);return}catch(e){console.warn("Clipboard API failed, attempting fallback...",e)}try{const e=document.createElement("textarea");e.value=n,e.style.position="fixed",e.style.left="-9999px",e.style.top="0",e.setAttribute("readonly",""),document.body.appendChild(e),e.focus(),e.select();const t=document.execCommand("copy");document.body.removeChild(e),t||console.error("Fallback copy failed.")}catch(e){console.error("All copy methods failed",e)}}};function d9({isOpen:n,onClose:e,onDeleted:t,onSaved:r,entry:o,COMMENT_TAGS:s,findTagInfo:a,hasQuoteTag:u,quoteText:l,beforeQuote:i,afterQuote:c,formatExcelDate:p,quoteStyles:h={}}){const[f,g]=jt.useState("view"),[y,b]=jt.useState(o.comment||""),[v,w]=jt.useState(o.comment||""),[S,N]=jt.useState({}),[D,F]=jt.useState({}),[G,P]=jt.useState(!1),[U,q]=jt.useState(!1),[R,I]=jt.useState(null),[T,L]=jt.useState(!1),[E,x]=jt.useState(null),[k,A]=jt.useState(!1),[C,j]=jt.useState(!1),B=h.block||"relative bg-blue-50 border-l-4 border-blue-200 pl-6 pr-2 py-3 mb-2 rounded",O=h.text||"text-base text-blue-900 font-serif",H=h.markLeft||"absolute left-2 top-2 text-4xl text-blue-200 leading-none select-none",X=h.markRight||"absolute right-2 bottom-2 text-4xl text-blue-200 leading-none select-none";jt.useEffect(()=>{b(o.comment||""),w(o.comment||"");let yt=o.tag?o.tag.split(",").map(Mt=>Mt.trim()).filter(Boolean):[];yt=yt.filter(Mt=>Mt!=="Comment");const Et={};yt.forEach(Mt=>{Et[Mt]=!0}),N(Et),F(Et),g("view"),j(!1)},[o.comment,o.tag,n]),jt.useEffect(()=>{f==="edit"&&(F(S||{}),b(v||""))},[f,S,v]),jt.useEffect(()=>{f==="view"&&(F(S||{}),b(v||""))},[f,S,v]),jt.useEffect(()=>{P(!1)},[n,f]);const et=async()=>{N(D),w(y);const yt={commentid:o.commentid,comment:y,tag:Object.keys(D).join(", "),createdby:o.createdby,timestamp:o.timestamp};console.log("Updated comment entry:",yt);try{await r4(o.commentid,yt),r(o.commentid)}catch(Et){try{console.error("Edit comment failed:",Et)}catch{}return}g("view")},V=()=>{console.log(`Deleting comment with ID: ${o.commentid}`),t(o.commentid)},tt=yt=>{if(yt.key==='"'){const Et=y,Mt=yt.target.selectionStart;(Et.slice(0,Mt).match(/"/g)||[]).length%2===1&&F(It=>({...It,Quote:!0}))}},$=s.map(yt=>({label:yt.label,spanClass:yt.tagClass,title:yt.label})),z=yt=>{if(yt==="DNC"){q(!1),L(!0),x(!0);return}if(yt==="LDA"){q(!1),A(!0);return}F(Et=>({...Et,[yt]:!0})),q(!1)},Z=yt=>{F(Et=>{const Mt={...Et};return delete Mt[yt],Mt})},it="px-1 py-0.5 text-xs font-semibold rounded-full",mt=W.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,padding:"6px 10px",borderRadius:9999,border:"1px solid #cfcfcf",marginTop:8,minHeight:32,alignItems:"center",width:"100%",boxSizing:"border-box",maxWidth:"100%"},children:Object.keys(D).map((yt,Et)=>{const Mt=a(yt);let qt=Mt?.tagClass?Mt.tagClass.replace(/px-2|py-0\.5|text-[^\s]+/g,""):"";qt=`${it} ${qt} ${Mt?.bgClass||""} ${Mt?.textClass||""}`;let Tt;if(Mt?.tagClass){const It=Mt.tagClass.match(/text-([a-z]+-\d{3,4}|[a-z]+)/);It&&(Tt={"text-red-800":"#991b1b","text-gray-800":"#1f2937","text-gray-200":"#e5e7eb","text-black":"#000","text-orange-800":"#9a3412","text-yellow-800":"#854d0e","text-blue-800":"#1e40af","text-blue-900":"#1e3a8a"}[It[0]]||void 0)}return W.jsxs("span",{className:qt,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.8em",padding:"2px 6px",display:"inline-flex",alignItems:"center",background:(Mt?.bgClass,void 0),borderRadius:9999,marginRight:2,color:Tt},children:[yt,W.jsx("button",{type:"button","aria-label":`Remove ${yt}`,onClick:()=>Z(yt),style:{marginLeft:4,background:"transparent",border:"none",color:Tt||"#888",cursor:"pointer",fontSize:"1em",lineHeight:1},children:""})]},yt)})}),lt=W.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,padding:"6px 10px",borderRadius:9999,border:"2px solid #cfcfcf",marginTop:8,minHeight:32,alignItems:"center",width:"100%",boxSizing:"border-box",maxWidth:"100%",background:"transparent"},children:Object.keys(S).map((yt,Et)=>{const Mt=a(yt);let qt=Mt?.tagClass?Mt.tagClass.replace(/px-2|py-0\.5|text-[^\s]+/g,""):"";qt=`${it} ${qt} ${Mt?.bgClass||""} ${Mt?.textClass||""}`;let Tt;if(Mt?.tagClass){const It=Mt.tagClass.match(/text-([a-z]+-\d{3,4}|[a-z]+)/);It&&(Tt={"text-red-800":"#991b1b","text-gray-800":"#1f2937","text-gray-200":"#e5e7eb","text-black":"#000","text-orange-800":"#9a3412","text-yellow-800":"#854d0e","text-blue-800":"#1e40af","text-blue-900":"#1e3a8a"}[It[0]]||void 0)}return W.jsx("span",{className:qt,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.8em",padding:"2px 6px",display:"inline-flex",alignItems:"center",background:(Mt?.bgClass,void 0),borderRadius:9999,marginRight:2,color:Tt},children:yt},yt)})}),at=yt=>Object.keys(yt||{}).sort().join(", "),rt=at(D)===at(S),ct=!o?.commentid,[ot,dt]=jt.useState(!1),ft=W.jsxs("div",{style:{width:"100%"},onClick:yt=>{yt.target.closest('button[aria-label="Edit"]')||yt.target.closest('button[aria-label="Copy comment"]')||e&&e()},children:[Object.keys(S).length>0&&lt,W.jsxs("div",{style:{marginTop:12,marginBottom:12,position:"relative"},onMouseEnter:()=>dt(!0),onMouseLeave:()=>dt(!1),children:[W.jsx("button",{type:"button","aria-label":C?"Copied":"Copy comment",title:C?"Copied!":"Copy comment",style:{position:"absolute",top:8,right:8,background:C?"#dcfce7":ot?"#e0e0e0":"#e0f2fe",color:C?"#166534":"#000",border:"none",borderRadius:6,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:ot||C?"0 2px 8px rgba(0,0,0,0.12)":"0 1px 4px rgba(0,0,0,0.08)",transition:"all 0.3s ease",opacity:ot||C?.8:0,zIndex:2},onClick:async()=>{let yt;u&&l?yt=`${i||""}${l}${c||""}`:yt=v||"",await h9(yt),j(!0),setTimeout(()=>j(!1),1500)},children:C?W.jsx(Dv,{size:18}):W.jsx(z3,{size:18})}),W.jsx("div",{style:{fontSize:"1rem",color:"#222",whiteSpace:"pre-wrap",wordBreak:"break-word",minHeight:60,paddingLeft:16,paddingTop:6,borderRadius:8,background:"transparent",border:"1px solid #cfcfcf",position:"relative"},children:u&&l?W.jsxs(W.Fragment,{children:[i,W.jsxs("blockquote",{className:B,style:{marginLeft:0},children:[W.jsx("span",{className:H,"aria-hidden":"true",children:""}),W.jsx("span",{className:O,children:l}),W.jsx("span",{className:X,"aria-hidden":"true",children:""})]}),c]}):l4(v)})]}),W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8,width:"100%"},children:[W.jsxs("div",{style:{color:"#666",fontSize:"0.95em",paddingLeft:4},children:[W.jsx("span",{children:o.createdby?o.createdby:"Unknown"}),W.jsx("span",{style:{margin:"0 8px",color:"#bbb"},children:"|"}),W.jsx("span",{children:isNaN(o.timestamp)?o.timestamp:p(o.timestamp)})]}),W.jsx("button",{type:"button",onClick:()=>g("edit"),"aria-label":"Edit",style:{width:36,height:36,borderRadius:"50%",background:"#2563eb",color:"white",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",transition:"background 0.15s, box-shadow 0.15s"},onMouseEnter:yt=>{yt.currentTarget.style.background="#1e40af",yt.currentTarget.style.boxShadow="0 2px 8px rgba(37,99,235,0.15)"},onMouseLeave:yt=>{yt.currentTarget.style.background="#2563eb",yt.currentTarget.style.boxShadow="0 1px 4px rgba(0,0,0,0.08)"},children:W.jsx(W7,{size:20})})]})]}),gt=W.jsxs("div",{style:{width:"100%"},children:[W.jsx(U3,{dropdownId:"modal-insert-tag-dropdown",onTagClick:z,showDropdown:U,setShowDropdown:q,dropdownTarget:R,setDropdownTarget:I,targetName:"modal-comment",tags:$,forceCloseDropdown:T}),Object.keys(D).length>0&&mt,W.jsx("textarea",{value:y,onChange:yt=>b(yt.target.value),onKeyDown:tt,style:{width:"100%",minHeight:80,fontSize:"1rem",marginBottom:12,padding:8,borderRadius:6,border:"1px solid #cfcfcf",resize:"vertical",boxSizing:"border-box"},placeholder:"Edit comment..."}),W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:16,width:"100%",gap:8},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[W.jsx("button",{type:"button",onClick:()=>P(!G),style:{width:36,height:36,borderRadius:"50%",background:ct?"#e5e7eb":G?"#fee2e2":"#ef4444",color:ct?"#9ca3af":G?"#b91c1c":"white",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:ct?"not-allowed":"pointer",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",transition:"background 0.15s, box-shadow 0.15s"},disabled:ct,"aria-label":ct?"Cannot Delete  no comment ID":G?"Cancel Delete":"Delete",title:ct?"Cannot delete  comment does not contain an ID":G?"Cancel Delete":"Delete",onMouseEnter:yt=>{yt.currentTarget.disabled||(yt.currentTarget.style.background=G?"#fecaca":"#dc2626",yt.currentTarget.style.boxShadow=G?"0 2px 8px rgba(220,38,38,0.10)":"0 2px 8px rgba(220,38,38,0.15)")},onMouseLeave:yt=>{yt.currentTarget.disabled||(yt.currentTarget.style.background=G?"#fee2e2":"#ef4444",yt.currentTarget.style.boxShadow="0 1px 4px rgba(0,0,0,0.08)")},children:W.jsx(J7,{size:20})}),W.jsx("span",{style:{fontSize:12,color:"#6b7280",userSelect:"text"},children:o?.commentid?`Comment ID: ${o.commentid}`:"No Comment ID was found"})]}),W.jsxs("div",{style:{display:"flex",gap:8},children:[W.jsx("button",{type:"button",onClick:()=>{F(S||{}),g("view")},style:{width:36,height:36,borderRadius:"50%",background:"#e5e7eb",color:"#222",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 1px 4px rgba(0,0,0,0.08)",transition:"background 0.15s, box-shadow 0.15s"},"aria-label":"Back",title:"Back",onMouseEnter:yt=>{yt.currentTarget.style.background="#d1d5db",yt.currentTarget.style.boxShadow="0 2px 8px rgba(31,41,55,0.12)"},onMouseLeave:yt=>{yt.currentTarget.style.background="#e5e7eb",yt.currentTarget.style.boxShadow="0 1px 4px rgba(0,0,0,0.08)"},children:W.jsx(gb,{size:20})}),W.jsx("button",{type:"button",onClick:G?V:et,disabled:ct?!0:G?!1:y===(o.comment||"")&&rt,style:{width:36,height:36,borderRadius:"50%",background:ct?"#d1d5db":G?"#ef4444":y===(o.comment||"")&&rt?"#d1d5db":"#2563eb",color:ct?"#9ca3af":G?"white":y===(o.comment||"")&&rt?"#888":"white",fontWeight:500,border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:ct?"not-allowed":G?"pointer":y===(o.comment||"")&&rt?"not-allowed":"pointer",opacity:G?1:y===(o.comment||"")&&rt?.7:1,transition:"background 0.15s, box-shadow 0.15s"},"aria-label":ct?"Cannot Update  no comment ID":G?"Confirm Delete":"Update",title:ct?"Cannot modify  comment does not contain an ID":G?"Confirm Delete":"Update",onMouseEnter:yt=>{yt.currentTarget.disabled||(yt.currentTarget.style.background=G?"#dc2626":"#1e40af",yt.currentTarget.style.boxShadow=G?"0 2px 8px rgba(220,38,38,0.15)":"0 2px 8px rgba(37,99,235,0.15)")},onMouseLeave:yt=>{yt.currentTarget.disabled||(yt.currentTarget.style.background=G?"#ef4444":y===(o.comment||"")&&rt?"#d1d5db":"#2563eb",yt.currentTarget.style.boxShadow="0 1px 4px rgba(0,0,0,0.08)")},children:W.jsx(Dv,{size:20})})]})]})]}),wt=yt=>{L(!1),x(!1),yt&&(F(Et=>({...Et,[yt]:!0})),q(!1))};return W.jsxs(W.Fragment,{children:[W.jsx(o0,{isOpen:n,onClose:e,padding:"12px",style:{minHeight:200,width:"100%"},children:f==="view"?ft:gt}),T&&W.jsx(H3,{isOpen:T,onClose:()=>{L(!1),x(!1)},phone:o.phone,otherPhone:o.otherPhone,email:o.email,onSelect:wt}),k&&W.jsx($3,{isOpen:k,onClose:()=>A(!1),keywords:o.ldaKeywords||[],onSelect:yt=>{A(!1),yt&&F(Et=>({...Et,[yt]:!0}))}})]})}const i4="p-3 rounded-lg shadow-sm relative",s4="border-l-4 pl-4",a4="px-2 py-0.5 font-semibold rounded-full",p9=`${a4} bg-gray-100 text-gray-800`,m9=`${a4} bg-white text-gray-700 text-xs opacity-50`,g9="font-medium whitespace-nowrap",b9="flex items-center gap-1",o4="text-xs text-gray-500 mt-2 pt-2 border-t border-gray-200 flex justify-between items-center",y9="text-sm text-gray-800",v9="line-clamp-3",Gv="relative bg-gray-100 border-l-4 border-blue-200 pl-6 pr-2 py-3 mb-2 rounded",Xm="text-sm text-gray-600 font-serif",w9="line-clamp-3",Yv="absolute left-2 top-2 text-4xl text-gray-400 leading-none select-none",Xv="absolute right-2 bottom-2 text-4xl text-gray-400 leading-none select-none",nc=[{label:"Urgent",bgClass:"bg-red-50",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-red-100 text-red-800",priority:2,borderColor:"border-red-400",about:"Reserved for urgent attention"},{label:"Note",bgClass:"bg-gray-200",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-gray-700 text-gray-200",pinned:!0,priority:3,borderColor:"border-gray-400",about:"A pinned note for general information"},{label:"DNC",bgClass:"bg-red-100",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-red-200 text-black",pinned:!0,priority:4,borderColor:"border-red-600",about:"Student requested not to be contacted",subtags:[{label:"DNC - Phone",bgClass:"bg-red-100",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-red-200 text-black",pinned:!0,priority:4,borderColor:"border-red-600",about:"Student requested no phone contact"},{label:"DNC - Other Phone",bgClass:"bg-red-100",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-red-200 text-black",pinned:!0,priority:4,borderColor:"border-red-600",about:"Student requested no other phone contact"},{label:"DNC - Email",bgClass:"bg-red-200",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-red-200 text-black",pinned:!0,priority:4,borderColor:"border-red-600",about:"Student requested no email contact"}]},{label:"LDA",bgClass:"bg-orange-100",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-orange-200 text-orange-800",priority:3,borderColor:"border-orange-400",about:"Student plans to submit LDA"},{label:"Contacted",bgClass:"bg-yellow-100",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-yellow-200 text-yellow-800",priority:2,borderColor:"border-yellow-400",about:"Student gave a response"},{label:"Outreach",bgClass:"bg-gray-100",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-gray-200 text-gray-800",priority:1,borderColor:"border-gray-300",about:"Sourced from the Outreach Column"},{label:"Quote",bgClass:"bg-gray-100",tagClass:"px-2 py-0.5 font-semibold rounded-full bg-blue-50 text-blue-800",priority:2,borderColor:"border-blue-400",about:"Contains quoted text"}];function Kv(n){for(const e of nc){if(e.label===n)return e;if(e.subtags){const t=e.subtags.find(r=>r.label===n);if(t)return t}}if(typeof n=="string"&&n.startsWith("LDA ")){const e=nc.find(t=>t.label==="LDA");if(e)return{...e,label:n,bgClass:"bg-orange-100",priority:3}}return null}function sp({entry:n,searchTerm:e,index:t,onContextMenu:r,delete:o,save:s}){let a=n.tag?n.tag.split(",").map(at=>at.trim()).filter(Boolean):[];a=a.filter(at=>at!=="Comment");const u=a.map(Kv),l=[...u].sort((at,rt)=>{const ct=at?.priority??-1/0;return(rt?.priority??-1/0)-ct});let i=null,c=-1/0;u.forEach((at,rt)=>{at&&typeof at.priority=="number"&&at.priority>c&&(c=at.priority,i=at)}),i||(i=u[0]||null);const p=i&&i.bgClass?i.bgClass:"bg-gray-100";i&&i.tagClass;const h=a.includes("Quote");let f=!1,g=null,y=null;if(i&&i.label&&/^LDA\s+(.+)/i.test(i.label)){f=!0,g=i.label.replace(/^LDA\s+/i,"").trim();let at=[];const rt=g.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(rt){const ct=parseInt(rt[1],10),ot=parseInt(rt[2],10),dt=rt[3],gt=["","January","February","March","April","May","June","July","August","September","October","November","December"][ct]||"",wt=gt?gt.slice(0,3):"";gt&&(at.push(`${gt}\\s+${ot}(?:st|nd|rd|th)?`),at.push(`${wt}\\.?\\s+${ot}(?:st|nd|rd|th)?`)),at.push(`${ct}\\/${ot}\\/${dt}`),dt.length===2&&at.push(`${ct}\\/${ot}\\/20${dt}`)}else at.push(g.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));y=new RegExp(at.join("|"),"gi")}let b=null,v=null,w=null;if(h&&typeof n.comment=="string"){const at=n.comment.match(/^(.*?)["](.*?)["](.*)$/s);at?(b=at[1]?.trim()?W.jsx("p",{className:"text-sm text-gray-800 mb-2",children:at[1].trim()}):null,v=at[2]?.trim(),w=at[3]?.trim()?W.jsx("p",{className:"text-sm text-gray-800 mt-2",children:at[3].trim()}):null):v=n.comment}let S=n.comment;if(!h||!v){if(f&&n.comment&&y){let at=0,rt=[],ct;for(y.lastIndex=0;(ct=y.exec(n.comment))!==null;)ct.index>at&&rt.push(n.comment.slice(at,ct.index)),rt.push(W.jsx("b",{children:ct[0]},`lda-date-${ct.index}`)),at=y.lastIndex;at<n.comment.length&&rt.push(n.comment.slice(at)),S=rt.flatMap(ot=>l4(ot))}else if(e&&n.comment){const at=new RegExp(`(${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");S=n.comment.split(at).map((rt,ct)=>at.test(rt)?W.jsx("mark",{className:"bg-yellow-200 px-0.5 rounded",children:rt},ct):rt)}}let N=n.timestamp;isNaN(n.timestamp)||(N=Ll(n.timestamp));const F=(()=>{if(n.timestamp==null)return N;if(!isNaN(n.timestamp))try{const rt=Number(n.timestamp),ct=new Date(1899,11,30);return new Date(ct.getTime()+rt*864e5).toLocaleDateString()}catch{}const at=String(N).match(/\b\d{1,2}[\/-]\d{1,2}[\/-]\d{2,4}\b/);return at?at[0]:String(N).split(" at ")[0].split(",")[0]})(),[G,P]=jt.useState(!1),[U,q]=jt.useState(!1),[R,I]=jt.useState(!1),T=Ye.useRef(null),[L,E]=jt.useState(!1),x=Ye.useRef(null),[k,A]=jt.useState(!1),[C,j]=jt.useState([]),[B,O]=jt.useState(!1),H=Ye.useRef(null),X=Ye.useRef(null),[et,V]=jt.useState(2),tt=Ye.useRef(null);Ye.useEffect(()=>{const at=X.current;if(!at)return;const rt=dt=>{const ft=Math.round(dt||at.offsetWidth||at.clientWidth||0),gt=150,wt=92,yt=Math.max(0,ft-gt),Et=Math.max(1,Math.floor(yt/wt)),Mt=Math.min(2,Et);V(Mt),tt.current!==ft&&(tt.current=ft)},ct=dt=>{if(dt&&dt.length){const ft=dt[0],gt=ft.contentRect?ft.contentRect.width:ft.target.getBoundingClientRect().width;rt(gt)}else{const ft=at.getBoundingClientRect();rt(ft.width)}};ct();let ot;return typeof ResizeObserver<"u"?(ot=new ResizeObserver(ct),ot.observe(at)):window.addEventListener("resize",ct),()=>{ot?ot.disconnect():window.removeEventListener("resize",ct)}},[t]);const $=at=>{j(rt=>{const ct=[...rt];return ct[at]=!0,ct}),setTimeout(()=>{j(rt=>{const ct=[...rt];return ct[at]=!1,ct})},500)},z=at=>{at&&at.about&&jr.info(at.about,{position:"bottom-left",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!1,theme:"light",style:{fontSize:"1rem"}})};if(Ye.useEffect(()=>{if(T.current){const at=T.current,rt=window.getComputedStyle(at),ct=parseFloat(rt.lineHeight),ot=at.scrollHeight/ct;E(ot>3.1)}if(x.current){const at=x.current,rt=window.getComputedStyle(at),ct=parseFloat(rt.lineHeight),ot=at.scrollHeight/ct;A(ot>3.1)}},[n.comment,S,v,G]),R)return null;const Z=i&&i.borderColor?i.borderColor:"border-gray-300",mt={"bg-red-50":"#FFE5E5","bg-gray-200":"#D7DBDE","bg-red-100":"#FAD7D7","bg-orange-100":"#FFDEB8","bg-yellow-100":"#F7ECC1","bg-gray-100":"#EBEBEB","bg-blue-100":"#bfdbfe","bg-blue-50":"#EBEBEB"}[p]||"#e0e7ff";function lt(at){if(at&&/^LDA\s+(.+)/i.test(at.label)){const rt=at.label.replace(/^LDA\s+/i,"").trim();return W.jsxs("span",{className:"lda-tag-label",children:[W.jsx("span",{className:"hidden sm:inline",children:"LDA"}),rt]})}return at.label}return W.jsxs(W.Fragment,{children:[W.jsxs("li",{ref:X,className:`${i4} ${p} ${s4} ${Z}`,"data-row-index":n.studentId||t,onContextMenu:r,style:{position:"relative",transition:"background 0.15s, box-shadow 0.15s, opacity 300ms ease, transform 300ms ease, height 300ms ease, margin 300ms ease, padding 300ms ease",opacity:U?0:1,transform:U?"translateX(8px) scale(0.995)":"none",overflow:U?"hidden":void 0,paddingTop:U?0:void 0,paddingBottom:U?0:void 0,marginTop:U?0:void 0,marginBottom:U?0:void 0,height:U?0:void 0,pointerEvents:U?"none":void 0},onClick:()=>O(!0),tabIndex:0,role:"button","aria-label":"Open comment modal",onMouseEnter:at=>{at.currentTarget.style.background=mt,at.currentTarget.style.boxShadow="0 4px 16px rgba(59,130,246,0.10)"},onMouseLeave:at=>{at.currentTarget.style.background="",at.currentTarget.style.boxShadow=""},children:[W.jsx(B3,{}),h&&v?W.jsxs(W.Fragment,{children:[b,W.jsxs("blockquote",{className:Gv,children:[W.jsx("span",{className:Yv,"aria-hidden":"true",children:""}),W.jsx("span",{ref:x,className:`${Xm} ${G?"":w9}`,style:G?{userSelect:"none"}:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",userSelect:"none"},children:v}),W.jsx("span",{className:Xv,"aria-hidden":"true",children:""}),W.jsxs("div",{className:`${Xm} mt-1 text-right`,children:["- ",D3(n.studentName||n.student||n.createdby)||"Unknown"]})]}),w]}):W.jsx(W.Fragment,{children:W.jsx("p",{ref:T,className:`${y9} ${G?"":v9}`,style:G?{userSelect:"none"}:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",userSelect:"none"},children:S})}),W.jsxs("div",{className:o4,children:[W.jsxs("div",{ref:H,className:b9,style:{flex:1},children:[l.slice(0,et).map((at,rt)=>{if(!at)return null;let ct=at.tagClass?at.tagClass:p9;return l.length>1&&at.label==="Outreach"&&(ct+=" opacity-75"),W.jsx("span",{className:`${ct}${C[rt]?" bounce":""}`,style:{maxWidth:90,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",userSelect:"none"},onClick:ot=>{ot.stopPropagation(),$(rt),z(at)},tabIndex:0,"aria-label":`Bounce ${at.label} tag`,children:lt(at)},at.label+rt)}),l.length>et&&W.jsxs("span",{className:m9,children:["+",l.length-et]})]}),W.jsx("span",{className:g9,style:{marginLeft:"auto"},children:n.createdby?n.createdby:"Unknown"}),W.jsx("span",{className:"mx-2 text-gray-400",children:"|"}),W.jsx("span",{children:et===1?F:N})]})]}),W.jsx(d9,{isOpen:B,onSaved:at=>{s(at)},onClose:()=>O(!1),onDeleted:at=>{o(at),O(!1)},entry:n,COMMENT_TAGS:nc,findTagInfo:Kv,hasQuoteTag:h,quoteText:v,beforeQuote:b,afterQuote:w,formatExcelDate:Ll,quoteStyles:{block:Gv,text:Xm,markLeft:Yv,markRight:Xv}})]})}function x9({lines:n=1,showAvatar:e=!0,showTags:t=!0}){const o={background:"linear-gradient(90deg, rgba(0,0,0,0.06) 0%, rgba(0,0,0,0.035) 20%, rgba(0,0,0,0.06) 40%, rgba(0,0,0,0.035) 60%, rgba(0,0,0,0.06) 100%)",backgroundSize:"200% 100%",animation:"shimmer 3s linear infinite"},s=Math.max(1,n),a=Array.from({length:s}).map((u,l)=>W.jsx("div",{style:{...o,width:l===0?"90%":l===s-1?"60%":"85%"}},l));return W.jsxs(W.Fragment,{children:[W.jsx("style",{children:`
        @keyframes shimmer {
          0% { background-position: 200% 0; }
          100% { background-position: -200% 0; }
        }
      `}),W.jsxs("li",{className:`${i4} bg-gray-50 ${s4} border-gray-300`,"aria-hidden":"true",style:{overflow:"hidden"},children:[W.jsxs("div",{className:"flex items-start",children:[e&&W.jsx("div",{style:{...o,width:36,height:36,borderRadius:"50%",marginRight:12}}),W.jsxs("div",{style:{flex:1},children:[W.jsx("div",{style:{...o,height:12,width:"45%",marginBottom:10,borderRadius:6}}),a,W.jsxs("div",{className:"mt-2 flex items-center gap-2",style:{marginTop:8},children:[t&&W.jsxs(W.Fragment,{children:[W.jsx("div",{style:{...o,width:72,height:22,borderRadius:9999}}),W.jsx("div",{style:{...o,width:56,height:22,borderRadius:9999}})]}),W.jsx("div",{style:{flex:1}}),W.jsx("div",{style:{...o,width:80,height:12,borderRadius:6}})]})]})]}),W.jsx("div",{className:o4,style:{marginTop:12},children:W.jsx("div",{style:{...o,width:120,height:10,borderRadius:6}})})]})]})}function l4(n){if(typeof n!="string")return n;const{keywords:e}=qh(n||"");if(!e||e.length===0)return n;const r=Array.from(new Set(e)).sort((l,i)=>i.length-l.length).map(l=>l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),o=new RegExp(`(${r.join("|")})`,"gi"),s=[];let a=0,u;for(;(u=o.exec(n))!==null;){const l=u.index;l>a&&s.push(n.slice(a,l)),s.push(W.jsx("b",{children:u[0]},`lda-match-${l}`)),a=o.lastIndex}return a<n.length&&s.push(n.slice(a)),s.length>0?s:n}const S9=({tags:n=[],tag:e=null,className:t="",onRemove:r,onChange:o})=>{let s=[];typeof n=="string"?s=n.split(",").map(h=>h.trim()).filter(Boolean).map(h=>({label:h})):Array.isArray(n)?s=n:e&&(s=[e]);const u=(s||[]).map(h=>typeof h=="string"?h:h&&h.label||"").filter(Boolean).join(", ");if(jt.useEffect(()=>{typeof o=="function"&&o(u)},[u,o]),!s||s.length===0)return null;const l={display:"flex",flexWrap:"wrap",gap:4,padding:"2px 10px",borderRadius:9999,border:"1.5px solid #cfcfcf",marginTop:0,minHeight:32,alignItems:"center",width:"100%",boxSizing:"border-box",maxWidth:"100%",background:"transparent"},i="px-1 py-0.5 text-xs font-semibold rounded-full",c={overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.8em",padding:"2px 6px",display:"inline-flex",alignItems:"center",gap:0,borderRadius:9999,marginRight:0},p={margin:0,background:"transparent",border:"none",cursor:"pointer",fontSize:"0.85em",lineHeight:1,padding:"0 4px",color:"#374151",display:"inline-flex",alignItems:"center",justifyContent:"center"};return W.jsx("div",{className:`${t}`,style:l,children:s.map((h,f)=>{const g=typeof h=="string"?h:h.label||String(f),y=typeof h=="object"&&h.spanClass||"";return W.jsxs("span",{className:`${i} ${y}`,style:c,title:g,children:[W.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:g}),typeof r=="function"&&W.jsx("button",{type:"button","aria-label":`Remove ${g}`,onClick:b=>{b.stopPropagation(),r(g)},style:p,children:""})]},g+f)})})},_9=`
  @keyframes fadeInDrop {
    from {
      opacity: 0.5;
      transform: translateY(-1px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fadein {
    animation: fadeInDrop 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
`;function k9({show:n,onClose:e,addCommentToHistory:t,initialComment:r="",phone:o="",otherPhone:s="",email:a=""}){const u=jt.useRef(null),[l,i]=jt.useState(!1),c=jt.useRef(null),[p,h]=jt.useState(!1),[f,g]=jt.useState(!1),[y,b]=jt.useState(!1),[v,w]=jt.useState(!1),[S,N]=jt.useState(null),[D,F]=jt.useState([]),G=C=>{F(j=>j.filter(B=>(typeof B=="string"?B:B.label)!==C))},P=(Array.isArray(nc)?nc:[]).map(C=>({label:C.label,title:C.title||C.label,spanClass:C.tagClass||C.spanClass||C.bgClass||""})),U=Ye.useRef(null),q=Ye.useRef([]),R=C=>{const j=(C||[]).map(O=>`LDA ${O}`),B=P.find(O=>(O.label||"").toUpperCase()==="LDA");F(O=>{const H=O.filter(V=>!((typeof V=="string"?V:V.label)||"").toUpperCase().startsWith("LDA")),X=new Set(O.map(V=>typeof V=="string"?V:V.label)),et=j.filter(V=>!X.has(V)).map(V=>({label:V,title:V,spanClass:B?B.spanClass:"bg-gray-100 text-gray-800"}));return[...H,...et]})},I=(C=800)=>{U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{F(j=>j.filter(B=>!((typeof B=="string"?B:B.label)||"").toUpperCase().startsWith("LDA"))),q.current=[],U.current=null},C)},T=C=>{if(C.key==='"'){const j=u.current;if(!j)return;const B=j.value,O=j.selectionStart;if((B.slice(0,O).match(/"/g)||[]).length%2===1){const et=P.find(V=>V.label==="Quote")||{label:"Quote",spanClass:"bg-blue-50 text-blue-800"};F(V=>V.some(tt=>(typeof tt=="string"?tt:tt.label)==="Quote")?V:[...V,et])}}},L=C=>{if(C==="DNC"){w(!1),N(null),h(!0),g(!0);return}if(C==="LDA"){w(!1),N(null),b(!0);return}w(!1),N(null);const j=P.find(B=>B.label===C)||{label:C,spanClass:"bg-gray-100 text-gray-800"};F(B=>B.some(O=>(typeof O=="string"?O:O.label)===j.label)?B:[...B,j])},E=C=>{if(h(!1),g(!1),C){const j=P.find(O=>(O.label||"").toUpperCase()==="DNC"),B={label:C,title:C,spanClass:j?j.spanClass:"bg-gray-100 text-gray-800"};F(O=>O.some(H=>(typeof H=="string"?H:H.label)===B.label)?O:[...O,B]),w(!1)}},x=C=>{if(b(!1),C){const j=P.find(O=>(O.label||"").toUpperCase()==="LDA"),B={label:C,title:C,spanClass:j?j.spanClass:"bg-gray-100 text-gray-800"};F(O=>O.some(H=>(typeof H=="string"?H:H.label)===B.label)?O:[...O,B])}},k=C=>{const j=C.target.value,B=qh(j||"")||{dates:[]},O=Array.isArray(B.dates)?B.dates:[];if(O.length>0){U.current&&(clearTimeout(U.current),U.current=null);const H=q.current||[];O.length===H.length&&O.every((et,V)=>et===H[V])||(R(O),q.current=O)}else I(800)};Ye.useEffect(()=>(c.current=!0,()=>{c.current=!1,U.current&&(clearTimeout(U.current),U.current=null)}),[]),Ye.useEffect(()=>{if(u.current){u.current.value=r;const C=qh(r||"")||{dates:[]},j=Array.isArray(C.dates)?C.dates:[];j.length>0&&(R(j),q.current=j)}},[r,n]);const A=async()=>{const C=u.current.value.trim();if(!C)return;i(!0),e&&e();const j=(D||[]).map(B=>typeof B=="string"?B:B&&B.label||"").filter(Boolean).join(", ");try{console.log("Submitting comment with tags:",j),await t(C,j)?c.current&&u.current&&(u.current.value="",F([])):console.error("Failed to add comment")}catch(B){console.error("Error adding comment",B)}finally{c.current&&i(!1)}};return W.jsxs(W.Fragment,{children:[W.jsx("style",{children:_9}),W.jsxs("div",{id:"new-comment-section",className:`relative p-1 bg-gradient-to-br from-white via-gray-50 to-gray-100 border border-gray-200 rounded-2xl shadow-xl transition-all duration-200 ${n?"animate-fadein opacity-100":"hidden opacity-0"}`,children:[W.jsxs("div",{className:"flex flex-col gap-2 mb-3",children:[W.jsx("div",{className:"flex items-center justify-start",children:W.jsx(U3,{dropdownId:"new-comment-tags",onTagClick:L,showDropdown:v,setShowDropdown:w,dropdownTarget:S,setDropdownTarget:N,targetName:"newComment",tags:P,forceCloseDropdown:p||y||f})}),W.jsx(S9,{tags:D,onRemove:G})]}),W.jsx("textarea",{id:"new-comment-input",ref:u,className:"w-full p-3 border border-gray-300 rounded-xl bg-white shadow-inner focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all duration-150 text-base placeholder-gray-400 resize-vertical",rows:3,placeholder:"Add a new comment...",onChange:k,onKeyDown:T}),W.jsx("div",{className:"flex justify-end items-center mt-4",children:W.jsx("button",{id:"submit-comment-button",className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white font-semibold rounded-xl shadow-md hover:from-blue-700 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-150 disabled:bg-gray-400 disabled:from-gray-400 disabled:to-gray-400",onClick:A,disabled:l,children:"Submit"})})]}),p&&W.jsx(H3,{isOpen:p,onClose:()=>{h(!1),g(!1)},phone:o,otherPhone:s,email:a,onSelect:E}),y&&W.jsx($3,{isOpen:y,onClose:()=>b(!1),onSelect:x})]})}let wg=!1;const xg=new EventTarget;function Sg(n=!0){wg=!!n,xg.dispatchEvent(new CustomEvent("change",{detail:wg}))}function A9(){return wg}const C9=`
  @keyframes fadeInDrop {
    from {
      opacity: 0;
      transform: translateY(-24px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-fadein {
    animation: fadeInDrop 0.4s cubic-bezier(0.4,0,0.2,1);
  }
  /* See-through scrollbar styles */
  #history-content {
    scrollbar-width: thin; /* Firefox */
    scrollbar-color: rgba(0,0,0,0.15) rgba(0,0,0,0.03);
    position: relative; /* allow overlay absolute positioning */
  }
  #history-content::-webkit-scrollbar {
    width: 8px;
    background: transparent;
  }
  #history-content::-webkit-scrollbar-thumb {
    background: rgba(0,0,0,0.15);
    border-radius: 8px;
  }
  #history-content::-webkit-scrollbar-track {
    background: rgba(0,0,0,0.03);
  }

  /* Skeleton overlay that sits above comments and fades out
     Remove padding so layout/spacing exactly matches the normal comment list */
  .skeleton-overlay {
    position: absolute;
    inset: 0;
    z-index: 20;
    background: rgba(255,255,255,0.9);
    display: flex;
    flex-direction: column;
    padding: 0; /* keep items aligned with comments */
    /* Allow skeleton content to overfill the overlay; do NOT show overlay scrollbars */
    overflow: visible;
    transition: opacity 400ms cubic-bezier(0.4,0,0.2,1), visibility 400ms;
  }
`;function E9(n){if(!n)return null;if(!isNaN(n)){const t=new Date(Date.UTC(1899,11,30)),r=new Date(t.getTime()+n*864e5);return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`}const e=new Date(n);return isNaN(e.getTime())?null:`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`}function N9(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function T9(){return new Date().getFullYear()}function Zv(n){const[e,t]=n.split("-"),r=["January","February","March","April","May","June","July","August","September","October","November","December"],o=parseInt(t,10)-1;return r[o]}function ap(n){if(n==null)return 0;if(!isNaN(n)){const t=Number(n);return new Date(Date.UTC(1899,11,30)).getTime()+t*864e5}const e=new Date(n);return isNaN(e.getTime())?0:e.getTime()}function j9({history:n,student:e,reload:t}){console.log("Rendering StudentHistory with history:",n,"and student:",e);const[r,o]=jt.useState(Array.isArray(n)?n:[]),[s,a]=jt.useState(A9()),[u,l]=jt.useState(!1),[i,c]=jt.useState({pinnedComments:[],currentMonthComments:[],currentYearMonths:[],yearGroups:{},sortedYears:[]}),p=s||n==null||!u;jt.useEffect(()=>{},[p]);const[h,f]=jt.useState(!1),[g,y]=jt.useState(""),[b,v]=jt.useState(!1),[w,S]=jt.useState({}),N=jt.useRef(w);jt.useEffect(()=>{N.current=w},[w]);const[D,F]=jt.useState({}),G=jt.useRef(D);jt.useEffect(()=>{G.current=D},[D]),jt.useEffect(()=>{o(Array.isArray(n)?n:[]),n!=null&&(a(!1),Sg(!1))},[n]),jt.useEffect(()=>{const k=A=>{a(!!A.detail)};return xg.addEventListener("change",k),()=>xg.removeEventListener("change",k)},[]),jt.useEffect(()=>{if(!Array.isArray(r)||r.length===0){c({pinnedComments:[],currentMonthComments:[],currentYearMonths:[],yearGroups:{},sortedYears:[]}),S({}),F({}),l(!0),a(!1),Sg(!1);return}l(!1);let k;const A=()=>{try{const j=r.map(ct=>Lv(ct||{})).filter(ct=>!g||ct.comment&&ct.comment.toLowerCase().includes(g.toLowerCase())),B=ct=>ct.tag?ct.tag.split(",").map(dt=>dt.trim()).some(dt=>{const ft=nc.find(gt=>gt.label===dt);if(ft&&(ft.pinned||Array.isArray(ft.subtags)&&ft.subtags.some(gt=>gt.pinned)))return!0;for(const gt of nc)if(Array.isArray(gt.subtags)){const wt=gt.subtags.find(yt=>yt.label===dt);if(wt&&wt.pinned)return!0}return!1}):!1,O=j.filter(B).slice().sort((ct,ot)=>ap(ot.timestamp)-ap(ct.timestamp)),H=j.filter(ct=>!B(ct)).slice().sort((ct,ot)=>ap(ot.timestamp)-ap(ct.timestamp)),X=N9(),et=T9(),V=[],tt={},$={};H.forEach(ct=>{const ot=E9(ct.timestamp);if(!ot)return;const[dt]=ot.split("-"),ft=parseInt(dt,10);ot===X?V.push(ct):ft===et?(tt[ot]||(tt[ot]=[]),tt[ot].push(ct)):($[ft]||($[ft]={}),$[ft][ot]||($[ft][ot]=[]),$[ft][ot].push(ct))});const z=Object.keys(tt).sort((ct,ot)=>ot.localeCompare(ct)),Z=Object.keys($).map(ct=>parseInt(ct,10)).sort((ct,ot)=>ot-ct),it={};Z.forEach(ct=>{const ot=Object.keys($[ct]).sort((dt,ft)=>ft.localeCompare(dt));it[ct]={monthGroups:$[ct],sortedMonths:ot}});const lt={...N.current||{}};z.forEach(ct=>{ct in lt||(lt[ct]=!0)}),Z.forEach(ct=>{Object.keys($[ct]).forEach(ot=>{const dt=`${ct}-${ot}`;dt in lt||(lt[dt]=!0)})}),Object.keys(lt).forEach(ct=>{const ot=z.includes(ct),dt=Z.some(ft=>$[ft]&&Object.keys($[ft]).includes(ct));!ot&&!dt&&delete lt[ct]});const rt={...G.current||{}};Z.forEach(ct=>{ct in rt||(rt[ct]=!0)}),Object.keys(rt).forEach(ct=>{Z.includes(parseInt(ct,10))||delete rt[ct]}),S(lt),F(rt),c({pinnedComments:O,currentMonthComments:V,currentYearMonths:z.map(ct=>({month:ct,comments:tt[ct]})),yearGroups:it,sortedYears:Z}),l(!0)}catch{S({}),F({}),c({pinnedComments:[],currentMonthComments:[],currentYearMonths:[],yearGroups:{},sortedYears:[]}),l(!0)}};return typeof window<"u"&&"requestIdleCallback"in window?k=window.requestIdleCallback(A,{timeout:500}):k=setTimeout(A,0),()=>{typeof window<"u"&&"cancelIdleCallback"in window&&k&&typeof k=="number"?window.cancelIdleCallback(k):k&&clearTimeout(k)}},[r,g]);function P(k){S(A=>({...A,[k]:!A[k]}))}function U(k){F(A=>({...A,[k]:!A[k]}))}async function q(k,A=""){if(!k)return!1;try{const C=(e&&(e.ID??e.Id??e.id))??null,j=(e&&(e.Student??e.StudentName??e.Name))??null;return await vg(String(k),A,void 0,C,j),await t(),jr.success("Comment saved"),!0}catch{return o(j=>Array.isArray(j)?j.filter(B=>B!==commentPreviewEntry):[]),jr.error("Failed to save comment"),!1}}async function R(k){await c9(k),await t(),jr.error("Comment deleted")}async function I(k){await t(),jr.success("Comment changes saved")}const T=jt.useRef(s||n==null||!u),L=jt.useRef(null),E=jt.useRef(null);jt.useEffect(()=>{T.current=s||n==null||!u},[s,n,u]),jt.useEffect(()=>(s||n==null||!u?L.current||(L.current=setTimeout(()=>{T.current&&!E.current&&(E.current=jr.warn("Uh oh. This is taking longer than usual",{autoClose:6e3}))},3e3)):(L.current&&(clearTimeout(L.current),L.current=null),E.current=null),()=>{L.current&&(clearTimeout(L.current),L.current=null)}),[s,n,u]);const x=Ye.useMemo(()=>{let k=0,A=0;for(const C of r||[]){const B=(Lv(C||{}).tag||"").toLowerCase(),O=B.includes("contacted"),H=B.includes("outreach");(O||H)&&(A++,O&&k++)}return console.log("[ContactRate]",{contacted:k,total:A,rate:A>0?Math.round(k/A*100):null}),A>0?Math.round(k/A*100):null},[r]);return W.jsxs("div",{children:[W.jsx("style",{children:C9}),W.jsxs("div",{className:"sticky-header space-y-4 pl-2",children:[W.jsxs("div",{className:"flex justify-between items-center",children:[W.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"History"}),W.jsxs("div",{className:"flex items-center space-x-2",children:[x!==null&&W.jsxs("div",{className:`w-8 h-8 rounded-full shadow-lg flex items-center justify-center text-[10px] font-bold ${x>=50?"bg-green-100 text-green-800":x>=25?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,title:`Contact rate: ${x}%`,children:[x,"%"]}),W.jsx("button",{id:"search-history-button",className:"bg-gray-600 text-white w-8 h-8 rounded-full shadow-lg flex items-center justify-center hover:bg-gray-700",onClick:()=>f(k=>!k),"aria-label":"Search history",children:W.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),W.jsx("button",{id:"add-comment-button",className:"bg-blue-600 text-white w-8 h-8 rounded-full shadow-lg flex items-center justify-center hover:bg-blue-700",onClick:()=>v(k=>!k),"aria-label":"Add comment",children:W.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})]}),W.jsxs("div",{id:"search-container",className:`${h?"":"hidden"} space-y-2`,children:[W.jsx("div",{id:"tag-filter-container",className:"flex flex-wrap items-center gap-2 pb-2 border-b border-gray-200"}),W.jsxs("div",{className:"relative",children:[W.jsx("input",{type:"text",id:"search-input",className:"w-full p-2 pl-8 border rounded-md",placeholder:"Search comments...",value:g,onChange:k=>y(k.target.value),autoFocus:h}),W.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:W.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),W.jsx("button",{id:"clear-search-button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",type:"button",onClick:()=>y(""),"aria-label":"Clear search",children:""})]})]}),W.jsx(k9,{show:b,onClose:()=>v(!1),addCommentToHistory:q})]}),W.jsxs("div",{id:"history-content",className:"overflow-y-auto",style:{height:b||h?"calc(105vh - 460px)":"calc(100vh - 260px)"},children:[W.jsx("ul",{className:"space-y-4",children:!Array.isArray(r)||r.length===0?W.jsx("li",{className:"p-3 bg-gray-100 rounded-lg shadow-sm relative",children:W.jsx("p",{className:"text-sm text-gray-800",children:"Student has no comments yet"})}):W.jsxs(W.Fragment,{children:[i.pinnedComments.map((k,A)=>W.jsx(sp,{entry:k,searchTerm:g,index:A,delete:R,save:I},`pinned-${A}`)),[...i.currentMonthComments].map((k,A)=>W.jsx(sp,{entry:k,searchTerm:g,index:A,delete:R,save:I},`currentmonth-${A}`)),(i.currentYearMonths||[]).map(({month:k,comments:A})=>W.jsxs("li",{className:"bg-gray-50 rounded-lg shadow-sm p-2",children:[W.jsxs("div",{className:"flex items-center font-semibold text-gray-700 mb-2 cursor-pointer select-none",onClick:()=>P(k),style:{userSelect:"none"},"aria-label":w[k]?"Expand":"Collapse",tabIndex:0,role:"button",onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&P(k)},children:[W.jsx("span",{className:"mr-2 text-gray-500",style:{fontSize:"1.2em",lineHeight:"1"},children:w[k]?W.jsx(Wm,{size:20,strokeWidth:2}):W.jsx(Vm,{size:20,strokeWidth:2})}),Zv(k)]}),!w[k]&&W.jsx("ul",{className:"space-y-2",children:[...A||[]].map((C,j)=>W.jsx(sp,{entry:C,searchTerm:g,index:j,delete:R,save:I},`month-${k}-${j}`))})]},k)),(i.sortedYears||[]).map(k=>W.jsxs("li",{className:"bg-gray-100 rounded-lg shadow-md p-2 mb-2",children:[W.jsxs("div",{className:"flex items-center font-bold text-gray-800 mb-2 cursor-pointer select-none",onClick:()=>U(k),style:{userSelect:"none"},"aria-label":D[k]?"Expand":"Collapse",tabIndex:0,role:"button",onKeyDown:A=>{(A.key==="Enter"||A.key===" ")&&U(k)},children:[W.jsx("span",{className:"mr-2 text-gray-600",style:{fontSize:"1.2em",lineHeight:"1"},children:D[k]?W.jsx(Wm,{size:22,strokeWidth:2.5}):W.jsx(Vm,{size:22,strokeWidth:2.5})}),k]}),!D[k]&&i.yearGroups[k]&&W.jsx("ul",{className:"space-y-2 ml-2",children:i.yearGroups[k].sortedMonths.map(A=>W.jsxs("li",{className:"bg-gray-50 rounded-lg shadow-sm p-2",children:[W.jsxs("div",{className:"flex items-center font-semibold text-gray-700 mb-2 cursor-pointer select-none",onClick:()=>P(`${k}-${A}`),style:{userSelect:"none"},"aria-label":w[`${k}-${A}`]?"Expand":"Collapse",tabIndex:0,role:"button",onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&P(`${k}-${A}`)},children:[W.jsx("span",{className:"mr-2 text-gray-500",style:{fontSize:"1.2em",lineHeight:"1"},children:w[`${k}-${A}`]?W.jsx(Wm,{size:20,strokeWidth:2}):W.jsx(Vm,{size:20,strokeWidth:2})}),Zv(A)]}),!w[`${k}-${A}`]&&W.jsx("ul",{className:"space-y-2",children:[...i.yearGroups[k].monthGroups[A]||[]].map((C,j)=>W.jsx(sp,{entry:C,searchTerm:g,index:j,delete:R,save:I},`year-${k}-month-${A}-${j}`))})]},A))})]},k))]})}),W.jsx("div",{className:"skeleton-overlay",style:{opacity:p?1:0,pointerEvents:p?"auto":"none",visibility:"visible"},"aria-hidden":!p,children:W.jsx("ul",{className:"space-y-4",children:Array.from({length:5}).map((k,A)=>W.jsx(x9,{},`skeleton-${A}`))})})]})]})}const M9="bg-gray-100 shadow rounded-md p-0.5 flex flex-col md:flex-row md:items-center md:justify-between text-sm",L9="flex-1 flex items-center justify-between",O9="font-semibold text-sm text-gray-800 flex items-center",R9="flex gap-1 ml-2",I9="text-xs text-gray-500",D9="text-xs text-gray-600",Qv={student:["Student Name","Student"],title:["Assignment Title","Title","Assignment"],dueDate:["Due Date","Deadline"],score:["Score","Points"],submissionLink:["Submission Link","Submit Link"],assignmentLink:["Assignment Link","Assignment URL","Assignment Page","Link"],gradebook:["Gradebook","gradeBookLink","Grade Book"],submission:["submission","Submitted","Submission Status","Is Submitted"]};function B9({assignments:n,reload:e}){const t=jt.useMemo(()=>{if(!n||!n.length){const h={};for(const[f,g]of Object.entries(Qv))h[f]=g&&g.length?g[0]:f;return h}const i=h=>String(h||"").toLowerCase().replace(/[^a-z0-9]/g,""),c=Object.keys(n[0]),p={};for(const[h,f]of Object.entries(Qv)){let g=c.find(y=>f.some(b=>i(b)===i(y)));g||(g=c.find(y=>i(y)===i(h))),p[h]=g||(f&&f.length?f[0]:h)}return p},[n]),r=jt.useMemo(()=>{if(!n||!n.length)return[];const i={jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,sept:8,oct:9,nov:10,dec:11},c=f=>{if(!f)return Number.POSITIVE_INFINITY;if(!isNaN(f)&&String(f).trim()!=="")try{let U=Number(f);Number.isInteger(U)&&(U+=.9993055556);const q=Ll(U);if(q){const R=new Date(q);if(!isNaN(R.getTime()))return R.getTime()}}catch(U){console.warn("Excel date parse failed, falling back to string parse",U)}const y=String(f).trim().match(/^([A-Za-z]+)\s+(\d{1,2})(?:\s*(?:by)?\s*([\d:]+\s*[ap]m)?)?/i);if(!y)return Number.POSITIVE_INFINITY;const b=y[1].toLowerCase().slice(0,3),v=parseInt(y[2],10),w=y[3]?y[3].replace(/\s+/g,"").toLowerCase():null,S=i[b];if(S===void 0)return Number.POSITIVE_INFINITY;let N=23,D=59;if(w){const U=w.match(/(\d{1,2}):?(\d{2})?(am|pm)?/);if(U){const q=parseInt(U[1],10),R=U[2]?parseInt(U[2],10):0,I=U[3];N=q%12,I==="pm"&&(N+=12),!I&&q===24&&(N=0),D=R}}const F=new Date;let G=F.getFullYear();const P=new Date(G,S,v,N,D);return P.getTime()<F.getTime()-1e3*60*60*24*330&&P.setFullYear(G+1),P.getTime()},h=[...n.filter(f=>{const g=f[t.title];return!(!g||String(g).trim().toUpperCase()==="N/A")})];return h.sort((f,g)=>{const y=c(f[t.dueDate]),b=c(g[t.dueDate]);return y-b}),h},[n,t]),[o,s]=jt.useState(!1),a=async()=>{try{if(!navigator.permissions||!navigator.permissions.query)return console.log("Permissions API not available  will attempt clipboard write (may prompt)."),!0;const i=await navigator.permissions.query({name:"clipboard-write"});return i.state==="denied"?(console.log("Clipboard permission: denied"),!1):(console.log("Clipboard permission:",i.state),!0)}catch{return console.log("Could not determine clipboard permission (error), will attempt write."),!0}},u=async()=>{try{const i=(r||[]).map(g=>{const y=g[t.title]||"",b=g[t.assignmentLink]||g[t.link]||"";return{title:y,link:b}}).filter(g=>!!g.link);if(i.length===0){s(!0),setTimeout(()=>s(!1),1200);return}const c=g=>String(g||"").replace(/\s+/g," ").trim(),p=i.map(g=>`- ${c(g.title)||"Untitled"}: ${c(g.link)}`).join(`
`),h=await a();let f=!1;if(h&&navigator&&navigator.clipboard&&typeof navigator.clipboard.writeText=="function")try{await navigator.clipboard.writeText(p),f=!0,console.log("Copied to clipboard via Clipboard API")}catch(g){console.log("Clipboard writeText failed, falling back to textarea method:",g),f=!1}if(!f){if(!h)try{window.alert("Clipboard access is denied. Please allow clipboard access in your browser settings or use the manual copy fallback.")}catch{}const g=document.createElement("textarea");g.value=p,g.style.position="fixed",g.style.left="-9999px",document.body.appendChild(g),g.select();try{document.execCommand("copy"),console.log("Copied to clipboard via textarea fallback")}catch(y){console.log("Textarea fallback copy failed",y)}document.body.removeChild(g)}s(!0),setTimeout(()=>s(!1),1200)}catch{s(!1)}},l=i=>{if(i==null||i==="")return"";if(!isNaN(i)&&String(i).trim()!=="")try{let c=Number(i);return Number.isInteger(c)&&(c+=.9993055556),Ll(c)}catch{return i}return i};return W.jsxs(W.Fragment,{children:[W.jsx("style",{children:`
          .student-assignments.custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            background: transparent;
          }
          .student-assignments.custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.15);
            border-radius: 8px;
          }
          .student-assignments.custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.03);
          }

          /* Tooltip styles: positioned to the LEFT of the button, vertically centered.
             Starts slightly right (invisible) and when .visible it fades in and slides left. */
          .tooltip {
            position: absolute;
            top: 50%;
            right: calc(100% + 8px); /* place to the left of the button */
            left: auto;
            transform: translateY(-50%) translateX(12px); /* start slightly to the right */
            background-color: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 180ms ease-out, transform 220ms cubic-bezier(.2,.8,.2,1);
            pointer-events: none;
            box-shadow: 0 6px 18px rgba(0,0,0,0.18);
          }
          .tooltip.visible {
            opacity: 1;
            transform: translateY(-50%) translateX(-8px); /* slide left into place */
          }
        `}),W.jsx("div",{className:"sticky-header space-y-4 mb-2 pl-2",children:W.jsxs("div",{className:"flex justify-between items-center",children:[W.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Assignments"}),W.jsx("div",{className:"flex items-center",children:W.jsxs("div",{className:"relative",children:[W.jsx("button",{id:"copy-assignments-button",className:"bg-gray-500 text-white w-8 h-8 rounded-full shadow-lg flex items-center justify-center hover:bg-gray-600","aria-label":"Copy assignments",title:o?"Copied":"Copy assignment links",type:"button",onClick:u,children:W.jsx(z3,{className:"h-4 w-4"})}),o&&W.jsx("div",{className:"tooltip visible",children:"Copied!"})]})})]})}),W.jsx("div",{className:"student-assignments max-h-125 overflow-y-auto grid gap-4 custom-scrollbar",style:{scrollbarWidth:"thin",scrollbarColor:"rgba(0,0,0,0.15) rgba(0,0,0,0.03)"},children:r&&r.length>0?r.map((i,c)=>{const p=Object.prototype.hasOwnProperty.call(i,t.submission)?i[t.submission]:!1,h=p===!1||typeof p=="string"&&p.toLowerCase()==="missing",f=h?"border-red-500":"border-blue-300";return W.jsx("div",{className:`${M9} group border-l-4 ${f} pl-4`,children:W.jsxs("div",{className:`${L9} w-full`,children:[W.jsxs("div",{className:"flex-1 flex flex-col justify-between h-full",children:[W.jsxs("div",{children:[W.jsx("div",{className:O9,children:i[t.assignmentLink]?W.jsx("a",{href:i[t.assignmentLink],target:"_blank",rel:"noopener noreferrer",title:"View Assignment",style:{textDecoration:"none"},children:i[t.title]}):W.jsx("span",{title:"No Assignment",children:i[t.title]})}),W.jsxs("div",{className:I9,children:["Due: ",l(i[t.dueDate])]}),h&&W.jsx("div",{className:"mt-1",children:i[t.submissionLink]?W.jsx("a",{href:i[t.submissionLink],target:"_blank",rel:"noopener noreferrer",className:"rounded-full bg-white-500 px-2 py-0 flex items-center border border-red-500 cursor-pointer",title:"View Submission",style:{width:"60px",justifyContent:"center"},children:W.jsx("div",{className:"text-red-500 text-xs font-semibold",children:"missing"})}):W.jsx("div",{className:"rounded-full bg-white-500 px-2 py-0 flex items-center border border-red-500 opacity-50 cursor-not-allowed",title:"No Submission",style:{width:"70px",justifyContent:"center"},children:W.jsx("div",{className:"text-red-500 text-xs font-semibold",children:"missing"})})})]}),W.jsx("div",{className:"flex justify-end mt-2",children:W.jsxs("div",{className:D9+" flex items-center",children:["Score: ",i[t.score]===""||i[t.score]===void 0||i[t.score]===null?0:i[t.score]]})})]}),W.jsx("div",{className:`${R9} flex-shrink-0`})]})},c)}):W.jsx("div",{className:"text-gray-500 pl-2",children:"No assignments found."})})]})}class P9{constructor(){this.isExtensionInstalled=!1,this.isChecking=!1,this.pingInterval=null,this.keepAliveInterval=null,this.listeners=new Set,this.handleMessage=this.handleMessage.bind(this),this.setupMessageListener()}setupMessageListener(){window.addEventListener("message",this.handleMessage)}handleMessage(e){if(!(!e.data||!e.data.type))switch(e.data.type){case"SRK_EXTENSION_INSTALLED":console.log("ChromeExtensionService: Extension detected!"),this.handleExtensionDetected();break;case"SRK_HIGHLIGHT_STUDENT_ROW":console.log("ChromeExtensionService: Highlight student row request received:",e.data),this.handleHighlightStudentRow(e.data.data);break;case"SRK_NAVIGATE_TO_STUDENT":console.log("ChromeExtensionService: Navigate to student request received:",e.data),this.handleNavigateToStudent(e.data.data);break;case"SRK_IMPORT_MASTER_LIST":console.log("ChromeExtensionService: Import master list request received:",e.data),this.notifyListeners({type:"message",data:e.data});break;default:this.notifyListeners({type:"message",data:e.data})}}handleExtensionDetected(){this.isExtensionInstalled||(this.isExtensionInstalled=!0,this.stopPinging(),this.notifyListeners({type:"installed",installed:!0}))}sendHighlightConfirmation(e,t,r){const o={type:"SRK_HIGHLIGHT_CONFIRMATION",data:{syStudentId:e||"",status:t,message:r,timestamp:Date.now()}};console.log(`ChromeExtensionService: Sending highlight confirmation (${t}):`,o),this.sendMessage(o)}async handleHighlightStudentRow(e){if(typeof window.Excel>"u"){const c="Excel API is not available. The add-in may not be running inside Excel.";console.warn("ChromeExtensionService:",c),this.sendHighlightConfirmation(e?.syStudentId,"error",c);return}if(!e||!e.syStudentId||!e.targetSheet){const c="Missing required parameters: syStudentId and targetSheet are required.";console.error("ChromeExtensionService:",c,e),this.sendHighlightConfirmation(e?.syStudentId,"error",c);return}const{studentName:t,syStudentId:r,startCol:o,endCol:s,targetSheet:a,color:u="#FFFF00",editColumn:l,editText:i}=e;if(o==null){const c="startCol is required but was not provided.";console.error("ChromeExtensionService:",c,{startCol:o}),this.sendHighlightConfirmation(r,"error",c);return}if(s==null){const c="endCol is required but was not provided.";console.error("ChromeExtensionService:",c,{endCol:s}),this.sendHighlightConfirmation(r,"error",c);return}if(typeof o!="number"&&typeof o!="string"){const c=`startCol must be a number or string, but received ${typeof o}.`;console.error("ChromeExtensionService:",c,{startCol:o}),this.sendHighlightConfirmation(r,"error",c);return}if(typeof s!="number"&&typeof s!="string"){const c=`endCol must be a number or string, but received ${typeof s}.`;console.error("ChromeExtensionService:",c,{endCol:s}),this.sendHighlightConfirmation(r,"error",c);return}if(l!==void 0&&typeof l!="number"&&typeof l!="string"){const c=`editColumn must be a number or string, but received ${typeof l}.`;console.error("ChromeExtensionService:",c,{editColumn:l}),this.sendHighlightConfirmation(r,"error",c);return}l!==void 0&&i===void 0&&console.warn("ChromeExtensionService: editColumn specified but editText is missing");try{await Excel.run(async c=>{const p=I=>{if(!I||typeof I!="string")return[I];const T=/^(.*?)(\d{1,2}[/-]\d{1,2}[/-]\d{4})$/,L=I.match(T);if(!L)return[I];const E=L[1],x=L[2];let k=null;if(x.includes("/"))k="/";else if(x.includes("-"))k="-";else return[I];const A=x.split(k);if(A.length!==3)return[I];const[C,j,B]=A,O=new Set;return O.add(I),["/","-"].forEach(X=>{O.add(`${E}${C.padStart(2,"0")}${X}${j.padStart(2,"0")}${X}${B}`),O.add(`${E}${parseInt(C,10)}${X}${parseInt(j,10)}${X}${B}`),O.add(`${E}${C.padStart(2,"0")}${X}${parseInt(j,10)}${X}${B}`),O.add(`${E}${parseInt(C,10)}${X}${j.padStart(2,"0")}${X}${B}`)}),Array.from(O)};let h=c.workbook.worksheets.getItemOrNullObject(a);if(h.load("isNullObject"),await c.sync(),h.isNullObject){const I=p(a);if(I.length>1){const T=c.workbook.worksheets;T.load("items/name"),await c.sync();let L=null;for(const E of I){const x=T.items.find(k=>k.name===E);if(x){L=x.name;break}}L&&(console.log(`ChromeExtensionService: Found sheet "${L}" using date format normalization (requested: "${a}")`),h=c.workbook.worksheets.getItem(L))}}if(h.load("isNullObject"),await c.sync(),h.isNullObject){const I=`Sheet "${a}" not found in the workbook. Verify the sheet name is correct (sheet names are case-sensitive).`;console.error("ChromeExtensionService:",I),this.sendHighlightConfirmation(r,"error",I);return}const f=h.getUsedRange();f.load(["values","rowCount","columnCount","rowIndex"]),await c.sync();const g=f.values,y=g[0],b=(I,T)=>{if(typeof I=="number"){if(I<0){const x=`${T} must be >= 0, but received ${I}.`;return console.error("ChromeExtensionService:",x,{[T]:I}),{index:-1,error:x}}if(I>=y.length){const x=`${T} index (${I}) exceeds the number of columns in the sheet (${y.length}).`;return console.error("ChromeExtensionService:",x,{[T]:I}),{index:-1,error:x}}return{index:I,error:null}}const L=String(I).trim();for(let x=0;x<y.length;x++)if(String(y[x]).trim().toLowerCase()===L.toLowerCase())return{index:x,error:null};const E=`Column "${L}" not found in sheet "${a}". Check that the column header exists in row 1.`;return console.error("ChromeExtensionService:",E,{[T]:I}),{index:-1,error:E}},v=b(o,"startCol"),w=b(s,"endCol");if(v.error||w.error){const I=v.error||w.error;this.sendHighlightConfirmation(r,"error",I);return}const S=v.index,N=w.index;if(S>N){const I=`startCol (${o}, index ${S}) must be less than or equal to endCol (${s}, index ${N}).`;console.error("ChromeExtensionService:",I),this.sendHighlightConfirmation(r,"error",I);return}let D=-1;if(l!==void 0){const I=b(l,"editColumn");if(I.error){this.sendHighlightConfirmation(r,"error",I.error);return}D=I.index}let F=-1;const G=["Student ID","SyStudentID","Student identifier","ID"];for(let I=0;I<y.length;I++)if(G.some(T=>String(y[I]).trim().toLowerCase()===T.toLowerCase())){F=I;break}if(F===-1){const I=`Could not find a Student ID column in sheet "${a}". Expected one of: ${G.join(", ")}.`;console.error("ChromeExtensionService:",I),this.sendHighlightConfirmation(r,"error",I);return}let P=-1;for(let I=1;I<g.length;I++)if(String(g[I][F]).trim()===String(r).trim()){P=I;break}if(P===-1){const I=`Student with ID "${r}" not found in sheet "${a}". Verify the student ID exists in the sheet.`;console.warn("ChromeExtensionService:",I),this.sendHighlightConfirmation(r,"error",I);return}const U=f.rowIndex+P,q=N-S+1,R=h.getRangeByIndexes(U,S,1,q);if(R.format.fill.color=u,await c.sync(),l!==void 0&&i!==void 0&&D!==-1){const I=h.getRangeByIndexes(U,D,1,1);I.values=[[i]],await c.sync(),console.log(`ChromeExtensionService: Successfully edited cell at column "${l}" (index ${D}) with text "${i}"`)}console.log(`ChromeExtensionService: Successfully highlighted student "${t}" (ID: ${r}) in "${a}" from column "${o}" (index ${S}) to "${s}" (index ${N})`),this.sendHighlightConfirmation(r,"success","Row highlighted successfully"),this.notifyListeners({type:"highlight_complete",data:{studentName:t,syStudentId:r,targetSheet:a,startCol:o,endCol:s,startColIndex:S,endColIndex:N,color:u,editColumn:l,editColumnIndex:D,editText:i,timestamp:new Date().toISOString()}})})}catch(c){console.error("ChromeExtensionService: Error highlighting student row:",c);let p=c.message||"An unknown error occurred while highlighting the row.";c.code==="InvalidReference"?p="Invalid cell reference. The worksheet structure may have changed.":c.code==="GeneralException"?p="Excel encountered an error. The workbook may be protected, read-only, or in use by another process.":c.code==="AccessDenied"?p="Access denied. The workbook or sheet may be protected.":c.message&&c.message.includes("network")&&(p="A network error occurred. Check your connection to Excel Online."),this.sendHighlightConfirmation(r,"error",p),this.notifyListeners({type:"highlight_error",data:{studentName:t,syStudentId:r,editColumn:l,editText:i,error:p,timestamp:new Date().toISOString()}})}}async handleNavigateToStudent(e){if(typeof window.Excel>"u"){console.warn("ChromeExtensionService: Excel API is not available for navigation.");return}if(!e||!e.syStudentId||!e.targetSheet){console.error("ChromeExtensionService: Navigate requires syStudentId and targetSheet.",e);return}const{syStudentId:t,targetSheet:r}=e;try{await Excel.run(async o=>{const s=y=>{if(!y||typeof y!="string")return[y];const b=/^(.*?)(\d{1,2}[/-]\d{1,2}[/-]\d{4})$/,v=y.match(b);if(!v)return[y];const w=v[1],S=v[2],N=S.includes("/")?"/":S.includes("-")?"-":null;if(!N)return[y];const D=S.split(N);if(D.length!==3)return[y];const[F,G,P]=D,U=new Set;return U.add(y),["/","-"].forEach(q=>{U.add(`${w}${F.padStart(2,"0")}${q}${G.padStart(2,"0")}${q}${P}`),U.add(`${w}${parseInt(F,10)}${q}${parseInt(G,10)}${q}${P}`),U.add(`${w}${F.padStart(2,"0")}${q}${parseInt(G,10)}${q}${P}`),U.add(`${w}${parseInt(F,10)}${q}${G.padStart(2,"0")}${q}${P}`)}),Array.from(U)};let a=o.workbook.worksheets.getItemOrNullObject(r);if(a.load("isNullObject"),await o.sync(),a.isNullObject){const y=s(r);if(y.length>1){const b=o.workbook.worksheets;b.load("items/name"),await o.sync();let v=null;for(const w of y){const S=b.items.find(N=>N.name===w);if(S){v=S.name;break}}v&&(console.log(`ChromeExtensionService: Navigate - found sheet "${v}" via date normalization (requested: "${r}")`),a=o.workbook.worksheets.getItem(v))}}if(a.load("isNullObject"),await o.sync(),a.isNullObject){console.error(`ChromeExtensionService: Navigate - sheet "${r}" not found.`);return}const u=a.getUsedRange();u.load(["values","rowCount","columnCount","rowIndex"]),await o.sync();const l=u.values,i=l[0],c=["Student ID","SyStudentID","Student identifier","ID"];let p=-1;for(let y=0;y<i.length;y++)if(c.some(b=>String(i[y]).trim().toLowerCase()===b.toLowerCase())){p=y;break}if(p===-1){console.error(`ChromeExtensionService: Navigate - no Student ID column found in "${r}".`);return}let h=-1;for(let y=1;y<l.length;y++)if(String(l[y][p]).trim()===String(t).trim()){h=y;break}if(h===-1){console.warn(`ChromeExtensionService: Navigate - student "${t}" not found in "${r}".`);return}const f=u.rowIndex+h,g=a.getRangeByIndexes(f,0,1,i.length);a.activate(),g.select(),await o.sync(),console.log(`ChromeExtensionService: Navigated to student "${t}" in "${r}" (row ${f+1}).`)})}catch(o){console.error("ChromeExtensionService: Error navigating to student row:",o)}}sendPing(){const e={type:"SRK_CHECK_EXTENSION"};window.postMessage(e,"*"),window.parent&&window.parent!==window&&window.parent.postMessage(e,"*")}startPinging(e=2e3){this.isChecking||(console.log("ChromeExtensionService: Starting extension detection..."),this.isChecking=!0,this.sendPing(),this.pingInterval=setInterval(()=>{this.isExtensionInstalled?this.stopPinging():this.sendPing()},e))}stopPinging(){this.pingInterval&&(console.log("ChromeExtensionService: Stopping extension detection."),clearInterval(this.pingInterval),this.pingInterval=null,this.isChecking=!1)}startKeepAlive(e=2e4){this.keepAliveInterval||(console.log("ChromeExtensionService: Starting keep-alive heartbeat..."),this.keepAliveInterval=setInterval(()=>{typeof chrome<"u"&&chrome.runtime&&chrome.runtime.sendMessage&&chrome.runtime.sendMessage({type:"keep_alive_ping"},t=>{chrome.runtime.lastError})},e))}stopKeepAlive(){this.keepAliveInterval&&(console.log("ChromeExtensionService: Stopping keep-alive heartbeat."),clearInterval(this.keepAliveInterval),this.keepAliveInterval=null)}addListener(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(e){this.listeners.forEach(t=>{try{t(e)}catch(r){console.error("ChromeExtensionService: Listener error:",r)}})}sendMessage(e){window.parent&&window.parent!==window?(console.log(` ChromeExtensionService: Sending message (${e.type}) to parent window:`,e),window.parent.postMessage(e,"*")):(console.log(` ChromeExtensionService: Sending message (${e.type}) to window:`,e),window.postMessage(e,"*"))}sendChromeMessage(e,t){typeof chrome<"u"&&chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(e,r=>{chrome.runtime.lastError&&console.warn("ChromeExtensionService: Chrome message error:",chrome.runtime.lastError),t&&t(r)}):console.warn("ChromeExtensionService: chrome.runtime.sendMessage not available")}sendSelectedStudents(e){const r=(Array.isArray(e)?e:[e]).map(s=>({name:s.StudentName||s.name||"",syStudentId:s.ID||s.syStudentId||"",phone:s.Phone||s.phone||"",otherPhone:s.OtherPhone||s.otherPhone||""})),o={type:"SRK_SELECTED_STUDENTS",data:{students:r,count:r.length,timestamp:new Date().toISOString()}};console.log("ChromeExtensionService: Sending selected students:",o),this.sendMessage(o)}getInstallationStatus(){return this.isExtensionInstalled}reset(){this.stopPinging(),this.stopKeepAlive(),this.isExtensionInstalled=!1,this.isChecking=!1}cleanup(){this.stopPinging(),this.stopKeepAlive(),window.removeEventListener("message",this.handleMessage),this.listeners.clear()}}const Tl=new P9,F9=n=>{if(n==null)return null;if(typeof n=="number")return n;if(typeof n=="string"){const e=n.match(/^(\d+(?:\.\d+)?)\s*%?$/);if(e)return Number(e[1])}return null},Jv=n=>{if(n==null)return null;if(typeof n=="number")return n;if(typeof n=="string"){const e=parseFloat(n);return isNaN(e)?null:e}return null},Km=n=>{if(!n||n.length===0)return null;const e=[...n].sort((p,h)=>p-h),t=e.length,r=e[0],o=e[t-1],s=t%2===0?(e[t/2-1]+e[t/2])/2:e[Math.floor(t/2)],a=Math.floor(t*.25),u=Math.floor(t*.75),l=e[a],i=e[u],c=n.reduce((p,h)=>p+h,0)/t;return{min:r,q1:l,median:s,q3:i,max:o,mean:c,count:t}};function z9({students:n,hiddenRowCount:e=0}){const[t,r]=jt.useState("grade"),o=jt.useMemo(()=>{if(!n||n.length===0)return null;const h=n.map(f=>F9(f.Grade)).filter(f=>f!==null);return h.length===0?null:Km(h)},[n]),s=jt.useMemo(()=>{if(!n||n.length===0)return null;const h=n.map(f=>Jv(f.DaysOut)).filter(f=>f!==null);return h.length===0?null:Km(h)},[n]),a=jt.useMemo(()=>{if(!n||n.length===0)return null;const h=n.map(f=>Jv(f.MissingAssignments)).filter(f=>f!==null);return h.length===0?null:Km(h)},[n]),u=jt.useMemo(()=>n?n.map(h=>h.Gradebook).filter(h=>h&&typeof h=="string"&&/^https?:\/\/\S+$/i.test(h)):[],[n]);Ye.useEffect(()=>{let h=null;t==="grade"?h=o:t==="daysOut"?h=s:t==="missingAssignments"&&(h=a),h||(s?(console.log(" MultiStudentView: No data for",t,"- switching to daysOut"),r("daysOut")):a?(console.log(" MultiStudentView: No data for",t,"- switching to missingAssignments"),r("missingAssignments")):o&&t!=="grade"&&(console.log(" MultiStudentView: No data for",t,"- switching to grade"),r("grade")))},[t,o,s,a]);const l=()=>{if(console.log(" MultiStudentView: openAllGradebooks called"),console.log(" MultiStudentView: Gradebook links count:",u.length),console.log(" MultiStudentView: Gradebook links:",u),u.length===0){console.warn(" MultiStudentView: No valid gradebook links found"),alert("No valid gradebook links found for selected students.");return}const h={type:"SRK_PING",timestamp:new Date().toISOString(),source:"excel-addin-multistudent"};console.log(" MultiStudentView: Sending SRK_PING to Chrome extension:",h),Tl.sendMessage(h);const f={type:"SRK_LINKS",links:u};console.log(" MultiStudentView: Sending SRK_LINKS to Chrome extension:",f),Tl.sendMessage(f),console.log(" MultiStudentView: Both messages sent to Chrome extension")},i=()=>{switch(t){case"grade":return{stats:o,title:"Grade Distribution",unit:"%",scaleLabels:["0%","50%","100%"],isPercentage:!0,reverseColors:!1};case"daysOut":return{stats:s,title:"Days Out Distribution",unit:" days",scaleLabels:s?["0",Math.round(s.max/2).toString(),Math.round(s.max).toString()]:["0","0","0"],isPercentage:!1,reverseColors:!0};case"missingAssignments":return{stats:a,title:"Missing Assignments Distribution",unit:"",scaleLabels:a?["0",Math.round(a.max/2).toString(),Math.round(a.max).toString()]:["0","0","0"],isPercentage:!1,reverseColors:!0};default:return{stats:o,title:"Grade Distribution",unit:"%",scaleLabels:["0%","50%","100%"],isPercentage:!0,reverseColors:!1}}},c=({stats:h,title:f,unit:g,scaleLabels:y,isPercentage:b,reverseColors:v})=>{if(!h)return W.jsxs("div",{className:"p-6 bg-gray-50 border border-gray-200 rounded-lg text-center text-gray-500",children:["No ",f.toLowerCase()," data available for selected students"]});const{min:w,q1:S,median:N,q3:D,max:F,mean:G,count:P}=h,U=F-w,q=v?"text-green-600":"text-red-600",R=v?"text-red-600":"text-green-600",I=v?"#10b981":"#ef4444",T=v?"#ef4444":"#10b981",L=B=>U===0?50:b?B*.8+10:(B-w)/U*80+10,E=10,x=L(S),k=L(N),A=L(D),C=b?90:L(F),j=L(G);return W.jsxs("div",{className:"p-6 bg-white border border-gray-200 rounded-lg",children:[W.jsx("div",{className:"mb-4",children:W.jsxs("select",{value:t,onChange:B=>r(B.target.value),className:"w-full text-md font-bold text-gray-800 bg-transparent border-none cursor-pointer hover:text-blue-600 focus:outline-none appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right center",paddingRight:"20px"},children:[W.jsx("option",{value:"grade",children:"Grade Distribution"}),W.jsx("option",{value:"daysOut",children:"Days Out Distribution"}),W.jsx("option",{value:"missingAssignments",children:"Missing Assignments Distribution"})]})}),W.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-6 text-sm",children:[W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"text-gray-500",children:"Min"}),W.jsxs("div",{className:`font-bold ${q}`,children:[Math.round(w),g]})]}),W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"text-gray-500",children:"Average"}),W.jsxs("div",{className:"font-bold text-blue-600",children:[Math.round(G),g]})]}),W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"text-gray-500",children:"Max"}),W.jsxs("div",{className:`font-bold ${R}`,children:[Math.round(F),g]})]}),W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"text-gray-500",children:"Q1"}),W.jsxs("div",{className:"font-bold text-gray-700",children:[Math.round(S),g]})]}),W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"text-gray-500",children:"Median"}),W.jsxs("div",{className:"font-bold text-gray-700",children:[Math.round(N),g]})]}),W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"text-gray-500",children:"Q3"}),W.jsxs("div",{className:"font-bold text-gray-700",children:[Math.round(D),g]})]})]}),W.jsx("div",{className:"relative h-24 mb-2",children:W.jsxs("svg",{width:"100%",height:"100%",className:"overflow-visible",children:[W.jsx("line",{x1:"10%",y1:"50%",x2:"90%",y2:"50%",stroke:"#e5e7eb",strokeWidth:"1"}),W.jsx("line",{x1:`${E}%`,y1:"40%",x2:`${E}%`,y2:"60%",stroke:I,strokeWidth:"2"}),W.jsx("line",{x1:`${E}%`,y1:"50%",x2:`${x}%`,y2:"50%",stroke:"#6b7280",strokeWidth:"2"}),W.jsx("rect",{x:`${x}%`,y:"30%",width:`${A-x}%`,height:"40%",fill:"#93c5fd",stroke:"#3b82f6",strokeWidth:"2",rx:"4"}),W.jsx("line",{x1:`${k}%`,y1:"30%",x2:`${k}%`,y2:"70%",stroke:"#1e40af",strokeWidth:"3"}),W.jsx("circle",{cx:`${j}%`,cy:"50%",r:"4",fill:"#3b82f6",stroke:"#1e40af",strokeWidth:"2"}),W.jsx("line",{x1:`${A}%`,y1:"50%",x2:`${C}%`,y2:"50%",stroke:"#6b7280",strokeWidth:"2"}),W.jsx("line",{x1:`${C}%`,y1:"40%",x2:`${C}%`,y2:"60%",stroke:T,strokeWidth:"2"}),W.jsx("text",{x:"10%",y:"90%",fontSize:"12",fill:"#6b7280",textAnchor:"middle",children:y[0]}),W.jsx("text",{x:"50%",y:"90%",fontSize:"12",fill:"#6b7280",textAnchor:"middle",children:y[1]}),W.jsx("text",{x:"90%",y:"90%",fontSize:"12",fill:"#6b7280",textAnchor:"middle",children:y[2]})]})}),W.jsxs("div",{className:"text-xs text-gray-500 text-center mt-4",children:[P," student",P!==1?"s":""," with data"]})]})},p=i();return W.jsxs("div",{className:"p-4 space-y-4",children:[W.jsx(c,{stats:p.stats,title:p.title,unit:p.unit,scaleLabels:p.scaleLabels,isPercentage:p.isPercentage,reverseColors:p.reverseColors}),W.jsx("div",{className:"flex flex-col gap-2",children:W.jsx("button",{type:"button",onClick:l,disabled:u.length===0,className:`w-full py-3 px-4 rounded-lg font-semibold text-white transition-colors ${u.length>0?"bg-blue-600 hover:bg-blue-700 active:bg-blue-800":"bg-gray-300 cursor-not-allowed"}`,title:u.length>0?`Open ${u.length} gradebook${u.length!==1?"s":""}`:"No valid gradebook links",children:u.length>0?`Open All Gradebooks (${u.length})`:"No Gradebook Links"})}),e>0&&W.jsxs("div",{className:"text-xs text-gray-500 text-center pt-2 border-t border-gray-200",children:[e," row",e!==1?"s":""," hidden by filters"]})]})}async function q9(n={}){console.log("loadCache: start",{options:n});let e=[];if(n.ID)try{e=(await bg("Student History","Student identifier"))?.data??[];const o="sheetCache";try{const s=localStorage.getItem(o),a=s?JSON.parse(s):{};a.studentHistory=e,localStorage.setItem(o,JSON.stringify(a)),console.log("loadCache: saved studentHistory to sheetCache")}catch(s){console.warn("loadCache: failed to write sheetCache to localStorage",s)}}catch(r){console.error("Failed to load Student History sheet:",r)}else console.log("loadCache: no activeStudentId provided, skipping loadSheet");return await Promise.resolve(),console.log("loadCache: finished",e),e}async function U9(n){if(!n)return null;try{const e=localStorage.getItem("sheetCache");if(!e)return null;const t=JSON.parse(e),r=t&&t.studentHistory[n];return r&&Array.isArray(r)?r:null}catch(e){return console.warn("loadSheetCache: failed to read sheetCache from localStorage",e),null}}const H9={},Ip={StudentName:["Student Name","Student"],ID:["Student ID","SyStudentID","Student identifier"],StudentNumber:["Student Number"],Shift:["Shift"],Instructor:["Instructor","Teacher"],ProgVersDescrip:["Program","Program Description","ProgVersDescrip"],Gender:["Gender"],Phone:["Phone Number","Contact"],CreatedBy:["Created By","Author"],OtherPhone:["Other Phone","Alt Phone"],StudentEmail:["Email","Student Email"],PersonalEmail:["Other Email"],Assigned:["Advisor"],AdmissionsRep:["Admissions Rep","Admissions","AdmRep","AmRep"],ExpectedStartDate:["Expected Start Date","Start Date","ExpStartDate"],Grade:["Current Grade","Grade %","Grade","Course Grade"],LDA:["Last Date of Attendance","LDA","course lda","CurrentLDA"],DaysOut:["Days Out"],Gradebook:["Gradebook","gradeBookLink"],MissingAssignments:["Missing Assignments","Missing"],Outreach:["Outreach","Comments","Notes","Comment"],ProfilePicture:["Profile Picture","Photo","Avatar"]},$9=n=>{if(!n)return!1;const e=n.includes("!")?n.split("!")[1]:n;return e==="1:1"?!0:/^[A-Z]+1(:[A-Z]+1)?$/.test(e)},V9=(n,e)=>{if(!n||typeof n!="object")return null;for(const r of e)if(n[r]!==void 0&&n[r]!==null)return n[r];const t=Object.keys(n).reduce((r,o)=>(r[o.toLowerCase()]=o,r),{});for(const r of e){const o=r.toLowerCase();if(t[o]){const s=t[o],a=n[s];if(a!=null)return a}}return null};function u4({onReady:n,user:e}){const[t,r]=jt.useState("details"),[o,s]=jt.useState([]),[a,u]=jt.useState([]),[l,i]=jt.useState(H9),[c,p]=jt.useState(1),[h,f]=jt.useState([]),[g,y]=jt.useState(0),[b,v]=jt.useState(0),[w,S]=jt.useState({history:!0,assignments:!0});jt.useEffect(()=>{(async()=>{try{await Excel.run(async P=>{P.workbook.worksheets.onActivated.add(()=>(v(U=>U+1),Promise.resolve())),await P.sync()})}catch(P){console.warn("Failed to register sheet activation listener",P)}})()},[]),jt.useEffect(()=>{(async()=>{try{await Excel.run(async P=>{const U=P.workbook.worksheets;P.load(U,"items/name"),await P.sync();const q=U.items.map(R=>R.name);S({history:q.includes("Student History"),assignments:q.some(R=>["Missing Assignments","Assignments"].includes(R))})})}catch(P){console.warn("Failed to check sheet existence",P)}})()},[b]),jt.useEffect(()=>{t==="history"&&!w.history&&r("details"),t==="assignments"&&!w.assignments&&r("details")},[w,t]);const N=()=>{if(!l||!w.history)return;console.log("=== ACTIVE STUDENT STATE ==="),console.log("Full activeStudentState:",l),console.log("Available keys:",Object.keys(l));const G=l.ID,P=l.StudentNumber;console.log("Extracted studentId (ID):",G),console.log("Extracted studentNumber:",P),!(!G&&!P)&&(console.log("Loading history for",l.StudentName),Sg(!0),P&&U9(P).then(U=>{U&&s(U)}).catch(()=>{}),bg("Student History").then(U=>{if(U&&U.data&&Array.isArray(U.data)){console.log("=== HISTORY LOAD DEBUG ==="),console.log("Raw history data count:",U.data.length),console.log("Sample entry keys:",U.data[0]?Object.keys(U.data[0]):"no entries"),console.log("Sample entry values:",U.data[0]),console.log("Looking for studentId:",G,"or studentNumber:",P);const q=U.data.filter(R=>{const I=V9(R,["ID","Student ID","SyStudentID","Student Identifier","StudentID","Student Number","StudentNumber"]);if(!I)return!1;const T=G&&I==G||P&&I==P;return T&&console.log("MATCH FOUND:",{entryIdValue:I,studentId:G,studentNumber:P}),T});console.log("Filtered history count:",q.length),console.log("=== END DEBUG ==="),s(q)}}).catch(U=>console.error("Failed to load Student History sheet:",U)))},D=()=>{!l||!l.Gradebook||w.assignments&&bg("Missing Assignments","Gradebook",l.Gradebook).then(G=>{u(G.data)}).catch(G=>console.error(G))};jt.useEffect(()=>{!l?.ID&&!l?.StudentNumber||(w.history&&N(),w.assignments&&D())},[l?.ID,l?.StudentNumber]);const F=()=>{if(!l||!l.ID)return W.jsx("div",{className:"p-8 text-center text-gray-500",children:W.jsx("p",{children:"Please select a student row to view details."})});switch(t){case"history":return w.history?W.jsx(j9,{history:o,student:l,reload:N}):W.jsx(Ym,{student:l});case"assignments":return w.assignments?W.jsx(B9,{assignments:a,reload:D}):W.jsx(Ym,{student:l});case"details":default:return W.jsx(Ym,{student:l})}};return jt.useEffect(()=>{b>0&&(i({}),p(1),f([]));let G=null;return(async()=>{try{G=await s9(({address:P,values:U,data:q,rowCount:R,allRows:I,hiddenRowCount:T})=>{if($9(P)){i({}),p(1),f([]),y(0);return}p(R||1),f(I||[]),y(T||0),i(L=>({...L,...q}))},Ip);try{const P=await l9(Ip);if(P&&P.success){p(P.rowCount||1),f(P.allRows||[]),y(P.hiddenRowCount||0);const U=P.singleRow||Array.isArray(P.rows)&&P.rows[0]||null;U&&(U.ID==="Student ID"||U.StudentName==="Student Name"?i({}):(i(q=>({...q,...U})),b===0&&await q9(U)))}}catch(P){console.warn("getSelectedRange failed to initialize selection:",P)}finally{n&&n()}}catch(P){console.error("Failed to register Excel selection handler:",P),n&&n()}})(),()=>{G&&typeof G.remove=="function"&&G.remove()}},[b]),jt.useEffect(()=>{let G=null;return(async()=>{try{G=await u9(P=>{const q=(P&&Array.isArray(P.changes)?P.changes:[]).map(I=>{const T=I&&I.value,L=T==null?"":String(T);try{const E=yk(L);return{change:I,text:L,match:!!(E&&E.matched),tag:E&&E.tag}}catch{return{change:I,text:L,match:!1,tag:null}}});return q.forEach(({change:I,text:T,match:L,tag:E})=>{try{if(L){o9(I.rowIndex,I.colIndex,9);const x=E?`${E}, Outreach`:"Outreach";vg(String(T),x,void 0,I.otherValues?.ID,I.otherValues?.StudentName)}else vg(String(T),"Outreach",void 0,I.otherValues?.ID,I.otherValues?.StudentName)}catch(x){console.warn("highlightRow/addComment failed",x)}}),q.some(I=>I.match)},null,"Outreach",Ip,["StudentName","ID"])}catch(P){console.error("Failed to register Excel cell-change handler:",P)}})(),()=>{if(G&&typeof G.remove=="function")try{G.remove()}catch{}}},[b]),jt.useEffect(()=>{c>1&&h.length>0?Tl.sendSelectedStudents(h):c===1&&l?.ID&&Tl.sendSelectedStudents(l)},[c,h,l]),W.jsxs("div",{className:"studentview-outer",children:[W.jsx(e7,{student:l,selectedRowCount:c}),c===1?W.jsxs(W.Fragment,{children:[W.jsxs("div",{className:"studentview-tabs",children:[W.jsx("button",{type:"button",className:`studentview-tab ${t==="details"?"active":""}`,onClick:()=>r("details"),children:"Details"}),w.history&&W.jsx("button",{type:"button",className:`studentview-tab ${t==="history"?"active":""}`,onClick:()=>{N(),r("history")},children:"History"}),w.assignments&&W.jsx("button",{type:"button",className:`studentview-tab ${t==="assignments"?"active":""}`,onClick:()=>{D(),r("assignments")},children:"Assignments"})]}),W.jsx("div",{className:"studentview-tab-content",children:F()})]}):W.jsx(z9,{students:h,hiddenRowCount:g})]})}u4.displayName="StudentView";const c4=Ye.memo(u4),W9=Object.freeze(Object.defineProperty({__proto__:null,COLUMN_ALIASES:Ip,default:c4},Symbol.toStringTag,{value:"Module"}));var Zm={exports:{}},Qm,t5;function G9(){if(t5)return Qm;t5=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Qm=n,Qm}var Jm,e5;function Y9(){if(e5)return Jm;e5=1;var n=G9();function e(){}function t(){}return t.resetWarningCache=e,Jm=function(){function r(a,u,l,i,c,p){if(p!==n){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}r.isRequired=r;function o(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:o,element:r,elementType:r,instanceOf:o,node:r,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:t,resetWarningCache:e};return s.PropTypes=s,s},Jm}var n5;function X9(){return n5||(n5=1,Zm.exports=Y9()()),Zm.exports}var K9=X9();const t1=Eu(K9);function Z9(n,e){const t={};return(n[n.length-1]===""?[...n,""]:n).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const Q9=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,J9=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,tA={};function r5(n,e){return(tA.jsx?J9:Q9).test(n)}const eA=/[ \t\n\f\r]/g;function nA(n){return typeof n=="object"?n.type==="text"?i5(n.value):!1:i5(n)}function i5(n){return n.replace(eA,"")===""}class rd{constructor(e,t,r){this.normal=t,this.property=e,r&&(this.space=r)}}rd.prototype.normal={};rd.prototype.property={};rd.prototype.space=void 0;function f4(n,e){const t={},r={};for(const o of n)Object.assign(t,o.property),Object.assign(r,o.normal);return new rd(t,r,e)}function _g(n){return n.toLowerCase()}class da{constructor(e,t){this.attribute=t,this.property=e}}da.prototype.attribute="";da.prototype.booleanish=!1;da.prototype.boolean=!1;da.prototype.commaOrSpaceSeparated=!1;da.prototype.commaSeparated=!1;da.prototype.defined=!1;da.prototype.mustUseProperty=!1;da.prototype.number=!1;da.prototype.overloadedBoolean=!1;da.prototype.property="";da.prototype.spaceSeparated=!1;da.prototype.space=void 0;let rA=0;const nr=cc(),es=cc(),kg=cc(),ze=cc(),fi=cc(),yf=cc(),Aa=cc();function cc(){return 2**++rA}const Ag=Object.freeze(Object.defineProperty({__proto__:null,boolean:nr,booleanish:es,commaOrSpaceSeparated:Aa,commaSeparated:yf,number:ze,overloadedBoolean:kg,spaceSeparated:fi},Symbol.toStringTag,{value:"Module"})),e1=Object.keys(Ag);class yb extends da{constructor(e,t,r,o){let s=-1;if(super(e,t),s5(this,"space",o),typeof r=="number")for(;++s<e1.length;){const a=e1[s];s5(this,e1[s],(r&Ag[a])===Ag[a])}}}yb.prototype.defined=!0;function s5(n,e,t){t&&(n[e]=t)}function jf(n){const e={},t={};for(const[r,o]of Object.entries(n.properties)){const s=new yb(r,n.transform(n.attributes||{},r),o,n.space);n.mustUseProperty&&n.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),e[r]=s,t[_g(r)]=r,t[_g(s.attribute)]=r}return new rd(e,t,n.space)}const h4=jf({properties:{ariaActiveDescendant:null,ariaAtomic:es,ariaAutoComplete:null,ariaBusy:es,ariaChecked:es,ariaColCount:ze,ariaColIndex:ze,ariaColSpan:ze,ariaControls:fi,ariaCurrent:null,ariaDescribedBy:fi,ariaDetails:null,ariaDisabled:es,ariaDropEffect:fi,ariaErrorMessage:null,ariaExpanded:es,ariaFlowTo:fi,ariaGrabbed:es,ariaHasPopup:null,ariaHidden:es,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:fi,ariaLevel:ze,ariaLive:null,ariaModal:es,ariaMultiLine:es,ariaMultiSelectable:es,ariaOrientation:null,ariaOwns:fi,ariaPlaceholder:null,ariaPosInSet:ze,ariaPressed:es,ariaReadOnly:es,ariaRelevant:null,ariaRequired:es,ariaRoleDescription:fi,ariaRowCount:ze,ariaRowIndex:ze,ariaRowSpan:ze,ariaSelected:es,ariaSetSize:ze,ariaSort:null,ariaValueMax:ze,ariaValueMin:ze,ariaValueNow:ze,ariaValueText:null,role:null},transform(n,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function d4(n,e){return e in n?n[e]:e}function p4(n,e){return d4(n,e.toLowerCase())}const iA=jf({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:yf,acceptCharset:fi,accessKey:fi,action:null,allow:null,allowFullScreen:nr,allowPaymentRequest:nr,allowUserMedia:nr,alt:null,as:null,async:nr,autoCapitalize:null,autoComplete:fi,autoFocus:nr,autoPlay:nr,blocking:fi,capture:null,charSet:null,checked:nr,cite:null,className:fi,cols:ze,colSpan:null,content:null,contentEditable:es,controls:nr,controlsList:fi,coords:ze|yf,crossOrigin:null,data:null,dateTime:null,decoding:null,default:nr,defer:nr,dir:null,dirName:null,disabled:nr,download:kg,draggable:es,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:nr,formTarget:null,headers:fi,height:ze,hidden:kg,high:ze,href:null,hrefLang:null,htmlFor:fi,httpEquiv:fi,id:null,imageSizes:null,imageSrcSet:null,inert:nr,inputMode:null,integrity:null,is:null,isMap:nr,itemId:null,itemProp:fi,itemRef:fi,itemScope:nr,itemType:fi,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:nr,low:ze,manifest:null,max:null,maxLength:ze,media:null,method:null,min:null,minLength:ze,multiple:nr,muted:nr,name:null,nonce:null,noModule:nr,noValidate:nr,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:nr,optimum:ze,pattern:null,ping:fi,placeholder:null,playsInline:nr,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:nr,referrerPolicy:null,rel:fi,required:nr,reversed:nr,rows:ze,rowSpan:ze,sandbox:fi,scope:null,scoped:nr,seamless:nr,selected:nr,shadowRootClonable:nr,shadowRootDelegatesFocus:nr,shadowRootMode:null,shape:null,size:ze,sizes:null,slot:null,span:ze,spellCheck:es,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ze,step:null,style:null,tabIndex:ze,target:null,title:null,translate:null,type:null,typeMustMatch:nr,useMap:null,value:es,width:ze,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:fi,axis:null,background:null,bgColor:null,border:ze,borderColor:null,bottomMargin:ze,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:nr,declare:nr,event:null,face:null,frame:null,frameBorder:null,hSpace:ze,leftMargin:ze,link:null,longDesc:null,lowSrc:null,marginHeight:ze,marginWidth:ze,noResize:nr,noHref:nr,noShade:nr,noWrap:nr,object:null,profile:null,prompt:null,rev:null,rightMargin:ze,rules:null,scheme:null,scrolling:es,standby:null,summary:null,text:null,topMargin:ze,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ze,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:nr,disableRemotePlayback:nr,prefix:null,property:null,results:ze,security:null,unselectable:null},space:"html",transform:p4}),sA=jf({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Aa,accentHeight:ze,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ze,amplitude:ze,arabicForm:null,ascent:ze,attributeName:null,attributeType:null,azimuth:ze,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ze,by:null,calcMode:null,capHeight:ze,className:fi,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ze,diffuseConstant:ze,direction:null,display:null,dur:null,divisor:ze,dominantBaseline:null,download:nr,dx:null,dy:null,edgeMode:null,editable:null,elevation:ze,enableBackground:null,end:null,event:null,exponent:ze,externalResourcesRequired:null,fill:null,fillOpacity:ze,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:yf,g2:yf,glyphName:yf,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ze,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ze,horizOriginX:ze,horizOriginY:ze,id:null,ideographic:ze,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ze,k:ze,k1:ze,k2:ze,k3:ze,k4:ze,kernelMatrix:Aa,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ze,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ze,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ze,overlineThickness:ze,paintOrder:null,panose1:null,path:null,pathLength:ze,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:fi,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ze,pointsAtY:ze,pointsAtZ:ze,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Aa,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Aa,rev:Aa,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Aa,requiredFeatures:Aa,requiredFonts:Aa,requiredFormats:Aa,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ze,specularExponent:ze,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ze,strikethroughThickness:ze,string:null,stroke:null,strokeDashArray:Aa,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ze,strokeOpacity:ze,strokeWidth:null,style:null,surfaceScale:ze,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Aa,tabIndex:ze,tableValues:null,target:null,targetX:ze,targetY:ze,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Aa,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ze,underlineThickness:ze,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ze,values:null,vAlphabetic:ze,vMathematical:ze,vectorEffect:null,vHanging:ze,vIdeographic:ze,version:null,vertAdvY:ze,vertOriginX:ze,vertOriginY:ze,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ze,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:d4}),m4=jf({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(n,e){return"xlink:"+e.slice(5).toLowerCase()}}),g4=jf({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:p4}),b4=jf({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(n,e){return"xml:"+e.slice(3).toLowerCase()}}),aA={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},oA=/[A-Z]/g,a5=/-[a-z]/g,lA=/^data[-\w.:]+$/i;function uA(n,e){const t=_g(e);let r=e,o=da;if(t in n.normal)return n.property[n.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&lA.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(a5,fA);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!a5.test(s)){let a=s.replace(oA,cA);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}o=yb}return new o(r,e)}function cA(n){return"-"+n.toLowerCase()}function fA(n){return n.charAt(1).toUpperCase()}const hA=f4([h4,iA,m4,g4,b4],"html"),vb=f4([h4,sA,m4,g4,b4],"svg");function dA(n){return n.join(" ").trim()}var tf={},n1,o5;function pA(){if(o5)return n1;o5=1;var n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,o=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,u=/^\s+|\s+$/g,l=`
`,i="/",c="*",p="",h="comment",f="declaration";function g(b,v){if(typeof b!="string")throw new TypeError("First argument must be a string");if(!b)return[];v=v||{};var w=1,S=1;function N(L){var E=L.match(e);E&&(w+=E.length);var x=L.lastIndexOf(l);S=~x?L.length-x:S+L.length}function D(){var L={line:w,column:S};return function(E){return E.position=new F(L),U(),E}}function F(L){this.start=L,this.end={line:w,column:S},this.source=v.source}F.prototype.content=b;function G(L){var E=new Error(v.source+":"+w+":"+S+": "+L);if(E.reason=L,E.filename=v.source,E.line=w,E.column=S,E.source=b,!v.silent)throw E}function P(L){var E=L.exec(b);if(E){var x=E[0];return N(x),b=b.slice(x.length),E}}function U(){P(t)}function q(L){var E;for(L=L||[];E=R();)E!==!1&&L.push(E);return L}function R(){var L=D();if(!(i!=b.charAt(0)||c!=b.charAt(1))){for(var E=2;p!=b.charAt(E)&&(c!=b.charAt(E)||i!=b.charAt(E+1));)++E;if(E+=2,p===b.charAt(E-1))return G("End of comment missing");var x=b.slice(2,E-2);return S+=2,N(x),b=b.slice(E),S+=2,L({type:h,comment:x})}}function I(){var L=D(),E=P(r);if(E){if(R(),!P(o))return G("property missing ':'");var x=P(s),k=L({type:f,property:y(E[0].replace(n,p)),value:x?y(x[0].replace(n,p)):p});return P(a),k}}function T(){var L=[];q(L);for(var E;E=I();)E!==!1&&(L.push(E),q(L));return L}return U(),T()}function y(b){return b?b.replace(u,p):p}return n1=g,n1}var l5;function mA(){if(l5)return tf;l5=1;var n=tf&&tf.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(tf,"__esModule",{value:!0}),tf.default=t;const e=n(pA());function t(r,o){let s=null;if(!r||typeof r!="string")return s;const a=(0,e.default)(r),u=typeof o=="function";return a.forEach(l=>{if(l.type!=="declaration")return;const{property:i,value:c}=l;u?o(i,c,l):c&&(s=s||{},s[i]=c)}),s}return tf}var yh={},u5;function gA(){if(u5)return yh;u5=1,Object.defineProperty(yh,"__esModule",{value:!0}),yh.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,o=/^-(ms)-/,s=function(i){return!i||t.test(i)||n.test(i)},a=function(i,c){return c.toUpperCase()},u=function(i,c){return"".concat(c,"-")},l=function(i,c){return c===void 0&&(c={}),s(i)?i:(i=i.toLowerCase(),c.reactCompat?i=i.replace(o,u):i=i.replace(r,u),i.replace(e,a))};return yh.camelCase=l,yh}var vh,c5;function bA(){if(c5)return vh;c5=1;var n=vh&&vh.__importDefault||function(o){return o&&o.__esModule?o:{default:o}},e=n(mA()),t=gA();function r(o,s){var a={};return!o||typeof o!="string"||(0,e.default)(o,function(u,l){u&&l&&(a[(0,t.camelCase)(u,s)]=l)}),a}return r.default=r,vh=r,vh}var yA=bA();const vA=Eu(yA),y4=v4("end"),wb=v4("start");function v4(n){return e;function e(t){const r=t&&t.position&&t.position[n]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function wA(n){const e=wb(n),t=y4(n);if(e&&t)return{start:e,end:t}}function Oh(n){return!n||typeof n!="object"?"":"position"in n||"type"in n?f5(n.position):"start"in n||"end"in n?f5(n):"line"in n||"column"in n?Cg(n):""}function Cg(n){return h5(n&&n.line)+":"+h5(n&&n.column)}function f5(n){return Cg(n&&n.start)+"-"+Cg(n&&n.end)}function h5(n){return n&&typeof n=="number"?n:1}class Ps extends Error{constructor(e,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let o="",s={},a=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof e=="string"?o=e:!s.cause&&e&&(a=!0,o=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof r=="string"){const l=r.indexOf(":");l===-1?s.ruleId=r:(s.source=r.slice(0,l),s.ruleId=r.slice(l+1))}if(!s.place&&s.ancestors&&s.ancestors){const l=s.ancestors[s.ancestors.length-1];l&&(s.place=l.position)}const u=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=u?u.column:void 0,this.fatal=void 0,this.file="",this.message=o,this.line=u?u.line:void 0,this.name=Oh(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=a&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Ps.prototype.file="";Ps.prototype.name="";Ps.prototype.reason="";Ps.prototype.message="";Ps.prototype.stack="";Ps.prototype.column=void 0;Ps.prototype.line=void 0;Ps.prototype.ancestors=void 0;Ps.prototype.cause=void 0;Ps.prototype.fatal=void 0;Ps.prototype.place=void 0;Ps.prototype.ruleId=void 0;Ps.prototype.source=void 0;const xb={}.hasOwnProperty,xA=new Map,SA=/[A-Z]/g,_A=new Set(["table","tbody","thead","tfoot","tr"]),kA=new Set(["td","th"]),w4="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function AA(n,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=OA(t,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=LA(t,e.jsx,e.jsxs)}const o={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?vb:hA,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=x4(o,n,void 0);return s&&typeof s!="string"?s:o.create(n,o.Fragment,{children:s||void 0},void 0)}function x4(n,e,t){if(e.type==="element")return CA(n,e,t);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return EA(n,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return TA(n,e,t);if(e.type==="mdxjsEsm")return NA(n,e);if(e.type==="root")return jA(n,e,t);if(e.type==="text")return MA(n,e)}function CA(n,e,t){const r=n.schema;let o=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(o=vb,n.schema=o),n.ancestors.push(e);const s=_4(n,e.tagName,!1),a=RA(n,e);let u=_b(n,e);return _A.has(e.tagName)&&(u=u.filter(function(l){return typeof l=="string"?!nA(l):!0})),S4(n,a,s,e),Sb(a,u),n.ancestors.pop(),n.schema=r,n.create(e,s,a,t)}function EA(n,e){if(e.data&&e.data.estree&&n.evaluater){const r=e.data.estree.body[0];return r.type,n.evaluater.evaluateExpression(r.expression)}$h(n,e.position)}function NA(n,e){if(e.data&&e.data.estree&&n.evaluater)return n.evaluater.evaluateProgram(e.data.estree);$h(n,e.position)}function TA(n,e,t){const r=n.schema;let o=r;e.name==="svg"&&r.space==="html"&&(o=vb,n.schema=o),n.ancestors.push(e);const s=e.name===null?n.Fragment:_4(n,e.name,!0),a=IA(n,e),u=_b(n,e);return S4(n,a,s,e),Sb(a,u),n.ancestors.pop(),n.schema=r,n.create(e,s,a,t)}function jA(n,e,t){const r={};return Sb(r,_b(n,e)),n.create(e,n.Fragment,r,t)}function MA(n,e){return e.value}function S4(n,e,t,r){typeof t!="string"&&t!==n.Fragment&&n.passNode&&(e.node=r)}function Sb(n,e){if(e.length>0){const t=e.length>1?e:e[0];t&&(n.children=t)}}function LA(n,e,t){return r;function r(o,s,a,u){const i=Array.isArray(a.children)?t:e;return u?i(s,a,u):i(s,a)}}function OA(n,e){return t;function t(r,o,s,a){const u=Array.isArray(s.children),l=wb(r);return e(o,s,a,u,{columnNumber:l?l.column-1:void 0,fileName:n,lineNumber:l?l.line:void 0},void 0)}}function RA(n,e){const t={};let r,o;for(o in e.properties)if(o!=="children"&&xb.call(e.properties,o)){const s=DA(n,o,e.properties[o]);if(s){const[a,u]=s;n.tableCellAlignToStyle&&a==="align"&&typeof u=="string"&&kA.has(e.tagName)?r=u:t[a]=u}}if(r){const s=t.style||(t.style={});s[n.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function IA(n,e){const t={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&n.evaluater){const s=r.data.estree.body[0];s.type;const a=s.expression;a.type;const u=a.properties[0];u.type,Object.assign(t,n.evaluater.evaluateExpression(u.argument))}else $h(n,e.position);else{const o=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&n.evaluater){const u=r.value.data.estree.body[0];u.type,s=n.evaluater.evaluateExpression(u.expression)}else $h(n,e.position);else s=r.value===null?!0:r.value;t[o]=s}return t}function _b(n,e){const t=[];let r=-1;const o=n.passKeys?new Map:xA;for(;++r<e.children.length;){const s=e.children[r];let a;if(n.passKeys){const l=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(l){const i=o.get(l)||0;a=l+"-"+i,o.set(l,i+1)}}const u=x4(n,s,a);u!==void 0&&t.push(u)}return t}function DA(n,e,t){const r=uA(n.schema,e);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?Z9(t):dA(t)),r.property==="style"){let o=typeof t=="object"?t:BA(n,String(t));return n.stylePropertyNameCase==="css"&&(o=PA(o)),["style",o]}return[n.elementAttributeNameCase==="react"&&r.space?aA[r.property]||r.property:r.attribute,t]}}function BA(n,e){try{return vA(e,{reactCompat:!0})}catch(t){if(n.ignoreInvalidStyle)return{};const r=t,o=new Ps("Cannot parse `style` attribute",{ancestors:n.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw o.file=n.filePath||void 0,o.url=w4+"#cannot-parse-style-attribute",o}}function _4(n,e,t){let r;if(!t)r={type:"Literal",value:e};else if(e.includes(".")){const o=e.split(".");let s=-1,a;for(;++s<o.length;){const u=r5(o[s])?{type:"Identifier",name:o[s]}:{type:"Literal",value:o[s]};a=a?{type:"MemberExpression",object:a,property:u,computed:!!(s&&u.type==="Literal"),optional:!1}:u}r=a}else r=r5(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const o=r.value;return xb.call(n.components,o)?n.components[o]:o}if(n.evaluater)return n.evaluater.evaluateExpression(r);$h(n)}function $h(n,e){const t=new Ps("Cannot handle MDX estrees without `createEvaluater`",{ancestors:n.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=n.filePath||void 0,t.url=w4+"#cannot-handle-mdx-estrees-without-createevaluater",t}function PA(n){const e={};let t;for(t in n)xb.call(n,t)&&(e[FA(t)]=n[t]);return e}function FA(n){let e=n.replace(SA,zA);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function zA(n){return"-"+n.toLowerCase()}const r1={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},qA={};function kb(n,e){const t=qA,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,o=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return k4(n,r,o)}function k4(n,e,t){if(UA(n)){if("value"in n)return n.type==="html"&&!t?"":n.value;if(e&&"alt"in n&&n.alt)return n.alt;if("children"in n)return d5(n.children,e,t)}return Array.isArray(n)?d5(n,e,t):""}function d5(n,e,t){const r=[];let o=-1;for(;++o<n.length;)r[o]=k4(n[o],e,t);return r.join("")}function UA(n){return!!(n&&typeof n=="object")}const p5=document.createElement("i");function Ab(n){const e="&"+n+";";p5.innerHTML=e;const t=p5.textContent;return t.charCodeAt(t.length-1)===59&&n!=="semi"||t===e?!1:t}function Ea(n,e,t,r){const o=n.length;let s=0,a;if(e<0?e=-e>o?0:o+e:e=e>o?o:e,t=t>0?t:0,r.length<1e4)a=Array.from(r),a.unshift(e,t),n.splice(...a);else for(t&&n.splice(e,t);s<r.length;)a=r.slice(s,s+1e4),a.unshift(e,0),n.splice(...a),s+=1e4,e+=1e4}function Ha(n,e){return n.length>0?(Ea(n,n.length,0,e),n):e}const m5={}.hasOwnProperty;function A4(n){const e={};let t=-1;for(;++t<n.length;)HA(e,n[t]);return e}function HA(n,e){let t;for(t in e){const o=(m5.call(n,t)?n[t]:void 0)||(n[t]={}),s=e[t];let a;if(s)for(a in s){m5.call(o,a)||(o[a]=[]);const u=s[a];$A(o[a],Array.isArray(u)?u:u?[u]:[])}}}function $A(n,e){let t=-1;const r=[];for(;++t<e.length;)(e[t].add==="after"?n:r).push(e[t]);Ea(n,0,0,r)}function C4(n,e){const t=Number.parseInt(n,e);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function wo(n){return n.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Ws=Nu(/[A-Za-z]/),Bs=Nu(/[\dA-Za-z]/),VA=Nu(/[#-'*+\--9=?A-Z^-~]/);function Vp(n){return n!==null&&(n<32||n===127)}const Eg=Nu(/\d/),WA=Nu(/[\dA-Fa-f]/),GA=Nu(/[!-/:-@[-`{-~]/);function On(n){return n!==null&&n<-2}function ui(n){return n!==null&&(n<0||n===32)}function pr(n){return n===-2||n===-1||n===32}const h0=Nu(new RegExp("\\p{P}|\\p{S}","u")),rc=Nu(/\s/);function Nu(n){return e;function e(t){return t!==null&&t>-1&&n.test(String.fromCharCode(t))}}function Mf(n){const e=[];let t=-1,r=0,o=0;for(;++t<n.length;){const s=n.charCodeAt(t);let a="";if(s===37&&Bs(n.charCodeAt(t+1))&&Bs(n.charCodeAt(t+2)))o=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(a=String.fromCharCode(s));else if(s>55295&&s<57344){const u=n.charCodeAt(t+1);s<56320&&u>56319&&u<57344?(a=String.fromCharCode(s,u),o=1):a=""}else a=String.fromCharCode(s);a&&(e.push(n.slice(r,t),encodeURIComponent(a)),r=t+o+1,a=""),o&&(t+=o,o=0)}return e.join("")+n.slice(r)}function Cr(n,e,t,r){const o=r?r-1:Number.POSITIVE_INFINITY;let s=0;return a;function a(l){return pr(l)?(n.enter(t),u(l)):e(l)}function u(l){return pr(l)&&s++<o?(n.consume(l),u):(n.exit(t),e(l))}}const YA={tokenize:XA};function XA(n){const e=n.attempt(this.parser.constructs.contentInitial,r,o);let t;return e;function r(u){if(u===null){n.consume(u);return}return n.enter("lineEnding"),n.consume(u),n.exit("lineEnding"),Cr(n,e,"linePrefix")}function o(u){return n.enter("paragraph"),s(u)}function s(u){const l=n.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=l),t=l,a(u)}function a(u){if(u===null){n.exit("chunkText"),n.exit("paragraph"),n.consume(u);return}return On(u)?(n.consume(u),n.exit("chunkText"),s):(n.consume(u),a)}}const KA={tokenize:ZA},g5={tokenize:QA};function ZA(n){const e=this,t=[];let r=0,o,s,a;return u;function u(S){if(r<t.length){const N=t[r];return e.containerState=N[1],n.attempt(N[0].continuation,l,i)(S)}return i(S)}function l(S){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,o&&w();const N=e.events.length;let D=N,F;for(;D--;)if(e.events[D][0]==="exit"&&e.events[D][1].type==="chunkFlow"){F=e.events[D][1].end;break}v(r);let G=N;for(;G<e.events.length;)e.events[G][1].end={...F},G++;return Ea(e.events,D+1,0,e.events.slice(N)),e.events.length=G,i(S)}return u(S)}function i(S){if(r===t.length){if(!o)return h(S);if(o.currentConstruct&&o.currentConstruct.concrete)return g(S);e.interrupt=!!(o.currentConstruct&&!o._gfmTableDynamicInterruptHack)}return e.containerState={},n.check(g5,c,p)(S)}function c(S){return o&&w(),v(r),h(S)}function p(S){return e.parser.lazy[e.now().line]=r!==t.length,a=e.now().offset,g(S)}function h(S){return e.containerState={},n.attempt(g5,f,g)(S)}function f(S){return r++,t.push([e.currentConstruct,e.containerState]),h(S)}function g(S){if(S===null){o&&w(),v(0),n.consume(S);return}return o=o||e.parser.flow(e.now()),n.enter("chunkFlow",{_tokenizer:o,contentType:"flow",previous:s}),y(S)}function y(S){if(S===null){b(n.exit("chunkFlow"),!0),v(0),n.consume(S);return}return On(S)?(n.consume(S),b(n.exit("chunkFlow")),r=0,e.interrupt=void 0,u):(n.consume(S),y)}function b(S,N){const D=e.sliceStream(S);if(N&&D.push(null),S.previous=s,s&&(s.next=S),s=S,o.defineSkip(S.start),o.write(D),e.parser.lazy[S.start.line]){let F=o.events.length;for(;F--;)if(o.events[F][1].start.offset<a&&(!o.events[F][1].end||o.events[F][1].end.offset>a))return;const G=e.events.length;let P=G,U,q;for(;P--;)if(e.events[P][0]==="exit"&&e.events[P][1].type==="chunkFlow"){if(U){q=e.events[P][1].end;break}U=!0}for(v(r),F=G;F<e.events.length;)e.events[F][1].end={...q},F++;Ea(e.events,P+1,0,e.events.slice(G)),e.events.length=F}}function v(S){let N=t.length;for(;N-- >S;){const D=t[N];e.containerState=D[1],D[0].exit.call(e,n)}t.length=S}function w(){o.write([null]),s=void 0,o=void 0,e.containerState._closeFlow=void 0}}function QA(n,e,t){return Cr(n,n.attempt(this.parser.constructs.document,e,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Ef(n){if(n===null||ui(n)||rc(n))return 1;if(h0(n))return 2}function d0(n,e,t){const r=[];let o=-1;for(;++o<n.length;){const s=n[o].resolveAll;s&&!r.includes(s)&&(e=s(e,t),r.push(s))}return e}const Ng={name:"attention",resolveAll:JA,tokenize:tC};function JA(n,e){let t=-1,r,o,s,a,u,l,i,c;for(;++t<n.length;)if(n[t][0]==="enter"&&n[t][1].type==="attentionSequence"&&n[t][1]._close){for(r=t;r--;)if(n[r][0]==="exit"&&n[r][1].type==="attentionSequence"&&n[r][1]._open&&e.sliceSerialize(n[r][1]).charCodeAt(0)===e.sliceSerialize(n[t][1]).charCodeAt(0)){if((n[r][1]._close||n[t][1]._open)&&(n[t][1].end.offset-n[t][1].start.offset)%3&&!((n[r][1].end.offset-n[r][1].start.offset+n[t][1].end.offset-n[t][1].start.offset)%3))continue;l=n[r][1].end.offset-n[r][1].start.offset>1&&n[t][1].end.offset-n[t][1].start.offset>1?2:1;const p={...n[r][1].end},h={...n[t][1].start};b5(p,-l),b5(h,l),a={type:l>1?"strongSequence":"emphasisSequence",start:p,end:{...n[r][1].end}},u={type:l>1?"strongSequence":"emphasisSequence",start:{...n[t][1].start},end:h},s={type:l>1?"strongText":"emphasisText",start:{...n[r][1].end},end:{...n[t][1].start}},o={type:l>1?"strong":"emphasis",start:{...a.start},end:{...u.end}},n[r][1].end={...a.start},n[t][1].start={...u.end},i=[],n[r][1].end.offset-n[r][1].start.offset&&(i=Ha(i,[["enter",n[r][1],e],["exit",n[r][1],e]])),i=Ha(i,[["enter",o,e],["enter",a,e],["exit",a,e],["enter",s,e]]),i=Ha(i,d0(e.parser.constructs.insideSpan.null,n.slice(r+1,t),e)),i=Ha(i,[["exit",s,e],["enter",u,e],["exit",u,e],["exit",o,e]]),n[t][1].end.offset-n[t][1].start.offset?(c=2,i=Ha(i,[["enter",n[t][1],e],["exit",n[t][1],e]])):c=0,Ea(n,r-1,t-r+3,i),t=r+i.length-c-2;break}}for(t=-1;++t<n.length;)n[t][1].type==="attentionSequence"&&(n[t][1].type="data");return n}function tC(n,e){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,o=Ef(r);let s;return a;function a(l){return s=l,n.enter("attentionSequence"),u(l)}function u(l){if(l===s)return n.consume(l),u;const i=n.exit("attentionSequence"),c=Ef(l),p=!c||c===2&&o||t.includes(l),h=!o||o===2&&c||t.includes(r);return i._open=!!(s===42?p:p&&(o||!h)),i._close=!!(s===42?h:h&&(c||!p)),e(l)}}function b5(n,e){n.column+=e,n.offset+=e,n._bufferIndex+=e}const eC={name:"autolink",tokenize:nC};function nC(n,e,t){let r=0;return o;function o(f){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(f),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),s}function s(f){return Ws(f)?(n.consume(f),a):f===64?t(f):i(f)}function a(f){return f===43||f===45||f===46||Bs(f)?(r=1,u(f)):i(f)}function u(f){return f===58?(n.consume(f),r=0,l):(f===43||f===45||f===46||Bs(f))&&r++<32?(n.consume(f),u):(r=0,i(f))}function l(f){return f===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(f),n.exit("autolinkMarker"),n.exit("autolink"),e):f===null||f===32||f===60||Vp(f)?t(f):(n.consume(f),l)}function i(f){return f===64?(n.consume(f),c):VA(f)?(n.consume(f),i):t(f)}function c(f){return Bs(f)?p(f):t(f)}function p(f){return f===46?(n.consume(f),r=0,c):f===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(f),n.exit("autolinkMarker"),n.exit("autolink"),e):h(f)}function h(f){if((f===45||Bs(f))&&r++<63){const g=f===45?h:p;return n.consume(f),g}return t(f)}}const id={partial:!0,tokenize:rC};function rC(n,e,t){return r;function r(s){return pr(s)?Cr(n,o,"linePrefix")(s):o(s)}function o(s){return s===null||On(s)?e(s):t(s)}}const E4={continuation:{tokenize:sC},exit:aC,name:"blockQuote",tokenize:iC};function iC(n,e,t){const r=this;return o;function o(a){if(a===62){const u=r.containerState;return u.open||(n.enter("blockQuote",{_container:!0}),u.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(a),n.exit("blockQuoteMarker"),s}return t(a)}function s(a){return pr(a)?(n.enter("blockQuotePrefixWhitespace"),n.consume(a),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),e):(n.exit("blockQuotePrefix"),e(a))}}function sC(n,e,t){const r=this;return o;function o(a){return pr(a)?Cr(n,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):s(a)}function s(a){return n.attempt(E4,e,t)(a)}}function aC(n){n.exit("blockQuote")}const N4={name:"characterEscape",tokenize:oC};function oC(n,e,t){return r;function r(s){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(s),n.exit("escapeMarker"),o}function o(s){return GA(s)?(n.enter("characterEscapeValue"),n.consume(s),n.exit("characterEscapeValue"),n.exit("characterEscape"),e):t(s)}}const T4={name:"characterReference",tokenize:lC};function lC(n,e,t){const r=this;let o=0,s,a;return u;function u(p){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(p),n.exit("characterReferenceMarker"),l}function l(p){return p===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(p),n.exit("characterReferenceMarkerNumeric"),i):(n.enter("characterReferenceValue"),s=31,a=Bs,c(p))}function i(p){return p===88||p===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(p),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),s=6,a=WA,c):(n.enter("characterReferenceValue"),s=7,a=Eg,c(p))}function c(p){if(p===59&&o){const h=n.exit("characterReferenceValue");return a===Bs&&!Ab(r.sliceSerialize(h))?t(p):(n.enter("characterReferenceMarker"),n.consume(p),n.exit("characterReferenceMarker"),n.exit("characterReference"),e)}return a(p)&&o++<s?(n.consume(p),c):t(p)}}const y5={partial:!0,tokenize:cC},v5={concrete:!0,name:"codeFenced",tokenize:uC};function uC(n,e,t){const r=this,o={partial:!0,tokenize:D};let s=0,a=0,u;return l;function l(F){return i(F)}function i(F){const G=r.events[r.events.length-1];return s=G&&G[1].type==="linePrefix"?G[2].sliceSerialize(G[1],!0).length:0,u=F,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),c(F)}function c(F){return F===u?(a++,n.consume(F),c):a<3?t(F):(n.exit("codeFencedFenceSequence"),pr(F)?Cr(n,p,"whitespace")(F):p(F))}function p(F){return F===null||On(F)?(n.exit("codeFencedFence"),r.interrupt?e(F):n.check(y5,y,N)(F)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),h(F))}function h(F){return F===null||On(F)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),p(F)):pr(F)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),Cr(n,f,"whitespace")(F)):F===96&&F===u?t(F):(n.consume(F),h)}function f(F){return F===null||On(F)?p(F):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),g(F))}function g(F){return F===null||On(F)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),p(F)):F===96&&F===u?t(F):(n.consume(F),g)}function y(F){return n.attempt(o,N,b)(F)}function b(F){return n.enter("lineEnding"),n.consume(F),n.exit("lineEnding"),v}function v(F){return s>0&&pr(F)?Cr(n,w,"linePrefix",s+1)(F):w(F)}function w(F){return F===null||On(F)?n.check(y5,y,N)(F):(n.enter("codeFlowValue"),S(F))}function S(F){return F===null||On(F)?(n.exit("codeFlowValue"),w(F)):(n.consume(F),S)}function N(F){return n.exit("codeFenced"),e(F)}function D(F,G,P){let U=0;return q;function q(E){return F.enter("lineEnding"),F.consume(E),F.exit("lineEnding"),R}function R(E){return F.enter("codeFencedFence"),pr(E)?Cr(F,I,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):I(E)}function I(E){return E===u?(F.enter("codeFencedFenceSequence"),T(E)):P(E)}function T(E){return E===u?(U++,F.consume(E),T):U>=a?(F.exit("codeFencedFenceSequence"),pr(E)?Cr(F,L,"whitespace")(E):L(E)):P(E)}function L(E){return E===null||On(E)?(F.exit("codeFencedFence"),G(E)):P(E)}}}function cC(n,e,t){const r=this;return o;function o(a){return a===null?t(a):(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),s)}function s(a){return r.parser.lazy[r.now().line]?t(a):e(a)}}const i1={name:"codeIndented",tokenize:hC},fC={partial:!0,tokenize:dC};function hC(n,e,t){const r=this;return o;function o(i){return n.enter("codeIndented"),Cr(n,s,"linePrefix",5)(i)}function s(i){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?a(i):t(i)}function a(i){return i===null?l(i):On(i)?n.attempt(fC,a,l)(i):(n.enter("codeFlowValue"),u(i))}function u(i){return i===null||On(i)?(n.exit("codeFlowValue"),a(i)):(n.consume(i),u)}function l(i){return n.exit("codeIndented"),e(i)}}function dC(n,e,t){const r=this;return o;function o(a){return r.parser.lazy[r.now().line]?t(a):On(a)?(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),o):Cr(n,s,"linePrefix",5)(a)}function s(a){const u=r.events[r.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?e(a):On(a)?o(a):t(a)}}const pC={name:"codeText",previous:gC,resolve:mC,tokenize:bC};function mC(n){let e=n.length-4,t=3,r,o;if((n[t][1].type==="lineEnding"||n[t][1].type==="space")&&(n[e][1].type==="lineEnding"||n[e][1].type==="space")){for(r=t;++r<e;)if(n[r][1].type==="codeTextData"){n[t][1].type="codeTextPadding",n[e][1].type="codeTextPadding",t+=2,e-=2;break}}for(r=t-1,e++;++r<=e;)o===void 0?r!==e&&n[r][1].type!=="lineEnding"&&(o=r):(r===e||n[r][1].type==="lineEnding")&&(n[o][1].type="codeTextData",r!==o+2&&(n[o][1].end=n[r-1][1].end,n.splice(o+2,r-o-2),e-=r-o-2,r=o+2),o=void 0);return n}function gC(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function bC(n,e,t){let r=0,o,s;return a;function a(p){return n.enter("codeText"),n.enter("codeTextSequence"),u(p)}function u(p){return p===96?(n.consume(p),r++,u):(n.exit("codeTextSequence"),l(p))}function l(p){return p===null?t(p):p===32?(n.enter("space"),n.consume(p),n.exit("space"),l):p===96?(s=n.enter("codeTextSequence"),o=0,c(p)):On(p)?(n.enter("lineEnding"),n.consume(p),n.exit("lineEnding"),l):(n.enter("codeTextData"),i(p))}function i(p){return p===null||p===32||p===96||On(p)?(n.exit("codeTextData"),l(p)):(n.consume(p),i)}function c(p){return p===96?(n.consume(p),o++,c):o===r?(n.exit("codeTextSequence"),n.exit("codeText"),e(p)):(s.type="codeTextData",i(p))}}class yC{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,t,r){const o=t||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-o,Number.POSITIVE_INFINITY);return r&&wh(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),wh(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),wh(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);wh(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);wh(this.left,t.reverse())}}}function wh(n,e){let t=0;if(e.length<1e4)n.push(...e);else for(;t<e.length;)n.push(...e.slice(t,t+1e4)),t+=1e4}function j4(n){const e={};let t=-1,r,o,s,a,u,l,i;const c=new yC(n);for(;++t<c.length;){for(;t in e;)t=e[t];if(r=c.get(t),t&&r[1].type==="chunkFlow"&&c.get(t-1)[1].type==="listItemPrefix"&&(l=r[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,vC(c,t)),t=e[t],i=!0);else if(r[1]._container){for(s=t,o=void 0;s--;)if(a=c.get(s),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(o&&(c.get(o)[1].type="lineEndingBlank"),a[1].type="lineEnding",o=s);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;o&&(r[1].end={...c.get(o)[1].start},u=c.slice(o,t),u.unshift(r),c.splice(o,t-o+1,u))}}return Ea(n,0,Number.POSITIVE_INFINITY,c.slice(0)),!i}function vC(n,e){const t=n.get(e)[1],r=n.get(e)[2];let o=e-1;const s=[];let a=t._tokenizer;a||(a=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const u=a.events,l=[],i={};let c,p,h=-1,f=t,g=0,y=0;const b=[y];for(;f;){for(;n.get(++o)[1]!==f;);s.push(o),f._tokenizer||(c=r.sliceStream(f),f.next||c.push(null),p&&a.defineSkip(f.start),f._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(c),f._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),p=f,f=f.next}for(f=t;++h<u.length;)u[h][0]==="exit"&&u[h-1][0]==="enter"&&u[h][1].type===u[h-1][1].type&&u[h][1].start.line!==u[h][1].end.line&&(y=h+1,b.push(y),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(a.events=[],f?(f._tokenizer=void 0,f.previous=void 0):b.pop(),h=b.length;h--;){const v=u.slice(b[h],b[h+1]),w=s.pop();l.push([w,w+v.length-1]),n.splice(w,2,v)}for(l.reverse(),h=-1;++h<l.length;)i[g+l[h][0]]=g+l[h][1],g+=l[h][1]-l[h][0]-1;return i}const wC={resolve:SC,tokenize:_C},xC={partial:!0,tokenize:kC};function SC(n){return j4(n),n}function _C(n,e){let t;return r;function r(u){return n.enter("content"),t=n.enter("chunkContent",{contentType:"content"}),o(u)}function o(u){return u===null?s(u):On(u)?n.check(xC,a,s)(u):(n.consume(u),o)}function s(u){return n.exit("chunkContent"),n.exit("content"),e(u)}function a(u){return n.consume(u),n.exit("chunkContent"),t.next=n.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,o}}function kC(n,e,t){const r=this;return o;function o(a){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),Cr(n,s,"linePrefix")}function s(a){if(a===null||On(a))return t(a);const u=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?e(a):n.interrupt(r.parser.constructs.flow,t,e)(a)}}function M4(n,e,t,r,o,s,a,u,l){const i=l||Number.POSITIVE_INFINITY;let c=0;return p;function p(v){return v===60?(n.enter(r),n.enter(o),n.enter(s),n.consume(v),n.exit(s),h):v===null||v===32||v===41||Vp(v)?t(v):(n.enter(r),n.enter(a),n.enter(u),n.enter("chunkString",{contentType:"string"}),y(v))}function h(v){return v===62?(n.enter(s),n.consume(v),n.exit(s),n.exit(o),n.exit(r),e):(n.enter(u),n.enter("chunkString",{contentType:"string"}),f(v))}function f(v){return v===62?(n.exit("chunkString"),n.exit(u),h(v)):v===null||v===60||On(v)?t(v):(n.consume(v),v===92?g:f)}function g(v){return v===60||v===62||v===92?(n.consume(v),f):f(v)}function y(v){return!c&&(v===null||v===41||ui(v))?(n.exit("chunkString"),n.exit(u),n.exit(a),n.exit(r),e(v)):c<i&&v===40?(n.consume(v),c++,y):v===41?(n.consume(v),c--,y):v===null||v===32||v===40||Vp(v)?t(v):(n.consume(v),v===92?b:y)}function b(v){return v===40||v===41||v===92?(n.consume(v),y):y(v)}}function L4(n,e,t,r,o,s){const a=this;let u=0,l;return i;function i(f){return n.enter(r),n.enter(o),n.consume(f),n.exit(o),n.enter(s),c}function c(f){return u>999||f===null||f===91||f===93&&!l||f===94&&!u&&"_hiddenFootnoteSupport"in a.parser.constructs?t(f):f===93?(n.exit(s),n.enter(o),n.consume(f),n.exit(o),n.exit(r),e):On(f)?(n.enter("lineEnding"),n.consume(f),n.exit("lineEnding"),c):(n.enter("chunkString",{contentType:"string"}),p(f))}function p(f){return f===null||f===91||f===93||On(f)||u++>999?(n.exit("chunkString"),c(f)):(n.consume(f),l||(l=!pr(f)),f===92?h:p)}function h(f){return f===91||f===92||f===93?(n.consume(f),u++,p):p(f)}}function O4(n,e,t,r,o,s){let a;return u;function u(h){return h===34||h===39||h===40?(n.enter(r),n.enter(o),n.consume(h),n.exit(o),a=h===40?41:h,l):t(h)}function l(h){return h===a?(n.enter(o),n.consume(h),n.exit(o),n.exit(r),e):(n.enter(s),i(h))}function i(h){return h===a?(n.exit(s),l(a)):h===null?t(h):On(h)?(n.enter("lineEnding"),n.consume(h),n.exit("lineEnding"),Cr(n,i,"linePrefix")):(n.enter("chunkString",{contentType:"string"}),c(h))}function c(h){return h===a||h===null||On(h)?(n.exit("chunkString"),i(h)):(n.consume(h),h===92?p:c)}function p(h){return h===a||h===92?(n.consume(h),c):c(h)}}function Rh(n,e){let t;return r;function r(o){return On(o)?(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),t=!0,r):pr(o)?Cr(n,r,t?"linePrefix":"lineSuffix")(o):e(o)}}const AC={name:"definition",tokenize:EC},CC={partial:!0,tokenize:NC};function EC(n,e,t){const r=this;let o;return s;function s(f){return n.enter("definition"),a(f)}function a(f){return L4.call(r,n,u,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(f)}function u(f){return o=wo(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),f===58?(n.enter("definitionMarker"),n.consume(f),n.exit("definitionMarker"),l):t(f)}function l(f){return ui(f)?Rh(n,i)(f):i(f)}function i(f){return M4(n,c,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(f)}function c(f){return n.attempt(CC,p,p)(f)}function p(f){return pr(f)?Cr(n,h,"whitespace")(f):h(f)}function h(f){return f===null||On(f)?(n.exit("definition"),r.parser.defined.push(o),e(f)):t(f)}}function NC(n,e,t){return r;function r(u){return ui(u)?Rh(n,o)(u):t(u)}function o(u){return O4(n,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(u)}function s(u){return pr(u)?Cr(n,a,"whitespace")(u):a(u)}function a(u){return u===null||On(u)?e(u):t(u)}}const TC={name:"hardBreakEscape",tokenize:jC};function jC(n,e,t){return r;function r(s){return n.enter("hardBreakEscape"),n.consume(s),o}function o(s){return On(s)?(n.exit("hardBreakEscape"),e(s)):t(s)}}const MC={name:"headingAtx",resolve:LC,tokenize:OC};function LC(n,e){let t=n.length-2,r=3,o,s;return n[r][1].type==="whitespace"&&(r+=2),t-2>r&&n[t][1].type==="whitespace"&&(t-=2),n[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&n[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(o={type:"atxHeadingText",start:n[r][1].start,end:n[t][1].end},s={type:"chunkText",start:n[r][1].start,end:n[t][1].end,contentType:"text"},Ea(n,r,t-r+1,[["enter",o,e],["enter",s,e],["exit",s,e],["exit",o,e]])),n}function OC(n,e,t){let r=0;return o;function o(c){return n.enter("atxHeading"),s(c)}function s(c){return n.enter("atxHeadingSequence"),a(c)}function a(c){return c===35&&r++<6?(n.consume(c),a):c===null||ui(c)?(n.exit("atxHeadingSequence"),u(c)):t(c)}function u(c){return c===35?(n.enter("atxHeadingSequence"),l(c)):c===null||On(c)?(n.exit("atxHeading"),e(c)):pr(c)?Cr(n,u,"whitespace")(c):(n.enter("atxHeadingText"),i(c))}function l(c){return c===35?(n.consume(c),l):(n.exit("atxHeadingSequence"),u(c))}function i(c){return c===null||c===35||ui(c)?(n.exit("atxHeadingText"),u(c)):(n.consume(c),i)}}const RC=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],w5=["pre","script","style","textarea"],IC={concrete:!0,name:"htmlFlow",resolveTo:PC,tokenize:FC},DC={partial:!0,tokenize:qC},BC={partial:!0,tokenize:zC};function PC(n){let e=n.length;for(;e--&&!(n[e][0]==="enter"&&n[e][1].type==="htmlFlow"););return e>1&&n[e-2][1].type==="linePrefix"&&(n[e][1].start=n[e-2][1].start,n[e+1][1].start=n[e-2][1].start,n.splice(e-2,2)),n}function FC(n,e,t){const r=this;let o,s,a,u,l;return i;function i(H){return c(H)}function c(H){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(H),p}function p(H){return H===33?(n.consume(H),h):H===47?(n.consume(H),s=!0,y):H===63?(n.consume(H),o=3,r.interrupt?e:j):Ws(H)?(n.consume(H),a=String.fromCharCode(H),b):t(H)}function h(H){return H===45?(n.consume(H),o=2,f):H===91?(n.consume(H),o=5,u=0,g):Ws(H)?(n.consume(H),o=4,r.interrupt?e:j):t(H)}function f(H){return H===45?(n.consume(H),r.interrupt?e:j):t(H)}function g(H){const X="CDATA[";return H===X.charCodeAt(u++)?(n.consume(H),u===X.length?r.interrupt?e:I:g):t(H)}function y(H){return Ws(H)?(n.consume(H),a=String.fromCharCode(H),b):t(H)}function b(H){if(H===null||H===47||H===62||ui(H)){const X=H===47,et=a.toLowerCase();return!X&&!s&&w5.includes(et)?(o=1,r.interrupt?e(H):I(H)):RC.includes(a.toLowerCase())?(o=6,X?(n.consume(H),v):r.interrupt?e(H):I(H)):(o=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(H):s?w(H):S(H))}return H===45||Bs(H)?(n.consume(H),a+=String.fromCharCode(H),b):t(H)}function v(H){return H===62?(n.consume(H),r.interrupt?e:I):t(H)}function w(H){return pr(H)?(n.consume(H),w):q(H)}function S(H){return H===47?(n.consume(H),q):H===58||H===95||Ws(H)?(n.consume(H),N):pr(H)?(n.consume(H),S):q(H)}function N(H){return H===45||H===46||H===58||H===95||Bs(H)?(n.consume(H),N):D(H)}function D(H){return H===61?(n.consume(H),F):pr(H)?(n.consume(H),D):S(H)}function F(H){return H===null||H===60||H===61||H===62||H===96?t(H):H===34||H===39?(n.consume(H),l=H,G):pr(H)?(n.consume(H),F):P(H)}function G(H){return H===l?(n.consume(H),l=null,U):H===null||On(H)?t(H):(n.consume(H),G)}function P(H){return H===null||H===34||H===39||H===47||H===60||H===61||H===62||H===96||ui(H)?D(H):(n.consume(H),P)}function U(H){return H===47||H===62||pr(H)?S(H):t(H)}function q(H){return H===62?(n.consume(H),R):t(H)}function R(H){return H===null||On(H)?I(H):pr(H)?(n.consume(H),R):t(H)}function I(H){return H===45&&o===2?(n.consume(H),x):H===60&&o===1?(n.consume(H),k):H===62&&o===4?(n.consume(H),B):H===63&&o===3?(n.consume(H),j):H===93&&o===5?(n.consume(H),C):On(H)&&(o===6||o===7)?(n.exit("htmlFlowData"),n.check(DC,O,T)(H)):H===null||On(H)?(n.exit("htmlFlowData"),T(H)):(n.consume(H),I)}function T(H){return n.check(BC,L,O)(H)}function L(H){return n.enter("lineEnding"),n.consume(H),n.exit("lineEnding"),E}function E(H){return H===null||On(H)?T(H):(n.enter("htmlFlowData"),I(H))}function x(H){return H===45?(n.consume(H),j):I(H)}function k(H){return H===47?(n.consume(H),a="",A):I(H)}function A(H){if(H===62){const X=a.toLowerCase();return w5.includes(X)?(n.consume(H),B):I(H)}return Ws(H)&&a.length<8?(n.consume(H),a+=String.fromCharCode(H),A):I(H)}function C(H){return H===93?(n.consume(H),j):I(H)}function j(H){return H===62?(n.consume(H),B):H===45&&o===2?(n.consume(H),j):I(H)}function B(H){return H===null||On(H)?(n.exit("htmlFlowData"),O(H)):(n.consume(H),B)}function O(H){return n.exit("htmlFlow"),e(H)}}function zC(n,e,t){const r=this;return o;function o(a){return On(a)?(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),s):t(a)}function s(a){return r.parser.lazy[r.now().line]?t(a):e(a)}}function qC(n,e,t){return r;function r(o){return n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),n.attempt(id,e,t)}}const UC={name:"htmlText",tokenize:HC};function HC(n,e,t){const r=this;let o,s,a;return u;function u(j){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(j),l}function l(j){return j===33?(n.consume(j),i):j===47?(n.consume(j),D):j===63?(n.consume(j),S):Ws(j)?(n.consume(j),P):t(j)}function i(j){return j===45?(n.consume(j),c):j===91?(n.consume(j),s=0,g):Ws(j)?(n.consume(j),w):t(j)}function c(j){return j===45?(n.consume(j),f):t(j)}function p(j){return j===null?t(j):j===45?(n.consume(j),h):On(j)?(a=p,k(j)):(n.consume(j),p)}function h(j){return j===45?(n.consume(j),f):p(j)}function f(j){return j===62?x(j):j===45?h(j):p(j)}function g(j){const B="CDATA[";return j===B.charCodeAt(s++)?(n.consume(j),s===B.length?y:g):t(j)}function y(j){return j===null?t(j):j===93?(n.consume(j),b):On(j)?(a=y,k(j)):(n.consume(j),y)}function b(j){return j===93?(n.consume(j),v):y(j)}function v(j){return j===62?x(j):j===93?(n.consume(j),v):y(j)}function w(j){return j===null||j===62?x(j):On(j)?(a=w,k(j)):(n.consume(j),w)}function S(j){return j===null?t(j):j===63?(n.consume(j),N):On(j)?(a=S,k(j)):(n.consume(j),S)}function N(j){return j===62?x(j):S(j)}function D(j){return Ws(j)?(n.consume(j),F):t(j)}function F(j){return j===45||Bs(j)?(n.consume(j),F):G(j)}function G(j){return On(j)?(a=G,k(j)):pr(j)?(n.consume(j),G):x(j)}function P(j){return j===45||Bs(j)?(n.consume(j),P):j===47||j===62||ui(j)?U(j):t(j)}function U(j){return j===47?(n.consume(j),x):j===58||j===95||Ws(j)?(n.consume(j),q):On(j)?(a=U,k(j)):pr(j)?(n.consume(j),U):x(j)}function q(j){return j===45||j===46||j===58||j===95||Bs(j)?(n.consume(j),q):R(j)}function R(j){return j===61?(n.consume(j),I):On(j)?(a=R,k(j)):pr(j)?(n.consume(j),R):U(j)}function I(j){return j===null||j===60||j===61||j===62||j===96?t(j):j===34||j===39?(n.consume(j),o=j,T):On(j)?(a=I,k(j)):pr(j)?(n.consume(j),I):(n.consume(j),L)}function T(j){return j===o?(n.consume(j),o=void 0,E):j===null?t(j):On(j)?(a=T,k(j)):(n.consume(j),T)}function L(j){return j===null||j===34||j===39||j===60||j===61||j===96?t(j):j===47||j===62||ui(j)?U(j):(n.consume(j),L)}function E(j){return j===47||j===62||ui(j)?U(j):t(j)}function x(j){return j===62?(n.consume(j),n.exit("htmlTextData"),n.exit("htmlText"),e):t(j)}function k(j){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(j),n.exit("lineEnding"),A}function A(j){return pr(j)?Cr(n,C,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(j):C(j)}function C(j){return n.enter("htmlTextData"),a(j)}}const Cb={name:"labelEnd",resolveAll:GC,resolveTo:YC,tokenize:XC},$C={tokenize:KC},VC={tokenize:ZC},WC={tokenize:QC};function GC(n){let e=-1;const t=[];for(;++e<n.length;){const r=n[e][1];if(t.push(n[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const o=r.type==="labelImage"?4:2;r.type="data",e+=o}}return n.length!==t.length&&Ea(n,0,n.length,t),n}function YC(n,e){let t=n.length,r=0,o,s,a,u;for(;t--;)if(o=n[t][1],s){if(o.type==="link"||o.type==="labelLink"&&o._inactive)break;n[t][0]==="enter"&&o.type==="labelLink"&&(o._inactive=!0)}else if(a){if(n[t][0]==="enter"&&(o.type==="labelImage"||o.type==="labelLink")&&!o._balanced&&(s=t,o.type!=="labelLink")){r=2;break}}else o.type==="labelEnd"&&(a=t);const l={type:n[s][1].type==="labelLink"?"link":"image",start:{...n[s][1].start},end:{...n[n.length-1][1].end}},i={type:"label",start:{...n[s][1].start},end:{...n[a][1].end}},c={type:"labelText",start:{...n[s+r+2][1].end},end:{...n[a-2][1].start}};return u=[["enter",l,e],["enter",i,e]],u=Ha(u,n.slice(s+1,s+r+3)),u=Ha(u,[["enter",c,e]]),u=Ha(u,d0(e.parser.constructs.insideSpan.null,n.slice(s+r+4,a-3),e)),u=Ha(u,[["exit",c,e],n[a-2],n[a-1],["exit",i,e]]),u=Ha(u,n.slice(a+1)),u=Ha(u,[["exit",l,e]]),Ea(n,s,n.length,u),n}function XC(n,e,t){const r=this;let o=r.events.length,s,a;for(;o--;)if((r.events[o][1].type==="labelImage"||r.events[o][1].type==="labelLink")&&!r.events[o][1]._balanced){s=r.events[o][1];break}return u;function u(h){return s?s._inactive?p(h):(a=r.parser.defined.includes(wo(r.sliceSerialize({start:s.end,end:r.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(h),n.exit("labelMarker"),n.exit("labelEnd"),l):t(h)}function l(h){return h===40?n.attempt($C,c,a?c:p)(h):h===91?n.attempt(VC,c,a?i:p)(h):a?c(h):p(h)}function i(h){return n.attempt(WC,c,p)(h)}function c(h){return e(h)}function p(h){return s._balanced=!0,t(h)}}function KC(n,e,t){return r;function r(p){return n.enter("resource"),n.enter("resourceMarker"),n.consume(p),n.exit("resourceMarker"),o}function o(p){return ui(p)?Rh(n,s)(p):s(p)}function s(p){return p===41?c(p):M4(n,a,u,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(p)}function a(p){return ui(p)?Rh(n,l)(p):c(p)}function u(p){return t(p)}function l(p){return p===34||p===39||p===40?O4(n,i,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(p):c(p)}function i(p){return ui(p)?Rh(n,c)(p):c(p)}function c(p){return p===41?(n.enter("resourceMarker"),n.consume(p),n.exit("resourceMarker"),n.exit("resource"),e):t(p)}}function ZC(n,e,t){const r=this;return o;function o(u){return L4.call(r,n,s,a,"reference","referenceMarker","referenceString")(u)}function s(u){return r.parser.defined.includes(wo(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(u):t(u)}function a(u){return t(u)}}function QC(n,e,t){return r;function r(s){return n.enter("reference"),n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),o}function o(s){return s===93?(n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),n.exit("reference"),e):t(s)}}const JC={name:"labelStartImage",resolveAll:Cb.resolveAll,tokenize:tE};function tE(n,e,t){const r=this;return o;function o(u){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(u),n.exit("labelImageMarker"),s}function s(u){return u===91?(n.enter("labelMarker"),n.consume(u),n.exit("labelMarker"),n.exit("labelImage"),a):t(u)}function a(u){return u===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(u):e(u)}}const eE={name:"labelStartLink",resolveAll:Cb.resolveAll,tokenize:nE};function nE(n,e,t){const r=this;return o;function o(a){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(a),n.exit("labelMarker"),n.exit("labelLink"),s}function s(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(a):e(a)}}const s1={name:"lineEnding",tokenize:rE};function rE(n,e){return t;function t(r){return n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),Cr(n,e,"linePrefix")}}const Dp={name:"thematicBreak",tokenize:iE};function iE(n,e,t){let r=0,o;return s;function s(i){return n.enter("thematicBreak"),a(i)}function a(i){return o=i,u(i)}function u(i){return i===o?(n.enter("thematicBreakSequence"),l(i)):r>=3&&(i===null||On(i))?(n.exit("thematicBreak"),e(i)):t(i)}function l(i){return i===o?(n.consume(i),r++,l):(n.exit("thematicBreakSequence"),pr(i)?Cr(n,u,"whitespace")(i):u(i))}}const ha={continuation:{tokenize:lE},exit:cE,name:"list",tokenize:oE},sE={partial:!0,tokenize:fE},aE={partial:!0,tokenize:uE};function oE(n,e,t){const r=this,o=r.events[r.events.length-1];let s=o&&o[1].type==="linePrefix"?o[2].sliceSerialize(o[1],!0).length:0,a=0;return u;function u(f){const g=r.containerState.type||(f===42||f===43||f===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||f===r.containerState.marker:Eg(f)){if(r.containerState.type||(r.containerState.type=g,n.enter(g,{_container:!0})),g==="listUnordered")return n.enter("listItemPrefix"),f===42||f===45?n.check(Dp,t,i)(f):i(f);if(!r.interrupt||f===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),l(f)}return t(f)}function l(f){return Eg(f)&&++a<10?(n.consume(f),l):(!r.interrupt||a<2)&&(r.containerState.marker?f===r.containerState.marker:f===41||f===46)?(n.exit("listItemValue"),i(f)):t(f)}function i(f){return n.enter("listItemMarker"),n.consume(f),n.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||f,n.check(id,r.interrupt?t:c,n.attempt(sE,h,p))}function c(f){return r.containerState.initialBlankLine=!0,s++,h(f)}function p(f){return pr(f)?(n.enter("listItemPrefixWhitespace"),n.consume(f),n.exit("listItemPrefixWhitespace"),h):t(f)}function h(f){return r.containerState.size=s+r.sliceSerialize(n.exit("listItemPrefix"),!0).length,e(f)}}function lE(n,e,t){const r=this;return r.containerState._closeFlow=void 0,n.check(id,o,s);function o(u){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Cr(n,e,"listItemIndent",r.containerState.size+1)(u)}function s(u){return r.containerState.furtherBlankLines||!pr(u)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(u)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,n.attempt(aE,e,a)(u))}function a(u){return r.containerState._closeFlow=!0,r.interrupt=void 0,Cr(n,n.attempt(ha,e,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(u)}}function uE(n,e,t){const r=this;return Cr(n,o,"listItemIndent",r.containerState.size+1);function o(s){const a=r.events[r.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===r.containerState.size?e(s):t(s)}}function cE(n){n.exit(this.containerState.type)}function fE(n,e,t){const r=this;return Cr(n,o,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function o(s){const a=r.events[r.events.length-1];return!pr(s)&&a&&a[1].type==="listItemPrefixWhitespace"?e(s):t(s)}}const x5={name:"setextUnderline",resolveTo:hE,tokenize:dE};function hE(n,e){let t=n.length,r,o,s;for(;t--;)if(n[t][0]==="enter"){if(n[t][1].type==="content"){r=t;break}n[t][1].type==="paragraph"&&(o=t)}else n[t][1].type==="content"&&n.splice(t,1),!s&&n[t][1].type==="definition"&&(s=t);const a={type:"setextHeading",start:{...n[r][1].start},end:{...n[n.length-1][1].end}};return n[o][1].type="setextHeadingText",s?(n.splice(o,0,["enter",a,e]),n.splice(s+1,0,["exit",n[r][1],e]),n[r][1].end={...n[s][1].end}):n[r][1]=a,n.push(["exit",a,e]),n}function dE(n,e,t){const r=this;let o;return s;function s(i){let c=r.events.length,p;for(;c--;)if(r.events[c][1].type!=="lineEnding"&&r.events[c][1].type!=="linePrefix"&&r.events[c][1].type!=="content"){p=r.events[c][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||p)?(n.enter("setextHeadingLine"),o=i,a(i)):t(i)}function a(i){return n.enter("setextHeadingLineSequence"),u(i)}function u(i){return i===o?(n.consume(i),u):(n.exit("setextHeadingLineSequence"),pr(i)?Cr(n,l,"lineSuffix")(i):l(i))}function l(i){return i===null||On(i)?(n.exit("setextHeadingLine"),e(i)):t(i)}}const pE={tokenize:mE};function mE(n){const e=this,t=n.attempt(id,r,n.attempt(this.parser.constructs.flowInitial,o,Cr(n,n.attempt(this.parser.constructs.flow,o,n.attempt(wC,o)),"linePrefix")));return t;function r(s){if(s===null){n.consume(s);return}return n.enter("lineEndingBlank"),n.consume(s),n.exit("lineEndingBlank"),e.currentConstruct=void 0,t}function o(s){if(s===null){n.consume(s);return}return n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),e.currentConstruct=void 0,t}}const gE={resolveAll:I4()},bE=R4("string"),yE=R4("text");function R4(n){return{resolveAll:I4(n==="text"?vE:void 0),tokenize:e};function e(t){const r=this,o=this.parser.constructs[n],s=t.attempt(o,a,u);return a;function a(c){return i(c)?s(c):u(c)}function u(c){if(c===null){t.consume(c);return}return t.enter("data"),t.consume(c),l}function l(c){return i(c)?(t.exit("data"),s(c)):(t.consume(c),l)}function i(c){if(c===null)return!0;const p=o[c];let h=-1;if(p)for(;++h<p.length;){const f=p[h];if(!f.previous||f.previous.call(r,r.previous))return!0}return!1}}}function I4(n){return e;function e(t,r){let o=-1,s;for(;++o<=t.length;)s===void 0?t[o]&&t[o][1].type==="data"&&(s=o,o++):(!t[o]||t[o][1].type!=="data")&&(o!==s+2&&(t[s][1].end=t[o-1][1].end,t.splice(s+2,o-s-2),o=s+2),s=void 0);return n?n(t,r):t}}function vE(n,e){let t=0;for(;++t<=n.length;)if((t===n.length||n[t][1].type==="lineEnding")&&n[t-1][1].type==="data"){const r=n[t-1][1],o=e.sliceStream(r);let s=o.length,a=-1,u=0,l;for(;s--;){const i=o[s];if(typeof i=="string"){for(a=i.length;i.charCodeAt(a-1)===32;)u++,a--;if(a)break;a=-1}else if(i===-2)l=!0,u++;else if(i!==-1){s++;break}}if(e._contentTypeTextTrailing&&t===n.length&&(u=0),u){const i={type:t===n.length||l||u<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?a:r.start._bufferIndex+a,_index:r.start._index+s,line:r.end.line,column:r.end.column-u,offset:r.end.offset-u},end:{...r.end}};r.end={...i.start},r.start.offset===r.end.offset?Object.assign(r,i):(n.splice(t,0,["enter",i,e],["exit",i,e]),t+=2)}t++}return n}const wE={42:ha,43:ha,45:ha,48:ha,49:ha,50:ha,51:ha,52:ha,53:ha,54:ha,55:ha,56:ha,57:ha,62:E4},xE={91:AC},SE={[-2]:i1,[-1]:i1,32:i1},_E={35:MC,42:Dp,45:[x5,Dp],60:IC,61:x5,95:Dp,96:v5,126:v5},kE={38:T4,92:N4},AE={[-5]:s1,[-4]:s1,[-3]:s1,33:JC,38:T4,42:Ng,60:[eC,UC],91:eE,92:[TC,N4],93:Cb,95:Ng,96:pC},CE={null:[Ng,gE]},EE={null:[42,95]},NE={null:[]},TE=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:EE,contentInitial:xE,disable:NE,document:wE,flow:_E,flowInitial:SE,insideSpan:CE,string:kE,text:AE},Symbol.toStringTag,{value:"Module"}));function jE(n,e,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const o={},s=[];let a=[],u=[];const l={attempt:G(D),check:G(F),consume:w,enter:S,exit:N,interrupt:G(F,{interrupt:!0})},i={code:null,containerState:{},defineSkip:y,events:[],now:g,parser:n,previous:null,sliceSerialize:h,sliceStream:f,write:p};let c=e.tokenize.call(i,l);return e.resolveAll&&s.push(e),i;function p(R){return a=Ha(a,R),b(),a[a.length-1]!==null?[]:(P(e,0),i.events=d0(s,i.events,i),i.events)}function h(R,I){return LE(f(R),I)}function f(R){return ME(a,R)}function g(){const{_bufferIndex:R,_index:I,line:T,column:L,offset:E}=r;return{_bufferIndex:R,_index:I,line:T,column:L,offset:E}}function y(R){o[R.line]=R.column,q()}function b(){let R;for(;r._index<a.length;){const I=a[r._index];if(typeof I=="string")for(R=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===R&&r._bufferIndex<I.length;)v(I.charCodeAt(r._bufferIndex));else v(I)}}function v(R){c=c(R)}function w(R){On(R)?(r.line++,r.column=1,r.offset+=R===-3?2:1,q()):R!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++)),i.previous=R}function S(R,I){const T=I||{};return T.type=R,T.start=g(),i.events.push(["enter",T,i]),u.push(T),T}function N(R){const I=u.pop();return I.end=g(),i.events.push(["exit",I,i]),I}function D(R,I){P(R,I.from)}function F(R,I){I.restore()}function G(R,I){return T;function T(L,E,x){let k,A,C,j;return Array.isArray(L)?O(L):"tokenize"in L?O([L]):B(L);function B(V){return tt;function tt($){const z=$!==null&&V[$],Z=$!==null&&V.null,it=[...Array.isArray(z)?z:z?[z]:[],...Array.isArray(Z)?Z:Z?[Z]:[]];return O(it)($)}}function O(V){return k=V,A=0,V.length===0?x:H(V[A])}function H(V){return tt;function tt($){return j=U(),C=V,V.partial||(i.currentConstruct=V),V.name&&i.parser.constructs.disable.null.includes(V.name)?et():V.tokenize.call(I?Object.assign(Object.create(i),I):i,l,X,et)($)}}function X(V){return R(C,j),E}function et(V){return j.restore(),++A<k.length?H(k[A]):x}}}function P(R,I){R.resolveAll&&!s.includes(R)&&s.push(R),R.resolve&&Ea(i.events,I,i.events.length-I,R.resolve(i.events.slice(I),i)),R.resolveTo&&(i.events=R.resolveTo(i.events,i))}function U(){const R=g(),I=i.previous,T=i.currentConstruct,L=i.events.length,E=Array.from(u);return{from:L,restore:x};function x(){r=R,i.previous=I,i.currentConstruct=T,i.events.length=L,u=E,q()}}function q(){r.line in o&&r.column<2&&(r.column=o[r.line],r.offset+=o[r.line]-1)}}function ME(n,e){const t=e.start._index,r=e.start._bufferIndex,o=e.end._index,s=e.end._bufferIndex;let a;if(t===o)a=[n[t].slice(r,s)];else{if(a=n.slice(t,o),r>-1){const u=a[0];typeof u=="string"?a[0]=u.slice(r):a.shift()}s>0&&a.push(n[o].slice(0,s))}return a}function LE(n,e){let t=-1;const r=[];let o;for(;++t<n.length;){const s=n[t];let a;if(typeof s=="string")a=s;else switch(s){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=e?" ":"	";break}case-1:{if(!e&&o)continue;a=" ";break}default:a=String.fromCharCode(s)}o=s===-2,r.push(a)}return r.join("")}function OE(n){const r={constructs:A4([TE,...(n||{}).extensions||[]]),content:o(YA),defined:[],document:o(KA),flow:o(pE),lazy:{},string:o(bE),text:o(yE)};return r;function o(s){return a;function a(u){return jE(r,s,u)}}}function RE(n){for(;!j4(n););return n}const S5=/[\0\t\n\r]/g;function IE(){let n=1,e="",t=!0,r;return o;function o(s,a,u){const l=[];let i,c,p,h,f;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(a||void 0).decode(s)),p=0,e="",t&&(s.charCodeAt(0)===65279&&p++,t=void 0);p<s.length;){if(S5.lastIndex=p,i=S5.exec(s),h=i&&i.index!==void 0?i.index:s.length,f=s.charCodeAt(h),!i){e=s.slice(p);break}if(f===10&&p===h&&r)l.push(-3),r=void 0;else switch(r&&(l.push(-5),r=void 0),p<h&&(l.push(s.slice(p,h)),n+=h-p),f){case 0:{l.push(65533),n++;break}case 9:{for(c=Math.ceil(n/4)*4,l.push(-2);n++<c;)l.push(-1);break}case 10:{l.push(-4),n=1;break}default:r=!0,n=1}p=h+1}return u&&(r&&l.push(-5),e&&l.push(e),l.push(null)),l}}const DE=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function BE(n){return n.replace(DE,PE)}function PE(n,e,t){if(e)return e;if(t.charCodeAt(0)===35){const o=t.charCodeAt(1),s=o===120||o===88;return C4(t.slice(s?2:1),s?16:10)}return Ab(t)||n}const D4={}.hasOwnProperty;function FE(n,e,t){return typeof e!="string"&&(t=e,e=void 0),zE(t)(RE(OE(t).document().write(IE()(n,e,!0))))}function zE(n){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(ft),autolinkProtocol:U,autolinkEmail:U,atxHeading:s(rt),blockQuote:s(Z),characterEscape:U,characterReference:U,codeFenced:s(it),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(it,a),codeText:s(mt,a),codeTextData:U,data:U,codeFlowValue:U,definition:s(lt),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(at),hardBreakEscape:s(ct),hardBreakTrailing:s(ct),htmlFlow:s(ot,a),htmlFlowData:U,htmlText:s(ot,a),htmlTextData:U,image:s(dt),label:a,link:s(ft),listItem:s(wt),listItemValue:h,listOrdered:s(gt,p),listUnordered:s(gt),paragraph:s(yt),reference:H,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s(rt),strong:s(Et),thematicBreak:s(qt)},exit:{atxHeading:l(),atxHeadingSequence:D,autolink:l(),autolinkEmail:z,autolinkProtocol:$,blockQuote:l(),characterEscapeValue:q,characterReferenceMarkerHexadecimal:et,characterReferenceMarkerNumeric:et,characterReferenceValue:V,characterReference:tt,codeFenced:l(b),codeFencedFence:y,codeFencedFenceInfo:f,codeFencedFenceMeta:g,codeFlowValue:q,codeIndented:l(v),codeText:l(E),codeTextData:q,data:q,definition:l(),definitionDestinationString:N,definitionLabelString:w,definitionTitleString:S,emphasis:l(),hardBreakEscape:l(I),hardBreakTrailing:l(I),htmlFlow:l(T),htmlFlowData:q,htmlText:l(L),htmlTextData:q,image:l(k),label:C,labelText:A,lineEnding:R,link:l(x),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:X,resourceDestinationString:j,resourceTitleString:B,resource:O,setextHeading:l(P),setextHeadingLineSequence:G,setextHeadingText:F,strong:l(),thematicBreak:l()}};B4(e,(n||{}).mdastExtensions||[]);const t={};return r;function r(Tt){let It={type:"root",children:[]};const Vt={stack:[It],tokenStack:[],config:e,enter:u,exit:i,buffer:a,resume:c,data:t},Kt=[];let ne=-1;for(;++ne<Tt.length;)if(Tt[ne][1].type==="listOrdered"||Tt[ne][1].type==="listUnordered")if(Tt[ne][0]==="enter")Kt.push(ne);else{const ae=Kt.pop();ne=o(Tt,ae,ne)}for(ne=-1;++ne<Tt.length;){const ae=e[Tt[ne][0]];D4.call(ae,Tt[ne][1].type)&&ae[Tt[ne][1].type].call(Object.assign({sliceSerialize:Tt[ne][2].sliceSerialize},Vt),Tt[ne][1])}if(Vt.tokenStack.length>0){const ae=Vt.tokenStack[Vt.tokenStack.length-1];(ae[1]||_5).call(Vt,void 0,ae[0])}for(It.position={start:gu(Tt.length>0?Tt[0][1].start:{line:1,column:1,offset:0}),end:gu(Tt.length>0?Tt[Tt.length-2][1].end:{line:1,column:1,offset:0})},ne=-1;++ne<e.transforms.length;)It=e.transforms[ne](It)||It;return It}function o(Tt,It,Vt){let Kt=It-1,ne=-1,ae=!1,Oe,le,Jt,ue;for(;++Kt<=Vt;){const ge=Tt[Kt];switch(ge[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{ge[0]==="enter"?ne++:ne--,ue=void 0;break}case"lineEndingBlank":{ge[0]==="enter"&&(Oe&&!ue&&!ne&&!Jt&&(Jt=Kt),ue=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ue=void 0}if(!ne&&ge[0]==="enter"&&ge[1].type==="listItemPrefix"||ne===-1&&ge[0]==="exit"&&(ge[1].type==="listUnordered"||ge[1].type==="listOrdered")){if(Oe){let fe=Kt;for(le=void 0;fe--;){const qe=Tt[fe];if(qe[1].type==="lineEnding"||qe[1].type==="lineEndingBlank"){if(qe[0]==="exit")continue;le&&(Tt[le][1].type="lineEndingBlank",ae=!0),qe[1].type="lineEnding",le=fe}else if(!(qe[1].type==="linePrefix"||qe[1].type==="blockQuotePrefix"||qe[1].type==="blockQuotePrefixWhitespace"||qe[1].type==="blockQuoteMarker"||qe[1].type==="listItemIndent"))break}Jt&&(!le||Jt<le)&&(Oe._spread=!0),Oe.end=Object.assign({},le?Tt[le][1].start:ge[1].end),Tt.splice(le||Kt,0,["exit",Oe,ge[2]]),Kt++,Vt++}if(ge[1].type==="listItemPrefix"){const fe={type:"listItem",_spread:!1,start:Object.assign({},ge[1].start),end:void 0};Oe=fe,Tt.splice(Kt,0,["enter",fe,ge[2]]),Kt++,Vt++,Jt=void 0,ue=!0}}}return Tt[It][1]._spread=ae,Vt}function s(Tt,It){return Vt;function Vt(Kt){u.call(this,Tt(Kt),Kt),It&&It.call(this,Kt)}}function a(){this.stack.push({type:"fragment",children:[]})}function u(Tt,It,Vt){this.stack[this.stack.length-1].children.push(Tt),this.stack.push(Tt),this.tokenStack.push([It,Vt||void 0]),Tt.position={start:gu(It.start),end:void 0}}function l(Tt){return It;function It(Vt){Tt&&Tt.call(this,Vt),i.call(this,Vt)}}function i(Tt,It){const Vt=this.stack.pop(),Kt=this.tokenStack.pop();if(Kt)Kt[0].type!==Tt.type&&(It?It.call(this,Tt,Kt[0]):(Kt[1]||_5).call(this,Tt,Kt[0]));else throw new Error("Cannot close `"+Tt.type+"` ("+Oh({start:Tt.start,end:Tt.end})+"): its not open");Vt.position.end=gu(Tt.end)}function c(){return kb(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function h(Tt){if(this.data.expectingFirstListItemValue){const It=this.stack[this.stack.length-2];It.start=Number.parseInt(this.sliceSerialize(Tt),10),this.data.expectingFirstListItemValue=void 0}}function f(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.lang=Tt}function g(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.meta=Tt}function y(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function b(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.value=Tt.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.value=Tt.replace(/(\r?\n|\r)$/g,"")}function w(Tt){const It=this.resume(),Vt=this.stack[this.stack.length-1];Vt.label=It,Vt.identifier=wo(this.sliceSerialize(Tt)).toLowerCase()}function S(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.title=Tt}function N(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.url=Tt}function D(Tt){const It=this.stack[this.stack.length-1];if(!It.depth){const Vt=this.sliceSerialize(Tt).length;It.depth=Vt}}function F(){this.data.setextHeadingSlurpLineEnding=!0}function G(Tt){const It=this.stack[this.stack.length-1];It.depth=this.sliceSerialize(Tt).codePointAt(0)===61?1:2}function P(){this.data.setextHeadingSlurpLineEnding=void 0}function U(Tt){const Vt=this.stack[this.stack.length-1].children;let Kt=Vt[Vt.length-1];(!Kt||Kt.type!=="text")&&(Kt=Mt(),Kt.position={start:gu(Tt.start),end:void 0},Vt.push(Kt)),this.stack.push(Kt)}function q(Tt){const It=this.stack.pop();It.value+=this.sliceSerialize(Tt),It.position.end=gu(Tt.end)}function R(Tt){const It=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Vt=It.children[It.children.length-1];Vt.position.end=gu(Tt.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(It.type)&&(U.call(this,Tt),q.call(this,Tt))}function I(){this.data.atHardBreak=!0}function T(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.value=Tt}function L(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.value=Tt}function E(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.value=Tt}function x(){const Tt=this.stack[this.stack.length-1];if(this.data.inReference){const It=this.data.referenceType||"shortcut";Tt.type+="Reference",Tt.referenceType=It,delete Tt.url,delete Tt.title}else delete Tt.identifier,delete Tt.label;this.data.referenceType=void 0}function k(){const Tt=this.stack[this.stack.length-1];if(this.data.inReference){const It=this.data.referenceType||"shortcut";Tt.type+="Reference",Tt.referenceType=It,delete Tt.url,delete Tt.title}else delete Tt.identifier,delete Tt.label;this.data.referenceType=void 0}function A(Tt){const It=this.sliceSerialize(Tt),Vt=this.stack[this.stack.length-2];Vt.label=BE(It),Vt.identifier=wo(It).toLowerCase()}function C(){const Tt=this.stack[this.stack.length-1],It=this.resume(),Vt=this.stack[this.stack.length-1];if(this.data.inReference=!0,Vt.type==="link"){const Kt=Tt.children;Vt.children=Kt}else Vt.alt=It}function j(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.url=Tt}function B(){const Tt=this.resume(),It=this.stack[this.stack.length-1];It.title=Tt}function O(){this.data.inReference=void 0}function H(){this.data.referenceType="collapsed"}function X(Tt){const It=this.resume(),Vt=this.stack[this.stack.length-1];Vt.label=It,Vt.identifier=wo(this.sliceSerialize(Tt)).toLowerCase(),this.data.referenceType="full"}function et(Tt){this.data.characterReferenceType=Tt.type}function V(Tt){const It=this.sliceSerialize(Tt),Vt=this.data.characterReferenceType;let Kt;Vt?(Kt=C4(It,Vt==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Kt=Ab(It);const ne=this.stack[this.stack.length-1];ne.value+=Kt}function tt(Tt){const It=this.stack.pop();It.position.end=gu(Tt.end)}function $(Tt){q.call(this,Tt);const It=this.stack[this.stack.length-1];It.url=this.sliceSerialize(Tt)}function z(Tt){q.call(this,Tt);const It=this.stack[this.stack.length-1];It.url="mailto:"+this.sliceSerialize(Tt)}function Z(){return{type:"blockquote",children:[]}}function it(){return{type:"code",lang:null,meta:null,value:""}}function mt(){return{type:"inlineCode",value:""}}function lt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function at(){return{type:"emphasis",children:[]}}function rt(){return{type:"heading",depth:0,children:[]}}function ct(){return{type:"break"}}function ot(){return{type:"html",value:""}}function dt(){return{type:"image",title:null,url:"",alt:null}}function ft(){return{type:"link",title:null,url:"",children:[]}}function gt(Tt){return{type:"list",ordered:Tt.type==="listOrdered",start:null,spread:Tt._spread,children:[]}}function wt(Tt){return{type:"listItem",spread:Tt._spread,checked:null,children:[]}}function yt(){return{type:"paragraph",children:[]}}function Et(){return{type:"strong",children:[]}}function Mt(){return{type:"text",value:""}}function qt(){return{type:"thematicBreak"}}}function gu(n){return{line:n.line,column:n.column,offset:n.offset}}function B4(n,e){let t=-1;for(;++t<e.length;){const r=e[t];Array.isArray(r)?B4(n,r):qE(n,r)}}function qE(n,e){let t;for(t in e)if(D4.call(e,t))switch(t){case"canContainEols":{const r=e[t];r&&n[t].push(...r);break}case"transforms":{const r=e[t];r&&n[t].push(...r);break}case"enter":case"exit":{const r=e[t];r&&Object.assign(n[t],r);break}}}function _5(n,e){throw n?new Error("Cannot close `"+n.type+"` ("+Oh({start:n.start,end:n.end})+"): a different token (`"+e.type+"`, "+Oh({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Oh({start:e.start,end:e.end})+") is still open")}function UE(n){const e=this;e.parser=t;function t(r){return FE(r,{...e.data("settings"),...n,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function HE(n,e){const t={type:"element",tagName:"blockquote",properties:{},children:n.wrap(n.all(e),!0)};return n.patch(e,t),n.applyData(e,t)}function $E(n,e){const t={type:"element",tagName:"br",properties:{},children:[]};return n.patch(e,t),[n.applyData(e,t),{type:"text",value:`
`}]}function VE(n,e){const t=e.value?e.value+`
`:"",r={},o=e.lang?e.lang.split(/\s+/):[];o.length>0&&(r.className=["language-"+o[0]]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return e.meta&&(s.data={meta:e.meta}),n.patch(e,s),s=n.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},n.patch(e,s),s}function WE(n,e){const t={type:"element",tagName:"del",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function GE(n,e){const t={type:"element",tagName:"em",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function YE(n,e){const t=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),o=Mf(r.toLowerCase()),s=n.footnoteOrder.indexOf(r);let a,u=n.footnoteCounts.get(r);u===void 0?(u=0,n.footnoteOrder.push(r),a=n.footnoteOrder.length):a=s+1,u+=1,n.footnoteCounts.set(r,u);const l={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+o,id:t+"fnref-"+o+(u>1?"-"+u:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};n.patch(e,l);const i={type:"element",tagName:"sup",properties:{},children:[l]};return n.patch(e,i),n.applyData(e,i)}function XE(n,e){const t={type:"element",tagName:"h"+e.depth,properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function KE(n,e){if(n.options.allowDangerousHtml){const t={type:"raw",value:e.value};return n.patch(e,t),n.applyData(e,t)}}function P4(n,e){const t=e.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const o=n.all(e),s=o[0];s&&s.type==="text"?s.value="["+s.value:o.unshift({type:"text",value:"["});const a=o[o.length-1];return a&&a.type==="text"?a.value+=r:o.push({type:"text",value:r}),o}function ZE(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return P4(n,e);const o={src:Mf(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(o.title=r.title);const s={type:"element",tagName:"img",properties:o,children:[]};return n.patch(e,s),n.applyData(e,s)}function QE(n,e){const t={src:Mf(e.url)};e.alt!==null&&e.alt!==void 0&&(t.alt=e.alt),e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"img",properties:t,children:[]};return n.patch(e,r),n.applyData(e,r)}function JE(n,e){const t={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};n.patch(e,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return n.patch(e,r),n.applyData(e,r)}function tN(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return P4(n,e);const o={href:Mf(r.url||"")};r.title!==null&&r.title!==void 0&&(o.title=r.title);const s={type:"element",tagName:"a",properties:o,children:n.all(e)};return n.patch(e,s),n.applyData(e,s)}function eN(n,e){const t={href:Mf(e.url)};e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"a",properties:t,children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function nN(n,e,t){const r=n.all(e),o=t?rN(t):F4(e),s={},a=[];if(typeof e.checked=="boolean"){const c=r[0];let p;c&&c.type==="element"&&c.tagName==="p"?p=c:(p={type:"element",tagName:"p",properties:{},children:[]},r.unshift(p)),p.children.length>0&&p.children.unshift({type:"text",value:" "}),p.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let u=-1;for(;++u<r.length;){const c=r[u];(o||u!==0||c.type!=="element"||c.tagName!=="p")&&a.push({type:"text",value:`
`}),c.type==="element"&&c.tagName==="p"&&!o?a.push(...c.children):a.push(c)}const l=r[r.length-1];l&&(o||l.type!=="element"||l.tagName!=="p")&&a.push({type:"text",value:`
`});const i={type:"element",tagName:"li",properties:s,children:a};return n.patch(e,i),n.applyData(e,i)}function rN(n){let e=!1;if(n.type==="list"){e=n.spread||!1;const t=n.children;let r=-1;for(;!e&&++r<t.length;)e=F4(t[r])}return e}function F4(n){const e=n.spread;return e??n.children.length>1}function iN(n,e){const t={},r=n.all(e);let o=-1;for(typeof e.start=="number"&&e.start!==1&&(t.start=e.start);++o<r.length;){const a=r[o];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:t,children:n.wrap(r,!0)};return n.patch(e,s),n.applyData(e,s)}function sN(n,e){const t={type:"element",tagName:"p",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function aN(n,e){const t={type:"root",children:n.wrap(n.all(e))};return n.patch(e,t),n.applyData(e,t)}function oN(n,e){const t={type:"element",tagName:"strong",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function lN(n,e){const t=n.all(e),r=t.shift(),o=[];if(r){const a={type:"element",tagName:"thead",properties:{},children:n.wrap([r],!0)};n.patch(e.children[0],a),o.push(a)}if(t.length>0){const a={type:"element",tagName:"tbody",properties:{},children:n.wrap(t,!0)},u=wb(e.children[1]),l=y4(e.children[e.children.length-1]);u&&l&&(a.position={start:u,end:l}),o.push(a)}const s={type:"element",tagName:"table",properties:{},children:n.wrap(o,!0)};return n.patch(e,s),n.applyData(e,s)}function uN(n,e,t){const r=t?t.children:void 0,s=(r?r.indexOf(e):1)===0?"th":"td",a=t&&t.type==="table"?t.align:void 0,u=a?a.length:e.children.length;let l=-1;const i=[];for(;++l<u;){const p=e.children[l],h={},f=a?a[l]:void 0;f&&(h.align=f);let g={type:"element",tagName:s,properties:h,children:[]};p&&(g.children=n.all(p),n.patch(p,g),g=n.applyData(p,g)),i.push(g)}const c={type:"element",tagName:"tr",properties:{},children:n.wrap(i,!0)};return n.patch(e,c),n.applyData(e,c)}function cN(n,e){const t={type:"element",tagName:"td",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}const k5=9,A5=32;function fN(n){const e=String(n),t=/\r?\n|\r/g;let r=t.exec(e),o=0;const s=[];for(;r;)s.push(C5(e.slice(o,r.index),o>0,!0),r[0]),o=r.index+r[0].length,r=t.exec(e);return s.push(C5(e.slice(o),o>0,!1)),s.join("")}function C5(n,e,t){let r=0,o=n.length;if(e){let s=n.codePointAt(r);for(;s===k5||s===A5;)r++,s=n.codePointAt(r)}if(t){let s=n.codePointAt(o-1);for(;s===k5||s===A5;)o--,s=n.codePointAt(o-1)}return o>r?n.slice(r,o):""}function hN(n,e){const t={type:"text",value:fN(String(e.value))};return n.patch(e,t),n.applyData(e,t)}function dN(n,e){const t={type:"element",tagName:"hr",properties:{},children:[]};return n.patch(e,t),n.applyData(e,t)}const pN={blockquote:HE,break:$E,code:VE,delete:WE,emphasis:GE,footnoteReference:YE,heading:XE,html:KE,imageReference:ZE,image:QE,inlineCode:JE,linkReference:tN,link:eN,listItem:nN,list:iN,paragraph:sN,root:aN,strong:oN,table:lN,tableCell:cN,tableRow:uN,text:hN,thematicBreak:dN,toml:op,yaml:op,definition:op,footnoteDefinition:op};function op(){}const z4=-1,p0=0,Ih=1,Wp=2,Eb=3,Nb=4,Tb=5,jb=6,q4=7,U4=8,E5=typeof self=="object"?self:globalThis,mN=(n,e)=>{const t=(o,s)=>(n.set(s,o),o),r=o=>{if(n.has(o))return n.get(o);const[s,a]=e[o];switch(s){case p0:case z4:return t(a,o);case Ih:{const u=t([],o);for(const l of a)u.push(r(l));return u}case Wp:{const u=t({},o);for(const[l,i]of a)u[r(l)]=r(i);return u}case Eb:return t(new Date(a),o);case Nb:{const{source:u,flags:l}=a;return t(new RegExp(u,l),o)}case Tb:{const u=t(new Map,o);for(const[l,i]of a)u.set(r(l),r(i));return u}case jb:{const u=t(new Set,o);for(const l of a)u.add(r(l));return u}case q4:{const{name:u,message:l}=a;return t(new E5[u](l),o)}case U4:return t(BigInt(a),o);case"BigInt":return t(Object(BigInt(a)),o);case"ArrayBuffer":return t(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:u}=new Uint8Array(a);return t(new DataView(u),a)}}return t(new E5[s](a),o)};return r},N5=n=>mN(new Map,n)(0),ef="",{toString:gN}={},{keys:bN}=Object,xh=n=>{const e=typeof n;if(e!=="object"||!n)return[p0,e];const t=gN.call(n).slice(8,-1);switch(t){case"Array":return[Ih,ef];case"Object":return[Wp,ef];case"Date":return[Eb,ef];case"RegExp":return[Nb,ef];case"Map":return[Tb,ef];case"Set":return[jb,ef];case"DataView":return[Ih,t]}return t.includes("Array")?[Ih,t]:t.includes("Error")?[q4,t]:[Wp,t]},lp=([n,e])=>n===p0&&(e==="function"||e==="symbol"),yN=(n,e,t,r)=>{const o=(a,u)=>{const l=r.push(a)-1;return t.set(u,l),l},s=a=>{if(t.has(a))return t.get(a);let[u,l]=xh(a);switch(u){case p0:{let c=a;switch(l){case"bigint":u=U4,c=a.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+l);c=null;break;case"undefined":return o([z4],a)}return o([u,c],a)}case Ih:{if(l){let h=a;return l==="DataView"?h=new Uint8Array(a.buffer):l==="ArrayBuffer"&&(h=new Uint8Array(a)),o([l,[...h]],a)}const c=[],p=o([u,c],a);for(const h of a)c.push(s(h));return p}case Wp:{if(l)switch(l){case"BigInt":return o([l,a.toString()],a);case"Boolean":case"Number":case"String":return o([l,a.valueOf()],a)}if(e&&"toJSON"in a)return s(a.toJSON());const c=[],p=o([u,c],a);for(const h of bN(a))(n||!lp(xh(a[h])))&&c.push([s(h),s(a[h])]);return p}case Eb:return o([u,a.toISOString()],a);case Nb:{const{source:c,flags:p}=a;return o([u,{source:c,flags:p}],a)}case Tb:{const c=[],p=o([u,c],a);for(const[h,f]of a)(n||!(lp(xh(h))||lp(xh(f))))&&c.push([s(h),s(f)]);return p}case jb:{const c=[],p=o([u,c],a);for(const h of a)(n||!lp(xh(h)))&&c.push(s(h));return p}}const{message:i}=a;return o([u,{name:l,message:i}],a)};return s},T5=(n,{json:e,lossy:t}={})=>{const r=[];return yN(!(e||t),!!e,new Map,r)(n),r},Gp=typeof structuredClone=="function"?(n,e)=>e&&("json"in e||"lossy"in e)?N5(T5(n,e)):structuredClone(n):(n,e)=>N5(T5(n,e));function vN(n,e){const t=[{type:"text",value:""}];return e>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),t}function wN(n,e){return"Back to reference "+(n+1)+(e>1?"-"+e:"")}function xN(n){const e=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",t=n.options.footnoteBackContent||vN,r=n.options.footnoteBackLabel||wN,o=n.options.footnoteLabel||"Footnotes",s=n.options.footnoteLabelTagName||"h2",a=n.options.footnoteLabelProperties||{className:["sr-only"]},u=[];let l=-1;for(;++l<n.footnoteOrder.length;){const i=n.footnoteById.get(n.footnoteOrder[l]);if(!i)continue;const c=n.all(i),p=String(i.identifier).toUpperCase(),h=Mf(p.toLowerCase());let f=0;const g=[],y=n.footnoteCounts.get(p);for(;y!==void 0&&++f<=y;){g.length>0&&g.push({type:"text",value:" "});let w=typeof t=="string"?t:t(l,f);typeof w=="string"&&(w={type:"text",value:w}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+h+(f>1?"-"+f:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(l,f),className:["data-footnote-backref"]},children:Array.isArray(w)?w:[w]})}const b=c[c.length-1];if(b&&b.type==="element"&&b.tagName==="p"){const w=b.children[b.children.length-1];w&&w.type==="text"?w.value+=" ":b.children.push({type:"text",value:" "}),b.children.push(...g)}else c.push(...g);const v={type:"element",tagName:"li",properties:{id:e+"fn-"+h},children:n.wrap(c,!0)};n.patch(i,v),u.push(v)}if(u.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Gp(a),id:"footnote-label"},children:[{type:"text",value:o}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:n.wrap(u,!0)},{type:"text",value:`
`}]}}const m0=(function(n){if(n==null)return AN;if(typeof n=="function")return g0(n);if(typeof n=="object")return Array.isArray(n)?SN(n):_N(n);if(typeof n=="string")return kN(n);throw new Error("Expected function, string, or object as test")});function SN(n){const e=[];let t=-1;for(;++t<n.length;)e[t]=m0(n[t]);return g0(r);function r(...o){let s=-1;for(;++s<e.length;)if(e[s].apply(this,o))return!0;return!1}}function _N(n){const e=n;return g0(t);function t(r){const o=r;let s;for(s in n)if(o[s]!==e[s])return!1;return!0}}function kN(n){return g0(e);function e(t){return t&&t.type===n}}function g0(n){return e;function e(t,r,o){return!!(CN(t)&&n.call(this,t,typeof r=="number"?r:void 0,o||void 0))}}function AN(){return!0}function CN(n){return n!==null&&typeof n=="object"&&"type"in n}const H4=[],EN=!0,Tg=!1,NN="skip";function $4(n,e,t,r){let o;typeof e=="function"&&typeof t!="function"?(r=t,t=e):o=e;const s=m0(o),a=r?-1:1;u(n,void 0,[])();function u(l,i,c){const p=l&&typeof l=="object"?l:{};if(typeof p.type=="string"){const f=typeof p.tagName=="string"?p.tagName:typeof p.name=="string"?p.name:void 0;Object.defineProperty(h,"name",{value:"node ("+(l.type+(f?"<"+f+">":""))+")"})}return h;function h(){let f=H4,g,y,b;if((!e||s(l,i,c[c.length-1]||void 0))&&(f=TN(t(l,c)),f[0]===Tg))return f;if("children"in l&&l.children){const v=l;if(v.children&&f[0]!==NN)for(y=(r?v.children.length:-1)+a,b=c.concat(v);y>-1&&y<v.children.length;){const w=v.children[y];if(g=u(w,y,b)(),g[0]===Tg)return g;y=typeof g[1]=="number"?g[1]:y+a}}return f}}}function TN(n){return Array.isArray(n)?n:typeof n=="number"?[EN,n]:n==null?H4:[n]}function Mb(n,e,t,r){let o,s,a;typeof e=="function"&&typeof t!="function"?(s=void 0,a=e,o=t):(s=e,a=t,o=r),$4(n,s,u,o);function u(l,i){const c=i[i.length-1],p=c?c.children.indexOf(l):void 0;return a(l,p,c)}}const jg={}.hasOwnProperty,jN={};function MN(n,e){const t=e||jN,r=new Map,o=new Map,s=new Map,a={...pN,...t.handlers},u={all:i,applyData:ON,definitionById:r,footnoteById:o,footnoteCounts:s,footnoteOrder:[],handlers:a,one:l,options:t,patch:LN,wrap:IN};return Mb(n,function(c){if(c.type==="definition"||c.type==="footnoteDefinition"){const p=c.type==="definition"?r:o,h=String(c.identifier).toUpperCase();p.has(h)||p.set(h,c)}}),u;function l(c,p){const h=c.type,f=u.handlers[h];if(jg.call(u.handlers,h)&&f)return f(u,c,p);if(u.options.passThrough&&u.options.passThrough.includes(h)){if("children"in c){const{children:y,...b}=c,v=Gp(b);return v.children=u.all(c),v}return Gp(c)}return(u.options.unknownHandler||RN)(u,c,p)}function i(c){const p=[];if("children"in c){const h=c.children;let f=-1;for(;++f<h.length;){const g=u.one(h[f],c);if(g){if(f&&h[f-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=j5(g.value)),!Array.isArray(g)&&g.type==="element")){const y=g.children[0];y&&y.type==="text"&&(y.value=j5(y.value))}Array.isArray(g)?p.push(...g):p.push(g)}}}return p}}function LN(n,e){n.position&&(e.position=wA(n))}function ON(n,e){let t=e;if(n&&n.data){const r=n.data.hName,o=n.data.hChildren,s=n.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const a="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:a}}t.type==="element"&&s&&Object.assign(t.properties,Gp(s)),"children"in t&&t.children&&o!==null&&o!==void 0&&(t.children=o)}return t}function RN(n,e){const t=e.data||{},r="value"in e&&!(jg.call(t,"hProperties")||jg.call(t,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function IN(n,e){const t=[];let r=-1;for(e&&t.push({type:"text",value:`
`});++r<n.length;)r&&t.push({type:"text",value:`
`}),t.push(n[r]);return e&&n.length>0&&t.push({type:"text",value:`
`}),t}function j5(n){let e=0,t=n.charCodeAt(e);for(;t===9||t===32;)e++,t=n.charCodeAt(e);return n.slice(e)}function M5(n,e){const t=MN(n,e),r=t.one(n,void 0),o=xN(t),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return o&&s.children.push({type:"text",value:`
`},o),s}function DN(n,e){return n&&"run"in n?async function(t,r){const o=M5(t,{file:r,...e});await n.run(o,r)}:function(t,r){return M5(t,{file:r,...n||e})}}function L5(n){if(n)throw n}var a1,O5;function BN(){if(O5)return a1;O5=1;var n=Object.prototype.hasOwnProperty,e=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,o=function(i){return typeof Array.isArray=="function"?Array.isArray(i):e.call(i)==="[object Array]"},s=function(i){if(!i||e.call(i)!=="[object Object]")return!1;var c=n.call(i,"constructor"),p=i.constructor&&i.constructor.prototype&&n.call(i.constructor.prototype,"isPrototypeOf");if(i.constructor&&!c&&!p)return!1;var h;for(h in i);return typeof h>"u"||n.call(i,h)},a=function(i,c){t&&c.name==="__proto__"?t(i,c.name,{enumerable:!0,configurable:!0,value:c.newValue,writable:!0}):i[c.name]=c.newValue},u=function(i,c){if(c==="__proto__")if(n.call(i,c)){if(r)return r(i,c).value}else return;return i[c]};return a1=function l(){var i,c,p,h,f,g,y=arguments[0],b=1,v=arguments.length,w=!1;for(typeof y=="boolean"&&(w=y,y=arguments[1]||{},b=2),(y==null||typeof y!="object"&&typeof y!="function")&&(y={});b<v;++b)if(i=arguments[b],i!=null)for(c in i)p=u(y,c),h=u(i,c),y!==h&&(w&&h&&(s(h)||(f=o(h)))?(f?(f=!1,g=p&&o(p)?p:[]):g=p&&s(p)?p:{},a(y,{name:c,newValue:l(w,g,h)})):typeof h<"u"&&a(y,{name:c,newValue:h}));return y},a1}var PN=BN();const o1=Eu(PN);function Mg(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function FN(){const n=[],e={run:t,use:r};return e;function t(...o){let s=-1;const a=o.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);u(null,...o);function u(l,...i){const c=n[++s];let p=-1;if(l){a(l);return}for(;++p<o.length;)(i[p]===null||i[p]===void 0)&&(i[p]=o[p]);o=i,c?zN(c,u)(...i):a(null,...i)}}function r(o){if(typeof o!="function")throw new TypeError("Expected `middelware` to be a function, not "+o);return n.push(o),e}}function zN(n,e){let t;return r;function r(...a){const u=n.length>a.length;let l;u&&a.push(o);try{l=n.apply(this,a)}catch(i){const c=i;if(u&&t)throw c;return o(c)}u||(l&&l.then&&typeof l.then=="function"?l.then(s,o):l instanceof Error?o(l):s(l))}function o(a,...u){t||(t=!0,e(a,...u))}function s(a){o(null,a)}}const Yo={basename:qN,dirname:UN,extname:HN,join:$N,sep:"/"};function qN(n,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');sd(n);let t=0,r=-1,o=n.length,s;if(e===void 0||e.length===0||e.length>n.length){for(;o--;)if(n.codePointAt(o)===47){if(s){t=o+1;break}}else r<0&&(s=!0,r=o+1);return r<0?"":n.slice(t,r)}if(e===n)return"";let a=-1,u=e.length-1;for(;o--;)if(n.codePointAt(o)===47){if(s){t=o+1;break}}else a<0&&(s=!0,a=o+1),u>-1&&(n.codePointAt(o)===e.codePointAt(u--)?u<0&&(r=o):(u=-1,r=a));return t===r?r=a:r<0&&(r=n.length),n.slice(t,r)}function UN(n){if(sd(n),n.length===0)return".";let e=-1,t=n.length,r;for(;--t;)if(n.codePointAt(t)===47){if(r){e=t;break}}else r||(r=!0);return e<0?n.codePointAt(0)===47?"/":".":e===1&&n.codePointAt(0)===47?"//":n.slice(0,e)}function HN(n){sd(n);let e=n.length,t=-1,r=0,o=-1,s=0,a;for(;e--;){const u=n.codePointAt(e);if(u===47){if(a){r=e+1;break}continue}t<0&&(a=!0,t=e+1),u===46?o<0?o=e:s!==1&&(s=1):o>-1&&(s=-1)}return o<0||t<0||s===0||s===1&&o===t-1&&o===r+1?"":n.slice(o,t)}function $N(...n){let e=-1,t;for(;++e<n.length;)sd(n[e]),n[e]&&(t=t===void 0?n[e]:t+"/"+n[e]);return t===void 0?".":VN(t)}function VN(n){sd(n);const e=n.codePointAt(0)===47;let t=WN(n,!e);return t.length===0&&!e&&(t="."),t.length>0&&n.codePointAt(n.length-1)===47&&(t+="/"),e?"/"+t:t}function WN(n,e){let t="",r=0,o=-1,s=0,a=-1,u,l;for(;++a<=n.length;){if(a<n.length)u=n.codePointAt(a);else{if(u===47)break;u=47}if(u===47){if(!(o===a-1||s===1))if(o!==a-1&&s===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(l=t.lastIndexOf("/"),l!==t.length-1){l<0?(t="",r=0):(t=t.slice(0,l),r=t.length-1-t.lastIndexOf("/")),o=a,s=0;continue}}else if(t.length>0){t="",r=0,o=a,s=0;continue}}e&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+n.slice(o+1,a):t=n.slice(o+1,a),r=a-o-1;o=a,s=0}else u===46&&s>-1?s++:s=-1}return t}function sd(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}const GN={cwd:YN};function YN(){return"/"}function Lg(n){return!!(n!==null&&typeof n=="object"&&"href"in n&&n.href&&"protocol"in n&&n.protocol&&n.auth===void 0)}function XN(n){if(typeof n=="string")n=new URL(n);else if(!Lg(n)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+n+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(n.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return KN(n)}function KN(n){if(n.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=n.pathname;let t=-1;for(;++t<e.length;)if(e.codePointAt(t)===37&&e.codePointAt(t+1)===50){const r=e.codePointAt(t+2);if(r===70||r===102){const o=new TypeError("File URL path must not include encoded / characters");throw o.code="ERR_INVALID_FILE_URL_PATH",o}}return decodeURIComponent(e)}const l1=["history","path","basename","stem","extname","dirname"];class V4{constructor(e){let t;e?Lg(e)?t={path:e}:typeof e=="string"||ZN(e)?t={value:e}:t=e:t={},this.cwd="cwd"in t?"":GN.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<l1.length;){const s=l1[r];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let o;for(o in t)l1.includes(o)||(this[o]=t[o])}get basename(){return typeof this.path=="string"?Yo.basename(this.path):void 0}set basename(e){c1(e,"basename"),u1(e,"basename"),this.path=Yo.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Yo.dirname(this.path):void 0}set dirname(e){R5(this.basename,"dirname"),this.path=Yo.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Yo.extname(this.path):void 0}set extname(e){if(u1(e,"extname"),R5(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Yo.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){Lg(e)&&(e=XN(e)),c1(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Yo.basename(this.path,this.extname):void 0}set stem(e){c1(e,"stem"),u1(e,"stem"),this.path=Yo.join(this.dirname||"",e+(this.extname||""))}fail(e,t,r){const o=this.message(e,t,r);throw o.fatal=!0,o}info(e,t,r){const o=this.message(e,t,r);return o.fatal=void 0,o}message(e,t,r){const o=new Ps(e,t,r);return this.path&&(o.name=this.path+":"+o.name,o.file=this.path),o.fatal=!1,this.messages.push(o),o}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function u1(n,e){if(n&&n.includes(Yo.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Yo.sep+"`")}function c1(n,e){if(!n)throw new Error("`"+e+"` cannot be empty")}function R5(n,e){if(!n)throw new Error("Setting `"+e+"` requires `path` to be set too")}function ZN(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const QN=(function(n){const r=this.constructor.prototype,o=r[n],s=function(){return o.apply(s,arguments)};return Object.setPrototypeOf(s,r),s}),JN={}.hasOwnProperty;class Lb extends QN{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=FN()}copy(){const e=new Lb;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];e.use(...r)}return e.data(o1(!0,{},this.namespace)),e}data(e,t){return typeof e=="string"?arguments.length===2?(d1("data",this.frozen),this.namespace[e]=t,this):JN.call(this.namespace,e)&&this.namespace[e]||void 0:e?(d1("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const o=t.call(e,...r);typeof o=="function"&&this.transformers.use(o)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=up(e),r=this.parser||this.Parser;return f1("parse",r),r(String(t),t)}process(e,t){const r=this;return this.freeze(),f1("process",this.parser||this.Parser),h1("process",this.compiler||this.Compiler),t?o(void 0,t):new Promise(o);function o(s,a){const u=up(e),l=r.parse(u);r.run(l,u,function(c,p,h){if(c||!p||!h)return i(c);const f=p,g=r.stringify(f,h);nT(g)?h.value=g:h.result=g,i(c,h)});function i(c,p){c||!p?a(c):s?s(p):t(void 0,p)}}}processSync(e){let t=!1,r;return this.freeze(),f1("processSync",this.parser||this.Parser),h1("processSync",this.compiler||this.Compiler),this.process(e,o),D5("processSync","process",t),r;function o(s,a){t=!0,L5(s),r=a}}run(e,t,r){I5(e),this.freeze();const o=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?s(void 0,r):new Promise(s);function s(a,u){const l=up(t);o.run(e,l,i);function i(c,p,h){const f=p||e;c?u(c):a?a(f):r(void 0,f,h)}}}runSync(e,t){let r=!1,o;return this.run(e,t,s),D5("runSync","run",r),o;function s(a,u){L5(a),o=u,r=!0}}stringify(e,t){this.freeze();const r=up(t),o=this.compiler||this.Compiler;return h1("stringify",o),I5(e),o(e,r)}use(e,...t){const r=this.attachers,o=this.namespace;if(d1("use",this.frozen),e!=null)if(typeof e=="function")l(e,t);else if(typeof e=="object")Array.isArray(e)?u(e):a(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(i){if(typeof i=="function")l(i,[]);else if(typeof i=="object")if(Array.isArray(i)){const[c,...p]=i;l(c,p)}else a(i);else throw new TypeError("Expected usable value, not `"+i+"`")}function a(i){if(!("plugins"in i)&&!("settings"in i))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");u(i.plugins),i.settings&&(o.settings=o1(!0,o.settings,i.settings))}function u(i){let c=-1;if(i!=null)if(Array.isArray(i))for(;++c<i.length;){const p=i[c];s(p)}else throw new TypeError("Expected a list of plugins, not `"+i+"`")}function l(i,c){let p=-1,h=-1;for(;++p<r.length;)if(r[p][0]===i){h=p;break}if(h===-1)r.push([i,...c]);else if(c.length>0){let[f,...g]=c;const y=r[h][1];Mg(y)&&Mg(f)&&(f=o1(!0,y,f)),r[h]=[i,f,...g]}}}}const tT=new Lb().freeze();function f1(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function h1(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function d1(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function I5(n){if(!Mg(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function D5(n,e,t){if(!t)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function up(n){return eT(n)?n:new V4(n)}function eT(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function nT(n){return typeof n=="string"||rT(n)}function rT(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const iT="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",B5=[],P5={allowDangerousHtml:!0},sT=/^(https?|ircs?|mailto|xmpp)$/i,aT=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function oT(n){const e=lT(n),t=uT(n);return cT(e.runSync(e.parse(t),t),n)}function lT(n){const e=n.rehypePlugins||B5,t=n.remarkPlugins||B5,r=n.remarkRehypeOptions?{...n.remarkRehypeOptions,...P5}:P5;return tT().use(UE).use(t).use(DN,r).use(e)}function uT(n){const e=n.children||"",t=new V4;return typeof e=="string"&&(t.value=e),t}function cT(n,e){const t=e.allowedElements,r=e.allowElement,o=e.components,s=e.disallowedElements,a=e.skipHtml,u=e.unwrapDisallowed,l=e.urlTransform||fT;for(const c of aT)Object.hasOwn(e,c.from)&&(""+c.from+(c.to?"use `"+c.to+"` instead":"remove it")+iT+c.id,void 0);return Mb(n,i),AA(n,{Fragment:W.Fragment,components:o,ignoreInvalidStyle:!0,jsx:W.jsx,jsxs:W.jsxs,passKeys:!0,passNode:!0});function i(c,p,h){if(c.type==="raw"&&h&&typeof p=="number")return a?h.children.splice(p,1):h.children[p]={type:"text",value:c.value},p;if(c.type==="element"){let f;for(f in r1)if(Object.hasOwn(r1,f)&&Object.hasOwn(c.properties,f)){const g=c.properties[f],y=r1[f];(y===null||y.includes(c.tagName))&&(c.properties[f]=l(String(g||""),f,c))}}if(c.type==="element"){let f=t?!t.includes(c.tagName):s?s.includes(c.tagName):!1;if(!f&&r&&typeof p=="number"&&(f=!r(c,p,h)),f&&h&&typeof p=="number")return u&&c.children?h.children.splice(p,1,...c.children):h.children.splice(p,1),p}}}function fT(n){const e=n.indexOf(":"),t=n.indexOf("?"),r=n.indexOf("#"),o=n.indexOf("/");return e===-1||o!==-1&&e>o||t!==-1&&e>t||r!==-1&&e>r||sT.test(n.slice(0,e))?n:""}function F5(n,e){const t=String(n);if(typeof e!="string")throw new TypeError("Expected character");let r=0,o=t.indexOf(e);for(;o!==-1;)r++,o=t.indexOf(e,o+e.length);return r}function hT(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function dT(n,e,t){const o=m0((t||{}).ignore||[]),s=pT(e);let a=-1;for(;++a<s.length;)$4(n,"text",u);function u(i,c){let p=-1,h;for(;++p<c.length;){const f=c[p],g=h?h.children:void 0;if(o(f,g?g.indexOf(f):void 0,h))return;h=f}if(h)return l(i,c)}function l(i,c){const p=c[c.length-1],h=s[a][0],f=s[a][1];let g=0;const b=p.children.indexOf(i);let v=!1,w=[];h.lastIndex=0;let S=h.exec(i.value);for(;S;){const N=S.index,D={index:S.index,input:S.input,stack:[...c,i]};let F=f(...S,D);if(typeof F=="string"&&(F=F.length>0?{type:"text",value:F}:void 0),F===!1?h.lastIndex=N+1:(g!==N&&w.push({type:"text",value:i.value.slice(g,N)}),Array.isArray(F)?w.push(...F):F&&w.push(F),g=N+S[0].length,v=!0),!h.global)break;S=h.exec(i.value)}return v?(g<i.value.length&&w.push({type:"text",value:i.value.slice(g)}),p.children.splice(b,1,...w)):w=[i],b+w.length}}function pT(n){const e=[];if(!Array.isArray(n))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!n[0]||Array.isArray(n[0])?n:[n];let r=-1;for(;++r<t.length;){const o=t[r];e.push([mT(o[0]),gT(o[1])])}return e}function mT(n){return typeof n=="string"?new RegExp(hT(n),"g"):n}function gT(n){return typeof n=="function"?n:function(){return n}}const p1="phrasing",m1=["autolink","link","image","label"];function bT(){return{transforms:[kT],enter:{literalAutolink:vT,literalAutolinkEmail:g1,literalAutolinkHttp:g1,literalAutolinkWww:g1},exit:{literalAutolink:_T,literalAutolinkEmail:ST,literalAutolinkHttp:wT,literalAutolinkWww:xT}}}function yT(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:p1,notInConstruct:m1},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:p1,notInConstruct:m1},{character:":",before:"[ps]",after:"\\/",inConstruct:p1,notInConstruct:m1}]}}function vT(n){this.enter({type:"link",title:null,url:"",children:[]},n)}function g1(n){this.config.enter.autolinkProtocol.call(this,n)}function wT(n){this.config.exit.autolinkProtocol.call(this,n)}function xT(n){this.config.exit.data.call(this,n);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(n)}function ST(n){this.config.exit.autolinkEmail.call(this,n)}function _T(n){this.exit(n)}function kT(n){dT(n,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,AT],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),CT]],{ignore:["link","linkReference"]})}function AT(n,e,t,r,o){let s="";if(!W4(o)||(/^w/i.test(e)&&(t=e+t,e="",s="http://"),!ET(t)))return!1;const a=NT(t+r);if(!a[0])return!1;const u={type:"link",title:null,url:s+e+a[0],children:[{type:"text",value:e+a[0]}]};return a[1]?[u,{type:"text",value:a[1]}]:u}function CT(n,e,t,r){return!W4(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+t,children:[{type:"text",value:e+"@"+t}]}}function ET(n){const e=n.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function NT(n){const e=/[!"&'),.:;<>?\]}]+$/.exec(n);if(!e)return[n,void 0];n=n.slice(0,e.index);let t=e[0],r=t.indexOf(")");const o=F5(n,"(");let s=F5(n,")");for(;r!==-1&&o>s;)n+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),s++;return[n,t]}function W4(n,e){const t=n.input.charCodeAt(n.index-1);return(n.index===0||rc(t)||h0(t))&&(!e||t!==47)}G4.peek=BT;function TT(){this.buffer()}function jT(n){this.enter({type:"footnoteReference",identifier:"",label:""},n)}function MT(){this.buffer()}function LT(n){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},n)}function OT(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=wo(this.sliceSerialize(n)).toLowerCase(),t.label=e}function RT(n){this.exit(n)}function IT(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=wo(this.sliceSerialize(n)).toLowerCase(),t.label=e}function DT(n){this.exit(n)}function BT(){return"["}function G4(n,e,t,r){const o=t.createTracker(r);let s=o.move("[^");const a=t.enter("footnoteReference"),u=t.enter("reference");return s+=o.move(t.safe(t.associationId(n),{after:"]",before:s})),u(),a(),s+=o.move("]"),s}function PT(){return{enter:{gfmFootnoteCallString:TT,gfmFootnoteCall:jT,gfmFootnoteDefinitionLabelString:MT,gfmFootnoteDefinition:LT},exit:{gfmFootnoteCallString:OT,gfmFootnoteCall:RT,gfmFootnoteDefinitionLabelString:IT,gfmFootnoteDefinition:DT}}}function FT(n){let e=!1;return n&&n.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:t,footnoteReference:G4},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,o,s,a){const u=s.createTracker(a);let l=u.move("[^");const i=s.enter("footnoteDefinition"),c=s.enter("label");return l+=u.move(s.safe(s.associationId(r),{before:l,after:"]"})),c(),l+=u.move("]:"),r.children&&r.children.length>0&&(u.shift(4),l+=u.move((e?`
`:" ")+s.indentLines(s.containerFlow(r,u.current()),e?Y4:zT))),i(),l}}function zT(n,e,t){return e===0?n:Y4(n,e,t)}function Y4(n,e,t){return(t?"":"    ")+n}const qT=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];X4.peek=WT;function UT(){return{canContainEols:["delete"],enter:{strikethrough:$T},exit:{strikethrough:VT}}}function HT(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:qT}],handlers:{delete:X4}}}function $T(n){this.enter({type:"delete",children:[]},n)}function VT(n){this.exit(n)}function X4(n,e,t,r){const o=t.createTracker(r),s=t.enter("strikethrough");let a=o.move("~~");return a+=t.containerPhrasing(n,{...o.current(),before:a,after:"~"}),a+=o.move("~~"),s(),a}function WT(){return"~"}function GT(n){return n.length}function YT(n,e){const t=e||{},r=(t.align||[]).concat(),o=t.stringLength||GT,s=[],a=[],u=[],l=[];let i=0,c=-1;for(;++c<n.length;){const y=[],b=[];let v=-1;for(n[c].length>i&&(i=n[c].length);++v<n[c].length;){const w=XT(n[c][v]);if(t.alignDelimiters!==!1){const S=o(w);b[v]=S,(l[v]===void 0||S>l[v])&&(l[v]=S)}y.push(w)}a[c]=y,u[c]=b}let p=-1;if(typeof r=="object"&&"length"in r)for(;++p<i;)s[p]=z5(r[p]);else{const y=z5(r);for(;++p<i;)s[p]=y}p=-1;const h=[],f=[];for(;++p<i;){const y=s[p];let b="",v="";y===99?(b=":",v=":"):y===108?b=":":y===114&&(v=":");let w=t.alignDelimiters===!1?1:Math.max(1,l[p]-b.length-v.length);const S=b+"-".repeat(w)+v;t.alignDelimiters!==!1&&(w=b.length+w+v.length,w>l[p]&&(l[p]=w),f[p]=w),h[p]=S}a.splice(1,0,h),u.splice(1,0,f),c=-1;const g=[];for(;++c<a.length;){const y=a[c],b=u[c];p=-1;const v=[];for(;++p<i;){const w=y[p]||"";let S="",N="";if(t.alignDelimiters!==!1){const D=l[p]-(b[p]||0),F=s[p];F===114?S=" ".repeat(D):F===99?D%2?(S=" ".repeat(D/2+.5),N=" ".repeat(D/2-.5)):(S=" ".repeat(D/2),N=S):N=" ".repeat(D)}t.delimiterStart!==!1&&!p&&v.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&w==="")&&(t.delimiterStart!==!1||p)&&v.push(" "),t.alignDelimiters!==!1&&v.push(S),v.push(w),t.alignDelimiters!==!1&&v.push(N),t.padding!==!1&&v.push(" "),(t.delimiterEnd!==!1||p!==i-1)&&v.push("|")}g.push(t.delimiterEnd===!1?v.join("").replace(/ +$/,""):v.join(""))}return g.join(`
`)}function XT(n){return n==null?"":String(n)}function z5(n){const e=typeof n=="string"?n.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function KT(n,e,t,r){const o=t.enter("blockquote"),s=t.createTracker(r);s.move("> "),s.shift(2);const a=t.indentLines(t.containerFlow(n,s.current()),ZT);return o(),a}function ZT(n,e,t){return">"+(t?"":" ")+n}function QT(n,e){return q5(n,e.inConstruct,!0)&&!q5(n,e.notInConstruct,!1)}function q5(n,e,t){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return t;let r=-1;for(;++r<e.length;)if(n.includes(e[r]))return!0;return!1}function U5(n,e,t,r){let o=-1;for(;++o<t.unsafe.length;)if(t.unsafe[o].character===`
`&&QT(t.stack,t.unsafe[o]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function JT(n,e){const t=String(n);let r=t.indexOf(e),o=r,s=0,a=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===o?++s>a&&(a=s):s=1,o=r+e.length,r=t.indexOf(e,o);return a}function tj(n,e){return!!(e.options.fences===!1&&n.value&&!n.lang&&/[^ \r\n]/.test(n.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(n.value))}function ej(n){const e=n.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function nj(n,e,t,r){const o=ej(t),s=n.value||"",a=o==="`"?"GraveAccent":"Tilde";if(tj(n,t)){const p=t.enter("codeIndented"),h=t.indentLines(s,rj);return p(),h}const u=t.createTracker(r),l=o.repeat(Math.max(JT(s,o)+1,3)),i=t.enter("codeFenced");let c=u.move(l);if(n.lang){const p=t.enter(`codeFencedLang${a}`);c+=u.move(t.safe(n.lang,{before:c,after:" ",encode:["`"],...u.current()})),p()}if(n.lang&&n.meta){const p=t.enter(`codeFencedMeta${a}`);c+=u.move(" "),c+=u.move(t.safe(n.meta,{before:c,after:`
`,encode:["`"],...u.current()})),p()}return c+=u.move(`
`),s&&(c+=u.move(s+`
`)),c+=u.move(l),i(),c}function rj(n,e,t){return(t?"":"    ")+n}function Ob(n){const e=n.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function ij(n,e,t,r){const o=Ob(t),s=o==='"'?"Quote":"Apostrophe",a=t.enter("definition");let u=t.enter("label");const l=t.createTracker(r);let i=l.move("[");return i+=l.move(t.safe(t.associationId(n),{before:i,after:"]",...l.current()})),i+=l.move("]: "),u(),!n.url||/[\0- \u007F]/.test(n.url)?(u=t.enter("destinationLiteral"),i+=l.move("<"),i+=l.move(t.safe(n.url,{before:i,after:">",...l.current()})),i+=l.move(">")):(u=t.enter("destinationRaw"),i+=l.move(t.safe(n.url,{before:i,after:n.title?" ":`
`,...l.current()}))),u(),n.title&&(u=t.enter(`title${s}`),i+=l.move(" "+o),i+=l.move(t.safe(n.title,{before:i,after:o,...l.current()})),i+=l.move(o),u()),a(),i}function sj(n){const e=n.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function Vh(n){return"&#x"+n.toString(16).toUpperCase()+";"}function Yp(n,e,t){const r=Ef(n),o=Ef(e);return r===void 0?o===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:o===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?o===void 0?{inside:!1,outside:!1}:o===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:o===void 0?{inside:!1,outside:!1}:o===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}K4.peek=aj;function K4(n,e,t,r){const o=sj(t),s=t.enter("emphasis"),a=t.createTracker(r),u=a.move(o);let l=a.move(t.containerPhrasing(n,{after:o,before:u,...a.current()}));const i=l.charCodeAt(0),c=Yp(r.before.charCodeAt(r.before.length-1),i,o);c.inside&&(l=Vh(i)+l.slice(1));const p=l.charCodeAt(l.length-1),h=Yp(r.after.charCodeAt(0),p,o);h.inside&&(l=l.slice(0,-1)+Vh(p));const f=a.move(o);return s(),t.attentionEncodeSurroundingInfo={after:h.outside,before:c.outside},u+l+f}function aj(n,e,t){return t.options.emphasis||"*"}function oj(n,e){let t=!1;return Mb(n,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,Tg}),!!((!n.depth||n.depth<3)&&kb(n)&&(e.options.setext||t))}function lj(n,e,t,r){const o=Math.max(Math.min(6,n.depth||1),1),s=t.createTracker(r);if(oj(n,t)){const c=t.enter("headingSetext"),p=t.enter("phrasing"),h=t.containerPhrasing(n,{...s.current(),before:`
`,after:`
`});return p(),c(),h+`
`+(o===1?"=":"-").repeat(h.length-(Math.max(h.lastIndexOf("\r"),h.lastIndexOf(`
`))+1))}const a="#".repeat(o),u=t.enter("headingAtx"),l=t.enter("phrasing");s.move(a+" ");let i=t.containerPhrasing(n,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(i)&&(i=Vh(i.charCodeAt(0))+i.slice(1)),i=i?a+" "+i:a,t.options.closeAtx&&(i+=" "+a),l(),u(),i}Z4.peek=uj;function Z4(n){return n.value||""}function uj(){return"<"}Q4.peek=cj;function Q4(n,e,t,r){const o=Ob(t),s=o==='"'?"Quote":"Apostrophe",a=t.enter("image");let u=t.enter("label");const l=t.createTracker(r);let i=l.move("![");return i+=l.move(t.safe(n.alt,{before:i,after:"]",...l.current()})),i+=l.move("]("),u(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(u=t.enter("destinationLiteral"),i+=l.move("<"),i+=l.move(t.safe(n.url,{before:i,after:">",...l.current()})),i+=l.move(">")):(u=t.enter("destinationRaw"),i+=l.move(t.safe(n.url,{before:i,after:n.title?" ":")",...l.current()}))),u(),n.title&&(u=t.enter(`title${s}`),i+=l.move(" "+o),i+=l.move(t.safe(n.title,{before:i,after:o,...l.current()})),i+=l.move(o),u()),i+=l.move(")"),a(),i}function cj(){return"!"}J4.peek=fj;function J4(n,e,t,r){const o=n.referenceType,s=t.enter("imageReference");let a=t.enter("label");const u=t.createTracker(r);let l=u.move("![");const i=t.safe(n.alt,{before:l,after:"]",...u.current()});l+=u.move(i+"]["),a();const c=t.stack;t.stack=[],a=t.enter("reference");const p=t.safe(t.associationId(n),{before:l,after:"]",...u.current()});return a(),t.stack=c,s(),o==="full"||!i||i!==p?l+=u.move(p+"]"):o==="shortcut"?l=l.slice(0,-1):l+=u.move("]"),l}function fj(){return"!"}t6.peek=hj;function t6(n,e,t){let r=n.value||"",o="`",s=-1;for(;new RegExp("(^|[^`])"+o+"([^`]|$)").test(r);)o+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<t.unsafe.length;){const a=t.unsafe[s],u=t.compilePattern(a);let l;if(a.atBreak)for(;l=u.exec(r);){let i=l.index;r.charCodeAt(i)===10&&r.charCodeAt(i-1)===13&&i--,r=r.slice(0,i)+" "+r.slice(l.index+1)}}return o+r+o}function hj(){return"`"}function e6(n,e){const t=kb(n);return!!(!e.options.resourceLink&&n.url&&!n.title&&n.children&&n.children.length===1&&n.children[0].type==="text"&&(t===n.url||"mailto:"+t===n.url)&&/^[a-z][a-z+.-]+:/i.test(n.url)&&!/[\0- <>\u007F]/.test(n.url))}n6.peek=dj;function n6(n,e,t,r){const o=Ob(t),s=o==='"'?"Quote":"Apostrophe",a=t.createTracker(r);let u,l;if(e6(n,t)){const c=t.stack;t.stack=[],u=t.enter("autolink");let p=a.move("<");return p+=a.move(t.containerPhrasing(n,{before:p,after:">",...a.current()})),p+=a.move(">"),u(),t.stack=c,p}u=t.enter("link"),l=t.enter("label");let i=a.move("[");return i+=a.move(t.containerPhrasing(n,{before:i,after:"](",...a.current()})),i+=a.move("]("),l(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(l=t.enter("destinationLiteral"),i+=a.move("<"),i+=a.move(t.safe(n.url,{before:i,after:">",...a.current()})),i+=a.move(">")):(l=t.enter("destinationRaw"),i+=a.move(t.safe(n.url,{before:i,after:n.title?" ":")",...a.current()}))),l(),n.title&&(l=t.enter(`title${s}`),i+=a.move(" "+o),i+=a.move(t.safe(n.title,{before:i,after:o,...a.current()})),i+=a.move(o),l()),i+=a.move(")"),u(),i}function dj(n,e,t){return e6(n,t)?"<":"["}r6.peek=pj;function r6(n,e,t,r){const o=n.referenceType,s=t.enter("linkReference");let a=t.enter("label");const u=t.createTracker(r);let l=u.move("[");const i=t.containerPhrasing(n,{before:l,after:"]",...u.current()});l+=u.move(i+"]["),a();const c=t.stack;t.stack=[],a=t.enter("reference");const p=t.safe(t.associationId(n),{before:l,after:"]",...u.current()});return a(),t.stack=c,s(),o==="full"||!i||i!==p?l+=u.move(p+"]"):o==="shortcut"?l=l.slice(0,-1):l+=u.move("]"),l}function pj(){return"["}function Rb(n){const e=n.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function mj(n){const e=Rb(n),t=n.options.bulletOther;if(!t)return e==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+t+"`) to be different");return t}function gj(n){const e=n.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function i6(n){const e=n.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function bj(n,e,t,r){const o=t.enter("list"),s=t.bulletCurrent;let a=n.ordered?gj(t):Rb(t);const u=n.ordered?a==="."?")":".":mj(t);let l=e&&t.bulletLastUsed?a===t.bulletLastUsed:!1;if(!n.ordered){const c=n.children?n.children[0]:void 0;if((a==="*"||a==="-")&&c&&(!c.children||!c.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(l=!0),i6(t)===a&&c){let p=-1;for(;++p<n.children.length;){const h=n.children[p];if(h&&h.type==="listItem"&&h.children&&h.children[0]&&h.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=u),t.bulletCurrent=a;const i=t.containerFlow(n,r);return t.bulletLastUsed=a,t.bulletCurrent=s,o(),i}function yj(n){const e=n.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function vj(n,e,t,r){const o=yj(t);let s=t.bulletCurrent||Rb(t);e&&e.type==="list"&&e.ordered&&(s=(typeof e.start=="number"&&e.start>-1?e.start:1)+(t.options.incrementListMarker===!1?0:e.children.indexOf(n))+s);let a=s.length+1;(o==="tab"||o==="mixed"&&(e&&e.type==="list"&&e.spread||n.spread))&&(a=Math.ceil(a/4)*4);const u=t.createTracker(r);u.move(s+" ".repeat(a-s.length)),u.shift(a);const l=t.enter("listItem"),i=t.indentLines(t.containerFlow(n,u.current()),c);return l(),i;function c(p,h,f){return h?(f?"":" ".repeat(a))+p:(f?s:s+" ".repeat(a-s.length))+p}}function wj(n,e,t,r){const o=t.enter("paragraph"),s=t.enter("phrasing"),a=t.containerPhrasing(n,r);return s(),o(),a}const xj=m0(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Sj(n,e,t,r){return(n.children.some(function(a){return xj(a)})?t.containerPhrasing:t.containerFlow).call(t,n,r)}function _j(n){const e=n.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}s6.peek=kj;function s6(n,e,t,r){const o=_j(t),s=t.enter("strong"),a=t.createTracker(r),u=a.move(o+o);let l=a.move(t.containerPhrasing(n,{after:o,before:u,...a.current()}));const i=l.charCodeAt(0),c=Yp(r.before.charCodeAt(r.before.length-1),i,o);c.inside&&(l=Vh(i)+l.slice(1));const p=l.charCodeAt(l.length-1),h=Yp(r.after.charCodeAt(0),p,o);h.inside&&(l=l.slice(0,-1)+Vh(p));const f=a.move(o+o);return s(),t.attentionEncodeSurroundingInfo={after:h.outside,before:c.outside},u+l+f}function kj(n,e,t){return t.options.strong||"*"}function Aj(n,e,t,r){return t.safe(n.value,r)}function Cj(n){const e=n.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function Ej(n,e,t){const r=(i6(t)+(t.options.ruleSpaces?" ":"")).repeat(Cj(t));return t.options.ruleSpaces?r.slice(0,-1):r}const a6={blockquote:KT,break:U5,code:nj,definition:ij,emphasis:K4,hardBreak:U5,heading:lj,html:Z4,image:Q4,imageReference:J4,inlineCode:t6,link:n6,linkReference:r6,list:bj,listItem:vj,paragraph:wj,root:Sj,strong:s6,text:Aj,thematicBreak:Ej};function Nj(){return{enter:{table:Tj,tableData:H5,tableHeader:H5,tableRow:Mj},exit:{codeText:Lj,table:jj,tableData:b1,tableHeader:b1,tableRow:b1}}}function Tj(n){const e=n._align;this.enter({type:"table",align:e.map(function(t){return t==="none"?null:t}),children:[]},n),this.data.inTable=!0}function jj(n){this.exit(n),this.data.inTable=void 0}function Mj(n){this.enter({type:"tableRow",children:[]},n)}function b1(n){this.exit(n)}function H5(n){this.enter({type:"tableCell",children:[]},n)}function Lj(n){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,Oj));const t=this.stack[this.stack.length-1];t.type,t.value=e,this.exit(n)}function Oj(n,e){return e==="|"?e:n}function Rj(n){const e=n||{},t=e.tableCellPadding,r=e.tablePipeAlign,o=e.stringLength,s=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:h,table:a,tableCell:l,tableRow:u}};function a(f,g,y,b){return i(c(f,y,b),f.align)}function u(f,g,y,b){const v=p(f,y,b),w=i([v]);return w.slice(0,w.indexOf(`
`))}function l(f,g,y,b){const v=y.enter("tableCell"),w=y.enter("phrasing"),S=y.containerPhrasing(f,{...b,before:s,after:s});return w(),v(),S}function i(f,g){return YT(f,{align:g,alignDelimiters:r,padding:t,stringLength:o})}function c(f,g,y){const b=f.children;let v=-1;const w=[],S=g.enter("table");for(;++v<b.length;)w[v]=p(b[v],g,y);return S(),w}function p(f,g,y){const b=f.children;let v=-1;const w=[],S=g.enter("tableRow");for(;++v<b.length;)w[v]=l(b[v],f,g,y);return S(),w}function h(f,g,y){let b=a6.inlineCode(f,g,y);return y.stack.includes("tableCell")&&(b=b.replace(/\|/g,"\\$&")),b}}function Ij(){return{exit:{taskListCheckValueChecked:$5,taskListCheckValueUnchecked:$5,paragraph:Bj}}}function Dj(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Pj}}}function $5(n){const e=this.stack[this.stack.length-2];e.type,e.checked=n.type==="taskListCheckValueChecked"}function Bj(n){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const o=e.children;let s=-1,a;for(;++s<o.length;){const u=o[s];if(u.type==="paragraph"){a=u;break}}a===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(n)}function Pj(n,e,t,r){const o=n.children[0],s=typeof n.checked=="boolean"&&o&&o.type==="paragraph",a="["+(n.checked?"x":" ")+"] ",u=t.createTracker(r);s&&u.move(a);let l=a6.listItem(n,e,t,{...r,...u.current()});return s&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,i)),l;function i(c){return c+a}}function Fj(){return[bT(),PT(),UT(),Nj(),Ij()]}function zj(n){return{extensions:[yT(),FT(n),HT(),Rj(n),Dj()]}}const qj={tokenize:Gj,partial:!0},o6={tokenize:Yj,partial:!0},l6={tokenize:Xj,partial:!0},u6={tokenize:Kj,partial:!0},Uj={tokenize:Zj,partial:!0},c6={name:"wwwAutolink",tokenize:Vj,previous:h6},f6={name:"protocolAutolink",tokenize:Wj,previous:d6},Bl={name:"emailAutolink",tokenize:$j,previous:p6},tl={};function Hj(){return{text:tl}}let Xu=48;for(;Xu<123;)tl[Xu]=Bl,Xu++,Xu===58?Xu=65:Xu===91&&(Xu=97);tl[43]=Bl;tl[45]=Bl;tl[46]=Bl;tl[95]=Bl;tl[72]=[Bl,f6];tl[104]=[Bl,f6];tl[87]=[Bl,c6];tl[119]=[Bl,c6];function $j(n,e,t){const r=this;let o,s;return a;function a(p){return!Og(p)||!p6.call(r,r.previous)||Ib(r.events)?t(p):(n.enter("literalAutolink"),n.enter("literalAutolinkEmail"),u(p))}function u(p){return Og(p)?(n.consume(p),u):p===64?(n.consume(p),l):t(p)}function l(p){return p===46?n.check(Uj,c,i)(p):p===45||p===95||Bs(p)?(s=!0,n.consume(p),l):c(p)}function i(p){return n.consume(p),o=!0,l}function c(p){return s&&o&&Ws(r.previous)?(n.exit("literalAutolinkEmail"),n.exit("literalAutolink"),e(p)):t(p)}}function Vj(n,e,t){const r=this;return o;function o(a){return a!==87&&a!==119||!h6.call(r,r.previous)||Ib(r.events)?t(a):(n.enter("literalAutolink"),n.enter("literalAutolinkWww"),n.check(qj,n.attempt(o6,n.attempt(l6,s),t),t)(a))}function s(a){return n.exit("literalAutolinkWww"),n.exit("literalAutolink"),e(a)}}function Wj(n,e,t){const r=this;let o="",s=!1;return a;function a(p){return(p===72||p===104)&&d6.call(r,r.previous)&&!Ib(r.events)?(n.enter("literalAutolink"),n.enter("literalAutolinkHttp"),o+=String.fromCodePoint(p),n.consume(p),u):t(p)}function u(p){if(Ws(p)&&o.length<5)return o+=String.fromCodePoint(p),n.consume(p),u;if(p===58){const h=o.toLowerCase();if(h==="http"||h==="https")return n.consume(p),l}return t(p)}function l(p){return p===47?(n.consume(p),s?i:(s=!0,l)):t(p)}function i(p){return p===null||Vp(p)||ui(p)||rc(p)||h0(p)?t(p):n.attempt(o6,n.attempt(l6,c),t)(p)}function c(p){return n.exit("literalAutolinkHttp"),n.exit("literalAutolink"),e(p)}}function Gj(n,e,t){let r=0;return o;function o(a){return(a===87||a===119)&&r<3?(r++,n.consume(a),o):a===46&&r===3?(n.consume(a),s):t(a)}function s(a){return a===null?t(a):e(a)}}function Yj(n,e,t){let r,o,s;return a;function a(i){return i===46||i===95?n.check(u6,l,u)(i):i===null||ui(i)||rc(i)||i!==45&&h0(i)?l(i):(s=!0,n.consume(i),a)}function u(i){return i===95?r=!0:(o=r,r=void 0),n.consume(i),a}function l(i){return o||r||!s?t(i):e(i)}}function Xj(n,e){let t=0,r=0;return o;function o(a){return a===40?(t++,n.consume(a),o):a===41&&r<t?s(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?n.check(u6,e,s)(a):a===null||ui(a)||rc(a)?e(a):(n.consume(a),o)}function s(a){return a===41&&r++,n.consume(a),o}}function Kj(n,e,t){return r;function r(u){return u===33||u===34||u===39||u===41||u===42||u===44||u===46||u===58||u===59||u===63||u===95||u===126?(n.consume(u),r):u===38?(n.consume(u),s):u===93?(n.consume(u),o):u===60||u===null||ui(u)||rc(u)?e(u):t(u)}function o(u){return u===null||u===40||u===91||ui(u)||rc(u)?e(u):r(u)}function s(u){return Ws(u)?a(u):t(u)}function a(u){return u===59?(n.consume(u),r):Ws(u)?(n.consume(u),a):t(u)}}function Zj(n,e,t){return r;function r(s){return n.consume(s),o}function o(s){return Bs(s)?t(s):e(s)}}function h6(n){return n===null||n===40||n===42||n===95||n===91||n===93||n===126||ui(n)}function d6(n){return!Ws(n)}function p6(n){return!(n===47||Og(n))}function Og(n){return n===43||n===45||n===46||n===95||Bs(n)}function Ib(n){let e=n.length,t=!1;for(;e--;){const r=n[e][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return n.length>0&&!t&&(n[n.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const Qj={tokenize:aM,partial:!0};function Jj(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:rM,continuation:{tokenize:iM},exit:sM}},text:{91:{name:"gfmFootnoteCall",tokenize:nM},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:tM,resolveTo:eM}}}}function tM(n,e,t){const r=this;let o=r.events.length;const s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a;for(;o--;){const l=r.events[o][1];if(l.type==="labelImage"){a=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return u;function u(l){if(!a||!a._balanced)return t(l);const i=wo(r.sliceSerialize({start:a.end,end:r.now()}));return i.codePointAt(0)!==94||!s.includes(i.slice(1))?t(l):(n.enter("gfmFootnoteCallLabelMarker"),n.consume(l),n.exit("gfmFootnoteCallLabelMarker"),e(l))}}function eM(n,e){let t=n.length;for(;t--;)if(n[t][1].type==="labelImage"&&n[t][0]==="enter"){n[t][1];break}n[t+1][1].type="data",n[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},n[t+3][1].start),end:Object.assign({},n[n.length-1][1].end)},o={type:"gfmFootnoteCallMarker",start:Object.assign({},n[t+3][1].end),end:Object.assign({},n[t+3][1].end)};o.end.column++,o.end.offset++,o.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},o.end),end:Object.assign({},n[n.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},u=[n[t+1],n[t+2],["enter",r,e],n[t+3],n[t+4],["enter",o,e],["exit",o,e],["enter",s,e],["enter",a,e],["exit",a,e],["exit",s,e],n[n.length-2],n[n.length-1],["exit",r,e]];return n.splice(t,n.length-t+1,...u),n}function nM(n,e,t){const r=this,o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s=0,a;return u;function u(p){return n.enter("gfmFootnoteCall"),n.enter("gfmFootnoteCallLabelMarker"),n.consume(p),n.exit("gfmFootnoteCallLabelMarker"),l}function l(p){return p!==94?t(p):(n.enter("gfmFootnoteCallMarker"),n.consume(p),n.exit("gfmFootnoteCallMarker"),n.enter("gfmFootnoteCallString"),n.enter("chunkString").contentType="string",i)}function i(p){if(s>999||p===93&&!a||p===null||p===91||ui(p))return t(p);if(p===93){n.exit("chunkString");const h=n.exit("gfmFootnoteCallString");return o.includes(wo(r.sliceSerialize(h)))?(n.enter("gfmFootnoteCallLabelMarker"),n.consume(p),n.exit("gfmFootnoteCallLabelMarker"),n.exit("gfmFootnoteCall"),e):t(p)}return ui(p)||(a=!0),s++,n.consume(p),p===92?c:i}function c(p){return p===91||p===92||p===93?(n.consume(p),s++,i):i(p)}}function rM(n,e,t){const r=this,o=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s,a=0,u;return l;function l(g){return n.enter("gfmFootnoteDefinition")._container=!0,n.enter("gfmFootnoteDefinitionLabel"),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(g),n.exit("gfmFootnoteDefinitionLabelMarker"),i}function i(g){return g===94?(n.enter("gfmFootnoteDefinitionMarker"),n.consume(g),n.exit("gfmFootnoteDefinitionMarker"),n.enter("gfmFootnoteDefinitionLabelString"),n.enter("chunkString").contentType="string",c):t(g)}function c(g){if(a>999||g===93&&!u||g===null||g===91||ui(g))return t(g);if(g===93){n.exit("chunkString");const y=n.exit("gfmFootnoteDefinitionLabelString");return s=wo(r.sliceSerialize(y)),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(g),n.exit("gfmFootnoteDefinitionLabelMarker"),n.exit("gfmFootnoteDefinitionLabel"),h}return ui(g)||(u=!0),a++,n.consume(g),g===92?p:c}function p(g){return g===91||g===92||g===93?(n.consume(g),a++,c):c(g)}function h(g){return g===58?(n.enter("definitionMarker"),n.consume(g),n.exit("definitionMarker"),o.includes(s)||o.push(s),Cr(n,f,"gfmFootnoteDefinitionWhitespace")):t(g)}function f(g){return e(g)}}function iM(n,e,t){return n.check(id,e,n.attempt(Qj,e,t))}function sM(n){n.exit("gfmFootnoteDefinition")}function aM(n,e,t){const r=this;return Cr(n,o,"gfmFootnoteDefinitionIndent",5);function o(s){const a=r.events[r.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?e(s):t(s)}}function oM(n){let t=(n||{}).singleTilde;const r={name:"strikethrough",tokenize:s,resolveAll:o};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function o(a,u){let l=-1;for(;++l<a.length;)if(a[l][0]==="enter"&&a[l][1].type==="strikethroughSequenceTemporary"&&a[l][1]._close){let i=l;for(;i--;)if(a[i][0]==="exit"&&a[i][1].type==="strikethroughSequenceTemporary"&&a[i][1]._open&&a[l][1].end.offset-a[l][1].start.offset===a[i][1].end.offset-a[i][1].start.offset){a[l][1].type="strikethroughSequence",a[i][1].type="strikethroughSequence";const c={type:"strikethrough",start:Object.assign({},a[i][1].start),end:Object.assign({},a[l][1].end)},p={type:"strikethroughText",start:Object.assign({},a[i][1].end),end:Object.assign({},a[l][1].start)},h=[["enter",c,u],["enter",a[i][1],u],["exit",a[i][1],u],["enter",p,u]],f=u.parser.constructs.insideSpan.null;f&&Ea(h,h.length,0,d0(f,a.slice(i+1,l),u)),Ea(h,h.length,0,[["exit",p,u],["enter",a[l][1],u],["exit",a[l][1],u],["exit",c,u]]),Ea(a,i-1,l-i+3,h),l=i+h.length-2;break}}for(l=-1;++l<a.length;)a[l][1].type==="strikethroughSequenceTemporary"&&(a[l][1].type="data");return a}function s(a,u,l){const i=this.previous,c=this.events;let p=0;return h;function h(g){return i===126&&c[c.length-1][1].type!=="characterEscape"?l(g):(a.enter("strikethroughSequenceTemporary"),f(g))}function f(g){const y=Ef(i);if(g===126)return p>1?l(g):(a.consume(g),p++,f);if(p<2&&!t)return l(g);const b=a.exit("strikethroughSequenceTemporary"),v=Ef(g);return b._open=!v||v===2&&!!y,b._close=!y||y===2&&!!v,u(g)}}}class lM{constructor(){this.map=[]}add(e,t,r){uM(this,e,t,r)}consume(e){if(this.map.sort(function(s,a){return s[0]-a[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(e.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),e.length=this.map[t][0];r.push(e.slice()),e.length=0;let o=r.pop();for(;o;){for(const s of o)e.push(s);o=r.pop()}this.map.length=0}}function uM(n,e,t,r){let o=0;if(!(t===0&&r.length===0)){for(;o<n.map.length;){if(n.map[o][0]===e){n.map[o][1]+=t,n.map[o][2].push(...r);return}o+=1}n.map.push([e,t,r])}}function cM(n,e){let t=!1;const r=[];for(;e<n.length;){const o=n[e];if(t){if(o[0]==="enter")o[1].type==="tableContent"&&r.push(n[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(o[1].type==="tableContent"){if(n[e-1][1].type==="tableDelimiterMarker"){const s=r.length-1;r[s]=r[s]==="left"?"center":"right"}}else if(o[1].type==="tableDelimiterRow")break}else o[0]==="enter"&&o[1].type==="tableDelimiterRow"&&(t=!0);e+=1}return r}function fM(){return{flow:{null:{name:"table",tokenize:hM,resolveAll:dM}}}}function hM(n,e,t){const r=this;let o=0,s=0,a;return u;function u(q){let R=r.events.length-1;for(;R>-1;){const L=r.events[R][1].type;if(L==="lineEnding"||L==="linePrefix")R--;else break}const I=R>-1?r.events[R][1].type:null,T=I==="tableHead"||I==="tableRow"?F:l;return T===F&&r.parser.lazy[r.now().line]?t(q):T(q)}function l(q){return n.enter("tableHead"),n.enter("tableRow"),i(q)}function i(q){return q===124||(a=!0,s+=1),c(q)}function c(q){return q===null?t(q):On(q)?s>1?(s=0,r.interrupt=!0,n.exit("tableRow"),n.enter("lineEnding"),n.consume(q),n.exit("lineEnding"),f):t(q):pr(q)?Cr(n,c,"whitespace")(q):(s+=1,a&&(a=!1,o+=1),q===124?(n.enter("tableCellDivider"),n.consume(q),n.exit("tableCellDivider"),a=!0,c):(n.enter("data"),p(q)))}function p(q){return q===null||q===124||ui(q)?(n.exit("data"),c(q)):(n.consume(q),q===92?h:p)}function h(q){return q===92||q===124?(n.consume(q),p):p(q)}function f(q){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(q):(n.enter("tableDelimiterRow"),a=!1,pr(q)?Cr(n,g,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(q):g(q))}function g(q){return q===45||q===58?b(q):q===124?(a=!0,n.enter("tableCellDivider"),n.consume(q),n.exit("tableCellDivider"),y):D(q)}function y(q){return pr(q)?Cr(n,b,"whitespace")(q):b(q)}function b(q){return q===58?(s+=1,a=!0,n.enter("tableDelimiterMarker"),n.consume(q),n.exit("tableDelimiterMarker"),v):q===45?(s+=1,v(q)):q===null||On(q)?N(q):D(q)}function v(q){return q===45?(n.enter("tableDelimiterFiller"),w(q)):D(q)}function w(q){return q===45?(n.consume(q),w):q===58?(a=!0,n.exit("tableDelimiterFiller"),n.enter("tableDelimiterMarker"),n.consume(q),n.exit("tableDelimiterMarker"),S):(n.exit("tableDelimiterFiller"),S(q))}function S(q){return pr(q)?Cr(n,N,"whitespace")(q):N(q)}function N(q){return q===124?g(q):q===null||On(q)?!a||o!==s?D(q):(n.exit("tableDelimiterRow"),n.exit("tableHead"),e(q)):D(q)}function D(q){return t(q)}function F(q){return n.enter("tableRow"),G(q)}function G(q){return q===124?(n.enter("tableCellDivider"),n.consume(q),n.exit("tableCellDivider"),G):q===null||On(q)?(n.exit("tableRow"),e(q)):pr(q)?Cr(n,G,"whitespace")(q):(n.enter("data"),P(q))}function P(q){return q===null||q===124||ui(q)?(n.exit("data"),G(q)):(n.consume(q),q===92?U:P)}function U(q){return q===92||q===124?(n.consume(q),P):P(q)}}function dM(n,e){let t=-1,r=!0,o=0,s=[0,0,0,0],a=[0,0,0,0],u=!1,l=0,i,c,p;const h=new lM;for(;++t<n.length;){const f=n[t],g=f[1];f[0]==="enter"?g.type==="tableHead"?(u=!1,l!==0&&(V5(h,e,l,i,c),c=void 0,l=0),i={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},h.add(t,0,[["enter",i,e]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(r=!0,p=void 0,s=[0,0,0,0],a=[0,t+1,0,0],u&&(u=!1,c={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},h.add(t,0,[["enter",c,e]])),o=g.type==="tableDelimiterRow"?2:c?3:1):o&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(r=!1,a[2]===0&&(s[1]!==0&&(a[0]=a[1],p=cp(h,e,s,o,void 0,p),s=[0,0,0,0]),a[2]=t)):g.type==="tableCellDivider"&&(r?r=!1:(s[1]!==0&&(a[0]=a[1],p=cp(h,e,s,o,void 0,p)),s=a,a=[s[1],t,0,0])):g.type==="tableHead"?(u=!0,l=t):g.type==="tableRow"||g.type==="tableDelimiterRow"?(l=t,s[1]!==0?(a[0]=a[1],p=cp(h,e,s,o,t,p)):a[1]!==0&&(p=cp(h,e,a,o,t,p)),o=0):o&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(a[3]=t)}for(l!==0&&V5(h,e,l,i,c),h.consume(e.events),t=-1;++t<e.events.length;){const f=e.events[t];f[0]==="enter"&&f[1].type==="table"&&(f[1]._align=cM(e.events,t))}return n}function cp(n,e,t,r,o,s){const a=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",u="tableContent";t[0]!==0&&(s.end=Object.assign({},of(e.events,t[0])),n.add(t[0],0,[["exit",s,e]]));const l=of(e.events,t[1]);if(s={type:a,start:Object.assign({},l),end:Object.assign({},l)},n.add(t[1],0,[["enter",s,e]]),t[2]!==0){const i=of(e.events,t[2]),c=of(e.events,t[3]),p={type:u,start:Object.assign({},i),end:Object.assign({},c)};if(n.add(t[2],0,[["enter",p,e]]),r!==2){const h=e.events[t[2]],f=e.events[t[3]];if(h[1].end=Object.assign({},f[1].end),h[1].type="chunkText",h[1].contentType="text",t[3]>t[2]+1){const g=t[2]+1,y=t[3]-t[2]-1;n.add(g,y,[])}}n.add(t[3]+1,0,[["exit",p,e]])}return o!==void 0&&(s.end=Object.assign({},of(e.events,o)),n.add(o,0,[["exit",s,e]]),s=void 0),s}function V5(n,e,t,r,o){const s=[],a=of(e.events,t);o&&(o.end=Object.assign({},a),s.push(["exit",o,e])),r.end=Object.assign({},a),s.push(["exit",r,e]),n.add(t+1,0,s)}function of(n,e){const t=n[e],r=t[0]==="enter"?"start":"end";return t[1][r]}const pM={name:"tasklistCheck",tokenize:gM};function mM(){return{text:{91:pM}}}function gM(n,e,t){const r=this;return o;function o(l){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(l):(n.enter("taskListCheck"),n.enter("taskListCheckMarker"),n.consume(l),n.exit("taskListCheckMarker"),s)}function s(l){return ui(l)?(n.enter("taskListCheckValueUnchecked"),n.consume(l),n.exit("taskListCheckValueUnchecked"),a):l===88||l===120?(n.enter("taskListCheckValueChecked"),n.consume(l),n.exit("taskListCheckValueChecked"),a):t(l)}function a(l){return l===93?(n.enter("taskListCheckMarker"),n.consume(l),n.exit("taskListCheckMarker"),n.exit("taskListCheck"),u):t(l)}function u(l){return On(l)?e(l):pr(l)?n.check({tokenize:bM},e,t)(l):t(l)}}function bM(n,e,t){return Cr(n,r,"whitespace");function r(o){return o===null?t(o):e(o)}}function yM(n){return A4([Hj(),Jj(),oM(n),fM(),mM()])}const vM={};function wM(n){const e=this,t=n||vM,r=e.data(),o=r.micromarkExtensions||(r.micromarkExtensions=[]),s=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),a=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);o.push(yM(t)),s.push(Fj()),a.push(zj(t))}const m6=({file:n,onLinkClick:e,theme:t="light"})=>{const[r,o]=jt.useState(""),[s,a]=jt.useState(null);jt.useEffect(()=>{n&&fetch(n).then(l=>{if(!l.ok)throw new Error(`Failed to load ${n}`);return l.text()}).then(l=>o(l)).catch(l=>a(l.message))},[n]);const u=t==="dark"?{background:"#181a1b",color:"#eee"}:{background:"#fff",color:"#111"};return s?W.jsxs("div",{className:"p-4 text-red-500",children:["Error: ",s]}):W.jsx("div",{className:"markdown-body",style:u,children:W.jsx(oT,{remarkPlugins:[wM],components:{a:({node:l,href:i,children:c,...p})=>{const h=i&&i.endsWith(".md");return W.jsx("a",{href:i,onClick:f=>{h&&e&&(f.preventDefault(),e(i))},...p,children:c})}},children:r})})};m6.propTypes={file:t1.string.isRequired,onLinkClick:t1.func,theme:t1.oneOf(["light","dark"])};const xM=({onReady:n}={})=>{const e="/Student-Retention-Add-in/react/dist/",t="about.md",[r,o]=jt.useState(t),s=`${e}${r}`,a=l=>{const i=l.startsWith("/")?l.slice(1):l;o(i)},u=()=>o(t);return jt.useEffect(()=>{n&&n()},[n]),W.jsxs("div",{className:"p-4",children:[r!==t&&W.jsx("button",{onClick:u,className:"mb-4 px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:" Back to Home"}),W.jsx(m6,{file:s,onLinkClick:a,theme:"light"})]})},SM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAD51JREFUeJztXQmQFsUVfo2rBqWiRAwi4J1VEUyMeADR4IoGkliWMVhGUyQpoyKscu0G1pVzQUCW+9BELWJKq4goRwgpo4CAXFIqmoqKYFRQI9EkWCnPRCGvZ6Zn+njd0/3vwR7/q53p+Xv6et/3+vXxz85fAkU5pFJyqBvQ2sVKQNvS3udjMAQPHh7rSntIhTFgUZieeFR8Hf2x9B7TwugvjWNZeXK6qHyRVpTPvsDTx/hpB4YL39+6emuhzTdAReA7YjAUj5/hcVKhBTeKaOCzJA6SOGYjIQNSCT3Bl9N1w8+dOvb54Q4M5+7btOrtUBUUAhD8zhgMx6MitKBGFwf4zh5AgW+kU+PitBIparoyDMvwoh1GDg5VQ+8B3PKbH/h57ofpBFnAd1m8qJfqCXG+QZ0uvfr19zaurA1RJSUg8fnnFgBH44oNfJZSYAXfIIGw8lzw0zyGm2qL94d17nvNxnfXL9/uq47cA/iA+4PCkWlg8XY1mk/XQnNs0AflcPAz18S64KkSPw30VUsm4PxCcGkUaVTwrb5euZ8RJN2L85wRoppMwLEFQNPwwlLoc8AXgAEJvnumQ6XJeoLV+unxoF2IeiWWa0rW4PFBSOF1Fs3fJ1HgAl/15eKeC/xg13MYnq4zwU/LPCxExZDF1Qef7tpyQ0jhLVFwprPEAX7WWz2laa5um7DIPUQmQJlJBUiRgEChrF8doIsENKwo40EGvjJ2BEiRgECRLV2xfm2h5ytFAoLFAn6RgMYRK/jy2BAgRQICxdiE09YKRQIaWpi2FSEPxNnqz1vqnYC2pb2vgvg7hc5kAm11q/hNY68mScOyNPpWcrYKtq1uvfZ29uBp/nsbV/4xTz8TfImQJtIDOPhl5B0H+OQWA9PTqOCrJKlxbvANss7E+CMxxoMAze8rs6CmQYCf5Wcf6gZ+Yfs5Rj48unppp4CvjQVNwQWRYoAZnTUrlmYQMngiA+Ge6voligyeL3BW8OUeFyANS4Cvq4FQ8JlaTp6v18HXew3zB87w+wohTWklLBSPrl3gS8o7wZetWsqXBz4FNgW+PwOg7H7KBEi6+krDECBbgif49J49FQcmiAAGCP5foqjjUb5qGrkFliOk/glgbDM24UxpxCXBN0kgAE0ye4Pv4XrU9EqZW/zUc4Av1eEr9U4AVj8TT1/iVRelS7rA10CvF/AN15T1EGIQfQcv5vkq6AL/kBPwyWubX8Hglvout6mICb7ZI0KkuBURKDoBoicpcQFSJCBQnCvhIgGNIPrUk5iOhkiRgEBxzn6KPaDhxTn7KRLQ8MLaiOmtbT3QUAQEFtxyJQf8QJj8CGDhm0wtVZyzH2mB6Cv5BAjwiwxEErkgY0WtrQcCxE2AAr5fwV/t0fcIzHcZ4/9jpmwXgLaNYNlSEPUqedStCGp7AZjFNUj3HF+iPISXz+xa8dAnuQrqCy9oCALEvkpSoRTkC2PDMOkoDDua+z+OjTcf8I006h4Q5RpE+Tn7+Gfg1WpMOjFfPZJApdwQMQkQiieKZoFfwZjqpjzwhQLytQykvpkmW5sKMGhWqPllyIDKeoEEXkb8BRgeB14ESPmBLjdEVAIYy2DWwffvAVkjCNBVNwQWsGjrj5MwI51zULSAZJDia2Bm7zHdXIBkBKQFZY1R3EVIA9MGxflt4Ie4Hl15tUzKtcjkWMYHtY4Dngp+am7IqXWFSEqADL4ARNwQwHlLCPgO16ODT7keK/hpXi/w+fGWn2rsXjxOw4tLzelnnXpAAkQCYBYE94CDoIMKNnC1dBT4SQ+hABZ5jfTGfauLehND/u+lL2DEXB/9XnxowfbzfnFHDea5HY9zsIwOGB4j1fWZF1CJSGOA6gsN8H2JZfDPOrkbKR/lx03rBg1ULc4YuKNjC8YdwHDeq0sfXBoCGJcdi+fx/5fjB/S8ecRFWE45FnoJhp9jJb8PKStzQQrg8nUS4dm1sBGz8Pw/zHN6g4KvlWcHX3FRn2H4EoYLdz724IYQoGzy3P2zn8Xg2ULzKz1At3ZlQPUs8N/PP7Ucg+WFNqi1iTIGOMEPHFyK4ifSLEiAzzKs5W5+CBrXWNLjxtt6ocENQTVLUdeOeH04hiWodUni0r7EuC/wQNfK/oHhboxftP3XMzfXtW5zFqT0AOF30wQtRrr/5NaTksGzP4Zd8GhPTVWJ9QTPhytnKL3otsqj8XoNRi7YtnD6rkLaYe8B8gAqhc1dzrn+lhMZ369i7BpU6hv6NDVvPSEN9j2T67MxPLH37VX7MMmcLfOmvh7SHroHUOC3APy7X3/rANSjEvW5TFsPGODT6w1jViXir03Stu8zvHrp5jlTVvi2idiKoMFv7qMAupybMahAfUpVKycBNePNKS1F4A146nHJiLGnPTO7ZpZPu7StCIIEbXbUHAXBr4Jo5QqdbCtkb1J4gS6ikABMUXnpqHHcvU3dUDtxr6ttdA+QQFcWS81QEPwJ2PhyBOO4nEWaBjiQ4OelTdKdgNeD+XXfX02sWX/P+L/b2mf0ADv4zY8BBL8aoumlDXzbVoZtXOClOlbeZi9BEuBziP9vjhS1BwgzVyqDoHXACX2u4u/T6YFZfimXaTQYVEUVJUCPM5Q8iOH9GLv7tWWLP7WAfxOm4V8OHU9bqR38JJ7P+1cndR2JcQPUdueCL/T7aVlVzd51U8eSY4K0F+QCP2AMYGwEZhmJYScnmPo+kGx56rzbZo3fwtN9mPsRAvzLMM3P8f6pJPiOuqT6+Gbdj7YtuudAr/Ix29I2uPamhDGpxnUcnoZfXj3ljbVTqo3ZkfmNmAX8lKBc/CPL9wafBNqpZFrOd1i0+2gSgPEVyX1rGfY5vpo20wG0tBSpkN7XjKsrXlb0u+vu59dMvlN5uavmglzge3YBrTtSSos6rDMPcIGfxn+ExwK9+h43DOZu51wX+DSgFqOIIZF0srnOHOMC6IPhHRhWkgSo7IEKPvMfA2x+3GVBhkKu8SED9G+vPPqA0aUxfhjEWwskEGS8a46v6SHjYli6HXzxeeCV46fNfnLimHRWpE1DVXejgC+swYMAdQZFNFjURynhUkSNMzbCzr3xtoEYf1QQ+DntMgwJNF1k/YhxTc0PJ+OJv5242iAgD3zfMSBtAOFXvcBPe4nd+vG0H8NFRt1t2B0Yf7qbQKr3Ue5S6AFqnJEOjHYr98wx4WqSAN0/60AGDAF78HwmCb5OKAEIlY6w3L++vOQ3L5t18wes8q3fjHMYBth7rxv8pA16rwB2cv9JM0qfGFe5SyEgD/yAHjAfc+G8mXUlfTjocYTiJBhp2n14PVuv9puDhl6B8R/i/RMYWMq1kZ2BYxCltNdol3xPI4QGn0e2w/v8NdHDCQIsrkcU5iHvrH2cv3Ek960j9S2RUoydpRNtc2OGG6Gnj6LwrEdZJghqfQT4Kr7pa6JLNCVo608Ka8rC4md1LK7BDr7aw4leApDF2WZnIKW3eg/Fu6Tvl1Z7QF7mpiyMHW0H1DUuUGmjuM8zFwSfZC7ELCdO4wt+lOAo0WzLQkz3b9AcesDhpJVnoO3FuA4k+Kklp3H88ZXFwB8yiwtfyMc1DLtjshIn+CwZgeLfEzDdeZw+fb+01gOsA0fmD5uoRErZrDy+vx9Pp1h7hDGIMtgwY0JEwPrp4x8vG1OzTMHFDj4v5xyMn4PH5XIa6bqNaDfxWIo+K1ArbLKSAg4q+IkF8uutC6cfLLT4ddPGeufFaeYRsZUrfh9AxjcRbSGmKSBbfxMngEXbx2CCn7mA43vfXvW+lShQes5/MdMDGE58etq4g2VVk/tj9GiIZ1lZT7N7C57ma4TrgaQxX4p2my6I6JI6a01RdAIMoIGdSE0zKT+dYDEYw0kYy78PGIqf+zqnmTpeUnlJ+wT4/Dp9FN4chGmLaA4E7A+d41MzF8kQ26dKMzjeCb6OF1DxWT4MPhTtVndDXeBjtzqp38AlafdzKmkOaHS3d6Ul43FqCPe+8ODcbSYDsBvv97S2gZrjK8al5tGxoMiyzPHV+6CmS+J2GgRA/BVcyiBhMdeJilQlpTgnoHUGX8SX9rx5xJzn7p+tPAaO9xbhcRZenKeXQVg35aLoHqJjkT/HNyw+yycsPXuaWh4DPjbBp5TQLchHSQugxjjjRcrFLP5iQyHg2XtnbLp46OgO1jaQdZng69Yv3IOaVkoHoKT3AP9DJu3kygTswHTdsowEEFJlpE8FIo9OlJ7fINyRNos/48LBFadtv6/2Da0XvMCiTUCtDGu7wEpOCqbAzQK+uFZ6ikyaCj5P89LKivJ9BgEQrfagE4ZlhYOf46LsgBoDpVmGUt/XWfzFxiiNgLl46syy5zYdREv66W5EsuCMCJfriYGmQE9Ji08fYZzybrqUgHefXra1S9m1/FdBFQIygEEDxAJSHlE0oFYCHWX0A022zJ/6dJ9h1R8ZaYPANy3bZv1glO8En8ftXjlq6DKSAGFBjP8QGYNBGLa1g28B1QI+bc0UEH5kJeHpvcpHn7p1wfQ3VR1gFkQPYvFnk2ztooGk/TcEgq+CztJC2H68mqMbjULA22sf449MDD75yuteh/gR7i5mowjwZJDADlwOoBYCLWkZOxozGL/+umnOlFWXjBx7NScAtDaZ4Ot6aOBnDOSCn7osAvwkXLdi1NDfOQkQsufJR2tP6X/9RsZ/mJIB/5qPf4tzGGhKWEEiFHZavx6XT/YXGPcXFj+YZQjG1+LpGEz6Y9J/E4Qb4OoAGgamA+0E/0W8mEm11fq2lLeeWMJ/ktX7V0GbkmycOWnndysn/JbFTyFcoFs1PTZEn2Tw2+B58YCa2gP44S38fFGWXndTao/RwN+NF9NWjBxC/ux5i31l2YYZE1b3HT3xWISGP6B7NtPHItDA11wSxP8fNsjlbuzgizjA8YlNRfCt/zvcYgngsn76+EfKxtRwvKoQmG7e4CfuSJ4JhYPPduN5BoK/2NXGFk0Al3XTxj58+Z2T+fybk3ChPqEQn1W/L7srALCAnpKWTTPFOPI8hvOWjxxiDLq6tHgCuKy9+64V/e66+18RCQADfKyfcj2e4C/F8GEE/w8+bWsVBHBZM/nOZ64YN3UvwjQcQboW8eoaDj4900nyvYLhJgxnI/g7Lc0wpNUQwOWpSVV7MBjxvQnT10H0ajX2bUSufR3n+HxrnP8D91z094+HtqlVESDkzxNGr8JgVf9Jtb0QR/7P2t/FkL9ypp3nHP9JjOyegD8fF1jrC21LqyRAyBPjKvjcPJqff3/KrG4seroOzkOgOyQLua8kfv8zPP0Hk73P+K4xwKKVFeWv1kcbWjUBsvypeiT/4Ynyxq63SMAhlv8DMUjl9xqy1aMAAAAASUVORK5CYII=",Rg=[{name:"Assigned",alias:["advisor"],static:!0},{name:"Student Name",alias:["Student"]},{name:"Gradebook",alias:["Gradelink","gradeBookLink","Grade Book"],static:!0,identifier:!0,format:["=HYPERLINK"]},{name:"ProgramVersion",alias:["Program","ProgVersDescrip"]},{name:"Shift",alias:["ShiftDescrip"]},{name:"LDA",alias:["Last Date of Attendance","Date of Attendance","CurrentLDA"],format:["MM/DD/YYYY"]},{name:"Days Out",alias:["Days Out"],format:["G-Y-R Color Scale"]},{name:"Grade",alias:["Course Grade","current score","current grade"]},{name:"Missing Assignments",alias:["Total Missing"]},{name:"Outreach",alias:["Comments","Comment"]},{name:"Phone",alias:["Phone Number","Contact Number"]},{name:"Other Phone",alias:["Second Phone","Alt Phone"]}],_M=[{option:"identifier",label:"Identifier",type:"boolean"},{option:"alias",label:"Aliases",type:"string"}],y1=[{id:"columns",label:"Columns",type:"array",choices:Rg,options:_M,defaultValue:[],section:"Create LDA",description:"List of columns to format in the master list."},{id:"daysOut",label:"Days Out",type:"number",defaultValue:5,section:"Create LDA",description:"Number of days out threshold."},{id:"includeFailingList",label:"Include Failing List",type:"boolean",defaultValue:!1,section:"Create LDA",description:"Whether to include the failing student list."},{id:"includeLdatTag",label:"Include LDA Tag",type:"boolean",defaultValue:!0,section:"Create LDA",description:"Whether to include the LDA tag."},{id:"includeDncTag",label:"Include DNC Tag",type:"boolean",defaultValue:!0,section:"Create LDA",description:"Whether to include the Do Not Contact students."},{id:"powerAutomateUrl",label:"Power Automate",type:"powerautomate",defaultValue:null,section:"Send Emails",description:"Configure Power Automate flow URL for sending personalized emails."},{id:"downloadHistoryCsv",label:"Download Copy",type:"action",defaultValue:null,section:"Student History",description:"Download the Student History sheet as a CSV file."}],kM=[],W5={"Create LDA":W.jsx("img",{src:SM,alt:"Create LDA",style:{width:16,height:16},"aria-hidden":"true"}),"Send Emails":W.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:W.jsx("path",{d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})}),"Student History":W.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[W.jsx("path",{d:"M12 8v4l3 3",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"currentColor",strokeWidth:"1.6"})]})};function g6({isOpen:n,title:e="Confirm delete",message:t="",confirmLabel:r="Delete",onConfirm:o=()=>{},onCancel:s=()=>{}}){return n?W.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:W.jsxs("div",{style:{width:"min(520px, 94%)",background:"#fff",borderRadius:8,padding:16,boxShadow:"0 8px 32px rgba(2,6,23,0.14)",fontFamily:"Segoe UI, system-ui, sans-serif"},children:[W.jsx("h4",{style:{margin:"0 0 8px 0"},children:e}),W.jsx("div",{style:{color:"#374151",marginBottom:12},children:t}),W.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[W.jsx("button",{onClick:s,style:{padding:"8px 10px",borderRadius:8,background:"#f3f4f6",border:"1px solid #e6e7eb",cursor:"pointer"},children:"Cancel"}),W.jsx("button",{onClick:o,style:{padding:"8px 10px",borderRadius:8,background:"#ef4444",color:"#fff",border:"none",cursor:"pointer"},children:r})]})]})}):null}const AM=({modalOpen:n,modalSetting:e,modalArray:t=[],setModalArray:r=()=>{},closeModal:o=()=>{},saveModal:s=()=>{},workbookColumns:a=[],masterListHeaders:u=null,newMasterListHeaders:l=null,blankColumns:i=null})=>W.jsx(W.Fragment,{children:n&&e?.type==="array"?W.jsx("div",{onClick:o,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},role:"dialog","aria-modal":"true",children:W.jsxs("div",{onClick:c=>c.stopPropagation(),style:{width:"min(820px, 96%)",maxHeight:"86vh",overflow:"auto",background:"#fff",borderRadius:8,padding:16,boxSizing:"border-box"},children:[W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[W.jsx("h3",{style:{margin:0},children:e?.label||"Edit items"}),W.jsx("button",{onClick:o,style:{background:"transparent",border:"none",cursor:"pointer",padding:6,display:"inline-flex",alignItems:"center",justifyContent:"center"},"aria-label":"Close",children:W.jsx(sk,{size:16})})]}),W.jsx(CM,{modalSetting:e,modalArray:t,setModalArray:r,closeModal:o,saveModal:s,workbookColumns:a,masterListHeaders:u,newMasterListHeaders:l,blankColumns:i})]})}):null}),CM=({modalSetting:n,modalArray:e=[],setModalArray:t,closeModal:r,saveModal:o,workbookColumns:s=[],masterListHeaders:a=null,newMasterListHeaders:u=null,blankColumns:l=null})=>{const[i,c]=Ye.useState(0),[p,h]=Ye.useState("choices"),[f,g]=Ye.useState({}),[y,b]=Ye.useState(null),[v,w]=Ye.useState({}),[S,N]=Ye.useState([]),[D,F]=Ye.useState(!1),[G,P]=Ye.useState(""),U=Ye.useRef(null),[q,R]=Ye.useState(!1),[I,T]=Ye.useState(!1),[L,E]=Ye.useState(!1),x=Ye.useMemo(()=>{const at={};return Array.isArray(s)&&s.forEach(rt=>{const ct=String(rt?.name??rt?.label??rt).trim();ct&&(at[ct]=rt)}),at},[s]);function k(){return JSON.stringify({choices:Array.isArray(s)?s.length:0,workbookSignature:(Array.isArray(s)?s.map(at=>{const rt=String(at?.name??at?.label??at).trim(),ct=Array.isArray(at?.options)?at.options.length:at?.options&&typeof at.options=="object"?Object.keys(at.options).length:0;return`${rt}:${ct}`}):[]).join("|"),options:n?.options?.length??0,modalArrayLength:(e||[]).length})}if(Ye.useEffect(()=>{const at={},rt={};let ct=0,ot=!1;if(Array.isArray(e)&&e.length&&e.forEach(ft=>{const gt=ft?.column??ft?.name;if(ft&&gt){const wt=String(gt).trim(),yt=ft.options&&typeof ft.options=="object"?{...ft.options}:{},Et={};["alias","static","format","label","name","identifier"].forEach(qt=>{ft[qt]!==void 0&&(Et[qt]=ft[qt])});const Mt={...yt,...Et};if(Mt.hidden)return;delete Mt.hidden,at[wt]=Mt,ct++,rt[wt]=ct,ot=!0}}),ot)Object.keys(at).forEach(ft=>{const gt=x[ft];if(gt&&typeof gt=="object"){const wt=at[ft];["alias","static","format","identifier"].forEach(yt=>{wt[yt]===void 0&&gt[yt]!==void 0&&(wt[yt]=gt[yt])})}});else{const ft=Array.isArray(s)&&s.length?s:n?.choices||[],gt=wt=>{const yt={};return!wt||typeof wt!="object"||Object.keys(wt).forEach(Et=>{Et==="name"||Et==="label"||Et!=="hidden"&&(yt[Et]=wt[Et])}),yt};ft.forEach((wt,yt)=>{const Et=String(wt.name??wt.label??wt).trim();if(!wt.hidden){if(!at[Et]){const Mt=x[Et];if(Mt){if(Mt.hidden)return;Mt.options&&typeof Mt.options=="object"&&!Array.isArray(Mt.options)?at[Et]={...Mt.options}:at[Et]=gt(Mt)}else at[Et]={}}rt[Et]||(ct++,rt[Et]=ct)}})}g(at),w(rt);const dt=Object.keys(rt).sort((ft,gt)=>(rt[ft]||0)-(rt[gt]||0));N(dt),P(dt[0]||""),c(ft=>dt[ft]?ft:0),h("choices");try{U.current=JSON.stringify({editableMap:at,orderList:dt}),R(!1)}catch{U.current=null,R(!1)}},[k()]),Ye.useEffect(()=>{try{const at=JSON.stringify({editableMap:f,orderList:S});R(U.current?at!==U.current:!1)}catch{R(!1)}},[f,S]),!n)return null;const A=Array.isArray(s)&&s.length?s:n.choices||[],C=S[i]||"",j=x[C];let B=Array.isArray(n?.options)?n.options:[];j&&Array.isArray(j.options)&&j.options.length&&(B=j.options);const O=at=>A.find(rt=>String(rt?.name??rt?.label??rt).trim()===at)||null;O(C);const H=at=>{const rt=String(at||"").trim();if(!rt||rt===C||S.includes(rt))return;const ct=[...S];ct[i]=rt;const ot={};ct.forEach((dt,ft)=>{ot[dt]=ft+1}),N(ct),w(ot),g(dt=>{const ft={...dt};return ft[rt]=ft[C]||{},delete ft[C],ft}),c(i)};Ye.useEffect(()=>{D&&P(C||"")},[D]);const X=(at,rt)=>{g(ct=>{const ot={...ct};return ot[C]={...ot[C]||{}},rt===""||rt==null?delete ot[C][at]:ot[C][at]=rt,ot})},et=()=>{const at=(S.length?S:Object.keys(f)).map(rt=>({column:rt,options:{...f[rt]||{}}}));try{t(at)}catch{}if(typeof o=="function")try{o(at)}catch{}h("choices");try{U.current=JSON.stringify({editableMap:f,orderList:S}),R(!1)}catch{R(!1)}},V=()=>{C&&T(!0)},tt=()=>{const at=C;if(!at){T(!1);return}const rt={...f||{}};delete rt[at];const ct=S.filter(gt=>gt!==at),ot={};ct.forEach((gt,wt)=>{ot[gt]=wt+1}),g(rt),N(ct),w(ot);const dt=Math.max(0,Math.min(ct.length-1,i));c(dt),P(ct[dt]||""),ct.length===0&&h("choices");const ft=(ct.length?ct:Object.keys(rt||{})).map(gt=>({column:gt,options:{...rt[gt]||{}}}));if(typeof o=="function")try{o(ft)}catch{try{t(ft)}catch{}}else t(ft);try{U.current=JSON.stringify({editableMap:rt,orderList:ct}),R(!1)}catch{R(!1)}T(!1),h("choices")},$=Ye.useMemo(()=>{const at=new Set;if(!Array.isArray(a)||a.length===0)return at;const rt=ot=>String(ot||"").trim().toLowerCase().replace(/\s+/g,""),ct=a.map(ot=>rt(ot));return S.forEach(ot=>{const dt=rt(ot);if(ct.includes(dt))return;const ft=x[ot],gt=[];ft&&Array.isArray(ft.alias)&&gt.push(...ft.alias);const wt=f[ot];wt&&Array.isArray(wt.alias)&&gt.push(...wt.alias),wt&&typeof wt.alias=="string"&&wt.alias&&gt.push(...wt.alias.split(",").map(Et=>Et.trim()).filter(Boolean)),gt.some(Et=>ct.includes(rt(Et)))||at.add(ot)}),at},[S,a,x,f]),z=Ye.useMemo(()=>{const at=new Set;if(!l||l.size===0||!Array.isArray(a)||a.length===0)return at;const rt=ot=>String(ot||"").trim().toLowerCase().replace(/\s+/g,""),ct=new Set;return l.forEach(ot=>ct.add(rt(ot))),S.forEach(ot=>{if($.has(ot))return;const dt=rt(ot);if(ct.has(dt)){at.add(ot);return}const ft=x[ot],gt=[];ft&&Array.isArray(ft.alias)&&gt.push(...ft.alias);const wt=f[ot];wt&&Array.isArray(wt.alias)&&gt.push(...wt.alias),wt&&typeof wt.alias=="string"&&wt.alias&&gt.push(...wt.alias.split(",").map(Et=>Et.trim()).filter(Boolean)),gt.some(Et=>ct.has(rt(Et)))&&at.add(ot)}),at},[S,l,a,$,x,f]),Z=(at,rt)=>{const ct=at+rt;if(ct<0||ct>=S.length)return;const ot=[...S];[ot[at],ot[ct]]=[ot[ct],ot[at]];const dt={};ot.forEach((ft,gt)=>{dt[ft]=gt+1}),N(ot),w(dt)},it=at=>{if(S.includes(at))return;const rt=[...S,at],ct={};rt.forEach((ft,gt)=>{ct[ft]=gt+1}),N(rt),w(ct);const ot=x[at],dt={};ot&&typeof ot=="object"&&Object.keys(ot).forEach(ft=>{ft!=="name"&&ft!=="label"&&(dt[ft]=ot[ft])}),delete dt.hidden,g(ft=>({...ft||{},[at]:dt})),R(!0)},mt=Ye.useMemo(()=>{if(!Array.isArray(a))return[];const at=new Set(S.map(rt=>rt.toLowerCase()));return S.forEach(rt=>{const ct=x[rt];ct&&Array.isArray(ct.alias)&&ct.alias.forEach(ot=>at.add(String(ot).trim().toLowerCase()))}),a.filter(rt=>rt&&!at.has(rt.toLowerCase()))},[a,S,x]),lt=async()=>{if(!L){E(!0);try{et(),typeof window<"u"&&window.Excel&&Excel.run&&await Excel.run(async at=>{const rt=at.workbook.worksheets;rt.load("items/name"),await at.sync();const ct=new Date,ot=`${ct.getMonth()+1}-${ct.getDate()}-${ct.getFullYear()}`;let dt=`LDA Preview ${ot}`,ft=2;const gt=rt.items.map(Et=>Et.name);for(;gt.includes(dt);)dt=`LDA Preview ${ot} (${ft++})`;const wt=rt.add(dt),yt=S.filter(Et=>!$.has(Et));if(yt.length>0){const Et=wt.getRangeByIndexes(0,0,1,yt.length);Et.values=[yt],Et.format.font.bold=!0,Et.format.autofitColumns()}wt.activate(),await at.sync()})}catch(at){console.warn("Failed to create preview sheet",at)}finally{E(!1)}}};if(p==="add"){const at=[...mt].sort((ct,ot)=>{const dt=u&&u.has(ct),ft=u&&u.has(ot);return dt&&!ft?-1:!dt&&ft?1:0}),rt=u?at.filter(ct=>u.has(ct)).length:0;return W.jsxs("div",{style:{border:"1px solid #e6e7eb",borderRadius:6,padding:8,background:"#fafafa",maxHeight:"56vh",overflowY:"auto"},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[W.jsx("button",{onClick:()=>h("choices"),style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e6e7eb",background:"#f8fafc",cursor:"pointer"},children:"Back"}),W.jsx("div",{style:{fontWeight:600,fontSize:14},children:"Add columns from Master List"}),rt>0&&W.jsxs("span",{style:{padding:"2px 8px",borderRadius:10,background:"#dbeafe",color:"#1d4ed8",fontSize:11,fontWeight:600,lineHeight:"16px"},children:[rt," new"]})]}),at.length===0?W.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"All Master List columns are already configured."}):at.map(ct=>{const ot=u&&u.has(ct);return W.jsxs("button",{type:"button",onClick:()=>{it(ct)},style:{display:"flex",alignItems:"center",width:"100%",padding:"8px 10px",marginBottom:4,borderRadius:6,border:ot?"1px solid rgba(29,78,216,0.2)":"1px solid #e6e7eb",background:ot?"#eff6ff":"#fff",cursor:"pointer",textAlign:"left",gap:8,fontSize:14,transition:"background-color 120ms ease"},onMouseEnter:dt=>{dt.currentTarget.style.background="#eef2ff"},onMouseLeave:dt=>{dt.currentTarget.style.background=ot?"#eff6ff":"#fff"},children:[W.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0,color:"#4f46e5"},children:W.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})}),W.jsx("span",{style:{flex:1},children:ct}),ot&&W.jsx("span",{title:"This column was recently added to the Master List",style:{padding:"2px 6px",borderRadius:4,background:"#dbeafe",color:"#1d4ed8",fontSize:11,fontWeight:600,flexShrink:0,lineHeight:"16px"},children:"New"})]},ct)})]})}return p==="choices"?W.jsxs("div",{style:{border:"1px solid #e6e7eb",borderRadius:6,padding:8,background:"#fafafa",maxHeight:"56vh",overflowY:"auto",position:"relative"},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[W.jsx("div",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:8,fontSize:13},children:"Visible on LDA"}),W.jsxs("div",{style:{display:"flex",gap:6},children:[W.jsxs("button",{type:"button",onClick:lt,disabled:L||S.length===0,title:"Create a preview LDA sheet with just headers",style:{padding:"6px 8px",borderRadius:6,background:L?"#f3f4f6":"#f0fdf4",border:"1px solid rgba(22,163,74,0.12)",cursor:L||S.length===0?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",gap:6,fontSize:13,color:"#15803d"},children:[W.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",children:[W.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8S1 12 1 12z",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"1.4"})]}),L?"Creating...":"Preview"]}),W.jsxs("button",{type:"button",onClick:()=>{if(Array.isArray(a)&&a.length>0)h("add");else{const at="New Column";let rt=1,ct=at;for(;S.includes(ct);)rt++,ct=`${at} ${rt}`;it(ct)}},title:"Add column","aria-label":"Add column",style:{padding:"6px 8px",borderRadius:6,background:"#eef2ff",border:"1px solid rgba(79,70,229,0.12)",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:6,fontSize:13},children:[W.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",children:W.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})}),"Add"]})]})]}),S.length===0&&W.jsx("div",{style:{color:"#6b7280",fontSize:13,marginBottom:8},children:"No visible columns. Click Add to include columns from the Master List."}),S.map((at,rt)=>{const ct=O(at),ot=String(ct?.name??ct?.label??at).trim(),dt=rt+1,ft="col-"+rt,gt=$.has(at);return W.jsxs("div",{onMouseEnter:()=>b(ft),onMouseLeave:()=>b(null),style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 8px",marginBottom:4,borderRadius:6,background:gt?"#f9fafb":y===ft?"#eef2ff":"transparent",border:gt?"1px solid #e5e7eb":y===ft?"1px solid rgba(79,70,229,0.12)":"1px solid transparent",transition:"background-color 120ms ease",gap:4,opacity:gt?.5:1},children:[W.jsx("div",{"aria-hidden":"true",style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:6,background:gt?"#f3f4f6":y===ft?"#eef2ff":"#f3f4f6",color:gt?"#9ca3af":"#374151",fontWeight:700,flexShrink:0,userSelect:"none",fontSize:13},title:gt?`Position ${dt} (missing from Master List)`:`Position ${dt}`,children:gt?W.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",children:[W.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"1.6"}),W.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),W.jsx("circle",{cx:"12",cy:"16",r:"0.5",fill:"currentColor",stroke:"currentColor",strokeWidth:"1"})]}):dt}),W.jsx("button",{onClick:()=>{gt||(c(rt),h("options"))},style:{flex:1,background:"none",border:"none",textAlign:"left",cursor:gt?"default":"pointer",padding:"4px 0",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:14,color:gt?"#9ca3af":"inherit"},children:ot}),gt&&W.jsx("span",{title:"This column was not found in the Master List and will be skipped",style:{padding:"2px 6px",borderRadius:4,background:"#fef3c7",color:"#92400e",fontSize:11,fontWeight:600,flexShrink:0,lineHeight:"16px"},children:"Missing"}),!gt&&z.has(at)&&W.jsx("span",{title:"This column exists in the Master List but contains no data values",style:{padding:"2px 6px",borderRadius:4,background:"#e0e7ff",color:"#3730a3",fontSize:11,fontWeight:600,flexShrink:0,lineHeight:"16px"},children:"Blank"}),!gt&&W.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:1,flexShrink:0},children:[W.jsx("button",{type:"button",onClick:wt=>{wt.stopPropagation(),Z(rt,-1)},disabled:rt===0,"aria-label":`Move ${ot} up`,title:"Move up",style:{padding:0,width:22,height:16,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"1px solid #e6e7eb",borderRadius:"4px 4px 0 0",background:rt===0?"#f9fafb":"#f3f4f6",cursor:rt===0?"not-allowed":"pointer",color:rt===0?"#d1d5db":"#374151",transition:"background-color 120ms ease"},children:W.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",children:W.jsx("path",{d:"M18 15l-6-6-6 6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),W.jsx("button",{type:"button",onClick:wt=>{wt.stopPropagation(),Z(rt,1)},disabled:rt===S.length-1,"aria-label":`Move ${ot} down`,title:"Move down",style:{padding:0,width:22,height:16,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"1px solid #e6e7eb",borderRadius:"0 0 4px 4px",background:rt===S.length-1?"#f9fafb":"#f3f4f6",cursor:rt===S.length-1?"not-allowed":"pointer",color:rt===S.length-1?"#d1d5db":"#374151",transition:"background-color 120ms ease"},children:W.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",children:W.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]},at+rt)})]}):W.jsxs("div",{style:{border:"1px solid #e6e7eb",borderRadius:6,padding:12,background:"#fff",maxHeight:"56vh",overflowY:"auto"},children:[W.jsxs("div",{style:{marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[W.jsx("button",{onClick:()=>h("choices"),style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e6e7eb",background:"#f8fafc",cursor:"pointer"},"aria-label":"Back to columns",children:"Back"}),W.jsxs("div",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[W.jsx("span",{children:"Options for:"}),D?W.jsx("input",{autoFocus:!0,value:G,onChange:at=>P(at.target.value),onBlur:()=>{H(G),F(!1)},onKeyDown:at=>{at.key==="Enter"?(H(G),F(!1)):at.key==="Escape"&&F(!1)},style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e6e7eb",minWidth:160},"aria-label":"Rename column"}):W.jsx("span",{onClick:()=>{F(!0)},style:{fontWeight:700,cursor:"pointer",userSelect:"none"},title:"Click to rename",role:"button",tabIndex:0,onKeyDown:at=>{(at.key==="Enter"||at.key===" ")&&F(!0)},children:C})]})]}),W.jsxs("div",{style:{fontSize:13,color:"#6b7280"},children:[Object.keys(f[C]||{}).length," set"]})]}),W.jsxs("div",{style:{display:"grid",gap:8},children:[B.length===0&&W.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"No options available"}),B.map(at=>{const rt=at.option||at.name||String(at),ct=at.label||rt,ot=Array.isArray(at.values)?at.values:Array.isArray(at.type)?at.type:[],dt=f[C]&&f[C][rt]||"";return W.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"space-between"},children:[W.jsx("div",{style:{minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ct}),ot&&ot.length>0?W.jsxs("select",{value:dt,onChange:ft=>X(rt,ft.target.value),style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e6e7eb",minWidth:160},"aria-label":`Select ${ct} for ${C}`,children:[W.jsx("option",{value:"",children:"None"}),ot.map(ft=>W.jsx("option",{value:ft,children:ft},ft))]}):at.type==="boolean"?(()=>{const ft=dt===!0||dt==="Yes"||dt==="On"||String(dt).toLowerCase()==="true"||String(dt).toLowerCase()==="yes"||String(dt).toLowerCase()==="on";return W.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:1,cursor:"pointer"},children:[W.jsxs("span",{style:{position:"relative",width:44,height:24,display:"inline-block"},children:[W.jsx("input",{type:"checkbox",checked:ft,onChange:gt=>X(rt,gt.target.checked),"aria-label":ct,style:{position:"absolute",opacity:0,width:0,height:0}}),W.jsx("span",{style:{position:"absolute",inset:0,borderRadius:9999,background:ft?"#4f46e5":"#e5e7eb",transition:"background-color 160ms linear",padding:2,boxSizing:"border-box"}}),W.jsx("span",{style:{position:"absolute",top:2,left:ft?22:2,width:20,height:20,borderRadius:"50%",background:"#fff",boxShadow:"0 1px 2px rgba(0,0,0,0.2)",transition:"left 160ms linear"}})]}),W.jsx("span",{style:{fontSize:13},children:ft?"On":"Off"})]})})():W.jsx("input",{type:"text",value:dt,onChange:ft=>X(rt,ft.target.value),style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e6e7eb",minWidth:160},"aria-label":`Enter ${ct} for ${C}`,placeholder:"Enter value"})]},rt)})]}),W.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:[W.jsx("button",{onClick:V,disabled:!C,"aria-disabled":!C,title:C?`Delete ${C}`:"No column selected",style:{padding:"8px 10px",borderRadius:6,background:"#fff",color:"#ef4444",border:"1px solid rgba(239,68,68,0.12)",cursor:C?"pointer":"not-allowed",opacity:C?1:.6},children:"Delete"}),W.jsx("button",{onClick:et,disabled:!q,"aria-disabled":!q,style:{padding:"8px 10px",borderRadius:6,background:q?"#4f46e5":"#9ca3af",color:"#fff",border:"none",cursor:q?"pointer":"not-allowed",opacity:q?1:.9},title:q?"Save changes":"No changes to save",children:"Save"})]}),W.jsx(g6,{isOpen:I,title:"Delete column",message:`Delete column "${C}"? This cannot be undone.`,confirmLabel:"Delete",onConfirm:tt,onCancel:()=>T(!1)})]})},b6={padding:"8px 10px",borderRadius:10,border:"none",cursor:"pointer",boxShadow:"0 10px 30px rgba(79,70,229,0.08)",transition:"transform 120ms ease, box-shadow 120ms ease",fontSize:13,fontWeight:600,marginRight:8},EM={...b6,background:"linear-gradient(90deg,#6366f1,#8b5cf6)",color:"#fff"},y6={...b6,background:"#f8fafc",color:"#0f172a",boxShadow:"none"},G5={...y6,padding:6,width:36,height:36,display:"inline-flex",alignItems:"center",justifyContent:"center"};function NM({isOpen:n,onClose:e,docKey:t="workbookSettings"}){const[r,o]=jt.useState(!1),[s,a]=jt.useState(null),[u,l]=jt.useState(null),[i,c]=jt.useState("tree"),[p,h]=jt.useState(!1),[f,g]=jt.useState(!1);jt.useEffect(()=>{n&&y()},[n]);async function y(){o(!0),l(null);try{const P={workbookProperties:{},worksheets:[],namedItems:[],addinSettings:{},documentSettingsKey:t,documentSettings:null};if(window.Excel&&Excel.run?await Excel.run(async U=>{const q=U.workbook.properties,R=U.workbook.worksheets,I=U.workbook.names;q.load(),R.load("items/name"),I.load("items/name,items/formula"),await U.sync(),P.workbookProperties={title:q.title,subject:q.subject,author:q.author,company:q.company,manager:q.manager,category:q.category,keywords:q.keywords,comments:q.comments,_raw:q},P.worksheets=R.items.map(T=>T.name),P.namedItems=I.items.map(T=>({name:T.name,formula:T.formula}))}):P._warning="Excel JavaScript API not available in this environment.",window.Office&&Office.context&&Office.context.document&&Office.context.document.settings)try{const U=Office.context.document.settings,q={};U._data&&typeof U._data=="object"&&Object.keys(U._data).forEach(R=>{try{q[R]=U.get?U.get(R):U._data[R]}catch{q[R]="[error reading key]"}}),P.addinSettings=q;try{const R=typeof U.get=="function"?U.get(t):U._data?U._data[t]:void 0;P.documentSettings=R??null}catch(R){P.documentSettings={_error:String(R)}}}catch(U){P.addinSettings={_error:String(U)};try{window.Office&&Office.context&&Office.context.document&&Office.context.document.settings&&typeof Office.context.document.settings.get=="function"&&(P.documentSettings=Office.context.document.settings.get(t))}catch{}}else P.addinSettings={_warning:"Office.context.document.settings not available."},P.documentSettings={_warning:"Office.context.document.settings not available."};a(P)}catch(P){l(String(P)),a(null)}finally{o(!1)}}function b(){e&&e()}async function v(){if(!s)return;const P=JSON.stringify(s,null,2);try{await navigator.clipboard.writeText(P)}catch{const q=document.createElement("textarea");q.value=P,document.body.appendChild(q),q.select();try{document.execCommand("copy")}catch{}document.body.removeChild(q)}}async function w(){g(!0);try{if(window.Office&&Office.context&&Office.context.document&&Office.context.document.settings){const P=Office.context.document.settings;try{typeof P.remove=="function"?P.remove(t):P._data&&Object.prototype.hasOwnProperty.call(P._data,t)&&delete P._data[t],typeof P.saveAsync=="function"?await new Promise(U=>{try{P.saveAsync(function(){U(null)})}catch{U(null)}}):typeof Office.context.document.settings.saveAsync=="function"&&await new Promise(U=>{try{Office.context.document.settings.saveAsync(function(){U(null)})}catch{U(null)}}),await y();return}catch(U){console.error("Error removing setting via Office API:",U)}}a(P=>P&&{...P,documentSettings:null})}finally{g(!1),h(!1)}}if(!n)return null;function S({open:P=!1}){return W.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{display:"block"},xmlns:"http://www.w3.org/2000/svg",children:W.jsx("path",{d:"M3 7a2 2 0 0 1 2-2h4l2 2h6a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round",fill:P?"#f3f4f6":"none"})})}function N(){return W.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",style:{display:"block"},xmlns:"http://www.w3.org/2000/svg",children:[W.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("path",{d:"M14 2v6h6",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function D({open:P}){return W.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",style:{transform:P?"rotate(90deg)":"none",transition:"transform 120ms linear"},fill:"none",xmlns:"http://www.w3.org/2000/svg",children:W.jsx("path",{d:"M8 5l8 7-8 7",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})})}function F({label:P,icon:U,defaultOpen:q=!1,children:R,right:I}){const[T,L]=jt.useState(q);return W.jsxs("div",{children:[W.jsxs("div",{onClick:()=>L(E=>!E),style:{display:"flex",alignItems:"center",gap:8,padding:"6px 8px",cursor:R?"pointer":"default",userSelect:"none",borderRadius:6,transition:"background 120ms"},children:[R?W.jsx(D,{open:T}):W.jsx("div",{style:{width:12}}),W.jsx("div",{style:{width:18,height:18,display:"flex",alignItems:"center",justifyContent:"center",color:"#6b7280"},children:U}),W.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:13},children:P}),I&&W.jsx("div",{style:{marginLeft:8,color:"#6b7280",fontSize:12},children:I})]}),R&&T&&W.jsx("div",{style:{marginLeft:20,borderLeft:"1px dashed rgba(0,0,0,0.04)",paddingLeft:8},children:R})]})}function G(P,U,q=""){const R=G.__seen||(G.__seen=new WeakSet),I=(L,E=0)=>{try{if(L===null||typeof L!="object"){const k=String(L??"");return k.length>40?k.slice(0,37)+"...":k}if(Array.isArray(L))return L.length===0?"[empty array]":I(L[0],E+1);const x=Object.values(L);for(let k=0;k<x.length;k++)if(x[k]===null||typeof x[k]!="object")return I(x[k],E+1);for(let k=0;k<x.length;k++)if(Array.isArray(x[k])&&x[k].length>0)return I(x[k][0],E+1);return"{object}"}catch{return"{...}"}},T=(L,E,x)=>{if(E===null||typeof E!="object")return W.jsx(F,{label:L,icon:W.jsx(N,{}),children:null,right:String(E??"")},x);if(R.has(E))return W.jsx(F,{label:L,icon:W.jsx(N,{}),children:null,right:"[circular]"},x);if(R.add(E),Array.isArray(E))return W.jsx(F,{label:`${L} [array]`,icon:W.jsx(S,{}),children:E.length===0?W.jsx("div",{style:{padding:6,color:"#6b7280"},children:"Empty array"}):E.map((A,C)=>{const j=`${C+1}: ${I(A)}`;return T(j,A,`${x}.${C}`)})},x);const k=Object.entries(E);return W.jsx(F,{label:`${L} {object}`,icon:W.jsx(S,{}),children:k.length===0?W.jsx("div",{style:{padding:6,color:"#6b7280"},children:"Empty object"}):k.map(([A,C])=>T(A,C,`${x}.${A}`))},x)};try{return T(P,U,q||P)}finally{G.__seen=new WeakSet}}return W.jsxs("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:[W.jsxs("div",{style:{width:"90%",maxWidth:900,maxHeight:"90%",overflow:"auto",background:"#fff",borderRadius:6,padding:16,boxShadow:"0 6px 24px rgba(0,0,0,0.2)",fontFamily:"Segoe UI, system-ui, sans-serif",fontSize:13},children:[W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[W.jsx("h3",{style:{margin:0},children:"Workbook Explorer"}),W.jsxs("div",{children:[W.jsx("button",{onClick:()=>c(P=>P==="tree"?"json":"tree"),style:y6,title:i==="tree"?"Switch to JSON view":"Switch to tree view","aria-label":i==="tree"?"Switch to JSON view":"Switch to tree view",children:i==="tree"?"JSON View":"Tree View"}),W.jsx("button",{onClick:y,style:G5,title:"Refresh","aria-label":"Refresh workbook settings",children:W.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[W.jsx("path",{d:"M21 12a9 9 0 1 1-2.36-6.36",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("path",{d:"M21 3v6h-6",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),i==="json"&&W.jsx("button",{onClick:v,style:EM,children:"Copy JSON"}),W.jsx("button",{onClick:b,style:G5,title:"Close","aria-label":"Close workbook explorer",children:W.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[W.jsx("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]}),r&&W.jsx("div",{children:"Loading workbook settings..."}),u&&W.jsxs("div",{style:{color:"red"},children:["Error: ",u]}),!r&&s&&(i==="tree"?W.jsxs("div",{style:{display:"grid",gap:8},children:[W.jsx(F,{label:"Workbook Properties",icon:W.jsx(S,{}),defaultOpen:!1,children:s.workbookProperties&&Object.keys(s.workbookProperties).length>0?Object.entries(s.workbookProperties).map(([P,U])=>G(P,U,`workbookProps.${P}`)):W.jsx("div",{style:{padding:6,color:"#6b7280"},children:"No properties available"})}),W.jsx(F,{label:`Worksheets (${s.worksheets&&s.worksheets.length||0})`,icon:W.jsx(S,{}),children:Array.isArray(s.worksheets)&&s.worksheets.length>0?s.worksheets.map((P,U)=>W.jsx(F,{label:P,icon:W.jsx(N,{})},U)):W.jsx("div",{style:{padding:6,color:"#6b7280"},children:"No worksheets found"})}),W.jsx(F,{label:`${s.documentSettingsKey||t}`,icon:W.jsx(S,{}),right:W.jsx("button",{onClick:P=>{P.stopPropagation(),h(!0)},title:"Delete mapping",style:{border:"none",background:"transparent",cursor:"pointer",padding:2,display:"inline-flex",alignItems:"center",justifyContent:"center",color:"#ef4444",borderRadius:6},children:W.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[W.jsx("path",{d:"M3 6h18",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("path",{d:"M8 6v14a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V6",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("path",{d:"M10 11v6M14 11v6",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("path",{d:"M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})]})}),children:s.documentSettings&&typeof s.documentSettings=="object"&&Object.keys(s.documentSettings).length>0?Object.entries(s.documentSettings).map(([P,U])=>G(P,U,`doc.${P}`)):W.jsx("div",{style:{padding:6,color:"#6b7280"},children:s.documentSettings===null?"No mapping found for this key":String(s.documentSettings??"")})})]}):W.jsx("div",{children:W.jsx("pre",{style:{margin:6,padding:8,background:"#f9fafb",borderRadius:6,overflow:"auto",maxHeight:480,fontSize:12},children:JSON.stringify(s,null,2)})})),!r&&!s&&!u&&W.jsx("div",{children:"No data available. Click Refresh."})]}),W.jsx(g6,{isOpen:p,title:"Delete document mapping",message:`Delete document setting "${t}"? This cannot be undone.`,confirmLabel:f?"Deleting...":"Delete",onConfirm:w,onCancel:()=>h(!1)})]})}function TM({isOpen:n,onClose:e}){const[t,r]=jt.useState(""),[o,s]=jt.useState(""),[a,u]=jt.useState(null),[l,i]=jt.useState(!1);jt.useEffect(()=>{n&&c()},[n]);const c=async()=>{i(!0);try{await Excel.run(async g=>{const b=g.workbook.settings.getItemOrNullObject("connections");b.load("value"),await g.sync();const w=(b.value?JSON.parse(b.value):[]).find(S=>S.type==="power-automate"&&S.name==="Send Personalized Email");w?(u(w),r(""),s("Connection configured")):(u(null),r(""),s("No connection configured"))})}catch(g){console.error("Error loading connection:",g),s("Error loading connection")}finally{i(!1)}},p=g=>{try{const y=new URL(g);return y.protocol==="http:"||y.protocol==="https:"}catch{return!1}},h=async()=>{if(!t.trim()&&a){e();return}if(!p(t)){s("Please enter a valid HTTP URL.");return}s("Saving connection...");try{await Excel.run(async g=>{const y=g.workbook.settings,b=y.getItemOrNullObject("connections");b.load("value"),await g.sync();let v=b.value?JSON.parse(b.value):[];v=v.filter(S=>!(S.type==="power-automate"&&S.name==="Send Personalized Email"));const w={id:a?.id||"pa-"+Math.random().toString(36).substr(2,9),name:"Send Personalized Email",type:"power-automate",url:t,actions:[],history:[]};v.push(w),y.add("connections",JSON.stringify(v)),await g.sync(),u(w),s("Connection saved successfully!"),setTimeout(()=>{e()},1500)})}catch(g){console.error("Error saving connection:",g),s("Error saving connection")}},f=async()=>{if(a){s("Deleting connection...");try{await Excel.run(async g=>{const y=g.workbook.settings,b=y.getItemOrNullObject("connections");b.load("value"),await g.sync();let v=b.value?JSON.parse(b.value):[];v=v.filter(w=>!(w.type==="power-automate"&&w.name==="Send Personalized Email")),y.add("connections",JSON.stringify(v)),await g.sync(),u(null),r(""),s("Connection deleted successfully!"),setTimeout(()=>{e()},1500)})}catch(g){console.error("Error deleting connection:",g),s("Error deleting connection")}}};return n?W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50",children:W.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[W.jsxs("div",{className:"flex justify-between items-center mb-4",children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Configure Power Automate"}),W.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600","aria-label":"Close",children:W.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l?W.jsx("div",{className:"flex justify-center items-center py-8",children:W.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-600"})}):W.jsxs(W.Fragment,{children:[W.jsxs("div",{className:"mb-4",children:[W.jsx("label",{htmlFor:"pa-url",className:"block text-sm font-medium text-gray-700 mb-2",children:"Power Automate HTTP URL"}),W.jsx("input",{type:"password",id:"pa-url",value:t,onChange:g=>r(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:a?"":"https://prod-xx.eastus.logic.azure.com...",autoComplete:"off"}),W.jsx("p",{className:"mt-2 text-xs text-gray-500",children:a?"A URL is configured. Enter a new URL to replace it.":'This URL is generated by the "When a HTTP request is received" trigger in your Power Automate flow.'})]}),W.jsx("p",{className:"text-xs text-center h-4 mb-4",style:{color:o.includes("Error")?"#dc2626":"#16a34a"},children:o}),W.jsxs("div",{className:"flex justify-between gap-2",children:[a&&W.jsx("button",{onClick:f,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"}),W.jsxs("div",{className:`flex gap-2 ${a?"":"ml-auto"}`,children:[W.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"}),W.jsx("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save"})]})]})]})]})}):null}function jM({accessToken:n}){const[e,t]=jt.useState(null);return jt.useEffect(()=>{const r=localStorage.getItem("SSO_USER_INFO");if(r)try{t(JSON.parse(r))}catch(o){console.error("Failed to parse cached user info:",o)}},[]),e?W.jsxs("div",{className:"p-4 rounded-md border border-gray-200 bg-white",children:[W.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Account Information"}),W.jsxs("div",{className:"space-y-2 text-sm",children:[W.jsxs("div",{children:[W.jsx("span",{className:"text-gray-500",children:"Name:"})," ",W.jsx("span",{className:"font-medium text-gray-900",children:e.name})]}),e.email&&W.jsxs("div",{children:[W.jsx("span",{className:"text-gray-500",children:"Email:"})," ",W.jsx("span",{className:"font-medium text-gray-900",children:e.email})]}),e.tenantId&&W.jsxs("div",{children:[W.jsx("span",{className:"text-gray-500",children:"Organization ID:"})," ",W.jsx("span",{className:"font-mono text-xs text-gray-700",children:e.tenantId})]})]})]}):W.jsx("div",{className:"p-4 bg-gray-50 rounded-md",children:W.jsx("p",{className:"text-sm text-gray-600",children:"Loading user information..."})})}const MM=({user:n,accessToken:e,onReady:t})=>{const[r,o]=jt.useState("workbook"),[s,a]=jt.useState(()=>kM.reduce((H,X)=>(H[X.id]=X.defaultValue,H),{})),[u,l]=jt.useState(()=>y1.reduce((H,X)=>(H[X.id]=X.defaultValue,H),{})),[i,c]=jt.useState(!1),[p,h]=jt.useState(null),[f,g]=jt.useState([]),[y,b]=jt.useState(null),[v,w]=jt.useState(!1),[S,N]=jt.useState(!1),[D,F]=jt.useState(!1),[G,P]=jt.useState(null),[U,q]=jt.useState(null),[R,I]=jt.useState(null),T=async()=>{try{if(typeof window<"u"&&window.Excel&&Excel.run)return await Excel.run(async X=>{const et=X.workbook.worksheets.getItemOrNullObject("Master List");if(await X.sync(),et.isNullObject)return null;const V=et.getUsedRangeOrNullObject();if(V.load("values"),await X.sync(),V.isNullObject||!V.values||V.values.length===0)return null;const tt=V.values,$=tt[0].map(Z=>Z==null?"":String(Z).trim()).filter(Boolean),z=new Set;return $.forEach((Z,it)=>{let mt=!0;for(let lt=1;lt<tt.length;lt++){const at=tt[lt][it];if(at!=null&&String(at).trim()!==""){mt=!1;break}}mt&&tt.length>1&&z.add(Z)}),{headers:$,blankColumns:z}})}catch(H){console.warn("Failed to read Master List headers",H)}return null},L=async()=>{if(!D){F(!0);try{if(typeof window>"u"||!window.Excel||!Excel.run)throw new Error("Excel API not available");const H=await Excel.run(async tt=>{const $=tt.workbook.worksheets.getItemOrNullObject("Student History");if(await tt.sync(),$.isNullObject)throw new Error("Student History sheet not found");const z=$.getUsedRangeOrNullObject();if(z.load("values"),await tt.sync(),z.isNullObject||!z.values||z.values.length===0)throw new Error("Student History sheet is empty");return z.values.map(Z=>Z.map(it=>{const mt=it==null?"":String(it);return mt.includes(",")||mt.includes('"')||mt.includes(`
`)?`"${mt.replace(/"/g,'""')}"`:mt}).join(",")).join(`
`)}),X=new Blob([H],{type:"text/csv;charset=utf-8;"}),et=URL.createObjectURL(X),V=document.createElement("a");V.href=et,V.download="Student History.csv",document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(et)}catch(H){console.error("Failed to download Student History CSV:",H),alert(H.message||"Failed to download Student History")}finally{F(!1)}}},E=async(H,X,et)=>{if(H.id==="columns"){const tt=await T(),$=tt?tt.headers:null;P($),I(tt?tt.blankColumns:null);const z=u.lastKnownHeaders;if($&&Array.isArray(z)&&z.length>0){const Z=lt=>String(lt||"").trim().toLowerCase().replace(/\s+/g,""),it=new Set(z.map(lt=>Z(lt))),mt=new Set;$.forEach(lt=>{it.has(Z(lt))||mt.add(lt)}),q(mt.size>0?mt:null)}else q(null)}else P(null),q(null),I(null);h(H);const V=Array.isArray(X)?X.map(tt=>typeof tt=="string"?{name:tt,alias:[],edit:"name",static:!1}:tt&&typeof tt=="object"?{name:tt.name??"",alias:Array.isArray(tt.alias)?tt.alias:tt.alias?String(tt.alias).split(",").map($=>$.trim()).filter(Boolean):[],edit:"name",static:!!tt.static}:{name:"",alias:[],edit:"name",static:!1}):[];g(V),b(()=>et),c(!0)},x=()=>{c(!1),h(null),g([]),b(null)},k=H=>{if(p&&typeof y=="function"){const X=Array.isArray(H)?H:f,et=(Array.isArray(X)?X:[]).map(V=>({name:String(V?.name??V?.column??"").trim(),alias:Array.isArray(V?.alias)?V.alias.map(tt=>String(tt).trim()).filter(Boolean):[],static:!!V?.static,...V&&V.options&&typeof V.options=="object"?V.options:{}}));y(p.id,et),p.id==="columns"&&Array.isArray(G)&&(B("lastKnownHeaders",G),q(null))}x()},A="workbookSettings",C=()=>{try{if(typeof window<"u"&&window.Office&&Office.context&&Office.context.document&&Office.context.document.settings)return Office.context.document.settings.get(A)||null}catch(H){console.warn("Failed to read document settings",H)}return null},j=H=>{try{typeof window<"u"&&window.Office&&Office.context&&Office.context.document&&Office.context.document.settings&&(Office.context.document.settings.set(A,H),Office.context.document.settings.saveAsync(X=>{X&&X.status!==Office.AsyncResultStatus.Succeeded&&console.warn("Failed to save workbook settings to document",X.error)}))}catch(X){console.warn("Failed to save document settings",X)}};jt.useEffect(()=>{const H=C();if(H&&typeof H=="object"){const et=!Array.isArray(H.columns)||H.columns.length===0,V={...H};et&&(V.columns=[...Rg],j(V)),l(tt=>({...tt,...V}));return}const X=y1.reduce((et,V)=>(et[V.id]=V.defaultValue,et),{});(!Array.isArray(X.columns)||X.columns.length===0)&&(X.columns=[...Rg]),l(X),j(X)},[]),jt.useEffect(()=>{t&&t()},[t]);const B=(H,X)=>{l(et=>{const V={...et,[H]:X};return j(V),V})},O=(H,X,et,V="")=>{const tt={},$=[];H.forEach(Z=>{Z.section?(tt[Z.section]||=[]).push(Z):$.push(Z)});const z=Z=>{const it=X[Z.id],mt=`${V}${Z.id}`;return W.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",gap:8,width:"100%",boxSizing:"border-box"},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0,overflow:"hidden"},children:[W.jsx("div",{style:{fontSize:14,fontWeight:600,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Z.label}),Z.description&&W.jsx("button",{type:"button",title:Z.description,"aria-label":`${Z.label} description`,style:{marginLeft:1,padding:1,border:"none",background:"transparent",color:"#6b7280",cursor:"pointer",display:"inline-flex",alignItems:"center"},children:W.jsx(bf,{size:14})})]}),W.jsx("div",{style:{display:"flex",alignItems:"center",gap:4,justifyContent:"flex-start"},children:(()=>{if(Z.type==="boolean")return W.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:1,cursor:"pointer"},children:[W.jsxs("span",{style:{position:"relative",width:44,height:24,display:"inline-block"},children:[W.jsx("input",{type:"checkbox",checked:!!it,onChange:lt=>et(Z.id,lt.target.checked),"aria-label":Z.label,style:{position:"absolute",opacity:0,width:0,height:0}}),W.jsx("span",{style:{position:"absolute",inset:0,borderRadius:9999,background:it?"#4f46e5":"#e5e7eb",transition:"background-color 160ms linear",padding:2,boxSizing:"border-box"}}),W.jsx("span",{style:{position:"absolute",top:2,left:it?22:2,width:20,height:20,borderRadius:"50%",background:"#fff",boxShadow:"0 1px 2px rgba(0,0,0,0.2)",transition:"left 160ms linear"}})]}),W.jsx("span",{style:{fontSize:13},children:it?"On":"Off"})]});if(Z.type==="select"&&Array.isArray(Z.options))return W.jsx("select",{value:it??"",onChange:lt=>et(Z.id,lt.target.value),style:{padding:"6px 10px",borderRadius:6,minWidth:120},"aria-label":Z.label,children:Z.options.map(lt=>W.jsx("option",{value:lt,children:lt},lt))});if(Z.type==="array")return Z.locked?W.jsxs("button",{onClick:()=>{},style:{padding:"6px 10px",borderRadius:6,background:"#f9fafb",border:"1px solid #e6e7eb",cursor:"not-allowed",display:"inline-flex",alignItems:"center",gap:8,color:"#6b7280"},"aria-label":"Configure","aria-disabled":"true",title:"This setting is locked",children:[W.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",style:{display:"block",color:"#9ca3af"},children:[W.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.2"}),W.jsx("path",{d:"M7 11V8a5 5 0 0 1 10 0v3",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]}),W.jsx("span",{style:{fontSize:13},children:"Locked"})]}):W.jsx("button",{onClick:()=>E(Z,it,et),style:{padding:"6px 10px",borderRadius:6,background:"#f3f4f6",border:"1px solid #e6e7eb",cursor:"pointer"},"aria-label":"Configure",children:"Configure"});if(Z.type==="powerautomate")return W.jsx("button",{onClick:()=>N(!0),style:{padding:"6px 10px",borderRadius:6,background:"#f3f4f6",border:"1px solid #e6e7eb",cursor:"pointer"},"aria-label":"Configure Power Automate",children:"Configure"});if(Z.type==="action"){const lt=Z.id==="downloadHistoryCsv"&&D;return W.jsxs("button",{onClick:()=>{Z.id==="downloadHistoryCsv"&&L()},disabled:lt,style:{padding:"6px 10px",borderRadius:6,background:lt?"#e5e7eb":"#f3f4f6",border:"1px solid #e6e7eb",cursor:lt?"not-allowed":"pointer",display:"inline-flex",alignItems:"center",gap:6,fontSize:13},"aria-label":Z.label,children:[W.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[W.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("polyline",{points:"7 10 12 15 17 10",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),lt?"Downloading...":"Download"]})}if(Z.type==="image"){const lt=`file-${mt}`;return W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[W.jsx("input",{id:lt,type:"file",accept:"image/*",style:{display:"none"},onChange:at=>{const rt=at.target.files&&at.target.files[0];if(rt){const ct=new FileReader;ct.onload=()=>et(Z.id,ct.result),ct.readAsDataURL(rt)}},"aria-label":`Upload ${Z.label}`}),W.jsx("label",{htmlFor:lt,title:"Upload",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:6,background:"#f3f4f6",cursor:"pointer",border:"1px solid #e5e7eb",color:"#374151"},children:W.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[W.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("polyline",{points:"17 8 12 3 7 8",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]})}),W.jsx("button",{onClick:()=>et(Z.id,Z.defaultValue),style:{padding:"6px 8px",borderRadius:6},title:"Reset to default",children:"Reset"})]})}return Z.type==="number"?W.jsx("input",{type:"number",value:it??"",onChange:lt=>et(Z.id,lt.target.value===""?"":Number(lt.target.value)),style:{padding:"6px 8px",borderRadius:6,width:72,boxSizing:"border-box",border:"1px solid #e6e7eb",background:"#fff",boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.02)",transition:"box-shadow 120ms ease, border-color 120ms ease"},placeholder:Z.placeholderValue??"","aria-label":Z.label}):W.jsx("input",{type:"text",value:it??"",onChange:lt=>et(Z.id,lt.target.value),style:{padding:"6px 10px",borderRadius:6,border:"1px solid #e6e7eb",background:"#fff",boxShadow:"inset 0 0 0 1px rgba(0,0,0,0.02)",transition:"box-shadow 120ms ease, border-color 120ms ease",minWidth:0},placeholder:Z.placeholderValue??"","aria-label":Z.label})})()})]},Z.id)};return W.jsxs("div",{style:{display:"grid",gap:8},children:[Object.keys(tt).map(Z=>W.jsxs("div",{children:[W.jsx("h3",{style:{margin:"2px 0",fontSize:15,fontWeight:700,backgroundColor:"#eaeaea",padding:"2px 6px",borderRadius:6},children:W.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[W5[Z]&&W.jsx("span",{"aria-hidden":"true",style:{display:"inline-flex",width:16,height:16,alignItems:"center"},children:W5[Z]}),W.jsx("span",{children:Z})]})}),W.jsx("div",{style:{padding:8,border:"1px solid #f3f4f6",borderRadius:6,background:"#fafafa",display:"grid",gap:8},children:tt[Z].map(z)})]},Z)),$.map(z)]})};return W.jsxs("div",{className:"settings-placeholder",role:"region","aria-label":"Settings",style:{position:"relative"},children:[W.jsx("div",{className:"settings-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:W.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1,minWidth:0},children:[W.jsx("h2",{className:"text-2xl text-slate-800 font-bold tracking-tight",style:{margin:0,paddingLeft:12},children:"Settings"}),W.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Manage your workbook and user preferences"}),W.jsxs("div",{className:"studentview-tabs",role:"tablist","aria-label":"Settings tabs",style:{marginBottom:8},children:[W.jsx("button",{role:"tab","aria-selected":r==="workbook",onClick:()=>o("workbook"),className:`studentview-tab ${r==="workbook"?"active":""}`,children:"Workbook"}),W.jsx("button",{role:"tab","aria-selected":r==="user",onClick:()=>o("user"),className:`studentview-tab ${r==="user"?"active":""}`,children:"User"})]}),W.jsx("div",{role:"tabpanel","aria-labelledby":r,style:{marginTop:12,padding:12,border:"1px solid #e5e7eb",borderRadius:8,background:"#fff"},children:r==="workbook"?W.jsxs("div",{children:[W.jsxs("button",{type:"button",onClick:()=>w(!0),title:"Open workbook inspector","aria-label":"Open workbook inspector",style:{margin:"0 0 8px 0",padding:"4px 8px",borderRadius:6,background:"#f3f4f6",border:"1px solid #e6e7eb",cursor:"pointer",display:"inline-flex",alignItems:"center",gap:6,fontSize:15,fontWeight:700},children:[W.jsx("span",{children:"Workbook Settings"}),W.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[W.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),W.jsx("path",{d:"M14 2v6h6",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})]})]}),O(y1,u,B,"workbook-")]}):r==="user"?W.jsx("div",{children:W.jsx(jM,{accessToken:e})}):null})]})}),W.jsx(AM,{modalOpen:i,modalSetting:p,modalArray:f,setModalArray:g,closeModal:x,saveModal:k,workbookColumns:u.columns,masterListHeaders:G,newMasterListHeaders:U,blankColumns:R}),W.jsx(NM,{isOpen:v,onClose:()=>w(!1),docKey:A}),W.jsx(TM,{isOpen:S,onClose:()=>N(!1)})]})};function v6(n){const e=n.replace(/\r\n/g,`
`).split(`
`).filter(s=>s!=="");if(e.length===0)return[];const t=s=>{const a=[];let u="",l=!1;for(let i=0;i<s.length;i++){const c=s[i];c==='"'?l&&s[i+1]==='"'?(u+='"',i++):l=!l:c===","&&!l?(a.push(u),u=""):u+=c}return a.push(u),a},r=e.map(t),o=(r.shift()||[]).map(s=>s===void 0?"":s.trim());return r.map(s=>{const a={};return o.forEach((u,l)=>{a[u||`col${l+1}`]=s[l]!==void 0?s[l]:""}),a})}function fp(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var v1={exports:{}};var Y5;function LM(){return Y5||(Y5=1,(function(n,e){(function(t){n.exports=t()})((function(){return(function t(r,o,s){function a(i,c){if(!o[i]){if(!r[i]){var p=typeof fp=="function"&&fp;if(!c&&p)return p(i,!0);if(u)return u(i,!0);var h=new Error("Cannot find module '"+i+"'");throw h.code="MODULE_NOT_FOUND",h}var f=o[i]={exports:{}};r[i][0].call(f.exports,(function(g){return a(r[i][1][g]||g)}),f,f.exports,t,r,o,s)}return o[i].exports}for(var u=typeof fp=="function"&&fp,l=0;l<s.length;l++)a(s[l]);return a})({1:[function(t,r,o){const s=t("fs"),a=t("fast-csv"),u=t("dayjs/plugin/customParseFormat"),l=t("dayjs/plugin/utc"),i=t("dayjs").extend(u).extend(l),c=t("../utils/stream-buf"),{fs:{exists:p}}=t("../utils/utils"),h={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};r.exports=class{constructor(f){this.workbook=f,this.worksheet=null}async readFile(f,g){if(g=g||{},!await p(f))throw new Error("File not found: "+f);const y=s.createReadStream(f),b=await this.read(y,g);return y.close(),b}read(f,g){return g=g||{},new Promise((y,b)=>{const v=this.workbook.addWorksheet(g.sheetName),w=g.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],S=g.map||function(D){if(D==="")return null;const F=Number(D);if(!Number.isNaN(F)&&F!==1/0)return F;const G=w.reduce((U,q)=>{if(U)return U;const R=i(D,q,!0);return R.isValid()?R:null},null);if(G)return new Date(G.valueOf());const P=h[D];return P!==void 0?P:D},N=a.parse(g.parserOptions).on("data",D=>{v.addRow(D.map(S))}).on("end",()=>{N.emit("worksheet",v)});N.on("worksheet",y).on("error",b),f.pipe(N)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(f,g){return new Promise((y,b)=>{g=g||{};const v=this.workbook.getWorksheet(g.sheetName||g.sheetId),w=a.format(g.formatterOptions);f.on("finish",()=>{y()}),w.on("error",b),w.pipe(f);const{dateFormat:S,dateUTC:N}=g,D=g.map||(P=>{if(P){if(P.text||P.hyperlink)return P.hyperlink||P.text||"";if(P.formula||P.result)return P.result||"";if(P instanceof Date)return S?N?i.utc(P).format(S):i(P).format(S):N?i.utc(P).format():i(P).format();if(P.error)return P.error;if(typeof P=="object")return JSON.stringify(P)}return P}),F=g.includeEmptyRows===void 0||g.includeEmptyRows;let G=1;v&&v.eachRow((P,U)=>{if(F)for(;G++<U-1;)w.write([]);const{values:q}=P;q.shift(),w.write(q.map(D)),G=U}),w.end()})}writeFile(f,g){const y={encoding:(g=g||{}).encoding||"utf8"},b=s.createWriteStream(f,y);return this.write(b,g)}async writeBuffer(f){const g=new c;return await this.write(g,f),g.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(t,r,o){const s=t("../utils/col-cache");class a{constructor(l,i){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=l,i)if(typeof i=="string"){const p=s.decodeAddress(i);this.nativeCol=p.col+c,this.nativeColOff=0,this.nativeRow=p.row+c,this.nativeRowOff=0}else i.nativeCol!==void 0?(this.nativeCol=i.nativeCol||0,this.nativeColOff=i.nativeColOff||0,this.nativeRow=i.nativeRow||0,this.nativeRowOff=i.nativeRowOff||0):i.col!==void 0?(this.col=i.col+c,this.row=i.row+c):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(l){return l instanceof a||l==null?l:new a(l)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(l){this.nativeCol=Math.floor(l),this.nativeColOff=Math.floor((l-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(l){this.nativeRow=Math.floor(l),this.nativeRowOff=Math.floor((l-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(l){this.nativeCol=l.nativeCol,this.nativeColOff=l.nativeColOff,this.nativeRow=l.nativeRow,this.nativeRowOff=l.nativeRowOff}}r.exports=a},{"../utils/col-cache":19}],3:[function(t,r,o){const s=t("../utils/col-cache"),a=t("../utils/under-dash"),u=t("./enums"),{slideFormula:l}=t("../utils/shared-formula"),i=t("./note");class c{constructor(f,g,y){if(!f||!g)throw new Error("A Cell needs a Row");this._row=f,this._column=g,s.validateAddress(y),this._address=y,this._value=p.create(c.Types.Null,this),this.style=this._mergeStyle(f.style,g.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(f){this.style.numFmt=f}get font(){return this.style.font}set font(f){this.style.font=f}get alignment(){return this.style.alignment}set alignment(f){this.style.alignment=f}get border(){return this.style.border}set border(f){this.style.border=f}get fill(){return this.style.fill}set fill(f){this.style.fill=f}get protection(){return this.style.protection}set protection(f){this.style.protection=f}_mergeStyle(f,g,y){const b=f&&f.numFmt||g&&g.numFmt;b&&(y.numFmt=b);const v=f&&f.font||g&&g.font;v&&(y.font=v);const w=f&&f.alignment||g&&g.alignment;w&&(y.alignment=w);const S=f&&f.border||g&&g.border;S&&(y.border=S);const N=f&&f.fill||g&&g.fill;N&&(y.fill=N);const D=f&&f.protection||g&&g.protection;return D&&(y.protection=D),y}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===c.Types.Merge}merge(f,g){this._value.release(),this._value=p.create(c.Types.Merge,this,f),g||(this.style=f.style)}unmerge(){this.type===c.Types.Merge&&(this._value.release(),this._value=p.create(c.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(f){return this._value.type===c.Types.Merge&&this._value.isMergedTo(f)}get master(){return this.type===c.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===c.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(f){this.type!==c.Types.Merge?(this._value.release(),this._value=p.create(p.getType(f),this,f)):this._value.master.value=f}get note(){return this._comment&&this._comment.note}set note(f){this._comment=new i(f)}get text(){return this._value.toString()}get html(){return a.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(f){this.type===c.Types.String&&(this._value=p.create(c.Types.Hyperlink,this,{text:this._value.value,hyperlink:f}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:f}=this._row;return{sheetName:f.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(f){this.names=[f]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(f){const{definedNames:g}=this.workbook;g.removeAllNames(this.fullAddress),f.forEach(y=>{g.addEx(this.fullAddress,y)})}addName(f){this.workbook.definedNames.addEx(this.fullAddress,f)}removeName(f){this.workbook.definedNames.removeEx(this.fullAddress,f)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(f){this._dataValidations.add(this.address,f)}get model(){const{model:f}=this._value;return f.style=this.style,this._comment&&(f.comment=this._comment.model),f}set model(f){if(this._value.release(),this._value=p.create(f.type,this),this._value.model=f,f.comment)switch(f.comment.type){case"note":this._comment=i.fromModel(f.comment)}f.style?this.style=f.style:this.style={}}}c.Types=u.ValueType;const p={getType:h=>h==null?c.Types.Null:h instanceof String||typeof h=="string"?c.Types.String:typeof h=="number"?c.Types.Number:typeof h=="boolean"?c.Types.Boolean:h instanceof Date?c.Types.Date:h.text&&h.hyperlink?c.Types.Hyperlink:h.formula||h.sharedFormula?c.Types.Formula:h.richText?c.Types.RichText:h.sharedString?c.Types.SharedString:h.error?c.Types.Error:c.Types.JSON,types:[{t:c.Types.Null,f:class{constructor(h){this.model={address:h.address,type:c.Types.Null}}get value(){return null}set value(h){}get type(){return c.Types.Null}get effectiveType(){return c.Types.Null}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return""}release(){}toString(){return""}}},{t:c.Types.Number,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Number,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.Number}get effectiveType(){return c.Types.Number}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:c.Types.String,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.String,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.String}get effectiveType(){return c.Types.String}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:c.Types.Date,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Date,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.Date}get effectiveType(){return c.Types.Date}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:c.Types.Hyperlink,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Hyperlink,text:f?f.text:void 0,hyperlink:f?f.hyperlink:void 0},f&&f.tooltip&&(this.model.tooltip=f.tooltip)}get value(){const h={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(h.tooltip=this.model.tooltip),h}set value(h){this.model={text:h.text,hyperlink:h.hyperlink},h.tooltip&&(this.model.tooltip=h.tooltip)}get text(){return this.model.text}set text(h){this.model.text=h}get hyperlink(){return this.model.hyperlink}set hyperlink(h){this.model.hyperlink=h}get type(){return c.Types.Hyperlink}get effectiveType(){return c.Types.Hyperlink}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:c.Types.Formula,f:class{constructor(h,f){this.cell=h,this.model={address:h.address,type:c.Types.Formula,shareType:f?f.shareType:void 0,ref:f?f.ref:void 0,formula:f?f.formula:void 0,sharedFormula:f?f.sharedFormula:void 0,result:f?f.result:void 0}}_copyModel(h){const f={},g=y=>{const b=h[y];b&&(f[y]=b)};return g("formula"),g("result"),g("ref"),g("shareType"),g("sharedFormula"),f}get value(){return this._copyModel(this.model)}set value(h){this.model=this._copyModel(h)}validate(h){switch(p.getType(h)){case c.Types.Null:case c.Types.String:case c.Types.Number:case c.Types.Date:break;case c.Types.Hyperlink:case c.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(h){this.model.formula=h}get formulaType(){return this.model.formula?u.FormulaType.Master:this.model.sharedFormula?u.FormulaType.Shared:u.FormulaType.None}get result(){return this.model.result}set result(h){this.model.result=h}get type(){return c.Types.Formula}get effectiveType(){const h=this.model.result;return h==null?u.ValueType.Null:h instanceof String||typeof h=="string"?u.ValueType.String:typeof h=="number"?u.ValueType.Number:h instanceof Date?u.ValueType.Date:h.text&&h.hyperlink?u.ValueType.Hyperlink:h.formula?u.ValueType.Formula:u.ValueType.Null}get address(){return this.model.address}set address(h){this.model.address=h}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:h}=this.cell,f=h.findCell(this.model.sharedFormula);this._translatedFormula=f&&l(f.formula,f.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:c.Types.Merge,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Merge,master:f?f.address:void 0},this._master=f,f&&f.addMergeRef()}get value(){return this._master.value}set value(h){h instanceof c?(this._master&&this._master.releaseMergeRef(),h.addMergeRef(),this._master=h):this._master.value=h}isMergedTo(h){return h===this._master}get master(){return this._master}get type(){return c.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:c.Types.JSON,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.String,value:JSON.stringify(f),rawValue:f}}get value(){return this.model.rawValue}set value(h){this.model.rawValue=h,this.model.value=JSON.stringify(h)}get type(){return c.Types.String}get effectiveType(){return c.Types.String}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:c.Types.SharedString,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.SharedString,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.SharedString}get effectiveType(){return c.Types.SharedString}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:c.Types.RichText,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.String,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}toString(){return this.model.value.richText.map(h=>h.text).join("")}get type(){return c.Types.RichText}get effectiveType(){return c.Types.RichText}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:c.Types.Boolean,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Boolean,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.Boolean}get effectiveType(){return c.Types.Boolean}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:c.Types.Error,f:class{constructor(h,f){this.model={address:h.address,type:c.Types.Error,value:f}}get value(){return this.model.value}set value(h){this.model.value=h}get type(){return c.Types.Error}get effectiveType(){return c.Types.Error}get address(){return this.model.address}set address(h){this.model.address=h}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((h,f)=>(h[f.t]=f.f,h),[]),create(h,f,g){const y=this.types[h];if(!y)throw new Error("Could not create Value of type "+h);return new y(f,g)}};r.exports=c},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(t,r,o){const s=t("../utils/under-dash"),a=t("./enums"),u=t("../utils/col-cache");class l{constructor(c,p,h){this._worksheet=c,this._number=p,h!==!1&&(this.defn=h)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return u.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(c){c?(this.key=c.key,this.width=c.width!==void 0?c.width:9,this.outlineLevel=c.outlineLevel,c.style?this.style=c.style:this.style={},this.header=c.header,this._hidden=!!c.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(c){c!==void 0?(this._header=c,this.headers.forEach((p,h)=>{this._worksheet.getCell(h+1,this.number).value=p})):this._header=void 0}get key(){return this._key}set key(c){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=c,c&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(c){this._hidden=c}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(c){this._outlineLevel=c}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(c){return this.width===c.width&&this.hidden===c.hidden&&this.outlineLevel===c.outlineLevel&&s.isEqual(this.style,c.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const c=this.style;return!c||!(c.font||c.numFmt||c.alignment||c.border||c.fill||c.protection)}get headerCount(){return this.headers.length}eachCell(c,p){const h=this.number;p||(p=c,c=null),this._worksheet.eachRow(c,(f,g)=>{p(f.getCell(h),g)})}get values(){const c=[];return this.eachCell((p,h)=>{p&&p.type!==a.ValueType.Null&&(c[h]=p.value)}),c}set values(c){if(!c)return;const p=this.number;let h=0;c.hasOwnProperty("0")&&(h=1),c.forEach((f,g)=>{this._worksheet.getCell(g+h,p).value=f})}_applyStyle(c,p){return this.style[c]=p,this.eachCell(h=>{h[c]=p}),p}get numFmt(){return this.style.numFmt}set numFmt(c){this._applyStyle("numFmt",c)}get font(){return this.style.font}set font(c){this._applyStyle("font",c)}get alignment(){return this.style.alignment}set alignment(c){this._applyStyle("alignment",c)}get protection(){return this.style.protection}set protection(c){this._applyStyle("protection",c)}get border(){return this.style.border}set border(c){this._applyStyle("border",c)}get fill(){return this.style.fill}set fill(c){this._applyStyle("fill",c)}static toModel(c){const p=[];let h=null;return c&&c.forEach((f,g)=>{f.isDefault?h&&(h=null):h&&f.equivalentTo(h)?h.max=g+1:(h={min:g+1,max:g+1,width:f.width!==void 0?f.width:9,style:f.style,isCustomWidth:f.isCustomWidth,hidden:f.hidden,outlineLevel:f.outlineLevel,collapsed:f.collapsed},p.push(h))}),p.length?p:void 0}static fromModel(c,p){const h=[];let f=1,g=0;for(p=(p=p||[]).sort((function(y,b){return y.min-b.min}));g<p.length;){const y=p[g++];for(;f<y.min;)h.push(new l(c,f++));for(;f<=y.max;)h.push(new l(c,f++,y))}return h.length?h:null}}r.exports=l},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(t,r,o){r.exports=class{constructor(s){this.model=s||{}}add(s,a){return this.model[s]=a}find(s){return this.model[s]}remove(s){this.model[s]=void 0}}},{}],6:[function(t,r,o){const s=t("../utils/under-dash"),a=t("../utils/col-cache"),u=t("../utils/cell-matrix"),l=t("./range"),i=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;r.exports=class{constructor(){this.matrixMap={}}getMatrix(c){return this.matrixMap[c]||(this.matrixMap[c]=new u)}add(c,p){const h=a.decodeEx(c);this.addEx(h,p)}addEx(c,p){const h=this.getMatrix(p);if(c.top)for(let f=c.left;f<=c.right;f++)for(let g=c.top;g<=c.bottom;g++){const y={sheetName:c.sheetName,address:a.n2l(f)+g,row:g,col:f};h.addCellEx(y)}else h.addCellEx(c)}remove(c,p){const h=a.decodeEx(c);this.removeEx(h,p)}removeEx(c,p){this.getMatrix(p).removeCellEx(c)}removeAllNames(c){s.each(this.matrixMap,p=>{p.removeCellEx(c)})}forEach(c){s.each(this.matrixMap,(p,h)=>{p.forEach(f=>{c(h,f)})})}getNames(c){return this.getNamesEx(a.decodeEx(c))}getNamesEx(c){return s.map(this.matrixMap,(p,h)=>p.findCellEx(c)&&h).filter(Boolean)}_explore(c,p){p.mark=!1;const{sheetName:h}=p,f=new l(p.row,p.col,p.row,p.col,h);let g,y;function b(w,S){const N=c.findCellAt(h,w,p.col);return!(!N||!N.mark)&&(f[S]=w,N.mark=!1,!0)}for(y=p.row-1;b(y,"top");y--);for(y=p.row+1;b(y,"bottom");y++);function v(w,S){const N=[];for(y=f.top;y<=f.bottom;y++){const D=c.findCellAt(h,y,w);if(!D||!D.mark)return!1;N.push(D)}f[S]=w;for(let D=0;D<N.length;D++)N[D].mark=!1;return!0}for(g=p.col-1;v(g,"left");g--);for(g=p.col+1;v(g,"right");g++);return f}getRanges(c,p){return(p=p||this.matrixMap[c])?(p.forEach(h=>{h.mark=!0}),{name:c,ranges:p.map(h=>h.mark&&this._explore(p,h)).filter(Boolean).map(h=>h.$shortRange)}):{name:c,ranges:[]}}normaliseMatrix(c,p){c.forEachInSheet(p,(h,f,g)=>{h&&(h.row===f&&h.col===g||(h.row=f,h.col=g,h.address=a.n2l(g)+f))})}spliceRows(c,p,h,f){s.each(this.matrixMap,g=>{g.spliceRows(c,p,h,f),this.normaliseMatrix(g,c)})}spliceColumns(c,p,h,f){s.each(this.matrixMap,g=>{g.spliceColumns(c,p,h,f),this.normaliseMatrix(g,c)})}get model(){return s.map(this.matrixMap,(c,p)=>this.getRanges(p,c)).filter(c=>c.ranges.length)}set model(c){const p=this.matrixMap={};c.forEach(h=>{const f=p[h.name]=new u;h.ranges.forEach(g=>{i.test(g.split("!").pop()||"")&&f.addCell(g)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(t,r,o){r.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(t,r,o){const s=t("../utils/col-cache"),a=t("./anchor");r.exports=class{constructor(u,l){this.worksheet=u,this.model=l}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(u){let{type:l,imageId:i,range:c,hyperlinks:p}=u;if(this.type=l,this.imageId=i,l==="image")if(typeof c=="string"){const h=s.decode(c);this.range={tl:new a(this.worksheet,{col:h.left,row:h.top},-1),br:new a(this.worksheet,{col:h.right,row:h.bottom},0),editAs:"oneCell"}}else this.range={tl:new a(this.worksheet,c.tl,0),br:c.br&&new a(this.worksheet,c.br,0),ext:c.ext,editAs:c.editAs,hyperlinks:p||c.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(t,r,o){const s=t("../utils/under-dash");class a{constructor(l){this.note=l}get model(){let l=null;switch(typeof this.note){case"string":l={type:"note",note:{texts:[{text:this.note}]}};break;default:l={type:"note",note:this.note}}return s.deepMerge({},a.DEFAULT_CONFIGS,l)}set model(l){const{note:i}=l,{texts:c}=i;c.length===1&&Object.keys(c[0]).length===1?this.note=c[0].text:this.note=i}static fromModel(l){const i=new a;return i.model=l,i}}a.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},r.exports=a},{"../utils/under-dash":26}],10:[function(t,r,o){const s=t("../utils/col-cache");class a{constructor(){this.decode(arguments)}setTLBR(l,i,c,p,h){if(arguments.length<4){const f=s.decodeAddress(l),g=s.decodeAddress(i);this.model={top:Math.min(f.row,g.row),left:Math.min(f.col,g.col),bottom:Math.max(f.row,g.row),right:Math.max(f.col,g.col),sheetName:c},this.setTLBR(f.row,f.col,g.row,g.col,h)}else this.model={top:Math.min(l,c),left:Math.min(i,p),bottom:Math.max(l,c),right:Math.max(i,p),sheetName:h}}decode(l){switch(l.length){case 5:this.setTLBR(l[0],l[1],l[2],l[3],l[4]);break;case 4:this.setTLBR(l[0],l[1],l[2],l[3]);break;case 3:this.setTLBR(l[0],l[1],l[2]);break;case 2:this.setTLBR(l[0],l[1]);break;case 1:{const i=l[0];if(i instanceof a)this.model={top:i.model.top,left:i.model.left,bottom:i.model.bottom,right:i.model.right,sheetName:i.sheetName};else if(i instanceof Array)this.decode(i);else if(i.top&&i.left&&i.bottom&&i.right)this.model={top:i.top,left:i.left,bottom:i.bottom,right:i.right,sheetName:i.sheetName};else{const c=s.decodeEx(i);c.top?this.model={top:c.top,left:c.left,bottom:c.bottom,right:c.right,sheetName:c.sheetName}:this.model={top:c.row,left:c.col,bottom:c.row,right:c.col,sheetName:c.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+l.length)}}get top(){return this.model.top||1}set top(l){this.model.top=l}get left(){return this.model.left||1}set left(l){this.model.left=l}get bottom(){return this.model.bottom||1}set bottom(l){this.model.bottom=l}get right(){return this.model.right||1}set right(l){this.model.right=l}get sheetName(){return this.model.sheetName}set sheetName(l){this.model.sheetName=l}get _serialisedSheetName(){const{sheetName:l}=this.model;return l?/^[a-zA-Z0-9]*$/.test(l)?l+"!":`'${l}'!`:""}expand(l,i,c,p){(!this.model.top||l<this.top)&&(this.top=l),(!this.model.left||i<this.left)&&(this.left=i),(!this.model.bottom||c>this.bottom)&&(this.bottom=c),(!this.model.right||p>this.right)&&(this.right=p)}expandRow(l){if(l){const{dimensions:i,number:c}=l;i&&this.expand(c,i.min,c,i.max)}}expandToAddress(l){const i=s.decodeEx(l);this.expand(i.row,i.col,i.row,i.col)}get tl(){return s.n2l(this.left)+this.top}get $t$l(){return`$${s.n2l(this.left)}$${this.top}`}get br(){return s.n2l(this.right)+this.bottom}get $b$r(){return`$${s.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(l){return(!l.sheetName||!this.sheetName||l.sheetName===this.sheetName)&&!(l.bottom<this.top)&&!(l.top>this.bottom)&&!(l.right<this.left)&&!(l.left>this.right)}contains(l){const i=s.decodeEx(l);return this.containsEx(i)}containsEx(l){return(!l.sheetName||!this.sheetName||l.sheetName===this.sheetName)&&l.row>=this.top&&l.row<=this.bottom&&l.col>=this.left&&l.col<=this.right}forEachAddress(l){for(let i=this.left;i<=this.right;i++)for(let c=this.top;c<=this.bottom;c++)l(s.encodeAddress(c,i),c,i)}}r.exports=a},{"../utils/col-cache":19}],11:[function(t,r,o){const s=t("../utils/under-dash"),a=t("./enums"),u=t("../utils/col-cache"),l=t("./cell");r.exports=class{constructor(i,c){this._worksheet=i,this._number=c,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(i){return this._cells[i-1]}getCellEx(i){let c=this._cells[i.col-1];if(!c){const p=this._worksheet.getColumn(i.col);c=new l(this,p,i.address),this._cells[i.col-1]=c}return c}getCell(i){if(typeof i=="string"){const c=this._worksheet.getColumnKey(i);i=c?c.number:u.l2n(i)}return this._cells[i-1]||this.getCellEx({address:u.encodeAddress(this._number,i),row:this._number,col:i})}splice(i,c){const p=i+c;for(var h=arguments.length,f=new Array(h>2?h-2:0),g=2;g<h;g++)f[g-2]=arguments[g];const y=f.length-c,b=this._cells.length;let v,w,S;if(y<0)for(v=i+f.length;v<=b;v++)S=this._cells[v-1],w=this._cells[v-y-1],w?(S=this.getCell(v),S.value=w.value,S.style=w.style,S._comment=w._comment):S&&(S.value=null,S.style={},S._comment=void 0);else if(y>0)for(v=b;v>=p;v--)w=this._cells[v-1],w?(S=this.getCell(v+y),S.value=w.value,S.style=w.style,S._comment=w._comment):this._cells[v+y-1]=void 0;for(v=0;v<f.length;v++)S=this.getCell(i+v),S.value=f[v],S.style={},S._comment=void 0}eachCell(i,c){if(c||(c=i,i=null),i&&i.includeEmpty){const p=this._cells.length;for(let h=1;h<=p;h++)c(this.getCell(h),h)}else this._cells.forEach((p,h)=>{p&&p.type!==a.ValueType.Null&&c(p,h+1)})}addPageBreak(i,c){const p=this._worksheet,h=Math.max(0,i-1)||0,f=Math.max(0,c-1)||16838,g={id:this._number,max:f,man:1};h&&(g.min=h),p.rowBreaks.push(g)}get values(){const i=[];return this._cells.forEach(c=>{c&&c.type!==a.ValueType.Null&&(i[c.col]=c.value)}),i}set values(i){if(this._cells=[],i)if(i instanceof Array){let c=0;i.hasOwnProperty("0")&&(c=1),i.forEach((p,h)=>{p!==void 0&&(this.getCellEx({address:u.encodeAddress(this._number,h+c),row:this._number,col:h+c}).value=p)})}else this._worksheet.eachColumnKey((c,p)=>{i[p]!==void 0&&(this.getCellEx({address:u.encodeAddress(this._number,c.number),row:this._number,col:c.number}).value=i[p])})}get hasValues(){return s.some(this._cells,i=>i&&i.type!==a.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let i=0;return this.eachCell(()=>{i++}),i}get dimensions(){let i=0,c=0;return this._cells.forEach(p=>{p&&p.type!==a.ValueType.Null&&((!i||i>p.col)&&(i=p.col),c<p.col&&(c=p.col))}),i>0?{min:i,max:c}:null}_applyStyle(i,c){return this.style[i]=c,this._cells.forEach(p=>{p&&(p[i]=c)}),c}get numFmt(){return this.style.numFmt}set numFmt(i){this._applyStyle("numFmt",i)}get font(){return this.style.font}set font(i){this._applyStyle("font",i)}get alignment(){return this.style.alignment}set alignment(i){this._applyStyle("alignment",i)}get protection(){return this.style.protection}set protection(i){this._applyStyle("protection",i)}get border(){return this.style.border}set border(i){this._applyStyle("border",i)}get fill(){return this.style.fill}set fill(i){this._applyStyle("fill",i)}get hidden(){return!!this._hidden}set hidden(i){this._hidden=i}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(i){this._outlineLevel=i}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const i=[];let c=0,p=0;return this._cells.forEach(h=>{if(h){const f=h.model;f&&((!c||c>h.col)&&(c=h.col),p<h.col&&(p=h.col),i.push(f))}}),this.height||i.length?{cells:i,number:this.number,min:c,max:p,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(i){if(i.number!==this._number)throw new Error("Invalid row number in model");let c;this._cells=[],i.cells.forEach(p=>{switch(p.type){case l.Types.Merge:break;default:{let h;if(p.address)h=u.decodeAddress(p.address);else if(c){const{row:f}=c,g=c.col+1;h={row:f,col:g,address:u.encodeAddress(f,g),$col$row:`$${u.n2l(g)}$${f}`}}c=h,this.getCellEx(h).model=p;break}}}),i.height?this.height=i.height:delete this.height,this.hidden=i.hidden,this.outlineLevel=i.outlineLevel||0,this.style=i.style&&JSON.parse(JSON.stringify(i.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(t,r,o){const s=t("../utils/col-cache");class a{constructor(l,i,c){this.table=l,this.column=i,this.index=c}_set(l,i){this.table.cacheState(),this.column[l]=i}get name(){return this.column.name}set name(l){this._set("name",l)}get filterButton(){return this.column.filterButton}set filterButton(l){this.column.filterButton=l}get style(){return this.column.style}set style(l){this.column.style=l}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(l){this._set("totalsRowLabel",l)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(l){this._set("totalsRowFunction",l)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(l){this._set("totalsRowResult",l)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(l){this._set("totalsRowFormula",l)}}r.exports=class{constructor(u,l){this.worksheet=u,l&&(this.table=l,this.validate(),this.store())}getFormula(u){switch(u.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${u.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${u.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${u.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${u.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${u.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${u.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${u.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${u.name}])`;case"custom":return u.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+u.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:u}=this,l=(y,b,v)=>{y[b]===void 0&&(y[b]=v)};l(u,"headerRow",!0),l(u,"totalsRow",!1),l(u,"style",{}),l(u.style,"theme","TableStyleMedium2"),l(u.style,"showFirstColumn",!1),l(u.style,"showLastColumn",!1),l(u.style,"showRowStripes",!1),l(u.style,"showColumnStripes",!1);const i=(y,b)=>{if(!y)throw new Error(b)};i(u.ref,"Table must have ref"),i(u.columns,"Table must have column definitions"),i(u.rows,"Table must have row definitions"),u.tl=s.decodeAddress(u.ref);const{row:c,col:p}=u.tl;i(c>0,"Table must be on valid row"),i(p>0,"Table must be on valid col");const{width:h,filterHeight:f,tableHeight:g}=this;u.autoFilterRef=s.encode(c,p,c+f-1,p+h-1),u.tableRef=s.encode(c,p,c+g-1,p+h-1),u.columns.forEach((y,b)=>{i(y.name,`Column ${b} must have a name`),b===0?l(y,"totalsRowLabel","Total"):(l(y,"totalsRowFunction","none"),y.totalsRowFormula=this.getFormula(y))})}store(){const u=(f,g)=>{g&&Object.keys(g).forEach(y=>{f[y]=g[y]})},{worksheet:l,table:i}=this,{row:c,col:p}=i.tl;let h=0;if(i.headerRow){const f=l.getRow(c+h++);i.columns.forEach((g,y)=>{const{style:b,name:v}=g,w=f.getCell(p+y);w.value=v,u(w,b)})}if(i.rows.forEach(f=>{const g=l.getRow(c+h++);f.forEach((y,b)=>{const v=g.getCell(p+b);v.value=y,u(v,i.columns[b].style)})}),i.totalsRow){const f=l.getRow(c+h++);i.columns.forEach((g,y)=>{const b=f.getCell(p+y);if(y===0)b.value=g.totalsRowLabel;else{const v=this.getFormula(g);b.value=v?{formula:g.totalsRowFormula,result:g.totalsRowResult}:null}u(b,g.style)})}}load(u){const{table:l}=this,{row:i,col:c}=l.tl;let p=0;if(l.headerRow){const h=u.getRow(i+p++);l.columns.forEach((f,g)=>{h.getCell(c+g).value=f.name})}if(l.rows.forEach(h=>{const f=u.getRow(i+p++);h.forEach((g,y)=>{f.getCell(c+y).value=g})}),l.totalsRow){const h=u.getRow(i+p++);l.columns.forEach((f,g)=>{const y=h.getCell(c+g);g===0?y.value=f.totalsRowLabel:this.getFormula(f)&&(y.value={formula:f.totalsRowFormula,result:f.totalsRowResult})})}}get model(){return this.table}set model(u){this.table=u}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const u=s.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let l=0;l<this._cache.tableHeight;l++){const i=this.worksheet.getRow(u.row+l);for(let c=0;c<this._cache.width;c++)i.getCell(u.col+c).value=null}else{for(let l=this.tableHeight;l<this._cache.tableHeight;l++){const i=this.worksheet.getRow(u.row+l);for(let c=0;c<this._cache.width;c++)i.getCell(u.col+c).value=null}for(let l=0;l<this.tableHeight;l++){const i=this.worksheet.getRow(u.row+l);for(let c=this.width;c<this._cache.width;c++)i.getCell(u.col+c).value=null}}this.store()}addRow(u,l){this.cacheState(),l===void 0?this.table.rows.push(u):this.table.rows.splice(l,0,u)}removeRows(u){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(u,l)}getColumn(u){const l=this.table.columns[u];return new a(this,l,u)}addColumn(u,l,i){this.cacheState(),i===void 0?(this.table.columns.push(u),this.table.rows.forEach((c,p)=>{c.push(l[p])})):(this.table.columns.splice(i,0,u),this.table.rows.forEach((c,p)=>{c.splice(i,0,l[p])}))}removeColumns(u){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(u,l),this.table.rows.forEach(i=>{i.splice(u,l)})}_assign(u,l,i){this.cacheState(),u[l]=i}get ref(){return this.table.ref}set ref(u){this._assign(this.table,"ref",u)}get name(){return this.table.name}set name(u){this.table.name=u}get displayName(){return this.table.displyName||this.table.name}set displayNamename(u){this.table.displayName=u}get headerRow(){return this.table.headerRow}set headerRow(u){this._assign(this.table,"headerRow",u)}get totalsRow(){return this.table.totalsRow}set totalsRow(u){this._assign(this.table,"totalsRow",u)}get theme(){return this.table.style.name}set theme(u){this.table.style.name=u}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(u){this.table.style.showFirstColumn=u}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(u){this.table.style.showLastColumn=u}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(u){this.table.style.showRowStripes=u}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(u){this.table.style.showColumnStripes=u}}},{"../utils/col-cache":19}],13:[function(t,r,o){const s=t("./worksheet"),a=t("./defined-names"),u=t("../xlsx/xlsx"),l=t("../csv/csv");r.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new a}get xlsx(){return this._xlsx||(this._xlsx=new u(this)),this._xlsx}get csv(){return this._csv||(this._csv=new l(this)),this._csv}get nextId(){for(let i=1;i<this._worksheets.length;i++)if(!this._worksheets[i])return i;return this._worksheets.length||1}addWorksheet(i,c){const p=this.nextId;c&&(typeof c=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),c={properties:{tabColor:{argb:c}}}):(c.argb||c.theme||c.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),c={properties:{tabColor:c}}));const h=this._worksheets.reduce((y,b)=>(b&&b.orderNo)>y?b.orderNo:y,0),f=Object.assign({},c,{id:p,name:i,orderNo:h+1,workbook:this}),g=new s(f);return this._worksheets[p]=g,g}removeWorksheetEx(i){delete this._worksheets[i.id]}removeWorksheet(i){const c=this.getWorksheet(i);c&&c.destroy()}getWorksheet(i){return i===void 0?this._worksheets.find(Boolean):typeof i=="number"?this._worksheets[i]:typeof i=="string"?this._worksheets.find(c=>c&&c.name===i):void 0}get worksheets(){return this._worksheets.slice(1).sort((i,c)=>i.orderNo-c.orderNo).filter(Boolean)}eachSheet(i){this.worksheets.forEach(c=>{i(c,c.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(i){const c=this.media.length;return this.media.push(Object.assign({},i,{type:"image"})),c}getImage(i){return this.media[i]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(i=>i.model),sheets:this.worksheets.map(i=>i.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(i){this.creator=i.creator,this.lastModifiedBy=i.lastModifiedBy,this.lastPrinted=i.lastPrinted,this.created=i.created,this.modified=i.modified,this.company=i.company,this.manager=i.manager,this.title=i.title,this.subject=i.subject,this.keywords=i.keywords,this.category=i.category,this.description=i.description,this.language=i.language,this.revision=i.revision,this.contentStatus=i.contentStatus,this.properties=i.properties,this.calcProperties=i.calcProperties,this._worksheets=[],i.worksheets.forEach(c=>{const{id:p,name:h,state:f}=c,g=i.sheets&&i.sheets.findIndex(y=>y.id===p);(this._worksheets[p]=new s({id:p,name:h,orderNo:g,state:f,workbook:this})).model=c}),this._definedNames.model=i.definedNames,this.views=i.views,this._themes=i.themes,this.media=i.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(t,r,o){const s=t("../utils/under-dash"),a=t("../utils/col-cache"),u=t("./range"),l=t("./row"),i=t("./column"),c=t("./enums"),p=t("./image"),h=t("./table"),f=t("./data-validations"),g=t("../utils/encryptor"),{copyStyle:y}=t("../utils/copy-style");r.exports=class{constructor(b){b=b||{},this._workbook=b.workbook,this.id=b.id,this.orderNo=b.orderNo,this.name=b.name,this.state=b.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},b.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!b.pageSetup||!b.pageSetup.fitToWidth&&!b.pageSetup.fitToHeight||b.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},b.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},b.headerFooter),this.dataValidations=new f,this.views=b.views||[],this.autoFilter=b.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(b){if(b===void 0&&(b="sheet"+this.id),this._name!==b){if(typeof b!="string")throw new Error("The name has to be a string.");if(b==="")throw new Error("The name can't be empty.");if(b==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(b))throw new Error(`Worksheet name ${b} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(b))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+b);if(b&&b.length>31&&(console.warn(`Worksheet name ${b} exceeds 31 chars. This will be truncated`),b=b.substring(0,31)),this._workbook._worksheets.find(v=>v&&v.name.toLowerCase()===b.toLowerCase()))throw new Error("Worksheet name already exists: "+b);this._name=b}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const b=new u;return this._rows.forEach(v=>{if(v){const w=v.dimensions;w&&b.expand(v.number,w.min,v.number,w.max)}}),b}get columns(){return this._columns}set columns(b){this._headerRowCount=b.reduce((S,N)=>{const D=(N.header?1:N.headers&&N.headers.length)||0;return Math.max(S,D)},0);let v=1;const w=this._columns=[];b.forEach(S=>{const N=new i(this,v++,!1);w.push(N),N.defn=S})}getColumnKey(b){return this._keys[b]}setColumnKey(b,v){this._keys[b]=v}deleteColumnKey(b){delete this._keys[b]}eachColumnKey(b){s.each(this._keys,b)}getColumn(b){if(typeof b=="string"){const v=this._keys[b];if(v)return v;b=a.l2n(b)}if(this._columns||(this._columns=[]),b>this._columns.length){let v=this._columns.length+1;for(;v<=b;)this._columns.push(new i(this,v++))}return this._columns[b-1]}spliceColumns(b,v){const w=this._rows.length;for(var S=arguments.length,N=new Array(S>2?S-2:0),D=2;D<S;D++)N[D-2]=arguments[D];if(N.length>0)for(let U=0;U<w;U++){const q=[b,v];N.forEach(I=>{q.push(I[U]||null)});const R=this.getRow(U+1);R.splice.apply(R,q)}else this._rows.forEach(U=>{U&&U.splice(b,v)});const F=N.length-v,G=b+v,P=this._columns.length;if(F<0)for(let U=b+N.length;U<=P;U++)this.getColumn(U).defn=this.getColumn(U-F).defn;else if(F>0)for(let U=P;U>=G;U--)this.getColumn(U+F).defn=this.getColumn(U).defn;for(let U=b;U<b+N.length;U++)this.getColumn(U).defn=null;this.workbook.definedNames.spliceColumns(this.name,b,v,N.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let b=0;return this.eachRow(v=>{b=Math.max(b,v.cellCount)}),b}get actualColumnCount(){const b=[];let v=0;return this.eachRow(w=>{w.eachCell(S=>{let{col:N}=S;b[N]||(b[N]=!0,v++)})}),v}_commitRow(){}get _lastRowNumber(){const b=this._rows;let v=b.length;for(;v>0&&b[v-1]===void 0;)v--;return v}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(b){return this._rows[b-1]}findRows(b,v){return this._rows.slice(b-1,b-1+v)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let b=0;return this.eachRow(()=>{b++}),b}getRow(b){let v=this._rows[b-1];return v||(v=this._rows[b-1]=new l(this,b)),v}getRows(b,v){if(v<1)return;const w=[];for(let S=b;S<b+v;S++)w.push(this.getRow(S));return w}addRow(b){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const w=this._nextRow,S=this.getRow(w);return S.values=b,this._setStyleOption(w,v[0]==="i"?v:"n"),S}addRows(b){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const w=[];return b.forEach(S=>{w.push(this.addRow(S,v))}),w}insertRow(b,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(b,0,v),this._setStyleOption(b,w),this.getRow(b)}insertRows(b,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(b,0,...v),w!=="n")for(let S=0;S<v.length;S++)w[0]==="o"&&this.findRow(v.length+b+S)!==void 0?this._copyStyle(v.length+b+S,b+S,w[1]==="+"):w[0]==="i"&&this.findRow(b-1)!==void 0&&this._copyStyle(b-1,b+S,w[1]==="+");return this.getRows(b,v.length)}_setStyleOption(b){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";v[0]==="o"&&this.findRow(b+1)!==void 0?this._copyStyle(b+1,b,v[1]==="+"):v[0]==="i"&&this.findRow(b-1)!==void 0&&this._copyStyle(b-1,b,v[1]==="+")}_copyStyle(b,v){let w=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const S=this.getRow(b),N=this.getRow(v);N.style=y(S.style),S.eachCell({includeEmpty:w},(D,F)=>{N.getCell(F).style=y(D.style)}),N.height=S.height}duplicateRow(b,v){let w=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const S=this._rows[b-1],N=new Array(v).fill(S.values);this.spliceRows(b+1,w?0:v,...N);for(let D=0;D<v;D++){const F=this._rows[b+D];F.style=S.style,F.height=S.height,S.eachCell({includeEmpty:!0},(G,P)=>{F.getCell(P).style=G.style})}}spliceRows(b,v){const w=b+v;for(var S=arguments.length,N=new Array(S>2?S-2:0),D=2;D<S;D++)N[D-2]=arguments[D];const F=N.length,G=F-v,P=this._rows.length;let U,q;if(G<0)for(b===P&&(this._rows[P-1]=void 0),U=w;U<=P;U++)if(q=this._rows[U-1],q){const R=this.getRow(U+G);R.values=q.values,R.style=q.style,R.height=q.height,q.eachCell({includeEmpty:!0},(I,T)=>{R.getCell(T).style=I.style}),this._rows[U-1]=void 0}else this._rows[U+G-1]=void 0;else if(G>0)for(U=P;U>=w;U--)if(q=this._rows[U-1],q){const R=this.getRow(U+G);R.values=q.values,R.style=q.style,R.height=q.height,q.eachCell({includeEmpty:!0},(I,T)=>{if(R.getCell(T).style=I.style,I._value.constructor.name==="MergeValue"){const L=this.getRow(I._row._number+F).getCell(T),E=I._value._master,x=this.getRow(E._row._number+F).getCell(E._column._number);L.merge(x)}})}else this._rows[U+G-1]=void 0;for(U=0;U<F;U++){const R=this.getRow(b+U);R.style={},R.values=N[U]}this.workbook.definedNames.spliceRows(this.name,b,v,F)}eachRow(b,v){if(v||(v=b,b=void 0),b&&b.includeEmpty){const w=this._rows.length;for(let S=1;S<=w;S++)v(this.getRow(S),S)}else this._rows.forEach(w=>{w&&w.hasValues&&v(w,w.number)})}getSheetValues(){const b=[];return this._rows.forEach(v=>{v&&(b[v.number]=v.values)}),b}findCell(b,v){const w=a.getAddress(b,v),S=this._rows[w.row-1];return S?S.findCell(w.col):void 0}getCell(b,v){const w=a.getAddress(b,v);return this.getRow(w.row).getCellEx(w)}mergeCells(){for(var b=arguments.length,v=new Array(b),w=0;w<b;w++)v[w]=arguments[w];const S=new u(v);this._mergeCellsInternal(S)}mergeCellsWithoutStyle(){for(var b=arguments.length,v=new Array(b),w=0;w<b;w++)v[w]=arguments[w];const S=new u(v);this._mergeCellsInternal(S,!0)}_mergeCellsInternal(b,v){s.each(this._merges,S=>{if(S.intersects(b))throw new Error("Cannot merge already merged cells")});const w=this.getCell(b.top,b.left);for(let S=b.top;S<=b.bottom;S++)for(let N=b.left;N<=b.right;N++)(S>b.top||N>b.left)&&this.getCell(S,N).merge(w,v);this._merges[w.address]=b}_unMergeMaster(b){const v=this._merges[b.address];if(v){for(let w=v.top;w<=v.bottom;w++)for(let S=v.left;S<=v.right;S++)this.getCell(w,S).unmerge();delete this._merges[b.address]}}get hasMerges(){return s.some(this._merges,Boolean)}unMergeCells(){for(var b=arguments.length,v=new Array(b),w=0;w<b;w++)v[w]=arguments[w];const S=new u(v);for(let N=S.top;N<=S.bottom;N++)for(let D=S.left;D<=S.right;D++){const F=this.findCell(N,D);F&&(F.type===c.ValueType.Merge?this._unMergeMaster(F.master):this._merges[F.address]&&this._unMergeMaster(F))}}fillFormula(b,v,w){let S=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const N=a.decode(b),{top:D,left:F,bottom:G,right:P}=N,U=P-F+1,q=a.encodeAddress(D,F),R=S==="shared";let I;I=typeof w=="function"?w:Array.isArray(w)?Array.isArray(w[0])?(L,E)=>w[L-D][E-F]:(L,E)=>w[(L-D)*U+(E-F)]:()=>{};let T=!0;for(let L=D;L<=G;L++)for(let E=F;E<=P;E++)T?(this.getCell(L,E).value={shareType:S,formula:v,ref:b,result:I(L,E)},T=!1):this.getCell(L,E).value=R?{sharedFormula:q,result:I(L,E)}:I(L,E)}addImage(b,v){const w={type:"image",imageId:b,range:v};this._media.push(new p(this,w))}getImages(){return this._media.filter(b=>b.type==="image")}addBackgroundImage(b){const v={type:"background",imageId:b};this._media.push(new p(this,v))}getBackgroundImageId(){const b=this._media.find(v=>v.type==="background");return b&&b.imageId}protect(b,v){return new Promise(w=>{this.sheetProtection={sheet:!0},v&&"spinCount"in v&&(v.spinCount=Number.isFinite(v.spinCount)?Math.round(Math.max(0,v.spinCount)):1e5),b&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=g.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=v&&"spinCount"in v?v.spinCount:1e5,this.sheetProtection.hashValue=g.convertPasswordToHash(b,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),v&&(this.sheetProtection=Object.assign(this.sheetProtection,v),!b&&"spinCount"in v&&delete this.sheetProtection.spinCount),w()})}unprotect(){this.sheetProtection=null}addTable(b){const v=new h(this,b);return this.tables[b.name]=v,v}getTable(b){return this.tables[b]}removeTable(b){delete this.tables[b]}getTables(){return Object.values(this.tables)}addConditionalFormatting(b){this.conditionalFormattings.push(b)}removeConditionalFormatting(b){typeof b=="number"?this.conditionalFormattings.splice(b,1):this.conditionalFormattings=b instanceof Function?this.conditionalFormattings.filter(b):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(b){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=b}get model(){const b={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(S=>S.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(S=>S.model),conditionalFormattings:this.conditionalFormattings};b.cols=i.toModel(this.columns);const v=b.rows=[],w=b.dimensions=new u;return this._rows.forEach(S=>{const N=S&&S.model;N&&(w.expand(N.number,N.min,N.number,N.max),v.push(N))}),b.merges=[],s.each(this._merges,S=>{b.merges.push(S.range)}),b}_parseRows(b){this._rows=[],b.rows.forEach(v=>{const w=new l(this,v.number);this._rows[w.number-1]=w,w.model=v})}_parseMergeCells(b){s.each(b.mergeCells,v=>{this.mergeCellsWithoutStyle(v)})}set model(b){this.name=b.name,this._columns=i.fromModel(this,b.cols),this._parseRows(b),this._parseMergeCells(b),this.dataValidations=new f(b.dataValidations),this.properties=b.properties,this.pageSetup=b.pageSetup,this.headerFooter=b.headerFooter,this.views=b.views,this.autoFilter=b.autoFilter,this._media=b.media.map(v=>new p(this,v)),this.sheetProtection=b.sheetProtection,this.tables=b.tables.reduce((v,w)=>{const S=new h;return S.model=w,v[w.name]=S,v},{}),this.conditionalFormattings=b.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(t,r,o){t("core-js/modules/es.promise"),t("core-js/modules/es.promise.finally"),t("core-js/modules/es.object.assign"),t("core-js/modules/es.object.keys"),t("core-js/modules/es.object.values"),t("core-js/modules/es.symbol"),t("core-js/modules/es.symbol.async-iterator"),t("core-js/modules/es.array.iterator"),t("core-js/modules/es.array.includes"),t("core-js/modules/es.array.find-index"),t("core-js/modules/es.array.find"),t("core-js/modules/es.string.from-code-point"),t("core-js/modules/es.string.includes"),t("core-js/modules/es.number.is-nan"),t("regenerator-runtime/runtime");const s={Workbook:t("./doc/workbook")},a=t("./doc/enums");Object.keys(a).forEach(u=>{s[u]=a[u]}),r.exports=s},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(t,r,o){const s=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");o.bufferToString=function(a){return typeof a=="string"?a:s?s.decode(a):a.toString()}},{}],17:[function(t,r,o){const s=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:a}=t("buffer");o.stringToBuffer=function(u){return typeof u!="string"?u:s?a.from(s.encode(u).buffer):a.from(u)}},{buffer:220}],18:[function(t,r,o){const s=t("./under-dash"),a=t("./col-cache");r.exports=class{constructor(u){this.template=u,this.sheets={}}addCell(u){this.addCellEx(a.decodeEx(u))}getCell(u){return this.findCellEx(a.decodeEx(u),!0)}findCell(u){return this.findCellEx(a.decodeEx(u),!1)}findCellAt(u,l,i){const c=this.sheets[u],p=c&&c[l];return p&&p[i]}addCellEx(u){if(u.top)for(let l=u.top;l<=u.bottom;l++)for(let i=u.left;i<=u.right;i++)this.getCellAt(u.sheetName,l,i);else this.findCellEx(u,!0)}getCellEx(u){return this.findCellEx(u,!0)}findCellEx(u,l){const i=this.findSheet(u,l),c=this.findSheetRow(i,u,l);return this.findRowCell(c,u,l)}getCellAt(u,l,i){const c=this.sheets[u]||(this.sheets[u]=[]),p=c[l]||(c[l]=[]);return p[i]||(p[i]={sheetName:u,address:a.n2l(i)+l,row:l,col:i})}removeCellEx(u){const l=this.findSheet(u);if(!l)return;const i=this.findSheetRow(l,u);i&&delete i[u.col]}forEachInSheet(u,l){const i=this.sheets[u];i&&i.forEach((c,p)=>{c&&c.forEach((h,f)=>{h&&l(h,p,f)})})}forEach(u){s.each(this.sheets,(l,i)=>{this.forEachInSheet(i,u)})}map(u){const l=[];return this.forEach(i=>{l.push(u(i))}),l}findSheet(u,l){const i=u.sheetName;return this.sheets[i]?this.sheets[i]:l?this.sheets[i]=[]:void 0}findSheetRow(u,l,i){const{row:c}=l;return u&&u[c]?u[c]:i?u[c]=[]:void 0}findRowCell(u,l,i){const{col:c}=l;return u&&u[c]?u[c]:i?u[c]=this.template?Object.assign(l,JSON.parse(JSON.stringify(this.template))):l:void 0}spliceRows(u,l,i,c){const p=this.sheets[u];if(p){const h=[];for(let f=0;f<c;f++)h.push([]);p.splice(l,i,...h)}}spliceColumns(u,l,i,c){const p=this.sheets[u];if(p){const h=[];for(let f=0;f<c;f++)h.push(null);s.each(p,f=>{f.splice(l,i,...h)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(t,r,o){const s=/^[A-Z]+\d+$/,a={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:u=>u<=26?1:u<=676?2:3,_fill(u){let l,i,c,p,h,f=1;if(u>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&u>=1){for(;f<=26;)l=this._dictionary[f-1],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=1}if(this._l2nFill<2&&u>=2){for(f=27;f<=702;)i=f-27,c=i%26,p=Math.floor(i/26),l=this._dictionary[p]+this._dictionary[c],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=2}if(this._l2nFill<3&&u>=3){for(f=703;f<=16384;)i=f-703,c=i%26,p=Math.floor(i/26)%26,h=Math.floor(i/676),l=this._dictionary[h]+this._dictionary[p]+this._dictionary[c],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=3}},l2n(u){if(this._l2n[u]||this._fill(u.length),!this._l2n[u])throw new Error("Out of bounds. Invalid column letter: "+u);return this._l2n[u]},n2l(u){if(u<1||u>16384)throw new Error(u+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[u]||this._fill(this._level(u)),this._n2l[u]},_hash:{},validateAddress(u){if(!s.test(u))throw new Error("Invalid Address: "+u);return!0},decodeAddress(u){const l=u.length<5&&this._hash[u];if(l)return l;let i=!1,c="",p=0,h=!1,f="",g=0;for(let b,v=0;v<u.length;v++)if(b=u.charCodeAt(v),!h&&b>=65&&b<=90)i=!0,c+=u[v],p=26*p+b-64;else if(b>=48&&b<=57)h=!0,f+=u[v],g=10*g+b-48;else if(h&&i&&b!==36)break;if(i){if(p>16384)throw new Error("Out of bounds. Invalid column letter: "+c)}else p=void 0;h||(g=void 0);const y={address:u=c+f,col:p,row:g,$col$row:`$${c}$${f}`};return p<=100&&g<=100&&(this._hash[u]=y,this._hash[y.$col$row]=y),y},getAddress(u,l){if(l){const i=this.n2l(l)+u;return this.decodeAddress(i)}return this.decodeAddress(u)},decode(u){const l=u.split(":");if(l.length===2){const i=this.decodeAddress(l[0]),c=this.decodeAddress(l[1]),p={top:Math.min(i.row,c.row),left:Math.min(i.col,c.col),bottom:Math.max(i.row,c.row),right:Math.max(i.col,c.col)};return p.tl=this.n2l(p.left)+p.top,p.br=this.n2l(p.right)+p.bottom,p.dimensions=`${p.tl}:${p.br}`,p}return this.decodeAddress(u)},decodeEx(u){const l=u.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),i=l[1]||l[2],c=l[3],p=c.split(":");if(p.length>1){let f=this.decodeAddress(p[0]),g=this.decodeAddress(p[1]);const y=Math.min(f.row,g.row),b=Math.min(f.col,g.col),v=Math.max(f.row,g.row),w=Math.max(f.col,g.col);return f=this.n2l(b)+y,g=this.n2l(w)+v,{top:y,left:b,bottom:v,right:w,sheetName:i,tl:{address:f,col:b,row:y,$col$row:`$${this.n2l(b)}$${y}`,sheetName:i},br:{address:g,col:w,row:v,$col$row:`$${this.n2l(w)}$${v}`,sheetName:i},dimensions:`${f}:${g}`}}if(c.startsWith("#"))return i?{sheetName:i,error:c}:{error:c};const h=this.decodeAddress(c);return i?{sheetName:i,...h}:h},encodeAddress:(u,l)=>a.n2l(l)+u,encode(){switch(arguments.length){case 2:return a.encodeAddress(arguments[0],arguments[1]);case 4:return`${a.encodeAddress(arguments[0],arguments[1])}:${a.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(u,l){const[i,c,,p,h]=u,[f,g]=l;return f>=i&&f<=p&&g>=c&&g<=h}};r.exports=a},{}],20:[function(t,r,o){const s=(u,l)=>({...u,...l.reduce((i,c)=>(u[c]&&(i[c]={...u[c]}),i),{})}),a=function(u,l,i){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];u[i]&&(l[i]=s(u[i],c))};o.copyStyle=u=>{if(!u)return u;if(l=u,Object.keys(l).length===0)return{};var l;const i={...u};return a(u,i,"font",["color"]),a(u,i,"alignment"),a(u,i,"protection"),u.border&&(a(u,i,"border"),a(u.border,i.border,"top",["color"]),a(u.border,i.border,"left",["color"]),a(u.border,i.border,"bottom",["color"]),a(u.border,i.border,"right",["color"]),a(u.border,i.border,"diagonal",["color"])),u.fill&&(a(u,i,"fill",["fgColor","bgColor","center"]),u.fill.stops&&(i.fill.stops=u.fill.stops.map(c=>s(c,["color"])))),i}},{}],21:[function(t,r,o){(function(s){(function(){const a=t("crypto"),u={hash(l){const i=a.createHash(l);for(var c=arguments.length,p=new Array(c>1?c-1:0),h=1;h<c;h++)p[h-1]=arguments[h];return i.update(s.concat(p)),i.digest()},convertPasswordToHash(l,i,c,p){if(i=i.toLowerCase(),a.getHashes().indexOf(i)<0)throw new Error(`Hash algorithm '${i}' not supported!`);const h=s.from(l,"utf16le");let f=this.hash(i,s.from(c,"base64"),h);for(let g=0;g<p;g++){const y=s.alloc(4);y.writeUInt32LE(g,0),f=this.hash(i,f,y)}return f.toString("base64")},randomBytes:l=>a.randomBytes(l)};r.exports=u}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(t,r,o){const{SaxesParser:s}=t("saxes"),{PassThrough:a}=t("readable-stream"),{bufferToString:u}=t("./browser-buffer-decode");r.exports=async function*(l){l.pipe&&!l[Symbol.asyncIterator]&&(l=l.pipe(new a));const i=new s;let c;i.on("error",h=>{c=h});let p=[];i.on("opentag",h=>p.push({eventType:"opentag",value:h})),i.on("text",h=>p.push({eventType:"text",value:h})),i.on("closetag",h=>p.push({eventType:"closetag",value:h}));for await(const h of l){if(i.write(u(h)),c)throw c;yield p,p=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(t,r,o){const s=t("./col-cache"),a=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,u=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;r.exports={slideFormula:function(l,i,c){const p=s.decode(i),h=s.decode(c);return l.replace(a,(f,g,y,b,v)=>{if(v)return f;const w=u.exec(b);if(w){const S=w[1],N=w[2].toUpperCase(),D=w[3],F=w[4];if(N.length>3||N.length===3&&N>"XFD")return f;let G=s.l2n(N),P=parseInt(F,10);return S||(G+=h.col-p.col),D||(P+=h.row-p.row),(g||"")+(S||"")+s.n2l(G)+(D||"")+P}return f})}}},{"./col-cache":19}],24:[function(t,r,o){(function(s,a){(function(){const u=t("readable-stream"),l=t("./utils"),i=t("./string-buf");class c{constructor(b,v){this._data=b,this._encoding=v}get length(){return this.toBuffer().length}copy(b,v,w,S){return this.toBuffer().copy(b,v,w,S)}toBuffer(){return this._buffer||(this._buffer=a.from(this._data,this._encoding)),this._buffer}}class p{constructor(b){this._data=b}get length(){return this._data.length}copy(b,v,w,S){return this._data._buf.copy(b,v,w,S)}toBuffer(){return this._data.toBuffer()}}class h{constructor(b){this._data=b}get length(){return this._data.length}copy(b,v,w,S){this._data.copy(b,v,w,S)}toBuffer(){return this._data}}class f{constructor(b){this.size=b,this.buffer=a.alloc(b),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const b=a.alloc(this.iWrite-this.iRead);return this.buffer.copy(b,0,this.iRead,this.iWrite),b}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(b){let v;return b===0?null:b===void 0||b>=this.length?(v=this.toBuffer(),this.iRead=this.iWrite,v):(v=a.alloc(b),this.buffer.copy(v,0,this.iRead,b),this.iRead+=b,v)}write(b,v,w){const S=Math.min(w,this.size-this.iWrite);return b.copy(this.buffer,this.iWrite,v,v+S),this.iWrite+=S,S}}const g=function(y){y=y||{},this.bufSize=y.bufSize||1048576,this.buffers=[],this.batch=y.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};l.inherits(g,u.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return a.concat(this.buffers.map(y=>y.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const b=this.buffers[this.buffers.length-1];if(!b.full)return b}const y=new f(this.bufSize);return this.buffers.push(y),y},async _pipe(y){await Promise.all(this.pipes.map((function(b){return new Promise(v=>{b.write(y.toBuffer(),()=>{v()})})})))},_writeToBuffers(y){let b=0;const v=y.length;for(;b<v;)b+=this._getWritableBuffer().write(y,b,v-b)},async write(y,b,v){let w;if(b instanceof Function&&(v=b,b="utf8"),v=v||l.nop,y instanceof i)w=new p(y);else if(y instanceof a)w=new h(y);else{if(!(typeof y=="string"||y instanceof String||y instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");w=new c(y,b)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(w);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(w),s.nextTick(v)):(await this._pipe(w),v());else this.paused||this.emit("data",w.toBuffer()),this._writeToBuffers(w),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(y,b,v){const w=S=>{S?v(S):(this._flush(),this.pipes.forEach(N=>{N.end()}),this.emit("finish"))};y?this.write(y,b,w):w()},read(y){let b;if(y){for(b=[];y&&this.buffers.length&&!this.buffers[0].eod;){const v=this.buffers[0],w=v.read(y);y-=w.length,b.push(w),v.eod&&v.full&&this.buffers.shift()}return a.concat(b)}return b=this.buffers.map(v=>v.toBuffer()).filter(Boolean),this.buffers=[],a.concat(b)},setEncoding(y){this.encoding=y},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(y){this.pipes.push(y),!this.paused&&this.buffers.length&&this.end()},unpipe(y){this.pipes=this.pipes.filter(b=>b!==y)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),r.exports=g}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(t,r,o){(function(s){(function(){r.exports=class{constructor(a){this._buf=s.alloc(a&&a.size||16384),this._encoding=a&&a.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=s.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(a){a=a||0,this._buffer=void 0,this._inPos=a}_grow(a){let u=2*this._buf.length;for(;u<a;)u*=2;const l=s.alloc(u);this._buf.copy(l,0),this._buf=l}addText(a){this._buffer=void 0;let u=this._inPos+this._buf.write(a,this._inPos,this._encoding);for(;u>=this._buf.length-4;)this._grow(this._inPos+a.length),u=this._inPos+this._buf.write(a,this._inPos,this._encoding);this._inPos=u}addStringBuf(a){a.length&&(this._buffer=void 0,this.length+a.length>this.capacity&&this._grow(this.length+a.length),a._buf.copy(this._buf,this._inPos,0,a.length),this._inPos+=a.length)}}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220}],26:[function(t,r,o){const{toString:s}=Object.prototype,a=/["&<>]/,u={each:function(l,i){l&&(Array.isArray(l)?l.forEach(i):Object.keys(l).forEach(c=>{i(l[c],c)}))},some:function(l,i){return!!l&&(Array.isArray(l)?l.some(i):Object.keys(l).some(c=>i(l[c],c)))},every:function(l,i){return!l||(Array.isArray(l)?l.every(i):Object.keys(l).every(c=>i(l[c],c)))},map:function(l,i){return l?Array.isArray(l)?l.map(i):Object.keys(l).map(c=>i(l[c],c)):[]},keyBy:(l,i)=>l.reduce((c,p)=>(c[p[i]]=p,c),{}),isEqual:function(l,i){const c=typeof l,p=typeof i,h=Array.isArray(l),f=Array.isArray(i);let g;if(c!==p)return!1;switch(typeof l){case"object":if(h||f)return!(!h||!f)&&l.length===i.length&&l.every((y,b)=>{const v=i[b];return u.isEqual(y,v)});if(l===null||i===null)return l===i;if(g=Object.keys(l),Object.keys(i).length!==g.length)return!1;for(const y of g)if(!i.hasOwnProperty(y))return!1;return u.every(l,(y,b)=>{const v=i[b];return u.isEqual(y,v)});default:return l===i}},escapeHtml(l){const i=a.exec(l);if(!i)return l;let c="",p="",h=0,f=i.index;for(;f<l.length;f++){switch(l.charAt(f)){case'"':p="&quot;";break;case"&":p="&amp;";break;case"'":p="&apos;";break;case"<":p="&lt;";break;case">":p="&gt;";break;default:continue}h!==f&&(c+=l.substring(h,f)),h=f+1,c+=p}return h!==f?c+l.substring(h,f):c},strcmp:(l,i)=>l<i?-1:l>i?1:0,isUndefined:l=>s.call(l)==="[object Undefined]",isObject:l=>s.call(l)==="[object Object]",deepMerge(){const l=arguments[0]||{},{length:i}=arguments;let c,p,h;function f(g,y){c=l[y],h=Array.isArray(g),u.isObject(g)||h?(h?(h=!1,p=c&&Array.isArray(c)?c:[]):p=c&&u.isObject(c)?c:{},l[y]=u.deepMerge(p,g)):u.isUndefined(g)||(l[y]=g)}for(let g=0;g<i;g++)u.each(arguments[g],f);return l}};r.exports=u},{}],27:[function(t,r,o){(function(s,a){(function(){const u=t("fs"),l=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,i={nop(){},promiseImmediate:c=>new Promise(p=>{s.setImmediate?a(()=>{p(c)}):setTimeout(()=>{p(c)},1)}),inherits:function(c,p,h,f){c.super_=p,f||(f=h,h=null),h&&Object.keys(h).forEach(y=>{Object.defineProperty(c,y,Object.getOwnPropertyDescriptor(h,y))});const g={constructor:{value:c,enumerable:!1,writable:!1,configurable:!0}};f&&Object.keys(f).forEach(y=>{g[y]=Object.getOwnPropertyDescriptor(f,y)}),c.prototype=Object.create(p.prototype,g)},dateToExcel:(c,p)=>25569+c.getTime()/864e5-(p?1462:0),excelToDate(c,p){const h=Math.round(24*(c-25569+(p?1462:0))*3600*1e3);return new Date(h)},parsePath(c){const p=c.lastIndexOf("/");return{path:c.substring(0,p),name:c.substring(p+1)}},getRelsPath(c){const p=i.parsePath(c);return`${p.path}/_rels/${p.name}.rels`},xmlEncode(c){const p=l.exec(c);if(!p)return c;let h="",f="",g=0,y=p.index;for(;y<c.length;y++){const b=c.charCodeAt(y);switch(b){case 34:f="&quot;";break;case 38:f="&amp;";break;case 39:f="&apos;";break;case 60:f="&lt;";break;case 62:f="&gt;";break;case 127:f="";break;default:if(b<=31&&(b<=8||b>=11&&b!==13)){f="";break}continue}g!==y&&(h+=c.substring(g,y)),g=y+1,f&&(h+=f)}return g!==y?h+c.substring(g,y):h},xmlDecode:c=>c.replace(/&([a-z]*);/g,p=>{switch(p){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return p}}),validInt(c){const p=parseInt(c,10);return Number.isNaN(p)?0:p},isDateFmt(c){return c?(c=(c=c.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:c=>new Promise(p=>{u.access(c,u.constants.F_OK,h=>{p(!h)})})},toIsoDateString:c=>c.toIsoString().subsstr(0,10),parseBoolean:c=>c===!0||c==="true"||c===1||c==="1"};r.exports=i}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{fs:216,timers:523}],28:[function(t,r,o){const s=t("./under-dash"),a=t("./utils");function u(c,p,h){c.push(` ${p}="${a.xmlEncode(h.toString())}"`)}function l(c,p){if(p){const h=[];s.each(p,(f,g)=>{f!==void 0&&u(h,g,f)}),c.push(h.join(""))}}class i{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(p){const h=this._xml;h.push("<?xml"),l(h,p),h.push(`?>
`)}openNode(p,h){const f=this.tos,g=this._xml;f&&this.open&&g.push(">"),this._stack.push(p),g.push("<"),g.push(p),l(g,h),this.leaf=!0,this.open=!0}addAttribute(p,h){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");h!==void 0&&u(this._xml,p,h)}addAttributes(p){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");l(this._xml,p)}writeText(p){const h=this._xml;this.open&&(h.push(">"),this.open=!1),this.leaf=!1,h.push(a.xmlEncode(p.toString()))}writeXml(p){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(p)}closeNode(){const p=this._stack.pop(),h=this._xml;this.leaf?h.push("/>"):(h.push("</"),h.push(p),h.push(">")),this.open=!1,this.leaf=!1}leafNode(p,h,f){this.openNode(p,h),f!==void 0&&this.writeText(f),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const p=this._rollbacks.pop();this._xml.length>p.xml&&this._xml.splice(p.xml,this._xml.length-p.xml),this._stack.length>p.stack&&this._stack.splice(p.stack,this._stack.length-p.stack),this.leaf=p.leaf,this.open=p.open}get xml(){return this.closeAll(),this._xml.join("")}}i.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},r.exports=i},{"./under-dash":26,"./utils":27}],29:[function(t,r,o){(function(s){(function(){const a=t("events"),u=t("jszip"),l=t("./stream-buf"),{stringToBuffer:i}=t("./browser-buffer-encode");class c extends a.EventEmitter{constructor(h){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},h),this.zip=new u,this.stream=new l}append(h,f){f.hasOwnProperty("base64")&&f.base64?this.zip.file(f.name,h,{base64:!0}):(s.browser&&typeof h=="string"&&(h=i(h)),this.zip.file(f.name,h))}async finalize(){const h=await this.zip.generateAsync(this.options);this.stream.end(h),this.emit("finish")}read(h){return this.stream.read(h)}setEncoding(h){return this.stream.setEncoding(h)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(h,f){return this.stream.pipe(h,f)}unpipe(h){return this.stream.unpipe(h)}unshift(h){return this.stream.unshift(h)}wrap(h){return this.stream.wrap(h)}}r.exports={ZipWriter:c}}).call(this)}).call(this,t("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(t,r,o){r.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(t,r,o){r.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(t,r,o){const s=t("../../utils/parse-sax"),a=t("../../utils/xml-stream");class u{prepare(){}render(){}parseOpen(i){}parseText(i){}parseClose(i){}reconcile(i,c){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(i=>{i instanceof u?i.reset():i.xform&&i.xform.reset()})}mergeModel(i){this.model=Object.assign(this.model||{},i)}async parse(i){for await(const c of i)for(const{eventType:p,value:h}of c)if(p==="opentag")this.parseOpen(h);else if(p==="text")this.parseText(h);else if(p==="closetag"&&!this.parseClose(h.name))return this.model;return this.model}async parseStream(i){return this.parse(s(i))}get xml(){return this.toXml(this.model)}toXml(i){const c=new a;return this.render(c,i),c.xml}static toAttribute(i,c){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(i===void 0){if(p)return c}else if(p||i!==c)return i.toString()}static toStringAttribute(i,c){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.toAttribute(i,c,p)}static toStringValue(i,c){return i===void 0?c:i}static toBoolAttribute(i,c){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(i===void 0){if(p)return c}else if(p||i!==c)return i?"1":"0"}static toBoolValue(i,c){return i===void 0?c:i==="1"}static toIntAttribute(i,c){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.toAttribute(i,c,p)}static toIntValue(i,c){return i===void 0?c:parseInt(i,10)}static toFloatAttribute(i,c){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.toAttribute(i,c,p)}static toFloatValue(i,c){return i===void 0?c:parseFloat(i)}}r.exports=u},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(t,r,o){const s=t("../base-xform"),a=t("../../../utils/col-cache");function u(i){try{return a.decodeEx(i),!0}catch{return!1}}function l(i){const c=[];let p=!1,h="";return i.split(",").forEach(f=>{if(!f)return;const g=(f.match(/'/g)||[]).length;if(!g)return void(p?h+=f+",":u(f)&&c.push(f));const y=g%2==0;!p&&y&&u(f)?c.push(f):p&&!y?(p=!1,u(h+f)&&c.push(h+f),h=""):(p=!0,h+=f+",")}),c}r.exports=class extends s{render(i,c){i.openNode("definedName",{name:c.name,localSheetId:c.localSheetId}),i.writeText(c.ranges.join(",")),i.closeNode()}parseOpen(i){switch(i.name){case"definedName":return this._parsedName=i.attributes.name,this._parsedLocalSheetId=i.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(i){this._parsedText.push(i)}parseClose(){return this.model={name:this._parsedName,ranges:l(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(t,r,o){const s=t("../../../utils/utils"),a=t("../base-xform");r.exports=class extends a{render(u,l){u.leafNode("sheet",{sheetId:l.id,name:l.name,state:l.state,"r:id":l.rId})}parseOpen(u){return u.name==="sheet"&&(this.model={name:s.xmlDecode(u.attributes.name),id:parseInt(u.attributes.sheetId,10),state:u.attributes.state,rId:u.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{render(a,u){a.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:u.fullCalcOnLoad?1:void 0})}parseOpen(a){return a.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{render(a,u){a.leafNode("workbookPr",{date1904:u.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(a){return a.name==="workbookPr"&&(this.model={date1904:a.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{render(a,u){const l={xWindow:u.x||0,yWindow:u.y||0,windowWidth:u.width||12e3,windowHeight:u.height||24e3,firstSheet:u.firstSheet,activeTab:u.activeTab};u.visibility&&u.visibility!=="visible"&&(l.visibility=u.visibility),a.leafNode("workbookView",l)}parseOpen(a){if(a.name==="workbookView"){const u=this.model={},l=function(c,p,h){const f=p!==void 0?u[c]=p:h;f!==void 0&&(u[c]=f)},i=function(c,p,h){const f=p!==void 0?u[c]=parseInt(p,10):h;f!==void 0&&(u[c]=f)};return i("x",a.attributes.xWindow,0),i("y",a.attributes.yWindow,0),i("width",a.attributes.windowWidth,25e3),i("height",a.attributes.windowHeight,1e4),l("visibility",a.attributes.visibility,"visible"),i("activeTab",a.attributes.activeTab,void 0),i("firstSheet",a.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../../../utils/col-cache"),u=t("../../../utils/xml-stream"),l=t("../base-xform"),i=t("../static-xform"),c=t("../list-xform"),p=t("./defined-name-xform"),h=t("./sheet-xform"),f=t("./workbook-view-xform"),g=t("./workbook-properties-xform"),y=t("./workbook-calc-properties-xform");class b extends l{constructor(){super(),this.map={fileVersion:b.STATIC_XFORMS.fileVersion,workbookPr:new g,bookViews:new c({tag:"bookViews",count:!1,childXform:new f}),sheets:new c({tag:"sheets",count:!1,childXform:new h}),definedNames:new c({tag:"definedNames",count:!1,childXform:new p}),calcPr:new y}}prepare(w){w.sheets=w.worksheets;const S=[];let N=0;w.sheets.forEach(D=>{if(D.pageSetup&&D.pageSetup.printArea&&D.pageSetup.printArea.split("&&").forEach(F=>{const G=F.split(":"),P={name:"_xlnm.Print_Area",ranges:[`'${D.name}'!$${G[0]}:$${G[1]}`],localSheetId:N};S.push(P)}),D.pageSetup&&(D.pageSetup.printTitlesRow||D.pageSetup.printTitlesColumn)){const F=[];if(D.pageSetup.printTitlesColumn){const P=D.pageSetup.printTitlesColumn.split(":");F.push(`'${D.name}'!$${P[0]}:$${P[1]}`)}if(D.pageSetup.printTitlesRow){const P=D.pageSetup.printTitlesRow.split(":");F.push(`'${D.name}'!$${P[0]}:$${P[1]}`)}const G={name:"_xlnm.Print_Titles",ranges:F,localSheetId:N};S.push(G)}N++}),S.length&&(w.definedNames=w.definedNames.concat(S)),(w.media||[]).forEach((D,F)=>{D.name=D.type+(F+1)})}render(w,S){w.openXml(u.StdDocAttributes),w.openNode("workbook",b.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(w),this.map.workbookPr.render(w,S.properties),this.map.bookViews.render(w,S.views),this.map.sheets.render(w,S.sheets),this.map.definedNames.render(w,S.definedNames),this.map.calcPr.render(w,S.calcProperties),w.closeNode()}parseOpen(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case"workbook":return!0;default:return this.parser=this.map[w.name],this.parser&&this.parser.parseOpen(w),!0}}parseText(w){this.parser&&this.parser.parseText(w)}parseClose(w){if(this.parser)return this.parser.parseClose(w)||(this.parser=void 0),!0;switch(w){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(w){const S=(w.workbookRels||[]).reduce((P,U)=>(P[U.Id]=U,P),{}),N=[];let D,F=0;(w.sheets||[]).forEach(P=>{const U=S[P.rId];U&&(D=w.worksheetHash["xl/"+U.Target.replace(/^(\s|\/xl\/)+/,"")],D&&(D.name=P.name,D.id=P.id,D.state=P.state,N[F++]=D))});const G=[];s.each(w.definedNames,P=>{if(P.name==="_xlnm.Print_Area"){if(D=N[P.localSheetId],D){D.pageSetup||(D.pageSetup={});const U=a.decodeEx(P.ranges[0]);D.pageSetup.printArea=D.pageSetup.printArea?`${D.pageSetup.printArea}&&${U.dimensions}`:U.dimensions}}else if(P.name==="_xlnm.Print_Titles"){if(D=N[P.localSheetId],D){D.pageSetup||(D.pageSetup={});const U=P.ranges.join(","),q=/\$/g,R=/\$\d+:\$\d+/,I=U.match(R);if(I&&I.length){const E=I[0];D.pageSetup.printTitlesRow=E.replace(q,"")}const T=/\$[A-Z]+:\$[A-Z]+/,L=U.match(T);if(L&&L.length){const E=L[0];D.pageSetup.printTitlesColumn=E.replace(q,"")}}}else G.push(P)}),w.definedNames=G,w.media.forEach((P,U)=>{P.index=U})}}b.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},b.STATIC_XFORMS={fileVersion:new i({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},r.exports=b},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(t,r,o){const s=t("../strings/rich-text-xform"),a=t("../../../utils/utils"),u=t("../base-xform"),l=r.exports=function(i){this.model=i};a.inherits(l,u,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new s),this._richTextXform},render(i,c){c=c||this.model,i.openNode("comment",{ref:c.ref,authorId:0}),i.openNode("text"),c&&c.note&&c.note.texts&&c.note.texts.forEach(p=>{this.richTextXform.render(i,p)}),i.closeNode(),i.closeNode()},parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"comment":return this.model={type:"note",note:{texts:[]},...i.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(i),!0;default:return!1}},parseText(i){this.parser&&this.parser.parseText(i)},parseClose(i){switch(i){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(i),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(t,r,o){const s=t("../../../utils/xml-stream"),a=t("../../../utils/utils"),u=t("../base-xform"),l=t("./comment-xform"),i=r.exports=function(){this.map={comment:new l}};a.inherits(i,u,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(c,p){p=p||this.model,c.openXml(s.StdDocAttributes),c.openNode("comments",i.COMMENTS_ATTRIBUTES),c.openNode("authors"),c.leafNode("author",null,"Author"),c.closeNode(),c.openNode("commentList"),p.comments.forEach(h=>{this.map.comment.render(c,h)}),c.closeNode(),c.closeNode()},parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(c),!0;default:return!1}},parseText(c){this.parser&&this.parser.parseText(c)},parseClose(c){switch(c){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(c),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(t,r,o){const s=t("../../base-xform");r.exports=class extends s{constructor(a){super(),this._model=a}get tag(){return this._model&&this._model.tag}render(a,u,l){(u===l[2]||this.tag==="x:SizeWithCells"&&u===l[1])&&a.leafNode(this.tag)}parseOpen(a){switch(a.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(t,r,o){const s=t("../../base-xform");r.exports=class extends s{constructor(a){super(),this._model=a}get tag(){return this._model&&this._model.tag}render(a,u){a.leafNode(this.tag,null,u)}parseOpen(a){switch(a.name){case this.tag:return this.text="",!0;default:return!1}}parseText(a){this.text=a}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"x:Anchor"}getAnchorRect(a){const u=Math.floor(a.left),l=Math.floor(68*(a.left-u)),i=Math.floor(a.top),c=Math.floor(18*(a.top-i)),p=Math.floor(a.right),h=Math.floor(68*(a.right-p)),f=Math.floor(a.bottom);return[u,l,i,c,p,h,f,Math.floor(18*(a.bottom-f))]}getDefaultRect(a){const u=a.col,l=Math.max(a.row-2,0);return[u,6,l,14,u+2,2,l+4,16]}render(a,u){const l=u.anchor?this.getAnchorRect(u.anchor):this.getDefaultRect(u.refAddress);a.leafNode("x:Anchor",null,l.join(", "))}parseOpen(a){switch(a.name){case this.tag:return this.text="",!0;default:return!1}}parseText(a){this.text=a}parseClose(){return!1}}},{"../base-xform":32}],44:[function(t,r,o){const s=t("../base-xform"),a=t("./vml-anchor-xform"),u=t("./style/vml-protection-xform"),l=t("./style/vml-position-xform"),i=["twoCells","oneCells","absolute"];r.exports=class extends s{constructor(){super(),this.map={"x:Anchor":new a,"x:Locked":new u({tag:"x:Locked"}),"x:LockText":new u({tag:"x:LockText"}),"x:SizeWithCells":new l({tag:"x:SizeWithCells"}),"x:MoveWithCells":new l({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(c,p){const{protection:h,editAs:f}=p.note;c.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(c,f,i),this.map["x:SizeWithCells"].render(c,f,i),this.map["x:Anchor"].render(c,p),this.map["x:Locked"].render(c,h.locked),c.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(c,h.lockText),c.leafNode("x:Row",null,p.refAddress.row-1),c.leafNode("x:Column",null,p.refAddress.col-1),c.closeNode()}parseOpen(c){switch(c.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const c=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),p=Object.keys(c).length;this.model.editAs=i[p],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(t,r,o){const s=t("../../../utils/xml-stream"),a=t("../base-xform"),u=t("./vml-shape-xform");class l extends a{constructor(){super(),this.map={"v:shape":new u}}get tag(){return"xml"}render(c,p){c.openXml(s.StdDocAttributes),c.openNode(this.tag,l.DRAWING_ATTRIBUTES),c.openNode("o:shapelayout",{"v:ext":"edit"}),c.leafNode("o:idmap",{"v:ext":"edit",data:1}),c.closeNode(),c.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),c.leafNode("v:stroke",{joinstyle:"miter"}),c.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),c.closeNode(),p.comments.forEach((h,f)=>{this.map["v:shape"].render(c,h,f)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(c){case this.tag:return!1;default:return!0}}reconcile(c,p){c.anchors.forEach(h=>{h.br?this.map["xdr:twoCellAnchor"].reconcile(h,p):this.map["xdr:oneCellAnchor"].reconcile(h,p)})}}l.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},r.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(t,r,o){const s=t("../base-xform"),a=t("./vml-textbox-xform"),u=t("./vml-client-data-xform");class l extends s{constructor(){super(),this.map={"v:textbox":new a,"x:ClientData":new u}}get tag(){return"v:shape"}render(c,p,h){c.openNode("v:shape",l.V_SHAPE_ATTRIBUTES(p,h)),c.leafNode("v:fill",{color2:"infoBackground [80]"}),c.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),c.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(c,p),this.map["x:ClientData"].render(c,p),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset(),this.model={margins:{insetmode:c.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}l.V_SHAPE_ATTRIBUTES=(i,c)=>({id:"_x0000_s"+(1025+c),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":i.note.margins&&i.note.margins.insetmode}),r.exports=l},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"v:textbox"}conversionUnit(a,u,l){return`${parseFloat(a)*u.toFixed(2)}${l}`}reverseConversionUnit(a){return(a||"").split(",").map(u=>Number(parseFloat(this.conversionUnit(parseFloat(u),.1,"")).toFixed(2)))}render(a,u){const l={style:"mso-direction-alt:auto"};if(u&&u.note){let{inset:i}=u.note&&u.note.margins;Array.isArray(i)&&(i=i.map(c=>this.conversionUnit(c,10,"mm")).join(",")),i&&(l.inset=i)}a.openNode("v:textbox",l),a.leafNode("div",{style:"text-align:left"}),a.closeNode()}parseOpen(a){switch(a.name){case this.tag:return this.model={inset:this.reverseConversionUnit(a.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(a){switch(a){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(t,r,o){const s=t("./base-xform");r.exports=class extends s{createNewModel(a){return{}}parseOpen(a){return this.parser=this.parser||this.map[a.name],this.parser?(this.parser.parseOpen(a),!0):a.name===this.tag&&(this.model=this.createNewModel(a),!0)}parseText(a){this.parser&&this.parser.parseText(a)}onParserClose(a,u){this.model[a]=u.model}parseClose(a){return this.parser?(this.parser.parseClose(a)||(this.onParserClose(a,this.parser),this.parser=void 0),!0):a!==this.tag}}},{"./base-xform":32}],49:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{render(a,u){a.openNode("HeadingPairs"),a.openNode("vt:vector",{size:2,baseType:"variant"}),a.openNode("vt:variant"),a.leafNode("vt:lpstr",void 0,"Worksheets"),a.closeNode(),a.openNode("vt:variant"),a.leafNode("vt:i4",void 0,u.length),a.closeNode(),a.closeNode(),a.closeNode()}parseOpen(a){return a.name==="HeadingPairs"}parseText(){}parseClose(a){return a!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{render(a,u){a.openNode("TitlesOfParts"),a.openNode("vt:vector",{size:u.length,baseType:"lpstr"}),u.forEach(l=>{a.leafNode("vt:lpstr",void 0,l.name)}),a.closeNode(),a.closeNode()}parseOpen(a){return a.name==="TitlesOfParts"}parseText(){}parseClose(a){return a!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(t,r,o){const s=t("../../../utils/xml-stream"),a=t("../base-xform"),u=t("../simple/string-xform"),l=t("./app-heading-pairs-xform"),i=t("./app-titles-of-parts-xform");class c extends a{constructor(){super(),this.map={Company:new u({tag:"Company"}),Manager:new u({tag:"Manager"}),HeadingPairs:new l,TitleOfParts:new i}}render(h,f){h.openXml(s.StdDocAttributes),h.openNode("Properties",c.PROPERTY_ATTRIBUTES),h.leafNode("Application",void 0,"Microsoft Excel"),h.leafNode("DocSecurity",void 0,"0"),h.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(h,f.worksheets),this.map.TitleOfParts.render(h,f.worksheets),this.map.Company.render(h,f.company||""),this.map.Manager.render(h,f.manager),h.leafNode("LinksUpToDate",void 0,"false"),h.leafNode("SharedDoc",void 0,"false"),h.leafNode("HyperlinksChanged",void 0,"false"),h.leafNode("AppVersion",void 0,"16.0300"),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"Properties":return!0;default:return this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0)}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}c.DateFormat=function(p){return p.toISOString().replace(/[.]\d{3,6}/,"")},c.DateAttrs={"xsi:type":"dcterms:W3CDTF"},c.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},r.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(t,r,o){const s=t("../../../utils/xml-stream"),a=t("../base-xform");class u extends a{render(i,c){i.openXml(s.StdDocAttributes),i.openNode("Types",u.PROPERTY_ATTRIBUTES);const p={};(c.media||[]).forEach(h=>{if(h.type==="image"){const f=h.extension;p[f]||(p[f]=!0,i.leafNode("Default",{Extension:f,ContentType:"image/"+f}))}}),i.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),i.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),i.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),c.worksheets.forEach(h=>{const f=`/xl/worksheets/sheet${h.id}.xml`;i.leafNode("Override",{PartName:f,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),i.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),i.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),c.sharedStrings&&c.sharedStrings.count&&i.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),c.tables&&c.tables.forEach(h=>{i.leafNode("Override",{PartName:"/xl/tables/"+h.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),c.drawings&&c.drawings.forEach(h=>{i.leafNode("Override",{PartName:`/xl/drawings/${h.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),c.commentRefs&&(i.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),c.commentRefs.forEach(h=>{let{commentName:f}=h;i.leafNode("Override",{PartName:`/xl/${f}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),i.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),i.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),i.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}u.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},r.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(t,r,o){const s=t("../../../utils/xml-stream"),a=t("../base-xform"),u=t("../simple/date-xform"),l=t("../simple/string-xform"),i=t("../simple/integer-xform");class c extends a{constructor(){super(),this.map={"dc:creator":new l({tag:"dc:creator"}),"dc:title":new l({tag:"dc:title"}),"dc:subject":new l({tag:"dc:subject"}),"dc:description":new l({tag:"dc:description"}),"dc:identifier":new l({tag:"dc:identifier"}),"dc:language":new l({tag:"dc:language"}),"cp:keywords":new l({tag:"cp:keywords"}),"cp:category":new l({tag:"cp:category"}),"cp:lastModifiedBy":new l({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new u({tag:"cp:lastPrinted",format:c.DateFormat}),"cp:revision":new i({tag:"cp:revision"}),"cp:version":new l({tag:"cp:version"}),"cp:contentStatus":new l({tag:"cp:contentStatus"}),"cp:contentType":new l({tag:"cp:contentType"}),"dcterms:created":new u({tag:"dcterms:created",attrs:c.DateAttrs,format:c.DateFormat}),"dcterms:modified":new u({tag:"dcterms:modified",attrs:c.DateAttrs,format:c.DateFormat})}}render(h,f){h.openXml(s.StdDocAttributes),h.openNode("cp:coreProperties",c.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(h,f.creator),this.map["dc:title"].render(h,f.title),this.map["dc:subject"].render(h,f.subject),this.map["dc:description"].render(h,f.description),this.map["dc:identifier"].render(h,f.identifier),this.map["dc:language"].render(h,f.language),this.map["cp:keywords"].render(h,f.keywords),this.map["cp:category"].render(h,f.category),this.map["cp:lastModifiedBy"].render(h,f.lastModifiedBy),this.map["cp:lastPrinted"].render(h,f.lastPrinted),this.map["cp:revision"].render(h,f.revision),this.map["cp:version"].render(h,f.version),this.map["cp:contentStatus"].render(h,f.contentStatus),this.map["cp:contentType"].render(h,f.contentType),this.map["dcterms:created"].render(h,f.created),this.map["dcterms:modified"].render(h,f.modified),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[h.name],this.parser)return this.parser.parseOpen(h),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(h))}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+h)}}}c.DateFormat=function(p){return p.toISOString().replace(/[.]\d{3}/,"")},c.DateAttrs={"xsi:type":"dcterms:W3CDTF"},c.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},r.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{render(a,u){a.leafNode("Relationship",u)}parseOpen(a){switch(a.name){case"Relationship":return this.model=a.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(t,r,o){const s=t("../../../utils/xml-stream"),a=t("../base-xform"),u=t("./relationship-xform");class l extends a{constructor(){super(),this.map={Relationship:new u}}render(c,p){p=p||this._values,c.openXml(s.StdDocAttributes),c.openNode("Relationships",l.RELATIONSHIPS_ATTRIBUTES),p.forEach(h=>{this.map.Relationship.render(c,h)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[c.name],this.parser)return this.parser.parseOpen(c),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(c){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+c)}}}l.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},r.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{parseOpen(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case this.tag:this.reset(),this.model={range:{editAs:a.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[a.name],this.parser&&this.parser.parseOpen(a)}return!0}parseText(a){this.parser&&this.parser.parseText(a)}reconcilePicture(a,u){if(a&&a.rId){const l=u.rels[a.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(l){const i=l[1],c=u.mediaIndex[i];return u.media[c]}}}}},{"../base-xform":32}],57:[function(t,r,o){const s=t("../base-xform"),a=t("./blip-xform");r.exports=class extends s{constructor(){super(),this.map={"a:blip":new a}}get tag(){return"xdr:blipFill"}render(u,l){u.openNode(this.tag),this.map["a:blip"].render(u,l),u.openNode("a:stretch"),u.leafNode("a:fillRect"),u.closeNode(),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"a:blip"}render(a,u){a.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":u.rId,cstate:"print"})}parseOpen(a){switch(a.name){case this.tag:return this.model={rId:a.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(a){switch(a){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"xdr:cNvPicPr"}render(a){a.openNode(this.tag),a.leafNode("a:picLocks",{noChangeAspect:"1"}),a.closeNode()}parseOpen(a){switch(a.name){case this.tag:default:return!0}}parseText(){}parseClose(a){switch(a){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(t,r,o){const s=t("../base-xform"),a=t("./hlink-click-xform"),u=t("./ext-lst-xform");r.exports=class extends s{constructor(){super(),this.map={"a:hlinkClick":new a,"a:extLst":new u}}get tag(){return"xdr:cNvPr"}render(l,i){l.openNode(this.tag,{id:i.index,name:"Picture "+i.index}),this.map["a:hlinkClick"].render(l,i),this.map["a:extLst"].render(l,i),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(t,r,o){const s=t("../base-xform"),a=t("../simple/integer-xform");r.exports=class extends s{constructor(u){super(),this.tag=u.tag,this.map={"xdr:col":new a({tag:"xdr:col",zero:!0}),"xdr:colOff":new a({tag:"xdr:colOff",zero:!0}),"xdr:row":new a({tag:"xdr:row",zero:!0}),"xdr:rowOff":new a({tag:"xdr:rowOff",zero:!0})}}render(u,l){u.openNode(this.tag),this.map["xdr:col"].render(u,l.nativeCol),this.map["xdr:colOff"].render(u,l.nativeColOff),this.map["xdr:row"].render(u,l.nativeRow),this.map["xdr:rowOff"].render(u,l.nativeRowOff),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(t,r,o){const s=t("../../../utils/col-cache"),a=t("../../../utils/xml-stream"),u=t("../base-xform"),l=t("./two-cell-anchor-xform"),i=t("./one-cell-anchor-xform");class c extends u{constructor(){super(),this.map={"xdr:twoCellAnchor":new l,"xdr:oneCellAnchor":new i}}prepare(h){h.anchors.forEach((f,g)=>{f.anchorType=(function(y){return(typeof y.range=="string"?s.decode(y.range):y.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"})(f),this.map[f.anchorType].prepare(f,{index:g})})}get tag(){return"xdr:wsDr"}render(h,f){h.openXml(a.StdDocAttributes),h.openNode(this.tag,c.DRAWING_ATTRIBUTES),f.anchors.forEach(g=>{this.map[g.anchorType].render(h,g)}),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(h){case this.tag:return!1;default:return!0}}reconcile(h,f){h.anchors.forEach(g=>{g.br?this.map["xdr:twoCellAnchor"].reconcile(g,f):this.map["xdr:oneCellAnchor"].reconcile(g,f)})}}c.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},r.exports=c},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"a:extLst"}render(a){a.openNode(this.tag),a.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),a.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),a.closeNode(),a.closeNode()}parseOpen(a){switch(a.name){case this.tag:default:return!0}}parseText(){}parseClose(a){switch(a){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{constructor(a){super(),this.tag=a.tag,this.map={}}render(a,u){a.openNode(this.tag);const l=Math.floor(9525*u.width),i=Math.floor(9525*u.height);a.addAttribute("cx",l),a.addAttribute("cy",i),a.closeNode()}parseOpen(a){return a.name===this.tag&&(this.model={width:parseInt(a.attributes.cx||"0",10)/9525,height:parseInt(a.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"a:hlinkClick"}render(a,u){u.hyperlinks&&u.hyperlinks.rId&&a.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":u.hyperlinks.rId,tooltip:u.hyperlinks.tooltip})}parseOpen(a){switch(a.name){case this.tag:return this.model={hyperlinks:{rId:a.attributes["r:id"],tooltip:a.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(t,r,o){const s=t("../base-xform"),a=t("./c-nv-pr-xform"),u=t("./c-nv-pic-pr-xform");r.exports=class extends s{constructor(){super(),this.map={"xdr:cNvPr":new a,"xdr:cNvPicPr":new u}}get tag(){return"xdr:nvPicPr"}render(l,i){l.openNode(this.tag),this.map["xdr:cNvPr"].render(l,i),this.map["xdr:cNvPicPr"].render(l,i),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(t,r,o){const s=t("./base-cell-anchor-xform"),a=t("../static-xform"),u=t("./cell-position-xform"),l=t("./ext-xform"),i=t("./pic-xform");r.exports=class extends s{constructor(){super(),this.map={"xdr:from":new u({tag:"xdr:from"}),"xdr:ext":new l({tag:"xdr:ext"}),"xdr:pic":new i,"xdr:clientData":new a({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(c,p){this.map["xdr:pic"].prepare(c.picture,p)}render(c,p){c.openNode(this.tag,{editAs:p.range.editAs||"oneCell"}),this.map["xdr:from"].render(c,p.range.tl),this.map["xdr:ext"].render(c,p.range.ext),this.map["xdr:pic"].render(c,p.picture),this.map["xdr:clientData"].render(c,{}),c.closeNode()}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(c,p){c.medium=this.reconcilePicture(c.picture,p)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(t,r,o){const s=t("../base-xform"),a=t("../static-xform"),u=t("./blip-fill-xform"),l=t("./nv-pic-pr-xform"),i=t("./sp-pr");r.exports=class extends s{constructor(){super(),this.map={"xdr:nvPicPr":new l,"xdr:blipFill":new u,"xdr:spPr":new a(i)}}get tag(){return"xdr:pic"}prepare(c,p){c.index=p.index+1}render(c,p){c.openNode(this.tag),this.map["xdr:nvPicPr"].render(c,p),this.map["xdr:blipFill"].render(c,p),this.map["xdr:spPr"].render(c,p),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(t,r,o){r.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(t,r,o){const s=t("./base-cell-anchor-xform"),a=t("../static-xform"),u=t("./cell-position-xform"),l=t("./pic-xform");r.exports=class extends s{constructor(){super(),this.map={"xdr:from":new u({tag:"xdr:from"}),"xdr:to":new u({tag:"xdr:to"}),"xdr:pic":new l,"xdr:clientData":new a({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(i,c){this.map["xdr:pic"].prepare(i.picture,c)}render(i,c){i.openNode(this.tag,{editAs:c.range.editAs||"oneCell"}),this.map["xdr:from"].render(i,c.range.tl),this.map["xdr:to"].render(i,c.range.br),this.map["xdr:pic"].render(i,c.picture),this.map["xdr:clientData"].render(i,{}),i.closeNode()}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(i,c){i.medium=this.reconcilePicture(i.picture,c)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(t,r,o){const s=t("./base-xform");r.exports=class extends s{constructor(a){super(),this.tag=a.tag,this.always=!!a.always,this.count=a.count,this.empty=a.empty,this.$count=a.$count||"count",this.$=a.$,this.childXform=a.childXform,this.maxItems=a.maxItems}prepare(a,u){const{childXform:l}=this;a&&a.forEach((i,c)=>{u.index=c,l.prepare(i,u)})}render(a,u){if(this.always||u&&u.length){a.openNode(this.tag,this.$),this.count&&a.addAttribute(this.$count,u&&u.length||0);const{childXform:l}=this;(u||[]).forEach((i,c)=>{l.render(a,i,c)}),a.closeNode()}else this.empty&&a.leafNode(this.tag)}parseOpen(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(a)&&(this.parser=this.childXform,!0)}}parseText(a){this.parser&&this.parser.parseText(a)}parseClose(a){if(this.parser){if(!this.parser.parseClose(a)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(a,u){if(a){const{childXform:l}=this;a.forEach(i=>{l.reconcile(i,u)})}}}},{"./base-xform":32}],72:[function(t,r,o){const s=t("../../../utils/col-cache"),a=t("../base-xform");r.exports=class extends a{get tag(){return"autoFilter"}render(u,l){if(l)if(typeof l=="string")u.leafNode("autoFilter",{ref:l});else{const i=function(h){return typeof h=="string"?h:s.getAddress(h.row,h.column).address},c=i(l.from),p=i(l.to);c&&p&&u.leafNode("autoFilter",{ref:`${c}:${p}`})}}parseOpen(u){u.name==="autoFilter"&&(this.model=u.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(t,r,o){const s=t("../../../utils/utils"),a=t("../base-xform"),u=t("../../../doc/range"),l=t("../../../doc/enums"),i=t("../strings/rich-text-xform");function c(p){if(p==null)return l.ValueType.Null;if(p instanceof String||typeof p=="string")return l.ValueType.String;if(typeof p=="number")return l.ValueType.Number;if(typeof p=="boolean")return l.ValueType.Boolean;if(p instanceof Date)return l.ValueType.Date;if(p.text&&p.hyperlink)return l.ValueType.Hyperlink;if(p.formula)return l.ValueType.Formula;if(p.error)return l.ValueType.Error;throw new Error("I could not understand type of value")}r.exports=class extends a{constructor(){super(),this.richTextXForm=new i}get tag(){return"c"}prepare(p,h){const f=h.styles.addStyleModel(p.style||{},(function(g){switch(g.type){case l.ValueType.Formula:return c(g.result);default:return g.type}})(p));switch(f&&(p.styleId=f),p.comment&&h.comments.push({...p.comment,ref:p.address}),p.type){case l.ValueType.String:case l.ValueType.RichText:h.sharedStrings&&(p.ssId=h.sharedStrings.add(p.value));break;case l.ValueType.Date:h.date1904&&(p.date1904=!0);break;case l.ValueType.Hyperlink:h.sharedStrings&&p.text!==void 0&&p.text!==null&&(p.ssId=h.sharedStrings.add(p.text)),h.hyperlinks.push({address:p.address,target:p.hyperlink,tooltip:p.tooltip});break;case l.ValueType.Merge:h.merges.add(p);break;case l.ValueType.Formula:if(h.date1904&&(p.date1904=!0),p.shareType==="shared"&&(p.si=h.siFormulae++),p.formula)h.formulae[p.address]=p;else if(p.sharedFormula){const g=h.formulae[p.sharedFormula];if(!g)throw new Error("Shared Formula master must exist above and or left of clone for cell "+p.address);g.si===void 0?(g.shareType="shared",g.si=h.siFormulae++,g.range=new u(g.address,p.address)):g.range&&g.range.expandToAddress(p.address),p.si=g.si}}}renderFormula(p,h){let f=null;switch(h.shareType){case"shared":f={t:"shared",ref:h.ref||h.range.range,si:h.si};break;case"array":f={t:"array",ref:h.ref};break;default:h.si!==void 0&&(f={t:"shared",si:h.si})}switch(c(h.result)){case l.ValueType.Null:p.leafNode("f",f,h.formula);break;case l.ValueType.String:p.addAttribute("t","str"),p.leafNode("f",f,h.formula),p.leafNode("v",null,h.result);break;case l.ValueType.Number:p.leafNode("f",f,h.formula),p.leafNode("v",null,h.result);break;case l.ValueType.Boolean:p.addAttribute("t","b"),p.leafNode("f",f,h.formula),p.leafNode("v",null,h.result?1:0);break;case l.ValueType.Error:p.addAttribute("t","e"),p.leafNode("f",f,h.formula),p.leafNode("v",null,h.result.error);break;case l.ValueType.Date:p.leafNode("f",f,h.formula),p.leafNode("v",null,s.dateToExcel(h.result,h.date1904));break;default:throw new Error("I could not understand type of value")}}render(p,h){if(h.type!==l.ValueType.Null||h.styleId){switch(p.openNode("c"),p.addAttribute("r",h.address),h.styleId&&p.addAttribute("s",h.styleId),h.type){case l.ValueType.Null:break;case l.ValueType.Number:p.leafNode("v",null,h.value);break;case l.ValueType.Boolean:p.addAttribute("t","b"),p.leafNode("v",null,h.value?"1":"0");break;case l.ValueType.Error:p.addAttribute("t","e"),p.leafNode("v",null,h.value.error);break;case l.ValueType.String:case l.ValueType.RichText:h.ssId!==void 0?(p.addAttribute("t","s"),p.leafNode("v",null,h.ssId)):h.value&&h.value.richText?(p.addAttribute("t","inlineStr"),p.openNode("is"),h.value.richText.forEach(f=>{this.richTextXForm.render(p,f)}),p.closeNode("is")):(p.addAttribute("t","str"),p.leafNode("v",null,h.value));break;case l.ValueType.Date:p.leafNode("v",null,s.dateToExcel(h.value,h.date1904));break;case l.ValueType.Hyperlink:h.ssId!==void 0?(p.addAttribute("t","s"),p.leafNode("v",null,h.ssId)):(p.addAttribute("t","str"),p.leafNode("v",null,h.text));break;case l.ValueType.Formula:this.renderFormula(p,h);break;case l.ValueType.Merge:}p.closeNode()}}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"c":return this.model={address:p.attributes.r},this.t=p.attributes.t,p.attributes.s&&(this.model.styleId=parseInt(p.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=p.attributes.si,this.model.shareType=p.attributes.t,this.model.ref=p.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(p),!0;default:return!1}}parseText(p){if(this.parser)this.parser.parseText(p);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+p:p;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+p:p:this.model.value=this.model.value?this.model.value+p:p}}parseClose(p){switch(p){case"c":{const{model:h}=this;if(h.formula||h.shareType)h.type=l.ValueType.Formula,h.value&&(this.t==="str"?h.result=s.xmlDecode(h.value):this.t==="b"?h.result=parseInt(h.value,10)!==0:this.t==="e"?h.result={error:h.value}:h.result=parseFloat(h.value),h.value=void 0);else if(h.value!==void 0)switch(this.t){case"s":h.type=l.ValueType.String,h.value=parseInt(h.value,10);break;case"str":h.type=l.ValueType.String,h.value=s.xmlDecode(h.value);break;case"inlineStr":h.type=l.ValueType.String;break;case"b":h.type=l.ValueType.Boolean,h.value=parseInt(h.value,10)!==0;break;case"e":h.type=l.ValueType.Error,h.value={error:h.value};break;default:h.type=l.ValueType.Number,h.value=parseFloat(h.value)}else h.styleId?h.type=l.ValueType.Null:h.type=l.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(p),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(p),!0)}}reconcile(p,h){const f=p.styleId&&h.styles&&h.styles.getStyleModel(p.styleId);switch(f&&(p.style=f),p.styleId!==void 0&&(p.styleId=void 0),p.type){case l.ValueType.String:typeof p.value=="number"&&h.sharedStrings&&(p.value=h.sharedStrings.getString(p.value)),p.value.richText&&(p.type=l.ValueType.RichText);break;case l.ValueType.Number:f&&s.isDateFmt(f.numFmt)&&(p.type=l.ValueType.Date,p.value=s.excelToDate(p.value,h.date1904));break;case l.ValueType.Formula:p.result!==void 0&&f&&s.isDateFmt(f.numFmt)&&(p.result=s.excelToDate(p.result,h.date1904)),p.shareType==="shared"&&(p.ref?h.formulae[p.si]=p.address:(p.sharedFormula=h.formulae[p.si],delete p.shareType),delete p.si)}const g=h.hyperlinkMap[p.address];g&&(p.type===l.ValueType.Formula?(p.text=p.result,p.result=void 0):(p.text=p.value,p.value=void 0),p.type=l.ValueType.Hyperlink,p.hyperlink=g);const y=h.commentsMap&&h.commentsMap[p.address];y&&(p.comment=y)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(t,r,o){const s=t("../../base-xform");r.exports=class extends s{get tag(){return"x14:cfIcon"}render(a,u){a.leafNode(this.tag,{iconSet:u.iconSet,iconId:u.iconId})}parseOpen(a){let{attributes:u}=a;this.model={iconSet:u.iconSet,iconId:s.toIntValue(u.iconId)}}parseClose(a){return a!==this.tag}}},{"../../base-xform":32}],75:[function(t,r,o){const{v4:s}=t("uuid"),a=t("../../base-xform"),u=t("../../composite-xform"),l=t("./databar-ext-xform"),i=t("./icon-set-ext-xform"),c={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class p extends u{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new l,"x14:iconSet":this.iconSetXform=new i}}get tag(){return"x14:cfRule"}static isExt(f){return f.type==="dataBar"?l.isExt(f):!(f.type!=="iconSet"||!f.custom&&!c[f.iconSet])}prepare(f){p.isExt(f)&&(f.x14Id=`{${s()}}`.toUpperCase())}render(f,g){if(p.isExt(g))switch(g.type){case"dataBar":this.renderDataBar(f,g);break;case"iconSet":this.renderIconSet(f,g)}}renderDataBar(f,g){f.openNode(this.tag,{type:"dataBar",id:g.x14Id}),this.databarXform.render(f,g),f.closeNode()}renderIconSet(f,g){f.openNode(this.tag,{type:"iconSet",priority:g.priority,id:g.x14Id||`{${s()}}`}),this.iconSetXform.render(f,g),f.closeNode()}createNewModel(f){let{attributes:g}=f;return{type:g.type,x14Id:g.id,priority:a.toIntValue(g.priority)}}onParserClose(f,g){Object.assign(this.model,g.model)}}r.exports=p},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(t,r,o){const s=t("../../composite-xform"),a=t("./f-ext-xform");r.exports=class extends s{constructor(){super(),this.map={"xm:f":this.fExtXform=new a}}get tag(){return"x14:cfvo"}render(u,l){u.openNode(this.tag,{type:l.type}),l.value!==void 0&&this.fExtXform.render(u,l.value),u.closeNode()}createNewModel(u){return{type:u.attributes.type}}onParserClose(u,l){switch(u){case"xm:f":this.model.value=l.model?parseFloat(l.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(t,r,o){const s=t("../../composite-xform"),a=t("./sqref-ext-xform"),u=t("./cf-rule-ext-xform");r.exports=class extends s{constructor(){super(),this.map={"xm:sqref":this.sqRef=new a,"x14:cfRule":this.cfRule=new u}}get tag(){return"x14:conditionalFormatting"}prepare(l,i){l.rules.forEach(c=>{this.cfRule.prepare(c,i)})}render(l,i){i.rules.some(u.isExt)&&(l.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),i.rules.filter(u.isExt).forEach(c=>this.cfRule.render(l,c)),this.sqRef.render(l,i.ref),l.closeNode())}createNewModel(){return{rules:[]}}onParserClose(l,i){switch(l){case"xm:sqref":this.model.ref=i.model;break;case"x14:cfRule":this.model.rules.push(i.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(t,r,o){const s=t("../../composite-xform"),a=t("./cf-rule-ext-xform"),u=t("./conditional-formatting-ext-xform");r.exports=class extends s{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new u}}get tag(){return"x14:conditionalFormattings"}hasContent(l){return l.hasExtContent===void 0&&(l.hasExtContent=l.some(i=>i.rules.some(a.isExt))),l.hasExtContent}prepare(l,i){l.forEach(c=>{this.cfXform.prepare(c,i)})}render(l,i){this.hasContent(i)&&(l.openNode(this.tag),i.forEach(c=>this.cfXform.render(l,c)),l.closeNode())}createNewModel(){return[]}onParserClose(l,i){this.model.push(i.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(t,r,o){const s=t("../../base-xform"),a=t("../../composite-xform"),u=t("../../style/color-xform"),l=t("./cfvo-ext-xform");r.exports=class extends a{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:borderColor":this.borderColorXform=new u("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new u("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new u("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new u("x14:axisColor")}}static isExt(i){return!i.gradient}get tag(){return"x14:dataBar"}render(i,c){i.openNode(this.tag,{minLength:s.toIntAttribute(c.minLength,0,!0),maxLength:s.toIntAttribute(c.maxLength,100,!0),border:s.toBoolAttribute(c.border,!1),gradient:s.toBoolAttribute(c.gradient,!0),negativeBarColorSameAsPositive:s.toBoolAttribute(c.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:s.toBoolAttribute(c.negativeBarBorderColorSameAsPositive,!0),axisPosition:s.toAttribute(c.axisPosition,"auto"),direction:s.toAttribute(c.direction,"leftToRight")}),c.cfvo.forEach(p=>{this.cfvoXform.render(i,p)}),this.borderColorXform.render(i,c.borderColor),this.negativeBorderColorXform.render(i,c.negativeBorderColor),this.negativeFillColorXform.render(i,c.negativeFillColor),this.axisColorXform.render(i,c.axisColor),i.closeNode()}createNewModel(i){let{attributes:c}=i;return{cfvo:[],minLength:s.toIntValue(c.minLength,0),maxLength:s.toIntValue(c.maxLength,100),border:s.toBoolValue(c.border,!1),gradient:s.toBoolValue(c.gradient,!0),negativeBarColorSameAsPositive:s.toBoolValue(c.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:s.toBoolValue(c.negativeBarBorderColorSameAsPositive,!0),axisPosition:s.toStringValue(c.axisPosition,"auto"),direction:s.toStringValue(c.direction,"leftToRight")}}onParserClose(i,c){const[,p]=i.split(":");switch(p){case"cfvo":this.model.cfvo.push(c.model);break;default:this.model[p]=c.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(t,r,o){const s=t("../../base-xform");r.exports=class extends s{get tag(){return"xm:f"}render(a,u){a.leafNode(this.tag,null,u)}parseOpen(){this.model=""}parseText(a){this.model+=a}parseClose(a){return a!==this.tag}}},{"../../base-xform":32}],81:[function(t,r,o){const s=t("../../base-xform"),a=t("../../composite-xform"),u=t("./cfvo-ext-xform"),l=t("./cf-icon-ext-xform");r.exports=class extends a{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new u,"x14:cfIcon":this.cfIconXform=new l}}get tag(){return"x14:iconSet"}render(i,c){i.openNode(this.tag,{iconSet:s.toStringAttribute(c.iconSet),reverse:s.toBoolAttribute(c.reverse,!1),showValue:s.toBoolAttribute(c.showValue,!0),custom:s.toBoolAttribute(c.icons,!1)}),c.cfvo.forEach(p=>{this.cfvoXform.render(i,p)}),c.icons&&c.icons.forEach((p,h)=>{p.iconId=h,this.cfIconXform.render(i,p)}),i.closeNode()}createNewModel(i){let{attributes:c}=i;return{cfvo:[],iconSet:s.toStringValue(c.iconSet,"3TrafficLights"),reverse:s.toBoolValue(c.reverse,!1),showValue:s.toBoolValue(c.showValue,!0)}}onParserClose(i,c){const[,p]=i.split(":");switch(p){case"cfvo":this.model.cfvo.push(c.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(c.model);break;default:this.model[p]=c.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(t,r,o){const s=t("../../base-xform");r.exports=class extends s{get tag(){return"xm:sqref"}render(a,u){a.leafNode(this.tag,null,u)}parseOpen(){this.model=""}parseText(a){this.model+=a}parseClose(a){return a!==this.tag}}},{"../../base-xform":32}],83:[function(t,r,o){const s=t("../../base-xform"),a=t("../../composite-xform"),u=t("../../../../doc/range"),l=t("./databar-xform"),i=t("./ext-lst-ref-xform"),c=t("./formula-xform"),p=t("./color-scale-xform"),h=t("./icon-set-xform"),f={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},g=b=>{const{type:v,operator:w}=b;switch(v){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:v};default:return{type:v,operator:w}}};class y extends a{constructor(){super(),this.map={dataBar:this.databarXform=new l,extLst:this.extLstRefXform=new i,formula:this.formulaXform=new c,colorScale:this.colorScaleXform=new p,iconSet:this.iconSetXform=new h}}get tag(){return"cfRule"}static isPrimitive(v){return v.type!=="iconSet"||!v.custom&&!f[v.iconSet]}render(v,w){switch(w.type){case"expression":this.renderExpression(v,w);break;case"cellIs":this.renderCellIs(v,w);break;case"top10":this.renderTop10(v,w);break;case"aboveAverage":this.renderAboveAverage(v,w);break;case"dataBar":this.renderDataBar(v,w);break;case"colorScale":this.renderColorScale(v,w);break;case"iconSet":this.renderIconSet(v,w);break;case"containsText":this.renderText(v,w);break;case"timePeriod":this.renderTimePeriod(v,w)}}renderExpression(v,w){v.openNode(this.tag,{type:"expression",dxfId:w.dxfId,priority:w.priority}),this.formulaXform.render(v,w.formulae[0]),v.closeNode()}renderCellIs(v,w){v.openNode(this.tag,{type:"cellIs",dxfId:w.dxfId,priority:w.priority,operator:w.operator}),w.formulae.forEach(S=>{this.formulaXform.render(v,S)}),v.closeNode()}renderTop10(v,w){v.leafNode(this.tag,{type:"top10",dxfId:w.dxfId,priority:w.priority,percent:s.toBoolAttribute(w.percent,!1),bottom:s.toBoolAttribute(w.bottom,!1),rank:s.toIntValue(w.rank,10,!0)})}renderAboveAverage(v,w){v.leafNode(this.tag,{type:"aboveAverage",dxfId:w.dxfId,priority:w.priority,aboveAverage:s.toBoolAttribute(w.aboveAverage,!0)})}renderDataBar(v,w){v.openNode(this.tag,{type:"dataBar",priority:w.priority}),this.databarXform.render(v,w),this.extLstRefXform.render(v,w),v.closeNode()}renderColorScale(v,w){v.openNode(this.tag,{type:"colorScale",priority:w.priority}),this.colorScaleXform.render(v,w),v.closeNode()}renderIconSet(v,w){y.isPrimitive(w)&&(v.openNode(this.tag,{type:"iconSet",priority:w.priority}),this.iconSetXform.render(v,w),v.closeNode())}renderText(v,w){v.openNode(this.tag,{type:w.operator,dxfId:w.dxfId,priority:w.priority,operator:s.toStringAttribute(w.operator,"containsText")});const S=(N=>{if(N.formulae&&N.formulae[0])return N.formulae[0];const D=new u(N.ref),{tl:F}=D;switch(N.operator){case"containsText":return`NOT(ISERROR(SEARCH("${N.text}",${F})))`;case"containsBlanks":return`LEN(TRIM(${F}))=0`;case"notContainsBlanks":return`LEN(TRIM(${F}))>0`;case"containsErrors":return`ISERROR(${F})`;case"notContainsErrors":return`NOT(ISERROR(${F}))`;default:return}})(w);S&&this.formulaXform.render(v,S),v.closeNode()}renderTimePeriod(v,w){v.openNode(this.tag,{type:"timePeriod",dxfId:w.dxfId,priority:w.priority,timePeriod:w.timePeriod});const S=(N=>{if(N.formulae&&N.formulae[0])return N.formulae[0];const D=new u(N.ref),{tl:F}=D;switch(N.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${F},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${F},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${F},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${F},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${F},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${F},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${F},1)=TODAY()-1`;case"today":return`FLOOR(${F},1)=TODAY()`;case"tomorrow":return`FLOOR(${F},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${F},1)<=6,FLOOR(${F},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${F})=MONTH(EDATE(TODAY(),0-1)),YEAR(${F})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${F})=MONTH(TODAY()),YEAR(${F})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${F})=MONTH(EDATE(TODAY(),0+1)),YEAR(${F})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(w);S&&this.formulaXform.render(v,S),v.closeNode()}createNewModel(v){let{attributes:w}=v;return{...g(w),dxfId:s.toIntValue(w.dxfId),priority:s.toIntValue(w.priority),timePeriod:w.timePeriod,percent:s.toBoolValue(w.percent),bottom:s.toBoolValue(w.bottom),rank:s.toIntValue(w.rank),aboveAverage:s.toBoolValue(w.aboveAverage)}}onParserClose(v,w){switch(v){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,w.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(w.model)}}}r.exports=y},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(t,r,o){const s=t("../../base-xform");r.exports=class extends s{get tag(){return"cfvo"}render(a,u){a.leafNode(this.tag,{type:u.type,val:u.value})}parseOpen(a){this.model={type:a.attributes.type,value:s.toFloatValue(a.attributes.val)}}parseClose(a){return a!==this.tag}}},{"../../base-xform":32}],85:[function(t,r,o){const s=t("../../composite-xform"),a=t("../../style/color-xform"),u=t("./cfvo-xform");r.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new u,color:this.colorXform=new a}}get tag(){return"colorScale"}render(l,i){l.openNode(this.tag),i.cfvo.forEach(c=>{this.cfvoXform.render(l,c)}),i.color.forEach(c=>{this.colorXform.render(l,c)}),l.closeNode()}createNewModel(l){return{cfvo:[],color:[]}}onParserClose(l,i){this.model[l].push(i.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(t,r,o){const s=t("../../composite-xform"),a=t("./cf-rule-xform");r.exports=class extends s{constructor(){super(),this.map={cfRule:new a}}get tag(){return"conditionalFormatting"}render(u,l){l.rules.some(a.isPrimitive)&&(u.openNode(this.tag,{sqref:l.ref}),l.rules.forEach(i=>{a.isPrimitive(i)&&(i.ref=l.ref,this.map.cfRule.render(u,i))}),u.closeNode())}createNewModel(u){let{attributes:l}=u;return{ref:l.sqref,rules:[]}}onParserClose(u,l){this.model.rules.push(l.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(t,r,o){const s=t("../../base-xform"),a=t("./conditional-formatting-xform");r.exports=class extends s{constructor(){super(),this.cfXform=new a}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(u,l){let i=u.reduce((c,p)=>Math.max(c,...p.rules.map(h=>h.priority||0)),1);u.forEach(c=>{c.rules.forEach(p=>{p.priority||(p.priority=i++),p.style&&(p.dxfId=l.styles.addDxfStyle(p.style))})})}render(u,l){l.forEach(i=>{this.cfXform.render(u,i)})}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return!!this.parser&&(!!this.parser.parseClose(u)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(u,l){u.forEach(i=>{i.rules.forEach(c=>{c.dxfId!==void 0&&(c.style=l.styles.getDxfStyle(c.dxfId),delete c.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(t,r,o){const s=t("../../composite-xform"),a=t("../../style/color-xform"),u=t("./cfvo-xform");r.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new u,color:this.colorXform=new a}}get tag(){return"dataBar"}render(l,i){l.openNode(this.tag),i.cfvo.forEach(c=>{this.cfvoXform.render(l,c)}),this.colorXform.render(l,i.color),l.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(l,i){switch(l){case"cfvo":this.model.cfvo.push(i.model);break;case"color":this.model.color=i.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(t,r,o){const s=t("../../base-xform"),a=t("../../composite-xform");class u extends s{get tag(){return"x14:id"}render(c,p){c.leafNode(this.tag,null,p)}parseOpen(){this.model=""}parseText(c){this.model+=c}parseClose(c){return c!==this.tag}}class l extends a{constructor(){super(),this.map={"x14:id":this.idXform=new u}}get tag(){return"ext"}render(c,p){c.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(c,p.x14Id),c.closeNode()}createNewModel(){return{}}onParserClose(c,p){this.model.x14Id=p.model}}r.exports=class extends a{constructor(){super(),this.map={ext:new l}}get tag(){return"extLst"}render(i,c){i.openNode(this.tag),this.map.ext.render(i,c),i.closeNode()}createNewModel(){return{}}onParserClose(i,c){Object.assign(this.model,c.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(t,r,o){const s=t("../../base-xform");r.exports=class extends s{get tag(){return"formula"}render(a,u){a.leafNode(this.tag,null,u)}parseOpen(){this.model=""}parseText(a){this.model+=a}parseClose(a){return a!==this.tag}}},{"../../base-xform":32}],91:[function(t,r,o){const s=t("../../base-xform"),a=t("../../composite-xform"),u=t("./cfvo-xform");r.exports=class extends a{constructor(){super(),this.map={cfvo:this.cfvoXform=new u}}get tag(){return"iconSet"}render(l,i){l.openNode(this.tag,{iconSet:s.toStringAttribute(i.iconSet,"3TrafficLights"),reverse:s.toBoolAttribute(i.reverse,!1),showValue:s.toBoolAttribute(i.showValue,!0)}),i.cfvo.forEach(c=>{this.cfvoXform.render(l,c)}),l.closeNode()}createNewModel(l){let{attributes:i}=l;return{iconSet:s.toStringValue(i.iconSet,"3TrafficLights"),reverse:s.toBoolValue(i.reverse),showValue:s.toBoolValue(i.showValue),cfvo:[]}}onParserClose(l,i){this.model[l].push(i.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(t,r,o){const s=t("../../../utils/utils"),a=t("../base-xform");r.exports=class extends a{get tag(){return"col"}prepare(u,l){const i=l.styles.addStyleModel(u.style||{});i&&(u.styleId=i)}render(u,l){u.openNode("col"),u.addAttribute("min",l.min),u.addAttribute("max",l.max),l.width&&u.addAttribute("width",l.width),l.styleId&&u.addAttribute("style",l.styleId),l.hidden&&u.addAttribute("hidden","1"),l.bestFit&&u.addAttribute("bestFit","1"),l.outlineLevel&&u.addAttribute("outlineLevel",l.outlineLevel),l.collapsed&&u.addAttribute("collapsed","1"),u.addAttribute("customWidth","1"),u.closeNode()}parseOpen(u){if(u.name==="col"){const l=this.model={min:parseInt(u.attributes.min||"0",10),max:parseInt(u.attributes.max||"0",10),width:u.attributes.width===void 0?void 0:parseFloat(u.attributes.width||"0")};return u.attributes.style&&(l.styleId=parseInt(u.attributes.style,10)),s.parseBoolean(u.attributes.hidden)&&(l.hidden=!0),s.parseBoolean(u.attributes.bestFit)&&(l.bestFit=!0),u.attributes.outlineLevel&&(l.outlineLevel=parseInt(u.attributes.outlineLevel,10)),s.parseBoolean(u.attributes.collapsed)&&(l.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(u,l){u.styleId&&(u.style=l.styles.getStyleModel(u.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../../../utils/utils"),u=t("../../../utils/col-cache"),l=t("../base-xform"),i=t("../../../doc/range");function c(h,f,g,y){const b=f[g];b!==void 0?h[g]=b:y!==void 0&&(h[g]=y)}function p(h,f,g,y){const b=f[g];b!==void 0&&(h[g]=a.parseBoolean(b))}r.exports=class extends l{get tag(){return"dataValidations"}render(h,f){const g=(function(y){const b=s.map(y,(S,N)=>({address:N,dataValidation:S,marked:!1})).sort((S,N)=>s.strcmp(S.address,N.address)),v=s.keyBy(b,"address"),w=(S,N,D)=>{for(let F=0;F<N;F++){const G=u.encodeAddress(S.row+F,D);if(!y[G]||!s.isEqual(y[S.address],y[G]))return!1}return!0};return b.map(S=>{if(!S.marked){const N=u.decodeEx(S.address);if(N.dimensions)return v[N.dimensions].marked=!0,{...S.dataValidation,sqref:S.address};let D=1,F=u.encodeAddress(N.row+D,N.col);for(;y[F]&&s.isEqual(S.dataValidation,y[F]);)D++,F=u.encodeAddress(N.row+D,N.col);let G=1;for(;w(N,D,N.col+G);)G++;for(let P=0;P<D;P++)for(let U=0;U<G;U++)F=u.encodeAddress(N.row+P,N.col+U),v[F].marked=!0;if(D>1||G>1){const P=N.row+(D-1),U=N.col+(G-1);return{...S.dataValidation,sqref:`${S.address}:${u.encodeAddress(P,U)}`}}return{...S.dataValidation,sqref:S.address}}return null}).filter(Boolean)})(f);g.length&&(h.openNode("dataValidations",{count:g.length}),g.forEach(y=>{h.openNode("dataValidation"),y.type!=="any"&&(h.addAttribute("type",y.type),y.operator&&y.type!=="list"&&y.operator!=="between"&&h.addAttribute("operator",y.operator),y.allowBlank&&h.addAttribute("allowBlank","1")),y.showInputMessage&&h.addAttribute("showInputMessage","1"),y.promptTitle&&h.addAttribute("promptTitle",y.promptTitle),y.prompt&&h.addAttribute("prompt",y.prompt),y.showErrorMessage&&h.addAttribute("showErrorMessage","1"),y.errorStyle&&h.addAttribute("errorStyle",y.errorStyle),y.errorTitle&&h.addAttribute("errorTitle",y.errorTitle),y.error&&h.addAttribute("error",y.error),h.addAttribute("sqref",y.sqref),(y.formulae||[]).forEach((b,v)=>{h.openNode("formula"+(v+1)),y.type==="date"?h.writeText(a.dateToExcel(new Date(b))):h.writeText(b),h.closeNode()}),h.closeNode()}),h.closeNode())}parseOpen(h){switch(h.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=h.attributes.sqref;const f={type:h.attributes.type||"any",formulae:[]};switch(h.attributes.type&&p(f,h.attributes,"allowBlank"),p(f,h.attributes,"showInputMessage"),p(f,h.attributes,"showErrorMessage"),f.type){case"any":case"list":case"custom":break;default:c(f,h.attributes,"operator","between")}return c(f,h.attributes,"promptTitle"),c(f,h.attributes,"prompt"),c(f,h.attributes,"errorStyle"),c(f,h.attributes,"errorTitle"),c(f,h.attributes,"error"),this._dataValidation=f,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(h){this._formula&&this._formula.push(h)}parseClose(h){switch(h){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(f=>{f.includes(":")?new i(f).forEachAddress(g=>{this.model[g]=this._dataValidation}):this.model[f]=this._dataValidation}),!0;case"formula1":case"formula2":{let f=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":f=parseInt(f,10);break;case"decimal":f=parseFloat(f);break;case"date":f=a.excelToDate(parseFloat(f))}return this._dataValidation.formulae.push(f),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"dimension"}render(a,u){u&&a.leafNode("dimension",{ref:u})}parseOpen(a){return a.name==="dimension"&&(this.model=a.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"drawing"}render(a,u){u&&a.leafNode(this.tag,{"r:id":u.rId})}parseOpen(a){switch(a.name){case this.tag:return this.model={rId:a.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(t,r,o){const s=t("../composite-xform"),a=t("./cf-ext/conditional-formattings-ext-xform");class u extends s{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new a}}get tag(){return"ext"}hasContent(i){return this.conditionalFormattings.hasContent(i.conditionalFormattings)}prepare(i,c){this.conditionalFormattings.prepare(i.conditionalFormattings,c)}render(i,c){i.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(i,c.conditionalFormattings),i.closeNode()}createNewModel(){return{}}onParserClose(i,c){this.model[i]=c.model}}r.exports=class extends s{constructor(){super(),this.map={ext:this.ext=new u}}get tag(){return"extLst"}prepare(l,i){this.ext.prepare(l,i)}hasContent(l){return this.ext.hasContent(l)}render(l,i){this.hasContent(i)&&(l.openNode("extLst"),this.ext.render(l,i),l.closeNode())}createNewModel(){return{}}onParserClose(l,i){Object.assign(this.model,i.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"headerFooter"}render(a,u){if(u){a.addRollback();let l=!1;a.openNode("headerFooter"),u.differentFirst&&(a.addAttribute("differentFirst","1"),l=!0),u.differentOddEven&&(a.addAttribute("differentOddEven","1"),l=!0),u.oddHeader&&typeof u.oddHeader=="string"&&(a.leafNode("oddHeader",null,u.oddHeader),l=!0),u.oddFooter&&typeof u.oddFooter=="string"&&(a.leafNode("oddFooter",null,u.oddFooter),l=!0),u.evenHeader&&typeof u.evenHeader=="string"&&(a.leafNode("evenHeader",null,u.evenHeader),l=!0),u.evenFooter&&typeof u.evenFooter=="string"&&(a.leafNode("evenFooter",null,u.evenFooter),l=!0),u.firstHeader&&typeof u.firstHeader=="string"&&(a.leafNode("firstHeader",null,u.firstHeader),l=!0),u.firstFooter&&typeof u.firstFooter=="string"&&(a.leafNode("firstFooter",null,u.firstFooter),l=!0),l?(a.closeNode(),a.commit()):a.rollback()}}parseOpen(a){switch(a.name){case"headerFooter":return this.model={},a.attributes.differentFirst&&(this.model.differentFirst=parseInt(a.attributes.differentFirst,0)===1),a.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(a.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(a){switch(this.currentNode){case"oddHeader":this.model.oddHeader=a;break;case"oddFooter":this.model.oddFooter=a;break;case"evenHeader":this.model.evenHeader=a;break;case"evenFooter":this.model.evenFooter=a;break;case"firstHeader":this.model.firstHeader=a;break;case"firstFooter":this.model.firstFooter=a}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"hyperlink"}render(a,u){this.isInternalLink(u)?a.leafNode("hyperlink",{ref:u.address,"r:id":u.rId,tooltip:u.tooltip,location:u.target}):a.leafNode("hyperlink",{ref:u.address,"r:id":u.rId,tooltip:u.tooltip})}parseOpen(a){return a.name==="hyperlink"&&(this.model={address:a.attributes.ref,rId:a.attributes["r:id"],tooltip:a.attributes.tooltip},a.attributes.location&&(this.model.target=a.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(a){return a.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(a.target)}}},{"../base-xform":32}],99:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"mergeCell"}render(a,u){a.leafNode("mergeCell",{ref:u})}parseOpen(a){return a.name==="mergeCell"&&(this.model=a.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../../../doc/range"),u=t("../../../utils/col-cache"),l=t("../../../doc/enums");r.exports=class{constructor(){this.merges={}}add(i){if(this.merges[i.master])this.merges[i.master].expandToAddress(i.address);else{const c=`${i.master}:${i.address}`;this.merges[i.master]=new a(c)}}get mergeCells(){return s.map(this.merges,i=>i.range)}reconcile(i,c){s.each(i,p=>{const h=u.decode(p);for(let f=h.top;f<=h.bottom;f++){const g=c[f-1];for(let y=h.left;y<=h.right;y++){const b=g.cells[y-1];b?b.type===l.ValueType.Merge&&(b.master=h.tl):g.cells[y]={type:l.ValueType.Null,address:u.encodeAddress(f,y)}}}})}getMasterAddress(i){const c=this.hash[i];return c&&c.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(t,r,o){const s=t("../base-xform"),a=u=>u!==void 0;r.exports=class extends s{get tag(){return"outlinePr"}render(u,l){return!(!l||!a(l.summaryBelow)&&!a(l.summaryRight))&&(u.leafNode(this.tag,{summaryBelow:a(l.summaryBelow)?Number(l.summaryBelow):void 0,summaryRight:a(l.summaryRight)?Number(l.summaryRight):void 0}),!0)}parseOpen(u){return u.name===this.tag&&(this.model={summaryBelow:a(u.attributes.summaryBelow)?!!Number(u.attributes.summaryBelow):void 0,summaryRight:a(u.attributes.summaryRight)?!!Number(u.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"brk"}render(a,u){a.leafNode("brk",u)}parseOpen(a){return a.name==="brk"&&(this.model=a.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../base-xform");r.exports=class extends a{get tag(){return"pageMargins"}render(u,l){if(l){const i={left:l.left,right:l.right,top:l.top,bottom:l.bottom,header:l.header,footer:l.footer};s.some(i,c=>c!==void 0)&&u.leafNode(this.tag,i)}}parseOpen(u){switch(u.name){case this.tag:return this.model={left:parseFloat(u.attributes.left||.7),right:parseFloat(u.attributes.right||.7),top:parseFloat(u.attributes.top||.75),bottom:parseFloat(u.attributes.bottom||.75),header:parseFloat(u.attributes.header||.3),footer:parseFloat(u.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"pageSetUpPr"}render(a,u){return!(!u||!u.fitToPage)&&(a.leafNode(this.tag,{fitToPage:u.fitToPage?"1":void 0}),!0)}parseOpen(a){return a.name===this.tag&&(this.model={fitToPage:a.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../base-xform");function u(p){return p?"1":void 0}function l(p){switch(p){case"overThenDown":return p;default:return}}function i(p){switch(p){case"atEnd":case"asDisplyed":return p;default:return}}function c(p){switch(p){case"dash":case"blank":case"NA":return p;default:return}}r.exports=class extends a{get tag(){return"pageSetup"}render(p,h){if(h){const f={paperSize:h.paperSize,orientation:h.orientation,horizontalDpi:h.horizontalDpi,verticalDpi:h.verticalDpi,pageOrder:l(h.pageOrder),blackAndWhite:u(h.blackAndWhite),draft:u(h.draft),cellComments:i(h.cellComments),errors:c(h.errors),scale:h.scale,fitToWidth:h.fitToWidth,fitToHeight:h.fitToHeight,firstPageNumber:h.firstPageNumber,useFirstPageNumber:u(h.firstPageNumber),usePrinterDefaults:u(h.usePrinterDefaults),copies:h.copies};s.some(f,g=>g!==void 0)&&p.leafNode(this.tag,f)}}parseOpen(p){switch(p.name){case this.tag:return this.model={paperSize:(h=p.attributes.paperSize,h!==void 0?parseInt(h,10):void 0),orientation:p.attributes.orientation||"portrait",horizontalDpi:parseInt(p.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(p.attributes.verticalDpi||"4294967295",10),pageOrder:p.attributes.pageOrder||"downThenOver",blackAndWhite:p.attributes.blackAndWhite==="1",draft:p.attributes.draft==="1",cellComments:p.attributes.cellComments||"None",errors:p.attributes.errors||"displayed",scale:parseInt(p.attributes.scale||"100",10),fitToWidth:parseInt(p.attributes.fitToWidth||"1",10),fitToHeight:parseInt(p.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(p.attributes.firstPageNumber||"1",10),useFirstPageNumber:p.attributes.useFirstPageNumber==="1",usePrinterDefaults:p.attributes.usePrinterDefaults==="1",copies:parseInt(p.attributes.copies||"1",10)},!0;default:return!1}var h}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"picture"}render(a,u){u&&a.leafNode(this.tag,{"r:id":u.rId})}parseOpen(a){switch(a.name){case this.tag:return this.model={rId:a.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../base-xform");function u(l){return l?"1":void 0}r.exports=class extends a{get tag(){return"printOptions"}render(l,i){if(i){const c={headings:u(i.showRowColHeaders),gridLines:u(i.showGridLines),horizontalCentered:u(i.horizontalCentered),verticalCentered:u(i.verticalCentered)};s.some(c,p=>p!==void 0)&&l.leafNode(this.tag,c)}}parseOpen(l){switch(l.name){case this.tag:return this.model={showRowColHeaders:l.attributes.headings==="1",showGridLines:l.attributes.gridLines==="1",horizontalCentered:l.attributes.horizontalCentered==="1",verticalCentered:l.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(t,r,o){const s=t("./page-breaks-xform"),a=t("../list-xform");r.exports=class extends a{constructor(){super({tag:"rowBreaks",count:!0,childXform:new s})}render(u,l){if(l&&l.length){u.openNode(this.tag,this.$),this.count&&(u.addAttribute(this.$count,l.length),u.addAttribute("manualBreakCount",l.length));const{childXform:i}=this;l.forEach(c=>{i.render(u,c)}),u.closeNode()}else this.empty&&u.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(t,r,o){const s=t("../base-xform"),a=t("../../../utils/utils"),u=t("./cell-xform");r.exports=class extends s{constructor(l){super(),this.maxItems=l&&l.maxItems,this.map={c:new u}}get tag(){return"row"}prepare(l,i){const c=i.styles.addStyleModel(l.style);c&&(l.styleId=c);const p=this.map.c;l.cells.forEach(h=>{p.prepare(h,i)})}render(l,i,c){l.openNode("row"),l.addAttribute("r",i.number),i.height&&(l.addAttribute("ht",i.height),l.addAttribute("customHeight","1")),i.hidden&&l.addAttribute("hidden","1"),i.min>0&&i.max>0&&i.min<=i.max&&l.addAttribute("spans",`${i.min}:${i.max}`),i.styleId&&(l.addAttribute("s",i.styleId),l.addAttribute("customFormat","1")),l.addAttribute("x14ac:dyDescent","0.25"),i.outlineLevel&&l.addAttribute("outlineLevel",i.outlineLevel),i.collapsed&&l.addAttribute("collapsed","1");const p=this.map.c;i.cells.forEach(h=>{p.render(l,h,c)}),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;if(l.name==="row"){this.numRowsSeen+=1;const i=l.attributes.spans?l.attributes.spans.split(":").map(p=>parseInt(p,10)):[void 0,void 0],c=this.model={number:parseInt(l.attributes.r,10),min:i[0],max:i[1],cells:[]};return l.attributes.s&&(c.styleId=parseInt(l.attributes.s,10)),a.parseBoolean(l.attributes.hidden)&&(c.hidden=!0),a.parseBoolean(l.attributes.bestFit)&&(c.bestFit=!0),l.attributes.ht&&(c.height=parseFloat(l.attributes.ht)),l.attributes.outlineLevel&&(c.outlineLevel=parseInt(l.attributes.outlineLevel,10)),a.parseBoolean(l.attributes.collapsed)&&(c.collapsed=!0),!0}return this.parser=this.map[l.name],!!this.parser&&(this.parser.parseOpen(l),!0)}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(l,i){l.style=l.styleId?i.styles.getStyleModel(l.styleId):{},l.styleId!==void 0&&(l.styleId=void 0);const c=this.map.c;l.cells.forEach(p=>{c.reconcile(p,i)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../base-xform");r.exports=class extends a{get tag(){return"sheetFormatPr"}render(u,l){if(l){const i={defaultRowHeight:l.defaultRowHeight,outlineLevelRow:l.outlineLevelRow,outlineLevelCol:l.outlineLevelCol,"x14ac:dyDescent":l.dyDescent};l.defaultColWidth&&(i.defaultColWidth=l.defaultColWidth),l.defaultRowHeight&&l.defaultRowHeight===15||(i.customHeight="1"),s.some(i,c=>c!==void 0)&&u.leafNode("sheetFormatPr",i)}}parseOpen(u){return u.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(u.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(u.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(u.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(u.attributes.outlineLevelCol||"0",10)},u.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(u.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(t,r,o){const s=t("../base-xform"),a=t("../style/color-xform"),u=t("./page-setup-properties-xform"),l=t("./outline-properties-xform");r.exports=class extends s{constructor(){super(),this.map={tabColor:new a("tabColor"),pageSetUpPr:new u,outlinePr:new l}}get tag(){return"sheetPr"}render(i,c){if(c){i.addRollback(),i.openNode("sheetPr");let p=!1;p=this.map.tabColor.render(i,c.tabColor)||p,p=this.map.pageSetUpPr.render(i,c.pageSetup)||p,p=this.map.outlinePr.render(i,c.outlineProperties)||p,p?(i.closeNode(),i.commit()):i.rollback()}}parseOpen(i){return this.parser?(this.parser.parseOpen(i),!0):i.name===this.tag?(this.reset(),!0):!!this.map[i.name]&&(this.parser=this.map[i.name],this.parser.parseOpen(i),!0)}parseText(i){return!!this.parser&&(this.parser.parseText(i),!0)}parseClose(i){return this.parser?(this.parser.parseClose(i)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../base-xform");function u(i,c){return i?c:void 0}function l(i,c){return i===c||void 0}r.exports=class extends a{get tag(){return"sheetProtection"}render(i,c){if(c){const p={sheet:u(c.sheet,"1"),selectLockedCells:c.selectLockedCells===!1?"1":void 0,selectUnlockedCells:c.selectUnlockedCells===!1?"1":void 0,formatCells:u(c.formatCells,"0"),formatColumns:u(c.formatColumns,"0"),formatRows:u(c.formatRows,"0"),insertColumns:u(c.insertColumns,"0"),insertRows:u(c.insertRows,"0"),insertHyperlinks:u(c.insertHyperlinks,"0"),deleteColumns:u(c.deleteColumns,"0"),deleteRows:u(c.deleteRows,"0"),sort:u(c.sort,"0"),autoFilter:u(c.autoFilter,"0"),pivotTables:u(c.pivotTables,"0")};c.sheet&&(p.algorithmName=c.algorithmName,p.hashValue=c.hashValue,p.saltValue=c.saltValue,p.spinCount=c.spinCount,p.objects=u(c.objects===!1,"1"),p.scenarios=u(c.scenarios===!1,"1")),s.some(p,h=>h!==void 0)&&i.leafNode(this.tag,p)}}parseOpen(i){switch(i.name){case this.tag:return this.model={sheet:l(i.attributes.sheet,"1"),objects:i.attributes.objects!=="1"&&void 0,scenarios:i.attributes.scenarios!=="1"&&void 0,selectLockedCells:i.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:i.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:l(i.attributes.formatCells,"0"),formatColumns:l(i.attributes.formatColumns,"0"),formatRows:l(i.attributes.formatRows,"0"),insertColumns:l(i.attributes.insertColumns,"0"),insertRows:l(i.attributes.insertRows,"0"),insertHyperlinks:l(i.attributes.insertHyperlinks,"0"),deleteColumns:l(i.attributes.deleteColumns,"0"),deleteRows:l(i.attributes.deleteRows,"0"),sort:l(i.attributes.sort,"0"),autoFilter:l(i.attributes.autoFilter,"0"),pivotTables:l(i.attributes.pivotTables,"0")},i.attributes.algorithmName&&(this.model.algorithmName=i.attributes.algorithmName,this.model.hashValue=i.attributes.hashValue,this.model.saltValue=i.attributes.saltValue,this.model.spinCount=parseInt(i.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(t,r,o){const s=t("../../../utils/col-cache"),a=t("../base-xform"),u={frozen:"frozen",frozenSplit:"frozen",split:"split"};r.exports=class extends a{get tag(){return"sheetView"}prepare(l){switch(l.state){case"frozen":case"split":break;default:l.state="normal"}}render(l,i){l.openNode("sheetView",{workbookViewId:i.workbookViewId||0});const c=function(y,b,v){v&&l.addAttribute(y,b)};let p,h,f,g;switch(c("rightToLeft","1",i.rightToLeft===!0),c("tabSelected","1",i.tabSelected),c("showRuler","0",i.showRuler===!1),c("showRowColHeaders","0",i.showRowColHeaders===!1),c("showGridLines","0",i.showGridLines===!1),c("zoomScale",i.zoomScale,i.zoomScale),c("zoomScaleNormal",i.zoomScaleNormal,i.zoomScaleNormal),c("view",i.style,i.style),i.state){case"frozen":h=i.xSplit||0,f=i.ySplit||0,p=i.topLeftCell||s.getAddress(f+1,h+1).address,g=(i.xSplit&&i.ySplit?"bottomRight":i.xSplit&&"topRight")||"bottomLeft",l.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:p,activePane:g,state:"frozen"}),l.leafNode("selection",{pane:g,activeCell:i.activeCell,sqref:i.activeCell});break;case"split":i.activePane==="topLeft"&&(i.activePane=void 0),l.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:i.topLeftCell,activePane:i.activePane}),l.leafNode("selection",{pane:i.activePane,activeCell:i.activeCell,sqref:i.activeCell});break;case"normal":i.activeCell&&l.leafNode("selection",{activeCell:i.activeCell,sqref:i.activeCell})}l.closeNode()}parseOpen(l){switch(l.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(l.attributes.workbookViewId,10),rightToLeft:l.attributes.rightToLeft==="1",tabSelected:l.attributes.tabSelected==="1",showRuler:l.attributes.showRuler!=="0",showRowColHeaders:l.attributes.showRowColHeaders!=="0",showGridLines:l.attributes.showGridLines!=="0",zoomScale:parseInt(l.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(l.attributes.zoomScaleNormal||"100",10),style:l.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(l.attributes.xSplit||"0",10),ySplit:parseInt(l.attributes.ySplit||"0",10),topLeftCell:l.attributes.topLeftCell,activePane:l.attributes.activePane||"topLeft",state:l.attributes.state},!0;case"selection":{const i=l.attributes.pane||"topLeft";return this.selections[i]={pane:i,activeCell:l.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(l){let i,c;switch(l){case"sheetView":return this.sheetView&&this.pane?(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:u[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(i.activePane=this.pane.activePane),c=this.selections[this.pane.activePane],c&&c.activeCell&&(i.activeCell=c.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)):(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},c=this.selections.topLeft,c&&c.activeCell&&(i.activeCell=c.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"tablePart"}render(a,u){u&&a.leafNode(this.tag,{"r:id":u.rId})}parseOpen(a){switch(a.name){case this.tag:return this.model={rId:a.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../../../utils/col-cache"),u=t("../../../utils/xml-stream"),l=t("../../rel-type"),i=t("./merges"),c=t("../base-xform"),p=t("../list-xform"),h=t("./row-xform"),f=t("./col-xform"),g=t("./dimension-xform"),y=t("./hyperlink-xform"),b=t("./merge-cell-xform"),v=t("./data-validations-xform"),w=t("./sheet-properties-xform"),S=t("./sheet-format-properties-xform"),N=t("./sheet-view-xform"),D=t("./sheet-protection-xform"),F=t("./page-margins-xform"),G=t("./page-setup-xform"),P=t("./print-options-xform"),U=t("./auto-filter-xform"),q=t("./picture-xform"),R=t("./drawing-xform"),I=t("./table-part-xform"),T=t("./row-breaks-xform"),L=t("./header-footer-xform"),E=t("./cf/conditional-formattings-xform"),x=t("./ext-lst-xform"),k=(C,j)=>{if(!j||!j.length)return C;if(!C||!C.length)return j;const B={},O={};return C.forEach(H=>{B[H.ref]=H,H.rules.forEach(X=>{const{x14Id:et}=X;et&&(O[et]=X)})}),j.forEach(H=>{H.rules.forEach(X=>{const et=O[X.x14Id];et?((V,tt)=>{Object.keys(tt).forEach($=>{const z=V[$],Z=tt[$];z===void 0&&Z!==void 0&&(V[$]=Z)})})(et,X):B[H.ref]?B[H.ref].rules.push(X):C.push({ref:H.ref,rules:[X]})})}),C};class A extends c{constructor(j){super();const{maxRows:B,maxCols:O,ignoreNodes:H}=j||{};this.ignoreNodes=H||[],this.map={sheetPr:new w,dimension:new g,sheetViews:new p({tag:"sheetViews",count:!1,childXform:new N}),sheetFormatPr:new S,cols:new p({tag:"cols",count:!1,childXform:new f}),sheetData:new p({tag:"sheetData",count:!1,empty:!0,childXform:new h({maxItems:O}),maxItems:B}),autoFilter:new U,mergeCells:new p({tag:"mergeCells",count:!0,childXform:new b}),rowBreaks:new T,hyperlinks:new p({tag:"hyperlinks",count:!1,childXform:new y}),pageMargins:new F,dataValidations:new v,pageSetup:new G,headerFooter:new L,printOptions:new P,picture:new q,drawing:new R,sheetProtection:new D,tableParts:new p({tag:"tableParts",count:!0,childXform:new I}),conditionalFormatting:new E,extLst:new x}}prepare(j,B){B.merges=new i,j.hyperlinks=B.hyperlinks=[],j.comments=B.comments=[],B.formulae={},B.siFormulae=0,this.map.cols.prepare(j.cols,B),this.map.sheetData.prepare(j.rows,B),this.map.conditionalFormatting.prepare(j.conditionalFormattings,B),j.mergeCells=B.merges.mergeCells;const O=j.rels=[];function H(V){return"rId"+(V.length+1)}if(j.hyperlinks.forEach(V=>{const tt=H(O);V.rId=tt,O.push({Id:tt,Type:l.Hyperlink,Target:V.target,TargetMode:"External"})}),j.comments.length>0){const V={Id:H(O),Type:l.Comments,Target:`../comments${j.id}.xml`};O.push(V);const tt={Id:H(O),Type:l.VmlDrawing,Target:`../drawings/vmlDrawing${j.id}.vml`};O.push(tt),j.comments.forEach($=>{$.refAddress=a.decodeAddress($.ref)}),B.commentRefs.push({commentName:"comments"+j.id,vmlDrawing:"vmlDrawing"+j.id})}const X=[];let et;j.media.forEach(V=>{if(V.type==="background"){const tt=H(O);et=B.media[V.imageId],O.push({Id:tt,Type:l.Image,Target:`../media/${et.name}.${et.extension}`}),j.background={rId:tt},j.image=B.media[V.imageId]}else if(V.type==="image"){let{drawing:tt}=j;et=B.media[V.imageId],tt||(tt=j.drawing={rId:H(O),name:"drawing"+ ++B.drawingsCount,anchors:[],rels:[]},B.drawings.push(tt),O.push({Id:tt.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${tt.name}.xml`}));let $=this.preImageId===V.imageId?X[V.imageId]:X[tt.rels.length];$||($=H(tt.rels),X[tt.rels.length]=$,tt.rels.push({Id:$,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${et.name}.${et.extension}`}));const z={picture:{rId:$},range:V.range};if(V.hyperlinks&&V.hyperlinks.hyperlink){const Z=H(tt.rels);X[tt.rels.length]=Z,z.picture.hyperlinks={tooltip:V.hyperlinks.tooltip,rId:Z},tt.rels.push({Id:Z,Type:l.Hyperlink,Target:V.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=V.imageId,tt.anchors.push(z)}}),j.tables.forEach(V=>{const tt=H(O);V.rId=tt,O.push({Id:tt,Type:l.Table,Target:"../tables/"+V.target}),V.columns.forEach($=>{const{style:z}=$;z&&($.dxfId=B.styles.addDxfStyle(z))})}),this.map.extLst.prepare(j,B)}render(j,B){j.openXml(u.StdDocAttributes),j.openNode("worksheet",A.WORKSHEET_ATTRIBUTES);const O=B.properties?{defaultRowHeight:B.properties.defaultRowHeight,dyDescent:B.properties.dyDescent,outlineLevelCol:B.properties.outlineLevelCol,outlineLevelRow:B.properties.outlineLevelRow}:void 0;B.properties&&B.properties.defaultColWidth&&(O.defaultColWidth=B.properties.defaultColWidth);const H={outlineProperties:B.properties&&B.properties.outlineProperties,tabColor:B.properties&&B.properties.tabColor,pageSetup:B.pageSetup&&B.pageSetup.fitToPage?{fitToPage:B.pageSetup.fitToPage}:void 0},X=B.pageSetup&&B.pageSetup.margins,et={showRowColHeaders:B.pageSetup&&B.pageSetup.showRowColHeaders,showGridLines:B.pageSetup&&B.pageSetup.showGridLines,horizontalCentered:B.pageSetup&&B.pageSetup.horizontalCentered,verticalCentered:B.pageSetup&&B.pageSetup.verticalCentered},V=B.sheetProtection;this.map.sheetPr.render(j,H),this.map.dimension.render(j,B.dimensions),this.map.sheetViews.render(j,B.views),this.map.sheetFormatPr.render(j,O),this.map.cols.render(j,B.cols),this.map.sheetData.render(j,B.rows),this.map.sheetProtection.render(j,V),this.map.autoFilter.render(j,B.autoFilter),this.map.mergeCells.render(j,B.mergeCells),this.map.conditionalFormatting.render(j,B.conditionalFormattings),this.map.dataValidations.render(j,B.dataValidations),this.map.hyperlinks.render(j,B.hyperlinks),this.map.printOptions.render(j,et),this.map.pageMargins.render(j,X),this.map.pageSetup.render(j,B.pageSetup),this.map.headerFooter.render(j,B.headerFooter),this.map.rowBreaks.render(j,B.rowBreaks),this.map.drawing.render(j,B.drawing),this.map.picture.render(j,B.background),this.map.tableParts.render(j,B.tables),this.map.extLst.render(j,B),B.rels&&B.rels.forEach(tt=>{tt.Type===l.VmlDrawing&&j.leafNode("legacyDrawing",{"r:id":tt.Id})}),j.closeNode()}parseOpen(j){return this.parser?(this.parser.parseOpen(j),!0):j.name==="worksheet"?(s.each(this.map,B=>{B.reset()}),!0):(this.map[j.name]&&!this.ignoreNodes.includes(j.name)&&(this.parser=this.map[j.name],this.parser.parseOpen(j)),!0)}parseText(j){this.parser&&this.parser.parseText(j)}parseClose(j){if(this.parser)return this.parser.parseClose(j)||(this.parser=void 0),!0;switch(j){case"worksheet":{const B=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(B.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(B.outlineProperties=this.map.sheetPr.model.outlineProperties);const O={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},H=Object.assign(O,this.map.pageSetup.model,this.map.printOptions.model),X=k(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:B,views:this.map.sheetViews.model,pageSetup:H,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:X},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(j,B){const O=(j.relationships||[]).reduce((X,et)=>{if(X[et.Id]=et,et.Type===l.Comments&&(j.comments=B.comments[et.Target].comments),et.Type===l.VmlDrawing&&j.comments&&j.comments.length){const V=B.vmlDrawings[et.Target].comments;j.comments.forEach((tt,$)=>{tt.note=Object.assign({},tt.note,V[$])})}return X},{});if(B.commentsMap=(j.comments||[]).reduce((X,et)=>(et.ref&&(X[et.ref]=et),X),{}),B.hyperlinkMap=(j.hyperlinks||[]).reduce((X,et)=>(et.rId&&(X[et.address]=O[et.rId].Target),X),{}),B.formulae={},j.rows=j.rows&&j.rows.filter(Boolean)||[],j.rows.forEach(X=>{X.cells=X.cells&&X.cells.filter(Boolean)||[]}),this.map.cols.reconcile(j.cols,B),this.map.sheetData.reconcile(j.rows,B),this.map.conditionalFormatting.reconcile(j.conditionalFormattings,B),j.media=[],j.drawing){const X=O[j.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(X){const et=X[1];B.drawings[et].anchors.forEach(V=>{if(V.medium){const tt={type:"image",imageId:V.medium.index,range:V.range,hyperlinks:V.picture.hyperlinks};j.media.push(tt)}})}}const H=j.background&&O[j.background.rId];if(H){const X=H.Target.split("/media/")[1],et=B.mediaIndex&&B.mediaIndex[X];et!==void 0&&j.media.push({type:"background",imageId:et})}j.tables=(j.tables||[]).map(X=>{const et=O[X.rId];return B.tables[et.Target]}),delete j.relationships,delete j.hyperlinks,delete j.comments}}A.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},r.exports=A},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{constructor(a){super(),this.tag=a.tag,this.attr=a.attr}render(a,u){u&&(a.openNode(this.tag),a.closeNode())}parseOpen(a){a.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{constructor(a){super(),this.tag=a.tag,this.attr=a.attr,this.attrs=a.attrs,this._format=a.format||function(u){try{return Number.isNaN(u.getTime())?"":u.toISOString()}catch{return""}},this._parse=a.parse||function(u){return new Date(u)}}render(a,u){u&&(a.openNode(this.tag),this.attrs&&a.addAttributes(this.attrs),this.attr?a.addAttribute(this.attr,this._format(u)):a.writeText(this._format(u)),a.closeNode())}parseOpen(a){a.name===this.tag&&(this.attr?this.model=this._parse(a.attributes[this.attr]):this.text=[])}parseText(a){this.attr||this.text.push(a)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{constructor(a){super(),this.tag=a.tag,this.attr=a.attr,this.attrs=a.attrs,this.zero=a.zero}render(a,u){(u||this.zero)&&(a.openNode(this.tag),this.attrs&&a.addAttributes(this.attrs),this.attr?a.addAttribute(this.attr,u):a.writeText(u),a.closeNode())}parseOpen(a){return a.name===this.tag&&(this.attr?this.model=parseInt(a.attributes[this.attr],10):this.text=[],!0)}parseText(a){this.attr||this.text.push(a)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{constructor(a){super(),this.tag=a.tag,this.attr=a.attr,this.attrs=a.attrs}render(a,u){u!==void 0&&(a.openNode(this.tag),this.attrs&&a.addAttributes(this.attrs),this.attr?a.addAttribute(this.attr,u):a.writeText(u),a.closeNode())}parseOpen(a){a.name===this.tag&&(this.attr?this.model=a.attributes[this.attr]:this.text=[])}parseText(a){this.attr||this.text.push(a)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(t,r,o){const s=t("./base-xform"),a=t("../../utils/xml-stream");r.exports=class extends s{constructor(u){super(),this._model=u}render(u){if(!this._xml){const l=new a;(function i(c,p){c.openNode(p.tag,p.$),p.c&&p.c.forEach(h=>{i(c,h)}),p.t&&c.writeText(p.t),c.closeNode()})(l,this._model),this._xml=l.xml}u.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(u){switch(u){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(t,r,o){const s=t("./text-xform"),a=t("./rich-text-xform"),u=t("../base-xform");r.exports=class extends u{constructor(){super(),this.map={r:new a,t:new s}}get tag(){return"rPh"}render(l,i){if(l.openNode(this.tag,{sb:i.sb||0,eb:i.eb||0}),i&&i.hasOwnProperty("richText")&&i.richText){const{r:c}=this.map;i.richText.forEach(p=>{c.render(l,p)})}else i&&this.map.t.render(l,i.text);l.closeNode()}parseOpen(l){const{name:i}=l;return this.parser?(this.parser.parseOpen(l),!0):i===this.tag?(this.model={sb:parseInt(l.attributes.sb,10),eb:parseInt(l.attributes.eb,10)},!0):(this.parser=this.map[i],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){switch(l){case"r":{let i=this.model.richText;i||(i=this.model.richText=[]),i.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(l){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(t,r,o){const s=t("./text-xform"),a=t("../style/font-xform"),u=t("../base-xform");class l extends u{constructor(c){super(),this.model=c}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new s)}get fontXform(){return this._fontXform||(this._fontXform=new a(l.FONT_OPTIONS))}render(c,p){p=p||this.model,c.openNode("r"),p.font&&this.fontXform.render(c,p.font),this.textXform.render(c,p.text),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(c),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){switch(c){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(c),!0}}}l.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},r.exports=l},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(t,r,o){const s=t("./text-xform"),a=t("./rich-text-xform"),u=t("./phonetic-text-xform"),l=t("../base-xform");r.exports=class extends l{constructor(i){super(),this.model=i,this.map={r:new a,t:new s,rPh:new u}}get tag(){return"si"}render(i,c){i.openNode(this.tag),c&&c.hasOwnProperty("richText")&&c.richText?c.richText.length?c.richText.forEach(p=>{this.map.r.render(i,p)}):this.map.t.render(i,""):c!=null&&this.map.t.render(i,c),i.closeNode()}parseOpen(i){const{name:c}=i;return this.parser?(this.parser.parseOpen(i),!0):c===this.tag?(this.model={},!0):(this.parser=this.map[c],!!this.parser&&(this.parser.parseOpen(i),!0))}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser){if(!this.parser.parseClose(i)){switch(i){case"r":{let c=this.model.richText;c||(c=this.model.richText=[]),c.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(t,r,o){const s=t("../../../utils/xml-stream"),a=t("../base-xform"),u=t("./shared-string-xform");r.exports=class extends a{constructor(l){super(),this.model=l||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new u)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(l){return this.model.values[l]}add(l){return l.richText?this.addRichText(l):this.addText(l)}addText(l){let i=this.hash[l];return i===void 0&&(i=this.hash[l]=this.model.values.length,this.model.values.push(l)),this.model.count++,i}addRichText(l){const i=this.sharedStringXform.toXml(l);let c=this.rich[i];return c===void 0&&(c=this.rich[i]=this.model.values.length,this.model.values.push(l)),this.model.count++,c}render(l,i){i=i||this._values,l.openXml(s.StdDocAttributes),l.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:i.count,uniqueCount:i.values.length});const c=this.sharedStringXform;i.values.forEach(p=>{c.render(l,p)}),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(l),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(l){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+l)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"t"}render(a,u){a.openNode("t"),/^\s|\n|\s$/.test(u)&&a.addAttribute("xml:space","preserve"),a.writeText(u),a.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(a,u)=>String.fromCharCode(parseInt(u,16)))}parseOpen(a){switch(a.name){case"t":return this._text=[],!0;default:return!1}}parseText(a){this._text.push(a)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(t,r,o){const s=t("../../../doc/enums"),a=t("../../../utils/utils"),u=t("../base-xform"),l={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((c,p)=>(c[p]=!0,c),{}),horizontal(c){return this.horizontalValues[c]?c:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((c,p)=>(c[p]=!0,c),{}),vertical(c){return c==="middle"?"center":this.verticalValues[c]?c:void 0},wrapText:c=>!!c||void 0,shrinkToFit:c=>!!c||void 0,textRotation(c){switch(c){case"vertical":return c;default:return(c=a.validInt(c))>=-90&&c<=90?c:void 0}},indent:c=>(c=a.validInt(c),Math.max(0,c)),readingOrder(c){switch(c){case"ltr":return s.ReadingOrder.LeftToRight;case"rtl":return s.ReadingOrder.RightToLeft;default:return}}},i={toXml(c){if(c=l.textRotation(c)){if(c==="vertical")return 255;const p=Math.round(c);if(p>=0&&p<=90)return p;if(p<0&&p>=-90)return 90-p}},toModel(c){const p=a.validInt(c);if(p!==void 0){if(p===255)return"vertical";if(p>=0&&p<=90)return p;if(p>90&&p<=180)return 90-p}}};r.exports=class extends u{get tag(){return"alignment"}render(c,p){c.addRollback(),c.openNode("alignment");let h=!1;function f(g,y){y&&(c.addAttribute(g,y),h=!0)}f("horizontal",l.horizontal(p.horizontal)),f("vertical",l.vertical(p.vertical)),f("wrapText",!!l.wrapText(p.wrapText)&&"1"),f("shrinkToFit",!!l.shrinkToFit(p.shrinkToFit)&&"1"),f("indent",l.indent(p.indent)),f("textRotation",i.toXml(p.textRotation)),f("readingOrder",l.readingOrder(p.readingOrder)),c.closeNode(),h?c.commit():c.rollback()}parseOpen(c){const p={};let h=!1;function f(g,y,b){g&&(p[y]=b,h=!0)}f(c.attributes.horizontal,"horizontal",c.attributes.horizontal),f(c.attributes.vertical,"vertical",c.attributes.vertical==="center"?"middle":c.attributes.vertical),f(c.attributes.wrapText,"wrapText",a.parseBoolean(c.attributes.wrapText)),f(c.attributes.shrinkToFit,"shrinkToFit",a.parseBoolean(c.attributes.shrinkToFit)),f(c.attributes.indent,"indent",parseInt(c.attributes.indent,10)),f(c.attributes.textRotation,"textRotation",i.toModel(c.attributes.textRotation)),f(c.attributes.readingOrder,"readingOrder",c.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=h?p:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(t,r,o){const s=t("../base-xform"),a=t("../../../utils/utils"),u=t("./color-xform");class l extends s{constructor(c){super(),this.name=c,this.map={color:new u}}get tag(){return this.name}render(c,p,h){const f=p&&p.color||h||this.defaultColor;c.openNode(this.name),p&&p.style&&(c.addAttribute("style",p.style),f&&this.map.color.render(c,f)),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.name:{const{style:p}=c.attributes;return this.model=p?{style:p}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):(c===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(c){return l.validStyleValues[c]}}l.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((i,c)=>(i[c]=!0,i),{}),r.exports=class extends s{constructor(){super(),this.map={top:new l("top"),left:new l("left"),bottom:new l("bottom"),right:new l("right"),diagonal:new l("diagonal")}}render(i,c){const{color:p}=c;function h(f,g){f&&!f.color&&c.color&&(f={...f,color:c.color}),g.render(i,f,p)}i.openNode("border"),c.diagonal&&c.diagonal.style&&(c.diagonal.up&&i.addAttribute("diagonalUp","1"),c.diagonal.down&&i.addAttribute("diagonalDown","1")),h(c.left,this.map.left),h(c.right,this.map.right),h(c.top,this.map.top),h(c.bottom,this.map.bottom),h(c.diagonal,this.map.diagonal),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"border":return this.reset(),this.diagonalUp=a.parseBoolean(i.attributes.diagonalUp),this.diagonalDown=a.parseBoolean(i.attributes.diagonalDown),!0;default:return this.parser=this.map[i.name],!!this.parser&&(this.parser.parseOpen(i),!0)}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;if(i==="border"){const c=this.model={},p=function(h,f,g){f&&(g&&Object.assign(f,g),c[h]=f)};p("left",this.map.left.model),p("right",this.map.right.model),p("top",this.map.top.model),p("bottom",this.map.bottom.model),p("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{constructor(a){super(),this.name=a||"color"}get tag(){return this.name}render(a,u){return!!u&&(a.openNode(this.name),u.argb?a.addAttribute("rgb",u.argb):u.theme!==void 0?(a.addAttribute("theme",u.theme),u.tint!==void 0&&a.addAttribute("tint",u.tint)):u.indexed!==void 0?a.addAttribute("indexed",u.indexed):a.addAttribute("auto","1"),a.closeNode(),!0)}parseOpen(a){return a.name===this.name&&(a.attributes.rgb?this.model={argb:a.attributes.rgb}:a.attributes.theme?(this.model={theme:parseInt(a.attributes.theme,10)},a.attributes.tint&&(this.model.tint=parseFloat(a.attributes.tint))):a.attributes.indexed?this.model={indexed:parseInt(a.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(t,r,o){const s=t("../base-xform"),a=t("./alignment-xform"),u=t("./border-xform"),l=t("./fill-xform"),i=t("./font-xform"),c=t("./numfmt-xform"),p=t("./protection-xform");r.exports=class extends s{constructor(){super(),this.map={alignment:new a,border:new u,fill:new l,font:new i,numFmt:new c,protection:new p}}get tag(){return"dxf"}render(h,f){if(h.openNode(this.tag),f.font&&this.map.font.render(h,f.font),f.numFmt&&f.numFmtId){const g={id:f.numFmtId,formatCode:f.numFmt};this.map.numFmt.render(h,g)}f.fill&&this.map.fill.render(h,f.fill),f.alignment&&this.map.alignment.render(h,f.alignment),f.border&&this.map.border.render(h,f.border),f.protection&&this.map.protection.render(h,f.protection),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h),!0}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return this.parser?(this.parser.parseClose(h)||(this.parser=void 0),!0):h!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(t,r,o){const s=t("../base-xform"),a=t("./color-xform");class u extends s{constructor(){super(),this.map={color:new a}}get tag(){return"stop"}render(h,f){h.openNode("stop"),h.addAttribute("position",f.position),this.map.color.render(h,f.color),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"stop":return this.model={position:parseFloat(h.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(h),!0;default:return!1}}parseText(){}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class l extends s{constructor(){super(),this.map={fgColor:new a("fgColor"),bgColor:new a("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(h,f){h.openNode("patternFill"),h.addAttribute("patternType",f.pattern),f.fgColor&&this.map.fgColor.render(h,f.fgColor),f.bgColor&&this.map.bgColor.render(h,f.bgColor),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"patternFill":return this.model={type:"pattern",pattern:h.attributes.patternType},!0;default:return this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0)}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.parser.model&&(this.model[h]=this.parser.model),this.parser=void 0),!0)}}class i extends s{constructor(){super(),this.map={stop:new u}}get name(){return"gradient"}get tag(){return"gradientFill"}render(h,f){switch(h.openNode("gradientFill"),f.gradient){case"angle":h.addAttribute("degree",f.degree);break;case"path":h.addAttribute("type","path"),f.center.left&&(h.addAttribute("left",f.center.left),f.center.right===void 0&&h.addAttribute("right",f.center.left)),f.center.right&&h.addAttribute("right",f.center.right),f.center.top&&(h.addAttribute("top",f.center.top),f.center.bottom===void 0&&h.addAttribute("bottom",f.center.top)),f.center.bottom&&h.addAttribute("bottom",f.center.bottom)}const g=this.map.stop;f.stops.forEach(y=>{g.render(h,y)}),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"gradientFill":{const f=this.model={stops:[]};return h.attributes.degree?(f.gradient="angle",f.degree=parseInt(h.attributes.degree,10)):h.attributes.type==="path"&&(f.gradient="path",f.center={left:h.attributes.left?parseFloat(h.attributes.left):0,top:h.attributes.top?parseFloat(h.attributes.top):0},h.attributes.right!==h.attributes.left&&(f.center.right=h.attributes.right?parseFloat(h.attributes.right):0),h.attributes.bottom!==h.attributes.top&&(f.center.bottom=h.attributes.bottom?parseFloat(h.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class c extends s{constructor(){super(),this.map={patternFill:new l,gradientFill:new i}}get tag(){return"fill"}render(h,f){switch(h.addRollback(),h.openNode("fill"),f.type){case"pattern":this.map.patternFill.render(h,f);break;case"gradient":this.map.gradientFill.render(h,f);break;default:return void h.rollback()}h.closeNode(),h.commit()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"fill":return this.model={},!0;default:return this.parser=this.map[h.name],!!this.parser&&(this.parser.parseOpen(h),!0)}}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return!!this.parser&&(this.parser.parseClose(h)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(h){return c.validPatternValues[h]}}c.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((p,h)=>(p[h]=!0,p),{}),c.StopXform=u,c.PatternFillXform=l,c.GradientFillXform=i,r.exports=c},{"../base-xform":32,"./color-xform":128}],131:[function(t,r,o){const s=t("./color-xform"),a=t("../simple/boolean-xform"),u=t("../simple/integer-xform"),l=t("../simple/string-xform"),i=t("./underline-xform"),c=t("../../../utils/under-dash"),p=t("../base-xform");class h extends p{constructor(g){super(),this.options=g||h.OPTIONS,this.map={b:{prop:"bold",xform:new a({tag:"b",attr:"val"})},i:{prop:"italic",xform:new a({tag:"i",attr:"val"})},u:{prop:"underline",xform:new i},charset:{prop:"charset",xform:new u({tag:"charset",attr:"val"})},color:{prop:"color",xform:new s},condense:{prop:"condense",xform:new a({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new a({tag:"extend",attr:"val"})},family:{prop:"family",xform:new u({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new a({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new l({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new l({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new a({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new a({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new u({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new l({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(g,y){const{map:b}=this;g.openNode(this.options.tagName),c.each(this.map,(v,w)=>{b[w].xform.render(g,y[v.prop])}),g.closeNode()}parseOpen(g){if(this.parser)return this.parser.parseOpen(g),!0;if(this.map[g.name])return this.parser=this.map[g.name].xform,this.parser.parseOpen(g);switch(g.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(g){this.parser&&this.parser.parseText(g)}parseClose(g){if(this.parser&&!this.parser.parseClose(g)){const y=this.map[g];return this.parser.model&&(this.model[y.prop]=this.parser.model),this.parser=void 0,!0}switch(g){case this.options.tagName:return!1;default:return!0}}}h.OPTIONS={tagName:"font",fontNameTag:"name"},r.exports=h},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(t,r,o){const s=t("../../../utils/under-dash"),a=t("../../defaultnumformats"),u=t("../base-xform"),l=(function(){const c={};return s.each(a,(p,h)=>{p.f&&(c[p.f]=parseInt(h,10))}),c})();class i extends u{constructor(p,h){super(),this.id=p,this.formatCode=h}get tag(){return"numFmt"}render(p,h){p.leafNode("numFmt",{numFmtId:h.id,formatCode:h.formatCode})}parseOpen(p){switch(p.name){case"numFmt":return this.model={id:parseInt(p.attributes.numFmtId,10),formatCode:p.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}i.getDefaultFmtId=function(c){return l[c]},i.getDefaultFmtCode=function(c){return a[c]&&a[c].f},r.exports=i},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(t,r,o){const s=t("../base-xform"),a={boolean:(u,l)=>u===void 0?l:u};r.exports=class extends s{get tag(){return"protection"}render(u,l){u.addRollback(),u.openNode("protection");let i=!1;function c(p,h){h!==void 0&&(u.addAttribute(p,h),i=!0)}c("locked",a.boolean(l.locked,!0)?void 0:"0"),c("hidden",a.boolean(l.hidden,!1)?"1":void 0),u.closeNode(),i?u.commit():u.rollback()}parseOpen(u){const l={locked:u.attributes.locked!=="0",hidden:u.attributes.hidden==="1"},i=!l.locked||l.hidden;this.model=i?l:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(t,r,o){const s=t("../base-xform"),a=t("./alignment-xform"),u=t("./protection-xform");r.exports=class extends s{constructor(l){super(),this.xfId=!(!l||!l.xfId),this.map={alignment:new a,protection:new u}}get tag(){return"xf"}render(l,i){l.openNode("xf",{numFmtId:i.numFmtId||0,fontId:i.fontId||0,fillId:i.fillId||0,borderId:i.borderId||0}),this.xfId&&l.addAttribute("xfId",i.xfId||0),i.numFmtId&&l.addAttribute("applyNumberFormat","1"),i.fontId&&l.addAttribute("applyFont","1"),i.fillId&&l.addAttribute("applyFill","1"),i.borderId&&l.addAttribute("applyBorder","1"),i.alignment&&l.addAttribute("applyAlignment","1"),i.protection&&l.addAttribute("applyProtection","1"),i.alignment&&this.map.alignment.render(l,i.alignment),i.protection&&this.map.protection.render(l,i.protection),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"xf":return this.model={numFmtId:parseInt(l.attributes.numFmtId,10),fontId:parseInt(l.attributes.fontId,10),fillId:parseInt(l.attributes.fillId,10),borderId:parseInt(l.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(l.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(l),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):l!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(t,r,o){const s=t("../../../doc/enums"),a=t("../../../utils/xml-stream"),u=t("../base-xform"),l=t("../static-xform"),i=t("../list-xform"),c=t("./font-xform"),p=t("./fill-xform"),h=t("./border-xform"),f=t("./numfmt-xform"),g=t("./style-xform"),y=t("./dxf-xform");class b extends u{constructor(w){super(),this.map={numFmts:new i({tag:"numFmts",count:!0,childXform:new f}),fonts:new i({tag:"fonts",count:!0,childXform:new c,$:{"x14ac:knownFonts":1}}),fills:new i({tag:"fills",count:!0,childXform:new p}),borders:new i({tag:"borders",count:!0,childXform:new h}),cellStyleXfs:new i({tag:"cellStyleXfs",count:!0,childXform:new g}),cellXfs:new i({tag:"cellXfs",count:!0,childXform:new g({xfId:!0})}),dxfs:new i({tag:"dxfs",always:!0,count:!0,childXform:new y}),numFmt:new f,font:new c,fill:new p,border:new h,style:new g({xfId:!0}),cellStyles:b.STATIC_XFORMS.cellStyles,tableStyles:b.STATIC_XFORMS.tableStyles,extLst:b.STATIC_XFORMS.extLst},w&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(w,S){S=S||this.model,w.openXml(a.StdDocAttributes),w.openNode("styleSheet",b.STYLESHEET_ATTRIBUTES),this.index?(S.numFmts&&S.numFmts.length&&(w.openNode("numFmts",{count:S.numFmts.length}),S.numFmts.forEach(N=>{w.writeXml(N)}),w.closeNode()),S.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),w.openNode("fonts",{count:S.fonts.length,"x14ac:knownFonts":1}),S.fonts.forEach(N=>{w.writeXml(N)}),w.closeNode(),w.openNode("fills",{count:S.fills.length}),S.fills.forEach(N=>{w.writeXml(N)}),w.closeNode(),w.openNode("borders",{count:S.borders.length}),S.borders.forEach(N=>{w.writeXml(N)}),w.closeNode(),this.map.cellStyleXfs.render(w,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),w.openNode("cellXfs",{count:S.styles.length}),S.styles.forEach(N=>{w.writeXml(N)}),w.closeNode()):(this.map.numFmts.render(w,S.numFmts),this.map.fonts.render(w,S.fonts),this.map.fills.render(w,S.fills),this.map.borders.render(w,S.borders),this.map.cellStyleXfs.render(w,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(w,S.styles)),b.STATIC_XFORMS.cellStyles.render(w),this.map.dxfs.render(w,S.dxfs),b.STATIC_XFORMS.tableStyles.render(w),b.STATIC_XFORMS.extLst.render(w),w.closeNode()}parseOpen(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[w.name],this.parser&&this.parser.parseOpen(w),!0}}parseText(w){this.parser&&this.parser.parseText(w)}parseClose(w){if(this.parser)return this.parser.parseClose(w)||(this.parser=void 0),!0;switch(w){case"styleSheet":{this.model={};const S=(N,D)=>{D.model&&D.model.length&&(this.model[N]=D.model)};if(S("numFmts",this.map.numFmts),S("fonts",this.map.fonts),S("fills",this.map.fills),S("borders",this.map.borders),S("styles",this.map.cellXfs),S("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const N=this.index.numFmt;this.model.numFmts.forEach(D=>{N[D.id]=D.formatCode})}return!1}default:return!0}}addStyleModel(w,S){if(!w)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(w))return this.weakMap.get(w);const N={};if(S=S||s.ValueType.Number,w.numFmt)N.numFmtId=this._addNumFmtStr(w.numFmt);else switch(S){case s.ValueType.Number:N.numFmtId=this._addNumFmtStr("General");break;case s.ValueType.Date:N.numFmtId=this._addNumFmtStr("mm-dd-yy")}w.font&&(N.fontId=this._addFont(w.font)),w.border&&(N.borderId=this._addBorder(w.border)),w.fill&&(N.fillId=this._addFill(w.fill)),w.alignment&&(N.alignment=w.alignment),w.protection&&(N.protection=w.protection);const D=this._addStyle(N);return this.weakMap&&this.weakMap.set(w,D),D}getStyleModel(w){const S=this.model.styles[w];if(!S)return null;let N=this.index.model[w];if(N)return N;if(N=this.index.model[w]={},S.numFmtId){const F=this.index.numFmt[S.numFmtId]||f.getDefaultFmtCode(S.numFmtId);F&&(N.numFmt=F)}function D(F,G,P){if(P||P===0){const U=G[P];U&&(N[F]=U)}}return D("font",this.model.fonts,S.fontId),D("border",this.model.borders,S.borderId),D("fill",this.model.fills,S.fillId),S.alignment&&(N.alignment=S.alignment),S.protection&&(N.protection=S.protection),N}addDxfStyle(w){return w.numFmt&&(w.numFmtId=this._addNumFmtStr(w.numFmt)),this.model.dxfs.push(w),this.model.dxfs.length-1}getDxfStyle(w){return this.model.dxfs[w]}_addStyle(w){const S=this.map.style.toXml(w);let N=this.index.style[S];return N===void 0&&(N=this.index.style[S]=this.model.styles.length,this.model.styles.push(S)),N}_addNumFmtStr(w){let S=f.getDefaultFmtId(w);if(S!==void 0||(S=this.index.numFmt[w],S!==void 0))return S;S=this.index.numFmt[w]=164+this.model.numFmts.length;const N=this.map.numFmt.toXml({id:S,formatCode:w});return this.model.numFmts.push(N),S}_addFont(w){const S=this.map.font.toXml(w);let N=this.index.font[S];return N===void 0&&(N=this.index.font[S]=this.model.fonts.length,this.model.fonts.push(S)),N}_addBorder(w){const S=this.map.border.toXml(w);let N=this.index.border[S];return N===void 0&&(N=this.index.border[S]=this.model.borders.length,this.model.borders.push(S)),N}_addFill(w){const S=this.map.fill.toXml(w);let N=this.index.fill[S];return N===void 0&&(N=this.index.fill[S]=this.model.fills.length,this.model.fills.push(S)),N}}b.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},b.STATIC_XFORMS={cellStyles:new l({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new l({tag:"dxfs",$:{count:0}}),tableStyles:new l({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new l({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},b.Mock=class extends b{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(v){return v.autodrain(),Promise.resolve()}addStyleModel(v,w){switch(w){case s.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const v={numFmtId:f.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(v)}return this._dateStyleId}getStyleModel(){return{}}},r.exports=b},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(t,r,o){const s=t("../base-xform");class a extends s{constructor(l){super(),this.model=l}get tag(){return"u"}render(l,i){if((i=i||this.model)===!0)l.leafNode("u");else{const c=a.Attributes[i];c&&l.leafNode("u",c)}}parseOpen(l){l.name==="u"&&(this.model=l.attributes.val||!0)}parseText(){}parseClose(){return!1}}a.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},r.exports=a},{"../base-xform":32}],137:[function(t,r,o){const s=t("../base-xform"),a=t("./filter-column-xform");r.exports=class extends s{constructor(){super(),this.map={filterColumn:new a}}get tag(){return"autoFilter"}prepare(u){u.columns.forEach((l,i)=>{this.map.filterColumn.prepare(l,{index:i})})}render(u,l){return u.openNode(this.tag,{ref:l.autoFilterRef}),l.columns.forEach(i=>{this.map.filterColumn.render(u,i)}),u.closeNode(),!0}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:return this.model={autoFilterRef:u.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[u.name],this.parser)return this.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"customFilter"}render(a,u){a.leafNode(this.tag,{val:u.val,operator:u.operator})}parseOpen(a){return a.name===this.tag&&(this.model={val:a.attributes.val,operator:a.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(t,r,o){const s=t("../base-xform"),a=t("../list-xform"),u=t("./custom-filter-xform"),l=t("./filter-xform");r.exports=class extends s{constructor(){super(),this.map={customFilters:new a({tag:"customFilters",count:!1,empty:!0,childXform:new u}),filters:new a({tag:"filters",count:!1,empty:!0,childXform:new l})}}get tag(){return"filterColumn"}prepare(i,c){i.colId=c.index.toString()}render(i,c){return c.customFilters?(i.openNode(this.tag,{colId:c.colId,hiddenButton:c.filterButton?"0":"1"}),this.map.customFilters.render(i,c.customFilters),i.closeNode(),!0):(i.leafNode(this.tag,{colId:c.colId,hiddenButton:c.filterButton?"0":"1"}),!0)}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;const{attributes:c}=i;switch(i.name){case this.tag:return this.model={filterButton:c.hiddenButton==="0"},!0;default:if(this.parser=this.map[i.name],this.parser)return this.parseOpen(i),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(i))}}parseText(){}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"filter"}render(a,u){a.leafNode(this.tag,{val:u.val})}parseOpen(a){return a.name===this.tag&&(this.model={val:a.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"tableColumn"}prepare(a,u){a.id=u.index+1}render(a,u){return a.leafNode(this.tag,{id:u.id.toString(),name:u.name,totalsRowLabel:u.totalsRowLabel,totalsRowFunction:u.totalsRowFunction,dxfId:u.dxfId}),!0}parseOpen(a){if(a.name===this.tag){const{attributes:u}=a;return this.model={name:u.name,totalsRowLabel:u.totalsRowLabel,totalsRowFunction:u.totalsRowFunction,dxfId:u.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(t,r,o){const s=t("../base-xform");r.exports=class extends s{get tag(){return"tableStyleInfo"}render(a,u){return a.leafNode(this.tag,{name:u.theme?u.theme:void 0,showFirstColumn:u.showFirstColumn?"1":"0",showLastColumn:u.showLastColumn?"1":"0",showRowStripes:u.showRowStripes?"1":"0",showColumnStripes:u.showColumnStripes?"1":"0"}),!0}parseOpen(a){if(a.name===this.tag){const{attributes:u}=a;return this.model={theme:u.name?u.name:null,showFirstColumn:u.showFirstColumn==="1",showLastColumn:u.showLastColumn==="1",showRowStripes:u.showRowStripes==="1",showColumnStripes:u.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(t,r,o){const s=t("../../../utils/xml-stream"),a=t("../base-xform"),u=t("../list-xform"),l=t("./auto-filter-xform"),i=t("./table-column-xform"),c=t("./table-style-info-xform");class p extends a{constructor(){super(),this.map={autoFilter:new l,tableColumns:new u({tag:"tableColumns",count:!0,empty:!0,childXform:new i}),tableStyleInfo:new c}}prepare(f,g){this.map.autoFilter.prepare(f),this.map.tableColumns.prepare(f.columns,g)}get tag(){return"table"}render(f,g){f.openXml(s.StdDocAttributes),f.openNode(this.tag,{...p.TABLE_ATTRIBUTES,id:g.id,name:g.name,displayName:g.displayName||g.name,ref:g.tableRef,totalsRowCount:g.totalsRow?"1":void 0,totalsRowShown:g.totalsRow?void 0:"1",headerRowCount:g.headerRow?"1":"0"}),this.map.autoFilter.render(f,g),this.map.tableColumns.render(f,g.columns),this.map.tableStyleInfo.render(f,g.style),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;const{name:g,attributes:y}=f;switch(g){case this.tag:this.reset(),this.model={name:y.name,displayName:y.displayName||y.name,tableRef:y.ref,totalsRow:y.totalsRowCount==="1",headerRow:y.headerRowCount==="1"};break;default:this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)}return!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((g,y)=>{this.model.columns[y].filterButton=g.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(f,g){f.columns.forEach(y=>{y.dxfId!==void 0&&(y.style=g.styles.getDxfStyle(y.dxfId))})}}p.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},r.exports=p},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(t,r,o){(function(s,a){(function(){const u=t("fs"),l=t("jszip"),{PassThrough:i}=t("readable-stream"),c=t("../utils/zip-stream"),p=t("../utils/stream-buf"),h=t("../utils/utils"),f=t("../utils/xml-stream"),{bufferToString:g}=t("../utils/browser-buffer-decode"),y=t("./xform/style/styles-xform"),b=t("./xform/core/core-xform"),v=t("./xform/strings/shared-strings-xform"),w=t("./xform/core/relationships-xform"),S=t("./xform/core/content-types-xform"),N=t("./xform/core/app-xform"),D=t("./xform/book/workbook-xform"),F=t("./xform/sheet/worksheet-xform"),G=t("./xform/drawing/drawing-xform"),P=t("./xform/table/table-xform"),U=t("./xform/comment/comments-xform"),q=t("./xform/comment/vml-notes-xform"),R=t("./xml/theme1");class I{constructor(L){this.workbook=L}async readFile(L,E){if(!await h.fs.exists(L))throw new Error("File not found: "+L);const x=u.createReadStream(L);try{const k=await this.read(x,E);return x.close(),k}catch(k){throw x.close(),k}}parseRels(L){return new w().parseStream(L)}parseWorkbook(L){return new D().parseStream(L)}parseSharedStrings(L){return new v().parseStream(L)}reconcile(L,E){const x=new D,k=new F(E),A=new G,C=new P;x.reconcile(L);const j={media:L.media,mediaIndex:L.mediaIndex};Object.keys(L.drawings).forEach(H=>{const X=L.drawings[H],et=L.drawingRels[H];et&&(j.rels=et.reduce((V,tt)=>(V[tt.Id]=tt,V),{}),(X.anchors||[]).forEach(V=>{const tt=V.picture&&V.picture.hyperlinks;tt&&j.rels[tt.rId]&&(tt.hyperlink=j.rels[tt.rId].Target,delete tt.rId)}),A.reconcile(X,j))});const B={styles:L.styles};Object.values(L.tables).forEach(H=>{C.reconcile(H,B)});const O={styles:L.styles,sharedStrings:L.sharedStrings,media:L.media,mediaIndex:L.mediaIndex,date1904:L.properties&&L.properties.date1904,drawings:L.drawings,comments:L.comments,tables:L.tables,vmlDrawings:L.vmlDrawings};L.worksheets.forEach(H=>{H.relationships=L.worksheetRels[H.sheetNo],k.reconcile(H,O)}),delete L.worksheetHash,delete L.worksheetRels,delete L.globalRels,delete L.sharedStrings,delete L.workbookRels,delete L.sheetDefs,delete L.styles,delete L.mediaIndex,delete L.drawings,delete L.drawingRels,delete L.vmlDrawings}async _processWorksheetEntry(L,E,x,k,A){const C=new F(k),j=await C.parseStream(L);j.sheetNo=x,E.worksheetHash[A]=j,E.worksheets.push(j)}async _processCommentEntry(L,E,x){const k=new U,A=await k.parseStream(L);E.comments[`../${x}.xml`]=A}async _processTableEntry(L,E,x){const k=new P,A=await k.parseStream(L);E.tables[`../tables/${x}.xml`]=A}async _processWorksheetRelsEntry(L,E,x){const k=new w,A=await k.parseStream(L);E.worksheetRels[x]=A}async _processMediaEntry(L,E,x){const k=x.lastIndexOf(".");if(k>=1){const A=x.substr(k+1),C=x.substr(0,k);await new Promise((j,B)=>{const O=new p;O.on("finish",()=>{E.mediaIndex[x]=E.media.length,E.mediaIndex[C]=E.media.length;const H={type:"image",name:C,extension:A,buffer:O.toBuffer()};E.media.push(H),j()}),L.on("error",H=>{B(H)}),L.pipe(O)})}}async _processDrawingEntry(L,E,x){const k=new G,A=await k.parseStream(L);E.drawings[x]=A}async _processDrawingRelsEntry(L,E,x){const k=new w,A=await k.parseStream(L);E.drawingRels[x]=A}async _processVmlDrawingEntry(L,E,x){const k=new q,A=await k.parseStream(L);E.vmlDrawings[`../drawings/${x}.vml`]=A}async _processThemeEntry(L,E,x){await new Promise((k,A)=>{const C=new p;L.on("error",A),C.on("error",A),C.on("finish",()=>{E.themes[x]=C.read().toString(),k()}),L.pipe(C)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(L,E){!L[Symbol.asyncIterator]&&L.pipe&&(L=L.pipe(new i));const x=[];for await(const k of L)x.push(k);return this.load(a.concat(x),E)}async load(L,E){let x;x=E&&E.base64?a.from(L.toString(),"base64"):L;const k={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},A=await l.loadAsync(x);for(const C of Object.values(A.files))if(!C.dir){let j,B=C.name;if(B[0]==="/"&&(B=B.substr(1)),B.match(/xl\/media\//)||B.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))j=new i,j.write(await C.async("nodebuffer"));else{let O;j=new i({writableObjectMode:!0,readableObjectMode:!0}),O=s.browser?g(await C.async("nodebuffer")):await C.async("string");const H=16384;for(let X=0;X<O.length;X+=H)j.write(O.substring(X,X+H))}switch(j.end(),B){case"_rels/.rels":k.globalRels=await this.parseRels(j);break;case"xl/workbook.xml":{const O=await this.parseWorkbook(j);k.sheets=O.sheets,k.definedNames=O.definedNames,k.views=O.views,k.properties=O.properties,k.calcProperties=O.calcProperties;break}case"xl/_rels/workbook.xml.rels":k.workbookRels=await this.parseRels(j);break;case"xl/sharedStrings.xml":k.sharedStrings=new v,await k.sharedStrings.parseStream(j);break;case"xl/styles.xml":k.styles=new y,await k.styles.parseStream(j);break;case"docProps/app.xml":{const O=new N,H=await O.parseStream(j);k.company=H.company,k.manager=H.manager;break}case"docProps/core.xml":{const O=new b,H=await O.parseStream(j);Object.assign(k,H);break}default:{let O=B.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(O){await this._processWorksheetEntry(j,k,O[1],E,B);break}if(O=B.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),O){await this._processWorksheetRelsEntry(j,k,O[1]);break}if(O=B.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),O){await this._processThemeEntry(j,k,O[1]);break}if(O=B.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),O){await this._processMediaEntry(j,k,O[1]);break}if(O=B.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),O){await this._processDrawingEntry(j,k,O[1]);break}if(O=B.match(/xl\/(comments\d+)[.]xml/),O){await this._processCommentEntry(j,k,O[1]);break}if(O=B.match(/xl\/tables\/(table\d+)[.]xml/),O){await this._processTableEntry(j,k,O[1]);break}if(O=B.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),O){await this._processDrawingRelsEntry(j,k,O[1]);break}if(O=B.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),O){await this._processVmlDrawingEntry(j,k,O[1]);break}}}}return this.reconcile(k,E),this.workbook.model=k,this.workbook}async addMedia(L,E){await Promise.all(E.media.map(async x=>{if(x.type==="image"){const k=`xl/media/${x.name}.${x.extension}`;if(x.filename){const A=await(function(C,j){return new Promise((B,O)=>{u.readFile(C,j,(H,X)=>{H?O(H):B(X)})})})(x.filename);return L.append(A,{name:k})}if(x.buffer)return L.append(x.buffer,{name:k});if(x.base64){const A=x.base64,C=A.substring(A.indexOf(",")+1);return L.append(C,{name:k,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(L,E){const x=new G,k=new w;E.worksheets.forEach(A=>{const{drawing:C}=A;if(C){x.prepare(C,{});let j=x.toXml(C);L.append(j,{name:`xl/drawings/${C.name}.xml`}),j=k.toXml(C.rels),L.append(j,{name:`xl/drawings/_rels/${C.name}.xml.rels`})}})}addTables(L,E){const x=new P;E.worksheets.forEach(k=>{const{tables:A}=k;A.forEach(C=>{x.prepare(C,{});const j=x.toXml(C);L.append(j,{name:"xl/tables/"+C.target})})})}async addContentTypes(L,E){const x=new S().toXml(E);L.append(x,{name:"[Content_Types].xml"})}async addApp(L,E){const x=new N().toXml(E);L.append(x,{name:"docProps/app.xml"})}async addCore(L,E){const x=new b;L.append(x.toXml(E),{name:"docProps/core.xml"})}async addThemes(L,E){const x=E.themes||{theme1:R};Object.keys(x).forEach(k=>{const A=x[k],C=`xl/theme/${k}.xml`;L.append(A,{name:C})})}async addOfficeRels(L){const E=new w().toXml([{Id:"rId1",Type:I.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:I.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:I.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);L.append(E,{name:"_rels/.rels"})}async addWorkbookRels(L,E){let x=1;const k=[{Id:"rId"+x++,Type:I.RelType.Styles,Target:"styles.xml"},{Id:"rId"+x++,Type:I.RelType.Theme,Target:"theme/theme1.xml"}];E.sharedStrings.count&&k.push({Id:"rId"+x++,Type:I.RelType.SharedStrings,Target:"sharedStrings.xml"}),E.worksheets.forEach(C=>{C.rId="rId"+x++,k.push({Id:C.rId,Type:I.RelType.Worksheet,Target:`worksheets/sheet${C.id}.xml`})});const A=new w().toXml(k);L.append(A,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(L,E){E.sharedStrings&&E.sharedStrings.count&&L.append(E.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(L,E){const{xml:x}=E.styles;x&&L.append(x,{name:"xl/styles.xml"})}async addWorkbook(L,E){const x=new D;L.append(x.toXml(E),{name:"xl/workbook.xml"})}async addWorksheets(L,E){const x=new F,k=new w,A=new U,C=new q;E.worksheets.forEach(j=>{let B=new f;x.render(B,j),L.append(B.xml,{name:`xl/worksheets/sheet${j.id}.xml`}),j.rels&&j.rels.length&&(B=new f,k.render(B,j.rels),L.append(B.xml,{name:`xl/worksheets/_rels/sheet${j.id}.xml.rels`})),j.comments.length>0&&(B=new f,A.render(B,j),L.append(B.xml,{name:`xl/comments${j.id}.xml`}),B=new f,C.render(B,j),L.append(B.xml,{name:`xl/drawings/vmlDrawing${j.id}.vml`}))})}_finalize(L){return new Promise((E,x)=>{L.on("finish",()=>{E(this)}),L.on("error",x),L.finalize()})}prepareModel(L,E){L.creator=L.creator||"ExcelJS",L.lastModifiedBy=L.lastModifiedBy||"ExcelJS",L.created=L.created||new Date,L.modified=L.modified||new Date,L.useSharedStrings=E.useSharedStrings===void 0||E.useSharedStrings,L.useStyles=E.useStyles===void 0||E.useStyles,L.sharedStrings=new v,L.styles=L.useStyles?new y(!0):new y.Mock;const x=new D,k=new F;x.prepare(L);const A={sharedStrings:L.sharedStrings,styles:L.styles,date1904:L.properties.date1904,drawingsCount:0,media:L.media};A.drawings=L.drawings=[],A.commentRefs=L.commentRefs=[];let C=0;L.tables=[],L.worksheets.forEach(j=>{j.tables.forEach(B=>{C++,B.target=`table${C}.xml`,B.id=C,L.tables.push(B)}),k.prepare(j,A)})}async write(L,E){E=E||{};const{model:x}=this.workbook,k=new c.ZipWriter(E.zip);return k.pipe(L),this.prepareModel(x,E),await this.addContentTypes(k,x),await this.addOfficeRels(k,x),await this.addWorkbookRels(k,x),await this.addWorksheets(k,x),await this.addSharedStrings(k,x),await this.addDrawings(k,x),await this.addTables(k,x),await Promise.all([this.addThemes(k,x),this.addStyles(k,x)]),await this.addMedia(k,x),await Promise.all([this.addApp(k,x),this.addCore(k,x)]),await this.addWorkbook(k,x),this._finalize(k)}writeFile(L,E){const x=u.createWriteStream(L);return new Promise((k,A)=>{x.on("finish",()=>{k()}),x.on("error",C=>{A(C)}),this.write(x,E).then(()=>{x.end()}).catch(C=>{A(C)})})}async writeBuffer(L){const E=new p;return await this.write(E,L),E.read()}}I.RelType=t("./rel-type"),r.exports=I}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(t,r,o){r.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(t,r,o){(function(s){(function(){Object.defineProperty(o,"__esModule",{value:!0}),o.CsvFormatterStream=void 0;const a=t("stream"),u=t("./formatter");class l extends a.Transform{constructor(c){super({writableObjectMode:c.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=c,this.rowFormatter=new u.RowFormatter(c),this.hasWrittenBOM=!c.writeBOM}transform(c){return this.rowFormatter.rowTransform=c,this}_transform(c,p,h){let f=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(c,(g,y)=>g?(f=!0,h(g)):(y&&y.forEach(b=>{this.push(s.from(b,"utf8"))}),f=!0,h()))}catch(g){if(f)throw g;h(g)}}_flush(c){this.rowFormatter.finish((p,h)=>p?c(p):(h&&h.forEach(f=>{this.push(s.from(f,"utf8"))}),c()))}}o.CsvFormatterStream=l}).call(this)}).call(this,t("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.FormatterOptions=void 0,o.FormatterOptions=class{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var a;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,s||{}),s?.quoteHeaders===void 0&&(this.quoteHeaders=this.quoteColumns),s?.quote===!0?this.quote='"':s?.quote===!1&&(this.quote=""),typeof s?.escape!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((a=s.writeHeaders)===null||a===void 0||a),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(t,r,o){var s=function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(o,"__esModule",{value:!0}),o.FieldFormatter=void 0;const a=s(t("lodash.isboolean")),u=s(t("lodash.isnil")),l=s(t("lodash.escaperegexp"));o.FieldFormatter=class{constructor(i){this._headers=null,this.formatterOptions=i,i.headers!==null&&(this.headers=i.headers),this.REPLACE_REGEXP=new RegExp(i.quote,"g");const c=`[${i.delimiter}${l.default(i.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(c)}set headers(i){this._headers=i}shouldQuote(i,c){const p=c?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return a.default(p)?p:Array.isArray(p)?p[i]:this._headers!==null&&p[this._headers[i]]}format(i,c,p){const h=(""+(u.default(i)?"":i)).replace(/\0/g,""),{formatterOptions:f}=this;return f.quote!==""&&h.indexOf(f.quote)!==-1?this.quoteField(h.replace(this.REPLACE_REGEXP,f.escapedQuote)):h.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(c,p)?this.quoteField(h):h}quoteField(i){const{quote:c}=this.formatterOptions;return`${c}${i}${c}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(t,r,o){var s=function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(o,"__esModule",{value:!0}),o.RowFormatter=void 0;const a=s(t("lodash.isfunction")),u=s(t("lodash.isequal")),l=t("./FieldFormatter"),i=t("../types");class c{constructor(h){this.rowCount=0,this.formatterOptions=h,this.fieldFormatter=new l.FieldFormatter(h),this.headers=h.headers,this.shouldWriteHeaders=h.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),h.transform&&(this.rowTransform=h.transform)}static isRowHashArray(h){return!!Array.isArray(h)&&Array.isArray(h[0])&&h[0].length===2}static isRowArray(h){return Array.isArray(h)&&!this.isRowHashArray(h)}static gatherHeaders(h){return c.isRowHashArray(h)?h.map(f=>f[0]):Array.isArray(h)?h:Object.keys(h)}static createTransform(h){return i.isSyncTransform(h)?(f,g)=>{let y=null;try{y=h(f)}catch(b){return g(b)}return g(null,y)}:(f,g)=>{h(f,g)}}set rowTransform(h){if(!a.default(h))throw new TypeError("The transform should be a function");this._rowTransform=c.createTransform(h)}format(h,f){this.callTransformer(h,(g,y)=>{if(g)return f(g);if(!h)return f(null);const b=[];if(y){const{shouldFormatColumns:v,headers:w}=this.checkHeaders(y);if(this.shouldWriteHeaders&&w&&!this.hasWrittenHeaders&&(b.push(this.formatColumns(w,!0)),this.hasWrittenHeaders=!0),v){const S=this.gatherColumns(y);b.push(this.formatColumns(S,!1))}}return f(null,b)})}finish(h){const f=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return h(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));f.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&f.push(this.formatterOptions.rowDelimiter),h(null,f)}checkHeaders(h){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const f=c.gatherHeaders(h);return this.headers=f,this.fieldFormatter.headers=f,this.shouldWriteHeaders?{shouldFormatColumns:!u.default(f,h),headers:f}:{shouldFormatColumns:!0,headers:null}}gatherColumns(h){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(h)?c.isRowHashArray(h)?this.headers.map((f,g)=>{const y=h[g];return y?y[1]:""}):c.isRowArray(h)&&!this.shouldWriteHeaders?h:this.headers.map((f,g)=>h[g]):this.headers.map(f=>h[f])}callTransformer(h,f){return this._rowTransform?this._rowTransform(h,f):f(null,h)}formatColumns(h,f){const g=h.map((b,v)=>this.fieldFormatter.format(b,v,f)).join(this.formatterOptions.delimiter),{rowCount:y}=this;return this.rowCount+=1,y?[this.formatterOptions.rowDelimiter,g].join(""):g}}o.RowFormatter=c},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.FieldFormatter=o.RowFormatter=void 0;var s=t("./RowFormatter");Object.defineProperty(o,"RowFormatter",{enumerable:!0,get:function(){return s.RowFormatter}});var a=t("./FieldFormatter");Object.defineProperty(o,"FieldFormatter",{enumerable:!0,get:function(){return a.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(t,r,o){(function(s){(function(){var a=Object.create?function(v,w,S,N){N===void 0&&(N=S),Object.defineProperty(v,N,{enumerable:!0,get:function(){return w[S]}})}:function(v,w,S,N){N===void 0&&(N=S),v[N]=w[S]},u=Object.create?function(v,w){Object.defineProperty(v,"default",{enumerable:!0,value:w})}:function(v,w){v.default=w},l=function(v){if(v&&v.__esModule)return v;var w={};if(v!=null)for(var S in v)S!=="default"&&Object.prototype.hasOwnProperty.call(v,S)&&a(w,v,S);return u(w,v),w},i=function(v,w){for(var S in v)S==="default"||Object.prototype.hasOwnProperty.call(w,S)||a(w,v,S)};Object.defineProperty(o,"__esModule",{value:!0}),o.writeToPath=o.writeToString=o.writeToBuffer=o.writeToStream=o.write=o.format=o.FormatterOptions=o.CsvFormatterStream=void 0;const c=t("util"),p=t("stream"),h=l(t("fs")),f=t("./FormatterOptions"),g=t("./CsvFormatterStream");i(t("./types"),o);var y=t("./CsvFormatterStream");Object.defineProperty(o,"CsvFormatterStream",{enumerable:!0,get:function(){return y.CsvFormatterStream}});var b=t("./FormatterOptions");Object.defineProperty(o,"FormatterOptions",{enumerable:!0,get:function(){return b.FormatterOptions}}),o.format=v=>new g.CsvFormatterStream(new f.FormatterOptions(v)),o.write=(v,w)=>{const S=o.format(w),N=c.promisify((D,F)=>{S.write(D,void 0,F)});return v.reduce((D,F)=>D.then(()=>N(F)),Promise.resolve()).then(()=>S.end()).catch(D=>{S.emit("error",D)}),S},o.writeToStream=(v,w,S)=>o.write(w,S).pipe(v),o.writeToBuffer=function(v){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const S=[],N=new p.Writable({write(D,F,G){S.push(D),G()}});return new Promise((D,F)=>{N.on("error",F).on("finish",()=>D(s.concat(S))),o.write(v,w).pipe(N)})},o.writeToString=(v,w)=>o.writeToBuffer(v,w).then(S=>S.toString()),o.writeToPath=(v,w,S)=>{const N=h.createWriteStream(v,{encoding:"utf8"});return o.write(w,S).pipe(N)}}).call(this)}).call(this,t("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.isSyncTransform=void 0,o.isSyncTransform=s=>s.length===1},{}],153:[function(t,r,o){(function(s){(function(){Object.defineProperty(o,"__esModule",{value:!0}),o.CsvParserStream=void 0;const a=t("string_decoder"),u=t("stream"),l=t("./transforms"),i=t("./parser");class c extends u.Transform{constructor(h){super({objectMode:h.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=h,this.parser=new i.Parser(h),this.headerTransformer=new l.HeaderTransformer(h),this.decoder=new a.StringDecoder(h.encoding),this.rowTransformerValidator=new l.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(h){return this.rowTransformerValidator.rowTransform=h,this}validate(h){return this.rowTransformerValidator.rowValidator=h,this}emit(h){if(h==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var f=arguments.length,g=new Array(f>1?f-1:0),y=1;y<f;y++)g[y-1]=arguments[y];return super.emit(h,...g)}_transform(h,f,g){if(this.hasHitRowLimit)return g();const y=c.wrapDoneCallback(g);try{const{lines:b}=this,v=b+this.decoder.write(h),w=this.parse(v,!0);return this.processRows(w,y)}catch(b){return y(b)}}_flush(h){const f=c.wrapDoneCallback(h);if(this.hasHitRowLimit)return f();try{const g=this.lines+this.decoder.end(),y=this.parse(g,!1);return this.processRows(y,f)}catch(g){return f(g)}}parse(h,f){if(!h)return[];const{line:g,rows:y}=this.parser.parse(h,f);return this.lines=g,y}processRows(h,f){const g=h.length,y=b=>{const v=N=>N?f(N):b%100!=0?y(b+1):void s(()=>y(b+1));if(this.checkAndEmitHeaders(),b>=g||this.hasHitRowLimit)return f();if(this.parsedLineCount+=1,this.shouldSkipLine)return v();const w=h[b];this.rowCount+=1,this.parsedRowCount+=1;const S=this.rowCount;return this.transformRow(w,(N,D)=>{if(N)return this.rowCount-=1,v(N);if(!D)return v(new Error("expected transform result"));if(D.isValid){if(D.row)return this.pushRow(D.row,v)}else this.emit("data-invalid",D.row,S,D.reason);return v()})};y(0)}transformRow(h,f){try{this.headerTransformer.transform(h,(g,y)=>g?f(g):y?y.isValid?y.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(y.row,f):this.skipRow(f):(this.rowCount-=1,this.parsedRowCount-=1,f(null,{row:null,isValid:!0})):this.shouldEmitRows?f(null,{isValid:!1,row:h}):this.skipRow(f):f(new Error("Expected result from header transform")))}catch(g){f(g)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(h){return this.rowCount-=1,h(null,{row:null,isValid:!0})}pushRow(h,f){try{this.parserOptions.objectMode?this.push(h):this.push(JSON.stringify(h)),f()}catch(g){f(g)}}static wrapDoneCallback(h){let f=!1;return function(g){if(g){if(f)throw g;return f=!0,void h(g)}for(var y=arguments.length,b=new Array(y>1?y-1:0),v=1;v<y;v++)b[v-1]=arguments[v];h(...b)}}}o.CsvParserStream=c}).call(this)}).call(this,t("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(t,r,o){var s=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(o,"__esModule",{value:!0}),o.ParserOptions=void 0;const a=s(t("lodash.escaperegexp")),u=s(t("lodash.isnil"));o.ParserOptions=class{constructor(l){var i;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,l||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=a.default(this.delimiter),this.escapeChar=(i=this.escape)!==null&&i!==void 0?i:this.quote,this.supportsComments=!u.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(t,r,o){var s=Object.create?function(y,b,v,w){w===void 0&&(w=v),Object.defineProperty(y,w,{enumerable:!0,get:function(){return b[v]}})}:function(y,b,v,w){w===void 0&&(w=v),y[w]=b[v]},a=Object.create?function(y,b){Object.defineProperty(y,"default",{enumerable:!0,value:b})}:function(y,b){y.default=b},u=function(y){if(y&&y.__esModule)return y;var b={};if(y!=null)for(var v in y)v!=="default"&&Object.prototype.hasOwnProperty.call(y,v)&&s(b,y,v);return a(b,y),b},l=function(y,b){for(var v in y)v==="default"||Object.prototype.hasOwnProperty.call(b,v)||s(b,y,v)};Object.defineProperty(o,"__esModule",{value:!0}),o.parseString=o.parseFile=o.parseStream=o.parse=o.ParserOptions=o.CsvParserStream=void 0;const i=u(t("fs")),c=t("stream"),p=t("./ParserOptions"),h=t("./CsvParserStream");l(t("./types"),o);var f=t("./CsvParserStream");Object.defineProperty(o,"CsvParserStream",{enumerable:!0,get:function(){return f.CsvParserStream}});var g=t("./ParserOptions");Object.defineProperty(o,"ParserOptions",{enumerable:!0,get:function(){return g.ParserOptions}}),o.parse=y=>new h.CsvParserStream(new p.ParserOptions(y)),o.parseStream=(y,b)=>y.pipe(new h.CsvParserStream(new p.ParserOptions(b))),o.parseFile=function(y){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i.createReadStream(y).pipe(new h.CsvParserStream(new p.ParserOptions(b)))},o.parseString=(y,b)=>{const v=new c.Readable;return v.push(y),v.push(null),v.pipe(new h.CsvParserStream(new p.ParserOptions(b)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.Parser=void 0;const s=t("./Scanner"),a=t("./RowParser"),u=t("./Token");class l{constructor(c){this.parserOptions=c,this.rowParser=new a.RowParser(this.parserOptions)}static removeBOM(c){return c&&c.charCodeAt(0)===65279?c.slice(1):c}parse(c,p){const h=new s.Scanner({line:l.removeBOM(c),parserOptions:this.parserOptions,hasMoreData:p});return this.parserOptions.supportsComments?this.parseWithComments(h):this.parseWithoutComments(h)}parseWithoutComments(c){const p=[];let h=!0;for(;h;)h=this.parseRow(c,p);return{line:c.line,rows:p}}parseWithComments(c){const{parserOptions:p}=this,h=[];for(let f=c.nextCharacterToken;f!==null;f=c.nextCharacterToken)if(u.Token.isTokenComment(f,p)){if(c.advancePastLine()===null)return{line:c.lineFromCursor,rows:h};if(!c.hasMoreCharacters)return{line:c.lineFromCursor,rows:h};c.truncateToCursor()}else if(!this.parseRow(c,h))break;return{line:c.line,rows:h}}parseRow(c,p){if(!c.nextNonSpaceToken)return!1;const h=this.rowParser.parse(c);return h!==null&&(this.parserOptions.ignoreEmpty&&a.RowParser.isEmptyRow(h)||p.push(h),!0)}}o.Parser=l},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.RowParser=void 0;const s=t("./column"),a=t("./Token");o.RowParser=class{constructor(u){this.parserOptions=u,this.columnParser=new s.ColumnParser(u)}static isEmptyRow(u){return u.join("").replace(/\s+/g,"")===""}parse(u){const{parserOptions:l}=this,{hasMoreData:i}=u,c=u,p=[];let h=this.getStartToken(c,p);for(;h;){if(a.Token.isTokenRowDelimiter(h))return c.advancePastToken(h),!c.hasMoreCharacters&&a.Token.isTokenCarriageReturn(h,l)&&i?null:(c.truncateToCursor(),p);if(!this.shouldSkipColumnParse(c,h,p)){const f=this.columnParser.parse(c);if(f===null)return null;p.push(f)}h=c.nextNonSpaceToken}return i?null:(c.truncateToCursor(),p)}getStartToken(u,l){const i=u.nextNonSpaceToken;return i!==null&&a.Token.isTokenDelimiter(i,this.parserOptions)?(l.push(""),u.nextNonSpaceToken):i}shouldSkipColumnParse(u,l,i){const{parserOptions:c}=this;if(a.Token.isTokenDelimiter(l,c)){u.advancePastToken(l);const p=u.nextCharacterToken;if(!u.hasMoreCharacters||p!==null&&a.Token.isTokenRowDelimiter(p)||p!==null&&a.Token.isTokenDelimiter(p,c))return i.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.Scanner=void 0;const s=t("./Token"),a=/((?:\r\n)|\n|\r)/;o.Scanner=class{constructor(u){this.cursor=0,this.line=u.line,this.lineLength=this.line.length,this.parserOptions=u.parserOptions,this.hasMoreData=u.hasMoreData,this.cursor=u.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:u}=this,l=this.parserOptions.NEXT_TOKEN_REGEXP;if(u.search(l)===-1)return null;const i=l.exec(u);if(i==null)return null;const c=i[1],p=this.cursor+(i.index||0);return new s.Token({token:c,startCursor:p,endCursor:p+c.length-1})}get nextCharacterToken(){const{cursor:u,lineLength:l}=this;return l<=u?null:new s.Token({token:this.line[u],startCursor:u,endCursor:u})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const u=a.exec(this.lineFromCursor);return u?(this.cursor+=(u.index||0)+u[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(u){return this.cursor=u,this}advanceToToken(u){return this.cursor=u.startCursor,this}advancePastToken(u){return this.cursor=u.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.Token=void 0,o.Token=class{constructor(s){this.token=s.token,this.startCursor=s.startCursor,this.endCursor=s.endCursor}static isTokenRowDelimiter(s){const a=s.token;return a==="\r"||a===`
`||a===`\r
`}static isTokenCarriageReturn(s,a){return s.token===a.carriageReturn}static isTokenComment(s,a){return a.supportsComments&&!!s&&s.token===a.comment}static isTokenEscapeCharacter(s,a){return s.token===a.escapeChar}static isTokenQuote(s,a){return s.token===a.quote}static isTokenDelimiter(s,a){return s.token===a.delimiter}}},{}],160:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.ColumnFormatter=void 0,o.ColumnFormatter=class{constructor(s){s.trim?this.format=a=>a.trim():s.ltrim?this.format=a=>a.trimLeft():s.rtrim?this.format=a=>a.trimRight():this.format=a=>a}}},{}],161:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.ColumnParser=void 0;const s=t("./NonQuotedColumnParser"),a=t("./QuotedColumnParser"),u=t("../Token");o.ColumnParser=class{constructor(l){this.parserOptions=l,this.quotedColumnParser=new a.QuotedColumnParser(l),this.nonQuotedColumnParser=new s.NonQuotedColumnParser(l)}parse(l){const{nextNonSpaceToken:i}=l;return i!==null&&u.Token.isTokenQuote(i,this.parserOptions)?(l.advanceToToken(i),this.quotedColumnParser.parse(l)):this.nonQuotedColumnParser.parse(l)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.NonQuotedColumnParser=void 0;const s=t("./ColumnFormatter"),a=t("../Token");o.NonQuotedColumnParser=class{constructor(u){this.parserOptions=u,this.columnFormatter=new s.ColumnFormatter(u)}parse(u){if(!u.hasMoreCharacters)return null;const{parserOptions:l}=this,i=[];let c=u.nextCharacterToken;for(;c&&!a.Token.isTokenDelimiter(c,l)&&!a.Token.isTokenRowDelimiter(c);c=u.nextCharacterToken)i.push(c.token),u.advancePastToken(c);return this.columnFormatter.format(i.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.QuotedColumnParser=void 0;const s=t("./ColumnFormatter"),a=t("../Token");o.QuotedColumnParser=class{constructor(u){this.parserOptions=u,this.columnFormatter=new s.ColumnFormatter(u)}parse(u){if(!u.hasMoreCharacters)return null;const l=u.cursor,{foundClosingQuote:i,col:c}=this.gatherDataBetweenQuotes(u);if(!i){if(u.advanceTo(l),!u.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${u.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(u),c}gatherDataBetweenQuotes(u){const{parserOptions:l}=this;let i=!1,c=!1;const p=[];let h=u.nextCharacterToken;for(;!c&&h!==null;h=u.nextCharacterToken){const f=a.Token.isTokenQuote(h,l);if(!i&&f)i=!0;else if(i)if(a.Token.isTokenEscapeCharacter(h,l)){u.advancePastToken(h);const g=u.nextCharacterToken;g!==null&&(a.Token.isTokenQuote(g,l)||a.Token.isTokenEscapeCharacter(g,l))?(p.push(g.token),h=g):f?c=!0:p.push(h.token)}else f?c=!0:p.push(h.token);u.advancePastToken(h)}return{col:this.columnFormatter.format(p.join("")),foundClosingQuote:c}}checkForMalformedColumn(u){const{parserOptions:l}=this,{nextNonSpaceToken:i}=u;if(i){const c=a.Token.isTokenDelimiter(i,l),p=a.Token.isTokenRowDelimiter(i);if(!c&&!p){const h=u.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${l.escapedDelimiter}' OR new line got: '${i.token}'. at '${h}`)}u.advanceToToken(i)}else u.hasMoreData||u.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.ColumnFormatter=o.QuotedColumnParser=o.NonQuotedColumnParser=o.ColumnParser=void 0;var s=t("./ColumnParser");Object.defineProperty(o,"ColumnParser",{enumerable:!0,get:function(){return s.ColumnParser}});var a=t("./NonQuotedColumnParser");Object.defineProperty(o,"NonQuotedColumnParser",{enumerable:!0,get:function(){return a.NonQuotedColumnParser}});var u=t("./QuotedColumnParser");Object.defineProperty(o,"QuotedColumnParser",{enumerable:!0,get:function(){return u.QuotedColumnParser}});var l=t("./ColumnFormatter");Object.defineProperty(o,"ColumnFormatter",{enumerable:!0,get:function(){return l.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.QuotedColumnParser=o.NonQuotedColumnParser=o.ColumnParser=o.Token=o.Scanner=o.RowParser=o.Parser=void 0;var s=t("./Parser");Object.defineProperty(o,"Parser",{enumerable:!0,get:function(){return s.Parser}});var a=t("./RowParser");Object.defineProperty(o,"RowParser",{enumerable:!0,get:function(){return a.RowParser}});var u=t("./Scanner");Object.defineProperty(o,"Scanner",{enumerable:!0,get:function(){return u.Scanner}});var l=t("./Token");Object.defineProperty(o,"Token",{enumerable:!0,get:function(){return l.Token}});var i=t("./column");Object.defineProperty(o,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}}),Object.defineProperty(o,"NonQuotedColumnParser",{enumerable:!0,get:function(){return i.NonQuotedColumnParser}}),Object.defineProperty(o,"QuotedColumnParser",{enumerable:!0,get:function(){return i.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(t,r,o){var s=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(o,"__esModule",{value:!0}),o.HeaderTransformer=void 0;const a=s(t("lodash.isundefined")),u=s(t("lodash.isfunction")),l=s(t("lodash.uniq")),i=s(t("lodash.groupby"));o.HeaderTransformer=class{constructor(c){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=c,c.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(c.headers)?this.setHeaders(c.headers):u.default(c.headers)&&(this.headersTransform=c.headers)}transform(c,p){return this.shouldMapRow(c)?p(null,this.processRow(c)):p(null,{row:null,isValid:!0})}shouldMapRow(c){const{parserOptions:p}=this;if(!this.headersTransform&&p.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(c)){if(this.headersTransform)this.setHeaders(this.headersTransform(c));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(c)}return!1}return!0}processRow(c){if(!this.headers)return{row:c,isValid:!0};const{parserOptions:p}=this;if(!p.discardUnmappedColumns&&c.length>this.headersLength){if(!p.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${c.length}`);return{row:c,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${c.length}`}}return p.strictColumnHandling&&c.length<this.headersLength?{row:c,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${c.length}`}:{row:this.mapHeaders(c),isValid:!0}}mapHeaders(c){const p={},{headers:h,headersLength:f}=this;for(let g=0;g<f;g+=1){const y=h[g];if(!a.default(y)){const b=c[g];a.default(b)?p[y]="":p[y]=b}}return p}setHeaders(c){var p;const h=c.filter(f=>!!f);if(l.default(h).length!==h.length){const f=i.default(h),g=Object.keys(f).filter(y=>f[y].length>1);throw new Error("Duplicate headers found "+JSON.stringify(g))}this.headers=c,this.receivedHeaders=!0,this.headersLength=((p=this.headers)===null||p===void 0?void 0:p.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(t,r,o){var s=function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(o,"__esModule",{value:!0}),o.RowTransformerValidator=void 0;const a=s(t("lodash.isfunction")),u=t("../types");class l{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(c){return u.isSyncTransform(c)?(p,h)=>{let f=null;try{f=c(p)}catch(g){return h(g)}return h(null,f)}:c}static createValidator(c){return u.isSyncValidate(c)?(p,h)=>{h(null,{row:p,isValid:c(p)})}:(p,h)=>{c(p,(f,g,y)=>f?h(f):h(null,g?{row:p,isValid:g,reason:y}:{row:p,isValid:!1,reason:y}))}}set rowTransform(c){if(!a.default(c))throw new TypeError("The transform should be a function");this._rowTransform=l.createTransform(c)}set rowValidator(c){if(!a.default(c))throw new TypeError("The validate should be a function");this._rowValidator=l.createValidator(c)}transformAndValidate(c,p){return this.callTransformer(c,(h,f)=>h?p(h):f?this.callValidator(f,(g,y)=>g?p(g):y&&!y.isValid?p(null,{row:f,isValid:!1,reason:y.reason}):p(null,{row:f,isValid:!0})):p(null,{row:null,isValid:!0}))}callTransformer(c,p){return this._rowTransform?this._rowTransform(c,p):p(null,c)}callValidator(c,p){return this._rowValidator?this._rowValidator(c,p):p(null,{row:c,isValid:!0})}}o.RowTransformerValidator=l},{"../types":169,"lodash.isfunction":446}],168:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.HeaderTransformer=o.RowTransformerValidator=void 0;var s=t("./RowTransformerValidator");Object.defineProperty(o,"RowTransformerValidator",{enumerable:!0,get:function(){return s.RowTransformerValidator}});var a=t("./HeaderTransformer");Object.defineProperty(o,"HeaderTransformer",{enumerable:!0,get:function(){return a.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.isSyncValidate=o.isSyncTransform=void 0,o.isSyncTransform=s=>s.length===1,o.isSyncValidate=s=>s.length===1},{}],170:[function(t,r,o){const s=o;s.bignum=t("bn.js"),s.define=t("./asn1/api").define,s.base=t("./asn1/base"),s.constants=t("./asn1/constants"),s.decoders=t("./asn1/decoders"),s.encoders=t("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(t,r,o){const s=t("./encoders"),a=t("./decoders"),u=t("inherits");function l(i,c){this.name=i,this.body=c,this.decoders={},this.encoders={}}o.define=function(i,c){return new l(i,c)},l.prototype._createNamed=function(i){const c=this.name;function p(h){this._initNamed(h,c)}return u(p,i),p.prototype._initNamed=function(h,f){i.call(this,h,f)},new p(this)},l.prototype._getDecoder=function(i){return i=i||"der",this.decoders.hasOwnProperty(i)||(this.decoders[i]=this._createNamed(a[i])),this.decoders[i]},l.prototype.decode=function(i,c,p){return this._getDecoder(c).decode(i,p)},l.prototype._getEncoder=function(i){return i=i||"der",this.encoders.hasOwnProperty(i)||(this.encoders[i]=this._createNamed(s[i])),this.encoders[i]},l.prototype.encode=function(i,c,p){return this._getEncoder(c).encode(i,p)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(t,r,o){const s=t("inherits"),a=t("../base/reporter").Reporter,u=t("safer-buffer").Buffer;function l(c,p){a.call(this,p),u.isBuffer(c)?(this.base=c,this.offset=0,this.length=c.length):this.error("Input not Buffer")}function i(c,p){if(Array.isArray(c))this.length=0,this.value=c.map((function(h){return i.isEncoderBuffer(h)||(h=new i(h,p)),this.length+=h.length,h}),this);else if(typeof c=="number"){if(!(0<=c&&c<=255))return p.error("non-byte EncoderBuffer value");this.value=c,this.length=1}else if(typeof c=="string")this.value=c,this.length=u.byteLength(c);else{if(!u.isBuffer(c))return p.error("Unsupported type: "+typeof c);this.value=c,this.length=c.length}}s(l,a),o.DecoderBuffer=l,l.isDecoderBuffer=function(c){return c instanceof l?!0:typeof c=="object"&&u.isBuffer(c.base)&&c.constructor.name==="DecoderBuffer"&&typeof c.offset=="number"&&typeof c.length=="number"&&typeof c.save=="function"&&typeof c.restore=="function"&&typeof c.isEmpty=="function"&&typeof c.readUInt8=="function"&&typeof c.skip=="function"&&typeof c.raw=="function"},l.prototype.save=function(){return{offset:this.offset,reporter:a.prototype.save.call(this)}},l.prototype.restore=function(c){const p=new l(this.base);return p.offset=c.offset,p.length=this.offset,this.offset=c.offset,a.prototype.restore.call(this,c.reporter),p},l.prototype.isEmpty=function(){return this.offset===this.length},l.prototype.readUInt8=function(c){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(c||"DecoderBuffer overrun")},l.prototype.skip=function(c,p){if(!(this.offset+c<=this.length))return this.error(p||"DecoderBuffer overrun");const h=new l(this.base);return h._reporterState=this._reporterState,h.offset=this.offset,h.length=this.offset+c,this.offset+=c,h},l.prototype.raw=function(c){return this.base.slice(c?c.offset:this.offset,this.length)},o.EncoderBuffer=i,i.isEncoderBuffer=function(c){return c instanceof i?!0:typeof c=="object"&&c.constructor.name==="EncoderBuffer"&&typeof c.length=="number"&&typeof c.join=="function"},i.prototype.join=function(c,p){return c||(c=u.alloc(this.length)),p||(p=0),this.length===0||(Array.isArray(this.value)?this.value.forEach((function(h){h.join(c,p),p+=h.length})):(typeof this.value=="number"?c[p]=this.value:typeof this.value=="string"?c.write(this.value,p):u.isBuffer(this.value)&&this.value.copy(c,p),p+=this.length)),c}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(t,r,o){const s=o;s.Reporter=t("./reporter").Reporter,s.DecoderBuffer=t("./buffer").DecoderBuffer,s.EncoderBuffer=t("./buffer").EncoderBuffer,s.Node=t("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(t,r,o){const s=t("../base/reporter").Reporter,a=t("../base/buffer").EncoderBuffer,u=t("../base/buffer").DecoderBuffer,l=t("minimalistic-assert"),i=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(i);function p(f,g,y){const b={};this._baseState=b,b.name=y,b.enc=f,b.parent=g||null,b.children=null,b.tag=null,b.args=null,b.reverseArgs=null,b.choice=null,b.optional=!1,b.any=!1,b.obj=!1,b.use=null,b.useDecoder=null,b.key=null,b.default=null,b.explicit=null,b.implicit=null,b.contains=null,b.parent||(b.children=[],this._wrap())}r.exports=p;const h=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];p.prototype.clone=function(){const f=this._baseState,g={};h.forEach((function(b){g[b]=f[b]}));const y=new this.constructor(g.parent);return y._baseState=g,y},p.prototype._wrap=function(){const f=this._baseState;c.forEach((function(g){this[g]=function(){const y=new this.constructor(this);return f.children.push(y),y[g].apply(y,arguments)}}),this)},p.prototype._init=function(f){const g=this._baseState;l(g.parent===null),f.call(this),g.children=g.children.filter((function(y){return y._baseState.parent===this}),this),l.equal(g.children.length,1,"Root node can have only one child")},p.prototype._useArgs=function(f){const g=this._baseState,y=f.filter((function(b){return b instanceof this.constructor}),this);f=f.filter((function(b){return!(b instanceof this.constructor)}),this),y.length!==0&&(l(g.children===null),g.children=y,y.forEach((function(b){b._baseState.parent=this}),this)),f.length!==0&&(l(g.args===null),g.args=f,g.reverseArgs=f.map((function(b){if(typeof b!="object"||b.constructor!==Object)return b;const v={};return Object.keys(b).forEach((function(w){w==(0|w)&&(w|=0);const S=b[w];v[S]=w})),v})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(f){p.prototype[f]=function(){const g=this._baseState;throw new Error(f+" not implemented for encoding: "+g.enc)}})),i.forEach((function(f){p.prototype[f]=function(){const g=this._baseState,y=Array.prototype.slice.call(arguments);return l(g.tag===null),g.tag=f,this._useArgs(y),this}})),p.prototype.use=function(f){l(f);const g=this._baseState;return l(g.use===null),g.use=f,this},p.prototype.optional=function(){return this._baseState.optional=!0,this},p.prototype.def=function(f){const g=this._baseState;return l(g.default===null),g.default=f,g.optional=!0,this},p.prototype.explicit=function(f){const g=this._baseState;return l(g.explicit===null&&g.implicit===null),g.explicit=f,this},p.prototype.implicit=function(f){const g=this._baseState;return l(g.explicit===null&&g.implicit===null),g.implicit=f,this},p.prototype.obj=function(){const f=this._baseState,g=Array.prototype.slice.call(arguments);return f.obj=!0,g.length!==0&&this._useArgs(g),this},p.prototype.key=function(f){const g=this._baseState;return l(g.key===null),g.key=f,this},p.prototype.any=function(){return this._baseState.any=!0,this},p.prototype.choice=function(f){const g=this._baseState;return l(g.choice===null),g.choice=f,this._useArgs(Object.keys(f).map((function(y){return f[y]}))),this},p.prototype.contains=function(f){const g=this._baseState;return l(g.use===null),g.contains=f,this},p.prototype._decode=function(f,g){const y=this._baseState;if(y.parent===null)return f.wrapResult(y.children[0]._decode(f,g));let b,v=y.default,w=!0,S=null;if(y.key!==null&&(S=f.enterKey(y.key)),y.optional){let N=null;if(y.explicit!==null?N=y.explicit:y.implicit!==null?N=y.implicit:y.tag!==null&&(N=y.tag),N!==null||y.any){if(w=this._peekTag(f,N,y.any),f.isError(w))return w}else{const D=f.save();try{y.choice===null?this._decodeGeneric(y.tag,f,g):this._decodeChoice(f,g),w=!0}catch{w=!1}f.restore(D)}}if(y.obj&&w&&(b=f.enterObject()),w){if(y.explicit!==null){const D=this._decodeTag(f,y.explicit);if(f.isError(D))return D;f=D}const N=f.offset;if(y.use===null&&y.choice===null){let D;y.any&&(D=f.save());const F=this._decodeTag(f,y.implicit!==null?y.implicit:y.tag,y.any);if(f.isError(F))return F;y.any?v=f.raw(D):f=F}if(g&&g.track&&y.tag!==null&&g.track(f.path(),N,f.length,"tagged"),g&&g.track&&y.tag!==null&&g.track(f.path(),f.offset,f.length,"content"),y.any||(v=y.choice===null?this._decodeGeneric(y.tag,f,g):this._decodeChoice(f,g)),f.isError(v))return v;if(y.any||y.choice!==null||y.children===null||y.children.forEach((function(D){D._decode(f,g)})),y.contains&&(y.tag==="octstr"||y.tag==="bitstr")){const D=new u(v);v=this._getUse(y.contains,f._reporterState.obj)._decode(D,g)}}return y.obj&&w&&(v=f.leaveObject(b)),y.key===null||v===null&&w!==!0?S!==null&&f.exitKey(S):f.leaveKey(S,y.key,v),v},p.prototype._decodeGeneric=function(f,g,y){const b=this._baseState;return f==="seq"||f==="set"?null:f==="seqof"||f==="setof"?this._decodeList(g,f,b.args[0],y):/str$/.test(f)?this._decodeStr(g,f,y):f==="objid"&&b.args?this._decodeObjid(g,b.args[0],b.args[1],y):f==="objid"?this._decodeObjid(g,null,null,y):f==="gentime"||f==="utctime"?this._decodeTime(g,f,y):f==="null_"?this._decodeNull(g,y):f==="bool"?this._decodeBool(g,y):f==="objDesc"?this._decodeStr(g,f,y):f==="int"||f==="enum"?this._decodeInt(g,b.args&&b.args[0],y):b.use!==null?this._getUse(b.use,g._reporterState.obj)._decode(g,y):g.error("unknown tag: "+f)},p.prototype._getUse=function(f,g){const y=this._baseState;return y.useDecoder=this._use(f,g),l(y.useDecoder._baseState.parent===null),y.useDecoder=y.useDecoder._baseState.children[0],y.implicit!==y.useDecoder._baseState.implicit&&(y.useDecoder=y.useDecoder.clone(),y.useDecoder._baseState.implicit=y.implicit),y.useDecoder},p.prototype._decodeChoice=function(f,g){const y=this._baseState;let b=null,v=!1;return Object.keys(y.choice).some((function(w){const S=f.save(),N=y.choice[w];try{const D=N._decode(f,g);if(f.isError(D))return!1;b={type:w,value:D},v=!0}catch{return f.restore(S),!1}return!0}),this),v?b:f.error("Choice not matched")},p.prototype._createEncoderBuffer=function(f){return new a(f,this.reporter)},p.prototype._encode=function(f,g,y){const b=this._baseState;if(b.default!==null&&b.default===f)return;const v=this._encodeValue(f,g,y);return v===void 0||this._skipDefault(v,g,y)?void 0:v},p.prototype._encodeValue=function(f,g,y){const b=this._baseState;if(b.parent===null)return b.children[0]._encode(f,g||new s);let v=null;if(this.reporter=g,b.optional&&f===void 0){if(b.default===null)return;f=b.default}let w=null,S=!1;if(b.any)v=this._createEncoderBuffer(f);else if(b.choice)v=this._encodeChoice(f,g);else if(b.contains)w=this._getUse(b.contains,y)._encode(f,g),S=!0;else if(b.children)w=b.children.map((function(N){if(N._baseState.tag==="null_")return N._encode(null,g,f);if(N._baseState.key===null)return g.error("Child should have a key");const D=g.enterKey(N._baseState.key);if(typeof f!="object")return g.error("Child expected, but input is not object");const F=N._encode(f[N._baseState.key],g,f);return g.leaveKey(D),F}),this).filter((function(N){return N})),w=this._createEncoderBuffer(w);else if(b.tag==="seqof"||b.tag==="setof"){if(!b.args||b.args.length!==1)return g.error("Too many args for : "+b.tag);if(!Array.isArray(f))return g.error("seqof/setof, but data is not Array");const N=this.clone();N._baseState.implicit=null,w=this._createEncoderBuffer(f.map((function(D){const F=this._baseState;return this._getUse(F.args[0],f)._encode(D,g)}),N))}else b.use!==null?v=this._getUse(b.use,y)._encode(f,g):(w=this._encodePrimitive(b.tag,f),S=!0);if(!b.any&&b.choice===null){const N=b.implicit!==null?b.implicit:b.tag,D=b.implicit===null?"universal":"context";N===null?b.use===null&&g.error("Tag could be omitted only for .use()"):b.use===null&&(v=this._encodeComposite(N,S,D,w))}return b.explicit!==null&&(v=this._encodeComposite(b.explicit,!1,"context",v)),v},p.prototype._encodeChoice=function(f,g){const y=this._baseState,b=y.choice[f.type];return b||l(!1,f.type+" not found in "+JSON.stringify(Object.keys(y.choice))),b._encode(f.value,g)},p.prototype._encodePrimitive=function(f,g){const y=this._baseState;if(/str$/.test(f))return this._encodeStr(g,f);if(f==="objid"&&y.args)return this._encodeObjid(g,y.reverseArgs[0],y.args[1]);if(f==="objid")return this._encodeObjid(g,null,null);if(f==="gentime"||f==="utctime")return this._encodeTime(g,f);if(f==="null_")return this._encodeNull();if(f==="int"||f==="enum")return this._encodeInt(g,y.args&&y.reverseArgs[0]);if(f==="bool")return this._encodeBool(g);if(f==="objDesc")return this._encodeStr(g,f);throw new Error("Unsupported tag: "+f)},p.prototype._isNumstr=function(f){return/^[0-9 ]*$/.test(f)},p.prototype._isPrintstr=function(f){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(f)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(t,r,o){const s=t("inherits");function a(l){this._reporterState={obj:null,path:[],options:l||{},errors:[]}}function u(l,i){this.path=l,this.rethrow(i)}o.Reporter=a,a.prototype.isError=function(l){return l instanceof u},a.prototype.save=function(){const l=this._reporterState;return{obj:l.obj,pathLen:l.path.length}},a.prototype.restore=function(l){const i=this._reporterState;i.obj=l.obj,i.path=i.path.slice(0,l.pathLen)},a.prototype.enterKey=function(l){return this._reporterState.path.push(l)},a.prototype.exitKey=function(l){const i=this._reporterState;i.path=i.path.slice(0,l-1)},a.prototype.leaveKey=function(l,i,c){const p=this._reporterState;this.exitKey(l),p.obj!==null&&(p.obj[i]=c)},a.prototype.path=function(){return this._reporterState.path.join("/")},a.prototype.enterObject=function(){const l=this._reporterState,i=l.obj;return l.obj={},i},a.prototype.leaveObject=function(l){const i=this._reporterState,c=i.obj;return i.obj=l,c},a.prototype.error=function(l){let i;const c=this._reporterState,p=l instanceof u;if(i=p?l:new u(c.path.map((function(h){return"["+JSON.stringify(h)+"]"})).join(""),l.message||l,l.stack),!c.options.partial)throw i;return p||c.errors.push(i),i},a.prototype.wrapResult=function(l){const i=this._reporterState;return i.options.partial?{result:this.isError(l)?null:l,errors:i.errors}:l},s(u,Error),u.prototype.rethrow=function(l){if(this.message=l+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,u),!this.stack)try{throw new Error(this.message)}catch(i){this.stack=i.stack}return this}},{inherits:440}],176:[function(t,r,o){function s(a){const u={};return Object.keys(a).forEach((function(l){(0|l)==l&&(l|=0);const i=a[l];u[i]=l})),u}o.tagClass={0:"universal",1:"application",2:"context",3:"private"},o.tagClassByName=s(o.tagClass),o.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},o.tagByName=s(o.tag)},{}],177:[function(t,r,o){const s=o;s._reverse=function(a){const u={};return Object.keys(a).forEach((function(l){(0|l)==l&&(l|=0);const i=a[l];u[i]=l})),u},s.der=t("./der")},{"./der":176}],178:[function(t,r,o){const s=t("inherits"),a=t("bn.js"),u=t("../base/buffer").DecoderBuffer,l=t("../base/node"),i=t("../constants/der");function c(g){this.enc="der",this.name=g.name,this.entity=g,this.tree=new p,this.tree._init(g.body)}function p(g){l.call(this,"der",g)}function h(g,y){let b=g.readUInt8(y);if(g.isError(b))return b;const v=i.tagClass[b>>6],w=(32&b)==0;if((31&b)==31){let S=b;for(b=0;(128&S)==128;){if(S=g.readUInt8(y),g.isError(S))return S;b<<=7,b|=127&S}}else b&=31;return{cls:v,primitive:w,tag:b,tagStr:i.tag[b]}}function f(g,y,b){let v=g.readUInt8(b);if(g.isError(v))return v;if(!y&&v===128)return null;if((128&v)==0)return v;const w=127&v;if(w>4)return g.error("length octect is too long");v=0;for(let S=0;S<w;S++){v<<=8;const N=g.readUInt8(b);if(g.isError(N))return N;v|=N}return v}r.exports=c,c.prototype.decode=function(g,y){return u.isDecoderBuffer(g)||(g=new u(g,y)),this.tree._decode(g,y)},s(p,l),p.prototype._peekTag=function(g,y,b){if(g.isEmpty())return!1;const v=g.save(),w=h(g,'Failed to peek tag: "'+y+'"');return g.isError(w)?w:(g.restore(v),w.tag===y||w.tagStr===y||w.tagStr+"of"===y||b)},p.prototype._decodeTag=function(g,y,b){const v=h(g,'Failed to decode tag of "'+y+'"');if(g.isError(v))return v;let w=f(g,v.primitive,'Failed to get length of "'+y+'"');if(g.isError(w))return w;if(!b&&v.tag!==y&&v.tagStr!==y&&v.tagStr+"of"!==y)return g.error('Failed to match tag: "'+y+'"');if(v.primitive||w!==null)return g.skip(w,'Failed to match body of: "'+y+'"');const S=g.save(),N=this._skipUntilEnd(g,'Failed to skip indefinite length body: "'+this.tag+'"');return g.isError(N)?N:(w=g.offset-S.offset,g.restore(S),g.skip(w,'Failed to match body of: "'+y+'"'))},p.prototype._skipUntilEnd=function(g,y){for(;;){const b=h(g,y);if(g.isError(b))return b;const v=f(g,b.primitive,y);if(g.isError(v))return v;let w;if(w=b.primitive||v!==null?g.skip(v):this._skipUntilEnd(g,y),g.isError(w))return w;if(b.tagStr==="end")break}},p.prototype._decodeList=function(g,y,b,v){const w=[];for(;!g.isEmpty();){const S=this._peekTag(g,"end");if(g.isError(S))return S;const N=b.decode(g,"der",v);if(g.isError(N)&&S)break;w.push(N)}return w},p.prototype._decodeStr=function(g,y){if(y==="bitstr"){const b=g.readUInt8();return g.isError(b)?b:{unused:b,data:g.raw()}}if(y==="bmpstr"){const b=g.raw();if(b.length%2==1)return g.error("Decoding of string type: bmpstr length mismatch");let v="";for(let w=0;w<b.length/2;w++)v+=String.fromCharCode(b.readUInt16BE(2*w));return v}if(y==="numstr"){const b=g.raw().toString("ascii");return this._isNumstr(b)?b:g.error("Decoding of string type: numstr unsupported characters")}if(y==="octstr"||y==="objDesc")return g.raw();if(y==="printstr"){const b=g.raw().toString("ascii");return this._isPrintstr(b)?b:g.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(y)?g.raw().toString():g.error("Decoding of string type: "+y+" unsupported")},p.prototype._decodeObjid=function(g,y,b){let v;const w=[];let S=0,N=0;for(;!g.isEmpty();)N=g.readUInt8(),S<<=7,S|=127&N,(128&N)==0&&(w.push(S),S=0);128&N&&w.push(S);const D=w[0]/40|0,F=w[0]%40;if(v=b?w:[D,F].concat(w.slice(1)),y){let G=y[v.join(" ")];G===void 0&&(G=y[v.join(".")]),G!==void 0&&(v=G)}return v},p.prototype._decodeTime=function(g,y){const b=g.raw().toString();let v,w,S,N,D,F;if(y==="gentime")v=0|b.slice(0,4),w=0|b.slice(4,6),S=0|b.slice(6,8),N=0|b.slice(8,10),D=0|b.slice(10,12),F=0|b.slice(12,14);else{if(y!=="utctime")return g.error("Decoding "+y+" time is not supported yet");v=0|b.slice(0,2),w=0|b.slice(2,4),S=0|b.slice(4,6),N=0|b.slice(6,8),D=0|b.slice(8,10),F=0|b.slice(10,12),v=v<70?2e3+v:1900+v}return Date.UTC(v,w-1,S,N,D,F,0)},p.prototype._decodeNull=function(){return null},p.prototype._decodeBool=function(g){const y=g.readUInt8();return g.isError(y)?y:y!==0},p.prototype._decodeInt=function(g,y){const b=g.raw();let v=new a(b);return y&&(v=y[v.toString(10)]||v),v},p.prototype._use=function(g,y){return typeof g=="function"&&(g=g(y)),g._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(t,r,o){const s=o;s.der=t("./der"),s.pem=t("./pem")},{"./der":178,"./pem":180}],180:[function(t,r,o){const s=t("inherits"),a=t("safer-buffer").Buffer,u=t("./der");function l(i){u.call(this,i),this.enc="pem"}s(l,u),r.exports=l,l.prototype.decode=function(i,c){const p=i.toString().split(/[\r\n]+/g),h=c.label.toUpperCase(),f=/^-----(BEGIN|END) ([^-]+)-----$/;let g=-1,y=-1;for(let w=0;w<p.length;w++){const S=p[w].match(f);if(S!==null&&S[2]===h){if(g!==-1){if(S[1]!=="END")break;y=w;break}if(S[1]!=="BEGIN")break;g=w}}if(g===-1||y===-1)throw new Error("PEM section not found for: "+h);const b=p.slice(g+1,y).join("");b.replace(/[^a-z0-9+/=]+/gi,"");const v=a.from(b,"base64");return u.prototype.decode.call(this,v,c)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(t,r,o){const s=t("inherits"),a=t("safer-buffer").Buffer,u=t("../base/node"),l=t("../constants/der");function i(h){this.enc="der",this.name=h.name,this.entity=h,this.tree=new c,this.tree._init(h.body)}function c(h){u.call(this,"der",h)}function p(h){return h<10?"0"+h:h}r.exports=i,i.prototype.encode=function(h,f){return this.tree._encode(h,f).join()},s(c,u),c.prototype._encodeComposite=function(h,f,g,y){const b=(function(S,N,D,F){let G;if(S==="seqof"?S="seq":S==="setof"&&(S="set"),l.tagByName.hasOwnProperty(S))G=l.tagByName[S];else{if(typeof S!="number"||(0|S)!==S)return F.error("Unknown tag: "+S);G=S}return G>=31?F.error("Multi-octet tag encoding unsupported"):(N||(G|=32),G|=l.tagClassByName[D||"universal"]<<6,G)})(h,f,g,this.reporter);if(y.length<128){const S=a.alloc(2);return S[0]=b,S[1]=y.length,this._createEncoderBuffer([S,y])}let v=1;for(let S=y.length;S>=256;S>>=8)v++;const w=a.alloc(2+v);w[0]=b,w[1]=128|v;for(let S=1+v,N=y.length;N>0;S--,N>>=8)w[S]=255&N;return this._createEncoderBuffer([w,y])},c.prototype._encodeStr=function(h,f){if(f==="bitstr")return this._createEncoderBuffer([0|h.unused,h.data]);if(f==="bmpstr"){const g=a.alloc(2*h.length);for(let y=0;y<h.length;y++)g.writeUInt16BE(h.charCodeAt(y),2*y);return this._createEncoderBuffer(g)}return f==="numstr"?this._isNumstr(h)?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: numstr supports only digits and space"):f==="printstr"?this._isPrintstr(h)?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(f)||f==="objDesc"?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: "+f+" unsupported")},c.prototype._encodeObjid=function(h,f,g){if(typeof h=="string"){if(!f)return this.reporter.error("string objid given, but no values map found");if(!f.hasOwnProperty(h))return this.reporter.error("objid not found in values map");h=f[h].split(/[\s.]+/g);for(let w=0;w<h.length;w++)h[w]|=0}else if(Array.isArray(h)){h=h.slice();for(let w=0;w<h.length;w++)h[w]|=0}if(!Array.isArray(h))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(h));if(!g){if(h[1]>=40)return this.reporter.error("Second objid identifier OOB");h.splice(0,2,40*h[0]+h[1])}let y=0;for(let w=0;w<h.length;w++){let S=h[w];for(y++;S>=128;S>>=7)y++}const b=a.alloc(y);let v=b.length-1;for(let w=h.length-1;w>=0;w--){let S=h[w];for(b[v--]=127&S;(S>>=7)>0;)b[v--]=128|127&S}return this._createEncoderBuffer(b)},c.prototype._encodeTime=function(h,f){let g;const y=new Date(h);return f==="gentime"?g=[p(y.getUTCFullYear()),p(y.getUTCMonth()+1),p(y.getUTCDate()),p(y.getUTCHours()),p(y.getUTCMinutes()),p(y.getUTCSeconds()),"Z"].join(""):f==="utctime"?g=[p(y.getUTCFullYear()%100),p(y.getUTCMonth()+1),p(y.getUTCDate()),p(y.getUTCHours()),p(y.getUTCMinutes()),p(y.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+f+" time is not supported yet"),this._encodeStr(g,"octstr")},c.prototype._encodeNull=function(){return this._createEncoderBuffer("")},c.prototype._encodeInt=function(h,f){if(typeof h=="string"){if(!f)return this.reporter.error("String int or enum given, but no values map");if(!f.hasOwnProperty(h))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(h));h=f[h]}if(typeof h!="number"&&!a.isBuffer(h)){const b=h.toArray();!h.sign&&128&b[0]&&b.unshift(0),h=a.from(b)}if(a.isBuffer(h)){let b=h.length;h.length===0&&b++;const v=a.alloc(b);return h.copy(v),h.length===0&&(v[0]=0),this._createEncoderBuffer(v)}if(h<128)return this._createEncoderBuffer(h);if(h<256)return this._createEncoderBuffer([0,h]);let g=1;for(let b=h;b>=256;b>>=8)g++;const y=new Array(g);for(let b=y.length-1;b>=0;b--)y[b]=255&h,h>>=8;return 128&y[0]&&y.unshift(0),this._createEncoderBuffer(a.from(y))},c.prototype._encodeBool=function(h){return this._createEncoderBuffer(h?255:0)},c.prototype._use=function(h,f){return typeof h=="function"&&(h=h(f)),h._getEncoder("der").tree},c.prototype._skipDefault=function(h,f,g){const y=this._baseState;let b;if(y.default===null)return!1;const v=h.join();if(y.defaultBuffer===void 0&&(y.defaultBuffer=this._encodeValue(y.default,f,g).join()),v.length!==y.defaultBuffer.length)return!1;for(b=0;b<v.length;b++)if(v[b]!==y.defaultBuffer[b])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(t,r,o){const s=o;s.der=t("./der"),s.pem=t("./pem")},{"./der":181,"./pem":183}],183:[function(t,r,o){const s=t("inherits"),a=t("./der");function u(l){a.call(this,l),this.enc="pem"}s(u,a),r.exports=u,u.prototype.encode=function(l,i){const c=a.prototype.encode.call(this,l).toString("base64"),p=["-----BEGIN "+i.label+"-----"];for(let h=0;h<c.length;h+=64)p.push(c.slice(h,h+64));return p.push("-----END "+i.label+"-----"),p.join(`
`)}},{"./der":181,inherits:440}],184:[function(t,r,o){(function(s,a){function u(T,L){if(!T)throw new Error(L||"Assertion failed")}function l(T,L){T.super_=L;var E=function(){};E.prototype=L.prototype,T.prototype=new E,T.prototype.constructor=T}function i(T,L,E){if(i.isBN(T))return T;this.negative=0,this.words=null,this.length=0,this.red=null,T!==null&&(L!=="le"&&L!=="be"||(E=L,L=10),this._init(T||0,L||10,E||"be"))}var c;typeof s=="object"?s.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{c=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:t("buffer").Buffer}catch{}function p(T,L){var E=T.charCodeAt(L);return E>=65&&E<=70?E-55:E>=97&&E<=102?E-87:E-48&15}function h(T,L,E){var x=p(T,E);return E-1>=L&&(x|=p(T,E-1)<<4),x}function f(T,L,E,x){for(var k=0,A=Math.min(T.length,E),C=L;C<A;C++){var j=T.charCodeAt(C)-48;k*=x,k+=j>=49?j-49+10:j>=17?j-17+10:j}return k}i.isBN=function(T){return T instanceof i||T!==null&&typeof T=="object"&&T.constructor.wordSize===i.wordSize&&Array.isArray(T.words)},i.max=function(T,L){return T.cmp(L)>0?T:L},i.min=function(T,L){return T.cmp(L)<0?T:L},i.prototype._init=function(T,L,E){if(typeof T=="number")return this._initNumber(T,L,E);if(typeof T=="object")return this._initArray(T,L,E);L==="hex"&&(L=16),u(L===(0|L)&&L>=2&&L<=36);var x=0;(T=T.toString().replace(/\s+/g,""))[0]==="-"&&(x++,this.negative=1),x<T.length&&(L===16?this._parseHex(T,x,E):(this._parseBase(T,L,x),E==="le"&&this._initArray(this.toArray(),L,E)))},i.prototype._initNumber=function(T,L,E){T<0&&(this.negative=1,T=-T),T<67108864?(this.words=[67108863&T],this.length=1):T<4503599627370496?(this.words=[67108863&T,T/67108864&67108863],this.length=2):(u(T<9007199254740992),this.words=[67108863&T,T/67108864&67108863,1],this.length=3),E==="le"&&this._initArray(this.toArray(),L,E)},i.prototype._initArray=function(T,L,E){if(u(typeof T.length=="number"),T.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(T.length/3),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var k,A,C=0;if(E==="be")for(x=T.length-1,k=0;x>=0;x-=3)A=T[x]|T[x-1]<<8|T[x-2]<<16,this.words[k]|=A<<C&67108863,this.words[k+1]=A>>>26-C&67108863,(C+=24)>=26&&(C-=26,k++);else if(E==="le")for(x=0,k=0;x<T.length;x+=3)A=T[x]|T[x+1]<<8|T[x+2]<<16,this.words[k]|=A<<C&67108863,this.words[k+1]=A>>>26-C&67108863,(C+=24)>=26&&(C-=26,k++);return this.strip()},i.prototype._parseHex=function(T,L,E){this.length=Math.ceil((T.length-L)/6),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var k,A=0,C=0;if(E==="be")for(x=T.length-1;x>=L;x-=2)k=h(T,L,x)<<A,this.words[C]|=67108863&k,A>=18?(A-=18,C+=1,this.words[C]|=k>>>26):A+=8;else for(x=(T.length-L)%2==0?L+1:L;x<T.length;x+=2)k=h(T,L,x)<<A,this.words[C]|=67108863&k,A>=18?(A-=18,C+=1,this.words[C]|=k>>>26):A+=8;this.strip()},i.prototype._parseBase=function(T,L,E){this.words=[0],this.length=1;for(var x=0,k=1;k<=67108863;k*=L)x++;x--,k=k/L|0;for(var A=T.length-E,C=A%x,j=Math.min(A,A-C)+E,B=0,O=E;O<j;O+=x)B=f(T,O,O+x,L),this.imuln(k),this.words[0]+B<67108864?this.words[0]+=B:this._iaddn(B);if(C!==0){var H=1;for(B=f(T,O,T.length,L),O=0;O<C;O++)H*=L;this.imuln(H),this.words[0]+B<67108864?this.words[0]+=B:this._iaddn(B)}this.strip()},i.prototype.copy=function(T){T.words=new Array(this.length);for(var L=0;L<this.length;L++)T.words[L]=this.words[L];T.length=this.length,T.negative=this.negative,T.red=this.red},i.prototype.clone=function(){var T=new i(null);return this.copy(T),T},i.prototype._expand=function(T){for(;this.length<T;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],y=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function v(T,L,E){E.negative=L.negative^T.negative;var x=T.length+L.length|0;E.length=x,x=x-1|0;var k=0|T.words[0],A=0|L.words[0],C=k*A,j=67108863&C,B=C/67108864|0;E.words[0]=j;for(var O=1;O<x;O++){for(var H=B>>>26,X=67108863&B,et=Math.min(O,L.length-1),V=Math.max(0,O-T.length+1);V<=et;V++){var tt=O-V|0;H+=(C=(k=0|T.words[tt])*(A=0|L.words[V])+X)/67108864|0,X=67108863&C}E.words[O]=0|X,B=0|H}return B!==0?E.words[O]=0|B:E.length--,E.strip()}i.prototype.toString=function(T,L){var E;if(L=0|L||1,(T=T||10)===16||T==="hex"){E="";for(var x=0,k=0,A=0;A<this.length;A++){var C=this.words[A],j=(16777215&(C<<x|k)).toString(16);E=(k=C>>>24-x&16777215)!==0||A!==this.length-1?g[6-j.length]+j+E:j+E,(x+=2)>=26&&(x-=26,A--)}for(k!==0&&(E=k.toString(16)+E);E.length%L!=0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}if(T===(0|T)&&T>=2&&T<=36){var B=y[T],O=b[T];E="";var H=this.clone();for(H.negative=0;!H.isZero();){var X=H.modn(O).toString(T);E=(H=H.idivn(O)).isZero()?X+E:g[B-X.length]+X+E}for(this.isZero()&&(E="0"+E);E.length%L!=0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}u(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var T=this.words[0];return this.length===2?T+=67108864*this.words[1]:this.length===3&&this.words[2]===1?T+=4503599627370496+67108864*this.words[1]:this.length>2&&u(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-T:T},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(T,L){return u(c!==void 0),this.toArrayLike(c,T,L)},i.prototype.toArray=function(T,L){return this.toArrayLike(Array,T,L)},i.prototype.toArrayLike=function(T,L,E){var x=this.byteLength(),k=E||Math.max(1,x);u(x<=k,"byte array longer than desired length"),u(k>0,"Requested array length <= 0"),this.strip();var A,C,j=L==="le",B=new T(k),O=this.clone();if(j){for(C=0;!O.isZero();C++)A=O.andln(255),O.iushrn(8),B[C]=A;for(;C<k;C++)B[C]=0}else{for(C=0;C<k-x;C++)B[C]=0;for(C=0;!O.isZero();C++)A=O.andln(255),O.iushrn(8),B[k-C-1]=A}return B},Math.clz32?i.prototype._countBits=function(T){return 32-Math.clz32(T)}:i.prototype._countBits=function(T){var L=T,E=0;return L>=4096&&(E+=13,L>>>=13),L>=64&&(E+=7,L>>>=7),L>=8&&(E+=4,L>>>=4),L>=2&&(E+=2,L>>>=2),E+L},i.prototype._zeroBits=function(T){if(T===0)return 26;var L=T,E=0;return(8191&L)==0&&(E+=13,L>>>=13),(127&L)==0&&(E+=7,L>>>=7),(15&L)==0&&(E+=4,L>>>=4),(3&L)==0&&(E+=2,L>>>=2),(1&L)==0&&E++,E},i.prototype.bitLength=function(){var T=this.words[this.length-1],L=this._countBits(T);return 26*(this.length-1)+L},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var T=0,L=0;L<this.length;L++){var E=this._zeroBits(this.words[L]);if(T+=E,E!==26)break}return T},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(T){return this.negative!==0?this.abs().inotn(T).iaddn(1):this.clone()},i.prototype.fromTwos=function(T){return this.testn(T-1)?this.notn(T).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(T){for(;this.length<T.length;)this.words[this.length++]=0;for(var L=0;L<T.length;L++)this.words[L]=this.words[L]|T.words[L];return this.strip()},i.prototype.ior=function(T){return u((this.negative|T.negative)==0),this.iuor(T)},i.prototype.or=function(T){return this.length>T.length?this.clone().ior(T):T.clone().ior(this)},i.prototype.uor=function(T){return this.length>T.length?this.clone().iuor(T):T.clone().iuor(this)},i.prototype.iuand=function(T){var L;L=this.length>T.length?T:this;for(var E=0;E<L.length;E++)this.words[E]=this.words[E]&T.words[E];return this.length=L.length,this.strip()},i.prototype.iand=function(T){return u((this.negative|T.negative)==0),this.iuand(T)},i.prototype.and=function(T){return this.length>T.length?this.clone().iand(T):T.clone().iand(this)},i.prototype.uand=function(T){return this.length>T.length?this.clone().iuand(T):T.clone().iuand(this)},i.prototype.iuxor=function(T){var L,E;this.length>T.length?(L=this,E=T):(L=T,E=this);for(var x=0;x<E.length;x++)this.words[x]=L.words[x]^E.words[x];if(this!==L)for(;x<L.length;x++)this.words[x]=L.words[x];return this.length=L.length,this.strip()},i.prototype.ixor=function(T){return u((this.negative|T.negative)==0),this.iuxor(T)},i.prototype.xor=function(T){return this.length>T.length?this.clone().ixor(T):T.clone().ixor(this)},i.prototype.uxor=function(T){return this.length>T.length?this.clone().iuxor(T):T.clone().iuxor(this)},i.prototype.inotn=function(T){u(typeof T=="number"&&T>=0);var L=0|Math.ceil(T/26),E=T%26;this._expand(L),E>0&&L--;for(var x=0;x<L;x++)this.words[x]=67108863&~this.words[x];return E>0&&(this.words[x]=~this.words[x]&67108863>>26-E),this.strip()},i.prototype.notn=function(T){return this.clone().inotn(T)},i.prototype.setn=function(T,L){u(typeof T=="number"&&T>=0);var E=T/26|0,x=T%26;return this._expand(E+1),this.words[E]=L?this.words[E]|1<<x:this.words[E]&~(1<<x),this.strip()},i.prototype.iadd=function(T){var L,E,x;if(this.negative!==0&&T.negative===0)return this.negative=0,L=this.isub(T),this.negative^=1,this._normSign();if(this.negative===0&&T.negative!==0)return T.negative=0,L=this.isub(T),T.negative=1,L._normSign();this.length>T.length?(E=this,x=T):(E=T,x=this);for(var k=0,A=0;A<x.length;A++)L=(0|E.words[A])+(0|x.words[A])+k,this.words[A]=67108863&L,k=L>>>26;for(;k!==0&&A<E.length;A++)L=(0|E.words[A])+k,this.words[A]=67108863&L,k=L>>>26;if(this.length=E.length,k!==0)this.words[this.length]=k,this.length++;else if(E!==this)for(;A<E.length;A++)this.words[A]=E.words[A];return this},i.prototype.add=function(T){var L;return T.negative!==0&&this.negative===0?(T.negative=0,L=this.sub(T),T.negative^=1,L):T.negative===0&&this.negative!==0?(this.negative=0,L=T.sub(this),this.negative=1,L):this.length>T.length?this.clone().iadd(T):T.clone().iadd(this)},i.prototype.isub=function(T){if(T.negative!==0){T.negative=0;var L=this.iadd(T);return T.negative=1,L._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(T),this.negative=1,this._normSign();var E,x,k=this.cmp(T);if(k===0)return this.negative=0,this.length=1,this.words[0]=0,this;k>0?(E=this,x=T):(E=T,x=this);for(var A=0,C=0;C<x.length;C++)A=(L=(0|E.words[C])-(0|x.words[C])+A)>>26,this.words[C]=67108863&L;for(;A!==0&&C<E.length;C++)A=(L=(0|E.words[C])+A)>>26,this.words[C]=67108863&L;if(A===0&&C<E.length&&E!==this)for(;C<E.length;C++)this.words[C]=E.words[C];return this.length=Math.max(this.length,C),E!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(T){return this.clone().isub(T)};var w=function(T,L,E){var x,k,A,C=T.words,j=L.words,B=E.words,O=0,H=0|C[0],X=8191&H,et=H>>>13,V=0|C[1],tt=8191&V,$=V>>>13,z=0|C[2],Z=8191&z,it=z>>>13,mt=0|C[3],lt=8191&mt,at=mt>>>13,rt=0|C[4],ct=8191&rt,ot=rt>>>13,dt=0|C[5],ft=8191&dt,gt=dt>>>13,wt=0|C[6],yt=8191&wt,Et=wt>>>13,Mt=0|C[7],qt=8191&Mt,Tt=Mt>>>13,It=0|C[8],Vt=8191&It,Kt=It>>>13,ne=0|C[9],ae=8191&ne,Oe=ne>>>13,le=0|j[0],Jt=8191&le,ue=le>>>13,ge=0|j[1],fe=8191&ge,qe=ge>>>13,Be=0|j[2],ke=8191&Be,Je=Be>>>13,Fe=0|j[3],Me=8191&Fe,Ke=Fe>>>13,En=0|j[4],Xe=8191&En,Sn=En>>>13,Nn=0|j[5],Te=8191&Nn,_n=Nn>>>13,Pn=0|j[6],on=8191&Pn,Dt=Pn>>>13,Ht=0|j[7],re=8191&Ht,we=Ht>>>13,nn=0|j[8],Ie=8191&nn,Ue=nn>>>13,He=0|j[9],Ge=8191&He,Ve=He>>>13;E.negative=T.negative^L.negative,E.length=19;var an=(O+(x=Math.imul(X,Jt))|0)+((8191&(k=(k=Math.imul(X,ue))+Math.imul(et,Jt)|0))<<13)|0;O=((A=Math.imul(et,ue))+(k>>>13)|0)+(an>>>26)|0,an&=67108863,x=Math.imul(tt,Jt),k=(k=Math.imul(tt,ue))+Math.imul($,Jt)|0,A=Math.imul($,ue);var kn=(O+(x=x+Math.imul(X,fe)|0)|0)+((8191&(k=(k=k+Math.imul(X,qe)|0)+Math.imul(et,fe)|0))<<13)|0;O=((A=A+Math.imul(et,qe)|0)+(k>>>13)|0)+(kn>>>26)|0,kn&=67108863,x=Math.imul(Z,Jt),k=(k=Math.imul(Z,ue))+Math.imul(it,Jt)|0,A=Math.imul(it,ue),x=x+Math.imul(tt,fe)|0,k=(k=k+Math.imul(tt,qe)|0)+Math.imul($,fe)|0,A=A+Math.imul($,qe)|0;var qn=(O+(x=x+Math.imul(X,ke)|0)|0)+((8191&(k=(k=k+Math.imul(X,Je)|0)+Math.imul(et,ke)|0))<<13)|0;O=((A=A+Math.imul(et,Je)|0)+(k>>>13)|0)+(qn>>>26)|0,qn&=67108863,x=Math.imul(lt,Jt),k=(k=Math.imul(lt,ue))+Math.imul(at,Jt)|0,A=Math.imul(at,ue),x=x+Math.imul(Z,fe)|0,k=(k=k+Math.imul(Z,qe)|0)+Math.imul(it,fe)|0,A=A+Math.imul(it,qe)|0,x=x+Math.imul(tt,ke)|0,k=(k=k+Math.imul(tt,Je)|0)+Math.imul($,ke)|0,A=A+Math.imul($,Je)|0;var Qt=(O+(x=x+Math.imul(X,Me)|0)|0)+((8191&(k=(k=k+Math.imul(X,Ke)|0)+Math.imul(et,Me)|0))<<13)|0;O=((A=A+Math.imul(et,Ke)|0)+(k>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,x=Math.imul(ct,Jt),k=(k=Math.imul(ct,ue))+Math.imul(ot,Jt)|0,A=Math.imul(ot,ue),x=x+Math.imul(lt,fe)|0,k=(k=k+Math.imul(lt,qe)|0)+Math.imul(at,fe)|0,A=A+Math.imul(at,qe)|0,x=x+Math.imul(Z,ke)|0,k=(k=k+Math.imul(Z,Je)|0)+Math.imul(it,ke)|0,A=A+Math.imul(it,Je)|0,x=x+Math.imul(tt,Me)|0,k=(k=k+Math.imul(tt,Ke)|0)+Math.imul($,Me)|0,A=A+Math.imul($,Ke)|0;var de=(O+(x=x+Math.imul(X,Xe)|0)|0)+((8191&(k=(k=k+Math.imul(X,Sn)|0)+Math.imul(et,Xe)|0))<<13)|0;O=((A=A+Math.imul(et,Sn)|0)+(k>>>13)|0)+(de>>>26)|0,de&=67108863,x=Math.imul(ft,Jt),k=(k=Math.imul(ft,ue))+Math.imul(gt,Jt)|0,A=Math.imul(gt,ue),x=x+Math.imul(ct,fe)|0,k=(k=k+Math.imul(ct,qe)|0)+Math.imul(ot,fe)|0,A=A+Math.imul(ot,qe)|0,x=x+Math.imul(lt,ke)|0,k=(k=k+Math.imul(lt,Je)|0)+Math.imul(at,ke)|0,A=A+Math.imul(at,Je)|0,x=x+Math.imul(Z,Me)|0,k=(k=k+Math.imul(Z,Ke)|0)+Math.imul(it,Me)|0,A=A+Math.imul(it,Ke)|0,x=x+Math.imul(tt,Xe)|0,k=(k=k+Math.imul(tt,Sn)|0)+Math.imul($,Xe)|0,A=A+Math.imul($,Sn)|0;var Ee=(O+(x=x+Math.imul(X,Te)|0)|0)+((8191&(k=(k=k+Math.imul(X,_n)|0)+Math.imul(et,Te)|0))<<13)|0;O=((A=A+Math.imul(et,_n)|0)+(k>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,x=Math.imul(yt,Jt),k=(k=Math.imul(yt,ue))+Math.imul(Et,Jt)|0,A=Math.imul(Et,ue),x=x+Math.imul(ft,fe)|0,k=(k=k+Math.imul(ft,qe)|0)+Math.imul(gt,fe)|0,A=A+Math.imul(gt,qe)|0,x=x+Math.imul(ct,ke)|0,k=(k=k+Math.imul(ct,Je)|0)+Math.imul(ot,ke)|0,A=A+Math.imul(ot,Je)|0,x=x+Math.imul(lt,Me)|0,k=(k=k+Math.imul(lt,Ke)|0)+Math.imul(at,Me)|0,A=A+Math.imul(at,Ke)|0,x=x+Math.imul(Z,Xe)|0,k=(k=k+Math.imul(Z,Sn)|0)+Math.imul(it,Xe)|0,A=A+Math.imul(it,Sn)|0,x=x+Math.imul(tt,Te)|0,k=(k=k+Math.imul(tt,_n)|0)+Math.imul($,Te)|0,A=A+Math.imul($,_n)|0;var Pe=(O+(x=x+Math.imul(X,on)|0)|0)+((8191&(k=(k=k+Math.imul(X,Dt)|0)+Math.imul(et,on)|0))<<13)|0;O=((A=A+Math.imul(et,Dt)|0)+(k>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,x=Math.imul(qt,Jt),k=(k=Math.imul(qt,ue))+Math.imul(Tt,Jt)|0,A=Math.imul(Tt,ue),x=x+Math.imul(yt,fe)|0,k=(k=k+Math.imul(yt,qe)|0)+Math.imul(Et,fe)|0,A=A+Math.imul(Et,qe)|0,x=x+Math.imul(ft,ke)|0,k=(k=k+Math.imul(ft,Je)|0)+Math.imul(gt,ke)|0,A=A+Math.imul(gt,Je)|0,x=x+Math.imul(ct,Me)|0,k=(k=k+Math.imul(ct,Ke)|0)+Math.imul(ot,Me)|0,A=A+Math.imul(ot,Ke)|0,x=x+Math.imul(lt,Xe)|0,k=(k=k+Math.imul(lt,Sn)|0)+Math.imul(at,Xe)|0,A=A+Math.imul(at,Sn)|0,x=x+Math.imul(Z,Te)|0,k=(k=k+Math.imul(Z,_n)|0)+Math.imul(it,Te)|0,A=A+Math.imul(it,_n)|0,x=x+Math.imul(tt,on)|0,k=(k=k+Math.imul(tt,Dt)|0)+Math.imul($,on)|0,A=A+Math.imul($,Dt)|0;var _t=(O+(x=x+Math.imul(X,re)|0)|0)+((8191&(k=(k=k+Math.imul(X,we)|0)+Math.imul(et,re)|0))<<13)|0;O=((A=A+Math.imul(et,we)|0)+(k>>>13)|0)+(_t>>>26)|0,_t&=67108863,x=Math.imul(Vt,Jt),k=(k=Math.imul(Vt,ue))+Math.imul(Kt,Jt)|0,A=Math.imul(Kt,ue),x=x+Math.imul(qt,fe)|0,k=(k=k+Math.imul(qt,qe)|0)+Math.imul(Tt,fe)|0,A=A+Math.imul(Tt,qe)|0,x=x+Math.imul(yt,ke)|0,k=(k=k+Math.imul(yt,Je)|0)+Math.imul(Et,ke)|0,A=A+Math.imul(Et,Je)|0,x=x+Math.imul(ft,Me)|0,k=(k=k+Math.imul(ft,Ke)|0)+Math.imul(gt,Me)|0,A=A+Math.imul(gt,Ke)|0,x=x+Math.imul(ct,Xe)|0,k=(k=k+Math.imul(ct,Sn)|0)+Math.imul(ot,Xe)|0,A=A+Math.imul(ot,Sn)|0,x=x+Math.imul(lt,Te)|0,k=(k=k+Math.imul(lt,_n)|0)+Math.imul(at,Te)|0,A=A+Math.imul(at,_n)|0,x=x+Math.imul(Z,on)|0,k=(k=k+Math.imul(Z,Dt)|0)+Math.imul(it,on)|0,A=A+Math.imul(it,Dt)|0,x=x+Math.imul(tt,re)|0,k=(k=k+Math.imul(tt,we)|0)+Math.imul($,re)|0,A=A+Math.imul($,we)|0;var Bt=(O+(x=x+Math.imul(X,Ie)|0)|0)+((8191&(k=(k=k+Math.imul(X,Ue)|0)+Math.imul(et,Ie)|0))<<13)|0;O=((A=A+Math.imul(et,Ue)|0)+(k>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,x=Math.imul(ae,Jt),k=(k=Math.imul(ae,ue))+Math.imul(Oe,Jt)|0,A=Math.imul(Oe,ue),x=x+Math.imul(Vt,fe)|0,k=(k=k+Math.imul(Vt,qe)|0)+Math.imul(Kt,fe)|0,A=A+Math.imul(Kt,qe)|0,x=x+Math.imul(qt,ke)|0,k=(k=k+Math.imul(qt,Je)|0)+Math.imul(Tt,ke)|0,A=A+Math.imul(Tt,Je)|0,x=x+Math.imul(yt,Me)|0,k=(k=k+Math.imul(yt,Ke)|0)+Math.imul(Et,Me)|0,A=A+Math.imul(Et,Ke)|0,x=x+Math.imul(ft,Xe)|0,k=(k=k+Math.imul(ft,Sn)|0)+Math.imul(gt,Xe)|0,A=A+Math.imul(gt,Sn)|0,x=x+Math.imul(ct,Te)|0,k=(k=k+Math.imul(ct,_n)|0)+Math.imul(ot,Te)|0,A=A+Math.imul(ot,_n)|0,x=x+Math.imul(lt,on)|0,k=(k=k+Math.imul(lt,Dt)|0)+Math.imul(at,on)|0,A=A+Math.imul(at,Dt)|0,x=x+Math.imul(Z,re)|0,k=(k=k+Math.imul(Z,we)|0)+Math.imul(it,re)|0,A=A+Math.imul(it,we)|0,x=x+Math.imul(tt,Ie)|0,k=(k=k+Math.imul(tt,Ue)|0)+Math.imul($,Ie)|0,A=A+Math.imul($,Ue)|0;var Gt=(O+(x=x+Math.imul(X,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(X,Ve)|0)+Math.imul(et,Ge)|0))<<13)|0;O=((A=A+Math.imul(et,Ve)|0)+(k>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,x=Math.imul(ae,fe),k=(k=Math.imul(ae,qe))+Math.imul(Oe,fe)|0,A=Math.imul(Oe,qe),x=x+Math.imul(Vt,ke)|0,k=(k=k+Math.imul(Vt,Je)|0)+Math.imul(Kt,ke)|0,A=A+Math.imul(Kt,Je)|0,x=x+Math.imul(qt,Me)|0,k=(k=k+Math.imul(qt,Ke)|0)+Math.imul(Tt,Me)|0,A=A+Math.imul(Tt,Ke)|0,x=x+Math.imul(yt,Xe)|0,k=(k=k+Math.imul(yt,Sn)|0)+Math.imul(Et,Xe)|0,A=A+Math.imul(Et,Sn)|0,x=x+Math.imul(ft,Te)|0,k=(k=k+Math.imul(ft,_n)|0)+Math.imul(gt,Te)|0,A=A+Math.imul(gt,_n)|0,x=x+Math.imul(ct,on)|0,k=(k=k+Math.imul(ct,Dt)|0)+Math.imul(ot,on)|0,A=A+Math.imul(ot,Dt)|0,x=x+Math.imul(lt,re)|0,k=(k=k+Math.imul(lt,we)|0)+Math.imul(at,re)|0,A=A+Math.imul(at,we)|0,x=x+Math.imul(Z,Ie)|0,k=(k=k+Math.imul(Z,Ue)|0)+Math.imul(it,Ie)|0,A=A+Math.imul(it,Ue)|0;var pe=(O+(x=x+Math.imul(tt,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(tt,Ve)|0)+Math.imul($,Ge)|0))<<13)|0;O=((A=A+Math.imul($,Ve)|0)+(k>>>13)|0)+(pe>>>26)|0,pe&=67108863,x=Math.imul(ae,ke),k=(k=Math.imul(ae,Je))+Math.imul(Oe,ke)|0,A=Math.imul(Oe,Je),x=x+Math.imul(Vt,Me)|0,k=(k=k+Math.imul(Vt,Ke)|0)+Math.imul(Kt,Me)|0,A=A+Math.imul(Kt,Ke)|0,x=x+Math.imul(qt,Xe)|0,k=(k=k+Math.imul(qt,Sn)|0)+Math.imul(Tt,Xe)|0,A=A+Math.imul(Tt,Sn)|0,x=x+Math.imul(yt,Te)|0,k=(k=k+Math.imul(yt,_n)|0)+Math.imul(Et,Te)|0,A=A+Math.imul(Et,_n)|0,x=x+Math.imul(ft,on)|0,k=(k=k+Math.imul(ft,Dt)|0)+Math.imul(gt,on)|0,A=A+Math.imul(gt,Dt)|0,x=x+Math.imul(ct,re)|0,k=(k=k+Math.imul(ct,we)|0)+Math.imul(ot,re)|0,A=A+Math.imul(ot,we)|0,x=x+Math.imul(lt,Ie)|0,k=(k=k+Math.imul(lt,Ue)|0)+Math.imul(at,Ie)|0,A=A+Math.imul(at,Ue)|0;var Ne=(O+(x=x+Math.imul(Z,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(Z,Ve)|0)+Math.imul(it,Ge)|0))<<13)|0;O=((A=A+Math.imul(it,Ve)|0)+(k>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,x=Math.imul(ae,Me),k=(k=Math.imul(ae,Ke))+Math.imul(Oe,Me)|0,A=Math.imul(Oe,Ke),x=x+Math.imul(Vt,Xe)|0,k=(k=k+Math.imul(Vt,Sn)|0)+Math.imul(Kt,Xe)|0,A=A+Math.imul(Kt,Sn)|0,x=x+Math.imul(qt,Te)|0,k=(k=k+Math.imul(qt,_n)|0)+Math.imul(Tt,Te)|0,A=A+Math.imul(Tt,_n)|0,x=x+Math.imul(yt,on)|0,k=(k=k+Math.imul(yt,Dt)|0)+Math.imul(Et,on)|0,A=A+Math.imul(Et,Dt)|0,x=x+Math.imul(ft,re)|0,k=(k=k+Math.imul(ft,we)|0)+Math.imul(gt,re)|0,A=A+Math.imul(gt,we)|0,x=x+Math.imul(ct,Ie)|0,k=(k=k+Math.imul(ct,Ue)|0)+Math.imul(ot,Ie)|0,A=A+Math.imul(ot,Ue)|0;var ye=(O+(x=x+Math.imul(lt,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(lt,Ve)|0)+Math.imul(at,Ge)|0))<<13)|0;O=((A=A+Math.imul(at,Ve)|0)+(k>>>13)|0)+(ye>>>26)|0,ye&=67108863,x=Math.imul(ae,Xe),k=(k=Math.imul(ae,Sn))+Math.imul(Oe,Xe)|0,A=Math.imul(Oe,Sn),x=x+Math.imul(Vt,Te)|0,k=(k=k+Math.imul(Vt,_n)|0)+Math.imul(Kt,Te)|0,A=A+Math.imul(Kt,_n)|0,x=x+Math.imul(qt,on)|0,k=(k=k+Math.imul(qt,Dt)|0)+Math.imul(Tt,on)|0,A=A+Math.imul(Tt,Dt)|0,x=x+Math.imul(yt,re)|0,k=(k=k+Math.imul(yt,we)|0)+Math.imul(Et,re)|0,A=A+Math.imul(Et,we)|0,x=x+Math.imul(ft,Ie)|0,k=(k=k+Math.imul(ft,Ue)|0)+Math.imul(gt,Ie)|0,A=A+Math.imul(gt,Ue)|0;var xe=(O+(x=x+Math.imul(ct,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(ct,Ve)|0)+Math.imul(ot,Ge)|0))<<13)|0;O=((A=A+Math.imul(ot,Ve)|0)+(k>>>13)|0)+(xe>>>26)|0,xe&=67108863,x=Math.imul(ae,Te),k=(k=Math.imul(ae,_n))+Math.imul(Oe,Te)|0,A=Math.imul(Oe,_n),x=x+Math.imul(Vt,on)|0,k=(k=k+Math.imul(Vt,Dt)|0)+Math.imul(Kt,on)|0,A=A+Math.imul(Kt,Dt)|0,x=x+Math.imul(qt,re)|0,k=(k=k+Math.imul(qt,we)|0)+Math.imul(Tt,re)|0,A=A+Math.imul(Tt,we)|0,x=x+Math.imul(yt,Ie)|0,k=(k=k+Math.imul(yt,Ue)|0)+Math.imul(Et,Ie)|0,A=A+Math.imul(Et,Ue)|0;var mn=(O+(x=x+Math.imul(ft,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(ft,Ve)|0)+Math.imul(gt,Ge)|0))<<13)|0;O=((A=A+Math.imul(gt,Ve)|0)+(k>>>13)|0)+(mn>>>26)|0,mn&=67108863,x=Math.imul(ae,on),k=(k=Math.imul(ae,Dt))+Math.imul(Oe,on)|0,A=Math.imul(Oe,Dt),x=x+Math.imul(Vt,re)|0,k=(k=k+Math.imul(Vt,we)|0)+Math.imul(Kt,re)|0,A=A+Math.imul(Kt,we)|0,x=x+Math.imul(qt,Ie)|0,k=(k=k+Math.imul(qt,Ue)|0)+Math.imul(Tt,Ie)|0,A=A+Math.imul(Tt,Ue)|0;var $e=(O+(x=x+Math.imul(yt,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(yt,Ve)|0)+Math.imul(Et,Ge)|0))<<13)|0;O=((A=A+Math.imul(Et,Ve)|0)+(k>>>13)|0)+($e>>>26)|0,$e&=67108863,x=Math.imul(ae,re),k=(k=Math.imul(ae,we))+Math.imul(Oe,re)|0,A=Math.imul(Oe,we),x=x+Math.imul(Vt,Ie)|0,k=(k=k+Math.imul(Vt,Ue)|0)+Math.imul(Kt,Ie)|0,A=A+Math.imul(Kt,Ue)|0;var vn=(O+(x=x+Math.imul(qt,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(qt,Ve)|0)+Math.imul(Tt,Ge)|0))<<13)|0;O=((A=A+Math.imul(Tt,Ve)|0)+(k>>>13)|0)+(vn>>>26)|0,vn&=67108863,x=Math.imul(ae,Ie),k=(k=Math.imul(ae,Ue))+Math.imul(Oe,Ie)|0,A=Math.imul(Oe,Ue);var Ze=(O+(x=x+Math.imul(Vt,Ge)|0)|0)+((8191&(k=(k=k+Math.imul(Vt,Ve)|0)+Math.imul(Kt,Ge)|0))<<13)|0;O=((A=A+Math.imul(Kt,Ve)|0)+(k>>>13)|0)+(Ze>>>26)|0,Ze&=67108863;var Tn=(O+(x=Math.imul(ae,Ge))|0)+((8191&(k=(k=Math.imul(ae,Ve))+Math.imul(Oe,Ge)|0))<<13)|0;return O=((A=Math.imul(Oe,Ve))+(k>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,B[0]=an,B[1]=kn,B[2]=qn,B[3]=Qt,B[4]=de,B[5]=Ee,B[6]=Pe,B[7]=_t,B[8]=Bt,B[9]=Gt,B[10]=pe,B[11]=Ne,B[12]=ye,B[13]=xe,B[14]=mn,B[15]=$e,B[16]=vn,B[17]=Ze,B[18]=Tn,O!==0&&(B[19]=O,E.length++),E};function S(T,L,E){return new N().mulp(T,L,E)}function N(T,L){this.x=T,this.y=L}Math.imul||(w=v),i.prototype.mulTo=function(T,L){var E=this.length+T.length;return this.length===10&&T.length===10?w(this,T,L):E<63?v(this,T,L):E<1024?(function(x,k,A){A.negative=k.negative^x.negative,A.length=x.length+k.length;for(var C=0,j=0,B=0;B<A.length-1;B++){var O=j;j=0;for(var H=67108863&C,X=Math.min(B,k.length-1),et=Math.max(0,B-x.length+1);et<=X;et++){var V=B-et,tt=(0|x.words[V])*(0|k.words[et]),$=67108863&tt;H=67108863&($=$+H|0),j+=(O=(O=O+(tt/67108864|0)|0)+($>>>26)|0)>>>26,O&=67108863}A.words[B]=H,C=O,O=j}return C!==0?A.words[B]=C:A.length--,A.strip()})(this,T,L):S(this,T,L)},N.prototype.makeRBT=function(T){for(var L=new Array(T),E=i.prototype._countBits(T)-1,x=0;x<T;x++)L[x]=this.revBin(x,E,T);return L},N.prototype.revBin=function(T,L,E){if(T===0||T===E-1)return T;for(var x=0,k=0;k<L;k++)x|=(1&T)<<L-k-1,T>>=1;return x},N.prototype.permute=function(T,L,E,x,k,A){for(var C=0;C<A;C++)x[C]=L[T[C]],k[C]=E[T[C]]},N.prototype.transform=function(T,L,E,x,k,A){this.permute(A,T,L,E,x,k);for(var C=1;C<k;C<<=1)for(var j=C<<1,B=Math.cos(2*Math.PI/j),O=Math.sin(2*Math.PI/j),H=0;H<k;H+=j)for(var X=B,et=O,V=0;V<C;V++){var tt=E[H+V],$=x[H+V],z=E[H+V+C],Z=x[H+V+C],it=X*z-et*Z;Z=X*Z+et*z,z=it,E[H+V]=tt+z,x[H+V]=$+Z,E[H+V+C]=tt-z,x[H+V+C]=$-Z,V!==j&&(it=B*X-O*et,et=B*et+O*X,X=it)}},N.prototype.guessLen13b=function(T,L){var E=1|Math.max(L,T),x=1&E,k=0;for(E=E/2|0;E;E>>>=1)k++;return 1<<k+1+x},N.prototype.conjugate=function(T,L,E){if(!(E<=1))for(var x=0;x<E/2;x++){var k=T[x];T[x]=T[E-x-1],T[E-x-1]=k,k=L[x],L[x]=-L[E-x-1],L[E-x-1]=-k}},N.prototype.normalize13b=function(T,L){for(var E=0,x=0;x<L/2;x++){var k=8192*Math.round(T[2*x+1]/L)+Math.round(T[2*x]/L)+E;T[x]=67108863&k,E=k<67108864?0:k/67108864|0}return T},N.prototype.convert13b=function(T,L,E,x){for(var k=0,A=0;A<L;A++)k+=0|T[A],E[2*A]=8191&k,k>>>=13,E[2*A+1]=8191&k,k>>>=13;for(A=2*L;A<x;++A)E[A]=0;u(k===0),u((-8192&k)==0)},N.prototype.stub=function(T){for(var L=new Array(T),E=0;E<T;E++)L[E]=0;return L},N.prototype.mulp=function(T,L,E){var x=2*this.guessLen13b(T.length,L.length),k=this.makeRBT(x),A=this.stub(x),C=new Array(x),j=new Array(x),B=new Array(x),O=new Array(x),H=new Array(x),X=new Array(x),et=E.words;et.length=x,this.convert13b(T.words,T.length,C,x),this.convert13b(L.words,L.length,O,x),this.transform(C,A,j,B,x,k),this.transform(O,A,H,X,x,k);for(var V=0;V<x;V++){var tt=j[V]*H[V]-B[V]*X[V];B[V]=j[V]*X[V]+B[V]*H[V],j[V]=tt}return this.conjugate(j,B,x),this.transform(j,B,et,A,x,k),this.conjugate(et,A,x),this.normalize13b(et,x),E.negative=T.negative^L.negative,E.length=T.length+L.length,E.strip()},i.prototype.mul=function(T){var L=new i(null);return L.words=new Array(this.length+T.length),this.mulTo(T,L)},i.prototype.mulf=function(T){var L=new i(null);return L.words=new Array(this.length+T.length),S(this,T,L)},i.prototype.imul=function(T){return this.clone().mulTo(T,this)},i.prototype.imuln=function(T){u(typeof T=="number"),u(T<67108864);for(var L=0,E=0;E<this.length;E++){var x=(0|this.words[E])*T,k=(67108863&x)+(67108863&L);L>>=26,L+=x/67108864|0,L+=k>>>26,this.words[E]=67108863&k}return L!==0&&(this.words[E]=L,this.length++),this},i.prototype.muln=function(T){return this.clone().imuln(T)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(T){var L=(function(A){for(var C=new Array(A.bitLength()),j=0;j<C.length;j++){var B=j/26|0,O=j%26;C[j]=(A.words[B]&1<<O)>>>O}return C})(T);if(L.length===0)return new i(1);for(var E=this,x=0;x<L.length&&L[x]===0;x++,E=E.sqr());if(++x<L.length)for(var k=E.sqr();x<L.length;x++,k=k.sqr())L[x]!==0&&(E=E.mul(k));return E},i.prototype.iushln=function(T){u(typeof T=="number"&&T>=0);var L,E=T%26,x=(T-E)/26,k=67108863>>>26-E<<26-E;if(E!==0){var A=0;for(L=0;L<this.length;L++){var C=this.words[L]&k,j=(0|this.words[L])-C<<E;this.words[L]=j|A,A=C>>>26-E}A&&(this.words[L]=A,this.length++)}if(x!==0){for(L=this.length-1;L>=0;L--)this.words[L+x]=this.words[L];for(L=0;L<x;L++)this.words[L]=0;this.length+=x}return this.strip()},i.prototype.ishln=function(T){return u(this.negative===0),this.iushln(T)},i.prototype.iushrn=function(T,L,E){var x;u(typeof T=="number"&&T>=0),x=L?(L-L%26)/26:0;var k=T%26,A=Math.min((T-k)/26,this.length),C=67108863^67108863>>>k<<k,j=E;if(x-=A,x=Math.max(0,x),j){for(var B=0;B<A;B++)j.words[B]=this.words[B];j.length=A}if(A!==0)if(this.length>A)for(this.length-=A,B=0;B<this.length;B++)this.words[B]=this.words[B+A];else this.words[0]=0,this.length=1;var O=0;for(B=this.length-1;B>=0&&(O!==0||B>=x);B--){var H=0|this.words[B];this.words[B]=O<<26-k|H>>>k,O=H&C}return j&&O!==0&&(j.words[j.length++]=O),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(T,L,E){return u(this.negative===0),this.iushrn(T,L,E)},i.prototype.shln=function(T){return this.clone().ishln(T)},i.prototype.ushln=function(T){return this.clone().iushln(T)},i.prototype.shrn=function(T){return this.clone().ishrn(T)},i.prototype.ushrn=function(T){return this.clone().iushrn(T)},i.prototype.testn=function(T){u(typeof T=="number"&&T>=0);var L=T%26,E=(T-L)/26,x=1<<L;return!(this.length<=E)&&!!(this.words[E]&x)},i.prototype.imaskn=function(T){u(typeof T=="number"&&T>=0);var L=T%26,E=(T-L)/26;if(u(this.negative===0,"imaskn works only with positive numbers"),this.length<=E)return this;if(L!==0&&E++,this.length=Math.min(E,this.length),L!==0){var x=67108863^67108863>>>L<<L;this.words[this.length-1]&=x}return this.strip()},i.prototype.maskn=function(T){return this.clone().imaskn(T)},i.prototype.iaddn=function(T){return u(typeof T=="number"),u(T<67108864),T<0?this.isubn(-T):this.negative!==0?this.length===1&&(0|this.words[0])<T?(this.words[0]=T-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(T),this.negative=1,this):this._iaddn(T)},i.prototype._iaddn=function(T){this.words[0]+=T;for(var L=0;L<this.length&&this.words[L]>=67108864;L++)this.words[L]-=67108864,L===this.length-1?this.words[L+1]=1:this.words[L+1]++;return this.length=Math.max(this.length,L+1),this},i.prototype.isubn=function(T){if(u(typeof T=="number"),u(T<67108864),T<0)return this.iaddn(-T);if(this.negative!==0)return this.negative=0,this.iaddn(T),this.negative=1,this;if(this.words[0]-=T,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var L=0;L<this.length&&this.words[L]<0;L++)this.words[L]+=67108864,this.words[L+1]-=1;return this.strip()},i.prototype.addn=function(T){return this.clone().iaddn(T)},i.prototype.subn=function(T){return this.clone().isubn(T)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(T,L,E){var x,k,A=T.length+E;this._expand(A);var C=0;for(x=0;x<T.length;x++){k=(0|this.words[x+E])+C;var j=(0|T.words[x])*L;C=((k-=67108863&j)>>26)-(j/67108864|0),this.words[x+E]=67108863&k}for(;x<this.length-E;x++)C=(k=(0|this.words[x+E])+C)>>26,this.words[x+E]=67108863&k;if(C===0)return this.strip();for(u(C===-1),C=0,x=0;x<this.length;x++)C=(k=-(0|this.words[x])+C)>>26,this.words[x]=67108863&k;return this.negative=1,this.strip()},i.prototype._wordDiv=function(T,L){var E=(this.length,T.length),x=this.clone(),k=T,A=0|k.words[k.length-1];(E=26-this._countBits(A))!==0&&(k=k.ushln(E),x.iushln(E),A=0|k.words[k.length-1]);var C,j=x.length-k.length;if(L!=="mod"){(C=new i(null)).length=j+1,C.words=new Array(C.length);for(var B=0;B<C.length;B++)C.words[B]=0}var O=x.clone()._ishlnsubmul(k,1,j);O.negative===0&&(x=O,C&&(C.words[j]=1));for(var H=j-1;H>=0;H--){var X=67108864*(0|x.words[k.length+H])+(0|x.words[k.length+H-1]);for(X=Math.min(X/A|0,67108863),x._ishlnsubmul(k,X,H);x.negative!==0;)X--,x.negative=0,x._ishlnsubmul(k,1,H),x.isZero()||(x.negative^=1);C&&(C.words[H]=X)}return C&&C.strip(),x.strip(),L!=="div"&&E!==0&&x.iushrn(E),{div:C||null,mod:x}},i.prototype.divmod=function(T,L,E){return u(!T.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:this.negative!==0&&T.negative===0?(A=this.neg().divmod(T,L),L!=="mod"&&(x=A.div.neg()),L!=="div"&&(k=A.mod.neg(),E&&k.negative!==0&&k.iadd(T)),{div:x,mod:k}):this.negative===0&&T.negative!==0?(A=this.divmod(T.neg(),L),L!=="mod"&&(x=A.div.neg()),{div:x,mod:A.mod}):(this.negative&T.negative)!=0?(A=this.neg().divmod(T.neg(),L),L!=="div"&&(k=A.mod.neg(),E&&k.negative!==0&&k.isub(T)),{div:A.div,mod:k}):T.length>this.length||this.cmp(T)<0?{div:new i(0),mod:this}:T.length===1?L==="div"?{div:this.divn(T.words[0]),mod:null}:L==="mod"?{div:null,mod:new i(this.modn(T.words[0]))}:{div:this.divn(T.words[0]),mod:new i(this.modn(T.words[0]))}:this._wordDiv(T,L);var x,k,A},i.prototype.div=function(T){return this.divmod(T,"div",!1).div},i.prototype.mod=function(T){return this.divmod(T,"mod",!1).mod},i.prototype.umod=function(T){return this.divmod(T,"mod",!0).mod},i.prototype.divRound=function(T){var L=this.divmod(T);if(L.mod.isZero())return L.div;var E=L.div.negative!==0?L.mod.isub(T):L.mod,x=T.ushrn(1),k=T.andln(1),A=E.cmp(x);return A<0||k===1&&A===0?L.div:L.div.negative!==0?L.div.isubn(1):L.div.iaddn(1)},i.prototype.modn=function(T){u(T<=67108863);for(var L=(1<<26)%T,E=0,x=this.length-1;x>=0;x--)E=(L*E+(0|this.words[x]))%T;return E},i.prototype.idivn=function(T){u(T<=67108863);for(var L=0,E=this.length-1;E>=0;E--){var x=(0|this.words[E])+67108864*L;this.words[E]=x/T|0,L=x%T}return this.strip()},i.prototype.divn=function(T){return this.clone().idivn(T)},i.prototype.egcd=function(T){u(T.negative===0),u(!T.isZero());var L=this,E=T.clone();L=L.negative!==0?L.umod(T):L.clone();for(var x=new i(1),k=new i(0),A=new i(0),C=new i(1),j=0;L.isEven()&&E.isEven();)L.iushrn(1),E.iushrn(1),++j;for(var B=E.clone(),O=L.clone();!L.isZero();){for(var H=0,X=1;(L.words[0]&X)==0&&H<26;++H,X<<=1);if(H>0)for(L.iushrn(H);H-- >0;)(x.isOdd()||k.isOdd())&&(x.iadd(B),k.isub(O)),x.iushrn(1),k.iushrn(1);for(var et=0,V=1;(E.words[0]&V)==0&&et<26;++et,V<<=1);if(et>0)for(E.iushrn(et);et-- >0;)(A.isOdd()||C.isOdd())&&(A.iadd(B),C.isub(O)),A.iushrn(1),C.iushrn(1);L.cmp(E)>=0?(L.isub(E),x.isub(A),k.isub(C)):(E.isub(L),A.isub(x),C.isub(k))}return{a:A,b:C,gcd:E.iushln(j)}},i.prototype._invmp=function(T){u(T.negative===0),u(!T.isZero());var L=this,E=T.clone();L=L.negative!==0?L.umod(T):L.clone();for(var x,k=new i(1),A=new i(0),C=E.clone();L.cmpn(1)>0&&E.cmpn(1)>0;){for(var j=0,B=1;(L.words[0]&B)==0&&j<26;++j,B<<=1);if(j>0)for(L.iushrn(j);j-- >0;)k.isOdd()&&k.iadd(C),k.iushrn(1);for(var O=0,H=1;(E.words[0]&H)==0&&O<26;++O,H<<=1);if(O>0)for(E.iushrn(O);O-- >0;)A.isOdd()&&A.iadd(C),A.iushrn(1);L.cmp(E)>=0?(L.isub(E),k.isub(A)):(E.isub(L),A.isub(k))}return(x=L.cmpn(1)===0?k:A).cmpn(0)<0&&x.iadd(T),x},i.prototype.gcd=function(T){if(this.isZero())return T.abs();if(T.isZero())return this.abs();var L=this.clone(),E=T.clone();L.negative=0,E.negative=0;for(var x=0;L.isEven()&&E.isEven();x++)L.iushrn(1),E.iushrn(1);for(;;){for(;L.isEven();)L.iushrn(1);for(;E.isEven();)E.iushrn(1);var k=L.cmp(E);if(k<0){var A=L;L=E,E=A}else if(k===0||E.cmpn(1)===0)break;L.isub(E)}return E.iushln(x)},i.prototype.invm=function(T){return this.egcd(T).a.umod(T)},i.prototype.isEven=function(){return(1&this.words[0])==0},i.prototype.isOdd=function(){return(1&this.words[0])==1},i.prototype.andln=function(T){return this.words[0]&T},i.prototype.bincn=function(T){u(typeof T=="number");var L=T%26,E=(T-L)/26,x=1<<L;if(this.length<=E)return this._expand(E+1),this.words[E]|=x,this;for(var k=x,A=E;k!==0&&A<this.length;A++){var C=0|this.words[A];k=(C+=k)>>>26,C&=67108863,this.words[A]=C}return k!==0&&(this.words[A]=k,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(T){var L,E=T<0;if(this.negative!==0&&!E)return-1;if(this.negative===0&&E)return 1;if(this.strip(),this.length>1)L=1;else{E&&(T=-T),u(T<=67108863,"Number is too big");var x=0|this.words[0];L=x===T?0:x<T?-1:1}return this.negative!==0?0|-L:L},i.prototype.cmp=function(T){if(this.negative!==0&&T.negative===0)return-1;if(this.negative===0&&T.negative!==0)return 1;var L=this.ucmp(T);return this.negative!==0?0|-L:L},i.prototype.ucmp=function(T){if(this.length>T.length)return 1;if(this.length<T.length)return-1;for(var L=0,E=this.length-1;E>=0;E--){var x=0|this.words[E],k=0|T.words[E];if(x!==k){x<k?L=-1:x>k&&(L=1);break}}return L},i.prototype.gtn=function(T){return this.cmpn(T)===1},i.prototype.gt=function(T){return this.cmp(T)===1},i.prototype.gten=function(T){return this.cmpn(T)>=0},i.prototype.gte=function(T){return this.cmp(T)>=0},i.prototype.ltn=function(T){return this.cmpn(T)===-1},i.prototype.lt=function(T){return this.cmp(T)===-1},i.prototype.lten=function(T){return this.cmpn(T)<=0},i.prototype.lte=function(T){return this.cmp(T)<=0},i.prototype.eqn=function(T){return this.cmpn(T)===0},i.prototype.eq=function(T){return this.cmp(T)===0},i.red=function(T){return new R(T)},i.prototype.toRed=function(T){return u(!this.red,"Already a number in reduction context"),u(this.negative===0,"red works only with positives"),T.convertTo(this)._forceRed(T)},i.prototype.fromRed=function(){return u(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(T){return this.red=T,this},i.prototype.forceRed=function(T){return u(!this.red,"Already a number in reduction context"),this._forceRed(T)},i.prototype.redAdd=function(T){return u(this.red,"redAdd works only with red numbers"),this.red.add(this,T)},i.prototype.redIAdd=function(T){return u(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,T)},i.prototype.redSub=function(T){return u(this.red,"redSub works only with red numbers"),this.red.sub(this,T)},i.prototype.redISub=function(T){return u(this.red,"redISub works only with red numbers"),this.red.isub(this,T)},i.prototype.redShl=function(T){return u(this.red,"redShl works only with red numbers"),this.red.shl(this,T)},i.prototype.redMul=function(T){return u(this.red,"redMul works only with red numbers"),this.red._verify2(this,T),this.red.mul(this,T)},i.prototype.redIMul=function(T){return u(this.red,"redMul works only with red numbers"),this.red._verify2(this,T),this.red.imul(this,T)},i.prototype.redSqr=function(){return u(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return u(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return u(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return u(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return u(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(T){return u(this.red&&!T.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,T)};var D={k256:null,p224:null,p192:null,p25519:null};function F(T,L){this.name=T,this.p=new i(L,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function G(){F.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P(){F.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function U(){F.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function q(){F.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function R(T){if(typeof T=="string"){var L=i._prime(T);this.m=L.p,this.prime=L}else u(T.gtn(1),"modulus must be greater than 1"),this.m=T,this.prime=null}function I(T){R.call(this,T),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}F.prototype._tmp=function(){var T=new i(null);return T.words=new Array(Math.ceil(this.n/13)),T},F.prototype.ireduce=function(T){var L,E=T;do this.split(E,this.tmp),L=(E=(E=this.imulK(E)).iadd(this.tmp)).bitLength();while(L>this.n);var x=L<this.n?-1:E.ucmp(this.p);return x===0?(E.words[0]=0,E.length=1):x>0?E.isub(this.p):E.strip!==void 0?E.strip():E._strip(),E},F.prototype.split=function(T,L){T.iushrn(this.n,0,L)},F.prototype.imulK=function(T){return T.imul(this.k)},l(G,F),G.prototype.split=function(T,L){for(var E=Math.min(T.length,9),x=0;x<E;x++)L.words[x]=T.words[x];if(L.length=E,T.length<=9)return T.words[0]=0,void(T.length=1);var k=T.words[9];for(L.words[L.length++]=4194303&k,x=10;x<T.length;x++){var A=0|T.words[x];T.words[x-10]=(4194303&A)<<4|k>>>22,k=A}k>>>=22,T.words[x-10]=k,k===0&&T.length>10?T.length-=10:T.length-=9},G.prototype.imulK=function(T){T.words[T.length]=0,T.words[T.length+1]=0,T.length+=2;for(var L=0,E=0;E<T.length;E++){var x=0|T.words[E];L+=977*x,T.words[E]=67108863&L,L=64*x+(L/67108864|0)}return T.words[T.length-1]===0&&(T.length--,T.words[T.length-1]===0&&T.length--),T},l(P,F),l(U,F),l(q,F),q.prototype.imulK=function(T){for(var L=0,E=0;E<T.length;E++){var x=19*(0|T.words[E])+L,k=67108863&x;x>>>=26,T.words[E]=k,L=x}return L!==0&&(T.words[T.length++]=L),T},i._prime=function(T){if(D[T])return D[T];var L;if(T==="k256")L=new G;else if(T==="p224")L=new P;else if(T==="p192")L=new U;else{if(T!=="p25519")throw new Error("Unknown prime "+T);L=new q}return D[T]=L,L},R.prototype._verify1=function(T){u(T.negative===0,"red works only with positives"),u(T.red,"red works only with red numbers")},R.prototype._verify2=function(T,L){u((T.negative|L.negative)==0,"red works only with positives"),u(T.red&&T.red===L.red,"red works only with red numbers")},R.prototype.imod=function(T){return this.prime?this.prime.ireduce(T)._forceRed(this):T.umod(this.m)._forceRed(this)},R.prototype.neg=function(T){return T.isZero()?T.clone():this.m.sub(T)._forceRed(this)},R.prototype.add=function(T,L){this._verify2(T,L);var E=T.add(L);return E.cmp(this.m)>=0&&E.isub(this.m),E._forceRed(this)},R.prototype.iadd=function(T,L){this._verify2(T,L);var E=T.iadd(L);return E.cmp(this.m)>=0&&E.isub(this.m),E},R.prototype.sub=function(T,L){this._verify2(T,L);var E=T.sub(L);return E.cmpn(0)<0&&E.iadd(this.m),E._forceRed(this)},R.prototype.isub=function(T,L){this._verify2(T,L);var E=T.isub(L);return E.cmpn(0)<0&&E.iadd(this.m),E},R.prototype.shl=function(T,L){return this._verify1(T),this.imod(T.ushln(L))},R.prototype.imul=function(T,L){return this._verify2(T,L),this.imod(T.imul(L))},R.prototype.mul=function(T,L){return this._verify2(T,L),this.imod(T.mul(L))},R.prototype.isqr=function(T){return this.imul(T,T.clone())},R.prototype.sqr=function(T){return this.mul(T,T)},R.prototype.sqrt=function(T){if(T.isZero())return T.clone();var L=this.m.andln(3);if(u(L%2==1),L===3){var E=this.m.add(new i(1)).iushrn(2);return this.pow(T,E)}for(var x=this.m.subn(1),k=0;!x.isZero()&&x.andln(1)===0;)k++,x.iushrn(1);u(!x.isZero());var A=new i(1).toRed(this),C=A.redNeg(),j=this.m.subn(1).iushrn(1),B=this.m.bitLength();for(B=new i(2*B*B).toRed(this);this.pow(B,j).cmp(C)!==0;)B.redIAdd(C);for(var O=this.pow(B,x),H=this.pow(T,x.addn(1).iushrn(1)),X=this.pow(T,x),et=k;X.cmp(A)!==0;){for(var V=X,tt=0;V.cmp(A)!==0;tt++)V=V.redSqr();u(tt<et);var $=this.pow(O,new i(1).iushln(et-tt-1));H=H.redMul($),O=$.redSqr(),X=X.redMul(O),et=tt}return H},R.prototype.invm=function(T){var L=T._invmp(this.m);return L.negative!==0?(L.negative=0,this.imod(L).redNeg()):this.imod(L)},R.prototype.pow=function(T,L){if(L.isZero())return new i(1).toRed(this);if(L.cmpn(1)===0)return T.clone();var E=new Array(16);E[0]=new i(1).toRed(this),E[1]=T;for(var x=2;x<E.length;x++)E[x]=this.mul(E[x-1],T);var k=E[0],A=0,C=0,j=L.bitLength()%26;for(j===0&&(j=26),x=L.length-1;x>=0;x--){for(var B=L.words[x],O=j-1;O>=0;O--){var H=B>>O&1;k!==E[0]&&(k=this.sqr(k)),H!==0||A!==0?(A<<=1,A|=H,(++C===4||x===0&&O===0)&&(k=this.mul(k,E[A]),C=0,A=0)):C=0}j=26}return k},R.prototype.convertTo=function(T){var L=T.umod(this.m);return L===T?L.clone():L},R.prototype.convertFrom=function(T){var L=T.clone();return L.red=null,L},i.mont=function(T){return new I(T)},l(I,R),I.prototype.convertTo=function(T){return this.imod(T.ushln(this.shift))},I.prototype.convertFrom=function(T){var L=this.imod(T.mul(this.rinv));return L.red=null,L},I.prototype.imul=function(T,L){if(T.isZero()||L.isZero())return T.words[0]=0,T.length=1,T;var E=T.imul(L),x=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=E.isub(x).iushrn(this.shift),A=k;return k.cmp(this.m)>=0?A=k.isub(this.m):k.cmpn(0)<0&&(A=k.iadd(this.m)),A._forceRed(this)},I.prototype.mul=function(T,L){if(T.isZero()||L.isZero())return new i(0)._forceRed(this);var E=T.mul(L),x=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=E.isub(x).iushrn(this.shift),A=k;return k.cmp(this.m)>=0?A=k.isub(this.m):k.cmpn(0)<0&&(A=k.iadd(this.m)),A._forceRed(this)},I.prototype.invm=function(T){return this.imod(T._invmp(this.m).mul(this.r2))._forceRed(this)}})(r===void 0||r)},{buffer:188}],185:[function(t,r,o){o.byteLength=function(f){var g=p(f),y=g[0],b=g[1];return 3*(y+b)/4-b},o.toByteArray=function(f){var g,y,b=p(f),v=b[0],w=b[1],S=new u((function(F,G,P){return 3*(G+P)/4-P})(0,v,w)),N=0,D=w>0?v-4:v;for(y=0;y<D;y+=4)g=a[f.charCodeAt(y)]<<18|a[f.charCodeAt(y+1)]<<12|a[f.charCodeAt(y+2)]<<6|a[f.charCodeAt(y+3)],S[N++]=g>>16&255,S[N++]=g>>8&255,S[N++]=255&g;return w===2&&(g=a[f.charCodeAt(y)]<<2|a[f.charCodeAt(y+1)]>>4,S[N++]=255&g),w===1&&(g=a[f.charCodeAt(y)]<<10|a[f.charCodeAt(y+1)]<<4|a[f.charCodeAt(y+2)]>>2,S[N++]=g>>8&255,S[N++]=255&g),S},o.fromByteArray=function(f){for(var g,y=f.length,b=y%3,v=[],w=0,S=y-b;w<S;w+=16383)v.push(h(f,w,w+16383>S?S:w+16383));return b===1?(g=f[y-1],v.push(s[g>>2]+s[g<<4&63]+"==")):b===2&&(g=(f[y-2]<<8)+f[y-1],v.push(s[g>>10]+s[g>>4&63]+s[g<<2&63]+"=")),v.join("")};for(var s=[],a=[],u=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,c=l.length;i<c;++i)s[i]=l[i],a[l.charCodeAt(i)]=i;function p(f){var g=f.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=f.indexOf("=");return y===-1&&(y=g),[y,y===g?0:4-y%4]}function h(f,g,y){for(var b,v,w=[],S=g;S<y;S+=3)b=(f[S]<<16&16711680)+(f[S+1]<<8&65280)+(255&f[S+2]),w.push(s[(v=b)>>18&63]+s[v>>12&63]+s[v>>6&63]+s[63&v]);return w.join("")}a[45]=62,a[95]=63},{}],186:[function(t,r,o){(function(s,a){function u(E,x){if(!E)throw new Error(x||"Assertion failed")}function l(E,x){E.super_=x;var k=function(){};k.prototype=x.prototype,E.prototype=new k,E.prototype.constructor=E}function i(E,x,k){if(i.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&(x!=="le"&&x!=="be"||(k=x,x=10),this._init(E||0,x||10,k||"be"))}var c;typeof s=="object"?s.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{c=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:t("buffer").Buffer}catch{}function p(E,x){var k=E.charCodeAt(x);return k>=48&&k<=57?k-48:k>=65&&k<=70?k-55:k>=97&&k<=102?k-87:void u(!1,"Invalid character in "+E)}function h(E,x,k){var A=p(E,k);return k-1>=x&&(A|=p(E,k-1)<<4),A}function f(E,x,k,A){for(var C=0,j=0,B=Math.min(E.length,k),O=x;O<B;O++){var H=E.charCodeAt(O)-48;C*=A,j=H>=49?H-49+10:H>=17?H-17+10:H,u(H>=0&&j<A,"Invalid character"),C+=j}return C}function g(E,x){E.words=x.words,E.length=x.length,E.negative=x.negative,E.red=x.red}if(i.isBN=function(E){return E instanceof i||E!==null&&typeof E=="object"&&E.constructor.wordSize===i.wordSize&&Array.isArray(E.words)},i.max=function(E,x){return E.cmp(x)>0?E:x},i.min=function(E,x){return E.cmp(x)<0?E:x},i.prototype._init=function(E,x,k){if(typeof E=="number")return this._initNumber(E,x,k);if(typeof E=="object")return this._initArray(E,x,k);x==="hex"&&(x=16),u(x===(0|x)&&x>=2&&x<=36);var A=0;(E=E.toString().replace(/\s+/g,""))[0]==="-"&&(A++,this.negative=1),A<E.length&&(x===16?this._parseHex(E,A,k):(this._parseBase(E,x,A),k==="le"&&this._initArray(this.toArray(),x,k)))},i.prototype._initNumber=function(E,x,k){E<0&&(this.negative=1,E=-E),E<67108864?(this.words=[67108863&E],this.length=1):E<4503599627370496?(this.words=[67108863&E,E/67108864&67108863],this.length=2):(u(E<9007199254740992),this.words=[67108863&E,E/67108864&67108863,1],this.length=3),k==="le"&&this._initArray(this.toArray(),x,k)},i.prototype._initArray=function(E,x,k){if(u(typeof E.length=="number"),E.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(E.length/3),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var C,j,B=0;if(k==="be")for(A=E.length-1,C=0;A>=0;A-=3)j=E[A]|E[A-1]<<8|E[A-2]<<16,this.words[C]|=j<<B&67108863,this.words[C+1]=j>>>26-B&67108863,(B+=24)>=26&&(B-=26,C++);else if(k==="le")for(A=0,C=0;A<E.length;A+=3)j=E[A]|E[A+1]<<8|E[A+2]<<16,this.words[C]|=j<<B&67108863,this.words[C+1]=j>>>26-B&67108863,(B+=24)>=26&&(B-=26,C++);return this._strip()},i.prototype._parseHex=function(E,x,k){this.length=Math.ceil((E.length-x)/6),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var C,j=0,B=0;if(k==="be")for(A=E.length-1;A>=x;A-=2)C=h(E,x,A)<<j,this.words[B]|=67108863&C,j>=18?(j-=18,B+=1,this.words[B]|=C>>>26):j+=8;else for(A=(E.length-x)%2==0?x+1:x;A<E.length;A+=2)C=h(E,x,A)<<j,this.words[B]|=67108863&C,j>=18?(j-=18,B+=1,this.words[B]|=C>>>26):j+=8;this._strip()},i.prototype._parseBase=function(E,x,k){this.words=[0],this.length=1;for(var A=0,C=1;C<=67108863;C*=x)A++;A--,C=C/x|0;for(var j=E.length-k,B=j%A,O=Math.min(j,j-B)+k,H=0,X=k;X<O;X+=A)H=f(E,X,X+A,x),this.imuln(C),this.words[0]+H<67108864?this.words[0]+=H:this._iaddn(H);if(B!==0){var et=1;for(H=f(E,X,E.length,x),X=0;X<B;X++)et*=x;this.imuln(et),this.words[0]+H<67108864?this.words[0]+=H:this._iaddn(H)}this._strip()},i.prototype.copy=function(E){E.words=new Array(this.length);for(var x=0;x<this.length;x++)E.words[x]=this.words[x];E.length=this.length,E.negative=this.negative,E.red=this.red},i.prototype._move=function(E){g(E,this)},i.prototype.clone=function(){var E=new i(null);return this.copy(E),E},i.prototype._expand=function(E){for(;this.length<E;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=y}catch{i.prototype.inspect=y}else i.prototype.inspect=y;function y(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var b=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],w=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(E,x){var k;if(x=0|x||1,(E=E||10)===16||E==="hex"){k="";for(var A=0,C=0,j=0;j<this.length;j++){var B=this.words[j],O=(16777215&(B<<A|C)).toString(16);C=B>>>24-A&16777215,(A+=2)>=26&&(A-=26,j--),k=C!==0||j!==this.length-1?b[6-O.length]+O+k:O+k}for(C!==0&&(k=C.toString(16)+k);k.length%x!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}if(E===(0|E)&&E>=2&&E<=36){var H=v[E],X=w[E];k="";var et=this.clone();for(et.negative=0;!et.isZero();){var V=et.modrn(X).toString(E);k=(et=et.idivn(X)).isZero()?V+k:b[H-V.length]+V+k}for(this.isZero()&&(k="0"+k);k.length%x!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}u(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var E=this.words[0];return this.length===2?E+=67108864*this.words[1]:this.length===3&&this.words[2]===1?E+=4503599627370496+67108864*this.words[1]:this.length>2&&u(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-E:E},i.prototype.toJSON=function(){return this.toString(16,2)},c&&(i.prototype.toBuffer=function(E,x){return this.toArrayLike(c,E,x)}),i.prototype.toArray=function(E,x){return this.toArrayLike(Array,E,x)};function S(E,x,k){k.negative=x.negative^E.negative;var A=E.length+x.length|0;k.length=A,A=A-1|0;var C=0|E.words[0],j=0|x.words[0],B=C*j,O=67108863&B,H=B/67108864|0;k.words[0]=O;for(var X=1;X<A;X++){for(var et=H>>>26,V=67108863&H,tt=Math.min(X,x.length-1),$=Math.max(0,X-E.length+1);$<=tt;$++){var z=X-$|0;et+=(B=(C=0|E.words[z])*(j=0|x.words[$])+V)/67108864|0,V=67108863&B}k.words[X]=0|V,H=0|et}return H!==0?k.words[X]=0|H:k.length--,k._strip()}i.prototype.toArrayLike=function(E,x,k){this._strip();var A=this.byteLength(),C=k||Math.max(1,A);u(A<=C,"byte array longer than desired length"),u(C>0,"Requested array length <= 0");var j=(function(B,O){return B.allocUnsafe?B.allocUnsafe(O):new B(O)})(E,C);return this["_toArrayLike"+(x==="le"?"LE":"BE")](j,A),j},i.prototype._toArrayLikeLE=function(E,x){for(var k=0,A=0,C=0,j=0;C<this.length;C++){var B=this.words[C]<<j|A;E[k++]=255&B,k<E.length&&(E[k++]=B>>8&255),k<E.length&&(E[k++]=B>>16&255),j===6?(k<E.length&&(E[k++]=B>>24&255),A=0,j=0):(A=B>>>24,j+=2)}if(k<E.length)for(E[k++]=A;k<E.length;)E[k++]=0},i.prototype._toArrayLikeBE=function(E,x){for(var k=E.length-1,A=0,C=0,j=0;C<this.length;C++){var B=this.words[C]<<j|A;E[k--]=255&B,k>=0&&(E[k--]=B>>8&255),k>=0&&(E[k--]=B>>16&255),j===6?(k>=0&&(E[k--]=B>>24&255),A=0,j=0):(A=B>>>24,j+=2)}if(k>=0)for(E[k--]=A;k>=0;)E[k--]=0},Math.clz32?i.prototype._countBits=function(E){return 32-Math.clz32(E)}:i.prototype._countBits=function(E){var x=E,k=0;return x>=4096&&(k+=13,x>>>=13),x>=64&&(k+=7,x>>>=7),x>=8&&(k+=4,x>>>=4),x>=2&&(k+=2,x>>>=2),k+x},i.prototype._zeroBits=function(E){if(E===0)return 26;var x=E,k=0;return(8191&x)==0&&(k+=13,x>>>=13),(127&x)==0&&(k+=7,x>>>=7),(15&x)==0&&(k+=4,x>>>=4),(3&x)==0&&(k+=2,x>>>=2),(1&x)==0&&k++,k},i.prototype.bitLength=function(){var E=this.words[this.length-1],x=this._countBits(E);return 26*(this.length-1)+x},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var E=0,x=0;x<this.length;x++){var k=this._zeroBits(this.words[x]);if(E+=k,k!==26)break}return E},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(E){return this.negative!==0?this.abs().inotn(E).iaddn(1):this.clone()},i.prototype.fromTwos=function(E){return this.testn(E-1)?this.notn(E).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(E){for(;this.length<E.length;)this.words[this.length++]=0;for(var x=0;x<E.length;x++)this.words[x]=this.words[x]|E.words[x];return this._strip()},i.prototype.ior=function(E){return u((this.negative|E.negative)==0),this.iuor(E)},i.prototype.or=function(E){return this.length>E.length?this.clone().ior(E):E.clone().ior(this)},i.prototype.uor=function(E){return this.length>E.length?this.clone().iuor(E):E.clone().iuor(this)},i.prototype.iuand=function(E){var x;x=this.length>E.length?E:this;for(var k=0;k<x.length;k++)this.words[k]=this.words[k]&E.words[k];return this.length=x.length,this._strip()},i.prototype.iand=function(E){return u((this.negative|E.negative)==0),this.iuand(E)},i.prototype.and=function(E){return this.length>E.length?this.clone().iand(E):E.clone().iand(this)},i.prototype.uand=function(E){return this.length>E.length?this.clone().iuand(E):E.clone().iuand(this)},i.prototype.iuxor=function(E){var x,k;this.length>E.length?(x=this,k=E):(x=E,k=this);for(var A=0;A<k.length;A++)this.words[A]=x.words[A]^k.words[A];if(this!==x)for(;A<x.length;A++)this.words[A]=x.words[A];return this.length=x.length,this._strip()},i.prototype.ixor=function(E){return u((this.negative|E.negative)==0),this.iuxor(E)},i.prototype.xor=function(E){return this.length>E.length?this.clone().ixor(E):E.clone().ixor(this)},i.prototype.uxor=function(E){return this.length>E.length?this.clone().iuxor(E):E.clone().iuxor(this)},i.prototype.inotn=function(E){u(typeof E=="number"&&E>=0);var x=0|Math.ceil(E/26),k=E%26;this._expand(x),k>0&&x--;for(var A=0;A<x;A++)this.words[A]=67108863&~this.words[A];return k>0&&(this.words[A]=~this.words[A]&67108863>>26-k),this._strip()},i.prototype.notn=function(E){return this.clone().inotn(E)},i.prototype.setn=function(E,x){u(typeof E=="number"&&E>=0);var k=E/26|0,A=E%26;return this._expand(k+1),this.words[k]=x?this.words[k]|1<<A:this.words[k]&~(1<<A),this._strip()},i.prototype.iadd=function(E){var x,k,A;if(this.negative!==0&&E.negative===0)return this.negative=0,x=this.isub(E),this.negative^=1,this._normSign();if(this.negative===0&&E.negative!==0)return E.negative=0,x=this.isub(E),E.negative=1,x._normSign();this.length>E.length?(k=this,A=E):(k=E,A=this);for(var C=0,j=0;j<A.length;j++)x=(0|k.words[j])+(0|A.words[j])+C,this.words[j]=67108863&x,C=x>>>26;for(;C!==0&&j<k.length;j++)x=(0|k.words[j])+C,this.words[j]=67108863&x,C=x>>>26;if(this.length=k.length,C!==0)this.words[this.length]=C,this.length++;else if(k!==this)for(;j<k.length;j++)this.words[j]=k.words[j];return this},i.prototype.add=function(E){var x;return E.negative!==0&&this.negative===0?(E.negative=0,x=this.sub(E),E.negative^=1,x):E.negative===0&&this.negative!==0?(this.negative=0,x=E.sub(this),this.negative=1,x):this.length>E.length?this.clone().iadd(E):E.clone().iadd(this)},i.prototype.isub=function(E){if(E.negative!==0){E.negative=0;var x=this.iadd(E);return E.negative=1,x._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(E),this.negative=1,this._normSign();var k,A,C=this.cmp(E);if(C===0)return this.negative=0,this.length=1,this.words[0]=0,this;C>0?(k=this,A=E):(k=E,A=this);for(var j=0,B=0;B<A.length;B++)j=(x=(0|k.words[B])-(0|A.words[B])+j)>>26,this.words[B]=67108863&x;for(;j!==0&&B<k.length;B++)j=(x=(0|k.words[B])+j)>>26,this.words[B]=67108863&x;if(j===0&&B<k.length&&k!==this)for(;B<k.length;B++)this.words[B]=k.words[B];return this.length=Math.max(this.length,B),k!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(E){return this.clone().isub(E)};var N=function(E,x,k){var A,C,j,B=E.words,O=x.words,H=k.words,X=0,et=0|B[0],V=8191&et,tt=et>>>13,$=0|B[1],z=8191&$,Z=$>>>13,it=0|B[2],mt=8191&it,lt=it>>>13,at=0|B[3],rt=8191&at,ct=at>>>13,ot=0|B[4],dt=8191&ot,ft=ot>>>13,gt=0|B[5],wt=8191&gt,yt=gt>>>13,Et=0|B[6],Mt=8191&Et,qt=Et>>>13,Tt=0|B[7],It=8191&Tt,Vt=Tt>>>13,Kt=0|B[8],ne=8191&Kt,ae=Kt>>>13,Oe=0|B[9],le=8191&Oe,Jt=Oe>>>13,ue=0|O[0],ge=8191&ue,fe=ue>>>13,qe=0|O[1],Be=8191&qe,ke=qe>>>13,Je=0|O[2],Fe=8191&Je,Me=Je>>>13,Ke=0|O[3],En=8191&Ke,Xe=Ke>>>13,Sn=0|O[4],Nn=8191&Sn,Te=Sn>>>13,_n=0|O[5],Pn=8191&_n,on=_n>>>13,Dt=0|O[6],Ht=8191&Dt,re=Dt>>>13,we=0|O[7],nn=8191&we,Ie=we>>>13,Ue=0|O[8],He=8191&Ue,Ge=Ue>>>13,Ve=0|O[9],an=8191&Ve,kn=Ve>>>13;k.negative=E.negative^x.negative,k.length=19;var qn=(X+(A=Math.imul(V,ge))|0)+((8191&(C=(C=Math.imul(V,fe))+Math.imul(tt,ge)|0))<<13)|0;X=((j=Math.imul(tt,fe))+(C>>>13)|0)+(qn>>>26)|0,qn&=67108863,A=Math.imul(z,ge),C=(C=Math.imul(z,fe))+Math.imul(Z,ge)|0,j=Math.imul(Z,fe);var Qt=(X+(A=A+Math.imul(V,Be)|0)|0)+((8191&(C=(C=C+Math.imul(V,ke)|0)+Math.imul(tt,Be)|0))<<13)|0;X=((j=j+Math.imul(tt,ke)|0)+(C>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,A=Math.imul(mt,ge),C=(C=Math.imul(mt,fe))+Math.imul(lt,ge)|0,j=Math.imul(lt,fe),A=A+Math.imul(z,Be)|0,C=(C=C+Math.imul(z,ke)|0)+Math.imul(Z,Be)|0,j=j+Math.imul(Z,ke)|0;var de=(X+(A=A+Math.imul(V,Fe)|0)|0)+((8191&(C=(C=C+Math.imul(V,Me)|0)+Math.imul(tt,Fe)|0))<<13)|0;X=((j=j+Math.imul(tt,Me)|0)+(C>>>13)|0)+(de>>>26)|0,de&=67108863,A=Math.imul(rt,ge),C=(C=Math.imul(rt,fe))+Math.imul(ct,ge)|0,j=Math.imul(ct,fe),A=A+Math.imul(mt,Be)|0,C=(C=C+Math.imul(mt,ke)|0)+Math.imul(lt,Be)|0,j=j+Math.imul(lt,ke)|0,A=A+Math.imul(z,Fe)|0,C=(C=C+Math.imul(z,Me)|0)+Math.imul(Z,Fe)|0,j=j+Math.imul(Z,Me)|0;var Ee=(X+(A=A+Math.imul(V,En)|0)|0)+((8191&(C=(C=C+Math.imul(V,Xe)|0)+Math.imul(tt,En)|0))<<13)|0;X=((j=j+Math.imul(tt,Xe)|0)+(C>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,A=Math.imul(dt,ge),C=(C=Math.imul(dt,fe))+Math.imul(ft,ge)|0,j=Math.imul(ft,fe),A=A+Math.imul(rt,Be)|0,C=(C=C+Math.imul(rt,ke)|0)+Math.imul(ct,Be)|0,j=j+Math.imul(ct,ke)|0,A=A+Math.imul(mt,Fe)|0,C=(C=C+Math.imul(mt,Me)|0)+Math.imul(lt,Fe)|0,j=j+Math.imul(lt,Me)|0,A=A+Math.imul(z,En)|0,C=(C=C+Math.imul(z,Xe)|0)+Math.imul(Z,En)|0,j=j+Math.imul(Z,Xe)|0;var Pe=(X+(A=A+Math.imul(V,Nn)|0)|0)+((8191&(C=(C=C+Math.imul(V,Te)|0)+Math.imul(tt,Nn)|0))<<13)|0;X=((j=j+Math.imul(tt,Te)|0)+(C>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,A=Math.imul(wt,ge),C=(C=Math.imul(wt,fe))+Math.imul(yt,ge)|0,j=Math.imul(yt,fe),A=A+Math.imul(dt,Be)|0,C=(C=C+Math.imul(dt,ke)|0)+Math.imul(ft,Be)|0,j=j+Math.imul(ft,ke)|0,A=A+Math.imul(rt,Fe)|0,C=(C=C+Math.imul(rt,Me)|0)+Math.imul(ct,Fe)|0,j=j+Math.imul(ct,Me)|0,A=A+Math.imul(mt,En)|0,C=(C=C+Math.imul(mt,Xe)|0)+Math.imul(lt,En)|0,j=j+Math.imul(lt,Xe)|0,A=A+Math.imul(z,Nn)|0,C=(C=C+Math.imul(z,Te)|0)+Math.imul(Z,Nn)|0,j=j+Math.imul(Z,Te)|0;var _t=(X+(A=A+Math.imul(V,Pn)|0)|0)+((8191&(C=(C=C+Math.imul(V,on)|0)+Math.imul(tt,Pn)|0))<<13)|0;X=((j=j+Math.imul(tt,on)|0)+(C>>>13)|0)+(_t>>>26)|0,_t&=67108863,A=Math.imul(Mt,ge),C=(C=Math.imul(Mt,fe))+Math.imul(qt,ge)|0,j=Math.imul(qt,fe),A=A+Math.imul(wt,Be)|0,C=(C=C+Math.imul(wt,ke)|0)+Math.imul(yt,Be)|0,j=j+Math.imul(yt,ke)|0,A=A+Math.imul(dt,Fe)|0,C=(C=C+Math.imul(dt,Me)|0)+Math.imul(ft,Fe)|0,j=j+Math.imul(ft,Me)|0,A=A+Math.imul(rt,En)|0,C=(C=C+Math.imul(rt,Xe)|0)+Math.imul(ct,En)|0,j=j+Math.imul(ct,Xe)|0,A=A+Math.imul(mt,Nn)|0,C=(C=C+Math.imul(mt,Te)|0)+Math.imul(lt,Nn)|0,j=j+Math.imul(lt,Te)|0,A=A+Math.imul(z,Pn)|0,C=(C=C+Math.imul(z,on)|0)+Math.imul(Z,Pn)|0,j=j+Math.imul(Z,on)|0;var Bt=(X+(A=A+Math.imul(V,Ht)|0)|0)+((8191&(C=(C=C+Math.imul(V,re)|0)+Math.imul(tt,Ht)|0))<<13)|0;X=((j=j+Math.imul(tt,re)|0)+(C>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,A=Math.imul(It,ge),C=(C=Math.imul(It,fe))+Math.imul(Vt,ge)|0,j=Math.imul(Vt,fe),A=A+Math.imul(Mt,Be)|0,C=(C=C+Math.imul(Mt,ke)|0)+Math.imul(qt,Be)|0,j=j+Math.imul(qt,ke)|0,A=A+Math.imul(wt,Fe)|0,C=(C=C+Math.imul(wt,Me)|0)+Math.imul(yt,Fe)|0,j=j+Math.imul(yt,Me)|0,A=A+Math.imul(dt,En)|0,C=(C=C+Math.imul(dt,Xe)|0)+Math.imul(ft,En)|0,j=j+Math.imul(ft,Xe)|0,A=A+Math.imul(rt,Nn)|0,C=(C=C+Math.imul(rt,Te)|0)+Math.imul(ct,Nn)|0,j=j+Math.imul(ct,Te)|0,A=A+Math.imul(mt,Pn)|0,C=(C=C+Math.imul(mt,on)|0)+Math.imul(lt,Pn)|0,j=j+Math.imul(lt,on)|0,A=A+Math.imul(z,Ht)|0,C=(C=C+Math.imul(z,re)|0)+Math.imul(Z,Ht)|0,j=j+Math.imul(Z,re)|0;var Gt=(X+(A=A+Math.imul(V,nn)|0)|0)+((8191&(C=(C=C+Math.imul(V,Ie)|0)+Math.imul(tt,nn)|0))<<13)|0;X=((j=j+Math.imul(tt,Ie)|0)+(C>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,A=Math.imul(ne,ge),C=(C=Math.imul(ne,fe))+Math.imul(ae,ge)|0,j=Math.imul(ae,fe),A=A+Math.imul(It,Be)|0,C=(C=C+Math.imul(It,ke)|0)+Math.imul(Vt,Be)|0,j=j+Math.imul(Vt,ke)|0,A=A+Math.imul(Mt,Fe)|0,C=(C=C+Math.imul(Mt,Me)|0)+Math.imul(qt,Fe)|0,j=j+Math.imul(qt,Me)|0,A=A+Math.imul(wt,En)|0,C=(C=C+Math.imul(wt,Xe)|0)+Math.imul(yt,En)|0,j=j+Math.imul(yt,Xe)|0,A=A+Math.imul(dt,Nn)|0,C=(C=C+Math.imul(dt,Te)|0)+Math.imul(ft,Nn)|0,j=j+Math.imul(ft,Te)|0,A=A+Math.imul(rt,Pn)|0,C=(C=C+Math.imul(rt,on)|0)+Math.imul(ct,Pn)|0,j=j+Math.imul(ct,on)|0,A=A+Math.imul(mt,Ht)|0,C=(C=C+Math.imul(mt,re)|0)+Math.imul(lt,Ht)|0,j=j+Math.imul(lt,re)|0,A=A+Math.imul(z,nn)|0,C=(C=C+Math.imul(z,Ie)|0)+Math.imul(Z,nn)|0,j=j+Math.imul(Z,Ie)|0;var pe=(X+(A=A+Math.imul(V,He)|0)|0)+((8191&(C=(C=C+Math.imul(V,Ge)|0)+Math.imul(tt,He)|0))<<13)|0;X=((j=j+Math.imul(tt,Ge)|0)+(C>>>13)|0)+(pe>>>26)|0,pe&=67108863,A=Math.imul(le,ge),C=(C=Math.imul(le,fe))+Math.imul(Jt,ge)|0,j=Math.imul(Jt,fe),A=A+Math.imul(ne,Be)|0,C=(C=C+Math.imul(ne,ke)|0)+Math.imul(ae,Be)|0,j=j+Math.imul(ae,ke)|0,A=A+Math.imul(It,Fe)|0,C=(C=C+Math.imul(It,Me)|0)+Math.imul(Vt,Fe)|0,j=j+Math.imul(Vt,Me)|0,A=A+Math.imul(Mt,En)|0,C=(C=C+Math.imul(Mt,Xe)|0)+Math.imul(qt,En)|0,j=j+Math.imul(qt,Xe)|0,A=A+Math.imul(wt,Nn)|0,C=(C=C+Math.imul(wt,Te)|0)+Math.imul(yt,Nn)|0,j=j+Math.imul(yt,Te)|0,A=A+Math.imul(dt,Pn)|0,C=(C=C+Math.imul(dt,on)|0)+Math.imul(ft,Pn)|0,j=j+Math.imul(ft,on)|0,A=A+Math.imul(rt,Ht)|0,C=(C=C+Math.imul(rt,re)|0)+Math.imul(ct,Ht)|0,j=j+Math.imul(ct,re)|0,A=A+Math.imul(mt,nn)|0,C=(C=C+Math.imul(mt,Ie)|0)+Math.imul(lt,nn)|0,j=j+Math.imul(lt,Ie)|0,A=A+Math.imul(z,He)|0,C=(C=C+Math.imul(z,Ge)|0)+Math.imul(Z,He)|0,j=j+Math.imul(Z,Ge)|0;var Ne=(X+(A=A+Math.imul(V,an)|0)|0)+((8191&(C=(C=C+Math.imul(V,kn)|0)+Math.imul(tt,an)|0))<<13)|0;X=((j=j+Math.imul(tt,kn)|0)+(C>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,A=Math.imul(le,Be),C=(C=Math.imul(le,ke))+Math.imul(Jt,Be)|0,j=Math.imul(Jt,ke),A=A+Math.imul(ne,Fe)|0,C=(C=C+Math.imul(ne,Me)|0)+Math.imul(ae,Fe)|0,j=j+Math.imul(ae,Me)|0,A=A+Math.imul(It,En)|0,C=(C=C+Math.imul(It,Xe)|0)+Math.imul(Vt,En)|0,j=j+Math.imul(Vt,Xe)|0,A=A+Math.imul(Mt,Nn)|0,C=(C=C+Math.imul(Mt,Te)|0)+Math.imul(qt,Nn)|0,j=j+Math.imul(qt,Te)|0,A=A+Math.imul(wt,Pn)|0,C=(C=C+Math.imul(wt,on)|0)+Math.imul(yt,Pn)|0,j=j+Math.imul(yt,on)|0,A=A+Math.imul(dt,Ht)|0,C=(C=C+Math.imul(dt,re)|0)+Math.imul(ft,Ht)|0,j=j+Math.imul(ft,re)|0,A=A+Math.imul(rt,nn)|0,C=(C=C+Math.imul(rt,Ie)|0)+Math.imul(ct,nn)|0,j=j+Math.imul(ct,Ie)|0,A=A+Math.imul(mt,He)|0,C=(C=C+Math.imul(mt,Ge)|0)+Math.imul(lt,He)|0,j=j+Math.imul(lt,Ge)|0;var ye=(X+(A=A+Math.imul(z,an)|0)|0)+((8191&(C=(C=C+Math.imul(z,kn)|0)+Math.imul(Z,an)|0))<<13)|0;X=((j=j+Math.imul(Z,kn)|0)+(C>>>13)|0)+(ye>>>26)|0,ye&=67108863,A=Math.imul(le,Fe),C=(C=Math.imul(le,Me))+Math.imul(Jt,Fe)|0,j=Math.imul(Jt,Me),A=A+Math.imul(ne,En)|0,C=(C=C+Math.imul(ne,Xe)|0)+Math.imul(ae,En)|0,j=j+Math.imul(ae,Xe)|0,A=A+Math.imul(It,Nn)|0,C=(C=C+Math.imul(It,Te)|0)+Math.imul(Vt,Nn)|0,j=j+Math.imul(Vt,Te)|0,A=A+Math.imul(Mt,Pn)|0,C=(C=C+Math.imul(Mt,on)|0)+Math.imul(qt,Pn)|0,j=j+Math.imul(qt,on)|0,A=A+Math.imul(wt,Ht)|0,C=(C=C+Math.imul(wt,re)|0)+Math.imul(yt,Ht)|0,j=j+Math.imul(yt,re)|0,A=A+Math.imul(dt,nn)|0,C=(C=C+Math.imul(dt,Ie)|0)+Math.imul(ft,nn)|0,j=j+Math.imul(ft,Ie)|0,A=A+Math.imul(rt,He)|0,C=(C=C+Math.imul(rt,Ge)|0)+Math.imul(ct,He)|0,j=j+Math.imul(ct,Ge)|0;var xe=(X+(A=A+Math.imul(mt,an)|0)|0)+((8191&(C=(C=C+Math.imul(mt,kn)|0)+Math.imul(lt,an)|0))<<13)|0;X=((j=j+Math.imul(lt,kn)|0)+(C>>>13)|0)+(xe>>>26)|0,xe&=67108863,A=Math.imul(le,En),C=(C=Math.imul(le,Xe))+Math.imul(Jt,En)|0,j=Math.imul(Jt,Xe),A=A+Math.imul(ne,Nn)|0,C=(C=C+Math.imul(ne,Te)|0)+Math.imul(ae,Nn)|0,j=j+Math.imul(ae,Te)|0,A=A+Math.imul(It,Pn)|0,C=(C=C+Math.imul(It,on)|0)+Math.imul(Vt,Pn)|0,j=j+Math.imul(Vt,on)|0,A=A+Math.imul(Mt,Ht)|0,C=(C=C+Math.imul(Mt,re)|0)+Math.imul(qt,Ht)|0,j=j+Math.imul(qt,re)|0,A=A+Math.imul(wt,nn)|0,C=(C=C+Math.imul(wt,Ie)|0)+Math.imul(yt,nn)|0,j=j+Math.imul(yt,Ie)|0,A=A+Math.imul(dt,He)|0,C=(C=C+Math.imul(dt,Ge)|0)+Math.imul(ft,He)|0,j=j+Math.imul(ft,Ge)|0;var mn=(X+(A=A+Math.imul(rt,an)|0)|0)+((8191&(C=(C=C+Math.imul(rt,kn)|0)+Math.imul(ct,an)|0))<<13)|0;X=((j=j+Math.imul(ct,kn)|0)+(C>>>13)|0)+(mn>>>26)|0,mn&=67108863,A=Math.imul(le,Nn),C=(C=Math.imul(le,Te))+Math.imul(Jt,Nn)|0,j=Math.imul(Jt,Te),A=A+Math.imul(ne,Pn)|0,C=(C=C+Math.imul(ne,on)|0)+Math.imul(ae,Pn)|0,j=j+Math.imul(ae,on)|0,A=A+Math.imul(It,Ht)|0,C=(C=C+Math.imul(It,re)|0)+Math.imul(Vt,Ht)|0,j=j+Math.imul(Vt,re)|0,A=A+Math.imul(Mt,nn)|0,C=(C=C+Math.imul(Mt,Ie)|0)+Math.imul(qt,nn)|0,j=j+Math.imul(qt,Ie)|0,A=A+Math.imul(wt,He)|0,C=(C=C+Math.imul(wt,Ge)|0)+Math.imul(yt,He)|0,j=j+Math.imul(yt,Ge)|0;var $e=(X+(A=A+Math.imul(dt,an)|0)|0)+((8191&(C=(C=C+Math.imul(dt,kn)|0)+Math.imul(ft,an)|0))<<13)|0;X=((j=j+Math.imul(ft,kn)|0)+(C>>>13)|0)+($e>>>26)|0,$e&=67108863,A=Math.imul(le,Pn),C=(C=Math.imul(le,on))+Math.imul(Jt,Pn)|0,j=Math.imul(Jt,on),A=A+Math.imul(ne,Ht)|0,C=(C=C+Math.imul(ne,re)|0)+Math.imul(ae,Ht)|0,j=j+Math.imul(ae,re)|0,A=A+Math.imul(It,nn)|0,C=(C=C+Math.imul(It,Ie)|0)+Math.imul(Vt,nn)|0,j=j+Math.imul(Vt,Ie)|0,A=A+Math.imul(Mt,He)|0,C=(C=C+Math.imul(Mt,Ge)|0)+Math.imul(qt,He)|0,j=j+Math.imul(qt,Ge)|0;var vn=(X+(A=A+Math.imul(wt,an)|0)|0)+((8191&(C=(C=C+Math.imul(wt,kn)|0)+Math.imul(yt,an)|0))<<13)|0;X=((j=j+Math.imul(yt,kn)|0)+(C>>>13)|0)+(vn>>>26)|0,vn&=67108863,A=Math.imul(le,Ht),C=(C=Math.imul(le,re))+Math.imul(Jt,Ht)|0,j=Math.imul(Jt,re),A=A+Math.imul(ne,nn)|0,C=(C=C+Math.imul(ne,Ie)|0)+Math.imul(ae,nn)|0,j=j+Math.imul(ae,Ie)|0,A=A+Math.imul(It,He)|0,C=(C=C+Math.imul(It,Ge)|0)+Math.imul(Vt,He)|0,j=j+Math.imul(Vt,Ge)|0;var Ze=(X+(A=A+Math.imul(Mt,an)|0)|0)+((8191&(C=(C=C+Math.imul(Mt,kn)|0)+Math.imul(qt,an)|0))<<13)|0;X=((j=j+Math.imul(qt,kn)|0)+(C>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,A=Math.imul(le,nn),C=(C=Math.imul(le,Ie))+Math.imul(Jt,nn)|0,j=Math.imul(Jt,Ie),A=A+Math.imul(ne,He)|0,C=(C=C+Math.imul(ne,Ge)|0)+Math.imul(ae,He)|0,j=j+Math.imul(ae,Ge)|0;var Tn=(X+(A=A+Math.imul(It,an)|0)|0)+((8191&(C=(C=C+Math.imul(It,kn)|0)+Math.imul(Vt,an)|0))<<13)|0;X=((j=j+Math.imul(Vt,kn)|0)+(C>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,A=Math.imul(le,He),C=(C=Math.imul(le,Ge))+Math.imul(Jt,He)|0,j=Math.imul(Jt,Ge);var Bn=(X+(A=A+Math.imul(ne,an)|0)|0)+((8191&(C=(C=C+Math.imul(ne,kn)|0)+Math.imul(ae,an)|0))<<13)|0;X=((j=j+Math.imul(ae,kn)|0)+(C>>>13)|0)+(Bn>>>26)|0,Bn&=67108863;var In=(X+(A=Math.imul(le,an))|0)+((8191&(C=(C=Math.imul(le,kn))+Math.imul(Jt,an)|0))<<13)|0;return X=((j=Math.imul(Jt,kn))+(C>>>13)|0)+(In>>>26)|0,In&=67108863,H[0]=qn,H[1]=Qt,H[2]=de,H[3]=Ee,H[4]=Pe,H[5]=_t,H[6]=Bt,H[7]=Gt,H[8]=pe,H[9]=Ne,H[10]=ye,H[11]=xe,H[12]=mn,H[13]=$e,H[14]=vn,H[15]=Ze,H[16]=Tn,H[17]=Bn,H[18]=In,X!==0&&(H[19]=X,k.length++),k};function D(E,x,k){k.negative=x.negative^E.negative,k.length=E.length+x.length;for(var A=0,C=0,j=0;j<k.length-1;j++){var B=C;C=0;for(var O=67108863&A,H=Math.min(j,x.length-1),X=Math.max(0,j-E.length+1);X<=H;X++){var et=j-X,V=(0|E.words[et])*(0|x.words[X]),tt=67108863&V;O=67108863&(tt=tt+O|0),C+=(B=(B=B+(V/67108864|0)|0)+(tt>>>26)|0)>>>26,B&=67108863}k.words[j]=O,A=B,B=C}return A!==0?k.words[j]=A:k.length--,k._strip()}function F(E,x,k){return D(E,x,k)}Math.imul||(N=S),i.prototype.mulTo=function(E,x){var k=this.length+E.length;return this.length===10&&E.length===10?N(this,E,x):k<63?S(this,E,x):k<1024?D(this,E,x):F(this,E,x)},i.prototype.mul=function(E){var x=new i(null);return x.words=new Array(this.length+E.length),this.mulTo(E,x)},i.prototype.mulf=function(E){var x=new i(null);return x.words=new Array(this.length+E.length),F(this,E,x)},i.prototype.imul=function(E){return this.clone().mulTo(E,this)},i.prototype.imuln=function(E){var x=E<0;x&&(E=-E),u(typeof E=="number"),u(E<67108864);for(var k=0,A=0;A<this.length;A++){var C=(0|this.words[A])*E,j=(67108863&C)+(67108863&k);k>>=26,k+=C/67108864|0,k+=j>>>26,this.words[A]=67108863&j}return k!==0&&(this.words[A]=k,this.length++),x?this.ineg():this},i.prototype.muln=function(E){return this.clone().imuln(E)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(E){var x=(function(j){for(var B=new Array(j.bitLength()),O=0;O<B.length;O++){var H=O/26|0,X=O%26;B[O]=j.words[H]>>>X&1}return B})(E);if(x.length===0)return new i(1);for(var k=this,A=0;A<x.length&&x[A]===0;A++,k=k.sqr());if(++A<x.length)for(var C=k.sqr();A<x.length;A++,C=C.sqr())x[A]!==0&&(k=k.mul(C));return k},i.prototype.iushln=function(E){u(typeof E=="number"&&E>=0);var x,k=E%26,A=(E-k)/26,C=67108863>>>26-k<<26-k;if(k!==0){var j=0;for(x=0;x<this.length;x++){var B=this.words[x]&C,O=(0|this.words[x])-B<<k;this.words[x]=O|j,j=B>>>26-k}j&&(this.words[x]=j,this.length++)}if(A!==0){for(x=this.length-1;x>=0;x--)this.words[x+A]=this.words[x];for(x=0;x<A;x++)this.words[x]=0;this.length+=A}return this._strip()},i.prototype.ishln=function(E){return u(this.negative===0),this.iushln(E)},i.prototype.iushrn=function(E,x,k){var A;u(typeof E=="number"&&E>=0),A=x?(x-x%26)/26:0;var C=E%26,j=Math.min((E-C)/26,this.length),B=67108863^67108863>>>C<<C,O=k;if(A-=j,A=Math.max(0,A),O){for(var H=0;H<j;H++)O.words[H]=this.words[H];O.length=j}if(j!==0)if(this.length>j)for(this.length-=j,H=0;H<this.length;H++)this.words[H]=this.words[H+j];else this.words[0]=0,this.length=1;var X=0;for(H=this.length-1;H>=0&&(X!==0||H>=A);H--){var et=0|this.words[H];this.words[H]=X<<26-C|et>>>C,X=et&B}return O&&X!==0&&(O.words[O.length++]=X),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(E,x,k){return u(this.negative===0),this.iushrn(E,x,k)},i.prototype.shln=function(E){return this.clone().ishln(E)},i.prototype.ushln=function(E){return this.clone().iushln(E)},i.prototype.shrn=function(E){return this.clone().ishrn(E)},i.prototype.ushrn=function(E){return this.clone().iushrn(E)},i.prototype.testn=function(E){u(typeof E=="number"&&E>=0);var x=E%26,k=(E-x)/26,A=1<<x;return!(this.length<=k)&&!!(this.words[k]&A)},i.prototype.imaskn=function(E){u(typeof E=="number"&&E>=0);var x=E%26,k=(E-x)/26;if(u(this.negative===0,"imaskn works only with positive numbers"),this.length<=k)return this;if(x!==0&&k++,this.length=Math.min(k,this.length),x!==0){var A=67108863^67108863>>>x<<x;this.words[this.length-1]&=A}return this._strip()},i.prototype.maskn=function(E){return this.clone().imaskn(E)},i.prototype.iaddn=function(E){return u(typeof E=="number"),u(E<67108864),E<0?this.isubn(-E):this.negative!==0?this.length===1&&(0|this.words[0])<=E?(this.words[0]=E-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(E),this.negative=1,this):this._iaddn(E)},i.prototype._iaddn=function(E){this.words[0]+=E;for(var x=0;x<this.length&&this.words[x]>=67108864;x++)this.words[x]-=67108864,x===this.length-1?this.words[x+1]=1:this.words[x+1]++;return this.length=Math.max(this.length,x+1),this},i.prototype.isubn=function(E){if(u(typeof E=="number"),u(E<67108864),E<0)return this.iaddn(-E);if(this.negative!==0)return this.negative=0,this.iaddn(E),this.negative=1,this;if(this.words[0]-=E,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var x=0;x<this.length&&this.words[x]<0;x++)this.words[x]+=67108864,this.words[x+1]-=1;return this._strip()},i.prototype.addn=function(E){return this.clone().iaddn(E)},i.prototype.subn=function(E){return this.clone().isubn(E)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(E,x,k){var A,C,j=E.length+k;this._expand(j);var B=0;for(A=0;A<E.length;A++){C=(0|this.words[A+k])+B;var O=(0|E.words[A])*x;B=((C-=67108863&O)>>26)-(O/67108864|0),this.words[A+k]=67108863&C}for(;A<this.length-k;A++)B=(C=(0|this.words[A+k])+B)>>26,this.words[A+k]=67108863&C;if(B===0)return this._strip();for(u(B===-1),B=0,A=0;A<this.length;A++)B=(C=-(0|this.words[A])+B)>>26,this.words[A]=67108863&C;return this.negative=1,this._strip()},i.prototype._wordDiv=function(E,x){var k=(this.length,E.length),A=this.clone(),C=E,j=0|C.words[C.length-1];(k=26-this._countBits(j))!==0&&(C=C.ushln(k),A.iushln(k),j=0|C.words[C.length-1]);var B,O=A.length-C.length;if(x!=="mod"){(B=new i(null)).length=O+1,B.words=new Array(B.length);for(var H=0;H<B.length;H++)B.words[H]=0}var X=A.clone()._ishlnsubmul(C,1,O);X.negative===0&&(A=X,B&&(B.words[O]=1));for(var et=O-1;et>=0;et--){var V=67108864*(0|A.words[C.length+et])+(0|A.words[C.length+et-1]);for(V=Math.min(V/j|0,67108863),A._ishlnsubmul(C,V,et);A.negative!==0;)V--,A.negative=0,A._ishlnsubmul(C,1,et),A.isZero()||(A.negative^=1);B&&(B.words[et]=V)}return B&&B._strip(),A._strip(),x!=="div"&&k!==0&&A.iushrn(k),{div:B||null,mod:A}},i.prototype.divmod=function(E,x,k){return u(!E.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:this.negative!==0&&E.negative===0?(j=this.neg().divmod(E,x),x!=="mod"&&(A=j.div.neg()),x!=="div"&&(C=j.mod.neg(),k&&C.negative!==0&&C.iadd(E)),{div:A,mod:C}):this.negative===0&&E.negative!==0?(j=this.divmod(E.neg(),x),x!=="mod"&&(A=j.div.neg()),{div:A,mod:j.mod}):(this.negative&E.negative)!=0?(j=this.neg().divmod(E.neg(),x),x!=="div"&&(C=j.mod.neg(),k&&C.negative!==0&&C.isub(E)),{div:j.div,mod:C}):E.length>this.length||this.cmp(E)<0?{div:new i(0),mod:this}:E.length===1?x==="div"?{div:this.divn(E.words[0]),mod:null}:x==="mod"?{div:null,mod:new i(this.modrn(E.words[0]))}:{div:this.divn(E.words[0]),mod:new i(this.modrn(E.words[0]))}:this._wordDiv(E,x);var A,C,j},i.prototype.div=function(E){return this.divmod(E,"div",!1).div},i.prototype.mod=function(E){return this.divmod(E,"mod",!1).mod},i.prototype.umod=function(E){return this.divmod(E,"mod",!0).mod},i.prototype.divRound=function(E){var x=this.divmod(E);if(x.mod.isZero())return x.div;var k=x.div.negative!==0?x.mod.isub(E):x.mod,A=E.ushrn(1),C=E.andln(1),j=k.cmp(A);return j<0||C===1&&j===0?x.div:x.div.negative!==0?x.div.isubn(1):x.div.iaddn(1)},i.prototype.modrn=function(E){var x=E<0;x&&(E=-E),u(E<=67108863);for(var k=(1<<26)%E,A=0,C=this.length-1;C>=0;C--)A=(k*A+(0|this.words[C]))%E;return x?-A:A},i.prototype.modn=function(E){return this.modrn(E)},i.prototype.idivn=function(E){var x=E<0;x&&(E=-E),u(E<=67108863);for(var k=0,A=this.length-1;A>=0;A--){var C=(0|this.words[A])+67108864*k;this.words[A]=C/E|0,k=C%E}return this._strip(),x?this.ineg():this},i.prototype.divn=function(E){return this.clone().idivn(E)},i.prototype.egcd=function(E){u(E.negative===0),u(!E.isZero());var x=this,k=E.clone();x=x.negative!==0?x.umod(E):x.clone();for(var A=new i(1),C=new i(0),j=new i(0),B=new i(1),O=0;x.isEven()&&k.isEven();)x.iushrn(1),k.iushrn(1),++O;for(var H=k.clone(),X=x.clone();!x.isZero();){for(var et=0,V=1;(x.words[0]&V)==0&&et<26;++et,V<<=1);if(et>0)for(x.iushrn(et);et-- >0;)(A.isOdd()||C.isOdd())&&(A.iadd(H),C.isub(X)),A.iushrn(1),C.iushrn(1);for(var tt=0,$=1;(k.words[0]&$)==0&&tt<26;++tt,$<<=1);if(tt>0)for(k.iushrn(tt);tt-- >0;)(j.isOdd()||B.isOdd())&&(j.iadd(H),B.isub(X)),j.iushrn(1),B.iushrn(1);x.cmp(k)>=0?(x.isub(k),A.isub(j),C.isub(B)):(k.isub(x),j.isub(A),B.isub(C))}return{a:j,b:B,gcd:k.iushln(O)}},i.prototype._invmp=function(E){u(E.negative===0),u(!E.isZero());var x=this,k=E.clone();x=x.negative!==0?x.umod(E):x.clone();for(var A,C=new i(1),j=new i(0),B=k.clone();x.cmpn(1)>0&&k.cmpn(1)>0;){for(var O=0,H=1;(x.words[0]&H)==0&&O<26;++O,H<<=1);if(O>0)for(x.iushrn(O);O-- >0;)C.isOdd()&&C.iadd(B),C.iushrn(1);for(var X=0,et=1;(k.words[0]&et)==0&&X<26;++X,et<<=1);if(X>0)for(k.iushrn(X);X-- >0;)j.isOdd()&&j.iadd(B),j.iushrn(1);x.cmp(k)>=0?(x.isub(k),C.isub(j)):(k.isub(x),j.isub(C))}return(A=x.cmpn(1)===0?C:j).cmpn(0)<0&&A.iadd(E),A},i.prototype.gcd=function(E){if(this.isZero())return E.abs();if(E.isZero())return this.abs();var x=this.clone(),k=E.clone();x.negative=0,k.negative=0;for(var A=0;x.isEven()&&k.isEven();A++)x.iushrn(1),k.iushrn(1);for(;;){for(;x.isEven();)x.iushrn(1);for(;k.isEven();)k.iushrn(1);var C=x.cmp(k);if(C<0){var j=x;x=k,k=j}else if(C===0||k.cmpn(1)===0)break;x.isub(k)}return k.iushln(A)},i.prototype.invm=function(E){return this.egcd(E).a.umod(E)},i.prototype.isEven=function(){return(1&this.words[0])==0},i.prototype.isOdd=function(){return(1&this.words[0])==1},i.prototype.andln=function(E){return this.words[0]&E},i.prototype.bincn=function(E){u(typeof E=="number");var x=E%26,k=(E-x)/26,A=1<<x;if(this.length<=k)return this._expand(k+1),this.words[k]|=A,this;for(var C=A,j=k;C!==0&&j<this.length;j++){var B=0|this.words[j];C=(B+=C)>>>26,B&=67108863,this.words[j]=B}return C!==0&&(this.words[j]=C,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(E){var x,k=E<0;if(this.negative!==0&&!k)return-1;if(this.negative===0&&k)return 1;if(this._strip(),this.length>1)x=1;else{k&&(E=-E),u(E<=67108863,"Number is too big");var A=0|this.words[0];x=A===E?0:A<E?-1:1}return this.negative!==0?0|-x:x},i.prototype.cmp=function(E){if(this.negative!==0&&E.negative===0)return-1;if(this.negative===0&&E.negative!==0)return 1;var x=this.ucmp(E);return this.negative!==0?0|-x:x},i.prototype.ucmp=function(E){if(this.length>E.length)return 1;if(this.length<E.length)return-1;for(var x=0,k=this.length-1;k>=0;k--){var A=0|this.words[k],C=0|E.words[k];if(A!==C){A<C?x=-1:A>C&&(x=1);break}}return x},i.prototype.gtn=function(E){return this.cmpn(E)===1},i.prototype.gt=function(E){return this.cmp(E)===1},i.prototype.gten=function(E){return this.cmpn(E)>=0},i.prototype.gte=function(E){return this.cmp(E)>=0},i.prototype.ltn=function(E){return this.cmpn(E)===-1},i.prototype.lt=function(E){return this.cmp(E)===-1},i.prototype.lten=function(E){return this.cmpn(E)<=0},i.prototype.lte=function(E){return this.cmp(E)<=0},i.prototype.eqn=function(E){return this.cmpn(E)===0},i.prototype.eq=function(E){return this.cmp(E)===0},i.red=function(E){return new T(E)},i.prototype.toRed=function(E){return u(!this.red,"Already a number in reduction context"),u(this.negative===0,"red works only with positives"),E.convertTo(this)._forceRed(E)},i.prototype.fromRed=function(){return u(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(E){return this.red=E,this},i.prototype.forceRed=function(E){return u(!this.red,"Already a number in reduction context"),this._forceRed(E)},i.prototype.redAdd=function(E){return u(this.red,"redAdd works only with red numbers"),this.red.add(this,E)},i.prototype.redIAdd=function(E){return u(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,E)},i.prototype.redSub=function(E){return u(this.red,"redSub works only with red numbers"),this.red.sub(this,E)},i.prototype.redISub=function(E){return u(this.red,"redISub works only with red numbers"),this.red.isub(this,E)},i.prototype.redShl=function(E){return u(this.red,"redShl works only with red numbers"),this.red.shl(this,E)},i.prototype.redMul=function(E){return u(this.red,"redMul works only with red numbers"),this.red._verify2(this,E),this.red.mul(this,E)},i.prototype.redIMul=function(E){return u(this.red,"redMul works only with red numbers"),this.red._verify2(this,E),this.red.imul(this,E)},i.prototype.redSqr=function(){return u(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return u(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return u(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return u(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return u(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(E){return u(this.red&&!E.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,E)};var G={k256:null,p224:null,p192:null,p25519:null};function P(E,x){this.name=E,this.p=new i(x,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function U(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function q(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function R(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function I(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(E){if(typeof E=="string"){var x=i._prime(E);this.m=x.p,this.prime=x}else u(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}function L(E){T.call(this,E),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}P.prototype._tmp=function(){var E=new i(null);return E.words=new Array(Math.ceil(this.n/13)),E},P.prototype.ireduce=function(E){var x,k=E;do this.split(k,this.tmp),x=(k=(k=this.imulK(k)).iadd(this.tmp)).bitLength();while(x>this.n);var A=x<this.n?-1:k.ucmp(this.p);return A===0?(k.words[0]=0,k.length=1):A>0?k.isub(this.p):k.strip!==void 0?k.strip():k._strip(),k},P.prototype.split=function(E,x){E.iushrn(this.n,0,x)},P.prototype.imulK=function(E){return E.imul(this.k)},l(U,P),U.prototype.split=function(E,x){for(var k=Math.min(E.length,9),A=0;A<k;A++)x.words[A]=E.words[A];if(x.length=k,E.length<=9)return E.words[0]=0,void(E.length=1);var C=E.words[9];for(x.words[x.length++]=4194303&C,A=10;A<E.length;A++){var j=0|E.words[A];E.words[A-10]=(4194303&j)<<4|C>>>22,C=j}C>>>=22,E.words[A-10]=C,C===0&&E.length>10?E.length-=10:E.length-=9},U.prototype.imulK=function(E){E.words[E.length]=0,E.words[E.length+1]=0,E.length+=2;for(var x=0,k=0;k<E.length;k++){var A=0|E.words[k];x+=977*A,E.words[k]=67108863&x,x=64*A+(x/67108864|0)}return E.words[E.length-1]===0&&(E.length--,E.words[E.length-1]===0&&E.length--),E},l(q,P),l(R,P),l(I,P),I.prototype.imulK=function(E){for(var x=0,k=0;k<E.length;k++){var A=19*(0|E.words[k])+x,C=67108863&A;A>>>=26,E.words[k]=C,x=A}return x!==0&&(E.words[E.length++]=x),E},i._prime=function(E){if(G[E])return G[E];var x;if(E==="k256")x=new U;else if(E==="p224")x=new q;else if(E==="p192")x=new R;else{if(E!=="p25519")throw new Error("Unknown prime "+E);x=new I}return G[E]=x,x},T.prototype._verify1=function(E){u(E.negative===0,"red works only with positives"),u(E.red,"red works only with red numbers")},T.prototype._verify2=function(E,x){u((E.negative|x.negative)==0,"red works only with positives"),u(E.red&&E.red===x.red,"red works only with red numbers")},T.prototype.imod=function(E){return this.prime?this.prime.ireduce(E)._forceRed(this):(g(E,E.umod(this.m)._forceRed(this)),E)},T.prototype.neg=function(E){return E.isZero()?E.clone():this.m.sub(E)._forceRed(this)},T.prototype.add=function(E,x){this._verify2(E,x);var k=E.add(x);return k.cmp(this.m)>=0&&k.isub(this.m),k._forceRed(this)},T.prototype.iadd=function(E,x){this._verify2(E,x);var k=E.iadd(x);return k.cmp(this.m)>=0&&k.isub(this.m),k},T.prototype.sub=function(E,x){this._verify2(E,x);var k=E.sub(x);return k.cmpn(0)<0&&k.iadd(this.m),k._forceRed(this)},T.prototype.isub=function(E,x){this._verify2(E,x);var k=E.isub(x);return k.cmpn(0)<0&&k.iadd(this.m),k},T.prototype.shl=function(E,x){return this._verify1(E),this.imod(E.ushln(x))},T.prototype.imul=function(E,x){return this._verify2(E,x),this.imod(E.imul(x))},T.prototype.mul=function(E,x){return this._verify2(E,x),this.imod(E.mul(x))},T.prototype.isqr=function(E){return this.imul(E,E.clone())},T.prototype.sqr=function(E){return this.mul(E,E)},T.prototype.sqrt=function(E){if(E.isZero())return E.clone();var x=this.m.andln(3);if(u(x%2==1),x===3){var k=this.m.add(new i(1)).iushrn(2);return this.pow(E,k)}for(var A=this.m.subn(1),C=0;!A.isZero()&&A.andln(1)===0;)C++,A.iushrn(1);u(!A.isZero());var j=new i(1).toRed(this),B=j.redNeg(),O=this.m.subn(1).iushrn(1),H=this.m.bitLength();for(H=new i(2*H*H).toRed(this);this.pow(H,O).cmp(B)!==0;)H.redIAdd(B);for(var X=this.pow(H,A),et=this.pow(E,A.addn(1).iushrn(1)),V=this.pow(E,A),tt=C;V.cmp(j)!==0;){for(var $=V,z=0;$.cmp(j)!==0;z++)$=$.redSqr();u(z<tt);var Z=this.pow(X,new i(1).iushln(tt-z-1));et=et.redMul(Z),X=Z.redSqr(),V=V.redMul(X),tt=z}return et},T.prototype.invm=function(E){var x=E._invmp(this.m);return x.negative!==0?(x.negative=0,this.imod(x).redNeg()):this.imod(x)},T.prototype.pow=function(E,x){if(x.isZero())return new i(1).toRed(this);if(x.cmpn(1)===0)return E.clone();var k=new Array(16);k[0]=new i(1).toRed(this),k[1]=E;for(var A=2;A<k.length;A++)k[A]=this.mul(k[A-1],E);var C=k[0],j=0,B=0,O=x.bitLength()%26;for(O===0&&(O=26),A=x.length-1;A>=0;A--){for(var H=x.words[A],X=O-1;X>=0;X--){var et=H>>X&1;C!==k[0]&&(C=this.sqr(C)),et!==0||j!==0?(j<<=1,j|=et,(++B===4||A===0&&X===0)&&(C=this.mul(C,k[j]),B=0,j=0)):B=0}O=26}return C},T.prototype.convertTo=function(E){var x=E.umod(this.m);return x===E?x.clone():x},T.prototype.convertFrom=function(E){var x=E.clone();return x.red=null,x},i.mont=function(E){return new L(E)},l(L,T),L.prototype.convertTo=function(E){return this.imod(E.ushln(this.shift))},L.prototype.convertFrom=function(E){var x=this.imod(E.mul(this.rinv));return x.red=null,x},L.prototype.imul=function(E,x){if(E.isZero()||x.isZero())return E.words[0]=0,E.length=1,E;var k=E.imul(x),A=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),C=k.isub(A).iushrn(this.shift),j=C;return C.cmp(this.m)>=0?j=C.isub(this.m):C.cmpn(0)<0&&(j=C.iadd(this.m)),j._forceRed(this)},L.prototype.mul=function(E,x){if(E.isZero()||x.isZero())return new i(0)._forceRed(this);var k=E.mul(x),A=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),C=k.isub(A).iushrn(this.shift),j=C;return C.cmp(this.m)>=0?j=C.isub(this.m):C.cmpn(0)<0&&(j=C.iadd(this.m)),j._forceRed(this)},L.prototype.invm=function(E){return this.imod(E._invmp(this.m).mul(this.r2))._forceRed(this)}})(r===void 0||r)},{buffer:188}],187:[function(t,r,o){var s;function a(l){this.rand=l}if(r.exports=function(l){return s||(s=new a(null)),s.generate(l)},r.exports.Rand=a,a.prototype.generate=function(l){return this._rand(l)},a.prototype._rand=function(l){if(this.rand.getBytes)return this.rand.getBytes(l);for(var i=new Uint8Array(l),c=0;c<i.length;c++)i[c]=this.rand.getByte();return i},typeof self=="object")self.crypto&&self.crypto.getRandomValues?a.prototype._rand=function(l){var i=new Uint8Array(l);return self.crypto.getRandomValues(i),i}:self.msCrypto&&self.msCrypto.getRandomValues?a.prototype._rand=function(l){var i=new Uint8Array(l);return self.msCrypto.getRandomValues(i),i}:typeof window=="object"&&(a.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var u=t("crypto");if(typeof u.randomBytes!="function")throw new Error("Not supported");a.prototype._rand=function(l){return u.randomBytes(l)}}catch{}},{crypto:188}],188:[function(t,r,o){},{}],189:[function(t,r,o){var s=t("safe-buffer").Buffer;function a(h){s.isBuffer(h)||(h=s.from(h));for(var f=h.length/4|0,g=new Array(f),y=0;y<f;y++)g[y]=h.readUInt32BE(4*y);return g}function u(h){for(;0<h.length;h++)h[0]=0}function l(h,f,g,y,b){for(var v,w,S,N,D=g[0],F=g[1],G=g[2],P=g[3],U=h[0]^f[0],q=h[1]^f[1],R=h[2]^f[2],I=h[3]^f[3],T=4,L=1;L<b;L++)v=D[U>>>24]^F[q>>>16&255]^G[R>>>8&255]^P[255&I]^f[T++],w=D[q>>>24]^F[R>>>16&255]^G[I>>>8&255]^P[255&U]^f[T++],S=D[R>>>24]^F[I>>>16&255]^G[U>>>8&255]^P[255&q]^f[T++],N=D[I>>>24]^F[U>>>16&255]^G[q>>>8&255]^P[255&R]^f[T++],U=v,q=w,R=S,I=N;return v=(y[U>>>24]<<24|y[q>>>16&255]<<16|y[R>>>8&255]<<8|y[255&I])^f[T++],w=(y[q>>>24]<<24|y[R>>>16&255]<<16|y[I>>>8&255]<<8|y[255&U])^f[T++],S=(y[R>>>24]<<24|y[I>>>16&255]<<16|y[U>>>8&255]<<8|y[255&q])^f[T++],N=(y[I>>>24]<<24|y[U>>>16&255]<<16|y[q>>>8&255]<<8|y[255&R])^f[T++],[v>>>=0,w>>>=0,S>>>=0,N>>>=0]}var i=[0,1,2,4,8,16,32,64,128,27,54],c=(function(){for(var h=new Array(256),f=0;f<256;f++)h[f]=f<128?f<<1:f<<1^283;for(var g=[],y=[],b=[[],[],[],[]],v=[[],[],[],[]],w=0,S=0,N=0;N<256;++N){var D=S^S<<1^S<<2^S<<3^S<<4;D=D>>>8^255&D^99,g[w]=D,y[D]=w;var F=h[w],G=h[F],P=h[G],U=257*h[D]^16843008*D;b[0][w]=U<<24|U>>>8,b[1][w]=U<<16|U>>>16,b[2][w]=U<<8|U>>>24,b[3][w]=U,U=16843009*P^65537*G^257*F^16843008*w,v[0][D]=U<<24|U>>>8,v[1][D]=U<<16|U>>>16,v[2][D]=U<<8|U>>>24,v[3][D]=U,w===0?w=S=1:(w=F^h[h[h[P^F]]],S^=h[h[S]])}return{SBOX:g,INV_SBOX:y,SUB_MIX:b,INV_SUB_MIX:v}})();function p(h){this._key=a(h),this._reset()}p.blockSize=16,p.keySize=32,p.prototype.blockSize=p.blockSize,p.prototype.keySize=p.keySize,p.prototype._reset=function(){for(var h=this._key,f=h.length,g=f+6,y=4*(g+1),b=[],v=0;v<f;v++)b[v]=h[v];for(v=f;v<y;v++){var w=b[v-1];v%f==0?(w=w<<8|w>>>24,w=c.SBOX[w>>>24]<<24|c.SBOX[w>>>16&255]<<16|c.SBOX[w>>>8&255]<<8|c.SBOX[255&w],w^=i[v/f|0]<<24):f>6&&v%f==4&&(w=c.SBOX[w>>>24]<<24|c.SBOX[w>>>16&255]<<16|c.SBOX[w>>>8&255]<<8|c.SBOX[255&w]),b[v]=b[v-f]^w}for(var S=[],N=0;N<y;N++){var D=y-N,F=b[D-(N%4?0:4)];S[N]=N<4||D<=4?F:c.INV_SUB_MIX[0][c.SBOX[F>>>24]]^c.INV_SUB_MIX[1][c.SBOX[F>>>16&255]]^c.INV_SUB_MIX[2][c.SBOX[F>>>8&255]]^c.INV_SUB_MIX[3][c.SBOX[255&F]]}this._nRounds=g,this._keySchedule=b,this._invKeySchedule=S},p.prototype.encryptBlockRaw=function(h){return l(h=a(h),this._keySchedule,c.SUB_MIX,c.SBOX,this._nRounds)},p.prototype.encryptBlock=function(h){var f=this.encryptBlockRaw(h),g=s.allocUnsafe(16);return g.writeUInt32BE(f[0],0),g.writeUInt32BE(f[1],4),g.writeUInt32BE(f[2],8),g.writeUInt32BE(f[3],12),g},p.prototype.decryptBlock=function(h){var f=(h=a(h))[1];h[1]=h[3],h[3]=f;var g=l(h,this._invKeySchedule,c.INV_SUB_MIX,c.INV_SBOX,this._nRounds),y=s.allocUnsafe(16);return y.writeUInt32BE(g[0],0),y.writeUInt32BE(g[3],4),y.writeUInt32BE(g[2],8),y.writeUInt32BE(g[1],12),y},p.prototype.scrub=function(){u(this._keySchedule),u(this._invKeySchedule),u(this._key)},r.exports.AES=p},{"safe-buffer":494}],190:[function(t,r,o){var s=t("./aes"),a=t("safe-buffer").Buffer,u=t("cipher-base"),l=t("inherits"),i=t("./ghash"),c=t("buffer-xor"),p=t("./incr32");function h(f,g,y,b){u.call(this);var v=a.alloc(4,0);this._cipher=new s.AES(g);var w=this._cipher.encryptBlock(v);this._ghash=new i(w),y=(function(S,N,D){if(N.length===12)return S._finID=a.concat([N,a.from([0,0,0,1])]),a.concat([N,a.from([0,0,0,2])]);var F=new i(D),G=N.length,P=G%16;F.update(N),P&&(P=16-P,F.update(a.alloc(P,0))),F.update(a.alloc(8,0));var U=8*G,q=a.alloc(8);q.writeUIntBE(U,0,8),F.update(q),S._finID=F.state;var R=a.from(S._finID);return p(R),R})(this,y,w),this._prev=a.from(y),this._cache=a.allocUnsafe(0),this._secCache=a.allocUnsafe(0),this._decrypt=b,this._alen=0,this._len=0,this._mode=f,this._authTag=null,this._called=!1}l(h,u),h.prototype._update=function(f){if(!this._called&&this._alen){var g=16-this._alen%16;g<16&&(g=a.alloc(g,0),this._ghash.update(g))}this._called=!0;var y=this._mode.encrypt(this,f);return this._decrypt?this._ghash.update(f):this._ghash.update(y),this._len+=f.length,y},h.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var f=c(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&(function(g,y){var b=0;g.length!==y.length&&b++;for(var v=Math.min(g.length,y.length),w=0;w<v;++w)b+=g[w]^y[w];return b})(f,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=f,this._cipher.scrub()},h.prototype.getAuthTag=function(){if(this._decrypt||!a.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},h.prototype.setAuthTag=function(f){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=f},h.prototype.setAAD=function(f){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(f),this._alen+=f.length},r.exports=h},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(t,r,o){var s=t("./encrypter"),a=t("./decrypter"),u=t("./modes/list.json");o.createCipher=o.Cipher=s.createCipher,o.createCipheriv=o.Cipheriv=s.createCipheriv,o.createDecipher=o.Decipher=a.createDecipher,o.createDecipheriv=o.Decipheriv=a.createDecipheriv,o.listCiphers=o.getCiphers=function(){return Object.keys(u)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(t,r,o){var s=t("./authCipher"),a=t("safe-buffer").Buffer,u=t("./modes"),l=t("./streamCipher"),i=t("cipher-base"),c=t("./aes"),p=t("evp_bytestokey");function h(y,b,v){i.call(this),this._cache=new f,this._last=void 0,this._cipher=new c.AES(b),this._prev=a.from(v),this._mode=y,this._autopadding=!0}function f(){this.cache=a.allocUnsafe(0)}function g(y,b,v){var w=u[y.toLowerCase()];if(!w)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=a.from(v)),w.mode!=="GCM"&&v.length!==w.iv)throw new TypeError("invalid iv length "+v.length);if(typeof b=="string"&&(b=a.from(b)),b.length!==w.key/8)throw new TypeError("invalid key length "+b.length);return w.type==="stream"?new l(w.module,b,v,!0):w.type==="auth"?new s(w.module,b,v,!0):new h(w.module,b,v)}t("inherits")(h,i),h.prototype._update=function(y){var b,v;this._cache.add(y);for(var w=[];b=this._cache.get(this._autopadding);)v=this._mode.decrypt(this,b),w.push(v);return a.concat(w)},h.prototype._final=function(){var y=this._cache.flush();if(this._autopadding)return(function(b){var v=b[15];if(v<1||v>16)throw new Error("unable to decrypt data");for(var w=-1;++w<v;)if(b[w+(16-v)]!==v)throw new Error("unable to decrypt data");if(v!==16)return b.slice(0,16-v)})(this._mode.decrypt(this,y));if(y)throw new Error("data not multiple of block length")},h.prototype.setAutoPadding=function(y){return this._autopadding=!!y,this},f.prototype.add=function(y){this.cache=a.concat([this.cache,y])},f.prototype.get=function(y){var b;if(y){if(this.cache.length>16)return b=this.cache.slice(0,16),this.cache=this.cache.slice(16),b}else if(this.cache.length>=16)return b=this.cache.slice(0,16),this.cache=this.cache.slice(16),b;return null},f.prototype.flush=function(){if(this.cache.length)return this.cache},o.createDecipher=function(y,b){var v=u[y.toLowerCase()];if(!v)throw new TypeError("invalid suite type");var w=p(b,!1,v.key,v.iv);return g(y,w.key,w.iv)},o.createDecipheriv=g},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(t,r,o){var s=t("./modes"),a=t("./authCipher"),u=t("safe-buffer").Buffer,l=t("./streamCipher"),i=t("cipher-base"),c=t("./aes"),p=t("evp_bytestokey");function h(b,v,w){i.call(this),this._cache=new g,this._cipher=new c.AES(v),this._prev=u.from(w),this._mode=b,this._autopadding=!0}t("inherits")(h,i),h.prototype._update=function(b){var v,w;this._cache.add(b);for(var S=[];v=this._cache.get();)w=this._mode.encrypt(this,v),S.push(w);return u.concat(S)};var f=u.alloc(16,16);function g(){this.cache=u.allocUnsafe(0)}function y(b,v,w){var S=s[b.toLowerCase()];if(!S)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=u.from(v)),v.length!==S.key/8)throw new TypeError("invalid key length "+v.length);if(typeof w=="string"&&(w=u.from(w)),S.mode!=="GCM"&&w.length!==S.iv)throw new TypeError("invalid iv length "+w.length);return S.type==="stream"?new l(S.module,v,w):S.type==="auth"?new a(S.module,v,w):new h(S.module,v,w)}h.prototype._final=function(){var b=this._cache.flush();if(this._autopadding)return b=this._mode.encrypt(this,b),this._cipher.scrub(),b;if(!b.equals(f))throw this._cipher.scrub(),new Error("data not multiple of block length")},h.prototype.setAutoPadding=function(b){return this._autopadding=!!b,this},g.prototype.add=function(b){this.cache=u.concat([this.cache,b])},g.prototype.get=function(){if(this.cache.length>15){var b=this.cache.slice(0,16);return this.cache=this.cache.slice(16),b}return null},g.prototype.flush=function(){for(var b=16-this.cache.length,v=u.allocUnsafe(b),w=-1;++w<b;)v.writeUInt8(b,w);return u.concat([this.cache,v])},o.createCipheriv=y,o.createCipher=function(b,v){var w=s[b.toLowerCase()];if(!w)throw new TypeError("invalid suite type");var S=p(v,!1,w.key,w.iv);return y(b,S.key,S.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(t,r,o){var s=t("safe-buffer").Buffer,a=s.alloc(16,0);function u(i){var c=s.allocUnsafe(16);return c.writeUInt32BE(i[0]>>>0,0),c.writeUInt32BE(i[1]>>>0,4),c.writeUInt32BE(i[2]>>>0,8),c.writeUInt32BE(i[3]>>>0,12),c}function l(i){this.h=i,this.state=s.alloc(16,0),this.cache=s.allocUnsafe(0)}l.prototype.ghash=function(i){for(var c=-1;++c<i.length;)this.state[c]^=i[c];this._multiply()},l.prototype._multiply=function(){for(var i,c,p,h=[(i=this.h).readUInt32BE(0),i.readUInt32BE(4),i.readUInt32BE(8),i.readUInt32BE(12)],f=[0,0,0,0],g=-1;++g<128;){for((this.state[~~(g/8)]&1<<7-g%8)!=0&&(f[0]^=h[0],f[1]^=h[1],f[2]^=h[2],f[3]^=h[3]),p=(1&h[3])!=0,c=3;c>0;c--)h[c]=h[c]>>>1|(1&h[c-1])<<31;h[0]=h[0]>>>1,p&&(h[0]=h[0]^225<<24)}this.state=u(f)},l.prototype.update=function(i){var c;for(this.cache=s.concat([this.cache,i]);this.cache.length>=16;)c=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(c)},l.prototype.final=function(i,c){return this.cache.length&&this.ghash(s.concat([this.cache,a],16)),this.ghash(u([0,i,0,c])),this.state},r.exports=l},{"safe-buffer":494}],195:[function(t,r,o){r.exports=function(s){for(var a,u=s.length;u--;){if((a=s.readUInt8(u))!==255){a++,s.writeUInt8(a,u);break}s.writeUInt8(0,u)}}},{}],196:[function(t,r,o){var s=t("buffer-xor");o.encrypt=function(a,u){var l=s(u,a._prev);return a._prev=a._cipher.encryptBlock(l),a._prev},o.decrypt=function(a,u){var l=a._prev;a._prev=u;var i=a._cipher.decryptBlock(u);return s(i,l)}},{"buffer-xor":219}],197:[function(t,r,o){var s=t("safe-buffer").Buffer,a=t("buffer-xor");function u(l,i,c){var p=i.length,h=a(i,l._cache);return l._cache=l._cache.slice(p),l._prev=s.concat([l._prev,c?i:h]),h}o.encrypt=function(l,i,c){for(var p,h=s.allocUnsafe(0);i.length;){if(l._cache.length===0&&(l._cache=l._cipher.encryptBlock(l._prev),l._prev=s.allocUnsafe(0)),!(l._cache.length<=i.length)){h=s.concat([h,u(l,i,c)]);break}p=l._cache.length,h=s.concat([h,u(l,i.slice(0,p),c)]),i=i.slice(p)}return h}},{"buffer-xor":219,"safe-buffer":494}],198:[function(t,r,o){var s=t("safe-buffer").Buffer;function a(l,i,c){for(var p,h,f=-1,g=0;++f<8;)p=i&1<<7-f?128:0,g+=(128&(h=l._cipher.encryptBlock(l._prev)[0]^p))>>f%8,l._prev=u(l._prev,c?p:h);return g}function u(l,i){var c=l.length,p=-1,h=s.allocUnsafe(l.length);for(l=s.concat([l,s.from([i])]);++p<c;)h[p]=l[p]<<1|l[p+1]>>7;return h}o.encrypt=function(l,i,c){for(var p=i.length,h=s.allocUnsafe(p),f=-1;++f<p;)h[f]=a(l,i[f],c);return h}},{"safe-buffer":494}],199:[function(t,r,o){var s=t("safe-buffer").Buffer;function a(u,l,i){var c=u._cipher.encryptBlock(u._prev)[0]^l;return u._prev=s.concat([u._prev.slice(1),s.from([i?l:c])]),c}o.encrypt=function(u,l,i){for(var c=l.length,p=s.allocUnsafe(c),h=-1;++h<c;)p[h]=a(u,l[h],i);return p}},{"safe-buffer":494}],200:[function(t,r,o){var s=t("buffer-xor"),a=t("safe-buffer").Buffer,u=t("../incr32");function l(i){var c=i._cipher.encryptBlockRaw(i._prev);return u(i._prev),c}o.encrypt=function(i,c){var p=Math.ceil(c.length/16),h=i._cache.length;i._cache=a.concat([i._cache,a.allocUnsafe(16*p)]);for(var f=0;f<p;f++){var g=l(i),y=h+16*f;i._cache.writeUInt32BE(g[0],y+0),i._cache.writeUInt32BE(g[1],y+4),i._cache.writeUInt32BE(g[2],y+8),i._cache.writeUInt32BE(g[3],y+12)}var b=i._cache.slice(0,c.length);return i._cache=i._cache.slice(c.length),s(c,b)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(t,r,o){o.encrypt=function(s,a){return s._cipher.encryptBlock(a)},o.decrypt=function(s,a){return s._cipher.decryptBlock(a)}},{}],202:[function(t,r,o){var s={ECB:t("./ecb"),CBC:t("./cbc"),CFB:t("./cfb"),CFB8:t("./cfb8"),CFB1:t("./cfb1"),OFB:t("./ofb"),CTR:t("./ctr"),GCM:t("./ctr")},a=t("./list.json");for(var u in a)a[u].module=s[a[u].mode];r.exports=a},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(t,r,o){r.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(t,r,o){(function(s){(function(){var a=t("buffer-xor");function u(l){return l._prev=l._cipher.encryptBlock(l._prev),l._prev}o.encrypt=function(l,i){for(;l._cache.length<i.length;)l._cache=s.concat([l._cache,u(l)]);var c=l._cache.slice(0,i.length);return l._cache=l._cache.slice(i.length),a(i,c)}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(t,r,o){var s=t("./aes"),a=t("safe-buffer").Buffer,u=t("cipher-base");function l(i,c,p,h){u.call(this),this._cipher=new s.AES(c),this._prev=a.from(p),this._cache=a.allocUnsafe(0),this._secCache=a.allocUnsafe(0),this._decrypt=h,this._mode=i}t("inherits")(l,u),l.prototype._update=function(i){return this._mode.encrypt(this,i,this._decrypt)},l.prototype._final=function(){this._cipher.scrub()},r.exports=l},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(t,r,o){var s=t("browserify-des"),a=t("browserify-aes/browser"),u=t("browserify-aes/modes"),l=t("browserify-des/modes"),i=t("evp_bytestokey");function c(h,f,g){if(h=h.toLowerCase(),u[h])return a.createCipheriv(h,f,g);if(l[h])return new s({key:f,iv:g,mode:h});throw new TypeError("invalid suite type")}function p(h,f,g){if(h=h.toLowerCase(),u[h])return a.createDecipheriv(h,f,g);if(l[h])return new s({key:f,iv:g,mode:h,decrypt:!0});throw new TypeError("invalid suite type")}o.createCipher=o.Cipher=function(h,f){var g,y;if(h=h.toLowerCase(),u[h])g=u[h].key,y=u[h].iv;else{if(!l[h])throw new TypeError("invalid suite type");g=8*l[h].key,y=l[h].iv}var b=i(f,!1,g,y);return c(h,b.key,b.iv)},o.createCipheriv=o.Cipheriv=c,o.createDecipher=o.Decipher=function(h,f){var g,y;if(h=h.toLowerCase(),u[h])g=u[h].key,y=u[h].iv;else{if(!l[h])throw new TypeError("invalid suite type");g=8*l[h].key,y=l[h].iv}var b=i(f,!1,g,y);return p(h,b.key,b.iv)},o.createDecipheriv=o.Decipheriv=p,o.listCiphers=o.getCiphers=function(){return Object.keys(l).concat(a.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(t,r,o){var s=t("cipher-base"),a=t("des.js"),u=t("inherits"),l=t("safe-buffer").Buffer,i={"des-ede3-cbc":a.CBC.instantiate(a.EDE),"des-ede3":a.EDE,"des-ede-cbc":a.CBC.instantiate(a.EDE),"des-ede":a.EDE,"des-cbc":a.CBC.instantiate(a.DES),"des-ecb":a.DES};function c(p){s.call(this);var h,f=p.mode.toLowerCase(),g=i[f];h=p.decrypt?"decrypt":"encrypt";var y=p.key;l.isBuffer(y)||(y=l.from(y)),f!=="des-ede"&&f!=="des-ede-cbc"||(y=l.concat([y,y.slice(0,8)]));var b=p.iv;l.isBuffer(b)||(b=l.from(b)),this._des=g.create({key:y,iv:b,type:h})}i.des=i["des-cbc"],i.des3=i["des-ede3-cbc"],r.exports=c,u(c,s),c.prototype._update=function(p){return l.from(this._des.update(p))},c.prototype._final=function(){return l.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(t,r,o){o["des-ecb"]={key:8,iv:0},o["des-cbc"]=o.des={key:8,iv:8},o["des-ede3-cbc"]=o.des3={key:24,iv:8},o["des-ede3"]={key:24,iv:0},o["des-ede-cbc"]={key:16,iv:8},o["des-ede"]={key:16,iv:0}},{}],209:[function(t,r,o){(function(s){(function(){var a=t("bn.js"),u=t("randombytes");function l(c){var p,h=c.modulus.byteLength();do p=new a(u(h));while(p.cmp(c.modulus)>=0||!p.umod(c.prime1)||!p.umod(c.prime2));return p}function i(c,p){var h=(function(G){var P=l(G);return{blinder:P.toRed(a.mont(G.modulus)).redPow(new a(G.publicExponent)).fromRed(),unblinder:P.invm(G.modulus)}})(p),f=p.modulus.byteLength(),g=new a(c).mul(h.blinder).umod(p.modulus),y=g.toRed(a.mont(p.prime1)),b=g.toRed(a.mont(p.prime2)),v=p.coefficient,w=p.prime1,S=p.prime2,N=y.redPow(p.exponent1).fromRed(),D=b.redPow(p.exponent2).fromRed(),F=N.isub(D).imul(v).umod(w).imul(S);return D.iadd(F).imul(h.unblinder).umod(p.modulus).toArrayLike(s,"be",f)}i.getr=l,r.exports=i}).call(this)}).call(this,t("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(t,r,o){r.exports=t("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(t,r,o){r.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(t,r,o){r.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(t,r,o){var s=t("safe-buffer").Buffer,a=t("create-hash"),u=t("readable-stream"),l=t("inherits"),i=t("./sign"),c=t("./verify"),p=t("./algorithms.json");function h(b){u.Writable.call(this);var v=p[b];if(!v)throw new Error("Unknown message digest");this._hashType=v.hash,this._hash=a(v.hash),this._tag=v.id,this._signType=v.sign}function f(b){u.Writable.call(this);var v=p[b];if(!v)throw new Error("Unknown message digest");this._hash=a(v.hash),this._tag=v.id,this._signType=v.sign}function g(b){return new h(b)}function y(b){return new f(b)}Object.keys(p).forEach((function(b){p[b].id=s.from(p[b].id,"hex"),p[b.toLowerCase()]=p[b]})),l(h,u.Writable),h.prototype._write=function(b,v,w){this._hash.update(b),w()},h.prototype.update=function(b,v){return typeof b=="string"&&(b=s.from(b,v)),this._hash.update(b),this},h.prototype.sign=function(b,v){this.end();var w=this._hash.digest(),S=i(w,b,this._hashType,this._signType,this._tag);return v?S.toString(v):S},l(f,u.Writable),f.prototype._write=function(b,v,w){this._hash.update(b),w()},f.prototype.update=function(b,v){return typeof b=="string"&&(b=s.from(b,v)),this._hash.update(b),this},f.prototype.verify=function(b,v,w){typeof v=="string"&&(v=s.from(v,w)),this.end();var S=this._hash.digest();return c(v,S,b,this._signType,this._tag)},r.exports={Sign:g,Verify:y,createSign:g,createVerify:y}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(t,r,o){var s=t("safe-buffer").Buffer,a=t("create-hmac"),u=t("browserify-rsa"),l=t("elliptic").ec,i=t("bn.js"),c=t("parse-asn1"),p=t("./curves.json");function h(b,v,w,S){if((b=s.from(b.toArray())).length<v.byteLength()){var N=s.alloc(v.byteLength()-b.length);b=s.concat([N,b])}var D=w.length,F=(function(U,q){U=(U=f(U,q)).mod(q);var R=s.from(U.toArray());if(R.length<q.byteLength()){var I=s.alloc(q.byteLength()-R.length);R=s.concat([I,R])}return R})(w,v),G=s.alloc(D);G.fill(1);var P=s.alloc(D);return P=a(S,P).update(G).update(s.from([0])).update(b).update(F).digest(),G=a(S,P).update(G).digest(),{k:P=a(S,P).update(G).update(s.from([1])).update(b).update(F).digest(),v:G=a(S,P).update(G).digest()}}function f(b,v){var w=new i(b),S=(b.length<<3)-v.bitLength();return S>0&&w.ishrn(S),w}function g(b,v,w){var S,N;do{for(S=s.alloc(0);8*S.length<b.bitLength();)v.v=a(w,v.k).update(v.v).digest(),S=s.concat([S,v.v]);N=f(S,b),v.k=a(w,v.k).update(v.v).update(s.from([0])).digest(),v.v=a(w,v.k).update(v.v).digest()}while(N.cmp(b)!==-1);return N}function y(b,v,w,S){return b.toRed(i.mont(w)).redPow(v).fromRed().mod(S)}r.exports=function(b,v,w,S,N){var D=c(v);if(D.curve){if(S!=="ecdsa"&&S!=="ecdsa/rsa")throw new Error("wrong private key type");return(function(U,q){var R=p[q.curve.join(".")];if(!R)throw new Error("unknown curve "+q.curve.join("."));var I=new l(R).keyFromPrivate(q.privateKey).sign(U);return s.from(I.toDER())})(b,D)}if(D.type==="dsa"){if(S!=="dsa")throw new Error("wrong private key type");return(function(U,q,R){for(var I,T=q.params.priv_key,L=q.params.p,E=q.params.q,x=q.params.g,k=new i(0),A=f(U,E).mod(E),C=!1,j=h(T,E,U,R);C===!1;)I=g(E,j,R),k=y(x,I,L,E),(C=I.invm(E).imul(A.add(T.mul(k))).mod(E)).cmpn(0)===0&&(C=!1,k=new i(0));return(function(B,O){B=B.toArray(),O=O.toArray(),128&B[0]&&(B=[0].concat(B)),128&O[0]&&(O=[0].concat(O));var H=[48,B.length+O.length+4,2,B.length];return H=H.concat(B,[2,O.length],O),s.from(H)})(k,C)})(b,D,w)}if(S!=="rsa"&&S!=="ecdsa/rsa")throw new Error("wrong private key type");b=s.concat([N,b]);for(var F=D.modulus.byteLength(),G=[0,1];b.length+G.length+1<F;)G.push(255);G.push(0);for(var P=-1;++P<b.length;)G.push(b[P]);return u(G,D)},r.exports.getKey=h,r.exports.makeKey=g},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(t,r,o){var s=t("safe-buffer").Buffer,a=t("bn.js"),u=t("elliptic").ec,l=t("parse-asn1"),i=t("./curves.json");function c(p,h){if(p.cmpn(0)<=0)throw new Error("invalid sig");if(p.cmp(h)>=h)throw new Error("invalid sig")}r.exports=function(p,h,f,g,y){var b=l(f);if(b.type==="ec"){if(g!=="ecdsa"&&g!=="ecdsa/rsa")throw new Error("wrong public key type");return(function(G,P,U){var q=i[U.data.algorithm.curve.join(".")];if(!q)throw new Error("unknown curve "+U.data.algorithm.curve.join("."));var R=new u(q),I=U.data.subjectPrivateKey.data;return R.verify(P,G,I)})(p,h,b)}if(b.type==="dsa"){if(g!=="dsa")throw new Error("wrong public key type");return(function(G,P,U){var q=U.data.p,R=U.data.q,I=U.data.g,T=U.data.pub_key,L=l.signature.decode(G,"der"),E=L.s,x=L.r;c(E,R),c(x,R);var k=a.mont(q),A=E.invm(R);return I.toRed(k).redPow(new a(P).mul(A).mod(R)).fromRed().mul(T.toRed(k).redPow(x.mul(A).mod(R)).fromRed()).mod(q).mod(R).cmp(x)===0})(p,h,b)}if(g!=="rsa"&&g!=="ecdsa/rsa")throw new Error("wrong public key type");h=s.concat([y,h]);for(var v=b.modulus.byteLength(),w=[1],S=0;h.length+w.length+2<v;)w.push(255),S++;w.push(0);for(var N=-1;++N<h.length;)w.push(h[N]);w=s.from(w);var D=a.mont(b.modulus);p=(p=new a(p).toRed(D)).redPow(new a(b.publicExponent)),p=s.from(p.fromRed().toArray());var F=S<8?1:0;for(v=Math.min(p.length,w.length),p.length!==w.length&&(F=1),N=-1;++N<v;)F|=p[N]^w[N];return F===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(t,r,o){},{}],217:[function(t,r,o){var s=t("buffer"),a=s.Buffer;function u(i,c){for(var p in i)c[p]=i[p]}function l(i,c,p){return a(i,c,p)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?r.exports=s:(u(s,o),o.Buffer=l),u(a,l),l.from=function(i,c,p){if(typeof i=="number")throw new TypeError("Argument must not be a number");return a(i,c,p)},l.alloc=function(i,c,p){if(typeof i!="number")throw new TypeError("Argument must be a number");var h=a(i);return c!==void 0?typeof p=="string"?h.fill(c,p):h.fill(c):h.fill(0),h},l.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return a(i)},l.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s.SlowBuffer(i)}},{buffer:220}],218:[function(t,r,o){var s=t("safe-buffer").Buffer,a=s.isEncoding||function(b){switch((b=""+b)&&b.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function u(b){var v;switch(this.encoding=(function(w){var S=(function(N){if(!N)return"utf8";for(var D;;)switch(N){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return N;default:if(D)return;N=(""+N).toLowerCase(),D=!0}})(w);if(typeof S!="string"&&(s.isEncoding===a||!a(w)))throw new Error("Unknown encoding: "+w);return S||w})(b),this.encoding){case"utf16le":this.text=c,this.end=p,v=4;break;case"utf8":this.fillLast=i,v=4;break;case"base64":this.text=h,this.end=f,v=3;break;default:return this.write=g,void(this.end=y)}this.lastNeed=0,this.lastTotal=0,this.lastChar=s.allocUnsafe(v)}function l(b){return b<=127?0:b>>5==6?2:b>>4==14?3:b>>3==30?4:b>>6==2?-1:-2}function i(b){var v=this.lastTotal-this.lastNeed,w=(function(S,N,D){if((192&N[0])!=128)return S.lastNeed=0,"";if(S.lastNeed>1&&N.length>1){if((192&N[1])!=128)return S.lastNeed=1,"";if(S.lastNeed>2&&N.length>2&&(192&N[2])!=128)return S.lastNeed=2,""}})(this,b);return w!==void 0?w:this.lastNeed<=b.length?(b.copy(this.lastChar,v,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(b.copy(this.lastChar,v,0,b.length),void(this.lastNeed-=b.length))}function c(b,v){if((b.length-v)%2==0){var w=b.toString("utf16le",v);if(w){var S=w.charCodeAt(w.length-1);if(S>=55296&&S<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1],w.slice(0,-1)}return w}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=b[b.length-1],b.toString("utf16le",v,b.length-1)}function p(b){var v=b&&b.length?this.write(b):"";if(this.lastNeed){var w=this.lastTotal-this.lastNeed;return v+this.lastChar.toString("utf16le",0,w)}return v}function h(b,v){var w=(b.length-v)%3;return w===0?b.toString("base64",v):(this.lastNeed=3-w,this.lastTotal=3,w===1?this.lastChar[0]=b[b.length-1]:(this.lastChar[0]=b[b.length-2],this.lastChar[1]=b[b.length-1]),b.toString("base64",v,b.length-w))}function f(b){var v=b&&b.length?this.write(b):"";return this.lastNeed?v+this.lastChar.toString("base64",0,3-this.lastNeed):v}function g(b){return b.toString(this.encoding)}function y(b){return b&&b.length?this.write(b):""}o.StringDecoder=u,u.prototype.write=function(b){if(b.length===0)return"";var v,w;if(this.lastNeed){if((v=this.fillLast(b))===void 0)return"";w=this.lastNeed,this.lastNeed=0}else w=0;return w<b.length?v?v+this.text(b,w):this.text(b,w):v||""},u.prototype.end=function(b){var v=b&&b.length?this.write(b):"";return this.lastNeed?v+"":v},u.prototype.text=function(b,v){var w=(function(N,D,F){var G=D.length-1;if(G<F)return 0;var P=l(D[G]);return P>=0?(P>0&&(N.lastNeed=P-1),P):--G<F||P===-2?0:(P=l(D[G]))>=0?(P>0&&(N.lastNeed=P-2),P):--G<F||P===-2?0:(P=l(D[G]))>=0?(P>0&&(P===2?P=0:N.lastNeed=P-3),P):0})(this,b,v);if(!this.lastNeed)return b.toString("utf8",v);this.lastTotal=w;var S=b.length-(w-this.lastNeed);return b.copy(this.lastChar,0,S),b.toString("utf8",v,S)},u.prototype.fillLast=function(b){if(this.lastNeed<=b.length)return b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);b.copy(this.lastChar,this.lastTotal-this.lastNeed,0,b.length),this.lastNeed-=b.length}},{"safe-buffer":217}],219:[function(t,r,o){(function(s){(function(){r.exports=function(a,u){for(var l=Math.min(a.length,u.length),i=new s(l),c=0;c<l;++c)i[c]=a[c]^u[c];return i}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220}],220:[function(t,r,o){(function(s){(function(){var a=t("base64-js"),u=t("ieee754");o.Buffer=i,o.SlowBuffer=function($){return+$!=$&&($=0),i.alloc(+$)},o.INSPECT_MAX_BYTES=50;function l($){if($>2147483647)throw new RangeError('The value "'+$+'" is invalid for option "size"');var z=new Uint8Array($);return z.__proto__=i.prototype,z}function i($,z,Z){if(typeof $=="number"){if(typeof z=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h($)}return c($,z,Z)}function c($,z,Z){if(typeof $=="string")return(function(lt,at){if(typeof at=="string"&&at!==""||(at="utf8"),!i.isEncoding(at))throw new TypeError("Unknown encoding: "+at);var rt=0|y(lt,at),ct=l(rt),ot=ct.write(lt,at);return ot!==rt&&(ct=ct.slice(0,ot)),ct})($,z);if(ArrayBuffer.isView($))return f($);if($==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof $);if(V($,ArrayBuffer)||$&&V($.buffer,ArrayBuffer))return(function(lt,at,rt){if(at<0||lt.byteLength<at)throw new RangeError('"offset" is outside of buffer bounds');if(lt.byteLength<at+(rt||0))throw new RangeError('"length" is outside of buffer bounds');var ct;return ct=at===void 0&&rt===void 0?new Uint8Array(lt):rt===void 0?new Uint8Array(lt,at):new Uint8Array(lt,at,rt),ct.__proto__=i.prototype,ct})($,z,Z);if(typeof $=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var it=$.valueOf&&$.valueOf();if(it!=null&&it!==$)return i.from(it,z,Z);var mt=(function(lt){if(i.isBuffer(lt)){var at=0|g(lt.length),rt=l(at);return rt.length===0||lt.copy(rt,0,0,at),rt}if(lt.length!==void 0)return typeof lt.length!="number"||tt(lt.length)?l(0):f(lt);if(lt.type==="Buffer"&&Array.isArray(lt.data))return f(lt.data)})($);if(mt)return mt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof $[Symbol.toPrimitive]=="function")return i.from($[Symbol.toPrimitive]("string"),z,Z);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof $)}function p($){if(typeof $!="number")throw new TypeError('"size" argument must be of type number');if($<0)throw new RangeError('The value "'+$+'" is invalid for option "size"')}function h($){return p($),l($<0?0:0|g($))}function f($){for(var z=$.length<0?0:0|g($.length),Z=l(z),it=0;it<z;it+=1)Z[it]=255&$[it];return Z}function g($){if($>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|$}function y($,z){if(i.isBuffer($))return $.length;if(ArrayBuffer.isView($)||V($,ArrayBuffer))return $.byteLength;if(typeof $!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof $);var Z=$.length,it=arguments.length>2&&arguments[2]===!0;if(!it&&Z===0)return 0;for(var mt=!1;;)switch(z){case"ascii":case"latin1":case"binary":return Z;case"utf8":case"utf-8":return H($).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Z;case"hex":return Z>>>1;case"base64":return X($).length;default:if(mt)return it?-1:H($).length;z=(""+z).toLowerCase(),mt=!0}}function b($,z,Z){var it=!1;if((z===void 0||z<0)&&(z=0),z>this.length||((Z===void 0||Z>this.length)&&(Z=this.length),Z<=0)||(Z>>>=0)<=(z>>>=0))return"";for($||($="utf8");;)switch($){case"hex":return L(this,z,Z);case"utf8":case"utf-8":return R(this,z,Z);case"ascii":return I(this,z,Z);case"latin1":case"binary":return T(this,z,Z);case"base64":return q(this,z,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,z,Z);default:if(it)throw new TypeError("Unknown encoding: "+$);$=($+"").toLowerCase(),it=!0}}function v($,z,Z){var it=$[z];$[z]=$[Z],$[Z]=it}function w($,z,Z,it,mt){if($.length===0)return-1;if(typeof Z=="string"?(it=Z,Z=0):Z>2147483647?Z=2147483647:Z<-2147483648&&(Z=-2147483648),tt(Z=+Z)&&(Z=mt?0:$.length-1),Z<0&&(Z=$.length+Z),Z>=$.length){if(mt)return-1;Z=$.length-1}else if(Z<0){if(!mt)return-1;Z=0}if(typeof z=="string"&&(z=i.from(z,it)),i.isBuffer(z))return z.length===0?-1:S($,z,Z,it,mt);if(typeof z=="number")return z&=255,typeof Uint8Array.prototype.indexOf=="function"?mt?Uint8Array.prototype.indexOf.call($,z,Z):Uint8Array.prototype.lastIndexOf.call($,z,Z):S($,[z],Z,it,mt);throw new TypeError("val must be string, number or Buffer")}function S($,z,Z,it,mt){var lt,at=1,rt=$.length,ct=z.length;if(it!==void 0&&((it=String(it).toLowerCase())==="ucs2"||it==="ucs-2"||it==="utf16le"||it==="utf-16le")){if($.length<2||z.length<2)return-1;at=2,rt/=2,ct/=2,Z/=2}function ot(wt,yt){return at===1?wt[yt]:wt.readUInt16BE(yt*at)}if(mt){var dt=-1;for(lt=Z;lt<rt;lt++)if(ot($,lt)===ot(z,dt===-1?0:lt-dt)){if(dt===-1&&(dt=lt),lt-dt+1===ct)return dt*at}else dt!==-1&&(lt-=lt-dt),dt=-1}else for(Z+ct>rt&&(Z=rt-ct),lt=Z;lt>=0;lt--){for(var ft=!0,gt=0;gt<ct;gt++)if(ot($,lt+gt)!==ot(z,gt)){ft=!1;break}if(ft)return lt}return-1}function N($,z,Z,it){Z=Number(Z)||0;var mt=$.length-Z;it?(it=Number(it))>mt&&(it=mt):it=mt;var lt=z.length;it>lt/2&&(it=lt/2);for(var at=0;at<it;++at){var rt=parseInt(z.substr(2*at,2),16);if(tt(rt))return at;$[Z+at]=rt}return at}function D($,z,Z,it){return et(H(z,$.length-Z),$,Z,it)}function F($,z,Z,it){return et((function(mt){for(var lt=[],at=0;at<mt.length;++at)lt.push(255&mt.charCodeAt(at));return lt})(z),$,Z,it)}function G($,z,Z,it){return F($,z,Z,it)}function P($,z,Z,it){return et(X(z),$,Z,it)}function U($,z,Z,it){return et((function(mt,lt){for(var at,rt,ct,ot=[],dt=0;dt<mt.length&&!((lt-=2)<0);++dt)at=mt.charCodeAt(dt),rt=at>>8,ct=at%256,ot.push(ct),ot.push(rt);return ot})(z,$.length-Z),$,Z,it)}function q($,z,Z){return z===0&&Z===$.length?a.fromByteArray($):a.fromByteArray($.slice(z,Z))}function R($,z,Z){Z=Math.min($.length,Z);for(var it=[],mt=z;mt<Z;){var lt,at,rt,ct,ot=$[mt],dt=null,ft=ot>239?4:ot>223?3:ot>191?2:1;if(mt+ft<=Z)switch(ft){case 1:ot<128&&(dt=ot);break;case 2:(192&(lt=$[mt+1]))==128&&(ct=(31&ot)<<6|63&lt)>127&&(dt=ct);break;case 3:lt=$[mt+1],at=$[mt+2],(192&lt)==128&&(192&at)==128&&(ct=(15&ot)<<12|(63&lt)<<6|63&at)>2047&&(ct<55296||ct>57343)&&(dt=ct);break;case 4:lt=$[mt+1],at=$[mt+2],rt=$[mt+3],(192&lt)==128&&(192&at)==128&&(192&rt)==128&&(ct=(15&ot)<<18|(63&lt)<<12|(63&at)<<6|63&rt)>65535&&ct<1114112&&(dt=ct)}dt===null?(dt=65533,ft=1):dt>65535&&(dt-=65536,it.push(dt>>>10&1023|55296),dt=56320|1023&dt),it.push(dt),mt+=ft}return(function(gt){var wt=gt.length;if(wt<=4096)return String.fromCharCode.apply(String,gt);for(var yt="",Et=0;Et<wt;)yt+=String.fromCharCode.apply(String,gt.slice(Et,Et+=4096));return yt})(it)}o.kMaxLength=2147483647,i.TYPED_ARRAY_SUPPORT=(function(){try{var $=new Uint8Array(1);return $.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},$.foo()===42}catch{return!1}})(),i.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),i.poolSize=8192,i.from=function($,z,Z){return c($,z,Z)},i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,i.alloc=function($,z,Z){return(function(it,mt,lt){return p(it),it<=0?l(it):mt!==void 0?typeof lt=="string"?l(it).fill(mt,lt):l(it).fill(mt):l(it)})($,z,Z)},i.allocUnsafe=function($){return h($)},i.allocUnsafeSlow=function($){return h($)},i.isBuffer=function($){return $!=null&&$._isBuffer===!0&&$!==i.prototype},i.compare=function($,z){if(V($,Uint8Array)&&($=i.from($,$.offset,$.byteLength)),V(z,Uint8Array)&&(z=i.from(z,z.offset,z.byteLength)),!i.isBuffer($)||!i.isBuffer(z))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if($===z)return 0;for(var Z=$.length,it=z.length,mt=0,lt=Math.min(Z,it);mt<lt;++mt)if($[mt]!==z[mt]){Z=$[mt],it=z[mt];break}return Z<it?-1:it<Z?1:0},i.isEncoding=function($){switch(String($).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function($,z){if(!Array.isArray($))throw new TypeError('"list" argument must be an Array of Buffers');if($.length===0)return i.alloc(0);var Z;if(z===void 0)for(z=0,Z=0;Z<$.length;++Z)z+=$[Z].length;var it=i.allocUnsafe(z),mt=0;for(Z=0;Z<$.length;++Z){var lt=$[Z];if(V(lt,Uint8Array)&&(lt=i.from(lt)),!i.isBuffer(lt))throw new TypeError('"list" argument must be an Array of Buffers');lt.copy(it,mt),mt+=lt.length}return it},i.byteLength=y,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var $=this.length;if($%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var z=0;z<$;z+=2)v(this,z,z+1);return this},i.prototype.swap32=function(){var $=this.length;if($%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var z=0;z<$;z+=4)v(this,z,z+3),v(this,z+1,z+2);return this},i.prototype.swap64=function(){var $=this.length;if($%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var z=0;z<$;z+=8)v(this,z,z+7),v(this,z+1,z+6),v(this,z+2,z+5),v(this,z+3,z+4);return this},i.prototype.toString=function(){var $=this.length;return $===0?"":arguments.length===0?R(this,0,$):b.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function($){if(!i.isBuffer($))throw new TypeError("Argument must be a Buffer");return this===$||i.compare(this,$)===0},i.prototype.inspect=function(){var $="",z=o.INSPECT_MAX_BYTES;return $=this.toString("hex",0,z).replace(/(.{2})/g,"$1 ").trim(),this.length>z&&($+=" ... "),"<Buffer "+$+">"},i.prototype.compare=function($,z,Z,it,mt){if(V($,Uint8Array)&&($=i.from($,$.offset,$.byteLength)),!i.isBuffer($))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof $);if(z===void 0&&(z=0),Z===void 0&&(Z=$?$.length:0),it===void 0&&(it=0),mt===void 0&&(mt=this.length),z<0||Z>$.length||it<0||mt>this.length)throw new RangeError("out of range index");if(it>=mt&&z>=Z)return 0;if(it>=mt)return-1;if(z>=Z)return 1;if(this===$)return 0;for(var lt=(mt>>>=0)-(it>>>=0),at=(Z>>>=0)-(z>>>=0),rt=Math.min(lt,at),ct=this.slice(it,mt),ot=$.slice(z,Z),dt=0;dt<rt;++dt)if(ct[dt]!==ot[dt]){lt=ct[dt],at=ot[dt];break}return lt<at?-1:at<lt?1:0},i.prototype.includes=function($,z,Z){return this.indexOf($,z,Z)!==-1},i.prototype.indexOf=function($,z,Z){return w(this,$,z,Z,!0)},i.prototype.lastIndexOf=function($,z,Z){return w(this,$,z,Z,!1)},i.prototype.write=function($,z,Z,it){if(z===void 0)it="utf8",Z=this.length,z=0;else if(Z===void 0&&typeof z=="string")it=z,Z=this.length,z=0;else{if(!isFinite(z))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");z>>>=0,isFinite(Z)?(Z>>>=0,it===void 0&&(it="utf8")):(it=Z,Z=void 0)}var mt=this.length-z;if((Z===void 0||Z>mt)&&(Z=mt),$.length>0&&(Z<0||z<0)||z>this.length)throw new RangeError("Attempt to write outside buffer bounds");it||(it="utf8");for(var lt=!1;;)switch(it){case"hex":return N(this,$,z,Z);case"utf8":case"utf-8":return D(this,$,z,Z);case"ascii":return F(this,$,z,Z);case"latin1":case"binary":return G(this,$,z,Z);case"base64":return P(this,$,z,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,$,z,Z);default:if(lt)throw new TypeError("Unknown encoding: "+it);it=(""+it).toLowerCase(),lt=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I($,z,Z){var it="";Z=Math.min($.length,Z);for(var mt=z;mt<Z;++mt)it+=String.fromCharCode(127&$[mt]);return it}function T($,z,Z){var it="";Z=Math.min($.length,Z);for(var mt=z;mt<Z;++mt)it+=String.fromCharCode($[mt]);return it}function L($,z,Z){var it=$.length;(!z||z<0)&&(z=0),(!Z||Z<0||Z>it)&&(Z=it);for(var mt="",lt=z;lt<Z;++lt)mt+=O($[lt]);return mt}function E($,z,Z){for(var it=$.slice(z,Z),mt="",lt=0;lt<it.length;lt+=2)mt+=String.fromCharCode(it[lt]+256*it[lt+1]);return mt}function x($,z,Z){if($%1!=0||$<0)throw new RangeError("offset is not uint");if($+z>Z)throw new RangeError("Trying to access beyond buffer length")}function k($,z,Z,it,mt,lt){if(!i.isBuffer($))throw new TypeError('"buffer" argument must be a Buffer instance');if(z>mt||z<lt)throw new RangeError('"value" argument is out of bounds');if(Z+it>$.length)throw new RangeError("Index out of range")}function A($,z,Z,it,mt,lt){if(Z+it>$.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("Index out of range")}function C($,z,Z,it,mt){return z=+z,Z>>>=0,mt||A($,0,Z,4),u.write($,z,Z,it,23,4),Z+4}function j($,z,Z,it,mt){return z=+z,Z>>>=0,mt||A($,0,Z,8),u.write($,z,Z,it,52,8),Z+8}i.prototype.slice=function($,z){var Z=this.length;($=~~$)<0?($+=Z)<0&&($=0):$>Z&&($=Z),(z=z===void 0?Z:~~z)<0?(z+=Z)<0&&(z=0):z>Z&&(z=Z),z<$&&(z=$);var it=this.subarray($,z);return it.__proto__=i.prototype,it},i.prototype.readUIntLE=function($,z,Z){$>>>=0,z>>>=0,Z||x($,z,this.length);for(var it=this[$],mt=1,lt=0;++lt<z&&(mt*=256);)it+=this[$+lt]*mt;return it},i.prototype.readUIntBE=function($,z,Z){$>>>=0,z>>>=0,Z||x($,z,this.length);for(var it=this[$+--z],mt=1;z>0&&(mt*=256);)it+=this[$+--z]*mt;return it},i.prototype.readUInt8=function($,z){return $>>>=0,z||x($,1,this.length),this[$]},i.prototype.readUInt16LE=function($,z){return $>>>=0,z||x($,2,this.length),this[$]|this[$+1]<<8},i.prototype.readUInt16BE=function($,z){return $>>>=0,z||x($,2,this.length),this[$]<<8|this[$+1]},i.prototype.readUInt32LE=function($,z){return $>>>=0,z||x($,4,this.length),(this[$]|this[$+1]<<8|this[$+2]<<16)+16777216*this[$+3]},i.prototype.readUInt32BE=function($,z){return $>>>=0,z||x($,4,this.length),16777216*this[$]+(this[$+1]<<16|this[$+2]<<8|this[$+3])},i.prototype.readIntLE=function($,z,Z){$>>>=0,z>>>=0,Z||x($,z,this.length);for(var it=this[$],mt=1,lt=0;++lt<z&&(mt*=256);)it+=this[$+lt]*mt;return it>=(mt*=128)&&(it-=Math.pow(2,8*z)),it},i.prototype.readIntBE=function($,z,Z){$>>>=0,z>>>=0,Z||x($,z,this.length);for(var it=z,mt=1,lt=this[$+--it];it>0&&(mt*=256);)lt+=this[$+--it]*mt;return lt>=(mt*=128)&&(lt-=Math.pow(2,8*z)),lt},i.prototype.readInt8=function($,z){return $>>>=0,z||x($,1,this.length),128&this[$]?-1*(255-this[$]+1):this[$]},i.prototype.readInt16LE=function($,z){$>>>=0,z||x($,2,this.length);var Z=this[$]|this[$+1]<<8;return 32768&Z?4294901760|Z:Z},i.prototype.readInt16BE=function($,z){$>>>=0,z||x($,2,this.length);var Z=this[$+1]|this[$]<<8;return 32768&Z?4294901760|Z:Z},i.prototype.readInt32LE=function($,z){return $>>>=0,z||x($,4,this.length),this[$]|this[$+1]<<8|this[$+2]<<16|this[$+3]<<24},i.prototype.readInt32BE=function($,z){return $>>>=0,z||x($,4,this.length),this[$]<<24|this[$+1]<<16|this[$+2]<<8|this[$+3]},i.prototype.readFloatLE=function($,z){return $>>>=0,z||x($,4,this.length),u.read(this,$,!0,23,4)},i.prototype.readFloatBE=function($,z){return $>>>=0,z||x($,4,this.length),u.read(this,$,!1,23,4)},i.prototype.readDoubleLE=function($,z){return $>>>=0,z||x($,8,this.length),u.read(this,$,!0,52,8)},i.prototype.readDoubleBE=function($,z){return $>>>=0,z||x($,8,this.length),u.read(this,$,!1,52,8)},i.prototype.writeUIntLE=function($,z,Z,it){$=+$,z>>>=0,Z>>>=0,it||k(this,$,z,Z,Math.pow(2,8*Z)-1,0);var mt=1,lt=0;for(this[z]=255&$;++lt<Z&&(mt*=256);)this[z+lt]=$/mt&255;return z+Z},i.prototype.writeUIntBE=function($,z,Z,it){$=+$,z>>>=0,Z>>>=0,it||k(this,$,z,Z,Math.pow(2,8*Z)-1,0);var mt=Z-1,lt=1;for(this[z+mt]=255&$;--mt>=0&&(lt*=256);)this[z+mt]=$/lt&255;return z+Z},i.prototype.writeUInt8=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,1,255,0),this[z]=255&$,z+1},i.prototype.writeUInt16LE=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,2,65535,0),this[z]=255&$,this[z+1]=$>>>8,z+2},i.prototype.writeUInt16BE=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,2,65535,0),this[z]=$>>>8,this[z+1]=255&$,z+2},i.prototype.writeUInt32LE=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,4,4294967295,0),this[z+3]=$>>>24,this[z+2]=$>>>16,this[z+1]=$>>>8,this[z]=255&$,z+4},i.prototype.writeUInt32BE=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,4,4294967295,0),this[z]=$>>>24,this[z+1]=$>>>16,this[z+2]=$>>>8,this[z+3]=255&$,z+4},i.prototype.writeIntLE=function($,z,Z,it){if($=+$,z>>>=0,!it){var mt=Math.pow(2,8*Z-1);k(this,$,z,Z,mt-1,-mt)}var lt=0,at=1,rt=0;for(this[z]=255&$;++lt<Z&&(at*=256);)$<0&&rt===0&&this[z+lt-1]!==0&&(rt=1),this[z+lt]=($/at>>0)-rt&255;return z+Z},i.prototype.writeIntBE=function($,z,Z,it){if($=+$,z>>>=0,!it){var mt=Math.pow(2,8*Z-1);k(this,$,z,Z,mt-1,-mt)}var lt=Z-1,at=1,rt=0;for(this[z+lt]=255&$;--lt>=0&&(at*=256);)$<0&&rt===0&&this[z+lt+1]!==0&&(rt=1),this[z+lt]=($/at>>0)-rt&255;return z+Z},i.prototype.writeInt8=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,1,127,-128),$<0&&($=255+$+1),this[z]=255&$,z+1},i.prototype.writeInt16LE=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,2,32767,-32768),this[z]=255&$,this[z+1]=$>>>8,z+2},i.prototype.writeInt16BE=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,2,32767,-32768),this[z]=$>>>8,this[z+1]=255&$,z+2},i.prototype.writeInt32LE=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,4,2147483647,-2147483648),this[z]=255&$,this[z+1]=$>>>8,this[z+2]=$>>>16,this[z+3]=$>>>24,z+4},i.prototype.writeInt32BE=function($,z,Z){return $=+$,z>>>=0,Z||k(this,$,z,4,2147483647,-2147483648),$<0&&($=4294967295+$+1),this[z]=$>>>24,this[z+1]=$>>>16,this[z+2]=$>>>8,this[z+3]=255&$,z+4},i.prototype.writeFloatLE=function($,z,Z){return C(this,$,z,!0,Z)},i.prototype.writeFloatBE=function($,z,Z){return C(this,$,z,!1,Z)},i.prototype.writeDoubleLE=function($,z,Z){return j(this,$,z,!0,Z)},i.prototype.writeDoubleBE=function($,z,Z){return j(this,$,z,!1,Z)},i.prototype.copy=function($,z,Z,it){if(!i.isBuffer($))throw new TypeError("argument should be a Buffer");if(Z||(Z=0),it||it===0||(it=this.length),z>=$.length&&(z=$.length),z||(z=0),it>0&&it<Z&&(it=Z),it===Z||$.length===0||this.length===0)return 0;if(z<0)throw new RangeError("targetStart out of bounds");if(Z<0||Z>=this.length)throw new RangeError("Index out of range");if(it<0)throw new RangeError("sourceEnd out of bounds");it>this.length&&(it=this.length),$.length-z<it-Z&&(it=$.length-z+Z);var mt=it-Z;if(this===$&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(z,Z,it);else if(this===$&&Z<z&&z<it)for(var lt=mt-1;lt>=0;--lt)$[lt+z]=this[lt+Z];else Uint8Array.prototype.set.call($,this.subarray(Z,it),z);return mt},i.prototype.fill=function($,z,Z,it){if(typeof $=="string"){if(typeof z=="string"?(it=z,z=0,Z=this.length):typeof Z=="string"&&(it=Z,Z=this.length),it!==void 0&&typeof it!="string")throw new TypeError("encoding must be a string");if(typeof it=="string"&&!i.isEncoding(it))throw new TypeError("Unknown encoding: "+it);if($.length===1){var mt=$.charCodeAt(0);(it==="utf8"&&mt<128||it==="latin1")&&($=mt)}}else typeof $=="number"&&($&=255);if(z<0||this.length<z||this.length<Z)throw new RangeError("Out of range index");if(Z<=z)return this;var lt;if(z>>>=0,Z=Z===void 0?this.length:Z>>>0,$||($=0),typeof $=="number")for(lt=z;lt<Z;++lt)this[lt]=$;else{var at=i.isBuffer($)?$:i.from($,it),rt=at.length;if(rt===0)throw new TypeError('The value "'+$+'" is invalid for argument "value"');for(lt=0;lt<Z-z;++lt)this[lt+z]=at[lt%rt]}return this};var B=/[^+/0-9A-Za-z-_]/g;function O($){return $<16?"0"+$.toString(16):$.toString(16)}function H($,z){var Z;z=z||1/0;for(var it=$.length,mt=null,lt=[],at=0;at<it;++at){if((Z=$.charCodeAt(at))>55295&&Z<57344){if(!mt){if(Z>56319){(z-=3)>-1&&lt.push(239,191,189);continue}if(at+1===it){(z-=3)>-1&&lt.push(239,191,189);continue}mt=Z;continue}if(Z<56320){(z-=3)>-1&&lt.push(239,191,189),mt=Z;continue}Z=65536+(mt-55296<<10|Z-56320)}else mt&&(z-=3)>-1&&lt.push(239,191,189);if(mt=null,Z<128){if((z-=1)<0)break;lt.push(Z)}else if(Z<2048){if((z-=2)<0)break;lt.push(Z>>6|192,63&Z|128)}else if(Z<65536){if((z-=3)<0)break;lt.push(Z>>12|224,Z>>6&63|128,63&Z|128)}else{if(!(Z<1114112))throw new Error("Invalid code point");if((z-=4)<0)break;lt.push(Z>>18|240,Z>>12&63|128,Z>>6&63|128,63&Z|128)}}return lt}function X($){return a.toByteArray((function(z){if((z=(z=z.split("=")[0]).trim().replace(B,"")).length<2)return"";for(;z.length%4!=0;)z+="=";return z})($))}function et($,z,Z,it){for(var mt=0;mt<it&&!(mt+Z>=z.length||mt>=$.length);++mt)z[mt+Z]=$[mt];return mt}function V($,z){return $ instanceof z||$!=null&&$.constructor!=null&&$.constructor.name!=null&&$.constructor.name===z.name}function tt($){return $!=$}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(t,r,o){var s=t("safe-buffer").Buffer,a=t("stream").Transform,u=t("string_decoder").StringDecoder;function l(i){a.call(this),this.hashMode=typeof i=="string",this.hashMode?this[i]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}t("inherits")(l,a),l.prototype.update=function(i,c,p){typeof i=="string"&&(i=s.from(i,c));var h=this._update(i);return this.hashMode?this:(p&&(h=this._toString(h,p)),h)},l.prototype.setAutoPadding=function(){},l.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},l.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},l.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},l.prototype._transform=function(i,c,p){var h;try{this.hashMode?this._update(i):this.push(this._update(i))}catch(f){h=f}finally{p(h)}},l.prototype._flush=function(i){var c;try{this.push(this.__final())}catch(p){c=p}i(c)},l.prototype._finalOrDigest=function(i){var c=this.__final()||s.alloc(0);return i&&(c=this._toString(c,i,!0)),c},l.prototype._toString=function(i,c,p){if(this._decoder||(this._decoder=new u(c),this._encoding=c),this._encoding!==c)throw new Error("can't switch encodings");var h=this._decoder.write(i);return p&&(h+=this._decoder.end()),h},r.exports=l},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(t,r,o){var s=t("../internals/is-callable"),a=t("../internals/try-to-string"),u=TypeError;r.exports=function(l){if(s(l))return l;throw new u(a(l)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(t,r,o){var s=t("../internals/is-constructor"),a=t("../internals/try-to-string"),u=TypeError;r.exports=function(l){if(s(l))return l;throw new u(a(l)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(t,r,o){var s=t("../internals/is-callable"),a=String,u=TypeError;r.exports=function(l){if(typeof l=="object"||s(l))return l;throw new u("Can't set "+a(l)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(t,r,o){var s=t("../internals/well-known-symbol"),a=t("../internals/object-create"),u=t("../internals/object-define-property").f,l=s("unscopables"),i=Array.prototype;i[l]===void 0&&u(i,l,{configurable:!0,value:a(null)}),r.exports=function(c){i[l][c]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(t,r,o){var s=t("../internals/object-is-prototype-of"),a=TypeError;r.exports=function(u,l){if(s(l,u))return u;throw new a("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(t,r,o){var s=t("../internals/is-object"),a=String,u=TypeError;r.exports=function(l){if(s(l))return l;throw new u(a(l)+" is not an object")}},{"../internals/is-object":289}],228:[function(t,r,o){var s=t("../internals/to-indexed-object"),a=t("../internals/to-absolute-index"),u=t("../internals/length-of-array-like"),l=function(i){return function(c,p,h){var f,g=s(c),y=u(g),b=a(h,y);if(i&&p!=p){for(;y>b;)if((f=g[b++])!=f)return!0}else for(;y>b;b++)if((i||b in g)&&g[b]===p)return i||b||0;return!i&&-1}};r.exports={includes:l(!0),indexOf:l(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(t,r,o){var s=t("../internals/function-bind-context"),a=t("../internals/function-uncurry-this"),u=t("../internals/indexed-object"),l=t("../internals/to-object"),i=t("../internals/length-of-array-like"),c=t("../internals/array-species-create"),p=a([].push),h=function(f){var g=f===1,y=f===2,b=f===3,v=f===4,w=f===6,S=f===7,N=f===5||w;return function(D,F,G,P){for(var U,q,R=l(D),I=u(R),T=s(F,G),L=i(I),E=0,x=P||c,k=g?x(D,L):y||S?x(D,0):void 0;L>E;E++)if((N||E in I)&&(q=T(U=I[E],E,R),f))if(g)k[E]=q;else if(q)switch(f){case 3:return!0;case 5:return U;case 6:return E;case 2:p(k,U)}else switch(f){case 4:return!1;case 7:p(k,U)}return w?-1:b||v?v:k}};r.exports={forEach:h(0),map:h(1),filter:h(2),some:h(3),every:h(4),find:h(5),findIndex:h(6),filterReject:h(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(t,r,o){var s=t("../internals/to-absolute-index"),a=t("../internals/length-of-array-like"),u=t("../internals/create-property"),l=Array,i=Math.max;r.exports=function(c,p,h){for(var f=a(c),g=s(p,f),y=s(h===void 0?f:h,f),b=l(i(y-g,0)),v=0;g<y;g++,v++)u(b,v,c[g]);return b.length=v,b}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(t,r,o){var s=t("../internals/function-uncurry-this");r.exports=s([].slice)},{"../internals/function-uncurry-this":268}],232:[function(t,r,o){var s=t("../internals/is-array"),a=t("../internals/is-constructor"),u=t("../internals/is-object"),l=t("../internals/well-known-symbol")("species"),i=Array;r.exports=function(c){var p;return s(c)&&(p=c.constructor,(a(p)&&(p===i||s(p.prototype))||u(p)&&(p=p[l])===null)&&(p=void 0)),p===void 0?i:p}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(t,r,o){var s=t("../internals/array-species-constructor");r.exports=function(a,u){return new(s(a))(u===0?0:u)}},{"../internals/array-species-constructor":232}],234:[function(t,r,o){var s=t("../internals/well-known-symbol")("iterator"),a=!1;try{var u=0,l={next:function(){return{done:!!u++}},return:function(){a=!0}};l[s]=function(){return this},Array.from(l,(function(){throw 2}))}catch{}r.exports=function(i,c){try{if(!c&&!a)return!1}catch{return!1}var p=!1;try{var h={};h[s]=function(){return{next:function(){return{done:p=!0}}}},i(h)}catch{}return p}},{"../internals/well-known-symbol":357}],235:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=s({}.toString),u=s("".slice);r.exports=function(l){return u(a(l),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(t,r,o){var s=t("../internals/to-string-tag-support"),a=t("../internals/is-callable"),u=t("../internals/classof-raw"),l=t("../internals/well-known-symbol")("toStringTag"),i=Object,c=u((function(){return arguments})())==="Arguments";r.exports=s?u:function(p){var h,f,g;return p===void 0?"Undefined":p===null?"Null":typeof(f=(function(y,b){try{return y[b]}catch{}})(h=i(p),l))=="string"?f:c?u(h):(g=u(h))==="Object"&&a(h.callee)?"Arguments":g}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(t,r,o){var s=t("../internals/has-own-property"),a=t("../internals/own-keys"),u=t("../internals/object-get-own-property-descriptor"),l=t("../internals/object-define-property");r.exports=function(i,c,p){for(var h=a(c),f=l.f,g=u.f,y=0;y<h.length;y++){var b=h[y];s(i,b)||p&&s(p,b)||f(i,b,g(c,b))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(t,r,o){var s=t("../internals/well-known-symbol")("match");r.exports=function(a){var u=/./;try{"/./"[a](u)}catch{try{return u[s]=!1,"/./"[a](u)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(t,r,o){var s=t("../internals/fails");r.exports=!s((function(){function a(){}return a.prototype.constructor=null,Object.getPrototypeOf(new a)!==a.prototype}))},{"../internals/fails":260}],240:[function(t,r,o){r.exports=function(s,a){return{value:s,done:a}}},{}],241:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/object-define-property"),u=t("../internals/create-property-descriptor");r.exports=s?function(l,i,c){return a.f(l,i,u(1,c))}:function(l,i,c){return l[i]=c,l}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(t,r,o){r.exports=function(s,a){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:a}}},{}],243:[function(t,r,o){var s=t("../internals/to-property-key"),a=t("../internals/object-define-property"),u=t("../internals/create-property-descriptor");r.exports=function(l,i,c){var p=s(i);p in l?a.f(l,p,u(0,c)):l[p]=c}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(t,r,o){var s=t("../internals/make-built-in"),a=t("../internals/object-define-property");r.exports=function(u,l,i){return i.get&&s(i.get,l,{getter:!0}),i.set&&s(i.set,l,{setter:!0}),a.f(u,l,i)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(t,r,o){var s=t("../internals/is-callable"),a=t("../internals/object-define-property"),u=t("../internals/make-built-in"),l=t("../internals/define-global-property");r.exports=function(i,c,p,h){h||(h={});var f=h.enumerable,g=h.name!==void 0?h.name:c;if(s(p)&&u(p,g,h),h.global)f?i[c]=p:l(c,p);else{try{h.unsafe?i[c]&&(f=!0):delete i[c]}catch{}f?i[c]=p:a.f(i,c,{value:p,enumerable:!1,configurable:!h.nonConfigurable,writable:!h.nonWritable})}return i}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(t,r,o){var s=t("../internals/global"),a=Object.defineProperty;r.exports=function(u,l){try{a(s,u,{value:l,configurable:!0,writable:!0})}catch{s[u]=l}return l}},{"../internals/global":274}],247:[function(t,r,o){var s=t("../internals/fails");r.exports=!s((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}))},{"../internals/fails":260}],248:[function(t,r,o){var s=typeof document=="object"&&document.all,a=s===void 0&&s!==void 0;r.exports={all:s,IS_HTMLDDA:a}},{}],249:[function(t,r,o){var s=t("../internals/global"),a=t("../internals/is-object"),u=s.document,l=a(u)&&a(u.createElement);r.exports=function(i){return l?u.createElement(i):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(t,r,o){var s=t("../internals/engine-is-deno"),a=t("../internals/engine-is-node");r.exports=!s&&!a&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(t,r,o){r.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(t,r,o){var s=t("../internals/engine-user-agent");r.exports=/ipad|iphone|ipod/i.test(s)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(t,r,o){var s=t("../internals/engine-user-agent");r.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(s)},{"../internals/engine-user-agent":256}],254:[function(t,r,o){var s=t("../internals/global"),a=t("../internals/classof-raw");r.exports=a(s.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(t,r,o){var s=t("../internals/engine-user-agent");r.exports=/web0s(?!.*chrome)/i.test(s)},{"../internals/engine-user-agent":256}],256:[function(t,r,o){r.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(t,r,o){var s,a,u=t("../internals/global"),l=t("../internals/engine-user-agent"),i=u.process,c=u.Deno,p=i&&i.versions||c&&c.version,h=p&&p.v8;h&&(a=(s=h.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&l&&(!(s=l.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=l.match(/Chrome\/(\d+)/))&&(a=+s[1]),r.exports=a},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(t,r,o){r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(t,r,o){var s=t("../internals/global"),a=t("../internals/object-get-own-property-descriptor").f,u=t("../internals/create-non-enumerable-property"),l=t("../internals/define-built-in"),i=t("../internals/define-global-property"),c=t("../internals/copy-constructor-properties"),p=t("../internals/is-forced");r.exports=function(h,f){var g,y,b,v,w,S=h.target,N=h.global,D=h.stat;if(g=N?s:D?s[S]||i(S,{}):(s[S]||{}).prototype)for(y in f){if(v=f[y],b=h.dontCallGetSet?(w=a(g,y))&&w.value:g[y],!p(N?y:S+(D?".":"#")+y,h.forced)&&b!==void 0){if(typeof v==typeof b)continue;c(v,b)}(h.sham||b&&b.sham)&&u(v,"sham",!0),l(g,y,v,h)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(t,r,o){r.exports=function(s){try{return!!s()}catch{return!0}}},{}],261:[function(t,r,o){var s=t("../internals/function-bind-native"),a=Function.prototype,u=a.apply,l=a.call;r.exports=typeof Reflect=="object"&&Reflect.apply||(s?l.bind(u):function(){return l.apply(u,arguments)})},{"../internals/function-bind-native":263}],262:[function(t,r,o){var s=t("../internals/function-uncurry-this-clause"),a=t("../internals/a-callable"),u=t("../internals/function-bind-native"),l=s(s.bind);r.exports=function(i,c){return a(i),c===void 0?i:u?l(i,c):function(){return i.apply(c,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(t,r,o){var s=t("../internals/fails");r.exports=!s((function(){var a=(function(){}).bind();return typeof a!="function"||a.hasOwnProperty("prototype")}))},{"../internals/fails":260}],264:[function(t,r,o){var s=t("../internals/function-bind-native"),a=Function.prototype.call;r.exports=s?a.bind(a):function(){return a.apply(a,arguments)}},{"../internals/function-bind-native":263}],265:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/has-own-property"),u=Function.prototype,l=s&&Object.getOwnPropertyDescriptor,i=a(u,"name"),c=i&&(function(){}).name==="something",p=i&&(!s||s&&l(u,"name").configurable);r.exports={EXISTS:i,PROPER:c,CONFIGURABLE:p}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=t("../internals/a-callable");r.exports=function(u,l,i){try{return s(a(Object.getOwnPropertyDescriptor(u,l)[i]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(t,r,o){var s=t("../internals/classof-raw"),a=t("../internals/function-uncurry-this");r.exports=function(u){if(s(u)==="Function")return a(u)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(t,r,o){var s=t("../internals/function-bind-native"),a=Function.prototype,u=a.call,l=s&&a.bind.bind(u,u);r.exports=s?l:function(i){return function(){return u.apply(i,arguments)}}},{"../internals/function-bind-native":263}],269:[function(t,r,o){var s=t("../internals/global"),a=t("../internals/is-callable"),u=function(l){return a(l)?l:void 0};r.exports=function(l,i){return arguments.length<2?u(s[l]):s[l]&&s[l][i]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(t,r,o){var s=t("../internals/classof"),a=t("../internals/get-method"),u=t("../internals/is-null-or-undefined"),l=t("../internals/iterators"),i=t("../internals/well-known-symbol")("iterator");r.exports=function(c){if(!u(c))return a(c,i)||a(c,"@@iterator")||l[s(c)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(t,r,o){var s=t("../internals/function-call"),a=t("../internals/a-callable"),u=t("../internals/an-object"),l=t("../internals/try-to-string"),i=t("../internals/get-iterator-method"),c=TypeError;r.exports=function(p,h){var f=arguments.length<2?i(p):h;if(a(f))return u(s(f,p));throw new c(l(p)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=t("../internals/is-array"),u=t("../internals/is-callable"),l=t("../internals/classof-raw"),i=t("../internals/to-string"),c=s([].push);r.exports=function(p){if(u(p))return p;if(a(p)){for(var h=p.length,f=[],g=0;g<h;g++){var y=p[g];typeof y=="string"?c(f,y):typeof y!="number"&&l(y)!=="Number"&&l(y)!=="String"||c(f,i(y))}var b=f.length,v=!0;return function(w,S){if(v)return v=!1,S;if(a(this))return S;for(var N=0;N<b;N++)if(f[N]===w)return S}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(t,r,o){var s=t("../internals/a-callable"),a=t("../internals/is-null-or-undefined");r.exports=function(u,l){var i=u[l];return a(i)?void 0:s(i)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(t,r,o){(function(s){(function(){var a=function(u){return u&&u.Math===Math&&u};r.exports=a(typeof globalThis=="object"&&globalThis)||a(typeof window=="object"&&window)||a(typeof self=="object"&&self)||a(typeof s=="object"&&s)||(function(){return this})()||this||Function("return this")()}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=t("../internals/to-object"),u=s({}.hasOwnProperty);r.exports=Object.hasOwn||function(l,i){return u(a(l),i)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(t,r,o){r.exports={}},{}],277:[function(t,r,o){r.exports=function(s,a){try{arguments.length===1?console.error(s):console.error(s,a)}catch{}}},{}],278:[function(t,r,o){var s=t("../internals/get-built-in");r.exports=s("document","documentElement")},{"../internals/get-built-in":269}],279:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/fails"),u=t("../internals/document-create-element");r.exports=!s&&!a((function(){return Object.defineProperty(u("div"),"a",{get:function(){return 7}}).a!==7}))},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=t("../internals/fails"),u=t("../internals/classof-raw"),l=Object,i=s("".split);r.exports=a((function(){return!l("z").propertyIsEnumerable(0)}))?function(c){return u(c)==="String"?i(c,""):l(c)}:l},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=t("../internals/is-callable"),u=t("../internals/shared-store"),l=s(Function.toString);a(u.inspectSource)||(u.inspectSource=function(i){return l(i)}),r.exports=u.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(t,r,o){var s,a,u,l=t("../internals/weak-map-basic-detection"),i=t("../internals/global"),c=t("../internals/is-object"),p=t("../internals/create-non-enumerable-property"),h=t("../internals/has-own-property"),f=t("../internals/shared-store"),g=t("../internals/shared-key"),y=t("../internals/hidden-keys"),b=i.TypeError,v=i.WeakMap;if(l||f.state){var w=f.state||(f.state=new v);w.get=w.get,w.has=w.has,w.set=w.set,s=function(N,D){if(w.has(N))throw new b("Object already initialized");return D.facade=N,w.set(N,D),D},a=function(N){return w.get(N)||{}},u=function(N){return w.has(N)}}else{var S=g("state");y[S]=!0,s=function(N,D){if(h(N,S))throw new b("Object already initialized");return D.facade=N,p(N,S,D),D},a=function(N){return h(N,S)?N[S]:{}},u=function(N){return h(N,S)}}r.exports={set:s,get:a,has:u,enforce:function(N){return u(N)?a(N):s(N,{})},getterFor:function(N){return function(D){var F;if(!c(D)||(F=a(D)).type!==N)throw new b("Incompatible receiver, "+N+" required");return F}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(t,r,o){var s=t("../internals/well-known-symbol"),a=t("../internals/iterators"),u=s("iterator"),l=Array.prototype;r.exports=function(i){return i!==void 0&&(a.Array===i||l[u]===i)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(t,r,o){var s=t("../internals/classof-raw");r.exports=Array.isArray||function(a){return s(a)==="Array"}},{"../internals/classof-raw":235}],285:[function(t,r,o){var s=t("../internals/document-all"),a=s.all;r.exports=s.IS_HTMLDDA?function(u){return typeof u=="function"||u===a}:function(u){return typeof u=="function"}},{"../internals/document-all":248}],286:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=t("../internals/fails"),u=t("../internals/is-callable"),l=t("../internals/classof"),i=t("../internals/get-built-in"),c=t("../internals/inspect-source"),p=function(){},h=[],f=i("Reflect","construct"),g=/^\s*(?:class|function)\b/,y=s(g.exec),b=!g.test(p),v=function(S){if(!u(S))return!1;try{return f(p,h,S),!0}catch{return!1}},w=function(S){if(!u(S))return!1;switch(l(S)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return b||!!y(g,c(S))}catch{return!0}};w.sham=!0,r.exports=!f||a((function(){var S;return v(v.call)||!v(Object)||!v((function(){S=!0}))||S}))?w:v},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(t,r,o){var s=t("../internals/fails"),a=t("../internals/is-callable"),u=/#|\.prototype\./,l=function(f,g){var y=c[i(f)];return y===h||y!==p&&(a(g)?s(g):!!g)},i=l.normalize=function(f){return String(f).replace(u,".").toLowerCase()},c=l.data={},p=l.NATIVE="N",h=l.POLYFILL="P";r.exports=l},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(t,r,o){r.exports=function(s){return s==null}},{}],289:[function(t,r,o){var s=t("../internals/is-callable"),a=t("../internals/document-all"),u=a.all;r.exports=a.IS_HTMLDDA?function(l){return typeof l=="object"?l!==null:s(l)||l===u}:function(l){return typeof l=="object"?l!==null:s(l)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(t,r,o){r.exports=!1},{}],291:[function(t,r,o){var s=t("../internals/is-object"),a=t("../internals/classof-raw"),u=t("../internals/well-known-symbol")("match");r.exports=function(l){var i;return s(l)&&((i=l[u])!==void 0?!!i:a(l)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(t,r,o){var s=t("../internals/get-built-in"),a=t("../internals/is-callable"),u=t("../internals/object-is-prototype-of"),l=t("../internals/use-symbol-as-uid"),i=Object;r.exports=l?function(c){return typeof c=="symbol"}:function(c){var p=s("Symbol");return a(p)&&u(p.prototype,i(c))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(t,r,o){var s=t("../internals/function-bind-context"),a=t("../internals/function-call"),u=t("../internals/an-object"),l=t("../internals/try-to-string"),i=t("../internals/is-array-iterator-method"),c=t("../internals/length-of-array-like"),p=t("../internals/object-is-prototype-of"),h=t("../internals/get-iterator"),f=t("../internals/get-iterator-method"),g=t("../internals/iterator-close"),y=TypeError,b=function(w,S){this.stopped=w,this.result=S},v=b.prototype;r.exports=function(w,S,N){var D,F,G,P,U,q,R,I=N&&N.that,T=!(!N||!N.AS_ENTRIES),L=!(!N||!N.IS_RECORD),E=!(!N||!N.IS_ITERATOR),x=!(!N||!N.INTERRUPTED),k=s(S,I),A=function(j){return D&&g(D,"normal",j),new b(!0,j)},C=function(j){return T?(u(j),x?k(j[0],j[1],A):k(j[0],j[1])):x?k(j,A):k(j)};if(L)D=w.iterator;else if(E)D=w;else{if(!(F=f(w)))throw new y(l(w)+" is not iterable");if(i(F)){for(G=0,P=c(w);P>G;G++)if((U=C(w[G]))&&p(v,U))return U;return new b(!1)}D=h(w,F)}for(q=L?w.next:D.next;!(R=a(q,D)).done;){try{U=C(R.value)}catch(j){g(D,"throw",j)}if(typeof U=="object"&&U&&p(v,U))return U}return new b(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(t,r,o){var s=t("../internals/function-call"),a=t("../internals/an-object"),u=t("../internals/get-method");r.exports=function(l,i,c){var p,h;a(l);try{if(!(p=u(l,"return"))){if(i==="throw")throw c;return c}p=s(p,l)}catch(f){h=!0,p=f}if(i==="throw")throw c;if(h)throw p;return a(p),c}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(t,r,o){var s=t("../internals/iterators-core").IteratorPrototype,a=t("../internals/object-create"),u=t("../internals/create-property-descriptor"),l=t("../internals/set-to-string-tag"),i=t("../internals/iterators"),c=function(){return this};r.exports=function(p,h,f,g){var y=h+" Iterator";return p.prototype=a(s,{next:u(+!g,f)}),l(p,y,!1,!0),i[y]=c,p}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/function-call"),u=t("../internals/is-pure"),l=t("../internals/function-name"),i=t("../internals/is-callable"),c=t("../internals/iterator-create-constructor"),p=t("../internals/object-get-prototype-of"),h=t("../internals/object-set-prototype-of"),f=t("../internals/set-to-string-tag"),g=t("../internals/create-non-enumerable-property"),y=t("../internals/define-built-in"),b=t("../internals/well-known-symbol"),v=t("../internals/iterators"),w=t("../internals/iterators-core"),S=l.PROPER,N=l.CONFIGURABLE,D=w.IteratorPrototype,F=w.BUGGY_SAFARI_ITERATORS,G=b("iterator"),P=function(){return this};r.exports=function(U,q,R,I,T,L,E){c(R,q,I);var x,k,A,C=function(V){if(V===T&&X)return X;if(!F&&V&&V in O)return O[V];switch(V){case"keys":case"values":case"entries":return function(){return new R(this,V)}}return function(){return new R(this)}},j=q+" Iterator",B=!1,O=U.prototype,H=O[G]||O["@@iterator"]||T&&O[T],X=!F&&H||C(T),et=q==="Array"&&O.entries||H;if(et&&(x=p(et.call(new U)))!==Object.prototype&&x.next&&(u||p(x)===D||(h?h(x,D):i(x[G])||y(x,G,P)),f(x,j,!0,!0),u&&(v[j]=P)),S&&T==="values"&&H&&H.name!=="values"&&(!u&&N?g(O,"name","values"):(B=!0,X=function(){return a(H,this)})),T)if(k={values:C("values"),keys:L?X:C("keys"),entries:C("entries")},E)for(A in k)(F||B||!(A in O))&&y(O,A,k[A]);else s({target:q,proto:!0,forced:F||B},k);return u&&!E||O[G]===X||y(O,G,X,{name:T}),v[q]=X,k}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(t,r,o){var s,a,u,l=t("../internals/fails"),i=t("../internals/is-callable"),c=t("../internals/is-object"),p=t("../internals/object-create"),h=t("../internals/object-get-prototype-of"),f=t("../internals/define-built-in"),g=t("../internals/well-known-symbol"),y=t("../internals/is-pure"),b=g("iterator"),v=!1;[].keys&&("next"in(u=[].keys())?(a=h(h(u)))!==Object.prototype&&(s=a):v=!0),!c(s)||l((function(){var w={};return s[b].call(w)!==w}))?s={}:y&&(s=p(s)),i(s[b])||f(s,b,(function(){return this})),r.exports={IteratorPrototype:s,BUGGY_SAFARI_ITERATORS:v}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(t,r,o){arguments[4][276][0].apply(o,arguments)},{dup:276}],299:[function(t,r,o){var s=t("../internals/to-length");r.exports=function(a){return s(a.length)}},{"../internals/to-length":343}],300:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=t("../internals/fails"),u=t("../internals/is-callable"),l=t("../internals/has-own-property"),i=t("../internals/descriptors"),c=t("../internals/function-name").CONFIGURABLE,p=t("../internals/inspect-source"),h=t("../internals/internal-state"),f=h.enforce,g=h.get,y=String,b=Object.defineProperty,v=s("".slice),w=s("".replace),S=s([].join),N=i&&!a((function(){return b((function(){}),"length",{value:8}).length!==8})),D=String(String).split("String"),F=r.exports=function(G,P,U){v(y(P),0,7)==="Symbol("&&(P="["+w(y(P),/^Symbol\(([^)]*)\)/,"$1")+"]"),U&&U.getter&&(P="get "+P),U&&U.setter&&(P="set "+P),(!l(G,"name")||c&&G.name!==P)&&(i?b(G,"name",{value:P,configurable:!0}):G.name=P),N&&U&&l(U,"arity")&&G.length!==U.arity&&b(G,"length",{value:U.arity});try{U&&l(U,"constructor")&&U.constructor?i&&b(G,"prototype",{writable:!1}):G.prototype&&(G.prototype=void 0)}catch{}var q=f(G);return l(q,"source")||(q.source=S(D,typeof P=="string"?P:"")),G};Function.prototype.toString=F((function(){return u(this)&&g(this).source||p(this)}),"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(t,r,o){var s=Math.ceil,a=Math.floor;r.exports=Math.trunc||function(u){var l=+u;return(l>0?a:s)(l)}},{}],302:[function(t,r,o){var s,a,u,l,i,c=t("../internals/global"),p=t("../internals/function-bind-context"),h=t("../internals/object-get-own-property-descriptor").f,f=t("../internals/task").set,g=t("../internals/queue"),y=t("../internals/engine-is-ios"),b=t("../internals/engine-is-ios-pebble"),v=t("../internals/engine-is-webos-webkit"),w=t("../internals/engine-is-node"),S=c.MutationObserver||c.WebKitMutationObserver,N=c.document,D=c.process,F=c.Promise,G=h(c,"queueMicrotask"),P=G&&G.value;if(!P){var U=new g,q=function(){var R,I;for(w&&(R=D.domain)&&R.exit();I=U.get();)try{I()}catch(T){throw U.head&&s(),T}R&&R.enter()};y||w||v||!S||!N?!b&&F&&F.resolve?((l=F.resolve(void 0)).constructor=F,i=p(l.then,l),s=function(){i(q)}):w?s=function(){D.nextTick(q)}:(f=p(f,c),s=function(){f(q)}):(a=!0,u=N.createTextNode(""),new S(q).observe(u,{characterData:!0}),s=function(){u.data=a=!a}),P=function(R){U.head||s(),U.add(R)}}r.exports=P},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(t,r,o){var s=t("../internals/a-callable"),a=TypeError,u=function(l){var i,c;this.promise=new l((function(p,h){if(i!==void 0||c!==void 0)throw new a("Bad Promise constructor");i=p,c=h})),this.resolve=s(i),this.reject=s(c)};r.exports.f=function(l){return new u(l)}},{"../internals/a-callable":222}],304:[function(t,r,o){var s=t("../internals/is-regexp"),a=TypeError;r.exports=function(u){if(s(u))throw new a("The method doesn't accept regular expressions");return u}},{"../internals/is-regexp":291}],305:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/function-uncurry-this"),u=t("../internals/function-call"),l=t("../internals/fails"),i=t("../internals/object-keys"),c=t("../internals/object-get-own-property-symbols"),p=t("../internals/object-property-is-enumerable"),h=t("../internals/to-object"),f=t("../internals/indexed-object"),g=Object.assign,y=Object.defineProperty,b=a([].concat);r.exports=!g||l((function(){if(s&&g({b:1},g(y({},"a",{enumerable:!0,get:function(){y(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var v={},w={},S=Symbol("assign detection");return v[S]=7,"abcdefghijklmnopqrst".split("").forEach((function(N){w[N]=N})),g({},v)[S]!==7||i(g({},w)).join("")!=="abcdefghijklmnopqrst"}))?function(v,w){for(var S=h(v),N=arguments.length,D=1,F=c.f,G=p.f;N>D;)for(var P,U=f(arguments[D++]),q=F?b(i(U),F(U)):i(U),R=q.length,I=0;R>I;)P=q[I++],s&&!u(G,U,P)||(S[P]=U[P]);return S}:g},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(t,r,o){var s,a=t("../internals/an-object"),u=t("../internals/object-define-properties"),l=t("../internals/enum-bug-keys"),i=t("../internals/hidden-keys"),c=t("../internals/html"),p=t("../internals/document-create-element"),h=t("../internals/shared-key"),f=h("IE_PROTO"),g=function(){},y=function(w){return"<script>"+w+"<\/script>"},b=function(w){w.write(y("")),w.close();var S=w.parentWindow.Object;return w=null,S},v=function(){try{s=new ActiveXObject("htmlfile")}catch{}var w,S;v=typeof document<"u"?document.domain&&s?b(s):((S=p("iframe")).style.display="none",c.appendChild(S),S.src="javascript:",(w=S.contentWindow.document).open(),w.write(y("document.F=Object")),w.close(),w.F):b(s);for(var N=l.length;N--;)delete v.prototype[l[N]];return v()};i[f]=!0,r.exports=Object.create||function(w,S){var N;return w!==null?(g.prototype=a(w),N=new g,g.prototype=null,N[f]=w):N=v(),S===void 0?N:u.f(N,S)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/v8-prototype-define-bug"),u=t("../internals/object-define-property"),l=t("../internals/an-object"),i=t("../internals/to-indexed-object"),c=t("../internals/object-keys");o.f=s&&!a?Object.defineProperties:function(p,h){l(p);for(var f,g=i(h),y=c(h),b=y.length,v=0;b>v;)u.f(p,f=y[v++],g[f]);return p}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/ie8-dom-define"),u=t("../internals/v8-prototype-define-bug"),l=t("../internals/an-object"),i=t("../internals/to-property-key"),c=TypeError,p=Object.defineProperty,h=Object.getOwnPropertyDescriptor;o.f=s?u?function(f,g,y){if(l(f),g=i(g),l(y),typeof f=="function"&&g==="prototype"&&"value"in y&&"writable"in y&&!y.writable){var b=h(f,g);b&&b.writable&&(f[g]=y.value,y={configurable:"configurable"in y?y.configurable:b.configurable,enumerable:"enumerable"in y?y.enumerable:b.enumerable,writable:!1})}return p(f,g,y)}:p:function(f,g,y){if(l(f),g=i(g),l(y),a)try{return p(f,g,y)}catch{}if("get"in y||"set"in y)throw new c("Accessors not supported");return"value"in y&&(f[g]=y.value),f}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/function-call"),u=t("../internals/object-property-is-enumerable"),l=t("../internals/create-property-descriptor"),i=t("../internals/to-indexed-object"),c=t("../internals/to-property-key"),p=t("../internals/has-own-property"),h=t("../internals/ie8-dom-define"),f=Object.getOwnPropertyDescriptor;o.f=s?f:function(g,y){if(g=i(g),y=c(y),h)try{return f(g,y)}catch{}if(p(g,y))return l(!a(u.f,g,y),g[y])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(t,r,o){var s=t("../internals/classof-raw"),a=t("../internals/to-indexed-object"),u=t("../internals/object-get-own-property-names").f,l=t("../internals/array-slice-simple"),i=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];r.exports.f=function(c){return i&&s(c)==="Window"?(function(p){try{return u(p)}catch{return l(i)}})(c):u(a(c))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(t,r,o){var s=t("../internals/object-keys-internal"),a=t("../internals/enum-bug-keys").concat("length","prototype");o.f=Object.getOwnPropertyNames||function(u){return s(u,a)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(t,r,o){o.f=Object.getOwnPropertySymbols},{}],313:[function(t,r,o){var s=t("../internals/has-own-property"),a=t("../internals/is-callable"),u=t("../internals/to-object"),l=t("../internals/shared-key"),i=t("../internals/correct-prototype-getter"),c=l("IE_PROTO"),p=Object,h=p.prototype;r.exports=i?p.getPrototypeOf:function(f){var g=u(f);if(s(g,c))return g[c];var y=g.constructor;return a(y)&&g instanceof y?y.prototype:g instanceof p?h:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(t,r,o){var s=t("../internals/function-uncurry-this");r.exports=s({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=t("../internals/has-own-property"),u=t("../internals/to-indexed-object"),l=t("../internals/array-includes").indexOf,i=t("../internals/hidden-keys"),c=s([].push);r.exports=function(p,h){var f,g=u(p),y=0,b=[];for(f in g)!a(i,f)&&a(g,f)&&c(b,f);for(;h.length>y;)a(g,f=h[y++])&&(~l(b,f)||c(b,f));return b}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(t,r,o){var s=t("../internals/object-keys-internal"),a=t("../internals/enum-bug-keys");r.exports=Object.keys||function(u){return s(u,a)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(t,r,o){var s={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,u=a&&!s.call({1:2},1);o.f=u?function(l){var i=a(this,l);return!!i&&i.enumerable}:s},{}],318:[function(t,r,o){var s=t("../internals/function-uncurry-this-accessor"),a=t("../internals/an-object"),u=t("../internals/a-possible-prototype");r.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var l,i=!1,c={};try{(l=s(Object.prototype,"__proto__","set"))(c,[]),i=c instanceof Array}catch{}return function(p,h){return a(p),u(h),i?l(p,h):p.__proto__=h,p}})():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/fails"),u=t("../internals/function-uncurry-this"),l=t("../internals/object-get-prototype-of"),i=t("../internals/object-keys"),c=t("../internals/to-indexed-object"),p=u(t("../internals/object-property-is-enumerable").f),h=u([].push),f=s&&a((function(){var y=Object.create(null);return y[2]=2,!p(y,2)})),g=function(y){return function(b){for(var v,w=c(b),S=i(w),N=f&&l(w)===null,D=S.length,F=0,G=[];D>F;)v=S[F++],s&&!(N?v in w:p(w,v))||h(G,y?[v,w[v]]:w[v]);return G}};r.exports={entries:g(!0),values:g(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(t,r,o){var s=t("../internals/function-call"),a=t("../internals/is-callable"),u=t("../internals/is-object"),l=TypeError;r.exports=function(i,c){var p,h;if(c==="string"&&a(p=i.toString)&&!u(h=s(p,i))||a(p=i.valueOf)&&!u(h=s(p,i))||c!=="string"&&a(p=i.toString)&&!u(h=s(p,i)))return h;throw new l("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(t,r,o){var s=t("../internals/get-built-in"),a=t("../internals/function-uncurry-this"),u=t("../internals/object-get-own-property-names"),l=t("../internals/object-get-own-property-symbols"),i=t("../internals/an-object"),c=a([].concat);r.exports=s("Reflect","ownKeys")||function(p){var h=u.f(i(p)),f=l.f;return f?c(h,f(p)):h}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(t,r,o){var s=t("../internals/global");r.exports=s},{"../internals/global":274}],323:[function(t,r,o){r.exports=function(s){try{return{error:!1,value:s()}}catch(a){return{error:!0,value:a}}}},{}],324:[function(t,r,o){var s=t("../internals/global"),a=t("../internals/promise-native-constructor"),u=t("../internals/is-callable"),l=t("../internals/is-forced"),i=t("../internals/inspect-source"),c=t("../internals/well-known-symbol"),p=t("../internals/engine-is-browser"),h=t("../internals/engine-is-deno"),f=t("../internals/is-pure"),g=t("../internals/engine-v8-version"),y=a&&a.prototype,b=c("species"),v=!1,w=u(s.PromiseRejectionEvent),S=l("Promise",(function(){var N=i(a),D=N!==String(a);if(!D&&g===66||f&&(!y.catch||!y.finally))return!0;if(!g||g<51||!/native code/.test(N)){var F=new a((function(P){P(1)})),G=function(P){P((function(){}),(function(){}))};if((F.constructor={})[b]=G,!(v=F.then((function(){}))instanceof G))return!0}return!D&&(p||h)&&!w}));r.exports={CONSTRUCTOR:S,REJECTION_EVENT:w,SUBCLASSING:v}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(t,r,o){var s=t("../internals/global");r.exports=s.Promise},{"../internals/global":274}],326:[function(t,r,o){var s=t("../internals/an-object"),a=t("../internals/is-object"),u=t("../internals/new-promise-capability");r.exports=function(l,i){if(s(l),a(i)&&i.constructor===l)return i;var c=u.f(l);return(0,c.resolve)(i),c.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(t,r,o){var s=t("../internals/promise-native-constructor"),a=t("../internals/check-correctness-of-iteration"),u=t("../internals/promise-constructor-detection").CONSTRUCTOR;r.exports=u||!a((function(l){s.all(l).then(void 0,(function(){}))}))},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(t,r,o){var s=function(){this.head=null,this.tail=null};s.prototype={add:function(a){var u={item:a,next:null},l=this.tail;l?l.next=u:this.head=u,this.tail=u},get:function(){var a=this.head;if(a)return(this.head=a.next)===null&&(this.tail=null),a.item}},r.exports=s},{}],329:[function(t,r,o){var s=t("../internals/is-null-or-undefined"),a=TypeError;r.exports=function(u){if(s(u))throw new a("Can't call method on "+u);return u}},{"../internals/is-null-or-undefined":288}],330:[function(t,r,o){var s=t("../internals/get-built-in"),a=t("../internals/define-built-in-accessor"),u=t("../internals/well-known-symbol"),l=t("../internals/descriptors"),i=u("species");r.exports=function(c){var p=s(c);l&&p&&!p[i]&&a(p,i,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(t,r,o){var s=t("../internals/object-define-property").f,a=t("../internals/has-own-property"),u=t("../internals/well-known-symbol")("toStringTag");r.exports=function(l,i,c){l&&!c&&(l=l.prototype),l&&!a(l,u)&&s(l,u,{configurable:!0,value:i})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(t,r,o){var s=t("../internals/shared"),a=t("../internals/uid"),u=s("keys");r.exports=function(l){return u[l]||(u[l]=a(l))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(t,r,o){var s=t("../internals/global"),a=t("../internals/define-global-property"),u=s["__core-js_shared__"]||a("__core-js_shared__",{});r.exports=u},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(t,r,o){var s=t("../internals/is-pure"),a=t("../internals/shared-store");(r.exports=function(u,l){return a[u]||(a[u]=l!==void 0?l:{})})("versions",[]).push({version:"3.33.0",mode:s?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(t,r,o){var s=t("../internals/an-object"),a=t("../internals/a-constructor"),u=t("../internals/is-null-or-undefined"),l=t("../internals/well-known-symbol")("species");r.exports=function(i,c){var p,h=s(i).constructor;return h===void 0||u(p=s(h)[l])?c:a(p)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(t,r,o){var s=t("../internals/engine-v8-version"),a=t("../internals/fails"),u=t("../internals/global").String;r.exports=!!Object.getOwnPropertySymbols&&!a((function(){var l=Symbol("symbol detection");return!u(l)||!(Object(l)instanceof Symbol)||!Symbol.sham&&s&&s<41}))},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(t,r,o){var s=t("../internals/function-call"),a=t("../internals/get-built-in"),u=t("../internals/well-known-symbol"),l=t("../internals/define-built-in");r.exports=function(){var i=a("Symbol"),c=i&&i.prototype,p=c&&c.valueOf,h=u("toPrimitive");c&&!c[h]&&l(c,h,(function(f){return s(p,this)}),{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(t,r,o){var s=t("../internals/symbol-constructor-detection");r.exports=s&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(t,r,o){var s,a,u,l,i=t("../internals/global"),c=t("../internals/function-apply"),p=t("../internals/function-bind-context"),h=t("../internals/is-callable"),f=t("../internals/has-own-property"),g=t("../internals/fails"),y=t("../internals/html"),b=t("../internals/array-slice"),v=t("../internals/document-create-element"),w=t("../internals/validate-arguments-length"),S=t("../internals/engine-is-ios"),N=t("../internals/engine-is-node"),D=i.setImmediate,F=i.clearImmediate,G=i.process,P=i.Dispatch,U=i.Function,q=i.MessageChannel,R=i.String,I=0,T={};g((function(){s=i.location}));var L=function(A){if(f(T,A)){var C=T[A];delete T[A],C()}},E=function(A){return function(){L(A)}},x=function(A){L(A.data)},k=function(A){i.postMessage(R(A),s.protocol+"//"+s.host)};D&&F||(D=function(A){w(arguments.length,1);var C=h(A)?A:U(A),j=b(arguments,1);return T[++I]=function(){c(C,void 0,j)},a(I),I},F=function(A){delete T[A]},N?a=function(A){G.nextTick(E(A))}:P&&P.now?a=function(A){P.now(E(A))}:q&&!S?(l=(u=new q).port2,u.port1.onmessage=x,a=p(l.postMessage,l)):i.addEventListener&&h(i.postMessage)&&!i.importScripts&&s&&s.protocol!=="file:"&&!g(k)?(a=k,i.addEventListener("message",x,!1)):a="onreadystatechange"in v("script")?function(A){y.appendChild(v("script")).onreadystatechange=function(){y.removeChild(this),L(A)}}:function(A){setTimeout(E(A),0)}),r.exports={set:D,clear:F}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(t,r,o){var s=t("../internals/to-integer-or-infinity"),a=Math.max,u=Math.min;r.exports=function(l,i){var c=s(l);return c<0?a(c+i,0):u(c,i)}},{"../internals/to-integer-or-infinity":342}],341:[function(t,r,o){var s=t("../internals/indexed-object"),a=t("../internals/require-object-coercible");r.exports=function(u){return s(a(u))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(t,r,o){var s=t("../internals/math-trunc");r.exports=function(a){var u=+a;return u!=u||u===0?0:s(u)}},{"../internals/math-trunc":301}],343:[function(t,r,o){var s=t("../internals/to-integer-or-infinity"),a=Math.min;r.exports=function(u){return u>0?a(s(u),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(t,r,o){var s=t("../internals/require-object-coercible"),a=Object;r.exports=function(u){return a(s(u))}},{"../internals/require-object-coercible":329}],345:[function(t,r,o){var s=t("../internals/function-call"),a=t("../internals/is-object"),u=t("../internals/is-symbol"),l=t("../internals/get-method"),i=t("../internals/ordinary-to-primitive"),c=t("../internals/well-known-symbol"),p=TypeError,h=c("toPrimitive");r.exports=function(f,g){if(!a(f)||u(f))return f;var y,b=l(f,h);if(b){if(g===void 0&&(g="default"),y=s(b,f,g),!a(y)||u(y))return y;throw new p("Can't convert object to primitive value")}return g===void 0&&(g="number"),i(f,g)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(t,r,o){var s=t("../internals/to-primitive"),a=t("../internals/is-symbol");r.exports=function(u){var l=s(u,"string");return a(l)?l:l+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(t,r,o){var s={};s[t("../internals/well-known-symbol")("toStringTag")]="z",r.exports=String(s)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(t,r,o){var s=t("../internals/classof"),a=String;r.exports=function(u){if(s(u)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return a(u)}},{"../internals/classof":236}],349:[function(t,r,o){var s=String;r.exports=function(a){try{return s(a)}catch{return"Object"}}},{}],350:[function(t,r,o){var s=t("../internals/function-uncurry-this"),a=0,u=Math.random(),l=s(1 .toString);r.exports=function(i){return"Symbol("+(i===void 0?"":i)+")_"+l(++a+u,36)}},{"../internals/function-uncurry-this":268}],351:[function(t,r,o){var s=t("../internals/symbol-constructor-detection");r.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(t,r,o){var s=t("../internals/descriptors"),a=t("../internals/fails");r.exports=s&&a((function(){return Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype!==42}))},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(t,r,o){var s=TypeError;r.exports=function(a,u){if(a<u)throw new s("Not enough arguments");return a}},{}],354:[function(t,r,o){var s=t("../internals/global"),a=t("../internals/is-callable"),u=s.WeakMap;r.exports=a(u)&&/native code/.test(String(u))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(t,r,o){var s=t("../internals/path"),a=t("../internals/has-own-property"),u=t("../internals/well-known-symbol-wrapped"),l=t("../internals/object-define-property").f;r.exports=function(i){var c=s.Symbol||(s.Symbol={});a(c,i)||l(c,i,{value:u.f(i)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(t,r,o){var s=t("../internals/well-known-symbol");o.f=s},{"../internals/well-known-symbol":357}],357:[function(t,r,o){var s=t("../internals/global"),a=t("../internals/shared"),u=t("../internals/has-own-property"),l=t("../internals/uid"),i=t("../internals/symbol-constructor-detection"),c=t("../internals/use-symbol-as-uid"),p=s.Symbol,h=a("wks"),f=c?p.for||p:p&&p.withoutSetter||l;r.exports=function(g){return u(h,g)||(h[g]=i&&u(p,g)?p[g]:f("Symbol."+g)),h[g]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/array-iteration").findIndex,u=t("../internals/add-to-unscopables"),l=!0;"findIndex"in[]&&Array(1).findIndex((function(){l=!1})),s({target:"Array",proto:!0,forced:l},{findIndex:function(i){return a(this,i,arguments.length>1?arguments[1]:void 0)}}),u("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/array-iteration").find,u=t("../internals/add-to-unscopables"),l=!0;"find"in[]&&Array(1).find((function(){l=!1})),s({target:"Array",proto:!0,forced:l},{find:function(i){return a(this,i,arguments.length>1?arguments[1]:void 0)}}),u("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/array-includes").includes,u=t("../internals/fails"),l=t("../internals/add-to-unscopables");s({target:"Array",proto:!0,forced:u((function(){return!Array(1).includes()}))},{includes:function(i){return a(this,i,arguments.length>1?arguments[1]:void 0)}}),l("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(t,r,o){var s=t("../internals/to-indexed-object"),a=t("../internals/add-to-unscopables"),u=t("../internals/iterators"),l=t("../internals/internal-state"),i=t("../internals/object-define-property").f,c=t("../internals/iterator-define"),p=t("../internals/create-iter-result-object"),h=t("../internals/is-pure"),f=t("../internals/descriptors"),g=l.set,y=l.getterFor("Array Iterator");r.exports=c(Array,"Array",(function(v,w){g(this,{type:"Array Iterator",target:s(v),index:0,kind:w})}),(function(){var v=y(this),w=v.target,S=v.kind,N=v.index++;if(!w||N>=w.length)return v.target=void 0,p(void 0,!0);switch(S){case"keys":return p(N,!1);case"values":return p(w[N],!1)}return p([N,w[N]],!1)}),"values");var b=u.Arguments=u.Array;if(a("keys"),a("values"),a("entries"),!h&&f&&b.name!=="values")try{i(b,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/get-built-in"),u=t("../internals/function-apply"),l=t("../internals/function-call"),i=t("../internals/function-uncurry-this"),c=t("../internals/fails"),p=t("../internals/is-callable"),h=t("../internals/is-symbol"),f=t("../internals/array-slice"),g=t("../internals/get-json-replacer-function"),y=t("../internals/symbol-constructor-detection"),b=String,v=a("JSON","stringify"),w=i(/./.exec),S=i("".charAt),N=i("".charCodeAt),D=i("".replace),F=i(1 .toString),G=/[\uD800-\uDFFF]/g,P=/^[\uD800-\uDBFF]$/,U=/^[\uDC00-\uDFFF]$/,q=!y||c((function(){var L=a("Symbol")("stringify detection");return v([L])!=="[null]"||v({a:L})!=="{}"||v(Object(L))!=="{}"})),R=c((function(){return v("\uDF06\uD834")!=='"\\udf06\\ud834"'||v("\uDEAD")!=='"\\udead"'})),I=function(L,E){var x=f(arguments),k=g(E);if(p(k)||L!==void 0&&!h(L))return x[1]=function(A,C){if(p(k)&&(C=l(k,this,b(A),C)),!h(C))return C},u(v,null,x)},T=function(L,E,x){var k=S(x,E-1),A=S(x,E+1);return w(P,L)&&!w(U,A)||w(U,L)&&!w(P,k)?"\\u"+F(N(L,0),16):L};v&&s({target:"JSON",stat:!0,arity:3,forced:q||R},{stringify:function(L,E,x){var k=f(arguments),A=u(q?I:v,null,k);return R&&typeof A=="string"?D(A,G,T):A}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(t,r,o){t("../internals/export")({target:"Number",stat:!0},{isNaN:function(s){return s!=s}})},{"../internals/export":259}],364:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/object-assign");s({target:"Object",stat:!0,arity:2,forced:Object.assign!==a},{assign:a})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/symbol-constructor-detection"),u=t("../internals/fails"),l=t("../internals/object-get-own-property-symbols"),i=t("../internals/to-object");s({target:"Object",stat:!0,forced:!a||u((function(){l.f(1)}))},{getOwnPropertySymbols:function(c){var p=l.f;return p?p(i(c)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/to-object"),u=t("../internals/object-keys");s({target:"Object",stat:!0,forced:t("../internals/fails")((function(){u(1)}))},{keys:function(l){return u(a(l))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/object-to-array").values;s({target:"Object",stat:!0},{values:function(u){return a(u)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/function-call"),u=t("../internals/a-callable"),l=t("../internals/new-promise-capability"),i=t("../internals/perform"),c=t("../internals/iterate");s({target:"Promise",stat:!0,forced:t("../internals/promise-statics-incorrect-iteration")},{all:function(p){var h=this,f=l.f(h),g=f.resolve,y=f.reject,b=i((function(){var v=u(h.resolve),w=[],S=0,N=1;c(p,(function(D){var F=S++,G=!1;N++,a(v,h,D).then((function(P){G||(G=!0,w[F]=P,--N||g(w))}),y)})),--N||g(w)}));return b.error&&y(b.value),f.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/is-pure"),u=t("../internals/promise-constructor-detection").CONSTRUCTOR,l=t("../internals/promise-native-constructor"),i=t("../internals/get-built-in"),c=t("../internals/is-callable"),p=t("../internals/define-built-in"),h=l&&l.prototype;if(s({target:"Promise",proto:!0,forced:u,real:!0},{catch:function(g){return this.then(void 0,g)}}),!a&&c(l)){var f=i("Promise").prototype.catch;h.catch!==f&&p(h,"catch",f,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(t,r,o){var s,a,u,l=t("../internals/export"),i=t("../internals/is-pure"),c=t("../internals/engine-is-node"),p=t("../internals/global"),h=t("../internals/function-call"),f=t("../internals/define-built-in"),g=t("../internals/object-set-prototype-of"),y=t("../internals/set-to-string-tag"),b=t("../internals/set-species"),v=t("../internals/a-callable"),w=t("../internals/is-callable"),S=t("../internals/is-object"),N=t("../internals/an-instance"),D=t("../internals/species-constructor"),F=t("../internals/task").set,G=t("../internals/microtask"),P=t("../internals/host-report-errors"),U=t("../internals/perform"),q=t("../internals/queue"),R=t("../internals/internal-state"),I=t("../internals/promise-native-constructor"),T=t("../internals/promise-constructor-detection"),L=t("../internals/new-promise-capability"),E=T.CONSTRUCTOR,x=T.REJECTION_EVENT,k=T.SUBCLASSING,A=R.getterFor("Promise"),C=R.set,j=I&&I.prototype,B=I,O=j,H=p.TypeError,X=p.document,et=p.process,V=L.f,tt=V,$=!!(X&&X.createEvent&&p.dispatchEvent),z=function(ft){var gt;return!(!S(ft)||!w(gt=ft.then))&&gt},Z=function(ft,gt){var wt,yt,Et,Mt=gt.value,qt=gt.state===1,Tt=qt?ft.ok:ft.fail,It=ft.resolve,Vt=ft.reject,Kt=ft.domain;try{Tt?(qt||(gt.rejection===2&&rt(gt),gt.rejection=1),Tt===!0?wt=Mt:(Kt&&Kt.enter(),wt=Tt(Mt),Kt&&(Kt.exit(),Et=!0)),wt===ft.promise?Vt(new H("Promise-chain cycle")):(yt=z(wt))?h(yt,wt,It,Vt):It(wt)):Vt(Mt)}catch(ne){Kt&&!Et&&Kt.exit(),Vt(ne)}},it=function(ft,gt){ft.notified||(ft.notified=!0,G((function(){for(var wt,yt=ft.reactions;wt=yt.get();)Z(wt,ft);ft.notified=!1,gt&&!ft.rejection&&lt(ft)})))},mt=function(ft,gt,wt){var yt,Et;$?((yt=X.createEvent("Event")).promise=gt,yt.reason=wt,yt.initEvent(ft,!1,!0),p.dispatchEvent(yt)):yt={promise:gt,reason:wt},!x&&(Et=p["on"+ft])?Et(yt):ft==="unhandledrejection"&&P("Unhandled promise rejection",wt)},lt=function(ft){h(F,p,(function(){var gt,wt=ft.facade,yt=ft.value;if(at(ft)&&(gt=U((function(){c?et.emit("unhandledRejection",yt,wt):mt("unhandledrejection",wt,yt)})),ft.rejection=c||at(ft)?2:1,gt.error))throw gt.value}))},at=function(ft){return ft.rejection!==1&&!ft.parent},rt=function(ft){h(F,p,(function(){var gt=ft.facade;c?et.emit("rejectionHandled",gt):mt("rejectionhandled",gt,ft.value)}))},ct=function(ft,gt,wt){return function(yt){ft(gt,yt,wt)}},ot=function(ft,gt,wt){ft.done||(ft.done=!0,wt&&(ft=wt),ft.value=gt,ft.state=2,it(ft,!0))},dt=function(ft,gt,wt){if(!ft.done){ft.done=!0,wt&&(ft=wt);try{if(ft.facade===gt)throw new H("Promise can't be resolved itself");var yt=z(gt);yt?G((function(){var Et={done:!1};try{h(yt,gt,ct(dt,Et,ft),ct(ot,Et,ft))}catch(Mt){ot(Et,Mt,ft)}})):(ft.value=gt,ft.state=1,it(ft,!1))}catch(Et){ot({done:!1},Et,ft)}}};if(E&&(O=(B=function(ft){N(this,O),v(ft),h(s,this);var gt=A(this);try{ft(ct(dt,gt),ct(ot,gt))}catch(wt){ot(gt,wt)}}).prototype,(s=function(ft){C(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new q,rejection:!1,state:0,value:void 0})}).prototype=f(O,"then",(function(ft,gt){var wt=A(this),yt=V(D(this,B));return wt.parent=!0,yt.ok=!w(ft)||ft,yt.fail=w(gt)&&gt,yt.domain=c?et.domain:void 0,wt.state===0?wt.reactions.add(yt):G((function(){Z(yt,wt)})),yt.promise})),a=function(){var ft=new s,gt=A(ft);this.promise=ft,this.resolve=ct(dt,gt),this.reject=ct(ot,gt)},L.f=V=function(ft){return ft===B||ft===void 0?new a(ft):tt(ft)},!i&&w(I)&&j!==Object.prototype)){u=j.then,k||f(j,"then",(function(ft,gt){var wt=this;return new B((function(yt,Et){h(u,wt,yt,Et)})).then(ft,gt)}),{unsafe:!0});try{delete j.constructor}catch{}g&&g(j,O)}l({global:!0,constructor:!0,wrap:!0,forced:E},{Promise:B}),y(B,"Promise",!1,!0),b("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/is-pure"),u=t("../internals/promise-native-constructor"),l=t("../internals/fails"),i=t("../internals/get-built-in"),c=t("../internals/is-callable"),p=t("../internals/species-constructor"),h=t("../internals/promise-resolve"),f=t("../internals/define-built-in"),g=u&&u.prototype;if(s({target:"Promise",proto:!0,real:!0,forced:!!u&&l((function(){g.finally.call({then:function(){}},(function(){}))}))},{finally:function(b){var v=p(this,i("Promise")),w=c(b);return this.then(w?function(S){return h(v,b()).then((function(){return S}))}:b,w?function(S){return h(v,b()).then((function(){throw S}))}:b)}}),!a&&c(u)){var y=i("Promise").prototype.finally;g.finally!==y&&f(g,"finally",y,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(t,r,o){t("../modules/es.promise.constructor"),t("../modules/es.promise.all"),t("../modules/es.promise.catch"),t("../modules/es.promise.race"),t("../modules/es.promise.reject"),t("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/function-call"),u=t("../internals/a-callable"),l=t("../internals/new-promise-capability"),i=t("../internals/perform"),c=t("../internals/iterate");s({target:"Promise",stat:!0,forced:t("../internals/promise-statics-incorrect-iteration")},{race:function(p){var h=this,f=l.f(h),g=f.reject,y=i((function(){var b=u(h.resolve);c(p,(function(v){a(b,h,v).then(f.resolve,g)}))}));return y.error&&g(y.value),f.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/function-call"),u=t("../internals/new-promise-capability");s({target:"Promise",stat:!0,forced:t("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(l){var i=u.f(this);return a(i.reject,void 0,l),i.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/get-built-in"),u=t("../internals/is-pure"),l=t("../internals/promise-native-constructor"),i=t("../internals/promise-constructor-detection").CONSTRUCTOR,c=t("../internals/promise-resolve"),p=a("Promise"),h=u&&!i;s({target:"Promise",stat:!0,forced:u||i},{resolve:function(f){return c(h&&this===p?l:this,f)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/function-uncurry-this"),u=t("../internals/to-absolute-index"),l=RangeError,i=String.fromCharCode,c=String.fromCodePoint,p=a([].join);s({target:"String",stat:!0,arity:1,forced:!!c&&c.length!==1},{fromCodePoint:function(h){for(var f,g=[],y=arguments.length,b=0;y>b;){if(f=+arguments[b++],u(f,1114111)!==f)throw new l(f+" is not a valid code point");g[b]=f<65536?i(f):i(55296+((f-=65536)>>10),f%1024+56320)}return p(g,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/function-uncurry-this"),u=t("../internals/not-a-regexp"),l=t("../internals/require-object-coercible"),i=t("../internals/to-string"),c=t("../internals/correct-is-regexp-logic"),p=a("".indexOf);s({target:"String",proto:!0,forced:!c("includes")},{includes:function(h){return!!~p(i(l(this)),i(u(h)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(t,r,o){t("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/global"),u=t("../internals/function-call"),l=t("../internals/function-uncurry-this"),i=t("../internals/is-pure"),c=t("../internals/descriptors"),p=t("../internals/symbol-constructor-detection"),h=t("../internals/fails"),f=t("../internals/has-own-property"),g=t("../internals/object-is-prototype-of"),y=t("../internals/an-object"),b=t("../internals/to-indexed-object"),v=t("../internals/to-property-key"),w=t("../internals/to-string"),S=t("../internals/create-property-descriptor"),N=t("../internals/object-create"),D=t("../internals/object-keys"),F=t("../internals/object-get-own-property-names"),G=t("../internals/object-get-own-property-names-external"),P=t("../internals/object-get-own-property-symbols"),U=t("../internals/object-get-own-property-descriptor"),q=t("../internals/object-define-property"),R=t("../internals/object-define-properties"),I=t("../internals/object-property-is-enumerable"),T=t("../internals/define-built-in"),L=t("../internals/define-built-in-accessor"),E=t("../internals/shared"),x=t("../internals/shared-key"),k=t("../internals/hidden-keys"),A=t("../internals/uid"),C=t("../internals/well-known-symbol"),j=t("../internals/well-known-symbol-wrapped"),B=t("../internals/well-known-symbol-define"),O=t("../internals/symbol-define-to-primitive"),H=t("../internals/set-to-string-tag"),X=t("../internals/internal-state"),et=t("../internals/array-iteration").forEach,V=x("hidden"),tt=X.set,$=X.getterFor("Symbol"),z=Object.prototype,Z=a.Symbol,it=Z&&Z.prototype,mt=a.RangeError,lt=a.TypeError,at=a.QObject,rt=U.f,ct=q.f,ot=G.f,dt=I.f,ft=l([].push),gt=E("symbols"),wt=E("op-symbols"),yt=E("wks"),Et=!at||!at.prototype||!at.prototype.findChild,Mt=function(le,Jt,ue){var ge=rt(z,Jt);ge&&delete z[Jt],ct(le,Jt,ue),ge&&le!==z&&ct(z,Jt,ge)},qt=c&&h((function(){return N(ct({},"a",{get:function(){return ct(this,"a",{value:7}).a}})).a!==7}))?Mt:ct,Tt=function(le,Jt){var ue=gt[le]=N(it);return tt(ue,{type:"Symbol",tag:le,description:Jt}),c||(ue.description=Jt),ue},It=function(le,Jt,ue){le===z&&It(wt,Jt,ue),y(le);var ge=v(Jt);return y(ue),f(gt,ge)?(ue.enumerable?(f(le,V)&&le[V][ge]&&(le[V][ge]=!1),ue=N(ue,{enumerable:S(0,!1)})):(f(le,V)||ct(le,V,S(1,{})),le[V][ge]=!0),qt(le,ge,ue)):ct(le,ge,ue)},Vt=function(le,Jt){y(le);var ue=b(Jt),ge=D(ue).concat(Oe(ue));return et(ge,(function(fe){c&&!u(Kt,ue,fe)||It(le,fe,ue[fe])})),le},Kt=function(le){var Jt=v(le),ue=u(dt,this,Jt);return!(this===z&&f(gt,Jt)&&!f(wt,Jt))&&(!(ue||!f(this,Jt)||!f(gt,Jt)||f(this,V)&&this[V][Jt])||ue)},ne=function(le,Jt){var ue=b(le),ge=v(Jt);if(ue!==z||!f(gt,ge)||f(wt,ge)){var fe=rt(ue,ge);return!fe||!f(gt,ge)||f(ue,V)&&ue[V][ge]||(fe.enumerable=!0),fe}},ae=function(le){var Jt=ot(b(le)),ue=[];return et(Jt,(function(ge){f(gt,ge)||f(k,ge)||ft(ue,ge)})),ue},Oe=function(le){var Jt=le===z,ue=ot(Jt?wt:b(le)),ge=[];return et(ue,(function(fe){!f(gt,fe)||Jt&&!f(z,fe)||ft(ge,gt[fe])})),ge};p||(T(it=(Z=function(){if(g(it,this))throw new lt("Symbol is not a constructor");var le=arguments.length&&arguments[0]!==void 0?w(arguments[0]):void 0,Jt=A(le),ue=function(ge){this===z&&u(ue,wt,ge),f(this,V)&&f(this[V],Jt)&&(this[V][Jt]=!1);var fe=S(1,ge);try{qt(this,Jt,fe)}catch(qe){if(!(qe instanceof mt))throw qe;Mt(this,Jt,fe)}};return c&&Et&&qt(z,Jt,{configurable:!0,set:ue}),Tt(Jt,le)}).prototype,"toString",(function(){return $(this).tag})),T(Z,"withoutSetter",(function(le){return Tt(A(le),le)})),I.f=Kt,q.f=It,R.f=Vt,U.f=ne,F.f=G.f=ae,P.f=Oe,j.f=function(le){return Tt(C(le),le)},c&&(L(it,"description",{configurable:!0,get:function(){return $(this).description}}),i||T(z,"propertyIsEnumerable",Kt,{unsafe:!0}))),s({global:!0,constructor:!0,wrap:!0,forced:!p,sham:!p},{Symbol:Z}),et(D(yt),(function(le){B(le)})),s({target:"Symbol",stat:!0,forced:!p},{useSetter:function(){Et=!0},useSimple:function(){Et=!1}}),s({target:"Object",stat:!0,forced:!p,sham:!c},{create:function(le,Jt){return Jt===void 0?N(le):Vt(N(le),Jt)},defineProperty:It,defineProperties:Vt,getOwnPropertyDescriptor:ne}),s({target:"Object",stat:!0,forced:!p},{getOwnPropertyNames:ae}),O(),H(Z,"Symbol"),k[V]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/get-built-in"),u=t("../internals/has-own-property"),l=t("../internals/to-string"),i=t("../internals/shared"),c=t("../internals/symbol-registry-detection"),p=i("string-to-symbol-registry"),h=i("symbol-to-string-registry");s({target:"Symbol",stat:!0,forced:!c},{for:function(f){var g=l(f);if(u(p,g))return p[g];var y=a("Symbol")(g);return p[g]=y,h[y]=g,y}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(t,r,o){t("../modules/es.symbol.constructor"),t("../modules/es.symbol.for"),t("../modules/es.symbol.key-for"),t("../modules/es.json.stringify"),t("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(t,r,o){var s=t("../internals/export"),a=t("../internals/has-own-property"),u=t("../internals/is-symbol"),l=t("../internals/try-to-string"),i=t("../internals/shared"),c=t("../internals/symbol-registry-detection"),p=i("symbol-to-string-registry");s({target:"Symbol",stat:!0,forced:!c},{keyFor:function(h){if(!u(h))throw new TypeError(l(h)+" is not a symbol");if(a(p,h))return p[h]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(t,r,o){function s(a){return Object.prototype.toString.call(a)}o.isArray=function(a){return Array.isArray?Array.isArray(a):s(a)==="[object Array]"},o.isBoolean=function(a){return typeof a=="boolean"},o.isNull=function(a){return a===null},o.isNullOrUndefined=function(a){return a==null},o.isNumber=function(a){return typeof a=="number"},o.isString=function(a){return typeof a=="string"},o.isSymbol=function(a){return typeof a=="symbol"},o.isUndefined=function(a){return a===void 0},o.isRegExp=function(a){return s(a)==="[object RegExp]"},o.isObject=function(a){return typeof a=="object"&&a!==null},o.isDate=function(a){return s(a)==="[object Date]"},o.isError=function(a){return s(a)==="[object Error]"||a instanceof Error},o.isFunction=function(a){return typeof a=="function"},o.isPrimitive=function(a){return a===null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||typeof a=="symbol"||a===void 0},o.isBuffer=t("buffer").Buffer.isBuffer},{buffer:220}],384:[function(t,r,o){(function(s){(function(){var a=t("elliptic"),u=t("bn.js");r.exports=function(p){return new i(p)};var l={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function i(p){this.curveType=l[p],this.curveType||(this.curveType={name:p}),this.curve=new a.ec(this.curveType.name),this.keys=void 0}function c(p,h,f){Array.isArray(p)||(p=p.toArray());var g=new s(p);if(f&&g.length<f){var y=new s(f-g.length);y.fill(0),g=s.concat([y,g])}return h?g.toString(h):g}l.p224=l.secp224r1,l.p256=l.secp256r1=l.prime256v1,l.p192=l.secp192r1=l.prime192v1,l.p384=l.secp384r1,l.p521=l.secp521r1,i.prototype.generateKeys=function(p,h){return this.keys=this.curve.genKeyPair(),this.getPublicKey(p,h)},i.prototype.computeSecret=function(p,h,f){return h=h||"utf8",s.isBuffer(p)||(p=new s(p,h)),c(this.curve.keyFromPublic(p).getPublic().mul(this.keys.getPrivate()).getX(),f,this.curveType.byteLength)},i.prototype.getPublicKey=function(p,h){var f=this.keys.getPublic(h==="compressed",!0);return h==="hybrid"&&(f[f.length-1]%2?f[0]=7:f[0]=6),c(f,p)},i.prototype.getPrivateKey=function(p){return c(this.keys.getPrivate(),p)},i.prototype.setPublicKey=function(p,h){return h=h||"utf8",s.isBuffer(p)||(p=new s(p,h)),this.keys._importPublic(p),this},i.prototype.setPrivateKey=function(p,h){h=h||"utf8",s.isBuffer(p)||(p=new s(p,h));var f=new u(p);return f=f.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(f),this}}).call(this)}).call(this,t("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(t,r,o){arguments[4][184][0].apply(o,arguments)},{buffer:188,dup:184}],386:[function(t,r,o){var s=t("inherits"),a=t("md5.js"),u=t("ripemd160"),l=t("sha.js"),i=t("cipher-base");function c(p){i.call(this,"digest"),this._hash=p}s(c,i),c.prototype._update=function(p){this._hash.update(p)},c.prototype._final=function(){return this._hash.digest()},r.exports=function(p){return(p=p.toLowerCase())==="md5"?new a:p==="rmd160"||p==="ripemd160"?new u:new c(l(p))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(t,r,o){var s=t("md5.js");r.exports=function(a){return new s().update(a).digest()}},{"md5.js":450}],388:[function(t,r,o){var s=t("inherits"),a=t("./legacy"),u=t("cipher-base"),l=t("safe-buffer").Buffer,i=t("create-hash/md5"),c=t("ripemd160"),p=t("sha.js"),h=l.alloc(128);function f(g,y){u.call(this,"digest"),typeof y=="string"&&(y=l.from(y));var b=g==="sha512"||g==="sha384"?128:64;this._alg=g,this._key=y,y.length>b?y=(g==="rmd160"?new c:p(g)).update(y).digest():y.length<b&&(y=l.concat([y,h],b));for(var v=this._ipad=l.allocUnsafe(b),w=this._opad=l.allocUnsafe(b),S=0;S<b;S++)v[S]=54^y[S],w[S]=92^y[S];this._hash=g==="rmd160"?new c:p(g),this._hash.update(v)}s(f,u),f.prototype._update=function(g){this._hash.update(g)},f.prototype._final=function(){var g=this._hash.digest();return(this._alg==="rmd160"?new c:p(this._alg)).update(this._opad).update(g).digest()},r.exports=function(g,y){return(g=g.toLowerCase())==="rmd160"||g==="ripemd160"?new f("rmd160",y):g==="md5"?new a(i,y):new f(g,y)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(t,r,o){var s=t("inherits"),a=t("safe-buffer").Buffer,u=t("cipher-base"),l=a.alloc(128);function i(c,p){u.call(this,"digest"),typeof p=="string"&&(p=a.from(p)),this._alg=c,this._key=p,p.length>64?p=c(p):p.length<64&&(p=a.concat([p,l],64));for(var h=this._ipad=a.allocUnsafe(64),f=this._opad=a.allocUnsafe(64),g=0;g<64;g++)h[g]=54^p[g],f[g]=92^p[g];this._hash=[h]}s(i,u),i.prototype._update=function(c){this._hash.push(c)},i.prototype._final=function(){var c=this._alg(a.concat(this._hash));return this._alg(a.concat([this._opad,c]))},r.exports=i},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(t,r,o){o.randomBytes=o.rng=o.pseudoRandomBytes=o.prng=t("randombytes"),o.createHash=o.Hash=t("create-hash"),o.createHmac=o.Hmac=t("create-hmac");var s=t("browserify-sign/algos"),a=Object.keys(s),u=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(a);o.getHashes=function(){return u};var l=t("pbkdf2");o.pbkdf2=l.pbkdf2,o.pbkdf2Sync=l.pbkdf2Sync;var i=t("browserify-cipher");o.Cipher=i.Cipher,o.createCipher=i.createCipher,o.Cipheriv=i.Cipheriv,o.createCipheriv=i.createCipheriv,o.Decipher=i.Decipher,o.createDecipher=i.createDecipher,o.Decipheriv=i.Decipheriv,o.createDecipheriv=i.createDecipheriv,o.getCiphers=i.getCiphers,o.listCiphers=i.listCiphers;var c=t("diffie-hellman");o.DiffieHellmanGroup=c.DiffieHellmanGroup,o.createDiffieHellmanGroup=c.createDiffieHellmanGroup,o.getDiffieHellman=c.getDiffieHellman,o.createDiffieHellman=c.createDiffieHellman,o.DiffieHellman=c.DiffieHellman;var p=t("browserify-sign");o.createSign=p.createSign,o.Sign=p.Sign,o.createVerify=p.createVerify,o.Verify=p.Verify,o.createECDH=t("create-ecdh");var h=t("public-encrypt");o.publicEncrypt=h.publicEncrypt,o.privateEncrypt=h.privateEncrypt,o.publicDecrypt=h.publicDecrypt,o.privateDecrypt=h.privateDecrypt;var f=t("randomfill");o.randomFill=f.randomFill,o.randomFillSync=f.randomFillSync,o.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},o.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(t,r,o){(function(s,a){typeof o=="object"&&r!==void 0?r.exports=a():(s=typeof globalThis<"u"?globalThis:s||self).dayjs=a()})(void 0,(function(){var s=6e4,a=36e5,u="millisecond",l="second",i="minute",c="hour",p="day",h="week",f="month",g="quarter",y="year",b="date",v="Invalid Date",w=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(x){var k=["th","st","nd","rd"],A=x%100;return"["+x+(k[(A-20)%10]||k[A]||k[0])+"]"}},D=function(x,k,A){var C=String(x);return!C||C.length>=k?x:""+Array(k+1-C.length).join(A)+x},F={s:D,z:function(x){var k=-x.utcOffset(),A=Math.abs(k),C=Math.floor(A/60),j=A%60;return(k<=0?"+":"-")+D(C,2,"0")+":"+D(j,2,"0")},m:function x(k,A){if(k.date()<A.date())return-x(A,k);var C=12*(A.year()-k.year())+(A.month()-k.month()),j=k.clone().add(C,f),B=A-j<0,O=k.clone().add(C+(B?-1:1),f);return+(-(C+(A-j)/(B?j-O:O-j))||0)},a:function(x){return x<0?Math.ceil(x)||0:Math.floor(x)},p:function(x){return{M:f,y,w:h,d:p,D:b,h:c,m:i,s:l,ms:u,Q:g}[x]||String(x||"").toLowerCase().replace(/s$/,"")},u:function(x){return x===void 0}},G="en",P={};P[G]=N;var U="$isDayjsObject",q=function(x){return x instanceof L||!(!x||!x[U])},R=function x(k,A,C){var j;if(!k)return G;if(typeof k=="string"){var B=k.toLowerCase();P[B]&&(j=B),A&&(P[B]=A,j=B);var O=k.split("-");if(!j&&O.length>1)return x(O[0])}else{var H=k.name;P[H]=k,j=H}return!C&&j&&(G=j),j||!C&&G},I=function(x,k){if(q(x))return x.clone();var A=typeof k=="object"?k:{};return A.date=x,A.args=arguments,new L(A)},T=F;T.l=R,T.i=q,T.w=function(x,k){return I(x,{locale:k.$L,utc:k.$u,x:k.$x,$offset:k.$offset})};var L=(function(){function x(A){this.$L=R(A.locale,null,!0),this.parse(A),this.$x=this.$x||A.x||{},this[U]=!0}var k=x.prototype;return k.parse=function(A){this.$d=(function(C){var j=C.date,B=C.utc;if(j===null)return new Date(NaN);if(T.u(j))return new Date;if(j instanceof Date)return new Date(j);if(typeof j=="string"&&!/Z$/i.test(j)){var O=j.match(w);if(O){var H=O[2]-1||0,X=(O[7]||"0").substring(0,3);return B?new Date(Date.UTC(O[1],H,O[3]||1,O[4]||0,O[5]||0,O[6]||0,X)):new Date(O[1],H,O[3]||1,O[4]||0,O[5]||0,O[6]||0,X)}}return new Date(j)})(A),this.init()},k.init=function(){var A=this.$d;this.$y=A.getFullYear(),this.$M=A.getMonth(),this.$D=A.getDate(),this.$W=A.getDay(),this.$H=A.getHours(),this.$m=A.getMinutes(),this.$s=A.getSeconds(),this.$ms=A.getMilliseconds()},k.$utils=function(){return T},k.isValid=function(){return this.$d.toString()!==v},k.isSame=function(A,C){var j=I(A);return this.startOf(C)<=j&&j<=this.endOf(C)},k.isAfter=function(A,C){return I(A)<this.startOf(C)},k.isBefore=function(A,C){return this.endOf(C)<I(A)},k.$g=function(A,C,j){return T.u(A)?this[C]:this.set(j,A)},k.unix=function(){return Math.floor(this.valueOf()/1e3)},k.valueOf=function(){return this.$d.getTime()},k.startOf=function(A,C){var j=this,B=!!T.u(C)||C,O=T.p(A),H=function(it,mt){var lt=T.w(j.$u?Date.UTC(j.$y,mt,it):new Date(j.$y,mt,it),j);return B?lt:lt.endOf(p)},X=function(it,mt){return T.w(j.toDate()[it].apply(j.toDate("s"),(B?[0,0,0,0]:[23,59,59,999]).slice(mt)),j)},et=this.$W,V=this.$M,tt=this.$D,$="set"+(this.$u?"UTC":"");switch(O){case y:return B?H(1,0):H(31,11);case f:return B?H(1,V):H(0,V+1);case h:var z=this.$locale().weekStart||0,Z=(et<z?et+7:et)-z;return H(B?tt-Z:tt+(6-Z),V);case p:case b:return X($+"Hours",0);case c:return X($+"Minutes",1);case i:return X($+"Seconds",2);case l:return X($+"Milliseconds",3);default:return this.clone()}},k.endOf=function(A){return this.startOf(A,!1)},k.$set=function(A,C){var j,B=T.p(A),O="set"+(this.$u?"UTC":""),H=(j={},j[p]=O+"Date",j[b]=O+"Date",j[f]=O+"Month",j[y]=O+"FullYear",j[c]=O+"Hours",j[i]=O+"Minutes",j[l]=O+"Seconds",j[u]=O+"Milliseconds",j)[B],X=B===p?this.$D+(C-this.$W):C;if(B===f||B===y){var et=this.clone().set(b,1);et.$d[H](X),et.init(),this.$d=et.set(b,Math.min(this.$D,et.daysInMonth())).$d}else H&&this.$d[H](X);return this.init(),this},k.set=function(A,C){return this.clone().$set(A,C)},k.get=function(A){return this[T.p(A)]()},k.add=function(A,C){var j,B=this;A=Number(A);var O=T.p(C),H=function(V){var tt=I(B);return T.w(tt.date(tt.date()+Math.round(V*A)),B)};if(O===f)return this.set(f,this.$M+A);if(O===y)return this.set(y,this.$y+A);if(O===p)return H(1);if(O===h)return H(7);var X=(j={},j[i]=s,j[c]=a,j[l]=1e3,j)[O]||1,et=this.$d.getTime()+A*X;return T.w(et,this)},k.subtract=function(A,C){return this.add(-1*A,C)},k.format=function(A){var C=this,j=this.$locale();if(!this.isValid())return j.invalidDate||v;var B=A||"YYYY-MM-DDTHH:mm:ssZ",O=T.z(this),H=this.$H,X=this.$m,et=this.$M,V=j.weekdays,tt=j.months,$=j.meridiem,z=function(mt,lt,at,rt){return mt&&(mt[lt]||mt(C,B))||at[lt].slice(0,rt)},Z=function(mt){return T.s(H%12||12,mt,"0")},it=$||function(mt,lt,at){var rt=mt<12?"AM":"PM";return at?rt.toLowerCase():rt};return B.replace(S,(function(mt,lt){return lt||(function(at){switch(at){case"YY":return String(C.$y).slice(-2);case"YYYY":return T.s(C.$y,4,"0");case"M":return et+1;case"MM":return T.s(et+1,2,"0");case"MMM":return z(j.monthsShort,et,tt,3);case"MMMM":return z(tt,et);case"D":return C.$D;case"DD":return T.s(C.$D,2,"0");case"d":return String(C.$W);case"dd":return z(j.weekdaysMin,C.$W,V,2);case"ddd":return z(j.weekdaysShort,C.$W,V,3);case"dddd":return V[C.$W];case"H":return String(H);case"HH":return T.s(H,2,"0");case"h":return Z(1);case"hh":return Z(2);case"a":return it(H,X,!0);case"A":return it(H,X,!1);case"m":return String(X);case"mm":return T.s(X,2,"0");case"s":return String(C.$s);case"ss":return T.s(C.$s,2,"0");case"SSS":return T.s(C.$ms,3,"0");case"Z":return O}return null})(mt)||O.replace(":","")}))},k.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},k.diff=function(A,C,j){var B,O=this,H=T.p(C),X=I(A),et=(X.utcOffset()-this.utcOffset())*s,V=this-X,tt=function(){return T.m(O,X)};switch(H){case y:B=tt()/12;break;case f:B=tt();break;case g:B=tt()/3;break;case h:B=(V-et)/6048e5;break;case p:B=(V-et)/864e5;break;case c:B=V/a;break;case i:B=V/s;break;case l:B=V/1e3;break;default:B=V}return j?B:T.a(B)},k.daysInMonth=function(){return this.endOf(f).$D},k.$locale=function(){return P[this.$L]},k.locale=function(A,C){if(!A)return this.$L;var j=this.clone(),B=R(A,C,!0);return B&&(j.$L=B),j},k.clone=function(){return T.w(this.$d,this)},k.toDate=function(){return new Date(this.valueOf())},k.toJSON=function(){return this.isValid()?this.toISOString():null},k.toISOString=function(){return this.$d.toISOString()},k.toString=function(){return this.$d.toUTCString()},x})(),E=L.prototype;return I.prototype=E,[["$ms",u],["$s",l],["$m",i],["$H",c],["$W",p],["$M",f],["$y",y],["$D",b]].forEach((function(x){E[x[1]]=function(k){return this.$g(k,x[0],x[1])}})),I.extend=function(x,k){return x.$i||(x(k,L,I),x.$i=!0),I},I.locale=R,I.isDayjs=q,I.unix=function(x){return I(1e3*x)},I.en=P[G],I.Ls=P,I.p={},I}))},{}],392:[function(t,r,o){(function(s,a){typeof o=="object"&&r!==void 0?r.exports=a():(s=typeof globalThis<"u"?globalThis:s||self).dayjs_plugin_customParseFormat=a()})(void 0,(function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},a=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,u=/\d\d/,l=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,c={},p=function(w){return(w=+w)+(w>68?1900:2e3)},h=function(w){return function(S){this[w]=+S}},f=[/[+-]\d\d:?(\d\d)?|Z/,function(w){(this.zone||(this.zone={})).offset=(function(S){if(!S||S==="Z")return 0;var N=S.match(/([+-]|\d\d)/g),D=60*N[1]+(+N[2]||0);return D===0?0:N[0]==="+"?-D:D})(w)}],g=function(w){var S=c[w];return S&&(S.indexOf?S:S.s.concat(S.f))},y=function(w,S){var N,D=c.meridiem;if(D){for(var F=1;F<=24;F+=1)if(w.indexOf(D(F,0,S))>-1){N=F>12;break}}else N=w===(S?"pm":"PM");return N},b={A:[i,function(w){this.afternoon=y(w,!1)}],a:[i,function(w){this.afternoon=y(w,!0)}],S:[/\d/,function(w){this.milliseconds=100*+w}],SS:[u,function(w){this.milliseconds=10*+w}],SSS:[/\d{3}/,function(w){this.milliseconds=+w}],s:[l,h("seconds")],ss:[l,h("seconds")],m:[l,h("minutes")],mm:[l,h("minutes")],H:[l,h("hours")],h:[l,h("hours")],HH:[l,h("hours")],hh:[l,h("hours")],D:[l,h("day")],DD:[u,h("day")],Do:[i,function(w){var S=c.ordinal,N=w.match(/\d+/);if(this.day=N[0],S)for(var D=1;D<=31;D+=1)S(D).replace(/\[|\]/g,"")===w&&(this.day=D)}],M:[l,h("month")],MM:[u,h("month")],MMM:[i,function(w){var S=g("months"),N=(g("monthsShort")||S.map((function(D){return D.slice(0,3)}))).indexOf(w)+1;if(N<1)throw new Error;this.month=N%12||N}],MMMM:[i,function(w){var S=g("months").indexOf(w)+1;if(S<1)throw new Error;this.month=S%12||S}],Y:[/[+-]?\d+/,h("year")],YY:[u,function(w){this.year=p(w)}],YYYY:[/\d{4}/,h("year")],Z:f,ZZ:f};function v(w){var S,N;S=w,N=c&&c.formats;for(var D=(w=S.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(I,T,L){var E=L&&L.toUpperCase();return T||N[L]||s[L]||N[E].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(x,k,A){return k||A.slice(1)}))}))).match(a),F=D.length,G=0;G<F;G+=1){var P=D[G],U=b[P],q=U&&U[0],R=U&&U[1];D[G]=R?{regex:q,parser:R}:P.replace(/^\[|\]$/g,"")}return function(I){for(var T={},L=0,E=0;L<F;L+=1){var x=D[L];if(typeof x=="string")E+=x.length;else{var k=x.regex,A=x.parser,C=I.slice(E),j=k.exec(C)[0];A.call(T,j),I=I.replace(j,"")}}return(function(B){var O=B.afternoon;if(O!==void 0){var H=B.hours;O?H<12&&(B.hours+=12):H===12&&(B.hours=0),delete B.afternoon}})(T),T}}return function(w,S,N){N.p.customParseFormat=!0,w&&w.parseTwoDigitYear&&(p=w.parseTwoDigitYear);var D=S.prototype,F=D.parse;D.parse=function(G){var P=G.date,U=G.utc,q=G.args;this.$u=U;var R=q[1];if(typeof R=="string"){var I=q[2]===!0,T=q[3]===!0,L=I||T,E=q[2];T&&(E=q[2]),c=this.$locale(),!I&&E&&(c=N.Ls[E]),this.$d=(function(C,j,B){try{if(["x","X"].indexOf(j)>-1)return new Date((j==="X"?1e3:1)*C);var O=v(j)(C),H=O.year,X=O.month,et=O.day,V=O.hours,tt=O.minutes,$=O.seconds,z=O.milliseconds,Z=O.zone,it=new Date,mt=et||(H||X?1:it.getDate()),lt=H||it.getFullYear(),at=0;H&&!X||(at=X>0?X-1:it.getMonth());var rt=V||0,ct=tt||0,ot=$||0,dt=z||0;return Z?new Date(Date.UTC(lt,at,mt,rt,ct,ot,dt+60*Z.offset*1e3)):B?new Date(Date.UTC(lt,at,mt,rt,ct,ot,dt)):new Date(lt,at,mt,rt,ct,ot,dt)}catch{return new Date("")}})(P,R,U),this.init(),E&&E!==!0&&(this.$L=this.locale(E).$L),L&&P!=this.format(R)&&(this.$d=new Date("")),c={}}else if(R instanceof Array)for(var x=R.length,k=1;k<=x;k+=1){q[1]=R[k-1];var A=N.apply(this,q);if(A.isValid()){this.$d=A.$d,this.$L=A.$L,this.init();break}k===x&&(this.$d=new Date(""))}else F.call(this,G)}}}))},{}],393:[function(t,r,o){(function(s,a){typeof o=="object"&&r!==void 0?r.exports=a():(s=typeof globalThis<"u"?globalThis:s||self).dayjs_plugin_utc=a()})(void 0,(function(){var s="minute",a=/[+-]\d\d(?::?\d\d)?/g,u=/([+-]|\d\d)/g;return function(l,i,c){var p=i.prototype;c.utc=function(w){var S={date:w,utc:!0,args:arguments};return new i(S)},p.utc=function(w){var S=c(this.toDate(),{locale:this.$L,utc:!0});return w?S.add(this.utcOffset(),s):S},p.local=function(){return c(this.toDate(),{locale:this.$L,utc:!1})};var h=p.parse;p.parse=function(w){w.utc&&(this.$u=!0),this.$utils().u(w.$offset)||(this.$offset=w.$offset),h.call(this,w)};var f=p.init;p.init=function(){if(this.$u){var w=this.$d;this.$y=w.getUTCFullYear(),this.$M=w.getUTCMonth(),this.$D=w.getUTCDate(),this.$W=w.getUTCDay(),this.$H=w.getUTCHours(),this.$m=w.getUTCMinutes(),this.$s=w.getUTCSeconds(),this.$ms=w.getUTCMilliseconds()}else f.call(this)};var g=p.utcOffset;p.utcOffset=function(w,S){var N=this.$utils().u;if(N(w))return this.$u?0:N(this.$offset)?g.call(this):this.$offset;if(typeof w=="string"&&(w=(function(P){P===void 0&&(P="");var U=P.match(a);if(!U)return null;var q=(""+U[0]).match(u)||["-",0,0],R=q[0],I=60*+q[1]+ +q[2];return I===0?0:R==="+"?I:-I})(w))===null)return this;var D=Math.abs(w)<=16?60*w:w,F=this;if(S)return F.$offset=D,F.$u=w===0,F;if(w!==0){var G=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(F=this.local().add(D+G,s)).$offset=D,F.$x.$localOffset=G}else F=this.utc();return F};var y=p.format;p.format=function(w){var S=w||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return y.call(this,S)},p.valueOf=function(){var w=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*w},p.isUTC=function(){return!!this.$u},p.toISOString=function(){return this.toDate().toISOString()},p.toString=function(){return this.toDate().toUTCString()};var b=p.toDate;p.toDate=function(w){return w==="s"&&this.$offset?c(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():b.call(this)};var v=p.diff;p.diff=function(w,S,N){if(w&&this.$u===w.$u)return v.call(this,w,S,N);var D=this.local(),F=c(w).local();return v.call(D,F,S,N)}}}))},{}],394:[function(t,r,o){o.utils=t("./des/utils"),o.Cipher=t("./des/cipher"),o.DES=t("./des/des"),o.CBC=t("./des/cbc"),o.EDE=t("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(t,r,o){var s=t("minimalistic-assert"),a=t("inherits"),u={};function l(i){s.equal(i.length,8,"Invalid IV length"),this.iv=new Array(8);for(var c=0;c<this.iv.length;c++)this.iv[c]=i[c]}o.instantiate=function(i){function c(g){i.call(this,g),this._cbcInit()}a(c,i);for(var p=Object.keys(u),h=0;h<p.length;h++){var f=p[h];c.prototype[f]=u[f]}return c.create=function(g){return new c(g)},c},u._cbcInit=function(){var i=new l(this.options.iv);this._cbcState=i},u._update=function(i,c,p,h){var f=this._cbcState,g=this.constructor.super_.prototype,y=f.iv;if(this.type==="encrypt"){for(var b=0;b<this.blockSize;b++)y[b]^=i[c+b];for(g._update.call(this,y,0,p,h),b=0;b<this.blockSize;b++)y[b]=p[h+b]}else{for(g._update.call(this,i,c,p,h),b=0;b<this.blockSize;b++)p[h+b]^=y[b];for(b=0;b<this.blockSize;b++)y[b]=i[c+b]}}},{inherits:440,"minimalistic-assert":453}],396:[function(t,r,o){var s=t("minimalistic-assert");function a(u){this.options=u,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=u.padding!==!1}r.exports=a,a.prototype._init=function(){},a.prototype.update=function(u){return u.length===0?[]:this.type==="decrypt"?this._updateDecrypt(u):this._updateEncrypt(u)},a.prototype._buffer=function(u,l){for(var i=Math.min(this.buffer.length-this.bufferOff,u.length-l),c=0;c<i;c++)this.buffer[this.bufferOff+c]=u[l+c];return this.bufferOff+=i,i},a.prototype._flushBuffer=function(u,l){return this._update(this.buffer,0,u,l),this.bufferOff=0,this.blockSize},a.prototype._updateEncrypt=function(u){var l=0,i=0,c=(this.bufferOff+u.length)/this.blockSize|0,p=new Array(c*this.blockSize);this.bufferOff!==0&&(l+=this._buffer(u,l),this.bufferOff===this.buffer.length&&(i+=this._flushBuffer(p,i)));for(var h=u.length-(u.length-l)%this.blockSize;l<h;l+=this.blockSize)this._update(u,l,p,i),i+=this.blockSize;for(;l<u.length;l++,this.bufferOff++)this.buffer[this.bufferOff]=u[l];return p},a.prototype._updateDecrypt=function(u){for(var l=0,i=0,c=Math.ceil((this.bufferOff+u.length)/this.blockSize)-1,p=new Array(c*this.blockSize);c>0;c--)l+=this._buffer(u,l),i+=this._flushBuffer(p,i);return l+=this._buffer(u,l),p},a.prototype.final=function(u){var l,i;return u&&(l=this.update(u)),i=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),l?l.concat(i):i},a.prototype._pad=function(u,l){if(l===0)return!1;for(;l<u.length;)u[l++]=0;return!0},a.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var u=new Array(this.blockSize);return this._update(this.buffer,0,u,0),u},a.prototype._unpad=function(u){return u},a.prototype._finalDecrypt=function(){s.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var u=new Array(this.blockSize);return this._flushBuffer(u,0),this._unpad(u)}},{"minimalistic-assert":453}],397:[function(t,r,o){var s=t("minimalistic-assert"),a=t("inherits"),u=t("./utils"),l=t("./cipher");function i(){this.tmp=new Array(2),this.keys=null}function c(h){l.call(this,h);var f=new i;this._desState=f,this.deriveKeys(f,h.key)}a(c,l),r.exports=c,c.create=function(h){return new c(h)};var p=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];c.prototype.deriveKeys=function(h,f){h.keys=new Array(32),s.equal(f.length,this.blockSize,"Invalid key length");var g=u.readUInt32BE(f,0),y=u.readUInt32BE(f,4);u.pc1(g,y,h.tmp,0),g=h.tmp[0],y=h.tmp[1];for(var b=0;b<h.keys.length;b+=2){var v=p[b>>>1];g=u.r28shl(g,v),y=u.r28shl(y,v),u.pc2(g,y,h.keys,b)}},c.prototype._update=function(h,f,g,y){var b=this._desState,v=u.readUInt32BE(h,f),w=u.readUInt32BE(h,f+4);u.ip(v,w,b.tmp,0),v=b.tmp[0],w=b.tmp[1],this.type==="encrypt"?this._encrypt(b,v,w,b.tmp,0):this._decrypt(b,v,w,b.tmp,0),v=b.tmp[0],w=b.tmp[1],u.writeUInt32BE(g,v,y),u.writeUInt32BE(g,w,y+4)},c.prototype._pad=function(h,f){if(this.padding===!1)return!1;for(var g=h.length-f,y=f;y<h.length;y++)h[y]=g;return!0},c.prototype._unpad=function(h){if(this.padding===!1)return h;for(var f=h[h.length-1],g=h.length-f;g<h.length;g++)s.equal(h[g],f);return h.slice(0,h.length-f)},c.prototype._encrypt=function(h,f,g,y,b){for(var v=f,w=g,S=0;S<h.keys.length;S+=2){var N=h.keys[S],D=h.keys[S+1];u.expand(w,h.tmp,0),N^=h.tmp[0],D^=h.tmp[1];var F=u.substitute(N,D),G=w;w=(v^u.permute(F))>>>0,v=G}u.rip(w,v,y,b)},c.prototype._decrypt=function(h,f,g,y,b){for(var v=g,w=f,S=h.keys.length-2;S>=0;S-=2){var N=h.keys[S],D=h.keys[S+1];u.expand(v,h.tmp,0),N^=h.tmp[0],D^=h.tmp[1];var F=u.substitute(N,D),G=v;v=(w^u.permute(F))>>>0,w=G}u.rip(v,w,y,b)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(t,r,o){var s=t("minimalistic-assert"),a=t("inherits"),u=t("./cipher"),l=t("./des");function i(p,h){s.equal(h.length,24,"Invalid key length");var f=h.slice(0,8),g=h.slice(8,16),y=h.slice(16,24);this.ciphers=p==="encrypt"?[l.create({type:"encrypt",key:f}),l.create({type:"decrypt",key:g}),l.create({type:"encrypt",key:y})]:[l.create({type:"decrypt",key:y}),l.create({type:"encrypt",key:g}),l.create({type:"decrypt",key:f})]}function c(p){u.call(this,p);var h=new i(this.type,this.options.key);this._edeState=h}a(c,u),r.exports=c,c.create=function(p){return new c(p)},c.prototype._update=function(p,h,f,g){var y=this._edeState;y.ciphers[0]._update(p,h,f,g),y.ciphers[1]._update(f,g,f,g),y.ciphers[2]._update(f,g,f,g)},c.prototype._pad=l.prototype._pad,c.prototype._unpad=l.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(t,r,o){o.readUInt32BE=function(l,i){return(l[0+i]<<24|l[1+i]<<16|l[2+i]<<8|l[3+i])>>>0},o.writeUInt32BE=function(l,i,c){l[0+c]=i>>>24,l[1+c]=i>>>16&255,l[2+c]=i>>>8&255,l[3+c]=255&i},o.ip=function(l,i,c,p){for(var h=0,f=0,g=6;g>=0;g-=2){for(var y=0;y<=24;y+=8)h<<=1,h|=i>>>y+g&1;for(y=0;y<=24;y+=8)h<<=1,h|=l>>>y+g&1}for(g=6;g>=0;g-=2){for(y=1;y<=25;y+=8)f<<=1,f|=i>>>y+g&1;for(y=1;y<=25;y+=8)f<<=1,f|=l>>>y+g&1}c[p+0]=h>>>0,c[p+1]=f>>>0},o.rip=function(l,i,c,p){for(var h=0,f=0,g=0;g<4;g++)for(var y=24;y>=0;y-=8)h<<=1,h|=i>>>y+g&1,h<<=1,h|=l>>>y+g&1;for(g=4;g<8;g++)for(y=24;y>=0;y-=8)f<<=1,f|=i>>>y+g&1,f<<=1,f|=l>>>y+g&1;c[p+0]=h>>>0,c[p+1]=f>>>0},o.pc1=function(l,i,c,p){for(var h=0,f=0,g=7;g>=5;g--){for(var y=0;y<=24;y+=8)h<<=1,h|=i>>y+g&1;for(y=0;y<=24;y+=8)h<<=1,h|=l>>y+g&1}for(y=0;y<=24;y+=8)h<<=1,h|=i>>y+g&1;for(g=1;g<=3;g++){for(y=0;y<=24;y+=8)f<<=1,f|=i>>y+g&1;for(y=0;y<=24;y+=8)f<<=1,f|=l>>y+g&1}for(y=0;y<=24;y+=8)f<<=1,f|=l>>y+g&1;c[p+0]=h>>>0,c[p+1]=f>>>0},o.r28shl=function(l,i){return l<<i&268435455|l>>>28-i};var s=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];o.pc2=function(l,i,c,p){for(var h=0,f=0,g=s.length>>>1,y=0;y<g;y++)h<<=1,h|=l>>>s[y]&1;for(y=g;y<s.length;y++)f<<=1,f|=i>>>s[y]&1;c[p+0]=h>>>0,c[p+1]=f>>>0},o.expand=function(l,i,c){var p=0,h=0;p=(1&l)<<5|l>>>27;for(var f=23;f>=15;f-=4)p<<=6,p|=l>>>f&63;for(f=11;f>=3;f-=4)h|=l>>>f&63,h<<=6;h|=(31&l)<<1|l>>>31,i[c+0]=p>>>0,i[c+1]=h>>>0};var a=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];o.substitute=function(l,i){for(var c=0,p=0;p<4;p++)c<<=4,c|=a[64*p+(l>>>18-6*p&63)];for(p=0;p<4;p++)c<<=4,c|=a[256+64*p+(i>>>18-6*p&63)];return c>>>0};var u=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];o.permute=function(l){for(var i=0,c=0;c<u.length;c++)i<<=1,i|=l>>>u[c]&1;return i>>>0},o.padSplit=function(l,i,c){for(var p=l.toString(2);p.length<i;)p="0"+p;for(var h=[],f=0;f<i;f+=c)h.push(p.slice(f,f+c));return h.join(" ")}},{}],400:[function(t,r,o){(function(s){(function(){var a=t("./lib/generatePrime"),u=t("./lib/primes.json"),l=t("./lib/dh"),i={binary:!0,hex:!0,base64:!0};o.DiffieHellmanGroup=o.createDiffieHellmanGroup=o.getDiffieHellman=function(c){var p=new s(u[c].prime,"hex"),h=new s(u[c].gen,"hex");return new l(p,h)},o.createDiffieHellman=o.DiffieHellman=function c(p,h,f,g){return s.isBuffer(h)||i[h]===void 0?c(p,"binary",h,f):(h=h||"binary",g=g||"binary",f=f||new s([2]),s.isBuffer(f)||(f=new s(f,g)),typeof p=="number"?new l(a(p,f),f,!0):(s.isBuffer(p)||(p=new s(p,h)),new l(p,f,!0)))}}).call(this)}).call(this,t("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(t,r,o){(function(s){(function(){var a=t("bn.js"),u=new(t("miller-rabin")),l=new a(24),i=new a(11),c=new a(10),p=new a(3),h=new a(7),f=t("./generatePrime"),g=t("randombytes");function y(N,D){return D=D||"utf8",s.isBuffer(N)||(N=new s(N,D)),this._pub=new a(N),this}function b(N,D){return D=D||"utf8",s.isBuffer(N)||(N=new s(N,D)),this._priv=new a(N),this}r.exports=w;var v={};function w(N,D,F){this.setGenerator(D),this.__prime=new a(N),this._prime=a.mont(this.__prime),this._primeLen=N.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,F?(this.setPublicKey=y,this.setPrivateKey=b):this._primeCode=8}function S(N,D){var F=new s(N.toArray());return D?F.toString(D):F}Object.defineProperty(w.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=(function(N,D){var F=D.toString("hex"),G=[F,N.toString(16)].join("_");if(G in v)return v[G];var P,U=0;if(N.isEven()||!f.simpleSieve||!f.fermatTest(N)||!u.test(N))return U+=1,U+=F==="02"||F==="05"?8:4,v[G]=U,U;switch(u.test(N.shrn(1))||(U+=2),F){case"02":N.mod(l).cmp(i)&&(U+=8);break;case"05":(P=N.mod(c)).cmp(p)&&P.cmp(h)&&(U+=8);break;default:U+=4}return v[G]=U,U})(this.__prime,this.__gen)),this._primeCode}}),w.prototype.generateKeys=function(){return this._priv||(this._priv=new a(g(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},w.prototype.computeSecret=function(N){var D=(N=(N=new a(N)).toRed(this._prime)).redPow(this._priv).fromRed(),F=new s(D.toArray()),G=this.getPrime();if(F.length<G.length){var P=new s(G.length-F.length);P.fill(0),F=s.concat([P,F])}return F},w.prototype.getPublicKey=function(N){return S(this._pub,N)},w.prototype.getPrivateKey=function(N){return S(this._priv,N)},w.prototype.getPrime=function(N){return S(this.__prime,N)},w.prototype.getGenerator=function(N){return S(this._gen,N)},w.prototype.setGenerator=function(N,D){return D=D||"utf8",s.isBuffer(N)||(N=new s(N,D)),this.__gen=N,this._gen=new a(N),this}}).call(this)}).call(this,t("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(t,r,o){var s=t("randombytes");r.exports=N,N.simpleSieve=w,N.fermatTest=S;var a=t("bn.js"),u=new a(24),l=new(t("miller-rabin")),i=new a(1),c=new a(2),p=new a(5),h=(new a(16),new a(8),new a(10)),f=new a(3),g=(new a(7),new a(11)),y=new a(4),b=(new a(12),null);function v(){if(b!==null)return b;var D=[];D[0]=2;for(var F=1,G=3;G<1048576;G+=2){for(var P=Math.ceil(Math.sqrt(G)),U=0;U<F&&D[U]<=P&&G%D[U]!=0;U++);F!==U&&D[U]<=P||(D[F++]=G)}return b=D,D}function w(D){for(var F=v(),G=0;G<F.length;G++)if(D.modn(F[G])===0)return D.cmpn(F[G])===0;return!0}function S(D){var F=a.mont(D);return c.toRed(F).redPow(D.subn(1)).fromRed().cmpn(1)===0}function N(D,F){if(D<16)return new a(F===2||F===5?[140,123]:[140,39]);var G,P;for(F=new a(F);;){for(G=new a(s(Math.ceil(D/8)));G.bitLength()>D;)G.ishrn(1);if(G.isEven()&&G.iadd(i),G.testn(1)||G.iadd(c),F.cmp(c)){if(!F.cmp(p))for(;G.mod(h).cmp(f);)G.iadd(y)}else for(;G.mod(u).cmp(g);)G.iadd(y);if(w(P=G.shrn(1))&&w(G)&&S(P)&&S(G)&&l.test(P)&&l.test(G))return G}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(t,r,o){r.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(t,r,o){arguments[4][184][0].apply(o,arguments)},{buffer:188,dup:184}],405:[function(t,r,o){var s=o;s.version=t("../package.json").version,s.utils=t("./elliptic/utils"),s.rand=t("brorand"),s.curve=t("./elliptic/curve"),s.curves=t("./elliptic/curves"),s.ec=t("./elliptic/ec"),s.eddsa=t("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(t,r,o){var s=t("bn.js"),a=t("../utils"),u=a.getNAF,l=a.getJSF,i=a.assert;function c(h,f){this.type=h,this.p=new s(f.p,16),this.red=f.prime?s.red(f.prime):s.mont(this.p),this.zero=new s(0).toRed(this.red),this.one=new s(1).toRed(this.red),this.two=new s(2).toRed(this.red),this.n=f.n&&new s(f.n,16),this.g=f.g&&this.pointFromJSON(f.g,f.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var g=this.n&&this.p.div(this.n);!g||g.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function p(h,f){this.curve=h,this.type=f,this.precomputed=null}r.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(h,f){i(h.precomputed);var g=h._getDoubles(),y=u(f,1,this._bitLength),b=(1<<g.step+1)-(g.step%2==0?2:1);b/=3;var v,w,S=[];for(v=0;v<y.length;v+=g.step){w=0;for(var N=v+g.step-1;N>=v;N--)w=(w<<1)+y[N];S.push(w)}for(var D=this.jpoint(null,null,null),F=this.jpoint(null,null,null),G=b;G>0;G--){for(v=0;v<S.length;v++)(w=S[v])===G?F=F.mixedAdd(g.points[v]):w===-G&&(F=F.mixedAdd(g.points[v].neg()));D=D.add(F)}return D.toP()},c.prototype._wnafMul=function(h,f){var g=4,y=h._getNAFPoints(g);g=y.wnd;for(var b=y.points,v=u(f,g,this._bitLength),w=this.jpoint(null,null,null),S=v.length-1;S>=0;S--){for(var N=0;S>=0&&v[S]===0;S--)N++;if(S>=0&&N++,w=w.dblp(N),S<0)break;var D=v[S];i(D!==0),w=h.type==="affine"?D>0?w.mixedAdd(b[D-1>>1]):w.mixedAdd(b[-D-1>>1].neg()):D>0?w.add(b[D-1>>1]):w.add(b[-D-1>>1].neg())}return h.type==="affine"?w.toP():w},c.prototype._wnafMulAdd=function(h,f,g,y,b){var v,w,S,N=this._wnafT1,D=this._wnafT2,F=this._wnafT3,G=0;for(v=0;v<y;v++){var P=(S=f[v])._getNAFPoints(h);N[v]=P.wnd,D[v]=P.points}for(v=y-1;v>=1;v-=2){var U=v-1,q=v;if(N[U]===1&&N[q]===1){var R=[f[U],null,null,f[q]];f[U].y.cmp(f[q].y)===0?(R[1]=f[U].add(f[q]),R[2]=f[U].toJ().mixedAdd(f[q].neg())):f[U].y.cmp(f[q].y.redNeg())===0?(R[1]=f[U].toJ().mixedAdd(f[q]),R[2]=f[U].add(f[q].neg())):(R[1]=f[U].toJ().mixedAdd(f[q]),R[2]=f[U].toJ().mixedAdd(f[q].neg()));var I=[-3,-1,-5,-7,0,7,5,1,3],T=l(g[U],g[q]);for(G=Math.max(T[0].length,G),F[U]=new Array(G),F[q]=new Array(G),w=0;w<G;w++){var L=0|T[0][w],E=0|T[1][w];F[U][w]=I[3*(L+1)+(E+1)],F[q][w]=0,D[U]=R}}else F[U]=u(g[U],N[U],this._bitLength),F[q]=u(g[q],N[q],this._bitLength),G=Math.max(F[U].length,G),G=Math.max(F[q].length,G)}var x=this.jpoint(null,null,null),k=this._wnafT4;for(v=G;v>=0;v--){for(var A=0;v>=0;){var C=!0;for(w=0;w<y;w++)k[w]=0|F[w][v],k[w]!==0&&(C=!1);if(!C)break;A++,v--}if(v>=0&&A++,x=x.dblp(A),v<0)break;for(w=0;w<y;w++){var j=k[w];j!==0&&(j>0?S=D[w][j-1>>1]:j<0&&(S=D[w][-j-1>>1].neg()),x=S.type==="affine"?x.mixedAdd(S):x.add(S))}}for(v=0;v<y;v++)D[v]=null;return b?x:x.toP()},c.BasePoint=p,p.prototype.eq=function(){throw new Error("Not implemented")},p.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(h,f){h=a.toArray(h,f);var g=this.p.byteLength();if((h[0]===4||h[0]===6||h[0]===7)&&h.length-1==2*g)return h[0]===6?i(h[h.length-1]%2==0):h[0]===7&&i(h[h.length-1]%2==1),this.point(h.slice(1,1+g),h.slice(1+g,1+2*g));if((h[0]===2||h[0]===3)&&h.length-1===g)return this.pointFromX(h.slice(1,1+g),h[0]===3);throw new Error("Unknown point format")},p.prototype.encodeCompressed=function(h){return this.encode(h,!0)},p.prototype._encode=function(h){var f=this.curve.p.byteLength(),g=this.getX().toArray("be",f);return h?[this.getY().isEven()?2:3].concat(g):[4].concat(g,this.getY().toArray("be",f))},p.prototype.encode=function(h,f){return a.encode(this._encode(f),h)},p.prototype.precompute=function(h){if(this.precomputed)return this;var f={doubles:null,naf:null,beta:null};return f.naf=this._getNAFPoints(8),f.doubles=this._getDoubles(4,h),f.beta=this._getBeta(),this.precomputed=f,this},p.prototype._hasDoubles=function(h){if(!this.precomputed)return!1;var f=this.precomputed.doubles;return!!f&&f.points.length>=Math.ceil((h.bitLength()+1)/f.step)},p.prototype._getDoubles=function(h,f){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var g=[this],y=this,b=0;b<f;b+=h){for(var v=0;v<h;v++)y=y.dbl();g.push(y)}return{step:h,points:g}},p.prototype._getNAFPoints=function(h){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var f=[this],g=(1<<h)-1,y=g===1?null:this.dbl(),b=1;b<g;b++)f[b]=f[b-1].add(y);return{wnd:h,points:f}},p.prototype._getBeta=function(){return null},p.prototype.dblp=function(h){for(var f=this,g=0;g<h;g++)f=f.dbl();return f}},{"../utils":419,"bn.js":420}],407:[function(t,r,o){var s=t("../utils"),a=t("bn.js"),u=t("inherits"),l=t("./base"),i=s.assert;function c(h){this.twisted=(0|h.a)!=1,this.mOneA=this.twisted&&(0|h.a)==-1,this.extended=this.mOneA,l.call(this,"edwards",h),this.a=new a(h.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new a(h.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new a(h.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),i(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|h.c)==1}function p(h,f,g,y,b){l.BasePoint.call(this,h,"projective"),f===null&&g===null&&y===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new a(f,16),this.y=new a(g,16),this.z=y?new a(y,16):this.curve.one,this.t=b&&new a(b,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}u(c,l),r.exports=c,c.prototype._mulA=function(h){return this.mOneA?h.redNeg():this.a.redMul(h)},c.prototype._mulC=function(h){return this.oneC?h:this.c.redMul(h)},c.prototype.jpoint=function(h,f,g,y){return this.point(h,f,g,y)},c.prototype.pointFromX=function(h,f){(h=new a(h,16)).red||(h=h.toRed(this.red));var g=h.redSqr(),y=this.c2.redSub(this.a.redMul(g)),b=this.one.redSub(this.c2.redMul(this.d).redMul(g)),v=y.redMul(b.redInvm()),w=v.redSqrt();if(w.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");var S=w.fromRed().isOdd();return(f&&!S||!f&&S)&&(w=w.redNeg()),this.point(h,w)},c.prototype.pointFromY=function(h,f){(h=new a(h,16)).red||(h=h.toRed(this.red));var g=h.redSqr(),y=g.redSub(this.c2),b=g.redMul(this.d).redMul(this.c2).redSub(this.a),v=y.redMul(b.redInvm());if(v.cmp(this.zero)===0){if(f)throw new Error("invalid point");return this.point(this.zero,h)}var w=v.redSqrt();if(w.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");return w.fromRed().isOdd()!==f&&(w=w.redNeg()),this.point(w,h)},c.prototype.validate=function(h){if(h.isInfinity())return!0;h.normalize();var f=h.x.redSqr(),g=h.y.redSqr(),y=f.redMul(this.a).redAdd(g),b=this.c2.redMul(this.one.redAdd(this.d.redMul(f).redMul(g)));return y.cmp(b)===0},u(p,l.BasePoint),c.prototype.pointFromJSON=function(h){return p.fromJSON(this,h)},c.prototype.point=function(h,f,g,y){return new p(this,h,f,g,y)},p.fromJSON=function(h,f){return new p(h,f[0],f[1],f[2])},p.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},p.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},p.prototype._extDbl=function(){var h=this.x.redSqr(),f=this.y.redSqr(),g=this.z.redSqr();g=g.redIAdd(g);var y=this.curve._mulA(h),b=this.x.redAdd(this.y).redSqr().redISub(h).redISub(f),v=y.redAdd(f),w=v.redSub(g),S=y.redSub(f),N=b.redMul(w),D=v.redMul(S),F=b.redMul(S),G=w.redMul(v);return this.curve.point(N,D,G,F)},p.prototype._projDbl=function(){var h,f,g,y,b,v,w=this.x.redAdd(this.y).redSqr(),S=this.x.redSqr(),N=this.y.redSqr();if(this.curve.twisted){var D=(y=this.curve._mulA(S)).redAdd(N);this.zOne?(h=w.redSub(S).redSub(N).redMul(D.redSub(this.curve.two)),f=D.redMul(y.redSub(N)),g=D.redSqr().redSub(D).redSub(D)):(b=this.z.redSqr(),v=D.redSub(b).redISub(b),h=w.redSub(S).redISub(N).redMul(v),f=D.redMul(y.redSub(N)),g=D.redMul(v))}else y=S.redAdd(N),b=this.curve._mulC(this.z).redSqr(),v=y.redSub(b).redSub(b),h=this.curve._mulC(w.redISub(y)).redMul(v),f=this.curve._mulC(y).redMul(S.redISub(N)),g=y.redMul(v);return this.curve.point(h,f,g)},p.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},p.prototype._extAdd=function(h){var f=this.y.redSub(this.x).redMul(h.y.redSub(h.x)),g=this.y.redAdd(this.x).redMul(h.y.redAdd(h.x)),y=this.t.redMul(this.curve.dd).redMul(h.t),b=this.z.redMul(h.z.redAdd(h.z)),v=g.redSub(f),w=b.redSub(y),S=b.redAdd(y),N=g.redAdd(f),D=v.redMul(w),F=S.redMul(N),G=v.redMul(N),P=w.redMul(S);return this.curve.point(D,F,P,G)},p.prototype._projAdd=function(h){var f,g,y=this.z.redMul(h.z),b=y.redSqr(),v=this.x.redMul(h.x),w=this.y.redMul(h.y),S=this.curve.d.redMul(v).redMul(w),N=b.redSub(S),D=b.redAdd(S),F=this.x.redAdd(this.y).redMul(h.x.redAdd(h.y)).redISub(v).redISub(w),G=y.redMul(N).redMul(F);return this.curve.twisted?(f=y.redMul(D).redMul(w.redSub(this.curve._mulA(v))),g=N.redMul(D)):(f=y.redMul(D).redMul(w.redSub(v)),g=this.curve._mulC(N).redMul(D)),this.curve.point(G,f,g)},p.prototype.add=function(h){return this.isInfinity()?h:h.isInfinity()?this:this.curve.extended?this._extAdd(h):this._projAdd(h)},p.prototype.mul=function(h){return this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve._wnafMul(this,h)},p.prototype.mulAdd=function(h,f,g){return this.curve._wnafMulAdd(1,[this,f],[h,g],2,!1)},p.prototype.jmulAdd=function(h,f,g){return this.curve._wnafMulAdd(1,[this,f],[h,g],2,!0)},p.prototype.normalize=function(){if(this.zOne)return this;var h=this.z.redInvm();return this.x=this.x.redMul(h),this.y=this.y.redMul(h),this.t&&(this.t=this.t.redMul(h)),this.z=this.curve.one,this.zOne=!0,this},p.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},p.prototype.getX=function(){return this.normalize(),this.x.fromRed()},p.prototype.getY=function(){return this.normalize(),this.y.fromRed()},p.prototype.eq=function(h){return this===h||this.getX().cmp(h.getX())===0&&this.getY().cmp(h.getY())===0},p.prototype.eqXToP=function(h){var f=h.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(f)===0)return!0;for(var g=h.clone(),y=this.curve.redN.redMul(this.z);;){if(g.iadd(this.curve.n),g.cmp(this.curve.p)>=0)return!1;if(f.redIAdd(y),this.x.cmp(f)===0)return!0}},p.prototype.toP=p.prototype.normalize,p.prototype.mixedAdd=p.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(t,r,o){var s=o;s.base=t("./base"),s.short=t("./short"),s.mont=t("./mont"),s.edwards=t("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(t,r,o){var s=t("bn.js"),a=t("inherits"),u=t("./base"),l=t("../utils");function i(p){u.call(this,"mont",p),this.a=new s(p.a,16).toRed(this.red),this.b=new s(p.b,16).toRed(this.red),this.i4=new s(4).toRed(this.red).redInvm(),this.two=new s(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(p,h,f){u.BasePoint.call(this,p,"projective"),h===null&&f===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new s(h,16),this.z=new s(f,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}a(i,u),r.exports=i,i.prototype.validate=function(p){var h=p.normalize().x,f=h.redSqr(),g=f.redMul(h).redAdd(f.redMul(this.a)).redAdd(h);return g.redSqrt().redSqr().cmp(g)===0},a(c,u.BasePoint),i.prototype.decodePoint=function(p,h){return this.point(l.toArray(p,h),1)},i.prototype.point=function(p,h){return new c(this,p,h)},i.prototype.pointFromJSON=function(p){return c.fromJSON(this,p)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(p,h){return new c(p,h[0],h[1]||p.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.z.cmpn(0)===0},c.prototype.dbl=function(){var p=this.x.redAdd(this.z).redSqr(),h=this.x.redSub(this.z).redSqr(),f=p.redSub(h),g=p.redMul(h),y=f.redMul(h.redAdd(this.curve.a24.redMul(f)));return this.curve.point(g,y)},c.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(p,h){var f=this.x.redAdd(this.z),g=this.x.redSub(this.z),y=p.x.redAdd(p.z),b=p.x.redSub(p.z).redMul(f),v=y.redMul(g),w=h.z.redMul(b.redAdd(v).redSqr()),S=h.x.redMul(b.redISub(v).redSqr());return this.curve.point(w,S)},c.prototype.mul=function(p){for(var h=p.clone(),f=this,g=this.curve.point(null,null),y=[];h.cmpn(0)!==0;h.iushrn(1))y.push(h.andln(1));for(var b=y.length-1;b>=0;b--)y[b]===0?(f=f.diffAdd(g,this),g=g.dbl()):(g=f.diffAdd(g,this),f=f.dbl());return g},c.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.eq=function(p){return this.getX().cmp(p.getX())===0},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(t,r,o){var s=t("../utils"),a=t("bn.js"),u=t("inherits"),l=t("./base"),i=s.assert;function c(f){l.call(this,"short",f),this.a=new a(f.a,16).toRed(this.red),this.b=new a(f.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(f),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function p(f,g,y,b){l.BasePoint.call(this,f,"affine"),g===null&&y===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new a(g,16),this.y=new a(y,16),b&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(f,g,y,b){l.BasePoint.call(this,f,"jacobian"),g===null&&y===null&&b===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new a(0)):(this.x=new a(g,16),this.y=new a(y,16),this.z=new a(b,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}u(c,l),r.exports=c,c.prototype._getEndomorphism=function(f){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var g,y;if(f.beta)g=new a(f.beta,16).toRed(this.red);else{var b=this._getEndoRoots(this.p);g=(g=b[0].cmp(b[1])<0?b[0]:b[1]).toRed(this.red)}if(f.lambda)y=new a(f.lambda,16);else{var v=this._getEndoRoots(this.n);this.g.mul(v[0]).x.cmp(this.g.x.redMul(g))===0?y=v[0]:(y=v[1],i(this.g.mul(y).x.cmp(this.g.x.redMul(g))===0))}return{beta:g,lambda:y,basis:f.basis?f.basis.map((function(w){return{a:new a(w.a,16),b:new a(w.b,16)}})):this._getEndoBasis(y)}}},c.prototype._getEndoRoots=function(f){var g=f===this.p?this.red:a.mont(f),y=new a(2).toRed(g).redInvm(),b=y.redNeg(),v=new a(3).toRed(g).redNeg().redSqrt().redMul(y);return[b.redAdd(v).fromRed(),b.redSub(v).fromRed()]},c.prototype._getEndoBasis=function(f){for(var g,y,b,v,w,S,N,D,F,G=this.n.ushrn(Math.floor(this.n.bitLength()/2)),P=f,U=this.n.clone(),q=new a(1),R=new a(0),I=new a(0),T=new a(1),L=0;P.cmpn(0)!==0;){var E=U.div(P);D=U.sub(E.mul(P)),F=I.sub(E.mul(q));var x=T.sub(E.mul(R));if(!b&&D.cmp(G)<0)g=N.neg(),y=q,b=D.neg(),v=F;else if(b&&++L==2)break;N=D,U=P,P=D,I=q,q=F,T=R,R=x}w=D.neg(),S=F;var k=b.sqr().add(v.sqr());return w.sqr().add(S.sqr()).cmp(k)>=0&&(w=g,S=y),b.negative&&(b=b.neg(),v=v.neg()),w.negative&&(w=w.neg(),S=S.neg()),[{a:b,b:v},{a:w,b:S}]},c.prototype._endoSplit=function(f){var g=this.endo.basis,y=g[0],b=g[1],v=b.b.mul(f).divRound(this.n),w=y.b.neg().mul(f).divRound(this.n),S=v.mul(y.a),N=w.mul(b.a),D=v.mul(y.b),F=w.mul(b.b);return{k1:f.sub(S).sub(N),k2:D.add(F).neg()}},c.prototype.pointFromX=function(f,g){(f=new a(f,16)).red||(f=f.toRed(this.red));var y=f.redSqr().redMul(f).redIAdd(f.redMul(this.a)).redIAdd(this.b),b=y.redSqrt();if(b.redSqr().redSub(y).cmp(this.zero)!==0)throw new Error("invalid point");var v=b.fromRed().isOdd();return(g&&!v||!g&&v)&&(b=b.redNeg()),this.point(f,b)},c.prototype.validate=function(f){if(f.inf)return!0;var g=f.x,y=f.y,b=this.a.redMul(g),v=g.redSqr().redMul(g).redIAdd(b).redIAdd(this.b);return y.redSqr().redISub(v).cmpn(0)===0},c.prototype._endoWnafMulAdd=function(f,g,y){for(var b=this._endoWnafT1,v=this._endoWnafT2,w=0;w<f.length;w++){var S=this._endoSplit(g[w]),N=f[w],D=N._getBeta();S.k1.negative&&(S.k1.ineg(),N=N.neg(!0)),S.k2.negative&&(S.k2.ineg(),D=D.neg(!0)),b[2*w]=N,b[2*w+1]=D,v[2*w]=S.k1,v[2*w+1]=S.k2}for(var F=this._wnafMulAdd(1,b,v,2*w,y),G=0;G<2*w;G++)b[G]=null,v[G]=null;return F},u(p,l.BasePoint),c.prototype.point=function(f,g,y){return new p(this,f,g,y)},c.prototype.pointFromJSON=function(f,g){return p.fromJSON(this,f,g)},p.prototype._getBeta=function(){if(this.curve.endo){var f=this.precomputed;if(f&&f.beta)return f.beta;var g=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(f){var y=this.curve,b=function(v){return y.point(v.x.redMul(y.endo.beta),v.y)};f.beta=g,g.precomputed={beta:null,naf:f.naf&&{wnd:f.naf.wnd,points:f.naf.points.map(b)},doubles:f.doubles&&{step:f.doubles.step,points:f.doubles.points.map(b)}}}return g}},p.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},p.fromJSON=function(f,g,y){typeof g=="string"&&(g=JSON.parse(g));var b=f.point(g[0],g[1],y);if(!g[2])return b;function v(S){return f.point(S[0],S[1],y)}var w=g[2];return b.precomputed={beta:null,doubles:w.doubles&&{step:w.doubles.step,points:[b].concat(w.doubles.points.map(v))},naf:w.naf&&{wnd:w.naf.wnd,points:[b].concat(w.naf.points.map(v))}},b},p.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},p.prototype.isInfinity=function(){return this.inf},p.prototype.add=function(f){if(this.inf)return f;if(f.inf)return this;if(this.eq(f))return this.dbl();if(this.neg().eq(f))return this.curve.point(null,null);if(this.x.cmp(f.x)===0)return this.curve.point(null,null);var g=this.y.redSub(f.y);g.cmpn(0)!==0&&(g=g.redMul(this.x.redSub(f.x).redInvm()));var y=g.redSqr().redISub(this.x).redISub(f.x),b=g.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,b)},p.prototype.dbl=function(){if(this.inf)return this;var f=this.y.redAdd(this.y);if(f.cmpn(0)===0)return this.curve.point(null,null);var g=this.curve.a,y=this.x.redSqr(),b=f.redInvm(),v=y.redAdd(y).redIAdd(y).redIAdd(g).redMul(b),w=v.redSqr().redISub(this.x.redAdd(this.x)),S=v.redMul(this.x.redSub(w)).redISub(this.y);return this.curve.point(w,S)},p.prototype.getX=function(){return this.x.fromRed()},p.prototype.getY=function(){return this.y.fromRed()},p.prototype.mul=function(f){return f=new a(f,16),this.isInfinity()?this:this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve.endo?this.curve._endoWnafMulAdd([this],[f]):this.curve._wnafMul(this,f)},p.prototype.mulAdd=function(f,g,y){var b=[this,g],v=[f,y];return this.curve.endo?this.curve._endoWnafMulAdd(b,v):this.curve._wnafMulAdd(1,b,v,2)},p.prototype.jmulAdd=function(f,g,y){var b=[this,g],v=[f,y];return this.curve.endo?this.curve._endoWnafMulAdd(b,v,!0):this.curve._wnafMulAdd(1,b,v,2,!0)},p.prototype.eq=function(f){return this===f||this.inf===f.inf&&(this.inf||this.x.cmp(f.x)===0&&this.y.cmp(f.y)===0)},p.prototype.neg=function(f){if(this.inf)return this;var g=this.curve.point(this.x,this.y.redNeg());if(f&&this.precomputed){var y=this.precomputed,b=function(v){return v.neg()};g.precomputed={naf:y.naf&&{wnd:y.naf.wnd,points:y.naf.points.map(b)},doubles:y.doubles&&{step:y.doubles.step,points:y.doubles.points.map(b)}}}return g},p.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},u(h,l.BasePoint),c.prototype.jpoint=function(f,g,y){return new h(this,f,g,y)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var f=this.z.redInvm(),g=f.redSqr(),y=this.x.redMul(g),b=this.y.redMul(g).redMul(f);return this.curve.point(y,b)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(f){if(this.isInfinity())return f;if(f.isInfinity())return this;var g=f.z.redSqr(),y=this.z.redSqr(),b=this.x.redMul(g),v=f.x.redMul(y),w=this.y.redMul(g.redMul(f.z)),S=f.y.redMul(y.redMul(this.z)),N=b.redSub(v),D=w.redSub(S);if(N.cmpn(0)===0)return D.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var F=N.redSqr(),G=F.redMul(N),P=b.redMul(F),U=D.redSqr().redIAdd(G).redISub(P).redISub(P),q=D.redMul(P.redISub(U)).redISub(w.redMul(G)),R=this.z.redMul(f.z).redMul(N);return this.curve.jpoint(U,q,R)},h.prototype.mixedAdd=function(f){if(this.isInfinity())return f.toJ();if(f.isInfinity())return this;var g=this.z.redSqr(),y=this.x,b=f.x.redMul(g),v=this.y,w=f.y.redMul(g).redMul(this.z),S=y.redSub(b),N=v.redSub(w);if(S.cmpn(0)===0)return N.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var D=S.redSqr(),F=D.redMul(S),G=y.redMul(D),P=N.redSqr().redIAdd(F).redISub(G).redISub(G),U=N.redMul(G.redISub(P)).redISub(v.redMul(F)),q=this.z.redMul(S);return this.curve.jpoint(P,U,q)},h.prototype.dblp=function(f){if(f===0)return this;if(this.isInfinity())return this;if(!f)return this.dbl();var g;if(this.curve.zeroA||this.curve.threeA){var y=this;for(g=0;g<f;g++)y=y.dbl();return y}var b=this.curve.a,v=this.curve.tinv,w=this.x,S=this.y,N=this.z,D=N.redSqr().redSqr(),F=S.redAdd(S);for(g=0;g<f;g++){var G=w.redSqr(),P=F.redSqr(),U=P.redSqr(),q=G.redAdd(G).redIAdd(G).redIAdd(b.redMul(D)),R=w.redMul(P),I=q.redSqr().redISub(R.redAdd(R)),T=R.redISub(I),L=q.redMul(T);L=L.redIAdd(L).redISub(U);var E=F.redMul(N);g+1<f&&(D=D.redMul(U)),w=I,N=E,F=L}return this.curve.jpoint(w,F.redMul(v),N)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var f,g,y;if(this.zOne){var b=this.x.redSqr(),v=this.y.redSqr(),w=v.redSqr(),S=this.x.redAdd(v).redSqr().redISub(b).redISub(w);S=S.redIAdd(S);var N=b.redAdd(b).redIAdd(b),D=N.redSqr().redISub(S).redISub(S),F=w.redIAdd(w);F=(F=F.redIAdd(F)).redIAdd(F),f=D,g=N.redMul(S.redISub(D)).redISub(F),y=this.y.redAdd(this.y)}else{var G=this.x.redSqr(),P=this.y.redSqr(),U=P.redSqr(),q=this.x.redAdd(P).redSqr().redISub(G).redISub(U);q=q.redIAdd(q);var R=G.redAdd(G).redIAdd(G),I=R.redSqr(),T=U.redIAdd(U);T=(T=T.redIAdd(T)).redIAdd(T),f=I.redISub(q).redISub(q),g=R.redMul(q.redISub(f)).redISub(T),y=(y=this.y.redMul(this.z)).redIAdd(y)}return this.curve.jpoint(f,g,y)},h.prototype._threeDbl=function(){var f,g,y;if(this.zOne){var b=this.x.redSqr(),v=this.y.redSqr(),w=v.redSqr(),S=this.x.redAdd(v).redSqr().redISub(b).redISub(w);S=S.redIAdd(S);var N=b.redAdd(b).redIAdd(b).redIAdd(this.curve.a),D=N.redSqr().redISub(S).redISub(S);f=D;var F=w.redIAdd(w);F=(F=F.redIAdd(F)).redIAdd(F),g=N.redMul(S.redISub(D)).redISub(F),y=this.y.redAdd(this.y)}else{var G=this.z.redSqr(),P=this.y.redSqr(),U=this.x.redMul(P),q=this.x.redSub(G).redMul(this.x.redAdd(G));q=q.redAdd(q).redIAdd(q);var R=U.redIAdd(U),I=(R=R.redIAdd(R)).redAdd(R);f=q.redSqr().redISub(I),y=this.y.redAdd(this.z).redSqr().redISub(P).redISub(G);var T=P.redSqr();T=(T=(T=T.redIAdd(T)).redIAdd(T)).redIAdd(T),g=q.redMul(R.redISub(f)).redISub(T)}return this.curve.jpoint(f,g,y)},h.prototype._dbl=function(){var f=this.curve.a,g=this.x,y=this.y,b=this.z,v=b.redSqr().redSqr(),w=g.redSqr(),S=y.redSqr(),N=w.redAdd(w).redIAdd(w).redIAdd(f.redMul(v)),D=g.redAdd(g),F=(D=D.redIAdd(D)).redMul(S),G=N.redSqr().redISub(F.redAdd(F)),P=F.redISub(G),U=S.redSqr();U=(U=(U=U.redIAdd(U)).redIAdd(U)).redIAdd(U);var q=N.redMul(P).redISub(U),R=y.redAdd(y).redMul(b);return this.curve.jpoint(G,q,R)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var f=this.x.redSqr(),g=this.y.redSqr(),y=this.z.redSqr(),b=g.redSqr(),v=f.redAdd(f).redIAdd(f),w=v.redSqr(),S=this.x.redAdd(g).redSqr().redISub(f).redISub(b),N=(S=(S=(S=S.redIAdd(S)).redAdd(S).redIAdd(S)).redISub(w)).redSqr(),D=b.redIAdd(b);D=(D=(D=D.redIAdd(D)).redIAdd(D)).redIAdd(D);var F=v.redIAdd(S).redSqr().redISub(w).redISub(N).redISub(D),G=g.redMul(F);G=(G=G.redIAdd(G)).redIAdd(G);var P=this.x.redMul(N).redISub(G);P=(P=P.redIAdd(P)).redIAdd(P);var U=this.y.redMul(F.redMul(D.redISub(F)).redISub(S.redMul(N)));U=(U=(U=U.redIAdd(U)).redIAdd(U)).redIAdd(U);var q=this.z.redAdd(S).redSqr().redISub(y).redISub(N);return this.curve.jpoint(P,U,q)},h.prototype.mul=function(f,g){return f=new a(f,g),this.curve._wnafMul(this,f)},h.prototype.eq=function(f){if(f.type==="affine")return this.eq(f.toJ());if(this===f)return!0;var g=this.z.redSqr(),y=f.z.redSqr();if(this.x.redMul(y).redISub(f.x.redMul(g)).cmpn(0)!==0)return!1;var b=g.redMul(this.z),v=y.redMul(f.z);return this.y.redMul(v).redISub(f.y.redMul(b)).cmpn(0)===0},h.prototype.eqXToP=function(f){var g=this.z.redSqr(),y=f.toRed(this.curve.red).redMul(g);if(this.x.cmp(y)===0)return!0;for(var b=f.clone(),v=this.curve.redN.redMul(g);;){if(b.iadd(this.curve.n),b.cmp(this.curve.p)>=0)return!1;if(y.redIAdd(v),this.x.cmp(y)===0)return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(t,r,o){var s,a=o,u=t("hash.js"),l=t("./curve"),i=t("./utils").assert;function c(h){h.type==="short"?this.curve=new l.short(h):h.type==="edwards"?this.curve=new l.edwards(h):this.curve=new l.mont(h),this.g=this.curve.g,this.n=this.curve.n,this.hash=h.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function p(h,f){Object.defineProperty(a,h,{configurable:!0,enumerable:!0,get:function(){var g=new c(f);return Object.defineProperty(a,h,{configurable:!0,enumerable:!0,value:g}),g}})}a.PresetCurve=c,p("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:u.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),p("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:u.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),p("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:u.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),p("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:u.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),p("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:u.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),p("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:u.sha256,gRed:!1,g:["9"]}),p("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:u.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{s=t("./precomputed/secp256k1")}catch{s=void 0}p("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:u.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",s]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(t,r,o){var s=t("bn.js"),a=t("hmac-drbg"),u=t("../utils"),l=t("../curves"),i=t("brorand"),c=u.assert,p=t("./key"),h=t("./signature");function f(g){if(!(this instanceof f))return new f(g);typeof g=="string"&&(c(Object.prototype.hasOwnProperty.call(l,g),"Unknown curve "+g),g=l[g]),g instanceof l.PresetCurve&&(g={curve:g}),this.curve=g.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=g.curve.g,this.g.precompute(g.curve.n.bitLength()+1),this.hash=g.hash||g.curve.hash}r.exports=f,f.prototype.keyPair=function(g){return new p(this,g)},f.prototype.keyFromPrivate=function(g,y){return p.fromPrivate(this,g,y)},f.prototype.keyFromPublic=function(g,y){return p.fromPublic(this,g,y)},f.prototype.genKeyPair=function(g){g||(g={});for(var y=new a({hash:this.hash,pers:g.pers,persEnc:g.persEnc||"utf8",entropy:g.entropy||i(this.hash.hmacStrength),entropyEnc:g.entropy&&g.entropyEnc||"utf8",nonce:this.n.toArray()}),b=this.n.byteLength(),v=this.n.sub(new s(2));;){var w=new s(y.generate(b));if(!(w.cmp(v)>0))return w.iaddn(1),this.keyFromPrivate(w)}},f.prototype._truncateToN=function(g,y){var b=8*g.byteLength()-this.n.bitLength();return b>0&&(g=g.ushrn(b)),!y&&g.cmp(this.n)>=0?g.sub(this.n):g},f.prototype.sign=function(g,y,b,v){typeof b=="object"&&(v=b,b=null),v||(v={}),y=this.keyFromPrivate(y,b),g=this._truncateToN(new s(g,16));for(var w=this.n.byteLength(),S=y.getPrivate().toArray("be",w),N=g.toArray("be",w),D=new a({hash:this.hash,entropy:S,nonce:N,pers:v.pers,persEnc:v.persEnc||"utf8"}),F=this.n.sub(new s(1)),G=0;;G++){var P=v.k?v.k(G):new s(D.generate(this.n.byteLength()));if(!((P=this._truncateToN(P,!0)).cmpn(1)<=0||P.cmp(F)>=0)){var U=this.g.mul(P);if(!U.isInfinity()){var q=U.getX(),R=q.umod(this.n);if(R.cmpn(0)!==0){var I=P.invm(this.n).mul(R.mul(y.getPrivate()).iadd(g));if((I=I.umod(this.n)).cmpn(0)!==0){var T=(U.getY().isOdd()?1:0)|(q.cmp(R)!==0?2:0);return v.canonical&&I.cmp(this.nh)>0&&(I=this.n.sub(I),T^=1),new h({r:R,s:I,recoveryParam:T})}}}}}},f.prototype.verify=function(g,y,b,v){g=this._truncateToN(new s(g,16)),b=this.keyFromPublic(b,v);var w=(y=new h(y,"hex")).r,S=y.s;if(w.cmpn(1)<0||w.cmp(this.n)>=0||S.cmpn(1)<0||S.cmp(this.n)>=0)return!1;var N,D=S.invm(this.n),F=D.mul(g).umod(this.n),G=D.mul(w).umod(this.n);return this.curve._maxwellTrick?!(N=this.g.jmulAdd(F,b.getPublic(),G)).isInfinity()&&N.eqXToP(w):!(N=this.g.mulAdd(F,b.getPublic(),G)).isInfinity()&&N.getX().umod(this.n).cmp(w)===0},f.prototype.recoverPubKey=function(g,y,b,v){c((3&b)===b,"The recovery param is more than two bits"),y=new h(y,v);var w=this.n,S=new s(g),N=y.r,D=y.s,F=1&b,G=b>>1;if(N.cmp(this.curve.p.umod(this.curve.n))>=0&&G)throw new Error("Unable to find sencond key candinate");N=G?this.curve.pointFromX(N.add(this.curve.n),F):this.curve.pointFromX(N,F);var P=y.r.invm(w),U=w.sub(S).mul(P).umod(w),q=D.mul(P).umod(w);return this.g.mulAdd(U,N,q)},f.prototype.getKeyRecoveryParam=function(g,y,b,v){if((y=new h(y,v)).recoveryParam!==null)return y.recoveryParam;for(var w=0;w<4;w++){var S;try{S=this.recoverPubKey(g,y,w)}catch{continue}if(S.eq(b))return w}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(t,r,o){var s=t("bn.js"),a=t("../utils").assert;function u(l,i){this.ec=l,this.priv=null,this.pub=null,i.priv&&this._importPrivate(i.priv,i.privEnc),i.pub&&this._importPublic(i.pub,i.pubEnc)}r.exports=u,u.fromPublic=function(l,i,c){return i instanceof u?i:new u(l,{pub:i,pubEnc:c})},u.fromPrivate=function(l,i,c){return i instanceof u?i:new u(l,{priv:i,privEnc:c})},u.prototype.validate=function(){var l=this.getPublic();return l.isInfinity()?{result:!1,reason:"Invalid public key"}:l.validate()?l.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},u.prototype.getPublic=function(l,i){return typeof l=="string"&&(i=l,l=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),i?this.pub.encode(i,l):this.pub},u.prototype.getPrivate=function(l){return l==="hex"?this.priv.toString(16,2):this.priv},u.prototype._importPrivate=function(l,i){this.priv=new s(l,i||16),this.priv=this.priv.umod(this.ec.curve.n)},u.prototype._importPublic=function(l,i){if(l.x||l.y)return this.ec.curve.type==="mont"?a(l.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||a(l.x&&l.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(l.x,l.y));this.pub=this.ec.curve.decodePoint(l,i)},u.prototype.derive=function(l){return l.validate()||a(l.validate(),"public point not validated"),l.mul(this.priv).getX()},u.prototype.sign=function(l,i,c){return this.ec.sign(l,this,i,c)},u.prototype.verify=function(l,i){return this.ec.verify(l,i,this)},u.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(t,r,o){var s=t("bn.js"),a=t("../utils"),u=a.assert;function l(f,g){if(f instanceof l)return f;this._importDER(f,g)||(u(f.r&&f.s,"Signature without r or s"),this.r=new s(f.r,16),this.s=new s(f.s,16),f.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=f.recoveryParam)}function i(){this.place=0}function c(f,g){var y=f[g.place++];if(!(128&y))return y;var b=15&y;if(b===0||b>4)return!1;for(var v=0,w=0,S=g.place;w<b;w++,S++)v<<=8,v|=f[S],v>>>=0;return!(v<=127)&&(g.place=S,v)}function p(f){for(var g=0,y=f.length-1;!f[g]&&!(128&f[g+1])&&g<y;)g++;return g===0?f:f.slice(g)}function h(f,g){if(g<128)f.push(g);else{var y=1+(Math.log(g)/Math.LN2>>>3);for(f.push(128|y);--y;)f.push(g>>>(y<<3)&255);f.push(g)}}r.exports=l,l.prototype._importDER=function(f,g){f=a.toArray(f,g);var y=new i;if(f[y.place++]!==48)return!1;var b=c(f,y);if(b===!1||b+y.place!==f.length||f[y.place++]!==2)return!1;var v=c(f,y);if(v===!1)return!1;var w=f.slice(y.place,v+y.place);if(y.place+=v,f[y.place++]!==2)return!1;var S=c(f,y);if(S===!1||f.length!==S+y.place)return!1;var N=f.slice(y.place,S+y.place);if(w[0]===0){if(!(128&w[1]))return!1;w=w.slice(1)}if(N[0]===0){if(!(128&N[1]))return!1;N=N.slice(1)}return this.r=new s(w),this.s=new s(N),this.recoveryParam=null,!0},l.prototype.toDER=function(f){var g=this.r.toArray(),y=this.s.toArray();for(128&g[0]&&(g=[0].concat(g)),128&y[0]&&(y=[0].concat(y)),g=p(g),y=p(y);!(y[0]||128&y[1]);)y=y.slice(1);var b=[2];h(b,g.length),(b=b.concat(g)).push(2),h(b,y.length);var v=b.concat(y),w=[48];return h(w,v.length),w=w.concat(v),a.encode(w,f)}},{"../utils":419,"bn.js":420}],415:[function(t,r,o){var s=t("hash.js"),a=t("../curves"),u=t("../utils"),l=u.assert,i=u.parseBytes,c=t("./key"),p=t("./signature");function h(f){if(l(f==="ed25519","only tested with ed25519 so far"),!(this instanceof h))return new h(f);f=a[f].curve,this.curve=f,this.g=f.g,this.g.precompute(f.n.bitLength()+1),this.pointClass=f.point().constructor,this.encodingLength=Math.ceil(f.n.bitLength()/8),this.hash=s.sha512}r.exports=h,h.prototype.sign=function(f,g){f=i(f);var y=this.keyFromSecret(g),b=this.hashInt(y.messagePrefix(),f),v=this.g.mul(b),w=this.encodePoint(v),S=this.hashInt(w,y.pubBytes(),f).mul(y.priv()),N=b.add(S).umod(this.curve.n);return this.makeSignature({R:v,S:N,Rencoded:w})},h.prototype.verify=function(f,g,y){f=i(f),g=this.makeSignature(g);var b=this.keyFromPublic(y),v=this.hashInt(g.Rencoded(),b.pubBytes(),f),w=this.g.mul(g.S());return g.R().add(b.pub().mul(v)).eq(w)},h.prototype.hashInt=function(){for(var f=this.hash(),g=0;g<arguments.length;g++)f.update(arguments[g]);return u.intFromLE(f.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(f){return c.fromPublic(this,f)},h.prototype.keyFromSecret=function(f){return c.fromSecret(this,f)},h.prototype.makeSignature=function(f){return f instanceof p?f:new p(this,f)},h.prototype.encodePoint=function(f){var g=f.getY().toArray("le",this.encodingLength);return g[this.encodingLength-1]|=f.getX().isOdd()?128:0,g},h.prototype.decodePoint=function(f){var g=(f=u.parseBytes(f)).length-1,y=f.slice(0,g).concat(-129&f[g]),b=(128&f[g])!=0,v=u.intFromLE(y);return this.curve.pointFromY(v,b)},h.prototype.encodeInt=function(f){return f.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(f){return u.intFromLE(f)},h.prototype.isPoint=function(f){return f instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(t,r,o){var s=t("../utils"),a=s.assert,u=s.parseBytes,l=s.cachedProperty;function i(c,p){this.eddsa=c,this._secret=u(p.secret),c.isPoint(p.pub)?this._pub=p.pub:this._pubBytes=u(p.pub)}i.fromPublic=function(c,p){return p instanceof i?p:new i(c,{pub:p})},i.fromSecret=function(c,p){return p instanceof i?p:new i(c,{secret:p})},i.prototype.secret=function(){return this._secret},l(i,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),l(i,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),l(i,"privBytes",(function(){var c=this.eddsa,p=this.hash(),h=c.encodingLength-1,f=p.slice(0,c.encodingLength);return f[0]&=248,f[h]&=127,f[h]|=64,f})),l(i,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),l(i,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),l(i,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),i.prototype.sign=function(c){return a(this._secret,"KeyPair can only verify"),this.eddsa.sign(c,this)},i.prototype.verify=function(c,p){return this.eddsa.verify(c,p,this)},i.prototype.getSecret=function(c){return a(this._secret,"KeyPair is public only"),s.encode(this.secret(),c)},i.prototype.getPublic=function(c){return s.encode(this.pubBytes(),c)},r.exports=i},{"../utils":419}],417:[function(t,r,o){var s=t("bn.js"),a=t("../utils"),u=a.assert,l=a.cachedProperty,i=a.parseBytes;function c(p,h){this.eddsa=p,typeof h!="object"&&(h=i(h)),Array.isArray(h)&&(h={R:h.slice(0,p.encodingLength),S:h.slice(p.encodingLength)}),u(h.R&&h.S,"Signature without R or S"),p.isPoint(h.R)&&(this._R=h.R),h.S instanceof s&&(this._S=h.S),this._Rencoded=Array.isArray(h.R)?h.R:h.Rencoded,this._Sencoded=Array.isArray(h.S)?h.S:h.Sencoded}l(c,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),l(c,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),l(c,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),l(c,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return a.encode(this.toBytes(),"hex").toUpperCase()},r.exports=c},{"../utils":419,"bn.js":420}],418:[function(t,r,o){r.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(t,r,o){var s=o,a=t("bn.js"),u=t("minimalistic-assert"),l=t("minimalistic-crypto-utils");s.assert=u,s.toArray=l.toArray,s.zero2=l.zero2,s.toHex=l.toHex,s.encode=l.encode,s.getNAF=function(i,c,p){var h=new Array(Math.max(i.bitLength(),p)+1);h.fill(0);for(var f=1<<c+1,g=i.clone(),y=0;y<h.length;y++){var b,v=g.andln(f-1);g.isOdd()?(b=v>(f>>1)-1?(f>>1)-v:v,g.isubn(b)):b=0,h[y]=b,g.iushrn(1)}return h},s.getJSF=function(i,c){var p=[[],[]];i=i.clone(),c=c.clone();for(var h,f=0,g=0;i.cmpn(-f)>0||c.cmpn(-g)>0;){var y,b,v=i.andln(3)+f&3,w=c.andln(3)+g&3;v===3&&(v=-1),w===3&&(w=-1),y=(1&v)==0?0:(h=i.andln(7)+f&7)!==3&&h!==5||w!==2?v:-v,p[0].push(y),b=(1&w)==0?0:(h=c.andln(7)+g&7)!==3&&h!==5||v!==2?w:-w,p[1].push(b),2*f===y+1&&(f=1-f),2*g===b+1&&(g=1-g),i.iushrn(1),c.iushrn(1)}return p},s.cachedProperty=function(i,c,p){var h="_"+c;i.prototype[c]=function(){return this[h]!==void 0?this[h]:this[h]=p.call(this)}},s.parseBytes=function(i){return typeof i=="string"?s.toArray(i,"hex"):i},s.intFromLE=function(i){return new a(i,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(t,r,o){arguments[4][184][0].apply(o,arguments)},{buffer:188,dup:184}],421:[function(t,r,o){r.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(t,r,o){var s=Object.create||function(P){var U=function(){};return U.prototype=P,new U},a=Object.keys||function(P){var U=[];for(var q in P)Object.prototype.hasOwnProperty.call(P,q)&&U.push(q);return q},u=Function.prototype.bind||function(P){var U=this;return function(){return U.apply(P,arguments)}};function l(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=s(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}r.exports=l,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._maxListeners=void 0;var i,c=10;try{var p={};Object.defineProperty&&Object.defineProperty(p,"x",{value:0}),i=p.x===0}catch{i=!1}function h(P){return P._maxListeners===void 0?l.defaultMaxListeners:P._maxListeners}function f(P,U,q){if(U)P.call(q);else for(var R=P.length,I=G(P,R),T=0;T<R;++T)I[T].call(q)}function g(P,U,q,R){if(U)P.call(q,R);else for(var I=P.length,T=G(P,I),L=0;L<I;++L)T[L].call(q,R)}function y(P,U,q,R,I){if(U)P.call(q,R,I);else for(var T=P.length,L=G(P,T),E=0;E<T;++E)L[E].call(q,R,I)}function b(P,U,q,R,I,T){if(U)P.call(q,R,I,T);else for(var L=P.length,E=G(P,L),x=0;x<L;++x)E[x].call(q,R,I,T)}function v(P,U,q,R){if(U)P.apply(q,R);else for(var I=P.length,T=G(P,I),L=0;L<I;++L)T[L].apply(q,R)}function w(P,U,q,R){var I,T,L;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if((T=P._events)?(T.newListener&&(P.emit("newListener",U,q.listener?q.listener:q),T=P._events),L=T[U]):(T=P._events=s(null),P._eventsCount=0),L){if(typeof L=="function"?L=T[U]=R?[q,L]:[L,q]:R?L.unshift(q):L.push(q),!L.warned&&(I=h(P))&&I>0&&L.length>I){L.warned=!0;var E=new Error("Possible EventEmitter memory leak detected. "+L.length+' "'+String(U)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');E.name="MaxListenersExceededWarning",E.emitter=P,E.type=U,E.count=L.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",E.name,E.message)}}else L=T[U]=q,++P._eventsCount;return P}function S(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var P=new Array(arguments.length),U=0;U<P.length;++U)P[U]=arguments[U];this.listener.apply(this.target,P)}}function N(P,U,q){var R={fired:!1,wrapFn:void 0,target:P,type:U,listener:q},I=u.call(S,R);return I.listener=q,R.wrapFn=I,I}function D(P,U,q){var R=P._events;if(!R)return[];var I=R[U];return I?typeof I=="function"?q?[I.listener||I]:[I]:q?(function(T){for(var L=new Array(T.length),E=0;E<L.length;++E)L[E]=T[E].listener||T[E];return L})(I):G(I,I.length):[]}function F(P){var U=this._events;if(U){var q=U[P];if(typeof q=="function")return 1;if(q)return q.length}return 0}function G(P,U){for(var q=new Array(U),R=0;R<U;++R)q[R]=P[R];return q}i?Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(P){if(typeof P!="number"||P<0||P!=P)throw new TypeError('"defaultMaxListeners" must be a positive number');c=P}}):l.defaultMaxListeners=c,l.prototype.setMaxListeners=function(P){if(typeof P!="number"||P<0||isNaN(P))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=P,this},l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(P){var U,q,R,I,T,L,E=P==="error";if(L=this._events)E=E&&L.error==null;else if(!E)return!1;if(E){if(arguments.length>1&&(U=arguments[1]),U instanceof Error)throw U;var x=new Error('Unhandled "error" event. ('+U+")");throw x.context=U,x}if(!(q=L[P]))return!1;var k=typeof q=="function";switch(R=arguments.length){case 1:f(q,k,this);break;case 2:g(q,k,this,arguments[1]);break;case 3:y(q,k,this,arguments[1],arguments[2]);break;case 4:b(q,k,this,arguments[1],arguments[2],arguments[3]);break;default:for(I=new Array(R-1),T=1;T<R;T++)I[T-1]=arguments[T];v(q,k,this,I)}return!0},l.prototype.addListener=function(P,U){return w(this,P,U,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(P,U){return w(this,P,U,!0)},l.prototype.once=function(P,U){if(typeof U!="function")throw new TypeError('"listener" argument must be a function');return this.on(P,N(this,P,U)),this},l.prototype.prependOnceListener=function(P,U){if(typeof U!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(P,N(this,P,U)),this},l.prototype.removeListener=function(P,U){var q,R,I,T,L;if(typeof U!="function")throw new TypeError('"listener" argument must be a function');if(!(R=this._events))return this;if(!(q=R[P]))return this;if(q===U||q.listener===U)--this._eventsCount==0?this._events=s(null):(delete R[P],R.removeListener&&this.emit("removeListener",P,q.listener||U));else if(typeof q!="function"){for(I=-1,T=q.length-1;T>=0;T--)if(q[T]===U||q[T].listener===U){L=q[T].listener,I=T;break}if(I<0)return this;I===0?q.shift():(function(E,x){for(var k=x,A=k+1,C=E.length;A<C;k+=1,A+=1)E[k]=E[A];E.pop()})(q,I),q.length===1&&(R[P]=q[0]),R.removeListener&&this.emit("removeListener",P,L||U)}return this},l.prototype.removeAllListeners=function(P){var U,q,R;if(!(q=this._events))return this;if(!q.removeListener)return arguments.length===0?(this._events=s(null),this._eventsCount=0):q[P]&&(--this._eventsCount==0?this._events=s(null):delete q[P]),this;if(arguments.length===0){var I,T=a(q);for(R=0;R<T.length;++R)(I=T[R])!=="removeListener"&&this.removeAllListeners(I);return this.removeAllListeners("removeListener"),this._events=s(null),this._eventsCount=0,this}if(typeof(U=q[P])=="function")this.removeListener(P,U);else if(U)for(R=U.length-1;R>=0;R--)this.removeListener(P,U[R]);return this},l.prototype.listeners=function(P){return D(this,P,!0)},l.prototype.rawListeners=function(P){return D(this,P,!1)},l.listenerCount=function(P,U){return typeof P.listenerCount=="function"?P.listenerCount(U):F.call(P,U)},l.prototype.listenerCount=F,l.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(t,r,o){var s=t("safe-buffer").Buffer,a=t("md5.js");r.exports=function(u,l,i,c){if(s.isBuffer(u)||(u=s.from(u,"binary")),l&&(s.isBuffer(l)||(l=s.from(l,"binary")),l.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var p=i/8,h=s.alloc(p),f=s.alloc(c||0),g=s.alloc(0);p>0||c>0;){var y=new a;y.update(g),y.update(u),l&&y.update(l),g=y.digest();var b=0;if(p>0){var v=h.length-p;b=Math.min(p,g.length),g.copy(h,v,0,b),p-=b}if(b<g.length&&c>0){var w=f.length-c,S=Math.min(c,g.length-b);g.copy(f,w,b,b+S),c-=S}}return g.fill(0),{key:h,iv:f}}},{"md5.js":450,"safe-buffer":494}],424:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.CsvParserStream=o.ParserOptions=o.parseFile=o.parseStream=o.parseString=o.parse=o.FormatterOptions=o.CsvFormatterStream=o.writeToPath=o.writeToString=o.writeToBuffer=o.writeToStream=o.write=o.format=void 0;var s=t("@fast-csv/format");Object.defineProperty(o,"format",{enumerable:!0,get:function(){return s.format}}),Object.defineProperty(o,"write",{enumerable:!0,get:function(){return s.write}}),Object.defineProperty(o,"writeToStream",{enumerable:!0,get:function(){return s.writeToStream}}),Object.defineProperty(o,"writeToBuffer",{enumerable:!0,get:function(){return s.writeToBuffer}}),Object.defineProperty(o,"writeToString",{enumerable:!0,get:function(){return s.writeToString}}),Object.defineProperty(o,"writeToPath",{enumerable:!0,get:function(){return s.writeToPath}}),Object.defineProperty(o,"CsvFormatterStream",{enumerable:!0,get:function(){return s.CsvFormatterStream}}),Object.defineProperty(o,"FormatterOptions",{enumerable:!0,get:function(){return s.FormatterOptions}});var a=t("@fast-csv/parse");Object.defineProperty(o,"parse",{enumerable:!0,get:function(){return a.parse}}),Object.defineProperty(o,"parseString",{enumerable:!0,get:function(){return a.parseString}}),Object.defineProperty(o,"parseStream",{enumerable:!0,get:function(){return a.parseStream}}),Object.defineProperty(o,"parseFile",{enumerable:!0,get:function(){return a.parseFile}}),Object.defineProperty(o,"ParserOptions",{enumerable:!0,get:function(){return a.ParserOptions}}),Object.defineProperty(o,"CsvParserStream",{enumerable:!0,get:function(){return a.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(t,r,o){var s=t("safe-buffer").Buffer,a=t("readable-stream").Transform;function u(l){a.call(this),this._block=s.allocUnsafe(l),this._blockSize=l,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}t("inherits")(u,a),u.prototype._transform=function(l,i,c){var p=null;try{this.update(l,i)}catch(h){p=h}c(p)},u.prototype._flush=function(l){var i=null;try{this.push(this.digest())}catch(c){i=c}l(i)},u.prototype.update=function(l,i){if((function(y,b){if(!s.isBuffer(y)&&typeof y!="string")throw new TypeError(b+" must be a string or a buffer")})(l,"Data"),this._finalized)throw new Error("Digest already called");s.isBuffer(l)||(l=s.from(l,i));for(var c=this._block,p=0;this._blockOffset+l.length-p>=this._blockSize;){for(var h=this._blockOffset;h<this._blockSize;)c[h++]=l[p++];this._update(),this._blockOffset=0}for(;p<l.length;)c[this._blockOffset++]=l[p++];for(var f=0,g=8*l.length;g>0;++f)this._length[f]+=g,(g=this._length[f]/4294967296|0)>0&&(this._length[f]-=4294967296*g);return this},u.prototype._update=function(){throw new Error("_update is not implemented")},u.prototype.digest=function(l){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var i=this._digest();l!==void 0&&(i=i.toString(l)),this._block.fill(0),this._blockOffset=0;for(var c=0;c<4;++c)this._length[c]=0;return i},u.prototype._digest=function(){throw new Error("_digest is not implemented")},r.exports=u},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(t,r,o){var s=o;s.utils=t("./hash/utils"),s.common=t("./hash/common"),s.sha=t("./hash/sha"),s.ripemd=t("./hash/ripemd"),s.hmac=t("./hash/hmac"),s.sha1=s.sha.sha1,s.sha256=s.sha.sha256,s.sha224=s.sha.sha224,s.sha384=s.sha.sha384,s.sha512=s.sha.sha512,s.ripemd160=s.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(t,r,o){var s=t("./utils"),a=t("minimalistic-assert");function u(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}o.BlockHash=u,u.prototype.update=function(l,i){if(l=s.toArray(l,i),this.pending?this.pending=this.pending.concat(l):this.pending=l,this.pendingTotal+=l.length,this.pending.length>=this._delta8){var c=(l=this.pending).length%this._delta8;this.pending=l.slice(l.length-c,l.length),this.pending.length===0&&(this.pending=null),l=s.join32(l,0,l.length-c,this.endian);for(var p=0;p<l.length;p+=this._delta32)this._update(l,p,p+this._delta32)}return this},u.prototype.digest=function(l){return this.update(this._pad()),a(this.pending===null),this._digest(l)},u.prototype._pad=function(){var l=this.pendingTotal,i=this._delta8,c=i-(l+this.padLength)%i,p=new Array(c+this.padLength);p[0]=128;for(var h=1;h<c;h++)p[h]=0;if(l<<=3,this.endian==="big"){for(var f=8;f<this.padLength;f++)p[h++]=0;p[h++]=0,p[h++]=0,p[h++]=0,p[h++]=0,p[h++]=l>>>24&255,p[h++]=l>>>16&255,p[h++]=l>>>8&255,p[h++]=255&l}else for(p[h++]=255&l,p[h++]=l>>>8&255,p[h++]=l>>>16&255,p[h++]=l>>>24&255,p[h++]=0,p[h++]=0,p[h++]=0,p[h++]=0,f=8;f<this.padLength;f++)p[h++]=0;return p}},{"./utils":437,"minimalistic-assert":453}],428:[function(t,r,o){var s=t("./utils"),a=t("minimalistic-assert");function u(l,i,c){if(!(this instanceof u))return new u(l,i,c);this.Hash=l,this.blockSize=l.blockSize/8,this.outSize=l.outSize/8,this.inner=null,this.outer=null,this._init(s.toArray(i,c))}r.exports=u,u.prototype._init=function(l){l.length>this.blockSize&&(l=new this.Hash().update(l).digest()),a(l.length<=this.blockSize);for(var i=l.length;i<this.blockSize;i++)l.push(0);for(i=0;i<l.length;i++)l[i]^=54;for(this.inner=new this.Hash().update(l),i=0;i<l.length;i++)l[i]^=106;this.outer=new this.Hash().update(l)},u.prototype.update=function(l,i){return this.inner.update(l,i),this},u.prototype.digest=function(l){return this.outer.update(this.inner.digest()),this.outer.digest(l)}},{"./utils":437,"minimalistic-assert":453}],429:[function(t,r,o){var s=t("./utils"),a=t("./common"),u=s.rotl32,l=s.sum32,i=s.sum32_3,c=s.sum32_4,p=a.BlockHash;function h(){if(!(this instanceof h))return new h;p.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function f(N,D,F,G){return N<=15?D^F^G:N<=31?D&F|~D&G:N<=47?(D|~F)^G:N<=63?D&G|F&~G:D^(F|~G)}function g(N){return N<=15?0:N<=31?1518500249:N<=47?1859775393:N<=63?2400959708:2840853838}function y(N){return N<=15?1352829926:N<=31?1548603684:N<=47?1836072691:N<=63?2053994217:0}s.inherits(h,p),o.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(N,D){for(var F=this.h[0],G=this.h[1],P=this.h[2],U=this.h[3],q=this.h[4],R=F,I=G,T=P,L=U,E=q,x=0;x<80;x++){var k=l(u(c(F,f(x,G,P,U),N[b[x]+D],g(x)),w[x]),q);F=q,q=U,U=u(P,10),P=G,G=k,k=l(u(c(R,f(79-x,I,T,L),N[v[x]+D],y(x)),S[x]),E),R=E,E=L,L=u(T,10),T=I,I=k}k=i(this.h[1],P,L),this.h[1]=i(this.h[2],U,E),this.h[2]=i(this.h[3],q,R),this.h[3]=i(this.h[4],F,I),this.h[4]=i(this.h[0],G,T),this.h[0]=k},h.prototype._digest=function(N){return N==="hex"?s.toHex32(this.h,"little"):s.split32(this.h,"little")};var b=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],v=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],w=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],S=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(t,r,o){o.sha1=t("./sha/1"),o.sha224=t("./sha/224"),o.sha256=t("./sha/256"),o.sha384=t("./sha/384"),o.sha512=t("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(t,r,o){var s=t("../utils"),a=t("../common"),u=t("./common"),l=s.rotl32,i=s.sum32,c=s.sum32_5,p=u.ft_1,h=a.BlockHash,f=[1518500249,1859775393,2400959708,3395469782];function g(){if(!(this instanceof g))return new g;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}s.inherits(g,h),r.exports=g,g.blockSize=512,g.outSize=160,g.hmacStrength=80,g.padLength=64,g.prototype._update=function(y,b){for(var v=this.W,w=0;w<16;w++)v[w]=y[b+w];for(;w<v.length;w++)v[w]=l(v[w-3]^v[w-8]^v[w-14]^v[w-16],1);var S=this.h[0],N=this.h[1],D=this.h[2],F=this.h[3],G=this.h[4];for(w=0;w<v.length;w++){var P=~~(w/20),U=c(l(S,5),p(P,N,D,F),G,v[w],f[P]);G=F,F=D,D=l(N,30),N=S,S=U}this.h[0]=i(this.h[0],S),this.h[1]=i(this.h[1],N),this.h[2]=i(this.h[2],D),this.h[3]=i(this.h[3],F),this.h[4]=i(this.h[4],G)},g.prototype._digest=function(y){return y==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(t,r,o){var s=t("../utils"),a=t("./256");function u(){if(!(this instanceof u))return new u;a.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}s.inherits(u,a),r.exports=u,u.blockSize=512,u.outSize=224,u.hmacStrength=192,u.padLength=64,u.prototype._digest=function(l){return l==="hex"?s.toHex32(this.h.slice(0,7),"big"):s.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(t,r,o){var s=t("../utils"),a=t("../common"),u=t("./common"),l=t("minimalistic-assert"),i=s.sum32,c=s.sum32_4,p=s.sum32_5,h=u.ch32,f=u.maj32,g=u.s0_256,y=u.s1_256,b=u.g0_256,v=u.g1_256,w=a.BlockHash,S=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function N(){if(!(this instanceof N))return new N;w.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=S,this.W=new Array(64)}s.inherits(N,w),r.exports=N,N.blockSize=512,N.outSize=256,N.hmacStrength=192,N.padLength=64,N.prototype._update=function(D,F){for(var G=this.W,P=0;P<16;P++)G[P]=D[F+P];for(;P<G.length;P++)G[P]=c(v(G[P-2]),G[P-7],b(G[P-15]),G[P-16]);var U=this.h[0],q=this.h[1],R=this.h[2],I=this.h[3],T=this.h[4],L=this.h[5],E=this.h[6],x=this.h[7];for(l(this.k.length===G.length),P=0;P<G.length;P++){var k=p(x,y(T),h(T,L,E),this.k[P],G[P]),A=i(g(U),f(U,q,R));x=E,E=L,L=T,T=i(I,k),I=R,R=q,q=U,U=i(k,A)}this.h[0]=i(this.h[0],U),this.h[1]=i(this.h[1],q),this.h[2]=i(this.h[2],R),this.h[3]=i(this.h[3],I),this.h[4]=i(this.h[4],T),this.h[5]=i(this.h[5],L),this.h[6]=i(this.h[6],E),this.h[7]=i(this.h[7],x)},N.prototype._digest=function(D){return D==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(t,r,o){var s=t("../utils"),a=t("./512");function u(){if(!(this instanceof u))return new u;a.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}s.inherits(u,a),r.exports=u,u.blockSize=1024,u.outSize=384,u.hmacStrength=192,u.padLength=128,u.prototype._digest=function(l){return l==="hex"?s.toHex32(this.h.slice(0,12),"big"):s.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(t,r,o){var s=t("../utils"),a=t("../common"),u=t("minimalistic-assert"),l=s.rotr64_hi,i=s.rotr64_lo,c=s.shr64_hi,p=s.shr64_lo,h=s.sum64,f=s.sum64_hi,g=s.sum64_lo,y=s.sum64_4_hi,b=s.sum64_4_lo,v=s.sum64_5_hi,w=s.sum64_5_lo,S=a.BlockHash,N=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function D(){if(!(this instanceof D))return new D;S.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=N,this.W=new Array(160)}function F(A,C,j,B,O){var H=A&j^~A&O;return H<0&&(H+=4294967296),H}function G(A,C,j,B,O,H){var X=C&B^~C&H;return X<0&&(X+=4294967296),X}function P(A,C,j,B,O){var H=A&j^A&O^j&O;return H<0&&(H+=4294967296),H}function U(A,C,j,B,O,H){var X=C&B^C&H^B&H;return X<0&&(X+=4294967296),X}function q(A,C){var j=l(A,C,28)^l(C,A,2)^l(C,A,7);return j<0&&(j+=4294967296),j}function R(A,C){var j=i(A,C,28)^i(C,A,2)^i(C,A,7);return j<0&&(j+=4294967296),j}function I(A,C){var j=l(A,C,14)^l(A,C,18)^l(C,A,9);return j<0&&(j+=4294967296),j}function T(A,C){var j=i(A,C,14)^i(A,C,18)^i(C,A,9);return j<0&&(j+=4294967296),j}function L(A,C){var j=l(A,C,1)^l(A,C,8)^c(A,C,7);return j<0&&(j+=4294967296),j}function E(A,C){var j=i(A,C,1)^i(A,C,8)^p(A,C,7);return j<0&&(j+=4294967296),j}function x(A,C){var j=l(A,C,19)^l(C,A,29)^c(A,C,6);return j<0&&(j+=4294967296),j}function k(A,C){var j=i(A,C,19)^i(C,A,29)^p(A,C,6);return j<0&&(j+=4294967296),j}s.inherits(D,S),r.exports=D,D.blockSize=1024,D.outSize=512,D.hmacStrength=192,D.padLength=128,D.prototype._prepareBlock=function(A,C){for(var j=this.W,B=0;B<32;B++)j[B]=A[C+B];for(;B<j.length;B+=2){var O=x(j[B-4],j[B-3]),H=k(j[B-4],j[B-3]),X=j[B-14],et=j[B-13],V=L(j[B-30],j[B-29]),tt=E(j[B-30],j[B-29]),$=j[B-32],z=j[B-31];j[B]=y(O,H,X,et,V,tt,$,z),j[B+1]=b(O,H,X,et,V,tt,$,z)}},D.prototype._update=function(A,C){this._prepareBlock(A,C);var j=this.W,B=this.h[0],O=this.h[1],H=this.h[2],X=this.h[3],et=this.h[4],V=this.h[5],tt=this.h[6],$=this.h[7],z=this.h[8],Z=this.h[9],it=this.h[10],mt=this.h[11],lt=this.h[12],at=this.h[13],rt=this.h[14],ct=this.h[15];u(this.k.length===j.length);for(var ot=0;ot<j.length;ot+=2){var dt=rt,ft=ct,gt=I(z,Z),wt=T(z,Z),yt=F(z,Z,it,mt,lt),Et=G(z,Z,it,mt,lt,at),Mt=this.k[ot],qt=this.k[ot+1],Tt=j[ot],It=j[ot+1],Vt=v(dt,ft,gt,wt,yt,Et,Mt,qt,Tt,It),Kt=w(dt,ft,gt,wt,yt,Et,Mt,qt,Tt,It);dt=q(B,O),ft=R(B,O),gt=P(B,O,H,X,et),wt=U(B,O,H,X,et,V);var ne=f(dt,ft,gt,wt),ae=g(dt,ft,gt,wt);rt=lt,ct=at,lt=it,at=mt,it=z,mt=Z,z=f(tt,$,Vt,Kt),Z=g($,$,Vt,Kt),tt=et,$=V,et=H,V=X,H=B,X=O,B=f(Vt,Kt,ne,ae),O=g(Vt,Kt,ne,ae)}h(this.h,0,B,O),h(this.h,2,H,X),h(this.h,4,et,V),h(this.h,6,tt,$),h(this.h,8,z,Z),h(this.h,10,it,mt),h(this.h,12,lt,at),h(this.h,14,rt,ct)},D.prototype._digest=function(A){return A==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(t,r,o){var s=t("../utils").rotr32;function a(i,c,p){return i&c^~i&p}function u(i,c,p){return i&c^i&p^c&p}function l(i,c,p){return i^c^p}o.ft_1=function(i,c,p,h){return i===0?a(c,p,h):i===1||i===3?l(c,p,h):i===2?u(c,p,h):void 0},o.ch32=a,o.maj32=u,o.p32=l,o.s0_256=function(i){return s(i,2)^s(i,13)^s(i,22)},o.s1_256=function(i){return s(i,6)^s(i,11)^s(i,25)},o.g0_256=function(i){return s(i,7)^s(i,18)^i>>>3},o.g1_256=function(i){return s(i,17)^s(i,19)^i>>>10}},{"../utils":437}],437:[function(t,r,o){var s=t("minimalistic-assert"),a=t("inherits");function u(p,h){return(64512&p.charCodeAt(h))==55296&&!(h<0||h+1>=p.length)&&(64512&p.charCodeAt(h+1))==56320}function l(p){return(p>>>24|p>>>8&65280|p<<8&16711680|(255&p)<<24)>>>0}function i(p){return p.length===1?"0"+p:p}function c(p){return p.length===7?"0"+p:p.length===6?"00"+p:p.length===5?"000"+p:p.length===4?"0000"+p:p.length===3?"00000"+p:p.length===2?"000000"+p:p.length===1?"0000000"+p:p}o.inherits=a,o.toArray=function(p,h){if(Array.isArray(p))return p.slice();if(!p)return[];var f=[];if(typeof p=="string")if(h){if(h==="hex")for((p=p.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(p="0"+p),y=0;y<p.length;y+=2)f.push(parseInt(p[y]+p[y+1],16))}else for(var g=0,y=0;y<p.length;y++){var b=p.charCodeAt(y);b<128?f[g++]=b:b<2048?(f[g++]=b>>6|192,f[g++]=63&b|128):u(p,y)?(b=65536+((1023&b)<<10)+(1023&p.charCodeAt(++y)),f[g++]=b>>18|240,f[g++]=b>>12&63|128,f[g++]=b>>6&63|128,f[g++]=63&b|128):(f[g++]=b>>12|224,f[g++]=b>>6&63|128,f[g++]=63&b|128)}else for(y=0;y<p.length;y++)f[y]=0|p[y];return f},o.toHex=function(p){for(var h="",f=0;f<p.length;f++)h+=i(p[f].toString(16));return h},o.htonl=l,o.toHex32=function(p,h){for(var f="",g=0;g<p.length;g++){var y=p[g];h==="little"&&(y=l(y)),f+=c(y.toString(16))}return f},o.zero2=i,o.zero8=c,o.join32=function(p,h,f,g){var y=f-h;s(y%4==0);for(var b=new Array(y/4),v=0,w=h;v<b.length;v++,w+=4){var S;S=g==="big"?p[w]<<24|p[w+1]<<16|p[w+2]<<8|p[w+3]:p[w+3]<<24|p[w+2]<<16|p[w+1]<<8|p[w],b[v]=S>>>0}return b},o.split32=function(p,h){for(var f=new Array(4*p.length),g=0,y=0;g<p.length;g++,y+=4){var b=p[g];h==="big"?(f[y]=b>>>24,f[y+1]=b>>>16&255,f[y+2]=b>>>8&255,f[y+3]=255&b):(f[y+3]=b>>>24,f[y+2]=b>>>16&255,f[y+1]=b>>>8&255,f[y]=255&b)}return f},o.rotr32=function(p,h){return p>>>h|p<<32-h},o.rotl32=function(p,h){return p<<h|p>>>32-h},o.sum32=function(p,h){return p+h>>>0},o.sum32_3=function(p,h,f){return p+h+f>>>0},o.sum32_4=function(p,h,f,g){return p+h+f+g>>>0},o.sum32_5=function(p,h,f,g,y){return p+h+f+g+y>>>0},o.sum64=function(p,h,f,g){var y=p[h],b=g+p[h+1]>>>0,v=(b<g?1:0)+f+y;p[h]=v>>>0,p[h+1]=b},o.sum64_hi=function(p,h,f,g){return(h+g>>>0<h?1:0)+p+f>>>0},o.sum64_lo=function(p,h,f,g){return h+g>>>0},o.sum64_4_hi=function(p,h,f,g,y,b,v,w){var S=0,N=h;return S+=(N=N+g>>>0)<h?1:0,S+=(N=N+b>>>0)<b?1:0,p+f+y+v+(S+=(N=N+w>>>0)<w?1:0)>>>0},o.sum64_4_lo=function(p,h,f,g,y,b,v,w){return h+g+b+w>>>0},o.sum64_5_hi=function(p,h,f,g,y,b,v,w,S,N){var D=0,F=h;return D+=(F=F+g>>>0)<h?1:0,D+=(F=F+b>>>0)<b?1:0,D+=(F=F+w>>>0)<w?1:0,p+f+y+v+S+(D+=(F=F+N>>>0)<N?1:0)>>>0},o.sum64_5_lo=function(p,h,f,g,y,b,v,w,S,N){return h+g+b+w+N>>>0},o.rotr64_hi=function(p,h,f){return(h<<32-f|p>>>f)>>>0},o.rotr64_lo=function(p,h,f){return(p<<32-f|h>>>f)>>>0},o.shr64_hi=function(p,h,f){return p>>>f},o.shr64_lo=function(p,h,f){return(p<<32-f|h>>>f)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(t,r,o){var s=t("hash.js"),a=t("minimalistic-crypto-utils"),u=t("minimalistic-assert");function l(i){if(!(this instanceof l))return new l(i);this.hash=i.hash,this.predResist=!!i.predResist,this.outLen=this.hash.outSize,this.minEntropy=i.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var c=a.toArray(i.entropy,i.entropyEnc||"hex"),p=a.toArray(i.nonce,i.nonceEnc||"hex"),h=a.toArray(i.pers,i.persEnc||"hex");u(c.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(c,p,h)}r.exports=l,l.prototype._init=function(i,c,p){var h=i.concat(c).concat(p);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var f=0;f<this.V.length;f++)this.K[f]=0,this.V[f]=1;this._update(h),this._reseed=1,this.reseedInterval=281474976710656},l.prototype._hmac=function(){return new s.hmac(this.hash,this.K)},l.prototype._update=function(i){var c=this._hmac().update(this.V).update([0]);i&&(c=c.update(i)),this.K=c.digest(),this.V=this._hmac().update(this.V).digest(),i&&(this.K=this._hmac().update(this.V).update([1]).update(i).digest(),this.V=this._hmac().update(this.V).digest())},l.prototype.reseed=function(i,c,p,h){typeof c!="string"&&(h=p,p=c,c=null),i=a.toArray(i,c),p=a.toArray(p,h),u(i.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(i.concat(p||[])),this._reseed=1},l.prototype.generate=function(i,c,p,h){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof c!="string"&&(h=p,p=c,c=null),p&&(p=a.toArray(p,h||"hex"),this._update(p));for(var f=[];f.length<i;)this.V=this._hmac().update(this.V).digest(),f=f.concat(this.V);var g=f.slice(0,i);return this._update(p),this._reseed++,a.encode(g,c)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(t,r,o){o.read=function(s,a,u,l,i){var c,p,h=8*i-l-1,f=(1<<h)-1,g=f>>1,y=-7,b=u?i-1:0,v=u?-1:1,w=s[a+b];for(b+=v,c=w&(1<<-y)-1,w>>=-y,y+=h;y>0;c=256*c+s[a+b],b+=v,y-=8);for(p=c&(1<<-y)-1,c>>=-y,y+=l;y>0;p=256*p+s[a+b],b+=v,y-=8);if(c===0)c=1-g;else{if(c===f)return p?NaN:1/0*(w?-1:1);p+=Math.pow(2,l),c-=g}return(w?-1:1)*p*Math.pow(2,c-l)},o.write=function(s,a,u,l,i,c){var p,h,f,g=8*c-i-1,y=(1<<g)-1,b=y>>1,v=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=l?0:c-1,S=l?1:-1,N=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(h=isNaN(a)?1:0,p=y):(p=Math.floor(Math.log(a)/Math.LN2),a*(f=Math.pow(2,-p))<1&&(p--,f*=2),(a+=p+b>=1?v/f:v*Math.pow(2,1-b))*f>=2&&(p++,f/=2),p+b>=y?(h=0,p=y):p+b>=1?(h=(a*f-1)*Math.pow(2,i),p+=b):(h=a*Math.pow(2,b-1)*Math.pow(2,i),p=0));i>=8;s[u+w]=255&h,w+=S,h/=256,i-=8);for(p=p<<i|h,g+=i;g>0;s[u+w]=255&p,w+=S,p/=256,g-=8);s[u+w-S]|=128*N}},{}],440:[function(t,r,o){typeof Object.create=="function"?r.exports=function(s,a){a&&(s.super_=a,s.prototype=Object.create(a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(s,a){if(a){s.super_=a;var u=function(){};u.prototype=a.prototype,s.prototype=new u,s.prototype.constructor=s}}},{}],441:[function(t,r,o){(function(s,a,u,l,i,c,p,h){(function(){(function(f){typeof o=="object"&&r!==void 0?r.exports=f():(typeof window<"u"?window:a!==void 0?a:typeof self<"u"?self:this).JSZip=f()})((function(){return(function f(g,y,b){function v(N,D){if(!y[N]){if(!g[N]){var F=typeof t=="function"&&t;if(!D&&F)return F(N,!0);if(w)return w(N,!0);var G=new Error("Cannot find module '"+N+"'");throw G.code="MODULE_NOT_FOUND",G}var P=y[N]={exports:{}};g[N][0].call(P.exports,(function(U){return v(g[N][1][U]||U)}),P,P.exports,f,g,y,b)}return y[N].exports}for(var w=typeof t=="function"&&t,S=0;S<b.length;S++)v(b[S]);return v})({1:[function(f,g,y){var b=f("./utils"),v=f("./support"),w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";y.encode=function(S){for(var N,D,F,G,P,U,q,R=[],I=0,T=S.length,L=T,E=b.getTypeOf(S)!=="string";I<S.length;)L=T-I,F=E?(N=S[I++],D=I<T?S[I++]:0,I<T?S[I++]:0):(N=S.charCodeAt(I++),D=I<T?S.charCodeAt(I++):0,I<T?S.charCodeAt(I++):0),G=N>>2,P=(3&N)<<4|D>>4,U=1<L?(15&D)<<2|F>>6:64,q=2<L?63&F:64,R.push(w.charAt(G)+w.charAt(P)+w.charAt(U)+w.charAt(q));return R.join("")},y.decode=function(S){var N,D,F,G,P,U,q=0,R=0,I="data:";if(S.substr(0,I.length)===I)throw new Error("Invalid base64 input, it looks like a data url.");var T,L=3*(S=S.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(S.charAt(S.length-1)===w.charAt(64)&&L--,S.charAt(S.length-2)===w.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(T=v.uint8array?new Uint8Array(0|L):new Array(0|L);q<S.length;)N=w.indexOf(S.charAt(q++))<<2|(G=w.indexOf(S.charAt(q++)))>>4,D=(15&G)<<4|(P=w.indexOf(S.charAt(q++)))>>2,F=(3&P)<<6|(U=w.indexOf(S.charAt(q++))),T[R++]=N,P!==64&&(T[R++]=D),U!==64&&(T[R++]=F);return T}},{"./support":30,"./utils":32}],2:[function(f,g,y){var b=f("./external"),v=f("./stream/DataWorker"),w=f("./stream/Crc32Probe"),S=f("./stream/DataLengthProbe");function N(D,F,G,P,U){this.compressedSize=D,this.uncompressedSize=F,this.crc32=G,this.compression=P,this.compressedContent=U}N.prototype={getContentWorker:function(){var D=new v(b.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new S("data_length")),F=this;return D.on("end",(function(){if(this.streamInfo.data_length!==F.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),D},getCompressedWorker:function(){return new v(b.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},N.createWorkerFrom=function(D,F,G){return D.pipe(new w).pipe(new S("uncompressedSize")).pipe(F.compressWorker(G)).pipe(new S("compressedSize")).withStreamInfo("compression",F)},g.exports=N},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(f,g,y){var b=f("./stream/GenericWorker");y.STORE={magic:"\0\0",compressWorker:function(){return new b("STORE compression")},uncompressWorker:function(){return new b("STORE decompression")}},y.DEFLATE=f("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(f,g,y){var b=f("./utils"),v=(function(){for(var w,S=[],N=0;N<256;N++){w=N;for(var D=0;D<8;D++)w=1&w?3988292384^w>>>1:w>>>1;S[N]=w}return S})();g.exports=function(w,S){return w!==void 0&&w.length?b.getTypeOf(w)!=="string"?(function(N,D,F,G){var P=v,U=0+F;N^=-1;for(var q=0;q<U;q++)N=N>>>8^P[255&(N^D[q])];return-1^N})(0|S,w,w.length):(function(N,D,F,G){var P=v,U=0+F;N^=-1;for(var q=0;q<U;q++)N=N>>>8^P[255&(N^D.charCodeAt(q))];return-1^N})(0|S,w,w.length):0}},{"./utils":32}],5:[function(f,g,y){y.base64=!1,y.binary=!1,y.dir=!1,y.createFolders=!0,y.date=null,y.compression=null,y.compressionOptions=null,y.comment=null,y.unixPermissions=null,y.dosPermissions=null},{}],6:[function(f,g,y){var b;b=typeof Promise<"u"?Promise:f("lie"),g.exports={Promise:b}},{lie:37}],7:[function(f,g,y){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",v=f("pako"),w=f("./utils"),S=f("./stream/GenericWorker"),N=b?"uint8array":"array";function D(F,G){S.call(this,"FlateWorker/"+F),this._pako=null,this._pakoAction=F,this._pakoOptions=G,this.meta={}}y.magic="\b\0",w.inherits(D,S),D.prototype.processChunk=function(F){this.meta=F.meta,this._pako===null&&this._createPako(),this._pako.push(w.transformTo(N,F.data),!1)},D.prototype.flush=function(){S.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},D.prototype.cleanUp=function(){S.prototype.cleanUp.call(this),this._pako=null},D.prototype._createPako=function(){this._pako=new v[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var F=this;this._pako.onData=function(G){F.push({data:G,meta:F.meta})}},y.compressWorker=function(F){return new D("Deflate",F)},y.uncompressWorker=function(){return new D("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(f,g,y){function b(P,U){var q,R="";for(q=0;q<U;q++)R+=String.fromCharCode(255&P),P>>>=8;return R}function v(P,U,q,R,I,T){var L,E,x=P.file,k=P.compression,A=T!==N.utf8encode,C=w.transformTo("string",T(x.name)),j=w.transformTo("string",N.utf8encode(x.name)),B=x.comment,O=w.transformTo("string",T(B)),H=w.transformTo("string",N.utf8encode(B)),X=j.length!==x.name.length,et=H.length!==B.length,V="",tt="",$="",z=x.dir,Z=x.date,it={crc32:0,compressedSize:0,uncompressedSize:0};U&&!q||(it.crc32=P.crc32,it.compressedSize=P.compressedSize,it.uncompressedSize=P.uncompressedSize);var mt=0;U&&(mt|=8),A||!X&&!et||(mt|=2048);var lt=0,at=0;z&&(lt|=16),I==="UNIX"?(at=798,lt|=(function(ct,ot){var dt=ct;return ct||(dt=ot?16893:33204),(65535&dt)<<16})(x.unixPermissions,z)):(at=20,lt|=(function(ct){return 63&(ct||0)})(x.dosPermissions)),L=Z.getUTCHours(),L<<=6,L|=Z.getUTCMinutes(),L<<=5,L|=Z.getUTCSeconds()/2,E=Z.getUTCFullYear()-1980,E<<=4,E|=Z.getUTCMonth()+1,E<<=5,E|=Z.getUTCDate(),X&&(tt=b(1,1)+b(D(C),4)+j,V+="up"+b(tt.length,2)+tt),et&&($=b(1,1)+b(D(O),4)+H,V+="uc"+b($.length,2)+$);var rt="";return rt+=`
\0`,rt+=b(mt,2),rt+=k.magic,rt+=b(L,2),rt+=b(E,2),rt+=b(it.crc32,4),rt+=b(it.compressedSize,4),rt+=b(it.uncompressedSize,4),rt+=b(C.length,2),rt+=b(V.length,2),{fileRecord:F.LOCAL_FILE_HEADER+rt+C+V,dirRecord:F.CENTRAL_FILE_HEADER+b(at,2)+rt+b(O.length,2)+"\0\0\0\0"+b(lt,4)+b(R,4)+C+V+O}}var w=f("../utils"),S=f("../stream/GenericWorker"),N=f("../utf8"),D=f("../crc32"),F=f("../signature");function G(P,U,q,R){S.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=U,this.zipPlatform=q,this.encodeFileName=R,this.streamFiles=P,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}w.inherits(G,S),G.prototype.push=function(P){var U=P.meta.percent||0,q=this.entriesCount,R=this._sources.length;this.accumulate?this.contentBuffer.push(P):(this.bytesWritten+=P.data.length,S.prototype.push.call(this,{data:P.data,meta:{currentFile:this.currentFile,percent:q?(U+100*(q-R-1))/q:100}}))},G.prototype.openedSource=function(P){this.currentSourceOffset=this.bytesWritten,this.currentFile=P.file.name;var U=this.streamFiles&&!P.file.dir;if(U){var q=v(P,U,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:q.fileRecord,meta:{percent:0}})}else this.accumulate=!0},G.prototype.closedSource=function(P){this.accumulate=!1;var U=this.streamFiles&&!P.file.dir,q=v(P,U,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(q.dirRecord),U)this.push({data:(function(R){return F.DATA_DESCRIPTOR+b(R.crc32,4)+b(R.compressedSize,4)+b(R.uncompressedSize,4)})(P),meta:{percent:100}});else for(this.push({data:q.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},G.prototype.flush=function(){for(var P=this.bytesWritten,U=0;U<this.dirRecords.length;U++)this.push({data:this.dirRecords[U],meta:{percent:100}});var q=this.bytesWritten-P,R=(function(I,T,L,E,x){var k=w.transformTo("string",x(E));return F.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(I,2)+b(I,2)+b(T,4)+b(L,4)+b(k.length,2)+k})(this.dirRecords.length,q,P,this.zipComment,this.encodeFileName);this.push({data:R,meta:{percent:100}})},G.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},G.prototype.registerPrevious=function(P){this._sources.push(P);var U=this;return P.on("data",(function(q){U.processChunk(q)})),P.on("end",(function(){U.closedSource(U.previous.streamInfo),U._sources.length?U.prepareNextSource():U.end()})),P.on("error",(function(q){U.error(q)})),this},G.prototype.resume=function(){return!!S.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},G.prototype.error=function(P){var U=this._sources;if(!S.prototype.error.call(this,P))return!1;for(var q=0;q<U.length;q++)try{U[q].error(P)}catch{}return!0},G.prototype.lock=function(){S.prototype.lock.call(this);for(var P=this._sources,U=0;U<P.length;U++)P[U].lock()},g.exports=G},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(f,g,y){var b=f("../compressions"),v=f("./ZipFileWorker");y.generateWorker=function(w,S,N){var D=new v(S.streamFiles,N,S.platform,S.encodeFileName),F=0;try{w.forEach((function(G,P){F++;var U=(function(T,L){var E=T||L,x=b[E];if(!x)throw new Error(E+" is not a valid compression method !");return x})(P.options.compression,S.compression),q=P.options.compressionOptions||S.compressionOptions||{},R=P.dir,I=P.date;P._compressWorker(U,q).withStreamInfo("file",{name:G,dir:R,date:I,comment:P.comment||"",unixPermissions:P.unixPermissions,dosPermissions:P.dosPermissions}).pipe(D)})),D.entriesCount=F}catch(G){D.error(G)}return D}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(f,g,y){function b(){if(!(this instanceof b))return new b;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var v=new b;for(var w in this)typeof this[w]!="function"&&(v[w]=this[w]);return v}}(b.prototype=f("./object")).loadAsync=f("./load"),b.support=f("./support"),b.defaults=f("./defaults"),b.version="3.10.1",b.loadAsync=function(v,w){return new b().loadAsync(v,w)},b.external=f("./external"),g.exports=b},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(f,g,y){var b=f("./utils"),v=f("./external"),w=f("./utf8"),S=f("./zipEntries"),N=f("./stream/Crc32Probe"),D=f("./nodejsUtils");function F(G){return new v.Promise((function(P,U){var q=G.decompressed.getContentWorker().pipe(new N);q.on("error",(function(R){U(R)})).on("end",(function(){q.streamInfo.crc32!==G.decompressed.crc32?U(new Error("Corrupted zip : CRC32 mismatch")):P()})).resume()}))}g.exports=function(G,P){var U=this;return P=b.extend(P||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:w.utf8decode}),D.isNode&&D.isStream(G)?v.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):b.prepareContent("the loaded zip file",G,!0,P.optimizedBinaryString,P.base64).then((function(q){var R=new S(P);return R.load(q),R})).then((function(q){var R=[v.Promise.resolve(q)],I=q.files;if(P.checkCRC32)for(var T=0;T<I.length;T++)R.push(F(I[T]));return v.Promise.all(R)})).then((function(q){for(var R=q.shift(),I=R.files,T=0;T<I.length;T++){var L=I[T],E=L.fileNameStr,x=b.resolve(L.fileNameStr);U.file(x,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:P.createFolders}),L.dir||(U.file(x).unsafeOriginalName=E)}return R.zipComment.length&&(U.comment=R.zipComment),U}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(f,g,y){var b=f("../utils"),v=f("../stream/GenericWorker");function w(S,N){v.call(this,"Nodejs stream input adapter for "+S),this._upstreamEnded=!1,this._bindStream(N)}b.inherits(w,v),w.prototype._bindStream=function(S){var N=this;(this._stream=S).pause(),S.on("data",(function(D){N.push({data:D,meta:{percent:0}})})).on("error",(function(D){N.isPaused?this.generatedError=D:N.error(D)})).on("end",(function(){N.isPaused?N._upstreamEnded=!0:N.end()}))},w.prototype.pause=function(){return!!v.prototype.pause.call(this)&&(this._stream.pause(),!0)},w.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},g.exports=w},{"../stream/GenericWorker":28,"../utils":32}],13:[function(f,g,y){var b=f("readable-stream").Readable;function v(w,S,N){b.call(this,S),this._helper=w;var D=this;w.on("data",(function(F,G){D.push(F)||D._helper.pause(),N&&N(G)})).on("error",(function(F){D.emit("error",F)})).on("end",(function(){D.push(null)}))}f("../utils").inherits(v,b),v.prototype._read=function(){this._helper.resume()},g.exports=v},{"../utils":32,"readable-stream":16}],14:[function(f,g,y){g.exports={isNode:u!==void 0,newBufferFrom:function(b,v){if(u.from&&u.from!==Uint8Array.from)return u.from(b,v);if(typeof b=="number")throw new Error('The "data" argument must not be a number');return new u(b,v)},allocBuffer:function(b){if(u.alloc)return u.alloc(b);var v=new u(b);return v.fill(0),v},isBuffer:function(b){return u.isBuffer(b)},isStream:function(b){return b&&typeof b.on=="function"&&typeof b.pause=="function"&&typeof b.resume=="function"}}},{}],15:[function(f,g,y){function b(x,k,A){var C,j=w.getTypeOf(k),B=w.extend(A||{},D);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(x=I(x)),B.createFolders&&(C=R(x))&&T.call(this,C,!0);var O=j==="string"&&B.binary===!1&&B.base64===!1;A&&A.binary!==void 0||(B.binary=!O),(k instanceof F&&k.uncompressedSize===0||B.dir||!k||k.length===0)&&(B.base64=!1,B.binary=!0,k="",B.compression="STORE",j="string");var H;H=k instanceof F||k instanceof S?k:U.isNode&&U.isStream(k)?new q(x,k):w.prepareContent(x,k,B.binary,B.optimizedBinaryString,B.base64);var X=new G(x,H,B);this.files[x]=X}var v=f("./utf8"),w=f("./utils"),S=f("./stream/GenericWorker"),N=f("./stream/StreamHelper"),D=f("./defaults"),F=f("./compressedObject"),G=f("./zipObject"),P=f("./generate"),U=f("./nodejsUtils"),q=f("./nodejs/NodejsStreamInputAdapter"),R=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var k=x.lastIndexOf("/");return 0<k?x.substring(0,k):""},I=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},T=function(x,k){return k=k!==void 0?k:D.createFolders,x=I(x),this.files[x]||b.call(this,x,null,{dir:!0,createFolders:k}),this.files[x]};function L(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var k,A,C;for(k in this.files)C=this.files[k],(A=k.slice(this.root.length,k.length))&&k.slice(0,this.root.length)===this.root&&x(A,C)},filter:function(x){var k=[];return this.forEach((function(A,C){x(A,C)&&k.push(C)})),k},file:function(x,k,A){if(arguments.length!==1)return x=this.root+x,b.call(this,x,k,A),this;if(L(x)){var C=x;return this.filter((function(B,O){return!O.dir&&C.test(B)}))}var j=this.files[this.root+x];return j&&!j.dir?j:null},folder:function(x){if(!x)return this;if(L(x))return this.filter((function(j,B){return B.dir&&x.test(j)}));var k=this.root+x,A=T.call(this,k),C=this.clone();return C.root=A.name,C},remove:function(x){x=this.root+x;var k=this.files[x];if(k||(x.slice(-1)!=="/"&&(x+="/"),k=this.files[x]),k&&!k.dir)delete this.files[x];else for(var A=this.filter((function(j,B){return B.name.slice(0,x.length)===x})),C=0;C<A.length;C++)delete this.files[A[C].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var k,A={};try{if((A=w.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:v.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");w.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var C=A.comment||this.comment||"";k=P.generateWorker(this,A,C)}catch(j){(k=new S("error")).error(j)}return new N(k,A.type||"string",A.mimeType)},generateAsync:function(x,k){return this.generateInternalStream(x).accumulate(k)},generateNodeStream:function(x,k){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(k)}};g.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(f,g,y){g.exports=f("stream")},{stream:void 0}],17:[function(f,g,y){var b=f("./DataReader");function v(w){b.call(this,w);for(var S=0;S<this.data.length;S++)w[S]=255&w[S]}f("../utils").inherits(v,b),v.prototype.byteAt=function(w){return this.data[this.zero+w]},v.prototype.lastIndexOfSignature=function(w){for(var S=w.charCodeAt(0),N=w.charCodeAt(1),D=w.charCodeAt(2),F=w.charCodeAt(3),G=this.length-4;0<=G;--G)if(this.data[G]===S&&this.data[G+1]===N&&this.data[G+2]===D&&this.data[G+3]===F)return G-this.zero;return-1},v.prototype.readAndCheckSignature=function(w){var S=w.charCodeAt(0),N=w.charCodeAt(1),D=w.charCodeAt(2),F=w.charCodeAt(3),G=this.readData(4);return S===G[0]&&N===G[1]&&D===G[2]&&F===G[3]},v.prototype.readData=function(w){if(this.checkOffset(w),w===0)return[];var S=this.data.slice(this.zero+this.index,this.zero+this.index+w);return this.index+=w,S},g.exports=v},{"../utils":32,"./DataReader":18}],18:[function(f,g,y){var b=f("../utils");function v(w){this.data=w,this.length=w.length,this.index=0,this.zero=0}v.prototype={checkOffset:function(w){this.checkIndex(this.index+w)},checkIndex:function(w){if(this.length<this.zero+w||w<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+w+"). Corrupted zip ?")},setIndex:function(w){this.checkIndex(w),this.index=w},skip:function(w){this.setIndex(this.index+w)},byteAt:function(){},readInt:function(w){var S,N=0;for(this.checkOffset(w),S=this.index+w-1;S>=this.index;S--)N=(N<<8)+this.byteAt(S);return this.index+=w,N},readString:function(w){return b.transformTo("string",this.readData(w))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var w=this.readInt(4);return new Date(Date.UTC(1980+(w>>25&127),(w>>21&15)-1,w>>16&31,w>>11&31,w>>5&63,(31&w)<<1))}},g.exports=v},{"../utils":32}],19:[function(f,g,y){var b=f("./Uint8ArrayReader");function v(w){b.call(this,w)}f("../utils").inherits(v,b),v.prototype.readData=function(w){this.checkOffset(w);var S=this.data.slice(this.zero+this.index,this.zero+this.index+w);return this.index+=w,S},g.exports=v},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(f,g,y){var b=f("./DataReader");function v(w){b.call(this,w)}f("../utils").inherits(v,b),v.prototype.byteAt=function(w){return this.data.charCodeAt(this.zero+w)},v.prototype.lastIndexOfSignature=function(w){return this.data.lastIndexOf(w)-this.zero},v.prototype.readAndCheckSignature=function(w){return w===this.readData(4)},v.prototype.readData=function(w){this.checkOffset(w);var S=this.data.slice(this.zero+this.index,this.zero+this.index+w);return this.index+=w,S},g.exports=v},{"../utils":32,"./DataReader":18}],21:[function(f,g,y){var b=f("./ArrayReader");function v(w){b.call(this,w)}f("../utils").inherits(v,b),v.prototype.readData=function(w){if(this.checkOffset(w),w===0)return new Uint8Array(0);var S=this.data.subarray(this.zero+this.index,this.zero+this.index+w);return this.index+=w,S},g.exports=v},{"../utils":32,"./ArrayReader":17}],22:[function(f,g,y){var b=f("../utils"),v=f("../support"),w=f("./ArrayReader"),S=f("./StringReader"),N=f("./NodeBufferReader"),D=f("./Uint8ArrayReader");g.exports=function(F){var G=b.getTypeOf(F);return b.checkSupport(G),G!=="string"||v.uint8array?G==="nodebuffer"?new N(F):v.uint8array?new D(b.transformTo("uint8array",F)):new w(b.transformTo("array",F)):new S(F)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(f,g,y){y.LOCAL_FILE_HEADER="PK",y.CENTRAL_FILE_HEADER="PK",y.CENTRAL_DIRECTORY_END="PK",y.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",y.ZIP64_CENTRAL_DIRECTORY_END="PK",y.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(f,g,y){var b=f("./GenericWorker"),v=f("../utils");function w(S){b.call(this,"ConvertWorker to "+S),this.destType=S}v.inherits(w,b),w.prototype.processChunk=function(S){this.push({data:v.transformTo(this.destType,S.data),meta:S.meta})},g.exports=w},{"../utils":32,"./GenericWorker":28}],25:[function(f,g,y){var b=f("./GenericWorker"),v=f("../crc32");function w(){b.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}f("../utils").inherits(w,b),w.prototype.processChunk=function(S){this.streamInfo.crc32=v(S.data,this.streamInfo.crc32||0),this.push(S)},g.exports=w},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(f,g,y){var b=f("../utils"),v=f("./GenericWorker");function w(S){v.call(this,"DataLengthProbe for "+S),this.propName=S,this.withStreamInfo(S,0)}b.inherits(w,v),w.prototype.processChunk=function(S){if(S){var N=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=N+S.data.length}v.prototype.processChunk.call(this,S)},g.exports=w},{"../utils":32,"./GenericWorker":28}],27:[function(f,g,y){var b=f("../utils"),v=f("./GenericWorker");function w(S){v.call(this,"DataWorker");var N=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,S.then((function(D){N.dataIsReady=!0,N.data=D,N.max=D&&D.length||0,N.type=b.getTypeOf(D),N.isPaused||N._tickAndRepeat()}),(function(D){N.error(D)}))}b.inherits(w,v),w.prototype.cleanUp=function(){v.prototype.cleanUp.call(this),this.data=null},w.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,b.delay(this._tickAndRepeat,[],this)),!0)},w.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(b.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},w.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var S=null,N=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":S=this.data.substring(this.index,N);break;case"uint8array":S=this.data.subarray(this.index,N);break;case"array":case"nodebuffer":S=this.data.slice(this.index,N)}return this.index=N,this.push({data:S,meta:{percent:this.max?this.index/this.max*100:0}})},g.exports=w},{"../utils":32,"./GenericWorker":28}],28:[function(f,g,y){function b(v){this.name=v||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}b.prototype={push:function(v){this.emit("data",v)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(v){this.emit("error",v)}return!0},error:function(v){return!this.isFinished&&(this.isPaused?this.generatedError=v:(this.isFinished=!0,this.emit("error",v),this.previous&&this.previous.error(v),this.cleanUp()),!0)},on:function(v,w){return this._listeners[v].push(w),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(v,w){if(this._listeners[v])for(var S=0;S<this._listeners[v].length;S++)this._listeners[v][S].call(this,w)},pipe:function(v){return v.registerPrevious(this)},registerPrevious:function(v){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=v.streamInfo,this.mergeStreamInfo(),this.previous=v;var w=this;return v.on("data",(function(S){w.processChunk(S)})),v.on("end",(function(){w.end()})),v.on("error",(function(S){w.error(S)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var v=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),v=!0),this.previous&&this.previous.resume(),!v},flush:function(){},processChunk:function(v){this.push(v)},withStreamInfo:function(v,w){return this.extraStreamInfo[v]=w,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var v in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,v)&&(this.streamInfo[v]=this.extraStreamInfo[v])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var v="Worker "+this.name;return this.previous?this.previous+" -> "+v:v}},g.exports=b},{}],29:[function(f,g,y){var b=f("../utils"),v=f("./ConvertWorker"),w=f("./GenericWorker"),S=f("../base64"),N=f("../support"),D=f("../external"),F=null;if(N.nodestream)try{F=f("../nodejs/NodejsStreamOutputAdapter")}catch{}function G(P,U,q){var R=U;switch(U){case"blob":case"arraybuffer":R="uint8array";break;case"base64":R="string"}try{this._internalType=R,this._outputType=U,this._mimeType=q,b.checkSupport(R),this._worker=P.pipe(new v(R)),P.lock()}catch(I){this._worker=new w("error"),this._worker.error(I)}}G.prototype={accumulate:function(P){return(function(U,q){return new D.Promise((function(R,I){var T=[],L=U._internalType,E=U._outputType,x=U._mimeType;U.on("data",(function(k,A){T.push(k),q&&q(A)})).on("error",(function(k){T=[],I(k)})).on("end",(function(){try{var k=(function(A,C,j){switch(A){case"blob":return b.newBlob(b.transformTo("arraybuffer",C),j);case"base64":return S.encode(C);default:return b.transformTo(A,C)}})(E,(function(A,C){var j,B=0,O=null,H=0;for(j=0;j<C.length;j++)H+=C[j].length;switch(A){case"string":return C.join("");case"array":return Array.prototype.concat.apply([],C);case"uint8array":for(O=new Uint8Array(H),j=0;j<C.length;j++)O.set(C[j],B),B+=C[j].length;return O;case"nodebuffer":return u.concat(C);default:throw new Error("concat : unsupported type '"+A+"'")}})(L,T),x);R(k)}catch(A){I(A)}T=[]})).resume()}))})(this,P)},on:function(P,U){var q=this;return P==="data"?this._worker.on(P,(function(R){U.call(q,R.data,R.meta)})):this._worker.on(P,(function(){b.delay(U,arguments,q)})),this},resume:function(){return b.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(P){if(b.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new F(this,{objectMode:this._outputType!=="nodebuffer"},P)}},g.exports=G},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(f,g,y){if(y.base64=!0,y.array=!0,y.string=!0,y.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",y.nodebuffer=u!==void 0,y.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")y.blob=!1;else{var b=new ArrayBuffer(0);try{y.blob=new Blob([b],{type:"application/zip"}).size===0}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);v.append(b),y.blob=v.getBlob("application/zip").size===0}catch{y.blob=!1}}}try{y.nodestream=!!f("readable-stream").Readable}catch{y.nodestream=!1}},{"readable-stream":16}],31:[function(f,g,y){for(var b=f("./utils"),v=f("./support"),w=f("./nodejsUtils"),S=f("./stream/GenericWorker"),N=new Array(256),D=0;D<256;D++)N[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;function F(){S.call(this,"utf-8 decode"),this.leftOver=null}function G(){S.call(this,"utf-8 encode")}N[254]=N[254]=1,y.utf8encode=function(P){return v.nodebuffer?w.newBufferFrom(P,"utf-8"):(function(U){var q,R,I,T,L,E=U.length,x=0;for(T=0;T<E;T++)(64512&(R=U.charCodeAt(T)))==55296&&T+1<E&&(64512&(I=U.charCodeAt(T+1)))==56320&&(R=65536+(R-55296<<10)+(I-56320),T++),x+=R<128?1:R<2048?2:R<65536?3:4;for(q=v.uint8array?new Uint8Array(x):new Array(x),T=L=0;L<x;T++)(64512&(R=U.charCodeAt(T)))==55296&&T+1<E&&(64512&(I=U.charCodeAt(T+1)))==56320&&(R=65536+(R-55296<<10)+(I-56320),T++),R<128?q[L++]=R:(R<2048?q[L++]=192|R>>>6:(R<65536?q[L++]=224|R>>>12:(q[L++]=240|R>>>18,q[L++]=128|R>>>12&63),q[L++]=128|R>>>6&63),q[L++]=128|63&R);return q})(P)},y.utf8decode=function(P){return v.nodebuffer?b.transformTo("nodebuffer",P).toString("utf-8"):(function(U){var q,R,I,T,L=U.length,E=new Array(2*L);for(q=R=0;q<L;)if((I=U[q++])<128)E[R++]=I;else if(4<(T=N[I]))E[R++]=65533,q+=T-1;else{for(I&=T===2?31:T===3?15:7;1<T&&q<L;)I=I<<6|63&U[q++],T--;1<T?E[R++]=65533:I<65536?E[R++]=I:(I-=65536,E[R++]=55296|I>>10&1023,E[R++]=56320|1023&I)}return E.length!==R&&(E.subarray?E=E.subarray(0,R):E.length=R),b.applyFromCharCode(E)})(P=b.transformTo(v.uint8array?"uint8array":"array",P))},b.inherits(F,S),F.prototype.processChunk=function(P){var U=b.transformTo(v.uint8array?"uint8array":"array",P.data);if(this.leftOver&&this.leftOver.length){if(v.uint8array){var q=U;(U=new Uint8Array(q.length+this.leftOver.length)).set(this.leftOver,0),U.set(q,this.leftOver.length)}else U=this.leftOver.concat(U);this.leftOver=null}var R=(function(T,L){var E;for((L=L||T.length)>T.length&&(L=T.length),E=L-1;0<=E&&(192&T[E])==128;)E--;return E<0||E===0?L:E+N[T[E]]>L?E:L})(U),I=U;R!==U.length&&(v.uint8array?(I=U.subarray(0,R),this.leftOver=U.subarray(R,U.length)):(I=U.slice(0,R),this.leftOver=U.slice(R,U.length))),this.push({data:y.utf8decode(I),meta:P.meta})},F.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:y.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},y.Utf8DecodeWorker=F,b.inherits(G,S),G.prototype.processChunk=function(P){this.push({data:y.utf8encode(P.data),meta:P.meta})},y.Utf8EncodeWorker=G},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(f,g,y){var b=f("./support"),v=f("./base64"),w=f("./nodejsUtils"),S=f("./external");function N(q){return q}function D(q,R){for(var I=0;I<q.length;++I)R[I]=255&q.charCodeAt(I);return R}f("setimmediate"),y.newBlob=function(q,R){y.checkSupport("blob");try{return new Blob([q],{type:R})}catch{try{var I=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return I.append(q),I.getBlob(R)}catch{throw new Error("Bug : can't construct the Blob.")}}};var F={stringifyByChunk:function(q,R,I){var T=[],L=0,E=q.length;if(E<=I)return String.fromCharCode.apply(null,q);for(;L<E;)R==="array"||R==="nodebuffer"?T.push(String.fromCharCode.apply(null,q.slice(L,Math.min(L+I,E)))):T.push(String.fromCharCode.apply(null,q.subarray(L,Math.min(L+I,E)))),L+=I;return T.join("")},stringifyByChar:function(q){for(var R="",I=0;I<q.length;I++)R+=String.fromCharCode(q[I]);return R},applyCanBeUsed:{uint8array:(function(){try{return b.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return b.nodebuffer&&String.fromCharCode.apply(null,w.allocBuffer(1)).length===1}catch{return!1}})()}};function G(q){var R=65536,I=y.getTypeOf(q),T=!0;if(I==="uint8array"?T=F.applyCanBeUsed.uint8array:I==="nodebuffer"&&(T=F.applyCanBeUsed.nodebuffer),T)for(;1<R;)try{return F.stringifyByChunk(q,I,R)}catch{R=Math.floor(R/2)}return F.stringifyByChar(q)}function P(q,R){for(var I=0;I<q.length;I++)R[I]=q[I];return R}y.applyFromCharCode=G;var U={};U.string={string:N,array:function(q){return D(q,new Array(q.length))},arraybuffer:function(q){return U.string.uint8array(q).buffer},uint8array:function(q){return D(q,new Uint8Array(q.length))},nodebuffer:function(q){return D(q,w.allocBuffer(q.length))}},U.array={string:G,array:N,arraybuffer:function(q){return new Uint8Array(q).buffer},uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return w.newBufferFrom(q)}},U.arraybuffer={string:function(q){return G(new Uint8Array(q))},array:function(q){return P(new Uint8Array(q),new Array(q.byteLength))},arraybuffer:N,uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return w.newBufferFrom(new Uint8Array(q))}},U.uint8array={string:G,array:function(q){return P(q,new Array(q.length))},arraybuffer:function(q){return q.buffer},uint8array:N,nodebuffer:function(q){return w.newBufferFrom(q)}},U.nodebuffer={string:G,array:function(q){return P(q,new Array(q.length))},arraybuffer:function(q){return U.nodebuffer.uint8array(q).buffer},uint8array:function(q){return P(q,new Uint8Array(q.length))},nodebuffer:N},y.transformTo=function(q,R){if(R=R||"",!q)return R;y.checkSupport(q);var I=y.getTypeOf(R);return U[I][q](R)},y.resolve=function(q){for(var R=q.split("/"),I=[],T=0;T<R.length;T++){var L=R[T];L==="."||L===""&&T!==0&&T!==R.length-1||(L===".."?I.pop():I.push(L))}return I.join("/")},y.getTypeOf=function(q){return typeof q=="string"?"string":Object.prototype.toString.call(q)==="[object Array]"?"array":b.nodebuffer&&w.isBuffer(q)?"nodebuffer":b.uint8array&&q instanceof Uint8Array?"uint8array":b.arraybuffer&&q instanceof ArrayBuffer?"arraybuffer":void 0},y.checkSupport=function(q){if(!b[q.toLowerCase()])throw new Error(q+" is not supported by this platform")},y.MAX_VALUE_16BITS=65535,y.MAX_VALUE_32BITS=-1,y.pretty=function(q){var R,I,T="";for(I=0;I<(q||"").length;I++)T+="\\x"+((R=q.charCodeAt(I))<16?"0":"")+R.toString(16).toUpperCase();return T},y.delay=function(q,R,I){h((function(){q.apply(I||null,R||[])}))},y.inherits=function(q,R){function I(){}I.prototype=R.prototype,q.prototype=new I},y.extend=function(){var q,R,I={};for(q=0;q<arguments.length;q++)for(R in arguments[q])Object.prototype.hasOwnProperty.call(arguments[q],R)&&I[R]===void 0&&(I[R]=arguments[q][R]);return I},y.prepareContent=function(q,R,I,T,L){return S.Promise.resolve(R).then((function(E){return b.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new S.Promise((function(x,k){var A=new FileReader;A.onload=function(C){x(C.target.result)},A.onerror=function(C){k(C.target.error)},A.readAsArrayBuffer(E)})):E})).then((function(E){var x=y.getTypeOf(E);return x?(x==="arraybuffer"?E=y.transformTo("uint8array",E):x==="string"&&(L?E=v.decode(E):I&&T!==!0&&(E=(function(k){return D(k,b.uint8array?new Uint8Array(k.length):new Array(k.length))})(E))),E):S.Promise.reject(new Error("Can't read the data of '"+q+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(f,g,y){var b=f("./reader/readerFor"),v=f("./utils"),w=f("./signature"),S=f("./zipEntry"),N=f("./support");function D(F){this.files=[],this.loadOptions=F}D.prototype={checkSignature:function(F){if(!this.reader.readAndCheckSignature(F)){this.reader.index-=4;var G=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+v.pretty(G)+", expected "+v.pretty(F)+")")}},isSignature:function(F,G){var P=this.reader.index;this.reader.setIndex(F);var U=this.reader.readString(4)===G;return this.reader.setIndex(P),U},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var F=this.reader.readData(this.zipCommentLength),G=N.uint8array?"uint8array":"array",P=v.transformTo(G,F);this.zipComment=this.loadOptions.decodeFileName(P)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var F,G,P,U=this.zip64EndOfCentralSize-44;0<U;)F=this.reader.readInt(2),G=this.reader.readInt(4),P=this.reader.readData(G),this.zip64ExtensibleData[F]={id:F,length:G,value:P}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var F,G;for(F=0;F<this.files.length;F++)G=this.files[F],this.reader.setIndex(G.localHeaderOffset),this.checkSignature(w.LOCAL_FILE_HEADER),G.readLocalPart(this.reader),G.handleUTF8(),G.processAttributes()},readCentralDir:function(){var F;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(w.CENTRAL_FILE_HEADER);)(F=new S({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(F);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var F=this.reader.lastIndexOfSignature(w.CENTRAL_DIRECTORY_END);if(F<0)throw this.isSignature(0,w.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(F);var G=F;if(this.checkSignature(w.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===v.MAX_VALUE_16BITS||this.diskWithCentralDirStart===v.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===v.MAX_VALUE_16BITS||this.centralDirRecords===v.MAX_VALUE_16BITS||this.centralDirSize===v.MAX_VALUE_32BITS||this.centralDirOffset===v.MAX_VALUE_32BITS){if(this.zip64=!0,(F=this.reader.lastIndexOfSignature(w.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(F),this.checkSignature(w.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,w.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(w.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(w.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var P=this.centralDirOffset+this.centralDirSize;this.zip64&&(P+=20,P+=12+this.zip64EndOfCentralSize);var U=G-P;if(0<U)this.isSignature(G,w.CENTRAL_FILE_HEADER)||(this.reader.zero=U);else if(U<0)throw new Error("Corrupted zip: missing "+Math.abs(U)+" bytes.")},prepareReader:function(F){this.reader=b(F)},load:function(F){this.prepareReader(F),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},g.exports=D},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(f,g,y){var b=f("./reader/readerFor"),v=f("./utils"),w=f("./compressedObject"),S=f("./crc32"),N=f("./utf8"),D=f("./compressions"),F=f("./support");function G(P,U){this.options=P,this.loadOptions=U}G.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(P){var U,q;if(P.skip(22),this.fileNameLength=P.readInt(2),q=P.readInt(2),this.fileName=P.readData(this.fileNameLength),P.skip(q),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((U=(function(R){for(var I in D)if(Object.prototype.hasOwnProperty.call(D,I)&&D[I].magic===R)return D[I];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+v.pretty(this.compressionMethod)+" unknown (inner file : "+v.transformTo("string",this.fileName)+")");this.decompressed=new w(this.compressedSize,this.uncompressedSize,this.crc32,U,P.readData(this.compressedSize))},readCentralPart:function(P){this.versionMadeBy=P.readInt(2),P.skip(2),this.bitFlag=P.readInt(2),this.compressionMethod=P.readString(2),this.date=P.readDate(),this.crc32=P.readInt(4),this.compressedSize=P.readInt(4),this.uncompressedSize=P.readInt(4);var U=P.readInt(2);if(this.extraFieldsLength=P.readInt(2),this.fileCommentLength=P.readInt(2),this.diskNumberStart=P.readInt(2),this.internalFileAttributes=P.readInt(2),this.externalFileAttributes=P.readInt(4),this.localHeaderOffset=P.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");P.skip(U),this.readExtraFields(P),this.parseZIP64ExtraField(P),this.fileComment=P.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var P=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),P==0&&(this.dosPermissions=63&this.externalFileAttributes),P==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var P=b(this.extraFields[1].value);this.uncompressedSize===v.MAX_VALUE_32BITS&&(this.uncompressedSize=P.readInt(8)),this.compressedSize===v.MAX_VALUE_32BITS&&(this.compressedSize=P.readInt(8)),this.localHeaderOffset===v.MAX_VALUE_32BITS&&(this.localHeaderOffset=P.readInt(8)),this.diskNumberStart===v.MAX_VALUE_32BITS&&(this.diskNumberStart=P.readInt(4))}},readExtraFields:function(P){var U,q,R,I=P.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});P.index+4<I;)U=P.readInt(2),q=P.readInt(2),R=P.readData(q),this.extraFields[U]={id:U,length:q,value:R};P.setIndex(I)},handleUTF8:function(){var P=F.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=N.utf8decode(this.fileName),this.fileCommentStr=N.utf8decode(this.fileComment);else{var U=this.findExtraFieldUnicodePath();if(U!==null)this.fileNameStr=U;else{var q=v.transformTo(P,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(q)}var R=this.findExtraFieldUnicodeComment();if(R!==null)this.fileCommentStr=R;else{var I=v.transformTo(P,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(I)}}},findExtraFieldUnicodePath:function(){var P=this.extraFields[28789];if(P){var U=b(P.value);return U.readInt(1)!==1||S(this.fileName)!==U.readInt(4)?null:N.utf8decode(U.readData(P.length-5))}return null},findExtraFieldUnicodeComment:function(){var P=this.extraFields[25461];if(P){var U=b(P.value);return U.readInt(1)!==1||S(this.fileComment)!==U.readInt(4)?null:N.utf8decode(U.readData(P.length-5))}return null}},g.exports=G},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(f,g,y){function b(U,q,R){this.name=U,this.dir=R.dir,this.date=R.date,this.comment=R.comment,this.unixPermissions=R.unixPermissions,this.dosPermissions=R.dosPermissions,this._data=q,this._dataBinary=R.binary,this.options={compression:R.compression,compressionOptions:R.compressionOptions}}var v=f("./stream/StreamHelper"),w=f("./stream/DataWorker"),S=f("./utf8"),N=f("./compressedObject"),D=f("./stream/GenericWorker");b.prototype={internalStream:function(U){var q=null,R="string";try{if(!U)throw new Error("No output type specified.");var I=(R=U.toLowerCase())==="string"||R==="text";R!=="binarystring"&&R!=="text"||(R="string"),q=this._decompressWorker();var T=!this._dataBinary;T&&!I&&(q=q.pipe(new S.Utf8EncodeWorker)),!T&&I&&(q=q.pipe(new S.Utf8DecodeWorker))}catch(L){(q=new D("error")).error(L)}return new v(q,R,"")},async:function(U,q){return this.internalStream(U).accumulate(q)},nodeStream:function(U,q){return this.internalStream(U||"nodebuffer").toNodejsStream(q)},_compressWorker:function(U,q){if(this._data instanceof N&&this._data.compression.magic===U.magic)return this._data.getCompressedWorker();var R=this._decompressWorker();return this._dataBinary||(R=R.pipe(new S.Utf8EncodeWorker)),N.createWorkerFrom(R,U,q)},_decompressWorker:function(){return this._data instanceof N?this._data.getContentWorker():this._data instanceof D?this._data:new w(this._data)}};for(var F=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],G=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},P=0;P<F.length;P++)b.prototype[F[P]]=G;g.exports=b},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(f,g,y){(function(b){var v,w,S=b.MutationObserver||b.WebKitMutationObserver;if(S){var N=0,D=new S(U),F=b.document.createTextNode("");D.observe(F,{characterData:!0}),v=function(){F.data=N=++N%2}}else if(b.setImmediate||b.MessageChannel===void 0)v="document"in b&&"onreadystatechange"in b.document.createElement("script")?function(){var q=b.document.createElement("script");q.onreadystatechange=function(){U(),q.onreadystatechange=null,q.parentNode.removeChild(q),q=null},b.document.documentElement.appendChild(q)}:function(){setTimeout(U,0)};else{var G=new b.MessageChannel;G.port1.onmessage=U,v=function(){G.port2.postMessage(0)}}var P=[];function U(){var q,R;w=!0;for(var I=P.length;I;){for(R=P,P=[],q=-1;++q<I;)R[q]();I=P.length}w=!1}g.exports=function(q){P.push(q)!==1||w||v()}}).call(this,a!==void 0?a:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(f,g,y){var b=f("immediate");function v(){}var w={},S=["REJECTED"],N=["FULFILLED"],D=["PENDING"];function F(I){if(typeof I!="function")throw new TypeError("resolver must be a function");this.state=D,this.queue=[],this.outcome=void 0,I!==v&&q(this,I)}function G(I,T,L){this.promise=I,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function P(I,T,L){b((function(){var E;try{E=T(L)}catch(x){return w.reject(I,x)}E===I?w.reject(I,new TypeError("Cannot resolve promise with itself")):w.resolve(I,E)}))}function U(I){var T=I&&I.then;if(I&&(typeof I=="object"||typeof I=="function")&&typeof T=="function")return function(){T.apply(I,arguments)}}function q(I,T){var L=!1;function E(A){L||(L=!0,w.reject(I,A))}function x(A){L||(L=!0,w.resolve(I,A))}var k=R((function(){T(x,E)}));k.status==="error"&&E(k.value)}function R(I,T){var L={};try{L.value=I(T),L.status="success"}catch(E){L.status="error",L.value=E}return L}(g.exports=F).prototype.finally=function(I){if(typeof I!="function")return this;var T=this.constructor;return this.then((function(L){return T.resolve(I()).then((function(){return L}))}),(function(L){return T.resolve(I()).then((function(){throw L}))}))},F.prototype.catch=function(I){return this.then(null,I)},F.prototype.then=function(I,T){if(typeof I!="function"&&this.state===N||typeof T!="function"&&this.state===S)return this;var L=new this.constructor(v);return this.state!==D?P(L,this.state===N?I:T,this.outcome):this.queue.push(new G(L,I,T)),L},G.prototype.callFulfilled=function(I){w.resolve(this.promise,I)},G.prototype.otherCallFulfilled=function(I){P(this.promise,this.onFulfilled,I)},G.prototype.callRejected=function(I){w.reject(this.promise,I)},G.prototype.otherCallRejected=function(I){P(this.promise,this.onRejected,I)},w.resolve=function(I,T){var L=R(U,T);if(L.status==="error")return w.reject(I,L.value);var E=L.value;if(E)q(I,E);else{I.state=N,I.outcome=T;for(var x=-1,k=I.queue.length;++x<k;)I.queue[x].callFulfilled(T)}return I},w.reject=function(I,T){I.state=S,I.outcome=T;for(var L=-1,E=I.queue.length;++L<E;)I.queue[L].callRejected(T);return I},F.resolve=function(I){return I instanceof this?I:w.resolve(new this(v),I)},F.reject=function(I){var T=new this(v);return w.reject(T,I)},F.all=function(I){var T=this;if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=I.length,E=!1;if(!L)return this.resolve([]);for(var x=new Array(L),k=0,A=-1,C=new this(v);++A<L;)j(I[A],A);return C;function j(B,O){T.resolve(B).then((function(H){x[O]=H,++k!==L||E||(E=!0,w.resolve(C,x))}),(function(H){E||(E=!0,w.reject(C,H))}))}},F.race=function(I){if(Object.prototype.toString.call(I)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=I.length,L=!1;if(!T)return this.resolve([]);for(var E,x=-1,k=new this(v);++x<T;)E=I[x],this.resolve(E).then((function(A){L||(L=!0,w.resolve(k,A))}),(function(A){L||(L=!0,w.reject(k,A))}));return k}},{immediate:36}],38:[function(f,g,y){var b={};(0,f("./lib/utils/common").assign)(b,f("./lib/deflate"),f("./lib/inflate"),f("./lib/zlib/constants")),g.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(f,g,y){var b=f("./zlib/deflate"),v=f("./utils/common"),w=f("./utils/strings"),S=f("./zlib/messages"),N=f("./zlib/zstream"),D=Object.prototype.toString;function F(P){if(!(this instanceof F))return new F(P);this.options=v.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},P||{});var U=this.options;U.raw&&0<U.windowBits?U.windowBits=-U.windowBits:U.gzip&&0<U.windowBits&&U.windowBits<16&&(U.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var q=b.deflateInit2(this.strm,U.level,U.method,U.windowBits,U.memLevel,U.strategy);if(q!==0)throw new Error(S[q]);if(U.header&&b.deflateSetHeader(this.strm,U.header),U.dictionary){var R;if(R=typeof U.dictionary=="string"?w.string2buf(U.dictionary):D.call(U.dictionary)==="[object ArrayBuffer]"?new Uint8Array(U.dictionary):U.dictionary,(q=b.deflateSetDictionary(this.strm,R))!==0)throw new Error(S[q]);this._dict_set=!0}}function G(P,U){var q=new F(U);if(q.push(P,!0),q.err)throw q.msg||S[q.err];return q.result}F.prototype.push=function(P,U){var q,R,I=this.strm,T=this.options.chunkSize;if(this.ended)return!1;R=U===~~U?U:U===!0?4:0,typeof P=="string"?I.input=w.string2buf(P):D.call(P)==="[object ArrayBuffer]"?I.input=new Uint8Array(P):I.input=P,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new v.Buf8(T),I.next_out=0,I.avail_out=T),(q=b.deflate(I,R))!==1&&q!==0)return this.onEnd(q),!(this.ended=!0);I.avail_out!==0&&(I.avail_in!==0||R!==4&&R!==2)||(this.options.to==="string"?this.onData(w.buf2binstring(v.shrinkBuf(I.output,I.next_out))):this.onData(v.shrinkBuf(I.output,I.next_out)))}while((0<I.avail_in||I.avail_out===0)&&q!==1);return R===4?(q=b.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===0):R!==2||(this.onEnd(0),!(I.avail_out=0))},F.prototype.onData=function(P){this.chunks.push(P)},F.prototype.onEnd=function(P){P===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg},y.Deflate=F,y.deflate=G,y.deflateRaw=function(P,U){return(U=U||{}).raw=!0,G(P,U)},y.gzip=function(P,U){return(U=U||{}).gzip=!0,G(P,U)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(f,g,y){var b=f("./zlib/inflate"),v=f("./utils/common"),w=f("./utils/strings"),S=f("./zlib/constants"),N=f("./zlib/messages"),D=f("./zlib/zstream"),F=f("./zlib/gzheader"),G=Object.prototype.toString;function P(q){if(!(this instanceof P))return new P(q);this.options=v.assign({chunkSize:16384,windowBits:0,to:""},q||{});var R=this.options;R.raw&&0<=R.windowBits&&R.windowBits<16&&(R.windowBits=-R.windowBits,R.windowBits===0&&(R.windowBits=-15)),!(0<=R.windowBits&&R.windowBits<16)||q&&q.windowBits||(R.windowBits+=32),15<R.windowBits&&R.windowBits<48&&(15&R.windowBits)==0&&(R.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var I=b.inflateInit2(this.strm,R.windowBits);if(I!==S.Z_OK)throw new Error(N[I]);this.header=new F,b.inflateGetHeader(this.strm,this.header)}function U(q,R){var I=new P(R);if(I.push(q,!0),I.err)throw I.msg||N[I.err];return I.result}P.prototype.push=function(q,R){var I,T,L,E,x,k,A=this.strm,C=this.options.chunkSize,j=this.options.dictionary,B=!1;if(this.ended)return!1;T=R===~~R?R:R===!0?S.Z_FINISH:S.Z_NO_FLUSH,typeof q=="string"?A.input=w.binstring2buf(q):G.call(q)==="[object ArrayBuffer]"?A.input=new Uint8Array(q):A.input=q,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new v.Buf8(C),A.next_out=0,A.avail_out=C),(I=b.inflate(A,S.Z_NO_FLUSH))===S.Z_NEED_DICT&&j&&(k=typeof j=="string"?w.string2buf(j):G.call(j)==="[object ArrayBuffer]"?new Uint8Array(j):j,I=b.inflateSetDictionary(this.strm,k)),I===S.Z_BUF_ERROR&&B===!0&&(I=S.Z_OK,B=!1),I!==S.Z_STREAM_END&&I!==S.Z_OK)return this.onEnd(I),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&I!==S.Z_STREAM_END&&(A.avail_in!==0||T!==S.Z_FINISH&&T!==S.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=w.utf8border(A.output,A.next_out),E=A.next_out-L,x=w.buf2string(A.output,L),A.next_out=E,A.avail_out=C-E,E&&v.arraySet(A.output,A.output,L,E,0),this.onData(x)):this.onData(v.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(B=!0)}while((0<A.avail_in||A.avail_out===0)&&I!==S.Z_STREAM_END);return I===S.Z_STREAM_END&&(T=S.Z_FINISH),T===S.Z_FINISH?(I=b.inflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===S.Z_OK):T!==S.Z_SYNC_FLUSH||(this.onEnd(S.Z_OK),!(A.avail_out=0))},P.prototype.onData=function(q){this.chunks.push(q)},P.prototype.onEnd=function(q){q===S.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=q,this.msg=this.strm.msg},y.Inflate=P,y.inflate=U,y.inflateRaw=function(q,R){return(R=R||{}).raw=!0,U(q,R)},y.ungzip=U},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(f,g,y){var b=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";y.assign=function(S){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var D=N.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var F in D)D.hasOwnProperty(F)&&(S[F]=D[F])}}return S},y.shrinkBuf=function(S,N){return S.length===N?S:S.subarray?S.subarray(0,N):(S.length=N,S)};var v={arraySet:function(S,N,D,F,G){if(N.subarray&&S.subarray)S.set(N.subarray(D,D+F),G);else for(var P=0;P<F;P++)S[G+P]=N[D+P]},flattenChunks:function(S){var N,D,F,G,P,U;for(N=F=0,D=S.length;N<D;N++)F+=S[N].length;for(U=new Uint8Array(F),N=G=0,D=S.length;N<D;N++)P=S[N],U.set(P,G),G+=P.length;return U}},w={arraySet:function(S,N,D,F,G){for(var P=0;P<F;P++)S[G+P]=N[D+P]},flattenChunks:function(S){return[].concat.apply([],S)}};y.setTyped=function(S){S?(y.Buf8=Uint8Array,y.Buf16=Uint16Array,y.Buf32=Int32Array,y.assign(y,v)):(y.Buf8=Array,y.Buf16=Array,y.Buf32=Array,y.assign(y,w))},y.setTyped(b)},{}],42:[function(f,g,y){var b=f("./common"),v=!0,w=!0;try{String.fromCharCode.apply(null,[0])}catch{v=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{w=!1}for(var S=new b.Buf8(256),N=0;N<256;N++)S[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function D(F,G){if(G<65537&&(F.subarray&&w||!F.subarray&&v))return String.fromCharCode.apply(null,b.shrinkBuf(F,G));for(var P="",U=0;U<G;U++)P+=String.fromCharCode(F[U]);return P}S[254]=S[254]=1,y.string2buf=function(F){var G,P,U,q,R,I=F.length,T=0;for(q=0;q<I;q++)(64512&(P=F.charCodeAt(q)))==55296&&q+1<I&&(64512&(U=F.charCodeAt(q+1)))==56320&&(P=65536+(P-55296<<10)+(U-56320),q++),T+=P<128?1:P<2048?2:P<65536?3:4;for(G=new b.Buf8(T),q=R=0;R<T;q++)(64512&(P=F.charCodeAt(q)))==55296&&q+1<I&&(64512&(U=F.charCodeAt(q+1)))==56320&&(P=65536+(P-55296<<10)+(U-56320),q++),P<128?G[R++]=P:(P<2048?G[R++]=192|P>>>6:(P<65536?G[R++]=224|P>>>12:(G[R++]=240|P>>>18,G[R++]=128|P>>>12&63),G[R++]=128|P>>>6&63),G[R++]=128|63&P);return G},y.buf2binstring=function(F){return D(F,F.length)},y.binstring2buf=function(F){for(var G=new b.Buf8(F.length),P=0,U=G.length;P<U;P++)G[P]=F.charCodeAt(P);return G},y.buf2string=function(F,G){var P,U,q,R,I=G||F.length,T=new Array(2*I);for(P=U=0;P<I;)if((q=F[P++])<128)T[U++]=q;else if(4<(R=S[q]))T[U++]=65533,P+=R-1;else{for(q&=R===2?31:R===3?15:7;1<R&&P<I;)q=q<<6|63&F[P++],R--;1<R?T[U++]=65533:q<65536?T[U++]=q:(q-=65536,T[U++]=55296|q>>10&1023,T[U++]=56320|1023&q)}return D(T,U)},y.utf8border=function(F,G){var P;for((G=G||F.length)>F.length&&(G=F.length),P=G-1;0<=P&&(192&F[P])==128;)P--;return P<0||P===0?G:P+S[F[P]]>G?P:G}},{"./common":41}],43:[function(f,g,y){g.exports=function(b,v,w,S){for(var N=65535&b|0,D=b>>>16&65535|0,F=0;w!==0;){for(w-=F=2e3<w?2e3:w;D=D+(N=N+v[S++]|0)|0,--F;);N%=65521,D%=65521}return N|D<<16|0}},{}],44:[function(f,g,y){g.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(f,g,y){var b=(function(){for(var v,w=[],S=0;S<256;S++){v=S;for(var N=0;N<8;N++)v=1&v?3988292384^v>>>1:v>>>1;w[S]=v}return w})();g.exports=function(v,w,S,N){var D=b,F=N+S;v^=-1;for(var G=N;G<F;G++)v=v>>>8^D[255&(v^w[G])];return-1^v}},{}],46:[function(f,g,y){var b,v=f("../utils/common"),w=f("./trees"),S=f("./adler32"),N=f("./crc32"),D=f("./messages"),F=-2,G=258,P=262,U=113;function q(V,tt){return V.msg=D[tt],tt}function R(V){return(V<<1)-(4<V?9:0)}function I(V){for(var tt=V.length;0<=--tt;)V[tt]=0}function T(V){var tt=V.state,$=tt.pending;$>V.avail_out&&($=V.avail_out),$!==0&&(v.arraySet(V.output,tt.pending_buf,tt.pending_out,$,V.next_out),V.next_out+=$,tt.pending_out+=$,V.total_out+=$,V.avail_out-=$,tt.pending-=$,tt.pending===0&&(tt.pending_out=0))}function L(V,tt){w._tr_flush_block(V,0<=V.block_start?V.block_start:-1,V.strstart-V.block_start,tt),V.block_start=V.strstart,T(V.strm)}function E(V,tt){V.pending_buf[V.pending++]=tt}function x(V,tt){V.pending_buf[V.pending++]=tt>>>8&255,V.pending_buf[V.pending++]=255&tt}function k(V,tt){var $,z,Z=V.max_chain_length,it=V.strstart,mt=V.prev_length,lt=V.nice_match,at=V.strstart>V.w_size-P?V.strstart-(V.w_size-P):0,rt=V.window,ct=V.w_mask,ot=V.prev,dt=V.strstart+G,ft=rt[it+mt-1],gt=rt[it+mt];V.prev_length>=V.good_match&&(Z>>=2),lt>V.lookahead&&(lt=V.lookahead);do if(rt[($=tt)+mt]===gt&&rt[$+mt-1]===ft&&rt[$]===rt[it]&&rt[++$]===rt[it+1]){it+=2,$++;do;while(rt[++it]===rt[++$]&&rt[++it]===rt[++$]&&rt[++it]===rt[++$]&&rt[++it]===rt[++$]&&rt[++it]===rt[++$]&&rt[++it]===rt[++$]&&rt[++it]===rt[++$]&&rt[++it]===rt[++$]&&it<dt);if(z=G-(dt-it),it=dt-G,mt<z){if(V.match_start=tt,lt<=(mt=z))break;ft=rt[it+mt-1],gt=rt[it+mt]}}while((tt=ot[tt&ct])>at&&--Z!=0);return mt<=V.lookahead?mt:V.lookahead}function A(V){var tt,$,z,Z,it,mt,lt,at,rt,ct,ot=V.w_size;do{if(Z=V.window_size-V.lookahead-V.strstart,V.strstart>=ot+(ot-P)){for(v.arraySet(V.window,V.window,ot,ot,0),V.match_start-=ot,V.strstart-=ot,V.block_start-=ot,tt=$=V.hash_size;z=V.head[--tt],V.head[tt]=ot<=z?z-ot:0,--$;);for(tt=$=ot;z=V.prev[--tt],V.prev[tt]=ot<=z?z-ot:0,--$;);Z+=ot}if(V.strm.avail_in===0)break;if(mt=V.strm,lt=V.window,at=V.strstart+V.lookahead,ct=void 0,(rt=Z)<(ct=mt.avail_in)&&(ct=rt),$=ct===0?0:(mt.avail_in-=ct,v.arraySet(lt,mt.input,mt.next_in,ct,at),mt.state.wrap===1?mt.adler=S(mt.adler,lt,ct,at):mt.state.wrap===2&&(mt.adler=N(mt.adler,lt,ct,at)),mt.next_in+=ct,mt.total_in+=ct,ct),V.lookahead+=$,V.lookahead+V.insert>=3)for(it=V.strstart-V.insert,V.ins_h=V.window[it],V.ins_h=(V.ins_h<<V.hash_shift^V.window[it+1])&V.hash_mask;V.insert&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[it+3-1])&V.hash_mask,V.prev[it&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=it,it++,V.insert--,!(V.lookahead+V.insert<3)););}while(V.lookahead<P&&V.strm.avail_in!==0)}function C(V,tt){for(var $,z;;){if(V.lookahead<P){if(A(V),V.lookahead<P&&tt===0)return 1;if(V.lookahead===0)break}if($=0,V.lookahead>=3&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+3-1])&V.hash_mask,$=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),$!==0&&V.strstart-$<=V.w_size-P&&(V.match_length=k(V,$)),V.match_length>=3)if(z=w._tr_tally(V,V.strstart-V.match_start,V.match_length-3),V.lookahead-=V.match_length,V.match_length<=V.max_lazy_match&&V.lookahead>=3){for(V.match_length--;V.strstart++,V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+3-1])&V.hash_mask,$=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart,--V.match_length!=0;);V.strstart++}else V.strstart+=V.match_length,V.match_length=0,V.ins_h=V.window[V.strstart],V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+1])&V.hash_mask;else z=w._tr_tally(V,0,V.window[V.strstart]),V.lookahead--,V.strstart++;if(z&&(L(V,!1),V.strm.avail_out===0))return 1}return V.insert=V.strstart<2?V.strstart:2,tt===4?(L(V,!0),V.strm.avail_out===0?3:4):V.last_lit&&(L(V,!1),V.strm.avail_out===0)?1:2}function j(V,tt){for(var $,z,Z;;){if(V.lookahead<P){if(A(V),V.lookahead<P&&tt===0)return 1;if(V.lookahead===0)break}if($=0,V.lookahead>=3&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+3-1])&V.hash_mask,$=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),V.prev_length=V.match_length,V.prev_match=V.match_start,V.match_length=2,$!==0&&V.prev_length<V.max_lazy_match&&V.strstart-$<=V.w_size-P&&(V.match_length=k(V,$),V.match_length<=5&&(V.strategy===1||V.match_length===3&&4096<V.strstart-V.match_start)&&(V.match_length=2)),V.prev_length>=3&&V.match_length<=V.prev_length){for(Z=V.strstart+V.lookahead-3,z=w._tr_tally(V,V.strstart-1-V.prev_match,V.prev_length-3),V.lookahead-=V.prev_length-1,V.prev_length-=2;++V.strstart<=Z&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+3-1])&V.hash_mask,$=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),--V.prev_length!=0;);if(V.match_available=0,V.match_length=2,V.strstart++,z&&(L(V,!1),V.strm.avail_out===0))return 1}else if(V.match_available){if((z=w._tr_tally(V,0,V.window[V.strstart-1]))&&L(V,!1),V.strstart++,V.lookahead--,V.strm.avail_out===0)return 1}else V.match_available=1,V.strstart++,V.lookahead--}return V.match_available&&(z=w._tr_tally(V,0,V.window[V.strstart-1]),V.match_available=0),V.insert=V.strstart<2?V.strstart:2,tt===4?(L(V,!0),V.strm.avail_out===0?3:4):V.last_lit&&(L(V,!1),V.strm.avail_out===0)?1:2}function B(V,tt,$,z,Z){this.good_length=V,this.max_lazy=tt,this.nice_length=$,this.max_chain=z,this.func=Z}function O(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new v.Buf16(1146),this.dyn_dtree=new v.Buf16(122),this.bl_tree=new v.Buf16(78),I(this.dyn_ltree),I(this.dyn_dtree),I(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new v.Buf16(16),this.heap=new v.Buf16(573),I(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new v.Buf16(573),I(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function H(V){var tt;return V&&V.state?(V.total_in=V.total_out=0,V.data_type=2,(tt=V.state).pending=0,tt.pending_out=0,tt.wrap<0&&(tt.wrap=-tt.wrap),tt.status=tt.wrap?42:U,V.adler=tt.wrap===2?0:1,tt.last_flush=0,w._tr_init(tt),0):q(V,F)}function X(V){var tt=H(V);return tt===0&&(function($){$.window_size=2*$.w_size,I($.head),$.max_lazy_match=b[$.level].max_lazy,$.good_match=b[$.level].good_length,$.nice_match=b[$.level].nice_length,$.max_chain_length=b[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=2,$.match_available=0,$.ins_h=0})(V.state),tt}function et(V,tt,$,z,Z,it){if(!V)return F;var mt=1;if(tt===-1&&(tt=6),z<0?(mt=0,z=-z):15<z&&(mt=2,z-=16),Z<1||9<Z||$!==8||z<8||15<z||tt<0||9<tt||it<0||4<it)return q(V,F);z===8&&(z=9);var lt=new O;return(V.state=lt).strm=V,lt.wrap=mt,lt.gzhead=null,lt.w_bits=z,lt.w_size=1<<lt.w_bits,lt.w_mask=lt.w_size-1,lt.hash_bits=Z+7,lt.hash_size=1<<lt.hash_bits,lt.hash_mask=lt.hash_size-1,lt.hash_shift=~~((lt.hash_bits+3-1)/3),lt.window=new v.Buf8(2*lt.w_size),lt.head=new v.Buf16(lt.hash_size),lt.prev=new v.Buf16(lt.w_size),lt.lit_bufsize=1<<Z+6,lt.pending_buf_size=4*lt.lit_bufsize,lt.pending_buf=new v.Buf8(lt.pending_buf_size),lt.d_buf=1*lt.lit_bufsize,lt.l_buf=3*lt.lit_bufsize,lt.level=tt,lt.strategy=it,lt.method=$,X(V)}b=[new B(0,0,0,0,(function(V,tt){var $=65535;for($>V.pending_buf_size-5&&($=V.pending_buf_size-5);;){if(V.lookahead<=1){if(A(V),V.lookahead===0&&tt===0)return 1;if(V.lookahead===0)break}V.strstart+=V.lookahead,V.lookahead=0;var z=V.block_start+$;if((V.strstart===0||V.strstart>=z)&&(V.lookahead=V.strstart-z,V.strstart=z,L(V,!1),V.strm.avail_out===0)||V.strstart-V.block_start>=V.w_size-P&&(L(V,!1),V.strm.avail_out===0))return 1}return V.insert=0,tt===4?(L(V,!0),V.strm.avail_out===0?3:4):(V.strstart>V.block_start&&(L(V,!1),V.strm.avail_out),1)})),new B(4,4,8,4,C),new B(4,5,16,8,C),new B(4,6,32,32,C),new B(4,4,16,16,j),new B(8,16,32,32,j),new B(8,16,128,128,j),new B(8,32,128,256,j),new B(32,128,258,1024,j),new B(32,258,258,4096,j)],y.deflateInit=function(V,tt){return et(V,tt,8,15,8,0)},y.deflateInit2=et,y.deflateReset=X,y.deflateResetKeep=H,y.deflateSetHeader=function(V,tt){return V&&V.state?V.state.wrap!==2?F:(V.state.gzhead=tt,0):F},y.deflate=function(V,tt){var $,z,Z,it;if(!V||!V.state||5<tt||tt<0)return V?q(V,F):F;if(z=V.state,!V.output||!V.input&&V.avail_in!==0||z.status===666&&tt!==4)return q(V,V.avail_out===0?-5:F);if(z.strm=V,$=z.last_flush,z.last_flush=tt,z.status===42)if(z.wrap===2)V.adler=0,E(z,31),E(z,139),E(z,8),z.gzhead?(E(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),E(z,255&z.gzhead.time),E(z,z.gzhead.time>>8&255),E(z,z.gzhead.time>>16&255),E(z,z.gzhead.time>>24&255),E(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),E(z,255&z.gzhead.os),z.gzhead.extra&&z.gzhead.extra.length&&(E(z,255&z.gzhead.extra.length),E(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(V.adler=N(V.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=69):(E(z,0),E(z,0),E(z,0),E(z,0),E(z,0),E(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),E(z,3),z.status=U);else{var mt=8+(z.w_bits-8<<4)<<8;mt|=(2<=z.strategy||z.level<2?0:z.level<6?1:z.level===6?2:3)<<6,z.strstart!==0&&(mt|=32),mt+=31-mt%31,z.status=U,x(z,mt),z.strstart!==0&&(x(z,V.adler>>>16),x(z,65535&V.adler)),V.adler=1}if(z.status===69)if(z.gzhead.extra){for(Z=z.pending;z.gzindex<(65535&z.gzhead.extra.length)&&(z.pending!==z.pending_buf_size||(z.gzhead.hcrc&&z.pending>Z&&(V.adler=N(V.adler,z.pending_buf,z.pending-Z,Z)),T(V),Z=z.pending,z.pending!==z.pending_buf_size));)E(z,255&z.gzhead.extra[z.gzindex]),z.gzindex++;z.gzhead.hcrc&&z.pending>Z&&(V.adler=N(V.adler,z.pending_buf,z.pending-Z,Z)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=73)}else z.status=73;if(z.status===73)if(z.gzhead.name){Z=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>Z&&(V.adler=N(V.adler,z.pending_buf,z.pending-Z,Z)),T(V),Z=z.pending,z.pending===z.pending_buf_size)){it=1;break}it=z.gzindex<z.gzhead.name.length?255&z.gzhead.name.charCodeAt(z.gzindex++):0,E(z,it)}while(it!==0);z.gzhead.hcrc&&z.pending>Z&&(V.adler=N(V.adler,z.pending_buf,z.pending-Z,Z)),it===0&&(z.gzindex=0,z.status=91)}else z.status=91;if(z.status===91)if(z.gzhead.comment){Z=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>Z&&(V.adler=N(V.adler,z.pending_buf,z.pending-Z,Z)),T(V),Z=z.pending,z.pending===z.pending_buf_size)){it=1;break}it=z.gzindex<z.gzhead.comment.length?255&z.gzhead.comment.charCodeAt(z.gzindex++):0,E(z,it)}while(it!==0);z.gzhead.hcrc&&z.pending>Z&&(V.adler=N(V.adler,z.pending_buf,z.pending-Z,Z)),it===0&&(z.status=103)}else z.status=103;if(z.status===103&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&T(V),z.pending+2<=z.pending_buf_size&&(E(z,255&V.adler),E(z,V.adler>>8&255),V.adler=0,z.status=U)):z.status=U),z.pending!==0){if(T(V),V.avail_out===0)return z.last_flush=-1,0}else if(V.avail_in===0&&R(tt)<=R($)&&tt!==4)return q(V,-5);if(z.status===666&&V.avail_in!==0)return q(V,-5);if(V.avail_in!==0||z.lookahead!==0||tt!==0&&z.status!==666){var lt=z.strategy===2?(function(at,rt){for(var ct;;){if(at.lookahead===0&&(A(at),at.lookahead===0)){if(rt===0)return 1;break}if(at.match_length=0,ct=w._tr_tally(at,0,at.window[at.strstart]),at.lookahead--,at.strstart++,ct&&(L(at,!1),at.strm.avail_out===0))return 1}return at.insert=0,rt===4?(L(at,!0),at.strm.avail_out===0?3:4):at.last_lit&&(L(at,!1),at.strm.avail_out===0)?1:2})(z,tt):z.strategy===3?(function(at,rt){for(var ct,ot,dt,ft,gt=at.window;;){if(at.lookahead<=G){if(A(at),at.lookahead<=G&&rt===0)return 1;if(at.lookahead===0)break}if(at.match_length=0,at.lookahead>=3&&0<at.strstart&&(ot=gt[dt=at.strstart-1])===gt[++dt]&&ot===gt[++dt]&&ot===gt[++dt]){ft=at.strstart+G;do;while(ot===gt[++dt]&&ot===gt[++dt]&&ot===gt[++dt]&&ot===gt[++dt]&&ot===gt[++dt]&&ot===gt[++dt]&&ot===gt[++dt]&&ot===gt[++dt]&&dt<ft);at.match_length=G-(ft-dt),at.match_length>at.lookahead&&(at.match_length=at.lookahead)}if(at.match_length>=3?(ct=w._tr_tally(at,1,at.match_length-3),at.lookahead-=at.match_length,at.strstart+=at.match_length,at.match_length=0):(ct=w._tr_tally(at,0,at.window[at.strstart]),at.lookahead--,at.strstart++),ct&&(L(at,!1),at.strm.avail_out===0))return 1}return at.insert=0,rt===4?(L(at,!0),at.strm.avail_out===0?3:4):at.last_lit&&(L(at,!1),at.strm.avail_out===0)?1:2})(z,tt):b[z.level].func(z,tt);if(lt!==3&&lt!==4||(z.status=666),lt===1||lt===3)return V.avail_out===0&&(z.last_flush=-1),0;if(lt===2&&(tt===1?w._tr_align(z):tt!==5&&(w._tr_stored_block(z,0,0,!1),tt===3&&(I(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),T(V),V.avail_out===0))return z.last_flush=-1,0}return tt!==4?0:z.wrap<=0?1:(z.wrap===2?(E(z,255&V.adler),E(z,V.adler>>8&255),E(z,V.adler>>16&255),E(z,V.adler>>24&255),E(z,255&V.total_in),E(z,V.total_in>>8&255),E(z,V.total_in>>16&255),E(z,V.total_in>>24&255)):(x(z,V.adler>>>16),x(z,65535&V.adler)),T(V),0<z.wrap&&(z.wrap=-z.wrap),z.pending!==0?0:1)},y.deflateEnd=function(V){var tt;return V&&V.state?(tt=V.state.status)!==42&&tt!==69&&tt!==73&&tt!==91&&tt!==103&&tt!==U&&tt!==666?q(V,F):(V.state=null,tt===U?q(V,-3):0):F},y.deflateSetDictionary=function(V,tt){var $,z,Z,it,mt,lt,at,rt,ct=tt.length;if(!V||!V.state||(it=($=V.state).wrap)===2||it===1&&$.status!==42||$.lookahead)return F;for(it===1&&(V.adler=S(V.adler,tt,ct,0)),$.wrap=0,ct>=$.w_size&&(it===0&&(I($.head),$.strstart=0,$.block_start=0,$.insert=0),rt=new v.Buf8($.w_size),v.arraySet(rt,tt,ct-$.w_size,$.w_size,0),tt=rt,ct=$.w_size),mt=V.avail_in,lt=V.next_in,at=V.input,V.avail_in=ct,V.next_in=0,V.input=tt,A($);$.lookahead>=3;){for(z=$.strstart,Z=$.lookahead-2;$.ins_h=($.ins_h<<$.hash_shift^$.window[z+3-1])&$.hash_mask,$.prev[z&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=z,z++,--Z;);$.strstart=z,$.lookahead=2,A($)}return $.strstart+=$.lookahead,$.block_start=$.strstart,$.insert=$.lookahead,$.lookahead=0,$.match_length=$.prev_length=2,$.match_available=0,V.next_in=lt,V.input=at,V.avail_in=mt,$.wrap=it,0},y.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(f,g,y){g.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(f,g,y){g.exports=function(b,v){var w,S,N,D,F,G,P,U,q,R,I,T,L,E,x,k,A,C,j,B,O,H,X,et,V;w=b.state,S=b.next_in,et=b.input,N=S+(b.avail_in-5),D=b.next_out,V=b.output,F=D-(v-b.avail_out),G=D+(b.avail_out-257),P=w.dmax,U=w.wsize,q=w.whave,R=w.wnext,I=w.window,T=w.hold,L=w.bits,E=w.lencode,x=w.distcode,k=(1<<w.lenbits)-1,A=(1<<w.distbits)-1;t:do{L<15&&(T+=et[S++]<<L,L+=8,T+=et[S++]<<L,L+=8),C=E[T&k];e:for(;;){if(T>>>=j=C>>>24,L-=j,(j=C>>>16&255)==0)V[D++]=65535&C;else{if(!(16&j)){if((64&j)==0){C=E[(65535&C)+(T&(1<<j)-1)];continue e}if(32&j){w.mode=12;break t}b.msg="invalid literal/length code",w.mode=30;break t}B=65535&C,(j&=15)&&(L<j&&(T+=et[S++]<<L,L+=8),B+=T&(1<<j)-1,T>>>=j,L-=j),L<15&&(T+=et[S++]<<L,L+=8,T+=et[S++]<<L,L+=8),C=x[T&A];n:for(;;){if(T>>>=j=C>>>24,L-=j,!(16&(j=C>>>16&255))){if((64&j)==0){C=x[(65535&C)+(T&(1<<j)-1)];continue n}b.msg="invalid distance code",w.mode=30;break t}if(O=65535&C,L<(j&=15)&&(T+=et[S++]<<L,(L+=8)<j&&(T+=et[S++]<<L,L+=8)),P<(O+=T&(1<<j)-1)){b.msg="invalid distance too far back",w.mode=30;break t}if(T>>>=j,L-=j,(j=D-F)<O){if(q<(j=O-j)&&w.sane){b.msg="invalid distance too far back",w.mode=30;break t}if(X=I,(H=0)===R){if(H+=U-j,j<B){for(B-=j;V[D++]=I[H++],--j;);H=D-O,X=V}}else if(R<j){if(H+=U+R-j,(j-=R)<B){for(B-=j;V[D++]=I[H++],--j;);if(H=0,R<B){for(B-=j=R;V[D++]=I[H++],--j;);H=D-O,X=V}}}else if(H+=R-j,j<B){for(B-=j;V[D++]=I[H++],--j;);H=D-O,X=V}for(;2<B;)V[D++]=X[H++],V[D++]=X[H++],V[D++]=X[H++],B-=3;B&&(V[D++]=X[H++],1<B&&(V[D++]=X[H++]))}else{for(H=D-O;V[D++]=V[H++],V[D++]=V[H++],V[D++]=V[H++],2<(B-=3););B&&(V[D++]=V[H++],1<B&&(V[D++]=V[H++]))}break}}break}}while(S<N&&D<G);S-=B=L>>3,T&=(1<<(L-=B<<3))-1,b.next_in=S,b.next_out=D,b.avail_in=S<N?N-S+5:5-(S-N),b.avail_out=D<G?G-D+257:257-(D-G),w.hold=T,w.bits=L}},{}],49:[function(f,g,y){var b=f("../utils/common"),v=f("./adler32"),w=f("./crc32"),S=f("./inffast"),N=f("./inftrees"),D=-2;function F(k){return(k>>>24&255)+(k>>>8&65280)+((65280&k)<<8)+((255&k)<<24)}function G(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new b.Buf16(320),this.work=new b.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function P(k){var A;return k&&k.state?(A=k.state,k.total_in=k.total_out=A.total=0,k.msg="",A.wrap&&(k.adler=1&A.wrap),A.mode=1,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new b.Buf32(852),A.distcode=A.distdyn=new b.Buf32(592),A.sane=1,A.back=-1,0):D}function U(k){var A;return k&&k.state?((A=k.state).wsize=0,A.whave=0,A.wnext=0,P(k)):D}function q(k,A){var C,j;return k&&k.state?(j=k.state,A<0?(C=0,A=-A):(C=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?D:(j.window!==null&&j.wbits!==A&&(j.window=null),j.wrap=C,j.wbits=A,U(k))):D}function R(k,A){var C,j;return k?(j=new G,(k.state=j).window=null,(C=q(k,A))!==0&&(k.state=null),C):D}var I,T,L=!0;function E(k){if(L){var A;for(I=new b.Buf32(512),T=new b.Buf32(32),A=0;A<144;)k.lens[A++]=8;for(;A<256;)k.lens[A++]=9;for(;A<280;)k.lens[A++]=7;for(;A<288;)k.lens[A++]=8;for(N(1,k.lens,0,288,I,0,k.work,{bits:9}),A=0;A<32;)k.lens[A++]=5;N(2,k.lens,0,32,T,0,k.work,{bits:5}),L=!1}k.lencode=I,k.lenbits=9,k.distcode=T,k.distbits=5}function x(k,A,C,j){var B,O=k.state;return O.window===null&&(O.wsize=1<<O.wbits,O.wnext=0,O.whave=0,O.window=new b.Buf8(O.wsize)),j>=O.wsize?(b.arraySet(O.window,A,C-O.wsize,O.wsize,0),O.wnext=0,O.whave=O.wsize):(j<(B=O.wsize-O.wnext)&&(B=j),b.arraySet(O.window,A,C-j,B,O.wnext),(j-=B)?(b.arraySet(O.window,A,C-j,j,0),O.wnext=j,O.whave=O.wsize):(O.wnext+=B,O.wnext===O.wsize&&(O.wnext=0),O.whave<O.wsize&&(O.whave+=B))),0}y.inflateReset=U,y.inflateReset2=q,y.inflateResetKeep=P,y.inflateInit=function(k){return R(k,15)},y.inflateInit2=R,y.inflate=function(k,A){var C,j,B,O,H,X,et,V,tt,$,z,Z,it,mt,lt,at,rt,ct,ot,dt,ft,gt,wt,yt,Et=0,Mt=new b.Buf8(4),qt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&k.avail_in!==0)return D;(C=k.state).mode===12&&(C.mode=13),H=k.next_out,B=k.output,et=k.avail_out,O=k.next_in,j=k.input,X=k.avail_in,V=C.hold,tt=C.bits,$=X,z=et,gt=0;t:for(;;)switch(C.mode){case 1:if(C.wrap===0){C.mode=13;break}for(;tt<16;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if(2&C.wrap&&V===35615){Mt[C.check=0]=255&V,Mt[1]=V>>>8&255,C.check=w(C.check,Mt,2,0),tt=V=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&V)<<8)+(V>>8))%31){k.msg="incorrect header check",C.mode=30;break}if((15&V)!=8){k.msg="unknown compression method",C.mode=30;break}if(tt-=4,ft=8+(15&(V>>>=4)),C.wbits===0)C.wbits=ft;else if(ft>C.wbits){k.msg="invalid window size",C.mode=30;break}C.dmax=1<<ft,k.adler=C.check=1,C.mode=512&V?10:12,tt=V=0;break;case 2:for(;tt<16;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if(C.flags=V,(255&C.flags)!=8){k.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){k.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=V>>8&1),512&C.flags&&(Mt[0]=255&V,Mt[1]=V>>>8&255,C.check=w(C.check,Mt,2,0)),tt=V=0,C.mode=3;case 3:for(;tt<32;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}C.head&&(C.head.time=V),512&C.flags&&(Mt[0]=255&V,Mt[1]=V>>>8&255,Mt[2]=V>>>16&255,Mt[3]=V>>>24&255,C.check=w(C.check,Mt,4,0)),tt=V=0,C.mode=4;case 4:for(;tt<16;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}C.head&&(C.head.xflags=255&V,C.head.os=V>>8),512&C.flags&&(Mt[0]=255&V,Mt[1]=V>>>8&255,C.check=w(C.check,Mt,2,0)),tt=V=0,C.mode=5;case 5:if(1024&C.flags){for(;tt<16;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}C.length=V,C.head&&(C.head.extra_len=V),512&C.flags&&(Mt[0]=255&V,Mt[1]=V>>>8&255,C.check=w(C.check,Mt,2,0)),tt=V=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(X<(Z=C.length)&&(Z=X),Z&&(C.head&&(ft=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),b.arraySet(C.head.extra,j,O,Z,ft)),512&C.flags&&(C.check=w(C.check,j,Z,O)),X-=Z,O+=Z,C.length-=Z),C.length))break t;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(X===0)break t;for(Z=0;ft=j[O+Z++],C.head&&ft&&C.length<65536&&(C.head.name+=String.fromCharCode(ft)),ft&&Z<X;);if(512&C.flags&&(C.check=w(C.check,j,Z,O)),X-=Z,O+=Z,ft)break t}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(X===0)break t;for(Z=0;ft=j[O+Z++],C.head&&ft&&C.length<65536&&(C.head.comment+=String.fromCharCode(ft)),ft&&Z<X;);if(512&C.flags&&(C.check=w(C.check,j,Z,O)),X-=Z,O+=Z,ft)break t}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;tt<16;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if(V!==(65535&C.check)){k.msg="header crc mismatch",C.mode=30;break}tt=V=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),k.adler=C.check=0,C.mode=12;break;case 10:for(;tt<32;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}k.adler=C.check=F(V),tt=V=0,C.mode=11;case 11:if(C.havedict===0)return k.next_out=H,k.avail_out=et,k.next_in=O,k.avail_in=X,C.hold=V,C.bits=tt,2;k.adler=C.check=1,C.mode=12;case 12:if(A===5||A===6)break t;case 13:if(C.last){V>>>=7&tt,tt-=7&tt,C.mode=27;break}for(;tt<3;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}switch(C.last=1&V,tt-=1,3&(V>>>=1)){case 0:C.mode=14;break;case 1:if(E(C),C.mode=20,A!==6)break;V>>>=2,tt-=2;break t;case 2:C.mode=17;break;case 3:k.msg="invalid block type",C.mode=30}V>>>=2,tt-=2;break;case 14:for(V>>>=7&tt,tt-=7&tt;tt<32;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if((65535&V)!=(V>>>16^65535)){k.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&V,tt=V=0,C.mode=15,A===6)break t;case 15:C.mode=16;case 16:if(Z=C.length){if(X<Z&&(Z=X),et<Z&&(Z=et),Z===0)break t;b.arraySet(B,j,O,Z,H),X-=Z,O+=Z,et-=Z,H+=Z,C.length-=Z;break}C.mode=12;break;case 17:for(;tt<14;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if(C.nlen=257+(31&V),V>>>=5,tt-=5,C.ndist=1+(31&V),V>>>=5,tt-=5,C.ncode=4+(15&V),V>>>=4,tt-=4,286<C.nlen||30<C.ndist){k.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;tt<3;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}C.lens[qt[C.have++]]=7&V,V>>>=3,tt-=3}for(;C.have<19;)C.lens[qt[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,wt={bits:C.lenbits},gt=N(0,C.lens,0,19,C.lencode,0,C.work,wt),C.lenbits=wt.bits,gt){k.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;at=(Et=C.lencode[V&(1<<C.lenbits)-1])>>>16&255,rt=65535&Et,!((lt=Et>>>24)<=tt);){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if(rt<16)V>>>=lt,tt-=lt,C.lens[C.have++]=rt;else{if(rt===16){for(yt=lt+2;tt<yt;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if(V>>>=lt,tt-=lt,C.have===0){k.msg="invalid bit length repeat",C.mode=30;break}ft=C.lens[C.have-1],Z=3+(3&V),V>>>=2,tt-=2}else if(rt===17){for(yt=lt+3;tt<yt;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}tt-=lt,ft=0,Z=3+(7&(V>>>=lt)),V>>>=3,tt-=3}else{for(yt=lt+7;tt<yt;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}tt-=lt,ft=0,Z=11+(127&(V>>>=lt)),V>>>=7,tt-=7}if(C.have+Z>C.nlen+C.ndist){k.msg="invalid bit length repeat",C.mode=30;break}for(;Z--;)C.lens[C.have++]=ft}}if(C.mode===30)break;if(C.lens[256]===0){k.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,wt={bits:C.lenbits},gt=N(1,C.lens,0,C.nlen,C.lencode,0,C.work,wt),C.lenbits=wt.bits,gt){k.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,wt={bits:C.distbits},gt=N(2,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,wt),C.distbits=wt.bits,gt){k.msg="invalid distances set",C.mode=30;break}if(C.mode=20,A===6)break t;case 20:C.mode=21;case 21:if(6<=X&&258<=et){k.next_out=H,k.avail_out=et,k.next_in=O,k.avail_in=X,C.hold=V,C.bits=tt,S(k,z),H=k.next_out,B=k.output,et=k.avail_out,O=k.next_in,j=k.input,X=k.avail_in,V=C.hold,tt=C.bits,C.mode===12&&(C.back=-1);break}for(C.back=0;at=(Et=C.lencode[V&(1<<C.lenbits)-1])>>>16&255,rt=65535&Et,!((lt=Et>>>24)<=tt);){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if(at&&(240&at)==0){for(ct=lt,ot=at,dt=rt;at=(Et=C.lencode[dt+((V&(1<<ct+ot)-1)>>ct)])>>>16&255,rt=65535&Et,!(ct+(lt=Et>>>24)<=tt);){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}V>>>=ct,tt-=ct,C.back+=ct}if(V>>>=lt,tt-=lt,C.back+=lt,C.length=rt,at===0){C.mode=26;break}if(32&at){C.back=-1,C.mode=12;break}if(64&at){k.msg="invalid literal/length code",C.mode=30;break}C.extra=15&at,C.mode=22;case 22:if(C.extra){for(yt=C.extra;tt<yt;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}C.length+=V&(1<<C.extra)-1,V>>>=C.extra,tt-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;at=(Et=C.distcode[V&(1<<C.distbits)-1])>>>16&255,rt=65535&Et,!((lt=Et>>>24)<=tt);){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if((240&at)==0){for(ct=lt,ot=at,dt=rt;at=(Et=C.distcode[dt+((V&(1<<ct+ot)-1)>>ct)])>>>16&255,rt=65535&Et,!(ct+(lt=Et>>>24)<=tt);){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}V>>>=ct,tt-=ct,C.back+=ct}if(V>>>=lt,tt-=lt,C.back+=lt,64&at){k.msg="invalid distance code",C.mode=30;break}C.offset=rt,C.extra=15&at,C.mode=24;case 24:if(C.extra){for(yt=C.extra;tt<yt;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}C.offset+=V&(1<<C.extra)-1,V>>>=C.extra,tt-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){k.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(et===0)break t;if(Z=z-et,C.offset>Z){if((Z=C.offset-Z)>C.whave&&C.sane){k.msg="invalid distance too far back",C.mode=30;break}it=Z>C.wnext?(Z-=C.wnext,C.wsize-Z):C.wnext-Z,Z>C.length&&(Z=C.length),mt=C.window}else mt=B,it=H-C.offset,Z=C.length;for(et<Z&&(Z=et),et-=Z,C.length-=Z;B[H++]=mt[it++],--Z;);C.length===0&&(C.mode=21);break;case 26:if(et===0)break t;B[H++]=C.length,et--,C.mode=21;break;case 27:if(C.wrap){for(;tt<32;){if(X===0)break t;X--,V|=j[O++]<<tt,tt+=8}if(z-=et,k.total_out+=z,C.total+=z,z&&(k.adler=C.check=C.flags?w(C.check,B,z,H-z):v(C.check,B,z,H-z)),z=et,(C.flags?V:F(V))!==C.check){k.msg="incorrect data check",C.mode=30;break}tt=V=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;tt<32;){if(X===0)break t;X--,V+=j[O++]<<tt,tt+=8}if(V!==(4294967295&C.total)){k.msg="incorrect length check",C.mode=30;break}tt=V=0}C.mode=29;case 29:gt=1;break t;case 30:gt=-3;break t;case 31:return-4;case 32:default:return D}return k.next_out=H,k.avail_out=et,k.next_in=O,k.avail_in=X,C.hold=V,C.bits=tt,(C.wsize||z!==k.avail_out&&C.mode<30&&(C.mode<27||A!==4))&&x(k,k.output,k.next_out,z-k.avail_out)?(C.mode=31,-4):($-=k.avail_in,z-=k.avail_out,k.total_in+=$,k.total_out+=z,C.total+=z,C.wrap&&z&&(k.adler=C.check=C.flags?w(C.check,B,z,k.next_out-z):v(C.check,B,z,k.next_out-z)),k.data_type=C.bits+(C.last?64:0)+(C.mode===12?128:0)+(C.mode===20||C.mode===15?256:0),($==0&&z===0||A===4)&&gt===0&&(gt=-5),gt)},y.inflateEnd=function(k){if(!k||!k.state)return D;var A=k.state;return A.window&&(A.window=null),k.state=null,0},y.inflateGetHeader=function(k,A){var C;return k&&k.state?(2&(C=k.state).wrap)==0?D:((C.head=A).done=!1,0):D},y.inflateSetDictionary=function(k,A){var C,j=A.length;return k&&k.state?(C=k.state).wrap!==0&&C.mode!==11?D:C.mode===11&&v(1,A,j,0)!==C.check?-3:x(k,A,j,j)?(C.mode=31,-4):(C.havedict=1,0):D},y.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(f,g,y){var b=f("../utils/common"),v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],w=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];g.exports=function(D,F,G,P,U,q,R,I){var T,L,E,x,k,A,C,j,B,O=I.bits,H=0,X=0,et=0,V=0,tt=0,$=0,z=0,Z=0,it=0,mt=0,lt=null,at=0,rt=new b.Buf16(16),ct=new b.Buf16(16),ot=null,dt=0;for(H=0;H<=15;H++)rt[H]=0;for(X=0;X<P;X++)rt[F[G+X]]++;for(tt=O,V=15;1<=V&&rt[V]===0;V--);if(V<tt&&(tt=V),V===0)return U[q++]=20971520,U[q++]=20971520,I.bits=1,0;for(et=1;et<V&&rt[et]===0;et++);for(tt<et&&(tt=et),H=Z=1;H<=15;H++)if(Z<<=1,(Z-=rt[H])<0)return-1;if(0<Z&&(D===0||V!==1))return-1;for(ct[1]=0,H=1;H<15;H++)ct[H+1]=ct[H]+rt[H];for(X=0;X<P;X++)F[G+X]!==0&&(R[ct[F[G+X]]++]=X);if(A=D===0?(lt=ot=R,19):D===1?(lt=v,at-=257,ot=w,dt-=257,256):(lt=S,ot=N,-1),H=et,k=q,z=X=mt=0,E=-1,x=(it=1<<($=tt))-1,D===1&&852<it||D===2&&592<it)return 1;for(;;){for(C=H-z,B=R[X]<A?(j=0,R[X]):R[X]>A?(j=ot[dt+R[X]],lt[at+R[X]]):(j=96,0),T=1<<H-z,et=L=1<<$;U[k+(mt>>z)+(L-=T)]=C<<24|j<<16|B|0,L!==0;);for(T=1<<H-1;mt&T;)T>>=1;if(T!==0?(mt&=T-1,mt+=T):mt=0,X++,--rt[H]==0){if(H===V)break;H=F[G+R[X]]}if(tt<H&&(mt&x)!==E){for(z===0&&(z=tt),k+=et,Z=1<<($=H-z);$+z<V&&!((Z-=rt[$+z])<=0);)$++,Z<<=1;if(it+=1<<$,D===1&&852<it||D===2&&592<it)return 1;U[E=mt&x]=tt<<24|$<<16|k-q|0}}return mt!==0&&(U[k+mt]=H-z<<24|64<<16|0),I.bits=tt,0}},{"../utils/common":41}],51:[function(f,g,y){g.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(f,g,y){var b=f("../utils/common");function v(ot){for(var dt=ot.length;0<=--dt;)ot[dt]=0}var w=256,S=286,N=30,D=15,F=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],G=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(576);v(q);var R=new Array(60);v(R);var I=new Array(512);v(I);var T=new Array(256);v(T);var L=new Array(29);v(L);var E,x,k,A=new Array(N);function C(ot,dt,ft,gt,wt){this.static_tree=ot,this.extra_bits=dt,this.extra_base=ft,this.elems=gt,this.max_length=wt,this.has_stree=ot&&ot.length}function j(ot,dt){this.dyn_tree=ot,this.max_code=0,this.stat_desc=dt}function B(ot){return ot<256?I[ot]:I[256+(ot>>>7)]}function O(ot,dt){ot.pending_buf[ot.pending++]=255&dt,ot.pending_buf[ot.pending++]=dt>>>8&255}function H(ot,dt,ft){ot.bi_valid>16-ft?(ot.bi_buf|=dt<<ot.bi_valid&65535,O(ot,ot.bi_buf),ot.bi_buf=dt>>16-ot.bi_valid,ot.bi_valid+=ft-16):(ot.bi_buf|=dt<<ot.bi_valid&65535,ot.bi_valid+=ft)}function X(ot,dt,ft){H(ot,ft[2*dt],ft[2*dt+1])}function et(ot,dt){for(var ft=0;ft|=1&ot,ot>>>=1,ft<<=1,0<--dt;);return ft>>>1}function V(ot,dt,ft){var gt,wt,yt=new Array(16),Et=0;for(gt=1;gt<=D;gt++)yt[gt]=Et=Et+ft[gt-1]<<1;for(wt=0;wt<=dt;wt++){var Mt=ot[2*wt+1];Mt!==0&&(ot[2*wt]=et(yt[Mt]++,Mt))}}function tt(ot){var dt;for(dt=0;dt<S;dt++)ot.dyn_ltree[2*dt]=0;for(dt=0;dt<N;dt++)ot.dyn_dtree[2*dt]=0;for(dt=0;dt<19;dt++)ot.bl_tree[2*dt]=0;ot.dyn_ltree[512]=1,ot.opt_len=ot.static_len=0,ot.last_lit=ot.matches=0}function $(ot){8<ot.bi_valid?O(ot,ot.bi_buf):0<ot.bi_valid&&(ot.pending_buf[ot.pending++]=ot.bi_buf),ot.bi_buf=0,ot.bi_valid=0}function z(ot,dt,ft,gt){var wt=2*dt,yt=2*ft;return ot[wt]<ot[yt]||ot[wt]===ot[yt]&&gt[dt]<=gt[ft]}function Z(ot,dt,ft){for(var gt=ot.heap[ft],wt=ft<<1;wt<=ot.heap_len&&(wt<ot.heap_len&&z(dt,ot.heap[wt+1],ot.heap[wt],ot.depth)&&wt++,!z(dt,gt,ot.heap[wt],ot.depth));)ot.heap[ft]=ot.heap[wt],ft=wt,wt<<=1;ot.heap[ft]=gt}function it(ot,dt,ft){var gt,wt,yt,Et,Mt=0;if(ot.last_lit!==0)for(;gt=ot.pending_buf[ot.d_buf+2*Mt]<<8|ot.pending_buf[ot.d_buf+2*Mt+1],wt=ot.pending_buf[ot.l_buf+Mt],Mt++,gt===0?X(ot,wt,dt):(X(ot,(yt=T[wt])+w+1,dt),(Et=F[yt])!==0&&H(ot,wt-=L[yt],Et),X(ot,yt=B(--gt),ft),(Et=G[yt])!==0&&H(ot,gt-=A[yt],Et)),Mt<ot.last_lit;);X(ot,256,dt)}function mt(ot,dt){var ft,gt,wt,yt=dt.dyn_tree,Et=dt.stat_desc.static_tree,Mt=dt.stat_desc.has_stree,qt=dt.stat_desc.elems,Tt=-1;for(ot.heap_len=0,ot.heap_max=573,ft=0;ft<qt;ft++)yt[2*ft]!==0?(ot.heap[++ot.heap_len]=Tt=ft,ot.depth[ft]=0):yt[2*ft+1]=0;for(;ot.heap_len<2;)yt[2*(wt=ot.heap[++ot.heap_len]=Tt<2?++Tt:0)]=1,ot.depth[wt]=0,ot.opt_len--,Mt&&(ot.static_len-=Et[2*wt+1]);for(dt.max_code=Tt,ft=ot.heap_len>>1;1<=ft;ft--)Z(ot,yt,ft);for(wt=qt;ft=ot.heap[1],ot.heap[1]=ot.heap[ot.heap_len--],Z(ot,yt,1),gt=ot.heap[1],ot.heap[--ot.heap_max]=ft,ot.heap[--ot.heap_max]=gt,yt[2*wt]=yt[2*ft]+yt[2*gt],ot.depth[wt]=(ot.depth[ft]>=ot.depth[gt]?ot.depth[ft]:ot.depth[gt])+1,yt[2*ft+1]=yt[2*gt+1]=wt,ot.heap[1]=wt++,Z(ot,yt,1),2<=ot.heap_len;);ot.heap[--ot.heap_max]=ot.heap[1],(function(It,Vt){var Kt,ne,ae,Oe,le,Jt,ue=Vt.dyn_tree,ge=Vt.max_code,fe=Vt.stat_desc.static_tree,qe=Vt.stat_desc.has_stree,Be=Vt.stat_desc.extra_bits,ke=Vt.stat_desc.extra_base,Je=Vt.stat_desc.max_length,Fe=0;for(Oe=0;Oe<=D;Oe++)It.bl_count[Oe]=0;for(ue[2*It.heap[It.heap_max]+1]=0,Kt=It.heap_max+1;Kt<573;Kt++)Je<(Oe=ue[2*ue[2*(ne=It.heap[Kt])+1]+1]+1)&&(Oe=Je,Fe++),ue[2*ne+1]=Oe,ge<ne||(It.bl_count[Oe]++,le=0,ke<=ne&&(le=Be[ne-ke]),Jt=ue[2*ne],It.opt_len+=Jt*(Oe+le),qe&&(It.static_len+=Jt*(fe[2*ne+1]+le)));if(Fe!==0){do{for(Oe=Je-1;It.bl_count[Oe]===0;)Oe--;It.bl_count[Oe]--,It.bl_count[Oe+1]+=2,It.bl_count[Je]--,Fe-=2}while(0<Fe);for(Oe=Je;Oe!==0;Oe--)for(ne=It.bl_count[Oe];ne!==0;)ge<(ae=It.heap[--Kt])||(ue[2*ae+1]!==Oe&&(It.opt_len+=(Oe-ue[2*ae+1])*ue[2*ae],ue[2*ae+1]=Oe),ne--)}})(ot,dt),V(yt,Tt,ot.bl_count)}function lt(ot,dt,ft){var gt,wt,yt=-1,Et=dt[1],Mt=0,qt=7,Tt=4;for(Et===0&&(qt=138,Tt=3),dt[2*(ft+1)+1]=65535,gt=0;gt<=ft;gt++)wt=Et,Et=dt[2*(gt+1)+1],++Mt<qt&&wt===Et||(Mt<Tt?ot.bl_tree[2*wt]+=Mt:wt!==0?(wt!==yt&&ot.bl_tree[2*wt]++,ot.bl_tree[32]++):Mt<=10?ot.bl_tree[34]++:ot.bl_tree[36]++,yt=wt,Tt=(Mt=0)===Et?(qt=138,3):wt===Et?(qt=6,3):(qt=7,4))}function at(ot,dt,ft){var gt,wt,yt=-1,Et=dt[1],Mt=0,qt=7,Tt=4;for(Et===0&&(qt=138,Tt=3),gt=0;gt<=ft;gt++)if(wt=Et,Et=dt[2*(gt+1)+1],!(++Mt<qt&&wt===Et)){if(Mt<Tt)for(;X(ot,wt,ot.bl_tree),--Mt!=0;);else wt!==0?(wt!==yt&&(X(ot,wt,ot.bl_tree),Mt--),X(ot,16,ot.bl_tree),H(ot,Mt-3,2)):Mt<=10?(X(ot,17,ot.bl_tree),H(ot,Mt-3,3)):(X(ot,18,ot.bl_tree),H(ot,Mt-11,7));yt=wt,Tt=(Mt=0)===Et?(qt=138,3):wt===Et?(qt=6,3):(qt=7,4)}}v(A);var rt=!1;function ct(ot,dt,ft,gt){H(ot,0+(gt?1:0),3),(function(wt,yt,Et,Mt){$(wt),O(wt,Et),O(wt,~Et),b.arraySet(wt.pending_buf,wt.window,yt,Et,wt.pending),wt.pending+=Et})(ot,dt,ft)}y._tr_init=function(ot){rt||((function(){var dt,ft,gt,wt,yt,Et=new Array(16);for(wt=gt=0;wt<28;wt++)for(L[wt]=gt,dt=0;dt<1<<F[wt];dt++)T[gt++]=wt;for(T[gt-1]=wt,wt=yt=0;wt<16;wt++)for(A[wt]=yt,dt=0;dt<1<<G[wt];dt++)I[yt++]=wt;for(yt>>=7;wt<N;wt++)for(A[wt]=yt<<7,dt=0;dt<1<<G[wt]-7;dt++)I[256+yt++]=wt;for(ft=0;ft<=D;ft++)Et[ft]=0;for(dt=0;dt<=143;)q[2*dt+1]=8,dt++,Et[8]++;for(;dt<=255;)q[2*dt+1]=9,dt++,Et[9]++;for(;dt<=279;)q[2*dt+1]=7,dt++,Et[7]++;for(;dt<=287;)q[2*dt+1]=8,dt++,Et[8]++;for(V(q,287,Et),dt=0;dt<N;dt++)R[2*dt+1]=5,R[2*dt]=et(dt,5);E=new C(q,F,257,S,D),x=new C(R,G,0,N,D),k=new C(new Array(0),P,0,19,7)})(),rt=!0),ot.l_desc=new j(ot.dyn_ltree,E),ot.d_desc=new j(ot.dyn_dtree,x),ot.bl_desc=new j(ot.bl_tree,k),ot.bi_buf=0,ot.bi_valid=0,tt(ot)},y._tr_stored_block=ct,y._tr_flush_block=function(ot,dt,ft,gt){var wt,yt,Et=0;0<ot.level?(ot.strm.data_type===2&&(ot.strm.data_type=(function(Mt){var qt,Tt=4093624447;for(qt=0;qt<=31;qt++,Tt>>>=1)if(1&Tt&&Mt.dyn_ltree[2*qt]!==0)return 0;if(Mt.dyn_ltree[18]!==0||Mt.dyn_ltree[20]!==0||Mt.dyn_ltree[26]!==0)return 1;for(qt=32;qt<w;qt++)if(Mt.dyn_ltree[2*qt]!==0)return 1;return 0})(ot)),mt(ot,ot.l_desc),mt(ot,ot.d_desc),Et=(function(Mt){var qt;for(lt(Mt,Mt.dyn_ltree,Mt.l_desc.max_code),lt(Mt,Mt.dyn_dtree,Mt.d_desc.max_code),mt(Mt,Mt.bl_desc),qt=18;3<=qt&&Mt.bl_tree[2*U[qt]+1]===0;qt--);return Mt.opt_len+=3*(qt+1)+5+5+4,qt})(ot),wt=ot.opt_len+3+7>>>3,(yt=ot.static_len+3+7>>>3)<=wt&&(wt=yt)):wt=yt=ft+5,ft+4<=wt&&dt!==-1?ct(ot,dt,ft,gt):ot.strategy===4||yt===wt?(H(ot,2+(gt?1:0),3),it(ot,q,R)):(H(ot,4+(gt?1:0),3),(function(Mt,qt,Tt,It){var Vt;for(H(Mt,qt-257,5),H(Mt,Tt-1,5),H(Mt,It-4,4),Vt=0;Vt<It;Vt++)H(Mt,Mt.bl_tree[2*U[Vt]+1],3);at(Mt,Mt.dyn_ltree,qt-1),at(Mt,Mt.dyn_dtree,Tt-1)})(ot,ot.l_desc.max_code+1,ot.d_desc.max_code+1,Et+1),it(ot,ot.dyn_ltree,ot.dyn_dtree)),tt(ot),gt&&$(ot)},y._tr_tally=function(ot,dt,ft){return ot.pending_buf[ot.d_buf+2*ot.last_lit]=dt>>>8&255,ot.pending_buf[ot.d_buf+2*ot.last_lit+1]=255&dt,ot.pending_buf[ot.l_buf+ot.last_lit]=255&ft,ot.last_lit++,dt===0?ot.dyn_ltree[2*ft]++:(ot.matches++,dt--,ot.dyn_ltree[2*(T[ft]+w+1)]++,ot.dyn_dtree[2*B(dt)]++),ot.last_lit===ot.lit_bufsize-1},y._tr_align=function(ot){H(ot,2,3),X(ot,256,q),(function(dt){dt.bi_valid===16?(O(dt,dt.bi_buf),dt.bi_buf=0,dt.bi_valid=0):8<=dt.bi_valid&&(dt.pending_buf[dt.pending++]=255&dt.bi_buf,dt.bi_buf>>=8,dt.bi_valid-=8)})(ot)}},{"../utils/common":41}],53:[function(f,g,y){g.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(f,g,y){(function(b){(function(v,w){if(!v.setImmediate){var S,N,D,F,G=1,P={},U=!1,q=v.document,R=Object.getPrototypeOf&&Object.getPrototypeOf(v);R=R&&R.setTimeout?R:v,S={}.toString.call(v.process)==="[object process]"?function(E){s.nextTick((function(){T(E)}))}:(function(){if(v.postMessage&&!v.importScripts){var E=!0,x=v.onmessage;return v.onmessage=function(){E=!1},v.postMessage("","*"),v.onmessage=x,E}})()?(F="setImmediate$"+Math.random()+"$",v.addEventListener?v.addEventListener("message",L,!1):v.attachEvent("onmessage",L),function(E){v.postMessage(F+E,"*")}):v.MessageChannel?((D=new MessageChannel).port1.onmessage=function(E){T(E.data)},function(E){D.port2.postMessage(E)}):q&&"onreadystatechange"in q.createElement("script")?(N=q.documentElement,function(E){var x=q.createElement("script");x.onreadystatechange=function(){T(E),x.onreadystatechange=null,N.removeChild(x),x=null},N.appendChild(x)}):function(E){setTimeout(T,0,E)},R.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var x=new Array(arguments.length-1),k=0;k<x.length;k++)x[k]=arguments[k+1];var A={callback:E,args:x};return P[G]=A,S(G),G++},R.clearImmediate=I}function I(E){delete P[E]}function T(E){if(U)setTimeout(T,0,E);else{var x=P[E];if(x){U=!0;try{(function(k){var A=k.callback,C=k.args;switch(C.length){case 0:A();break;case 1:A(C[0]);break;case 2:A(C[0],C[1]);break;case 3:A(C[0],C[1],C[2]);break;default:A.apply(void 0,C)}})(x)}finally{I(E),U=!1}}}}function L(E){E.source===v&&typeof E.data=="string"&&E.data.indexOf(F)===0&&T(+E.data.slice(F.length))}})(typeof self>"u"?b===void 0?this:b:self)}).call(this,a!==void 0?a:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)}))}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],t("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(t,r,o){(function(s){(function(){var a=/[\\^$.*+?()[\]{}|]/g,u=RegExp(a.source),l=typeof s=="object"&&s&&s.Object===Object&&s,i=typeof self=="object"&&self&&self.Object===Object&&self,c=l||i||Function("return this")(),p=Object.prototype.toString,h=c.Symbol,f=h?h.prototype:void 0,g=f?f.toString:void 0;function y(b){if(typeof b=="string")return b;if((function(w){return typeof w=="symbol"||(function(S){return!!S&&typeof S=="object"})(w)&&p.call(w)=="[object Symbol]"})(b))return g?g.call(b):"";var v=b+"";return v=="0"&&1/b==-1/0?"-0":v}r.exports=function(b){var v;return(b=(v=b)==null?"":y(v))&&u.test(b)?b.replace(a,"\\$&"):b}}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(t,r,o){(function(s){(function(){var a="[object Arguments]",u="[object Map]",l="[object Object]",i="[object Set]",c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,p=/^\w*$/,h=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,g=/\\(\\)?/g,y=/^\[object .+?Constructor\]$/,b=/^(?:0|[1-9]\d*)$/,v={};v["[object Float32Array]"]=v["[object Float64Array]"]=v["[object Int8Array]"]=v["[object Int16Array]"]=v["[object Int32Array]"]=v["[object Uint8Array]"]=v["[object Uint8ClampedArray]"]=v["[object Uint16Array]"]=v["[object Uint32Array]"]=!0,v[a]=v["[object Array]"]=v["[object ArrayBuffer]"]=v["[object Boolean]"]=v["[object DataView]"]=v["[object Date]"]=v["[object Error]"]=v["[object Function]"]=v[u]=v["[object Number]"]=v[l]=v["[object RegExp]"]=v[i]=v["[object String]"]=v["[object WeakMap]"]=!1;var w=typeof s=="object"&&s&&s.Object===Object&&s,S=typeof self=="object"&&self&&self.Object===Object&&self,N=w||S||Function("return this")(),D=typeof o=="object"&&o&&!o.nodeType&&o,F=D&&typeof r=="object"&&r&&!r.nodeType&&r,G=F&&F.exports===D&&w.process,P=(function(){try{return G&&G.binding("util")}catch{}})(),U=P&&P.isTypedArray;function q(_t,Bt,Gt,pe){for(var Ne=-1,ye=_t?_t.length:0;++Ne<ye;){var xe=_t[Ne];Bt(pe,xe,Gt(xe),_t)}return pe}function R(_t,Bt){for(var Gt=-1,pe=_t?_t.length:0;++Gt<pe;)if(Bt(_t[Gt],Gt,_t))return!0;return!1}function I(_t){var Bt=!1;if(_t!=null&&typeof _t.toString!="function")try{Bt=!!(_t+"")}catch{}return Bt}function T(_t){var Bt=-1,Gt=Array(_t.size);return _t.forEach((function(pe,Ne){Gt[++Bt]=[Ne,pe]})),Gt}function L(_t){var Bt=-1,Gt=Array(_t.size);return _t.forEach((function(pe){Gt[++Bt]=pe})),Gt}var E,x,k,A=Array.prototype,C=Function.prototype,j=Object.prototype,B=N["__core-js_shared__"],O=(E=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"",H=C.toString,X=j.hasOwnProperty,et=j.toString,V=RegExp("^"+H.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=N.Symbol,$=N.Uint8Array,z=j.propertyIsEnumerable,Z=A.splice,it=(x=Object.keys,k=Object,function(_t){return x(k(_t))}),mt=Xe(N,"DataView"),lt=Xe(N,"Map"),at=Xe(N,"Promise"),rt=Xe(N,"Set"),ct=Xe(N,"WeakMap"),ot=Xe(Object,"create"),dt=Ht(mt),ft=Ht(lt),gt=Ht(at),wt=Ht(rt),yt=Ht(ct),Et=tt?tt.prototype:void 0,Mt=Et?Et.valueOf:void 0,qt=Et?Et.toString:void 0;function Tt(_t){var Bt=-1,Gt=_t?_t.length:0;for(this.clear();++Bt<Gt;){var pe=_t[Bt];this.set(pe[0],pe[1])}}function It(_t){var Bt=-1,Gt=_t?_t.length:0;for(this.clear();++Bt<Gt;){var pe=_t[Bt];this.set(pe[0],pe[1])}}function Vt(_t){var Bt=-1,Gt=_t?_t.length:0;for(this.clear();++Bt<Gt;){var pe=_t[Bt];this.set(pe[0],pe[1])}}function Kt(_t){var Bt=-1,Gt=_t?_t.length:0;for(this.__data__=new Vt;++Bt<Gt;)this.add(_t[Bt])}function ne(_t){this.__data__=new It(_t)}function ae(_t,Bt){var Gt=He(_t)||Ue(_t)?(function(xe,mn){for(var $e=-1,vn=Array(xe);++$e<xe;)vn[$e]=mn($e);return vn})(_t.length,String):[],pe=Gt.length,Ne=!!pe;for(var ye in _t)!X.call(_t,ye)||Ne&&(ye=="length"||Nn(ye,pe))||Gt.push(ye);return Gt}function Oe(_t,Bt){for(var Gt=_t.length;Gt--;)if(Ie(_t[Gt][0],Bt))return Gt;return-1}function le(_t,Bt,Gt,pe){return ue(_t,(function(Ne,ye,xe){Bt(pe,Ne,Gt(Ne),xe)})),pe}Tt.prototype.clear=function(){this.__data__=ot?ot(null):{}},Tt.prototype.delete=function(_t){return this.has(_t)&&delete this.__data__[_t]},Tt.prototype.get=function(_t){var Bt=this.__data__;if(ot){var Gt=Bt[_t];return Gt==="__lodash_hash_undefined__"?void 0:Gt}return X.call(Bt,_t)?Bt[_t]:void 0},Tt.prototype.has=function(_t){var Bt=this.__data__;return ot?Bt[_t]!==void 0:X.call(Bt,_t)},Tt.prototype.set=function(_t,Bt){return this.__data__[_t]=ot&&Bt===void 0?"__lodash_hash_undefined__":Bt,this},It.prototype.clear=function(){this.__data__=[]},It.prototype.delete=function(_t){var Bt=this.__data__,Gt=Oe(Bt,_t);return!(Gt<0)&&(Gt==Bt.length-1?Bt.pop():Z.call(Bt,Gt,1),!0)},It.prototype.get=function(_t){var Bt=this.__data__,Gt=Oe(Bt,_t);return Gt<0?void 0:Bt[Gt][1]},It.prototype.has=function(_t){return Oe(this.__data__,_t)>-1},It.prototype.set=function(_t,Bt){var Gt=this.__data__,pe=Oe(Gt,_t);return pe<0?Gt.push([_t,Bt]):Gt[pe][1]=Bt,this},Vt.prototype.clear=function(){this.__data__={hash:new Tt,map:new(lt||It),string:new Tt}},Vt.prototype.delete=function(_t){return En(this,_t).delete(_t)},Vt.prototype.get=function(_t){return En(this,_t).get(_t)},Vt.prototype.has=function(_t){return En(this,_t).has(_t)},Vt.prototype.set=function(_t,Bt){return En(this,_t).set(_t,Bt),this},Kt.prototype.add=Kt.prototype.push=function(_t){return this.__data__.set(_t,"__lodash_hash_undefined__"),this},Kt.prototype.has=function(_t){return this.__data__.has(_t)},ne.prototype.clear=function(){this.__data__=new It},ne.prototype.delete=function(_t){return this.__data__.delete(_t)},ne.prototype.get=function(_t){return this.__data__.get(_t)},ne.prototype.has=function(_t){return this.__data__.has(_t)},ne.prototype.set=function(_t,Bt){var Gt=this.__data__;if(Gt instanceof It){var pe=Gt.__data__;if(!lt||pe.length<199)return pe.push([_t,Bt]),this;Gt=this.__data__=new Vt(pe)}return Gt.set(_t,Bt),this};var Jt,ue=(Jt=function(_t,Bt){return _t&&ge(_t,Bt,Ee)},function(_t,Bt){if(_t==null)return _t;if(!Ge(_t))return Jt(_t,Bt);for(var Gt=_t.length,pe=-1,Ne=Object(_t);++pe<Gt&&Bt(Ne[pe],pe,Ne)!==!1;);return _t}),ge=(function(_t){return function(Bt,Gt,pe){for(var Ne=-1,ye=Object(Bt),xe=pe(Bt),mn=xe.length;mn--;){var $e=xe[++Ne];if(Gt(ye[$e],$e,ye)===!1)break}return Bt}})();function fe(_t,Bt){for(var Gt=0,pe=(Bt=Te(Bt,_t)?[Bt]:Me(Bt)).length;_t!=null&&Gt<pe;)_t=_t[Dt(Bt[Gt++])];return Gt&&Gt==pe?_t:void 0}function qe(_t,Bt){return _t!=null&&Bt in Object(_t)}function Be(_t,Bt,Gt,pe,Ne){return _t===Bt||(_t==null||Bt==null||!kn(_t)&&!qn(Bt)?_t!=_t&&Bt!=Bt:(function(ye,xe,mn,$e,vn,Ze){var Tn=He(ye),Bn=He(xe),In="[object Array]",Qe="[object Array]";Tn||(In=(In=Sn(ye))==a?l:In),Bn||(Qe=(Qe=Sn(xe))==a?l:Qe);var mr=In==l&&!I(ye),sr=Qe==l&&!I(xe),Dr=In==Qe;if(Dr&&!mr)return Ze||(Ze=new ne),Tn||de(ye)?Ke(ye,xe,mn,$e,vn,Ze):(function(Un,tn,ar,tr,Ur,Kn,Zn){switch(ar){case"[object DataView]":if(Un.byteLength!=tn.byteLength||Un.byteOffset!=tn.byteOffset)return!1;Un=Un.buffer,tn=tn.buffer;case"[object ArrayBuffer]":return!(Un.byteLength!=tn.byteLength||!tr(new $(Un),new $(tn)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ie(+Un,+tn);case"[object Error]":return Un.name==tn.name&&Un.message==tn.message;case"[object RegExp]":case"[object String]":return Un==tn+"";case u:var cr=T;case i:var ri=2&Kn;if(cr||(cr=L),Un.size!=tn.size&&!ri)return!1;var or=Zn.get(Un);if(or)return or==tn;Kn|=1,Zn.set(Un,tn);var Mr=Ke(cr(Un),cr(tn),tr,Ur,Kn,Zn);return Zn.delete(Un),Mr;case"[object Symbol]":if(Mt)return Mt.call(Un)==Mt.call(tn)}return!1})(ye,xe,In,mn,$e,vn,Ze);if(!(2&vn)){var xi=mr&&X.call(ye,"__wrapped__"),ir=sr&&X.call(xe,"__wrapped__");if(xi||ir){var yr=xi?ye.value():ye,ur=ir?xe.value():xe;return Ze||(Ze=new ne),mn(yr,ur,$e,vn,Ze)}}return Dr?(Ze||(Ze=new ne),(function(Un,tn,ar,tr,Ur,Kn){var Zn=2&Ur,cr=Ee(Un),ri=cr.length,or=Ee(tn).length;if(ri!=or&&!Zn)return!1;for(var Mr=ri;Mr--;){var Sr=cr[Mr];if(!(Zn?Sr in tn:X.call(tn,Sr)))return!1}var Hr=Kn.get(Un);if(Hr&&Kn.get(tn))return Hr==tn;var Br=!0;Kn.set(Un,tn),Kn.set(tn,Un);for(var hi=Zn;++Mr<ri;){Sr=cr[Mr];var Lr=Un[Sr],ns=tn[Sr];if(tr)var fs=Zn?tr(ns,Lr,Sr,tn,Un,Kn):tr(Lr,ns,Sr,Un,tn,Kn);if(!(fs===void 0?Lr===ns||ar(Lr,ns,tr,Ur,Kn):fs)){Br=!1;break}hi||(hi=Sr=="constructor")}if(Br&&!hi){var fn=Un.constructor,vs=tn.constructor;fn==vs||!("constructor"in Un)||!("constructor"in tn)||typeof fn=="function"&&fn instanceof fn&&typeof vs=="function"&&vs instanceof vs||(Br=!1)}return Kn.delete(Un),Kn.delete(tn),Br})(ye,xe,mn,$e,vn,Ze)):!1})(_t,Bt,Be,Gt,pe,Ne))}function ke(_t){return!(!kn(_t)||(function(Bt){return!!O&&O in Bt})(_t))&&(Ve(_t)||I(_t)?V:y).test(Ht(_t))}function Je(_t){return typeof _t=="function"?_t:_t==null?Pe:typeof _t=="object"?He(_t)?(function(pe,Ne){return Te(pe)&&_n(Ne)?Pn(Dt(pe),Ne):function(ye){var xe=(function(mn,$e,vn){var Ze=mn==null?void 0:fe(mn,$e);return Ze===void 0?vn:Ze})(ye,pe);return xe===void 0&&xe===Ne?(function(mn,$e){return mn!=null&&(function(vn,Ze,Tn){Ze=Te(Ze,vn)?[Ze]:Me(Ze);for(var Bn,In=-1,Qe=Ze.length;++In<Qe;){var mr=Dt(Ze[In]);if(!(Bn=vn!=null&&Tn(vn,mr)))break;vn=vn[mr]}return Bn||!!(Qe=vn?vn.length:0)&&an(Qe)&&Nn(mr,Qe)&&(He(vn)||Ue(vn))})(mn,$e,qe)})(ye,pe):Be(Ne,xe,void 0,3)}})(_t[0],_t[1]):(function(pe){var Ne=(function(ye){for(var xe=Ee(ye),mn=xe.length;mn--;){var $e=xe[mn],vn=ye[$e];xe[mn]=[$e,vn,_n(vn)]}return xe})(pe);return Ne.length==1&&Ne[0][2]?Pn(Ne[0][0],Ne[0][1]):function(ye){return ye===pe||(function(xe,mn,$e,vn){var Ze=$e.length,Tn=Ze;if(xe==null)return!Tn;for(xe=Object(xe);Ze--;){var Bn=$e[Ze];if(Bn[2]?Bn[1]!==xe[Bn[0]]:!(Bn[0]in xe))return!1}for(;++Ze<Tn;){var In=(Bn=$e[Ze])[0],Qe=xe[In],mr=Bn[1];if(Bn[2]){if(Qe===void 0&&!(In in xe))return!1}else{var sr=new ne,Dr;if(!(Dr===void 0?Be(mr,Qe,vn,3,sr):Dr))return!1}}return!0})(ye,pe,Ne)}})(_t):Te(Bt=_t)?(Gt=Dt(Bt),function(pe){return pe?.[Gt]}):(function(pe){return function(Ne){return fe(Ne,pe)}})(Bt);var Bt,Gt}function Fe(_t){if(Gt=(Bt=_t)&&Bt.constructor,pe=typeof Gt=="function"&&Gt.prototype||j,Bt!==pe)return it(_t);var Bt,Gt,pe,Ne=[];for(var ye in Object(_t))X.call(_t,ye)&&ye!="constructor"&&Ne.push(ye);return Ne}function Me(_t){return He(_t)?_t:on(_t)}function Ke(_t,Bt,Gt,pe,Ne,ye){var xe=2&Ne,mn=_t.length,$e=Bt.length;if(mn!=$e&&!(xe&&$e>mn))return!1;var vn=ye.get(_t);if(vn&&ye.get(Bt))return vn==Bt;var Ze=-1,Tn=!0,Bn=1&Ne?new Kt:void 0;for(ye.set(_t,Bt),ye.set(Bt,_t);++Ze<mn;){var In=_t[Ze],Qe=Bt[Ze];if(pe)var mr=xe?pe(Qe,In,Ze,Bt,_t,ye):pe(In,Qe,Ze,_t,Bt,ye);if(mr!==void 0){if(mr)continue;Tn=!1;break}if(Bn){if(!R(Bt,(function(sr,Dr){if(!Bn.has(Dr)&&(In===sr||Gt(In,sr,pe,Ne,ye)))return Bn.add(Dr)}))){Tn=!1;break}}else if(In!==Qe&&!Gt(In,Qe,pe,Ne,ye)){Tn=!1;break}}return ye.delete(_t),ye.delete(Bt),Tn}function En(_t,Bt){var Gt,pe,Ne=_t.__data__;return((pe=typeof(Gt=Bt))=="string"||pe=="number"||pe=="symbol"||pe=="boolean"?Gt!=="__proto__":Gt===null)?Ne[typeof Bt=="string"?"string":"hash"]:Ne.map}function Xe(_t,Bt){var Gt=(function(pe,Ne){return pe?.[Ne]})(_t,Bt);return ke(Gt)?Gt:void 0}var Sn=function(_t){return et.call(_t)};function Nn(_t,Bt){return!!(Bt=Bt??9007199254740991)&&(typeof _t=="number"||b.test(_t))&&_t>-1&&_t%1==0&&_t<Bt}function Te(_t,Bt){if(He(_t))return!1;var Gt=typeof _t;return!(Gt!="number"&&Gt!="symbol"&&Gt!="boolean"&&_t!=null&&!Qt(_t))||p.test(_t)||!c.test(_t)||Bt!=null&&_t in Object(Bt)}function _n(_t){return _t==_t&&!kn(_t)}function Pn(_t,Bt){return function(Gt){return Gt!=null&&Gt[_t]===Bt&&(Bt!==void 0||_t in Object(Gt))}}(mt&&Sn(new mt(new ArrayBuffer(1)))!="[object DataView]"||lt&&Sn(new lt)!=u||at&&Sn(at.resolve())!="[object Promise]"||rt&&Sn(new rt)!=i||ct&&Sn(new ct)!="[object WeakMap]")&&(Sn=function(_t){var Bt=et.call(_t),Gt=Bt==l?_t.constructor:void 0,pe=Gt?Ht(Gt):void 0;if(pe)switch(pe){case dt:return"[object DataView]";case ft:return u;case gt:return"[object Promise]";case wt:return i;case yt:return"[object WeakMap]"}return Bt});var on=nn((function(_t){var Bt;_t=(Bt=_t)==null?"":(function(pe){if(typeof pe=="string")return pe;if(Qt(pe))return qt?qt.call(pe):"";var Ne=pe+"";return Ne=="0"&&1/pe==-1/0?"-0":Ne})(Bt);var Gt=[];return h.test(_t)&&Gt.push(""),_t.replace(f,(function(pe,Ne,ye,xe){Gt.push(ye?xe.replace(g,"$1"):Ne||pe)})),Gt}));function Dt(_t){if(typeof _t=="string"||Qt(_t))return _t;var Bt=_t+"";return Bt=="0"&&1/_t==-1/0?"-0":Bt}function Ht(_t){if(_t!=null){try{return H.call(_t)}catch{}try{return _t+""}catch{}}return""}var re,we=(re=function(_t,Bt,Gt){X.call(_t,Gt)?_t[Gt].push(Bt):_t[Gt]=[Bt]},function(_t,Bt){var Gt=He(_t)?q:le,pe={};return Gt(_t,re,Je(Bt),pe)});function nn(_t,Bt){if(typeof _t!="function"||Bt&&typeof Bt!="function")throw new TypeError("Expected a function");var Gt=function(){var pe=arguments,Ne=Bt?Bt.apply(this,pe):pe[0],ye=Gt.cache;if(ye.has(Ne))return ye.get(Ne);var xe=_t.apply(this,pe);return Gt.cache=ye.set(Ne,xe),xe};return Gt.cache=new(nn.Cache||Vt),Gt}function Ie(_t,Bt){return _t===Bt||_t!=_t&&Bt!=Bt}function Ue(_t){return(function(Bt){return qn(Bt)&&Ge(Bt)})(_t)&&X.call(_t,"callee")&&(!z.call(_t,"callee")||et.call(_t)==a)}nn.Cache=Vt;var He=Array.isArray;function Ge(_t){return _t!=null&&an(_t.length)&&!Ve(_t)}function Ve(_t){var Bt=kn(_t)?et.call(_t):"";return Bt=="[object Function]"||Bt=="[object GeneratorFunction]"}function an(_t){return typeof _t=="number"&&_t>-1&&_t%1==0&&_t<=9007199254740991}function kn(_t){var Bt=typeof _t;return!!_t&&(Bt=="object"||Bt=="function")}function qn(_t){return!!_t&&typeof _t=="object"}function Qt(_t){return typeof _t=="symbol"||qn(_t)&&et.call(_t)=="[object Symbol]"}var de=U?(function(_t){return function(Bt){return _t(Bt)}})(U):function(_t){return qn(_t)&&an(_t.length)&&!!v[et.call(_t)]};function Ee(_t){return Ge(_t)?ae(_t):Fe(_t)}function Pe(_t){return _t}r.exports=we}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(t,r,o){var s=Object.prototype.toString;r.exports=function(a){return a===!0||a===!1||(function(u){return!!u&&typeof u=="object"})(a)&&s.call(a)=="[object Boolean]"}},{}],445:[function(t,r,o){(function(s){(function(){var a="[object Arguments]",u="[object Map]",l="[object Object]",i="[object Set]",c=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h[a]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h["[object Function]"]=h[u]=h["[object Number]"]=h[l]=h["[object RegExp]"]=h[i]=h["[object String]"]=h["[object WeakMap]"]=!1;var f=typeof s=="object"&&s&&s.Object===Object&&s,g=typeof self=="object"&&self&&self.Object===Object&&self,y=f||g||Function("return this")(),b=typeof o=="object"&&o&&!o.nodeType&&o,v=b&&typeof r=="object"&&r&&!r.nodeType&&r,w=v&&v.exports===b,S=w&&f.process,N=(function(){try{return S&&S.binding&&S.binding("util")}catch{}})(),D=N&&N.isTypedArray;function F(Dt,Ht){for(var re=-1,we=Dt==null?0:Dt.length;++re<we;)if(Ht(Dt[re],re,Dt))return!0;return!1}function G(Dt){var Ht=-1,re=Array(Dt.size);return Dt.forEach((function(we,nn){re[++Ht]=[nn,we]})),re}function P(Dt){var Ht=-1,re=Array(Dt.size);return Dt.forEach((function(we){re[++Ht]=we})),re}var U,q,R,I=Array.prototype,T=Function.prototype,L=Object.prototype,E=y["__core-js_shared__"],x=T.toString,k=L.hasOwnProperty,A=(U=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"",C=L.toString,j=RegExp("^"+x.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),B=w?y.Buffer:void 0,O=y.Symbol,H=y.Uint8Array,X=L.propertyIsEnumerable,et=I.splice,V=O?O.toStringTag:void 0,tt=Object.getOwnPropertySymbols,$=B?B.isBuffer:void 0,z=(q=Object.keys,R=Object,function(Dt){return q(R(Dt))}),Z=qe(y,"DataView"),it=qe(y,"Map"),mt=qe(y,"Promise"),lt=qe(y,"Set"),at=qe(y,"WeakMap"),rt=qe(Object,"create"),ct=Fe(Z),ot=Fe(it),dt=Fe(mt),ft=Fe(lt),gt=Fe(at),wt=O?O.prototype:void 0,yt=wt?wt.valueOf:void 0;function Et(Dt){var Ht=-1,re=Dt==null?0:Dt.length;for(this.clear();++Ht<re;){var we=Dt[Ht];this.set(we[0],we[1])}}function Mt(Dt){var Ht=-1,re=Dt==null?0:Dt.length;for(this.clear();++Ht<re;){var we=Dt[Ht];this.set(we[0],we[1])}}function qt(Dt){var Ht=-1,re=Dt==null?0:Dt.length;for(this.clear();++Ht<re;){var we=Dt[Ht];this.set(we[0],we[1])}}function Tt(Dt){var Ht=-1,re=Dt==null?0:Dt.length;for(this.__data__=new qt;++Ht<re;)this.add(Dt[Ht])}function It(Dt){var Ht=this.__data__=new Mt(Dt);this.size=Ht.size}function Vt(Dt,Ht){var re=En(Dt),we=!re&&Ke(Dt),nn=!re&&!we&&Xe(Dt),Ie=!re&&!we&&!nn&&Pn(Dt),Ue=re||we||nn||Ie,He=Ue?(function(an,kn){for(var qn=-1,Qt=Array(an);++qn<an;)Qt[qn]=kn(qn);return Qt})(Dt.length,String):[],Ge=He.length;for(var Ve in Dt)!k.call(Dt,Ve)||Ue&&(Ve=="length"||nn&&(Ve=="offset"||Ve=="parent")||Ie&&(Ve=="buffer"||Ve=="byteLength"||Ve=="byteOffset")||Je(Ve,Ge))||He.push(Ve);return He}function Kt(Dt,Ht){for(var re=Dt.length;re--;)if(Me(Dt[re][0],Ht))return re;return-1}function ne(Dt){return Dt==null?Dt===void 0?"[object Undefined]":"[object Null]":V&&V in Object(Dt)?(function(Ht){var re=k.call(Ht,V),we=Ht[V];try{Ht[V]=void 0;var nn=!0}catch{}var Ie=C.call(Ht);return nn&&(re?Ht[V]=we:delete Ht[V]),Ie})(Dt):(function(Ht){return C.call(Ht)})(Dt)}function ae(Dt){return _n(Dt)&&ne(Dt)==a}function Oe(Dt,Ht,re,we,nn){return Dt===Ht||(Dt==null||Ht==null||!_n(Dt)&&!_n(Ht)?Dt!=Dt&&Ht!=Ht:(function(Ie,Ue,He,Ge,Ve,an){var kn=En(Ie),qn=En(Ue),Qt=kn?"[object Array]":ke(Ie),de=qn?"[object Array]":ke(Ue),Ee=(Qt=Qt==a?l:Qt)==l,Pe=(de=de==a?l:de)==l,_t=Qt==de;if(_t&&Xe(Ie)){if(!Xe(Ue))return!1;kn=!0,Ee=!1}if(_t&&!Ee)return an||(an=new It),kn||Pn(Ie)?ue(Ie,Ue,He,Ge,Ve,an):(function(ye,xe,mn,$e,vn,Ze,Tn){switch(mn){case"[object DataView]":if(ye.byteLength!=xe.byteLength||ye.byteOffset!=xe.byteOffset)return!1;ye=ye.buffer,xe=xe.buffer;case"[object ArrayBuffer]":return!(ye.byteLength!=xe.byteLength||!Ze(new H(ye),new H(xe)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Me(+ye,+xe);case"[object Error]":return ye.name==xe.name&&ye.message==xe.message;case"[object RegExp]":case"[object String]":return ye==xe+"";case u:var Bn=G;case i:var In=1&$e;if(Bn||(Bn=P),ye.size!=xe.size&&!In)return!1;var Qe=Tn.get(ye);if(Qe)return Qe==xe;$e|=2,Tn.set(ye,xe);var mr=ue(Bn(ye),Bn(xe),$e,vn,Ze,Tn);return Tn.delete(ye),mr;case"[object Symbol]":if(yt)return yt.call(ye)==yt.call(xe)}return!1})(Ie,Ue,Qt,He,Ge,Ve,an);if(!(1&He)){var Bt=Ee&&k.call(Ie,"__wrapped__"),Gt=Pe&&k.call(Ue,"__wrapped__");if(Bt||Gt){var pe=Bt?Ie.value():Ie,Ne=Gt?Ue.value():Ue;return an||(an=new It),Ve(pe,Ne,He,Ge,an)}}return _t?(an||(an=new It),(function(ye,xe,mn,$e,vn,Ze){var Tn=1&mn,Bn=ge(ye),In=Bn.length,Qe=ge(xe).length;if(In!=Qe&&!Tn)return!1;for(var mr=In;mr--;){var sr=Bn[mr];if(!(Tn?sr in xe:k.call(xe,sr)))return!1}var Dr=Ze.get(ye);if(Dr&&Ze.get(xe))return Dr==xe;var xi=!0;Ze.set(ye,xe),Ze.set(xe,ye);for(var ir=Tn;++mr<In;){sr=Bn[mr];var yr=ye[sr],ur=xe[sr];if($e)var Un=Tn?$e(ur,yr,sr,xe,ye,Ze):$e(yr,ur,sr,ye,xe,Ze);if(!(Un===void 0?yr===ur||vn(yr,ur,mn,$e,Ze):Un)){xi=!1;break}ir||(ir=sr=="constructor")}if(xi&&!ir){var tn=ye.constructor,ar=xe.constructor;tn==ar||!("constructor"in ye)||!("constructor"in xe)||typeof tn=="function"&&tn instanceof tn&&typeof ar=="function"&&ar instanceof ar||(xi=!1)}return Ze.delete(ye),Ze.delete(xe),xi})(Ie,Ue,He,Ge,Ve,an)):!1})(Dt,Ht,re,we,Oe,nn))}function le(Dt){return!(!Te(Dt)||(function(Ht){return!!A&&A in Ht})(Dt))&&(Sn(Dt)?j:c).test(Fe(Dt))}function Jt(Dt){if(re=(Ht=Dt)&&Ht.constructor,we=typeof re=="function"&&re.prototype||L,Ht!==we)return z(Dt);var Ht,re,we,nn=[];for(var Ie in Object(Dt))k.call(Dt,Ie)&&Ie!="constructor"&&nn.push(Ie);return nn}function ue(Dt,Ht,re,we,nn,Ie){var Ue=1&re,He=Dt.length,Ge=Ht.length;if(He!=Ge&&!(Ue&&Ge>He))return!1;var Ve=Ie.get(Dt);if(Ve&&Ie.get(Ht))return Ve==Ht;var an=-1,kn=!0,qn=2&re?new Tt:void 0;for(Ie.set(Dt,Ht),Ie.set(Ht,Dt);++an<He;){var Qt=Dt[an],de=Ht[an];if(we)var Ee=Ue?we(de,Qt,an,Ht,Dt,Ie):we(Qt,de,an,Dt,Ht,Ie);if(Ee!==void 0){if(Ee)continue;kn=!1;break}if(qn){if(!F(Ht,(function(Pe,_t){if(Bt=_t,!qn.has(Bt)&&(Qt===Pe||nn(Qt,Pe,re,we,Ie)))return qn.push(_t);var Bt}))){kn=!1;break}}else if(Qt!==de&&!nn(Qt,de,re,we,Ie)){kn=!1;break}}return Ie.delete(Dt),Ie.delete(Ht),kn}function ge(Dt){return(function(Ht,re,we){var nn=re(Ht);return En(Ht)?nn:(function(Ie,Ue){for(var He=-1,Ge=Ue.length,Ve=Ie.length;++He<Ge;)Ie[Ve+He]=Ue[He];return Ie})(nn,we(Ht))})(Dt,on,Be)}function fe(Dt,Ht){var re,we,nn=Dt.__data__;return((we=typeof(re=Ht))=="string"||we=="number"||we=="symbol"||we=="boolean"?re!=="__proto__":re===null)?nn[typeof Ht=="string"?"string":"hash"]:nn.map}function qe(Dt,Ht){var re=(function(we,nn){return we?.[nn]})(Dt,Ht);return le(re)?re:void 0}Et.prototype.clear=function(){this.__data__=rt?rt(null):{},this.size=0},Et.prototype.delete=function(Dt){var Ht=this.has(Dt)&&delete this.__data__[Dt];return this.size-=Ht?1:0,Ht},Et.prototype.get=function(Dt){var Ht=this.__data__;if(rt){var re=Ht[Dt];return re==="__lodash_hash_undefined__"?void 0:re}return k.call(Ht,Dt)?Ht[Dt]:void 0},Et.prototype.has=function(Dt){var Ht=this.__data__;return rt?Ht[Dt]!==void 0:k.call(Ht,Dt)},Et.prototype.set=function(Dt,Ht){var re=this.__data__;return this.size+=this.has(Dt)?0:1,re[Dt]=rt&&Ht===void 0?"__lodash_hash_undefined__":Ht,this},Mt.prototype.clear=function(){this.__data__=[],this.size=0},Mt.prototype.delete=function(Dt){var Ht=this.__data__,re=Kt(Ht,Dt);return!(re<0)&&(re==Ht.length-1?Ht.pop():et.call(Ht,re,1),--this.size,!0)},Mt.prototype.get=function(Dt){var Ht=this.__data__,re=Kt(Ht,Dt);return re<0?void 0:Ht[re][1]},Mt.prototype.has=function(Dt){return Kt(this.__data__,Dt)>-1},Mt.prototype.set=function(Dt,Ht){var re=this.__data__,we=Kt(re,Dt);return we<0?(++this.size,re.push([Dt,Ht])):re[we][1]=Ht,this},qt.prototype.clear=function(){this.size=0,this.__data__={hash:new Et,map:new(it||Mt),string:new Et}},qt.prototype.delete=function(Dt){var Ht=fe(this,Dt).delete(Dt);return this.size-=Ht?1:0,Ht},qt.prototype.get=function(Dt){return fe(this,Dt).get(Dt)},qt.prototype.has=function(Dt){return fe(this,Dt).has(Dt)},qt.prototype.set=function(Dt,Ht){var re=fe(this,Dt),we=re.size;return re.set(Dt,Ht),this.size+=re.size==we?0:1,this},Tt.prototype.add=Tt.prototype.push=function(Dt){return this.__data__.set(Dt,"__lodash_hash_undefined__"),this},Tt.prototype.has=function(Dt){return this.__data__.has(Dt)},It.prototype.clear=function(){this.__data__=new Mt,this.size=0},It.prototype.delete=function(Dt){var Ht=this.__data__,re=Ht.delete(Dt);return this.size=Ht.size,re},It.prototype.get=function(Dt){return this.__data__.get(Dt)},It.prototype.has=function(Dt){return this.__data__.has(Dt)},It.prototype.set=function(Dt,Ht){var re=this.__data__;if(re instanceof Mt){var we=re.__data__;if(!it||we.length<199)return we.push([Dt,Ht]),this.size=++re.size,this;re=this.__data__=new qt(we)}return re.set(Dt,Ht),this.size=re.size,this};var Be=tt?function(Dt){return Dt==null?[]:(Dt=Object(Dt),(function(Ht,re){for(var we=-1,nn=Ht==null?0:Ht.length,Ie=0,Ue=[];++we<nn;){var He=Ht[we];re(He,we,Ht)&&(Ue[Ie++]=He)}return Ue})(tt(Dt),(function(Ht){return X.call(Dt,Ht)})))}:function(){return[]},ke=ne;function Je(Dt,Ht){return!!(Ht=Ht??9007199254740991)&&(typeof Dt=="number"||p.test(Dt))&&Dt>-1&&Dt%1==0&&Dt<Ht}function Fe(Dt){if(Dt!=null){try{return x.call(Dt)}catch{}try{return Dt+""}catch{}}return""}function Me(Dt,Ht){return Dt===Ht||Dt!=Dt&&Ht!=Ht}(Z&&ke(new Z(new ArrayBuffer(1)))!="[object DataView]"||it&&ke(new it)!=u||mt&&ke(mt.resolve())!="[object Promise]"||lt&&ke(new lt)!=i||at&&ke(new at)!="[object WeakMap]")&&(ke=function(Dt){var Ht=ne(Dt),re=Ht==l?Dt.constructor:void 0,we=re?Fe(re):"";if(we)switch(we){case ct:return"[object DataView]";case ot:return u;case dt:return"[object Promise]";case ft:return i;case gt:return"[object WeakMap]"}return Ht});var Ke=ae((function(){return arguments})())?ae:function(Dt){return _n(Dt)&&k.call(Dt,"callee")&&!X.call(Dt,"callee")},En=Array.isArray,Xe=$||function(){return!1};function Sn(Dt){if(!Te(Dt))return!1;var Ht=ne(Dt);return Ht=="[object Function]"||Ht=="[object GeneratorFunction]"||Ht=="[object AsyncFunction]"||Ht=="[object Proxy]"}function Nn(Dt){return typeof Dt=="number"&&Dt>-1&&Dt%1==0&&Dt<=9007199254740991}function Te(Dt){var Ht=typeof Dt;return Dt!=null&&(Ht=="object"||Ht=="function")}function _n(Dt){return Dt!=null&&typeof Dt=="object"}var Pn=D?(function(Dt){return function(Ht){return Dt(Ht)}})(D):function(Dt){return _n(Dt)&&Nn(Dt.length)&&!!h[ne(Dt)]};function on(Dt){return(Ht=Dt)!=null&&Nn(Ht.length)&&!Sn(Ht)?Vt(Dt):Jt(Dt);var Ht}r.exports=function(Dt,Ht){return Oe(Dt,Ht)}}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(t,r,o){(function(s){(function(){var a=typeof s=="object"&&s&&s.Object===Object&&s,u=typeof self=="object"&&self&&self.Object===Object&&self,l=a||u||Function("return this")(),i=Object.prototype,c=i.hasOwnProperty,p=i.toString,h=l.Symbol,f=h?h.toStringTag:void 0;function g(y){return y==null?y===void 0?"[object Undefined]":"[object Null]":f&&f in Object(y)?(function(b){var v=c.call(b,f),w=b[f];try{b[f]=void 0;var S=!0}catch{}var N=p.call(b);return S&&(v?b[f]=w:delete b[f]),N})(y):(function(b){return p.call(b)})(y)}r.exports=function(y){if(!(function(v){var w=typeof v;return v!=null&&(w=="object"||w=="function")})(y))return!1;var b=g(y);return b=="[object Function]"||b=="[object GeneratorFunction]"||b=="[object AsyncFunction]"||b=="[object Proxy]"}}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(t,r,o){r.exports=function(s){return s==null}},{}],448:[function(t,r,o){r.exports=function(s){return s===void 0}},{}],449:[function(t,r,o){(function(s){(function(){var a=/^\[object .+?Constructor\]$/,u=typeof s=="object"&&s&&s.Object===Object&&s,l=typeof self=="object"&&self&&self.Object===Object&&self,i=u||l||Function("return this")();function c(O,H){return!!(O&&O.length)&&(function(X,et,V){if(et!=et)return(function(z,Z,it,mt){for(var lt=z.length,at=it+-1;++at<lt;)if(Z(z[at],at,z))return at;return-1})(X,p,V);for(var tt=V-1,$=X.length;++tt<$;)if(X[tt]===et)return tt;return-1})(O,H,0)>-1}function p(O){return O!=O}function h(O,H){return O.has(H)}function f(O){var H=-1,X=Array(O.size);return O.forEach((function(et){X[++H]=et})),X}var g,y=Array.prototype,b=Function.prototype,v=Object.prototype,w=i["__core-js_shared__"],S=(g=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",N=b.toString,D=v.hasOwnProperty,F=v.toString,G=RegExp("^"+N.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=y.splice,U=j(i,"Map"),q=j(i,"Set"),R=j(Object,"create");function I(O){var H=-1,X=O?O.length:0;for(this.clear();++H<X;){var et=O[H];this.set(et[0],et[1])}}function T(O){var H=-1,X=O?O.length:0;for(this.clear();++H<X;){var et=O[H];this.set(et[0],et[1])}}function L(O){var H=-1,X=O?O.length:0;for(this.clear();++H<X;){var et=O[H];this.set(et[0],et[1])}}function E(O){var H=-1,X=O?O.length:0;for(this.__data__=new L;++H<X;)this.add(O[H])}function x(O,H){for(var X,et,V=O.length;V--;)if((X=O[V][0])===(et=H)||X!=X&&et!=et)return V;return-1}function k(O){return!(!B(O)||(H=O,S&&S in H))&&((function(X){var et=B(X)?F.call(X):"";return et=="[object Function]"||et=="[object GeneratorFunction]"})(O)||(function(X){var et=!1;if(X!=null&&typeof X.toString!="function")try{et=!!(X+"")}catch{}return et})(O)?G:a).test((function(X){if(X!=null){try{return N.call(X)}catch{}try{return X+""}catch{}}return""})(O));var H}I.prototype.clear=function(){this.__data__=R?R(null):{}},I.prototype.delete=function(O){return this.has(O)&&delete this.__data__[O]},I.prototype.get=function(O){var H=this.__data__;if(R){var X=H[O];return X==="__lodash_hash_undefined__"?void 0:X}return D.call(H,O)?H[O]:void 0},I.prototype.has=function(O){var H=this.__data__;return R?H[O]!==void 0:D.call(H,O)},I.prototype.set=function(O,H){return this.__data__[O]=R&&H===void 0?"__lodash_hash_undefined__":H,this},T.prototype.clear=function(){this.__data__=[]},T.prototype.delete=function(O){var H=this.__data__,X=x(H,O);return!(X<0)&&(X==H.length-1?H.pop():P.call(H,X,1),!0)},T.prototype.get=function(O){var H=this.__data__,X=x(H,O);return X<0?void 0:H[X][1]},T.prototype.has=function(O){return x(this.__data__,O)>-1},T.prototype.set=function(O,H){var X=this.__data__,et=x(X,O);return et<0?X.push([O,H]):X[et][1]=H,this},L.prototype.clear=function(){this.__data__={hash:new I,map:new(U||T),string:new I}},L.prototype.delete=function(O){return C(this,O).delete(O)},L.prototype.get=function(O){return C(this,O).get(O)},L.prototype.has=function(O){return C(this,O).has(O)},L.prototype.set=function(O,H){return C(this,O).set(O,H),this},E.prototype.add=E.prototype.push=function(O){return this.__data__.set(O,"__lodash_hash_undefined__"),this},E.prototype.has=function(O){return this.__data__.has(O)};var A=q&&1/f(new q([,-0]))[1]==1/0?function(O){return new q(O)}:function(){};function C(O,H){var X,et,V=O.__data__;return((et=typeof(X=H))=="string"||et=="number"||et=="symbol"||et=="boolean"?X!=="__proto__":X===null)?V[typeof H=="string"?"string":"hash"]:V.map}function j(O,H){var X=(function(et,V){return et?.[V]})(O,H);return k(X)?X:void 0}function B(O){var H=typeof O;return!!O&&(H=="object"||H=="function")}r.exports=function(O){return O&&O.length?(function(H,X,et){var V=-1,tt=c,$=H.length,z=!0,Z=[],it=Z;if($>=200){var mt=A(H);if(mt)return f(mt);z=!1,tt=h,it=new E}else it=Z;t:for(;++V<$;){var lt=H[V],at=lt;if(lt=lt!==0?lt:0,z&&at==at){for(var rt=it.length;rt--;)if(it[rt]===at)continue t;Z.push(lt)}else tt(it,at,et)||(it!==Z&&it.push(at),Z.push(lt))}return Z})(O):[]}}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(t,r,o){var s=t("inherits"),a=t("hash-base"),u=t("safe-buffer").Buffer,l=new Array(16);function i(){a.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function c(y,b){return y<<b|y>>>32-b}function p(y,b,v,w,S,N,D){return c(y+(b&v|~b&w)+S+N|0,D)+b|0}function h(y,b,v,w,S,N,D){return c(y+(b&w|v&~w)+S+N|0,D)+b|0}function f(y,b,v,w,S,N,D){return c(y+(b^v^w)+S+N|0,D)+b|0}function g(y,b,v,w,S,N,D){return c(y+(v^(b|~w))+S+N|0,D)+b|0}s(i,a),i.prototype._update=function(){for(var y=l,b=0;b<16;++b)y[b]=this._block.readInt32LE(4*b);var v=this._a,w=this._b,S=this._c,N=this._d;v=p(v,w,S,N,y[0],3614090360,7),N=p(N,v,w,S,y[1],3905402710,12),S=p(S,N,v,w,y[2],606105819,17),w=p(w,S,N,v,y[3],3250441966,22),v=p(v,w,S,N,y[4],4118548399,7),N=p(N,v,w,S,y[5],1200080426,12),S=p(S,N,v,w,y[6],2821735955,17),w=p(w,S,N,v,y[7],4249261313,22),v=p(v,w,S,N,y[8],1770035416,7),N=p(N,v,w,S,y[9],2336552879,12),S=p(S,N,v,w,y[10],4294925233,17),w=p(w,S,N,v,y[11],2304563134,22),v=p(v,w,S,N,y[12],1804603682,7),N=p(N,v,w,S,y[13],4254626195,12),S=p(S,N,v,w,y[14],2792965006,17),v=h(v,w=p(w,S,N,v,y[15],1236535329,22),S,N,y[1],4129170786,5),N=h(N,v,w,S,y[6],3225465664,9),S=h(S,N,v,w,y[11],643717713,14),w=h(w,S,N,v,y[0],3921069994,20),v=h(v,w,S,N,y[5],3593408605,5),N=h(N,v,w,S,y[10],38016083,9),S=h(S,N,v,w,y[15],3634488961,14),w=h(w,S,N,v,y[4],3889429448,20),v=h(v,w,S,N,y[9],568446438,5),N=h(N,v,w,S,y[14],3275163606,9),S=h(S,N,v,w,y[3],4107603335,14),w=h(w,S,N,v,y[8],1163531501,20),v=h(v,w,S,N,y[13],2850285829,5),N=h(N,v,w,S,y[2],4243563512,9),S=h(S,N,v,w,y[7],1735328473,14),v=f(v,w=h(w,S,N,v,y[12],2368359562,20),S,N,y[5],4294588738,4),N=f(N,v,w,S,y[8],2272392833,11),S=f(S,N,v,w,y[11],1839030562,16),w=f(w,S,N,v,y[14],4259657740,23),v=f(v,w,S,N,y[1],2763975236,4),N=f(N,v,w,S,y[4],1272893353,11),S=f(S,N,v,w,y[7],4139469664,16),w=f(w,S,N,v,y[10],3200236656,23),v=f(v,w,S,N,y[13],681279174,4),N=f(N,v,w,S,y[0],3936430074,11),S=f(S,N,v,w,y[3],3572445317,16),w=f(w,S,N,v,y[6],76029189,23),v=f(v,w,S,N,y[9],3654602809,4),N=f(N,v,w,S,y[12],3873151461,11),S=f(S,N,v,w,y[15],530742520,16),v=g(v,w=f(w,S,N,v,y[2],3299628645,23),S,N,y[0],4096336452,6),N=g(N,v,w,S,y[7],1126891415,10),S=g(S,N,v,w,y[14],2878612391,15),w=g(w,S,N,v,y[5],4237533241,21),v=g(v,w,S,N,y[12],1700485571,6),N=g(N,v,w,S,y[3],2399980690,10),S=g(S,N,v,w,y[10],4293915773,15),w=g(w,S,N,v,y[1],2240044497,21),v=g(v,w,S,N,y[8],1873313359,6),N=g(N,v,w,S,y[15],4264355552,10),S=g(S,N,v,w,y[6],2734768916,15),w=g(w,S,N,v,y[13],1309151649,21),v=g(v,w,S,N,y[4],4149444226,6),N=g(N,v,w,S,y[11],3174756917,10),S=g(S,N,v,w,y[2],718787259,15),w=g(w,S,N,v,y[9],3951481745,21),this._a=this._a+v|0,this._b=this._b+w|0,this._c=this._c+S|0,this._d=this._d+N|0},i.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var y=u.allocUnsafe(16);return y.writeInt32LE(this._a,0),y.writeInt32LE(this._b,4),y.writeInt32LE(this._c,8),y.writeInt32LE(this._d,12),y},r.exports=i},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(t,r,o){var s=t("bn.js"),a=t("brorand");function u(l){this.rand=l||new a.Rand}r.exports=u,u.create=function(l){return new u(l)},u.prototype._randbelow=function(l){var i=l.bitLength(),c=Math.ceil(i/8);do var p=new s(this.rand.generate(c));while(p.cmp(l)>=0);return p},u.prototype._randrange=function(l,i){var c=i.sub(l);return l.add(this._randbelow(c))},u.prototype.test=function(l,i,c){var p=l.bitLength(),h=s.mont(l),f=new s(1).toRed(h);i||(i=Math.max(1,p/48|0));for(var g=l.subn(1),y=0;!g.testn(y);y++);for(var b=l.shrn(y),v=g.toRed(h);i>0;i--){var w=this._randrange(new s(2),g);c&&c(w);var S=w.toRed(h).redPow(b);if(S.cmp(f)!==0&&S.cmp(v)!==0){for(var N=1;N<y;N++){if((S=S.redSqr()).cmp(f)===0)return!1;if(S.cmp(v)===0)break}if(N===y)return!1}}return!0},u.prototype.getDivisor=function(l,i){var c=l.bitLength(),p=s.mont(l),h=new s(1).toRed(p);i||(i=Math.max(1,c/48|0));for(var f=l.subn(1),g=0;!f.testn(g);g++);for(var y=l.shrn(g),b=f.toRed(p);i>0;i--){var v=this._randrange(new s(2),f),w=l.gcd(v);if(w.cmpn(1)!==0)return w;var S=v.toRed(p).redPow(y);if(S.cmp(h)!==0&&S.cmp(b)!==0){for(var N=1;N<g;N++){if((S=S.redSqr()).cmp(h)===0)return S.fromRed().subn(1).gcd(l);if(S.cmp(b)===0)break}if(N===g)return(S=S.redSqr()).fromRed().subn(1).gcd(l)}}return!1}},{"bn.js":452,brorand:187}],452:[function(t,r,o){arguments[4][184][0].apply(o,arguments)},{buffer:188,dup:184}],453:[function(t,r,o){function s(a,u){if(!a)throw new Error(u||"Assertion failed")}r.exports=s,s.equal=function(a,u,l){if(a!=u)throw new Error(l||"Assertion failed: "+a+" != "+u)}},{}],454:[function(t,r,o){var s=o;function a(l){return l.length===1?"0"+l:l}function u(l){for(var i="",c=0;c<l.length;c++)i+=a(l[c].toString(16));return i}s.toArray=function(l,i){if(Array.isArray(l))return l.slice();if(!l)return[];var c=[];if(typeof l!="string"){for(var p=0;p<l.length;p++)c[p]=0|l[p];return c}if(i==="hex")for((l=l.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(l="0"+l),p=0;p<l.length;p+=2)c.push(parseInt(l[p]+l[p+1],16));else for(p=0;p<l.length;p++){var h=l.charCodeAt(p),f=h>>8,g=255&h;f?c.push(f,g):c.push(g)}return c},s.zero2=a,s.toHex=u,s.encode=function(l,i){return i==="hex"?u(l):l}},{}],455:[function(t,r,o){r.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(t,r,o){var s=t("asn1.js");o.certificate=t("./certificate");var a=s.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));o.RSAPrivateKey=a;var u=s.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));o.RSAPublicKey=u;var l=s.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(i),this.key("subjectPublicKey").bitstr())}));o.PublicKey=l;var i=s.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),c=s.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(i),this.key("subjectPrivateKey").octstr())}));o.PrivateKey=c;var p=s.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));o.EncryptedPrivateKey=p;var h=s.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));o.DSAPrivateKey=h,o.DSAparam=s.define("DSAparam",(function(){this.int()}));var f=s.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(g),this.key("publicKey").optional().explicit(1).bitstr())}));o.ECPrivateKey=f;var g=s.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));o.signature=s.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},{"./certificate":457,"asn1.js":170}],457:[function(t,r,o){var s=t("asn1.js"),a=s.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),u=s.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),l=s.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),i=s.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())})),c=s.define("RelativeDistinguishedName",(function(){this.setof(u)})),p=s.define("RDNSequence",(function(){this.seqof(c)})),h=s.define("Name",(function(){this.choice({rdnSequence:this.use(p)})})),f=s.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(a),this.key("notAfter").use(a))})),g=s.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),y=s.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(l),this.key("issuer").use(h),this.key("validity").use(f),this.key("subject").use(h),this.key("subjectPublicKeyInfo").use(i),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(g).optional())})),b=s.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(y),this.key("signatureAlgorithm").use(l),this.key("signatureValue").bitstr())}));r.exports=b},{"asn1.js":170}],458:[function(t,r,o){var s=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,a=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,u=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,l=t("evp_bytestokey"),i=t("browserify-aes"),c=t("safe-buffer").Buffer;r.exports=function(p,h){var f,g=p.toString(),y=g.match(s);if(y){var b="aes"+y[1],v=c.from(y[2],"hex"),w=c.from(y[3].replace(/[\r\n]/g,""),"base64"),S=l(h,v.slice(0,8),parseInt(y[1],10)).key,N=[],D=i.createDecipheriv(b,S,v);N.push(D.update(w)),N.push(D.final()),f=c.concat(N)}else{var F=g.match(u);f=c.from(F[2].replace(/[\r\n]/g,""),"base64")}return{tag:g.match(a)[1],data:f}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(t,r,o){var s=t("./asn1"),a=t("./aesid.json"),u=t("./fixProc"),l=t("browserify-aes"),i=t("pbkdf2"),c=t("safe-buffer").Buffer;function p(h){var f;typeof h!="object"||c.isBuffer(h)||(f=h.passphrase,h=h.key),typeof h=="string"&&(h=c.from(h));var g,y,b=u(h,f),v=b.tag,w=b.data;switch(v){case"CERTIFICATE":y=s.certificate.decode(w,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(y||(y=s.PublicKey.decode(w,"der")),g=y.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return s.RSAPublicKey.decode(y.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return y.subjectPrivateKey=y.subjectPublicKey,{type:"ec",data:y};case"1.2.840.10040.4.1":return y.algorithm.params.pub_key=s.DSAparam.decode(y.subjectPublicKey.data,"der"),{type:"dsa",data:y.algorithm.params};default:throw new Error("unknown key id "+g)}case"ENCRYPTED PRIVATE KEY":w=(function(S,N){var D=S.algorithm.decrypt.kde.kdeparams.salt,F=parseInt(S.algorithm.decrypt.kde.kdeparams.iters.toString(),10),G=a[S.algorithm.decrypt.cipher.algo.join(".")],P=S.algorithm.decrypt.cipher.iv,U=S.subjectPrivateKey,q=parseInt(G.split("-")[1],10)/8,R=i.pbkdf2Sync(N,D,F,q,"sha1"),I=l.createDecipheriv(G,R,P),T=[];return T.push(I.update(U)),T.push(I.final()),c.concat(T)})(w=s.EncryptedPrivateKey.decode(w,"der"),f);case"PRIVATE KEY":switch(g=(y=s.PrivateKey.decode(w,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return s.RSAPrivateKey.decode(y.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:y.algorithm.curve,privateKey:s.ECPrivateKey.decode(y.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return y.algorithm.params.priv_key=s.DSAparam.decode(y.subjectPrivateKey,"der"),{type:"dsa",params:y.algorithm.params};default:throw new Error("unknown key id "+g)}case"RSA PUBLIC KEY":return s.RSAPublicKey.decode(w,"der");case"RSA PRIVATE KEY":return s.RSAPrivateKey.decode(w,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:s.DSAPrivateKey.decode(w,"der")};case"EC PRIVATE KEY":return{curve:(w=s.ECPrivateKey.decode(w,"der")).parameters.value,privateKey:w.privateKey};default:throw new Error("unknown key type "+v)}}r.exports=p,p.signature=s.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(t,r,o){o.pbkdf2=t("./lib/async"),o.pbkdf2Sync=t("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(t,r,o){(function(s){(function(){var a,u,l=t("safe-buffer").Buffer,i=t("./precondition"),c=t("./default-encoding"),p=t("./sync"),h=t("./to-buffer"),f=s.crypto&&s.crypto.subtle,g={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},y=[];function b(){return u||(u=s.process&&s.process.nextTick?s.process.nextTick:s.queueMicrotask?s.queueMicrotask:s.setImmediate?s.setImmediate:s.setTimeout)}function v(w,S,N,D,F){return f.importKey("raw",w,{name:"PBKDF2"},!1,["deriveBits"]).then((function(G){return f.deriveBits({name:"PBKDF2",salt:S,iterations:N,hash:{name:F}},G,D<<3)})).then((function(G){return l.from(G)}))}r.exports=function(w,S,N,D,F,G){typeof F=="function"&&(G=F,F=void 0);var P=g[(F=F||"sha1").toLowerCase()];if(P&&typeof s.Promise=="function"){if(i(N,D),w=h(w,c,"Password"),S=h(S,c,"Salt"),typeof G!="function")throw new Error("No callback provided to pbkdf2");(function(U,q){U.then((function(R){b()((function(){q(null,R)}))}),(function(R){b()((function(){q(R)}))}))})((function(U){if(s.process&&!s.process.browser||!f||!f.importKey||!f.deriveBits)return Promise.resolve(!1);if(y[U]!==void 0)return y[U];var q=v(a=a||l.alloc(8),a,10,128,U).then((function(){return!0})).catch((function(){return!1}));return y[U]=q,q})(P).then((function(U){return U?v(w,S,N,D,P):p(w,S,N,D,F)})),G)}else b()((function(){var U;try{U=p(w,S,N,D,F)}catch(q){return G(q)}G(null,U)}))}}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(t,r,o){(function(s,a){(function(){var u;a.process&&a.process.browser?u="utf-8":a.process&&a.process.version?u=parseInt(s.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":u="utf-8",r.exports=u}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(t,r,o){var s=Math.pow(2,30)-1;r.exports=function(a,u){if(typeof a!="number")throw new TypeError("Iterations not a number");if(a<0)throw new TypeError("Bad iterations");if(typeof u!="number")throw new TypeError("Key length not a number");if(u<0||u>s||u!=u)throw new TypeError("Bad key length")}},{}],464:[function(t,r,o){var s=t("create-hash/md5"),a=t("ripemd160"),u=t("sha.js"),l=t("safe-buffer").Buffer,i=t("./precondition"),c=t("./default-encoding"),p=t("./to-buffer"),h=l.alloc(128),f={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function g(y,b,v){var w=(function(P){function U(q){return u(P).update(q).digest()}return P==="rmd160"||P==="ripemd160"?function(q){return new a().update(q).digest()}:P==="md5"?s:U})(y),S=y==="sha512"||y==="sha384"?128:64;b.length>S?b=w(b):b.length<S&&(b=l.concat([b,h],S));for(var N=l.allocUnsafe(S+f[y]),D=l.allocUnsafe(S+f[y]),F=0;F<S;F++)N[F]=54^b[F],D[F]=92^b[F];var G=l.allocUnsafe(S+v+4);N.copy(G,0,0,S),this.ipad1=G,this.ipad2=N,this.opad=D,this.alg=y,this.blocksize=S,this.hash=w,this.size=f[y]}g.prototype.run=function(y,b){return y.copy(b,this.blocksize),this.hash(b).copy(this.opad,this.blocksize),this.hash(this.opad)},r.exports=function(y,b,v,w,S){i(v,w);var N=new g(S=S||"sha1",y=p(y,c,"Password"),(b=p(b,c,"Salt")).length),D=l.allocUnsafe(w),F=l.allocUnsafe(b.length+4);b.copy(F,0,0,b.length);for(var G=0,P=f[S],U=Math.ceil(w/P),q=1;q<=U;q++){F.writeUInt32BE(q,b.length);for(var R=N.run(F,N.ipad1),I=R,T=1;T<v;T++){I=N.run(I,N.ipad2);for(var L=0;L<P;L++)R[L]^=I[L]}R.copy(D,G),G+=P}return D}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(t,r,o){var s=t("safe-buffer").Buffer;r.exports=function(a,u,l){if(s.isBuffer(a))return a;if(typeof a=="string")return s.from(a,u);if(ArrayBuffer.isView(a))return s.from(a.buffer);throw new TypeError(l+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(t,r,o){(function(s){(function(){s===void 0||!s.version||s.version.indexOf("v0.")===0||s.version.indexOf("v1.")===0&&s.version.indexOf("v1.8.")!==0?r.exports={nextTick:function(a,u,l,i){if(typeof a!="function")throw new TypeError('"callback" argument must be a function');var c,p,h=arguments.length;switch(h){case 0:case 1:return s.nextTick(a);case 2:return s.nextTick((function(){a.call(null,u)}));case 3:return s.nextTick((function(){a.call(null,u,l)}));case 4:return s.nextTick((function(){a.call(null,u,l,i)}));default:for(c=new Array(h-1),p=0;p<c.length;)c[p++]=arguments[p];return s.nextTick((function(){a.apply(null,c)}))}}}:r.exports=s}).call(this)}).call(this,t("_process"))},{_process:467}],467:[function(t,r,o){var s,a,u=r.exports={};function l(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function c(S){if(s===setTimeout)return setTimeout(S,0);if((s===l||!s)&&setTimeout)return s=setTimeout,setTimeout(S,0);try{return s(S,0)}catch{try{return s.call(null,S,0)}catch{return s.call(this,S,0)}}}(function(){try{s=typeof setTimeout=="function"?setTimeout:l}catch{s=l}try{a=typeof clearTimeout=="function"?clearTimeout:i}catch{a=i}})();var p,h=[],f=!1,g=-1;function y(){f&&p&&(f=!1,p.length?h=p.concat(h):g=-1,h.length&&b())}function b(){if(!f){var S=c(y);f=!0;for(var N=h.length;N;){for(p=h,h=[];++g<N;)p&&p[g].run();g=-1,N=h.length}p=null,f=!1,(function(D){if(a===clearTimeout)return clearTimeout(D);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(D);try{a(D)}catch{try{return a.call(null,D)}catch{return a.call(this,D)}}})(S)}}function v(S,N){this.fun=S,this.array=N}function w(){}u.nextTick=function(S){var N=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)N[D-1]=arguments[D];h.push(new v(S,N)),h.length!==1||f||c(b)},v.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=w,u.addListener=w,u.once=w,u.off=w,u.removeListener=w,u.removeAllListeners=w,u.emit=w,u.prependListener=w,u.prependOnceListener=w,u.listeners=function(S){return[]},u.binding=function(S){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(S){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],468:[function(t,r,o){o.publicEncrypt=t("./publicEncrypt"),o.privateDecrypt=t("./privateDecrypt"),o.privateEncrypt=function(s,a){return o.publicEncrypt(s,a,!0)},o.publicDecrypt=function(s,a){return o.privateDecrypt(s,a,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(t,r,o){var s=t("create-hash"),a=t("safe-buffer").Buffer;function u(l){var i=a.allocUnsafe(4);return i.writeUInt32BE(l,0),i}r.exports=function(l,i){for(var c,p=a.alloc(0),h=0;p.length<i;)c=u(h++),p=a.concat([p,s("sha1").update(l).update(c).digest()]);return p.slice(0,i)}},{"create-hash":386,"safe-buffer":494}],470:[function(t,r,o){arguments[4][184][0].apply(o,arguments)},{buffer:188,dup:184}],471:[function(t,r,o){var s=t("parse-asn1"),a=t("./mgf"),u=t("./xor"),l=t("bn.js"),i=t("browserify-rsa"),c=t("create-hash"),p=t("./withPublic"),h=t("safe-buffer").Buffer;r.exports=function(f,g,y){var b;b=f.padding?f.padding:y?1:4;var v,w=s(f),S=w.modulus.byteLength();if(g.length>S||new l(g).cmp(w.modulus)>=0)throw new Error("decryption error");v=y?p(new l(g),w):i(g,w);var N=h.alloc(S-v.length);if(v=h.concat([N,v],S),b===4)return(function(D,F){var G=D.modulus.byteLength(),P=c("sha1").update(h.alloc(0)).digest(),U=P.length;if(F[0]!==0)throw new Error("decryption error");var q=F.slice(1,U+1),R=F.slice(U+1),I=u(q,a(R,U)),T=u(R,a(I,G-U-1));if((function(E,x){E=h.from(E),x=h.from(x);var k=0,A=E.length;E.length!==x.length&&(k++,A=Math.min(E.length,x.length));for(var C=-1;++C<A;)k+=E[C]^x[C];return k})(P,T.slice(0,U)))throw new Error("decryption error");for(var L=U;T[L]===0;)L++;if(T[L++]!==1)throw new Error("decryption error");return T.slice(L)})(w,v);if(b===1)return(function(D,F,G){for(var P=F.slice(0,2),U=2,q=0;F[U++]!==0;)if(U>=F.length){q++;break}var R=F.slice(2,U-1);if((P.toString("hex")!=="0002"&&!G||P.toString("hex")!=="0001"&&G)&&q++,R.length<8&&q++,q)throw new Error("decryption error");return F.slice(U)})(0,v,y);if(b===3)return v;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(t,r,o){var s=t("parse-asn1"),a=t("randombytes"),u=t("create-hash"),l=t("./mgf"),i=t("./xor"),c=t("bn.js"),p=t("./withPublic"),h=t("browserify-rsa"),f=t("safe-buffer").Buffer;r.exports=function(g,y,b){var v;v=g.padding?g.padding:b?1:4;var w,S=s(g);if(v===4)w=(function(N,D){var F=N.modulus.byteLength(),G=D.length,P=u("sha1").update(f.alloc(0)).digest(),U=P.length,q=2*U;if(G>F-q-2)throw new Error("message too long");var R=f.alloc(F-G-q-2),I=F-U-1,T=a(U),L=i(f.concat([P,R,f.alloc(1,1),D],I),l(T,I)),E=i(T,l(L,U));return new c(f.concat([f.alloc(1),E,L],F))})(S,y);else if(v===1)w=(function(N,D,F){var G,P=D.length,U=N.modulus.byteLength();if(P>U-11)throw new Error("message too long");return G=F?f.alloc(U-P-3,255):(function(q){for(var R,I=f.allocUnsafe(q),T=0,L=a(2*q),E=0;T<q;)E===L.length&&(L=a(2*q),E=0),(R=L[E++])&&(I[T++]=R);return I})(U-P-3),new c(f.concat([f.from([0,F?1:2]),G,f.alloc(1),D],U))})(S,y,b);else{if(v!==3)throw new Error("unknown padding");if((w=new c(y)).cmp(S.modulus)>=0)throw new Error("data too long for modulus")}return b?h(w,S):p(w,S)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(t,r,o){var s=t("bn.js"),a=t("safe-buffer").Buffer;r.exports=function(u,l){return a.from(u.toRed(s.mont(l.modulus)).redPow(new s(l.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(t,r,o){r.exports=function(s,a){for(var u=s.length,l=-1;++l<u;)s[l]^=a[l];return s}},{}],475:[function(t,r,o){(function(s,a){(function(){var u=t("safe-buffer").Buffer,l=a.crypto||a.msCrypto;l&&l.getRandomValues?r.exports=function(i,c){if(i>4294967295)throw new RangeError("requested too many random bytes");var p=u.allocUnsafe(i);if(i>0)if(i>65536)for(var h=0;h<i;h+=65536)l.getRandomValues(p.slice(h,h+65536));else l.getRandomValues(p);return typeof c=="function"?s.nextTick((function(){c(null,p)})):p}:r.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(t,r,o){(function(s,a){(function(){function u(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var l=t("safe-buffer"),i=t("randombytes"),c=l.Buffer,p=l.kMaxLength,h=a.crypto||a.msCrypto,f=Math.pow(2,32)-1;function g(v,w){if(typeof v!="number"||v!=v)throw new TypeError("offset must be a number");if(v>f||v<0)throw new TypeError("offset must be a uint32");if(v>p||v>w)throw new RangeError("offset out of range")}function y(v,w,S){if(typeof v!="number"||v!=v)throw new TypeError("size must be a number");if(v>f||v<0)throw new TypeError("size must be a uint32");if(v+w>S||v>p)throw new RangeError("buffer too small")}function b(v,w,S,N){if(s.browser){var D=v.buffer,F=new Uint8Array(D,w,S);return h.getRandomValues(F),N?void s.nextTick((function(){N(null,v)})):v}if(!N)return i(S).copy(v,w),v;i(S,(function(G,P){if(G)return N(G);P.copy(v,w),N(null,v)}))}h&&h.getRandomValues||!s.browser?(o.randomFill=function(v,w,S,N){if(!(c.isBuffer(v)||v instanceof a.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof w=="function")N=w,w=0,S=v.length;else if(typeof S=="function")N=S,S=v.length-w;else if(typeof N!="function")throw new TypeError('"cb" argument must be a function');return g(w,v.length),y(S,w,v.length),b(v,w,S,N)},o.randomFillSync=function(v,w,S){if(w===void 0&&(w=0),!(c.isBuffer(v)||v instanceof a.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return g(w,v.length),S===void 0&&(S=v.length-w),y(S,w,v.length),b(v,w,S)}):(o.randomFill=u,o.randomFillSync=u)}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(t,r,o){var s={};function a(l,i,c){c||(c=Error);var p=(function(h){var f,g;function y(b,v,w){return h.call(this,(function(S,N,D){return typeof i=="string"?i:i(S,N,D)})(b,v,w))||this}return g=h,(f=y).prototype=Object.create(g.prototype),f.prototype.constructor=f,f.__proto__=g,y})(c);p.prototype.name=c.name,p.prototype.code=l,s[l]=p}function u(l,i){if(Array.isArray(l)){var c=l.length;return l=l.map((function(p){return String(p)})),c>2?"one of ".concat(i," ").concat(l.slice(0,c-1).join(", "),", or ")+l[c-1]:c===2?"one of ".concat(i," ").concat(l[0]," or ").concat(l[1]):"of ".concat(i," ").concat(l[0])}return"of ".concat(i," ").concat(String(l))}a("ERR_INVALID_OPT_VALUE",(function(l,i){return'The value "'+i+'" is invalid for option "'+l+'"'}),TypeError),a("ERR_INVALID_ARG_TYPE",(function(l,i,c){var p,h,f;if(typeof i=="string"&&(h="not ",i.substr(0,h.length)===h)?(p="must not be",i=i.replace(/^not /,"")):p="must be",(function(y,b,v){return(v===void 0||v>y.length)&&(v=y.length),y.substring(v-b.length,v)===b})(l," argument"))f="The ".concat(l," ").concat(p," ").concat(u(i,"type"));else{var g=(function(y,b,v){return typeof v!="number"&&(v=0),!(v+b.length>y.length)&&y.indexOf(b,v)!==-1})(l,".")?"property":"argument";f='The "'.concat(l,'" ').concat(g," ").concat(p," ").concat(u(i,"type"))}return f+=". Received type ".concat(typeof c)}),TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",(function(l){return"The "+l+" method is not implemented"})),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",(function(l){return"Cannot call "+l+" after a stream was destroyed"})),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",(function(l){return"Unknown encoding: "+l}),TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),r.exports.codes=s},{}],478:[function(t,r,o){(function(s){(function(){var a=Object.keys||function(y){var b=[];for(var v in y)b.push(v);return b};r.exports=h;var u=t("./_stream_readable"),l=t("./_stream_writable");t("inherits")(h,u);for(var i=a(l.prototype),c=0;c<i.length;c++){var p=i[c];h.prototype[p]||(h.prototype[p]=l.prototype[p])}function h(y){if(!(this instanceof h))return new h(y);u.call(this,y),l.call(this,y),this.allowHalfOpen=!0,y&&(y.readable===!1&&(this.readable=!1),y.writable===!1&&(this.writable=!1),y.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",f)))}function f(){this._writableState.ended||s.nextTick(g,this)}function g(y){y.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=y,this._writableState.destroyed=y)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(t,r,o){r.exports=a;var s=t("./_stream_transform");function a(u){if(!(this instanceof a))return new a(u);s.call(this,u)}t("inherits")(a,s),a.prototype._transform=function(u,l,i){i(null,u)}},{"./_stream_transform":481,inherits:440}],480:[function(t,r,o){(function(s,a){(function(){var u;r.exports=I,I.ReadableState=R,t("events").EventEmitter;var l=function($,z){return $.listeners(z).length},i=t("./internal/streams/stream"),c=t("buffer").Buffer,p=(a!==void 0?a:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},h,f=t("util");h=f&&f.debuglog?f.debuglog("stream"):function(){};var g,y,b,v=t("./internal/streams/buffer_list"),w=t("./internal/streams/destroy"),S=t("./internal/streams/state").getHighWaterMark,N=t("../errors").codes,D=N.ERR_INVALID_ARG_TYPE,F=N.ERR_STREAM_PUSH_AFTER_EOF,G=N.ERR_METHOD_NOT_IMPLEMENTED,P=N.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(I,i);var U=w.errorOrDestroy,q=["error","close","destroy","pause","resume"];function R($,z,Z){u=u||t("./_stream_duplex"),$=$||{},typeof Z!="boolean"&&(Z=z instanceof u),this.objectMode=!!$.objectMode,Z&&(this.objectMode=this.objectMode||!!$.readableObjectMode),this.highWaterMark=S(this,$,"readableHighWaterMark",Z),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=$.emitClose!==!1,this.autoDestroy=!!$.autoDestroy,this.destroyed=!1,this.defaultEncoding=$.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,$.encoding&&(g||(g=t("string_decoder/").StringDecoder),this.decoder=new g($.encoding),this.encoding=$.encoding)}function I($){if(u=u||t("./_stream_duplex"),!(this instanceof I))return new I($);var z=this instanceof u;this._readableState=new R($,this,z),this.readable=!0,$&&(typeof $.read=="function"&&(this._read=$.read),typeof $.destroy=="function"&&(this._destroy=$.destroy)),i.call(this)}function T($,z,Z,it,mt){h("readableAddChunk",z);var lt,at=$._readableState;if(z===null)at.reading=!1,(function(rt,ct){if(h("onEofChunk"),!ct.ended){if(ct.decoder){var ot=ct.decoder.end();ot&&ot.length&&(ct.buffer.push(ot),ct.length+=ct.objectMode?1:ot.length)}ct.ended=!0,ct.sync?x(rt):(ct.needReadable=!1,ct.emittedReadable||(ct.emittedReadable=!0,k(rt)))}})($,at);else if(mt||(lt=(function(rt,ct){var ot;dt=ct,c.isBuffer(dt)||dt instanceof p||typeof ct=="string"||ct===void 0||rt.objectMode||(ot=new D("chunk",["string","Buffer","Uint8Array"],ct));var dt;return ot})(at,z)),lt)U($,lt);else if(at.objectMode||z&&z.length>0)if(typeof z=="string"||at.objectMode||Object.getPrototypeOf(z)===c.prototype||(z=(function(rt){return c.from(rt)})(z)),it)at.endEmitted?U($,new P):L($,at,z,!0);else if(at.ended)U($,new F);else{if(at.destroyed)return!1;at.reading=!1,at.decoder&&!Z?(z=at.decoder.write(z),at.objectMode||z.length!==0?L($,at,z,!1):A($,at)):L($,at,z,!1)}else it||(at.reading=!1,A($,at));return!at.ended&&(at.length<at.highWaterMark||at.length===0)}function L($,z,Z,it){z.flowing&&z.length===0&&!z.sync?(z.awaitDrain=0,$.emit("data",Z)):(z.length+=z.objectMode?1:Z.length,it?z.buffer.unshift(Z):z.buffer.push(Z),z.needReadable&&x($)),A($,z)}Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function($){this._readableState&&(this._readableState.destroyed=$)}}),I.prototype.destroy=w.destroy,I.prototype._undestroy=w.undestroy,I.prototype._destroy=function($,z){z($)},I.prototype.push=function($,z){var Z,it=this._readableState;return it.objectMode?Z=!0:typeof $=="string"&&((z=z||it.defaultEncoding)!==it.encoding&&($=c.from($,z),z=""),Z=!0),T(this,$,z,!1,Z)},I.prototype.unshift=function($){return T(this,$,null,!0,!1)},I.prototype.isPaused=function(){return this._readableState.flowing===!1},I.prototype.setEncoding=function($){g||(g=t("string_decoder/").StringDecoder);var z=new g($);this._readableState.decoder=z,this._readableState.encoding=this._readableState.decoder.encoding;for(var Z=this._readableState.buffer.head,it="";Z!==null;)it+=z.write(Z.data),Z=Z.next;return this._readableState.buffer.clear(),it!==""&&this._readableState.buffer.push(it),this._readableState.length=it.length,this};function E($,z){return $<=0||z.length===0&&z.ended?0:z.objectMode?1:$!=$?z.flowing&&z.length?z.buffer.head.data.length:z.length:($>z.highWaterMark&&(z.highWaterMark=(function(Z){return Z>=1073741824?Z=1073741824:(Z--,Z|=Z>>>1,Z|=Z>>>2,Z|=Z>>>4,Z|=Z>>>8,Z|=Z>>>16,Z++),Z})($)),$<=z.length?$:z.ended?z.length:(z.needReadable=!0,0))}function x($){var z=$._readableState;h("emitReadable",z.needReadable,z.emittedReadable),z.needReadable=!1,z.emittedReadable||(h("emitReadable",z.flowing),z.emittedReadable=!0,s.nextTick(k,$))}function k($){var z=$._readableState;h("emitReadable_",z.destroyed,z.length,z.ended),z.destroyed||!z.length&&!z.ended||($.emit("readable"),z.emittedReadable=!1),z.needReadable=!z.flowing&&!z.ended&&z.length<=z.highWaterMark,H($)}function A($,z){z.readingMore||(z.readingMore=!0,s.nextTick(C,$,z))}function C($,z){for(;!z.reading&&!z.ended&&(z.length<z.highWaterMark||z.flowing&&z.length===0);){var Z=z.length;if(h("maybeReadMore read 0"),$.read(0),Z===z.length)break}z.readingMore=!1}function j($){var z=$._readableState;z.readableListening=$.listenerCount("readable")>0,z.resumeScheduled&&!z.paused?z.flowing=!0:$.listenerCount("data")>0&&$.resume()}function B($){h("readable nexttick read 0"),$.read(0)}function O($,z){h("resume",z.reading),z.reading||$.read(0),z.resumeScheduled=!1,$.emit("resume"),H($),z.flowing&&!z.reading&&$.read(0)}function H($){var z=$._readableState;for(h("flow",z.flowing);z.flowing&&$.read()!==null;);}function X($,z){return z.length===0?null:(z.objectMode?Z=z.buffer.shift():!$||$>=z.length?(Z=z.decoder?z.buffer.join(""):z.buffer.length===1?z.buffer.first():z.buffer.concat(z.length),z.buffer.clear()):Z=z.buffer.consume($,z.decoder),Z);var Z}function et($){var z=$._readableState;h("endReadable",z.endEmitted),z.endEmitted||(z.ended=!0,s.nextTick(V,z,$))}function V($,z){if(h("endReadableNT",$.endEmitted,$.length),!$.endEmitted&&$.length===0&&($.endEmitted=!0,z.readable=!1,z.emit("end"),$.autoDestroy)){var Z=z._writableState;(!Z||Z.autoDestroy&&Z.finished)&&z.destroy()}}function tt($,z){for(var Z=0,it=$.length;Z<it;Z++)if($[Z]===z)return Z;return-1}I.prototype.read=function($){h("read",$),$=parseInt($,10);var z=this._readableState,Z=$;if($!==0&&(z.emittedReadable=!1),$===0&&z.needReadable&&((z.highWaterMark!==0?z.length>=z.highWaterMark:z.length>0)||z.ended))return h("read: emitReadable",z.length,z.ended),z.length===0&&z.ended?et(this):x(this),null;if(($=E($,z))===0&&z.ended)return z.length===0&&et(this),null;var it,mt=z.needReadable;return h("need readable",mt),(z.length===0||z.length-$<z.highWaterMark)&&h("length less than watermark",mt=!0),z.ended||z.reading?h("reading or ended",mt=!1):mt&&(h("do read"),z.reading=!0,z.sync=!0,z.length===0&&(z.needReadable=!0),this._read(z.highWaterMark),z.sync=!1,z.reading||($=E(Z,z))),(it=$>0?X($,z):null)===null?(z.needReadable=z.length<=z.highWaterMark,$=0):(z.length-=$,z.awaitDrain=0),z.length===0&&(z.ended||(z.needReadable=!0),Z!==$&&z.ended&&et(this)),it!==null&&this.emit("data",it),it},I.prototype._read=function($){U(this,new G("_read()"))},I.prototype.pipe=function($,z){var Z=this,it=this._readableState;switch(it.pipesCount){case 0:it.pipes=$;break;case 1:it.pipes=[it.pipes,$];break;default:it.pipes.push($)}it.pipesCount+=1,h("pipe count=%d opts=%j",it.pipesCount,z);var mt=(!z||z.end!==!1)&&$!==s.stdout&&$!==s.stderr?at:wt;function lt(yt,Et){h("onunpipe"),yt===Z&&Et&&Et.hasUnpiped===!1&&(Et.hasUnpiped=!0,h("cleanup"),$.removeListener("close",ft),$.removeListener("finish",gt),$.removeListener("drain",rt),$.removeListener("error",dt),$.removeListener("unpipe",lt),Z.removeListener("end",at),Z.removeListener("end",wt),Z.removeListener("data",ot),ct=!0,!it.awaitDrain||$._writableState&&!$._writableState.needDrain||rt())}function at(){h("onend"),$.end()}it.endEmitted?s.nextTick(mt):Z.once("end",mt),$.on("unpipe",lt);var rt=(function(yt){return function(){var Et=yt._readableState;h("pipeOnDrain",Et.awaitDrain),Et.awaitDrain&&Et.awaitDrain--,Et.awaitDrain===0&&l(yt,"data")&&(Et.flowing=!0,H(yt))}})(Z);$.on("drain",rt);var ct=!1;function ot(yt){h("ondata");var Et=$.write(yt);h("dest.write",Et),Et===!1&&((it.pipesCount===1&&it.pipes===$||it.pipesCount>1&&tt(it.pipes,$)!==-1)&&!ct&&(h("false write response, pause",it.awaitDrain),it.awaitDrain++),Z.pause())}function dt(yt){h("onerror",yt),wt(),$.removeListener("error",dt),l($,"error")===0&&U($,yt)}function ft(){$.removeListener("finish",gt),wt()}function gt(){h("onfinish"),$.removeListener("close",ft),wt()}function wt(){h("unpipe"),Z.unpipe($)}return Z.on("data",ot),(function(yt,Et,Mt){if(typeof yt.prependListener=="function")return yt.prependListener(Et,Mt);yt._events&&yt._events[Et]?Array.isArray(yt._events[Et])?yt._events[Et].unshift(Mt):yt._events[Et]=[Mt,yt._events[Et]]:yt.on(Et,Mt)})($,"error",dt),$.once("close",ft),$.once("finish",gt),$.emit("pipe",Z),it.flowing||(h("pipe resume"),Z.resume()),$},I.prototype.unpipe=function($){var z=this._readableState,Z={hasUnpiped:!1};if(z.pipesCount===0)return this;if(z.pipesCount===1)return $&&$!==z.pipes||($||($=z.pipes),z.pipes=null,z.pipesCount=0,z.flowing=!1,$&&$.emit("unpipe",this,Z)),this;if(!$){var it=z.pipes,mt=z.pipesCount;z.pipes=null,z.pipesCount=0,z.flowing=!1;for(var lt=0;lt<mt;lt++)it[lt].emit("unpipe",this,{hasUnpiped:!1});return this}var at=tt(z.pipes,$);return at===-1||(z.pipes.splice(at,1),z.pipesCount-=1,z.pipesCount===1&&(z.pipes=z.pipes[0]),$.emit("unpipe",this,Z)),this},I.prototype.on=function($,z){var Z=i.prototype.on.call(this,$,z),it=this._readableState;return $==="data"?(it.readableListening=this.listenerCount("readable")>0,it.flowing!==!1&&this.resume()):$==="readable"&&(it.endEmitted||it.readableListening||(it.readableListening=it.needReadable=!0,it.flowing=!1,it.emittedReadable=!1,h("on readable",it.length,it.reading),it.length?x(this):it.reading||s.nextTick(B,this))),Z},I.prototype.addListener=I.prototype.on,I.prototype.removeListener=function($,z){var Z=i.prototype.removeListener.call(this,$,z);return $==="readable"&&s.nextTick(j,this),Z},I.prototype.removeAllListeners=function($){var z=i.prototype.removeAllListeners.apply(this,arguments);return $!=="readable"&&$!==void 0||s.nextTick(j,this),z},I.prototype.resume=function(){var $=this._readableState;return $.flowing||(h("resume"),$.flowing=!$.readableListening,(function(z,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,s.nextTick(O,z,Z))})(this,$)),$.paused=!1,this},I.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},I.prototype.wrap=function($){var z=this,Z=this._readableState,it=!1;for(var mt in $.on("end",(function(){if(h("wrapped end"),Z.decoder&&!Z.ended){var at=Z.decoder.end();at&&at.length&&z.push(at)}z.push(null)})),$.on("data",(function(at){h("wrapped data"),Z.decoder&&(at=Z.decoder.write(at)),Z.objectMode&&at==null||(Z.objectMode||at&&at.length)&&(z.push(at)||(it=!0,$.pause()))})),$)this[mt]===void 0&&typeof $[mt]=="function"&&(this[mt]=(function(at){return function(){return $[at].apply($,arguments)}})(mt));for(var lt=0;lt<q.length;lt++)$.on(q[lt],this.emit.bind(this,q[lt]));return this._read=function(at){h("wrapped _read",at),it&&(it=!1,$.resume())},this},typeof Symbol=="function"&&(I.prototype[Symbol.asyncIterator]=function(){return y===void 0&&(y=t("./internal/streams/async_iterator")),y(this)}),Object.defineProperty(I.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(I.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(I.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function($){this._readableState&&(this._readableState.flowing=$)}}),I._fromList=X,Object.defineProperty(I.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(I.from=function($,z){return b===void 0&&(b=t("./internal/streams/from")),b(I,$,z)})}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(t,r,o){r.exports=h;var s=t("../errors").codes,a=s.ERR_METHOD_NOT_IMPLEMENTED,u=s.ERR_MULTIPLE_CALLBACK,l=s.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=s.ERR_TRANSFORM_WITH_LENGTH_0,c=t("./_stream_duplex");function p(y,b){var v=this._transformState;v.transforming=!1;var w=v.writecb;if(w===null)return this.emit("error",new u);v.writechunk=null,v.writecb=null,b!=null&&this.push(b),w(y);var S=this._readableState;S.reading=!1,(S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}function h(y){if(!(this instanceof h))return new h(y);c.call(this,y),this._transformState={afterTransform:p.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&(typeof y.transform=="function"&&(this._transform=y.transform),typeof y.flush=="function"&&(this._flush=y.flush)),this.on("prefinish",f)}function f(){var y=this;typeof this._flush!="function"||this._readableState.destroyed?g(this,null,null):this._flush((function(b,v){g(y,b,v)}))}function g(y,b,v){if(b)return y.emit("error",b);if(v!=null&&y.push(v),y._writableState.length)throw new i;if(y._transformState.transforming)throw new l;return y.push(null)}t("inherits")(h,c),h.prototype.push=function(y,b){return this._transformState.needTransform=!1,c.prototype.push.call(this,y,b)},h.prototype._transform=function(y,b,v){v(new a("_transform()"))},h.prototype._write=function(y,b,v){var w=this._transformState;if(w.writecb=v,w.writechunk=y,w.writeencoding=b,!w.transforming){var S=this._readableState;(w.needTransform||S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}},h.prototype._read=function(y){var b=this._transformState;b.writechunk===null||b.transforming?b.needTransform=!0:(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform))},h.prototype._destroy=function(y,b){c.prototype._destroy.call(this,y,(function(v){b(v)}))}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(t,r,o){(function(s,a){(function(){function u(C){var j=this;this.next=null,this.entry=null,this.finish=function(){(function(B,O,H){var X=B.entry;for(B.entry=null;X;){var et=X.callback;O.pendingcb--,et(H),X=X.next}O.corkedRequestsFree.next=B})(j,C)}}var l;r.exports=I,I.WritableState=R;var i={deprecate:t("util-deprecate")},c=t("./internal/streams/stream"),p=t("buffer").Buffer,h=(a!==void 0?a:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,g=t("./internal/streams/destroy"),y=t("./internal/streams/state").getHighWaterMark,b=t("../errors").codes,v=b.ERR_INVALID_ARG_TYPE,w=b.ERR_METHOD_NOT_IMPLEMENTED,S=b.ERR_MULTIPLE_CALLBACK,N=b.ERR_STREAM_CANNOT_PIPE,D=b.ERR_STREAM_DESTROYED,F=b.ERR_STREAM_NULL_VALUES,G=b.ERR_STREAM_WRITE_AFTER_END,P=b.ERR_UNKNOWN_ENCODING,U=g.errorOrDestroy;function q(){}function R(C,j,B){l=l||t("./_stream_duplex"),C=C||{},typeof B!="boolean"&&(B=j instanceof l),this.objectMode=!!C.objectMode,B&&(this.objectMode=this.objectMode||!!C.writableObjectMode),this.highWaterMark=y(this,C,"writableHighWaterMark",B),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var O=C.decodeStrings===!1;this.decodeStrings=!O,this.defaultEncoding=C.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(H){(function(X,et){var V=X._writableState,tt=V.sync,$=V.writecb;if(typeof $!="function")throw new S;if((function(Z){Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0})(V),et)(function(Z,it,mt,lt,at){--it.pendingcb,mt?(s.nextTick(at,lt),s.nextTick(A,Z,it),Z._writableState.errorEmitted=!0,U(Z,lt)):(at(lt),Z._writableState.errorEmitted=!0,U(Z,lt),A(Z,it))})(X,V,tt,et,$);else{var z=x(V)||X.destroyed;z||V.corked||V.bufferProcessing||!V.bufferedRequest||E(X,V),tt?s.nextTick(L,X,V,z,$):L(X,V,z,$)}})(j,H)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=C.emitClose!==!1,this.autoDestroy=!!C.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new u(this)}function I(C){var j=this instanceof(l=l||t("./_stream_duplex"));if(!j&&!f.call(I,this))return new I(C);this._writableState=new R(C,this,j),this.writable=!0,C&&(typeof C.write=="function"&&(this._write=C.write),typeof C.writev=="function"&&(this._writev=C.writev),typeof C.destroy=="function"&&(this._destroy=C.destroy),typeof C.final=="function"&&(this._final=C.final)),c.call(this)}function T(C,j,B,O,H,X,et){j.writelen=O,j.writecb=et,j.writing=!0,j.sync=!0,j.destroyed?j.onwrite(new D("write")):B?C._writev(H,j.onwrite):C._write(H,X,j.onwrite),j.sync=!1}function L(C,j,B,O){B||(function(H,X){X.length===0&&X.needDrain&&(X.needDrain=!1,H.emit("drain"))})(C,j),j.pendingcb--,O(),A(C,j)}function E(C,j){j.bufferProcessing=!0;var B=j.bufferedRequest;if(C._writev&&B&&B.next){var O=j.bufferedRequestCount,H=new Array(O),X=j.corkedRequestsFree;X.entry=B;for(var et=0,V=!0;B;)H[et]=B,B.isBuf||(V=!1),B=B.next,et+=1;H.allBuffers=V,T(C,j,!0,j.length,H,"",X.finish),j.pendingcb++,j.lastBufferedRequest=null,X.next?(j.corkedRequestsFree=X.next,X.next=null):j.corkedRequestsFree=new u(j),j.bufferedRequestCount=0}else{for(;B;){var tt=B.chunk,$=B.encoding,z=B.callback;if(T(C,j,!1,j.objectMode?1:tt.length,tt,$,z),B=B.next,j.bufferedRequestCount--,j.writing)break}B===null&&(j.lastBufferedRequest=null)}j.bufferedRequest=B,j.bufferProcessing=!1}function x(C){return C.ending&&C.length===0&&C.bufferedRequest===null&&!C.finished&&!C.writing}function k(C,j){C._final((function(B){j.pendingcb--,B&&U(C,B),j.prefinished=!0,C.emit("prefinish"),A(C,j)}))}function A(C,j){var B=x(j);if(B&&((function(H,X){X.prefinished||X.finalCalled||(typeof H._final!="function"||X.destroyed?(X.prefinished=!0,H.emit("prefinish")):(X.pendingcb++,X.finalCalled=!0,s.nextTick(k,H,X)))})(C,j),j.pendingcb===0&&(j.finished=!0,C.emit("finish"),j.autoDestroy))){var O=C._readableState;(!O||O.autoDestroy&&O.endEmitted)&&C.destroy()}return B}t("inherits")(I,c),R.prototype.getBuffer=function(){for(var C=this.bufferedRequest,j=[];C;)j.push(C),C=C.next;return j},(function(){try{Object.defineProperty(R.prototype,"buffer",{get:i.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(I,Symbol.hasInstance,{value:function(C){return!!f.call(this,C)||this===I&&C&&C._writableState instanceof R}})):f=function(C){return C instanceof this},I.prototype.pipe=function(){U(this,new N)},I.prototype.write=function(C,j,B){var O,H=this._writableState,X=!1,et=!H.objectMode&&(O=C,p.isBuffer(O)||O instanceof h);return et&&!p.isBuffer(C)&&(C=(function(V){return p.from(V)})(C)),typeof j=="function"&&(B=j,j=null),et?j="buffer":j||(j=H.defaultEncoding),typeof B!="function"&&(B=q),H.ending?(function(V,tt){var $=new G;U(V,$),s.nextTick(tt,$)})(this,B):(et||(function(V,tt,$,z){var Z;return $===null?Z=new F:typeof $=="string"||tt.objectMode||(Z=new v("chunk",["string","Buffer"],$)),!Z||(U(V,Z),s.nextTick(z,Z),!1)})(this,H,C,B))&&(H.pendingcb++,X=(function(V,tt,$,z,Z,it){if(!$){var mt=(function(ct,ot,dt){return ct.objectMode||ct.decodeStrings===!1||typeof ot!="string"||(ot=p.from(ot,dt)),ot})(tt,z,Z);z!==mt&&($=!0,Z="buffer",z=mt)}var lt=tt.objectMode?1:z.length;tt.length+=lt;var at=tt.length<tt.highWaterMark;if(at||(tt.needDrain=!0),tt.writing||tt.corked){var rt=tt.lastBufferedRequest;tt.lastBufferedRequest={chunk:z,encoding:Z,isBuf:$,callback:it,next:null},rt?rt.next=tt.lastBufferedRequest:tt.bufferedRequest=tt.lastBufferedRequest,tt.bufferedRequestCount+=1}else T(V,tt,!1,lt,z,Z,it);return at})(this,H,et,C,j,B)),X},I.prototype.cork=function(){this._writableState.corked++},I.prototype.uncork=function(){var C=this._writableState;C.corked&&(C.corked--,C.writing||C.corked||C.bufferProcessing||!C.bufferedRequest||E(this,C))},I.prototype.setDefaultEncoding=function(C){if(typeof C=="string"&&(C=C.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((C+"").toLowerCase())>-1))throw new P(C);return this._writableState.defaultEncoding=C,this},Object.defineProperty(I.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(I.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),I.prototype._write=function(C,j,B){B(new w("_write()"))},I.prototype._writev=null,I.prototype.end=function(C,j,B){var O=this._writableState;return typeof C=="function"?(B=C,C=null,j=null):typeof j=="function"&&(B=j,j=null),C!=null&&this.write(C,j),O.corked&&(O.corked=1,this.uncork()),O.ending||(function(H,X,et){X.ending=!0,A(H,X),et&&(X.finished?s.nextTick(et):H.once("finish",et)),X.ended=!0,H.writable=!1})(this,O,B),this},Object.defineProperty(I.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(C){this._writableState&&(this._writableState.destroyed=C)}}),I.prototype.destroy=g.destroy,I.prototype._undestroy=g.undestroy,I.prototype._destroy=function(C,j){j(C)}}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(t,r,o){(function(s){(function(){var a;function u(D,F,G){return(F=(function(P){var U=(function(q,R){if(typeof q!="object"||q===null)return q;var I=q[Symbol.toPrimitive];if(I!==void 0){var T=I.call(q,R);if(typeof T!="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(R==="string"?String:Number)(q)})(P,"string");return typeof U=="symbol"?U:String(U)})(F))in D?Object.defineProperty(D,F,{value:G,enumerable:!0,configurable:!0,writable:!0}):D[F]=G,D}var l=t("./end-of-stream"),i=Symbol("lastResolve"),c=Symbol("lastReject"),p=Symbol("error"),h=Symbol("ended"),f=Symbol("lastPromise"),g=Symbol("handlePromise"),y=Symbol("stream");function b(D,F){return{value:D,done:F}}function v(D){var F=D[i];if(F!==null){var G=D[y].read();G!==null&&(D[f]=null,D[i]=null,D[c]=null,F(b(G,!1)))}}function w(D){s.nextTick(v,D)}var S=Object.getPrototypeOf((function(){})),N=Object.setPrototypeOf((u(a={get stream(){return this[y]},next:function(){var D=this,F=this[p];if(F!==null)return Promise.reject(F);if(this[h])return Promise.resolve(b(void 0,!0));if(this[y].destroyed)return new Promise((function(q,R){s.nextTick((function(){D[p]?R(D[p]):q(b(void 0,!0))}))}));var G,P=this[f];if(P)G=new Promise((function(q,R){return function(I,T){q.then((function(){R[h]?I(b(void 0,!0)):R[g](I,T)}),T)}})(P,this));else{var U=this[y].read();if(U!==null)return Promise.resolve(b(U,!1));G=new Promise(this[g])}return this[f]=G,G}},Symbol.asyncIterator,(function(){return this})),u(a,"return",(function(){var D=this;return new Promise((function(F,G){D[y].destroy(null,(function(P){P?G(P):F(b(void 0,!0))}))}))})),a),S);r.exports=function(D){var F,G=Object.create(N,(u(F={},y,{value:D,writable:!0}),u(F,i,{value:null,writable:!0}),u(F,c,{value:null,writable:!0}),u(F,p,{value:null,writable:!0}),u(F,h,{value:D._readableState.endEmitted,writable:!0}),u(F,g,{value:function(P,U){var q=G[y].read();q?(G[f]=null,G[i]=null,G[c]=null,P(b(q,!1))):(G[i]=P,G[c]=U)},writable:!0}),F));return G[f]=null,l(D,(function(P){if(P&&P.code!=="ERR_STREAM_PREMATURE_CLOSE"){var U=G[c];return U!==null&&(G[f]=null,G[i]=null,G[c]=null,U(P)),void(G[p]=P)}var q=G[i];q!==null&&(G[f]=null,G[i]=null,G[c]=null,q(b(void 0,!0))),G[h]=!0})),D.on("readable",w.bind(null,G)),G}}).call(this)}).call(this,t("_process"))},{"./end-of-stream":486,_process:467}],484:[function(t,r,o){function s(f,g){var y=Object.keys(f);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(f);g&&(b=b.filter((function(v){return Object.getOwnPropertyDescriptor(f,v).enumerable}))),y.push.apply(y,b)}return y}function a(f){for(var g=1;g<arguments.length;g++){var y=arguments[g]!=null?arguments[g]:{};g%2?s(Object(y),!0).forEach((function(b){u(f,b,y[b])})):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(y)):s(Object(y)).forEach((function(b){Object.defineProperty(f,b,Object.getOwnPropertyDescriptor(y,b))}))}return f}function u(f,g,y){return(g=i(g))in f?Object.defineProperty(f,g,{value:y,enumerable:!0,configurable:!0,writable:!0}):f[g]=y,f}function l(f,g){for(var y=0;y<g.length;y++){var b=g[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(f,i(b.key),b)}}function i(f){var g=(function(y,b){if(typeof y!="object"||y===null)return y;var v=y[Symbol.toPrimitive];if(v!==void 0){var w=v.call(y,b);if(typeof w!="object")return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return(b==="string"?String:Number)(y)})(f,"string");return typeof g=="symbol"?g:String(g)}var c=t("buffer").Buffer,p=t("util").inspect,h=p&&p.custom||"inspect";r.exports=(function(){function f(){(function(b,v){if(!(b instanceof v))throw new TypeError("Cannot call a class as a function")})(this,f),this.head=null,this.tail=null,this.length=0}var g,y;return g=f,(y=[{key:"push",value:function(b){var v={data:b,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(b){var v={data:b,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var b=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,b}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(b){if(this.length===0)return"";for(var v=this.head,w=""+v.data;v=v.next;)w+=b+v.data;return w}},{key:"concat",value:function(b){if(this.length===0)return c.alloc(0);for(var v,w,S,N=c.allocUnsafe(b>>>0),D=this.head,F=0;D;)v=D.data,w=N,S=F,c.prototype.copy.call(v,w,S),F+=D.data.length,D=D.next;return N}},{key:"consume",value:function(b,v){var w;return b<this.head.data.length?(w=this.head.data.slice(0,b),this.head.data=this.head.data.slice(b)):w=b===this.head.data.length?this.shift():v?this._getString(b):this._getBuffer(b),w}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(b){var v=this.head,w=1,S=v.data;for(b-=S.length;v=v.next;){var N=v.data,D=b>N.length?N.length:b;if(D===N.length?S+=N:S+=N.slice(0,b),(b-=D)==0){D===N.length?(++w,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=N.slice(D));break}++w}return this.length-=w,S}},{key:"_getBuffer",value:function(b){var v=c.allocUnsafe(b),w=this.head,S=1;for(w.data.copy(v),b-=w.data.length;w=w.next;){var N=w.data,D=b>N.length?N.length:b;if(N.copy(v,v.length-b,0,D),(b-=D)==0){D===N.length?(++S,w.next?this.head=w.next:this.head=this.tail=null):(this.head=w,w.data=N.slice(D));break}++S}return this.length-=S,v}},{key:h,value:function(b,v){return p(this,a(a({},v),{},{depth:0,customInspect:!1}))}}])&&l(g.prototype,y),Object.defineProperty(g,"prototype",{writable:!1}),f})()},{buffer:220,util:188}],485:[function(t,r,o){(function(s){(function(){function a(i,c){l(i,c),u(i)}function u(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function l(i,c){i.emit("error",c)}r.exports={destroy:function(i,c){var p=this,h=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return h||f?(c?c(i):i&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,s.nextTick(l,this,i)):s.nextTick(l,this,i)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,(function(g){!c&&g?p._writableState?p._writableState.errorEmitted?s.nextTick(u,p):(p._writableState.errorEmitted=!0,s.nextTick(a,p,g)):s.nextTick(a,p,g):c?(s.nextTick(u,p),c(g)):s.nextTick(u,p)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(i,c){var p=i._readableState,h=i._writableState;p&&p.autoDestroy||h&&h.autoDestroy?i.destroy(c):i.emit("error",c)}}}).call(this)}).call(this,t("_process"))},{_process:467}],486:[function(t,r,o){var s=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function a(){}r.exports=function u(l,i,c){if(typeof i=="function")return u(l,null,i);i||(i={}),c=(function(D){var F=!1;return function(){if(!F){F=!0;for(var G=arguments.length,P=new Array(G),U=0;U<G;U++)P[U]=arguments[U];D.apply(this,P)}}})(c||a);var p=i.readable||i.readable!==!1&&l.readable,h=i.writable||i.writable!==!1&&l.writable,f=function(){l.writable||y()},g=l._writableState&&l._writableState.finished,y=function(){h=!1,g=!0,p||c.call(l)},b=l._readableState&&l._readableState.endEmitted,v=function(){p=!1,b=!0,h||c.call(l)},w=function(D){c.call(l,D)},S=function(){var D;return p&&!b?(l._readableState&&l._readableState.ended||(D=new s),c.call(l,D)):h&&!g?(l._writableState&&l._writableState.ended||(D=new s),c.call(l,D)):void 0},N=function(){l.req.on("finish",y)};return(function(D){return D.setHeader&&typeof D.abort=="function"})(l)?(l.on("complete",y),l.on("abort",S),l.req?N():l.on("request",N)):h&&!l._writableState&&(l.on("end",f),l.on("close",f)),l.on("end",v),l.on("finish",y),i.error!==!1&&l.on("error",w),l.on("close",S),function(){l.removeListener("complete",y),l.removeListener("abort",S),l.removeListener("request",N),l.req&&l.req.removeListener("finish",y),l.removeListener("end",f),l.removeListener("close",f),l.removeListener("finish",y),l.removeListener("end",v),l.removeListener("error",w),l.removeListener("close",S)}}},{"../../../errors":477}],487:[function(t,r,o){r.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(t,r,o){var s,a=t("../../../errors").codes,u=a.ERR_MISSING_ARGS,l=a.ERR_STREAM_DESTROYED;function i(g){if(g)throw g}function c(g,y,b,v){v=(function(N){var D=!1;return function(){D||(D=!0,N.apply(void 0,arguments))}})(v);var w=!1;g.on("close",(function(){w=!0})),s===void 0&&(s=t("./end-of-stream")),s(g,{readable:y,writable:b},(function(N){if(N)return v(N);w=!0,v()}));var S=!1;return function(N){if(!w&&!S)return S=!0,(function(D){return D.setHeader&&typeof D.abort=="function"})(g)?g.abort():typeof g.destroy=="function"?g.destroy():void v(N||new l("pipe"))}}function p(g){g()}function h(g,y){return g.pipe(y)}function f(g){return g.length?typeof g[g.length-1]!="function"?i:g.pop():i}r.exports=function(){for(var g=arguments.length,y=new Array(g),b=0;b<g;b++)y[b]=arguments[b];var v,w=f(y);if(Array.isArray(y[0])&&(y=y[0]),y.length<2)throw new u("streams");var S=y.map((function(N,D){var F=D<y.length-1;return c(N,F,D>0,(function(G){v||(v=G),G&&S.forEach(p),F||(S.forEach(p),w(v))}))}));return y.reduce(h)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(t,r,o){var s=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;r.exports={getHighWaterMark:function(a,u,l,i){var c=(function(p,h,f){return p.highWaterMark!=null?p.highWaterMark:h?p[f]:null})(u,i,l);if(c!=null){if(!isFinite(c)||Math.floor(c)!==c||c<0)throw new s(i?l:"highWaterMark",c);return Math.floor(c)}return a.objectMode?16:16384}}},{"../../../errors":477}],490:[function(t,r,o){r.exports=t("events").EventEmitter},{events:422}],491:[function(t,r,o){(o=r.exports=t("./lib/_stream_readable.js")).Stream=o,o.Readable=o,o.Writable=t("./lib/_stream_writable.js"),o.Duplex=t("./lib/_stream_duplex.js"),o.Transform=t("./lib/_stream_transform.js"),o.PassThrough=t("./lib/_stream_passthrough.js"),o.finished=t("./lib/internal/streams/end-of-stream.js"),o.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(t,r,o){var s=(function(a){var u=Object.prototype,l=u.hasOwnProperty,i=Object.defineProperty||function(A,C,j){A[C]=j.value},c=typeof Symbol=="function"?Symbol:{},p=c.iterator||"@@iterator",h=c.asyncIterator||"@@asyncIterator",f=c.toStringTag||"@@toStringTag";function g(A,C,j){return Object.defineProperty(A,C,{value:j,enumerable:!0,configurable:!0,writable:!0}),A[C]}try{g({},"")}catch{g=function(C,j,B){return C[j]=B}}function y(A,C,j,B){var O=C&&C.prototype instanceof w?C:w,H=Object.create(O.prototype),X=new E(B||[]);return i(H,"_invoke",{value:R(A,j,X)}),H}function b(A,C,j){try{return{type:"normal",arg:A.call(C,j)}}catch(B){return{type:"throw",arg:B}}}a.wrap=y;var v={};function w(){}function S(){}function N(){}var D={};g(D,p,(function(){return this}));var F=Object.getPrototypeOf,G=F&&F(F(x([])));G&&G!==u&&l.call(G,p)&&(D=G);var P=N.prototype=w.prototype=Object.create(D);function U(A){["next","throw","return"].forEach((function(C){g(A,C,(function(j){return this._invoke(C,j)}))}))}function q(A,C){var j;i(this,"_invoke",{value:function(B,O){function H(){return new C((function(X,et){(function V(tt,$,z,Z){var it=b(A[tt],A,$);if(it.type!=="throw"){var mt=it.arg,lt=mt.value;return lt&&typeof lt=="object"&&l.call(lt,"__await")?C.resolve(lt.__await).then((function(at){V("next",at,z,Z)}),(function(at){V("throw",at,z,Z)})):C.resolve(lt).then((function(at){mt.value=at,z(mt)}),(function(at){return V("throw",at,z,Z)}))}Z(it.arg)})(B,O,X,et)}))}return j=j?j.then(H,H):H()}})}function R(A,C,j){var B="suspendedStart";return function(O,H){if(B==="executing")throw new Error("Generator is already running");if(B==="completed"){if(O==="throw")throw H;return k()}for(j.method=O,j.arg=H;;){var X=j.delegate;if(X){var et=I(X,j);if(et){if(et===v)continue;return et}}if(j.method==="next")j.sent=j._sent=j.arg;else if(j.method==="throw"){if(B==="suspendedStart")throw B="completed",j.arg;j.dispatchException(j.arg)}else j.method==="return"&&j.abrupt("return",j.arg);B="executing";var V=b(A,C,j);if(V.type==="normal"){if(B=j.done?"completed":"suspendedYield",V.arg===v)continue;return{value:V.arg,done:j.done}}V.type==="throw"&&(B="completed",j.method="throw",j.arg=V.arg)}}}function I(A,C){var j=C.method,B=A.iterator[j];if(B===void 0)return C.delegate=null,j==="throw"&&A.iterator.return&&(C.method="return",C.arg=void 0,I(A,C),C.method==="throw")||j!=="return"&&(C.method="throw",C.arg=new TypeError("The iterator does not provide a '"+j+"' method")),v;var O=b(B,A.iterator,C.arg);if(O.type==="throw")return C.method="throw",C.arg=O.arg,C.delegate=null,v;var H=O.arg;return H?H.done?(C[A.resultName]=H.value,C.next=A.nextLoc,C.method!=="return"&&(C.method="next",C.arg=void 0),C.delegate=null,v):H:(C.method="throw",C.arg=new TypeError("iterator result is not an object"),C.delegate=null,v)}function T(A){var C={tryLoc:A[0]};1 in A&&(C.catchLoc=A[1]),2 in A&&(C.finallyLoc=A[2],C.afterLoc=A[3]),this.tryEntries.push(C)}function L(A){var C=A.completion||{};C.type="normal",delete C.arg,A.completion=C}function E(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(T,this),this.reset(!0)}function x(A){if(A){var C=A[p];if(C)return C.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var j=-1,B=function O(){for(;++j<A.length;)if(l.call(A,j))return O.value=A[j],O.done=!1,O;return O.value=void 0,O.done=!0,O};return B.next=B}}return{next:k}}function k(){return{value:void 0,done:!0}}return S.prototype=N,i(P,"constructor",{value:N,configurable:!0}),i(N,"constructor",{value:S,configurable:!0}),S.displayName=g(N,f,"GeneratorFunction"),a.isGeneratorFunction=function(A){var C=typeof A=="function"&&A.constructor;return!!C&&(C===S||(C.displayName||C.name)==="GeneratorFunction")},a.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,N):(A.__proto__=N,g(A,f,"GeneratorFunction")),A.prototype=Object.create(P),A},a.awrap=function(A){return{__await:A}},U(q.prototype),g(q.prototype,h,(function(){return this})),a.AsyncIterator=q,a.async=function(A,C,j,B,O){O===void 0&&(O=Promise);var H=new q(y(A,C,j,B),O);return a.isGeneratorFunction(C)?H:H.next().then((function(X){return X.done?X.value:H.next()}))},U(P),g(P,f,"Generator"),g(P,p,(function(){return this})),g(P,"toString",(function(){return"[object Generator]"})),a.keys=function(A){var C=Object(A),j=[];for(var B in C)j.push(B);return j.reverse(),function O(){for(;j.length;){var H=j.pop();if(H in C)return O.value=H,O.done=!1,O}return O.done=!0,O}},a.values=x,E.prototype={constructor:E,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!A)for(var C in this)C.charAt(0)==="t"&&l.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=void 0)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var C=this;function j(V,tt){return H.type="throw",H.arg=A,C.next=V,tt&&(C.method="next",C.arg=void 0),!!tt}for(var B=this.tryEntries.length-1;B>=0;--B){var O=this.tryEntries[B],H=O.completion;if(O.tryLoc==="root")return j("end");if(O.tryLoc<=this.prev){var X=l.call(O,"catchLoc"),et=l.call(O,"finallyLoc");if(X&&et){if(this.prev<O.catchLoc)return j(O.catchLoc,!0);if(this.prev<O.finallyLoc)return j(O.finallyLoc)}else if(X){if(this.prev<O.catchLoc)return j(O.catchLoc,!0)}else{if(!et)throw new Error("try statement without catch or finally");if(this.prev<O.finallyLoc)return j(O.finallyLoc)}}}},abrupt:function(A,C){for(var j=this.tryEntries.length-1;j>=0;--j){var B=this.tryEntries[j];if(B.tryLoc<=this.prev&&l.call(B,"finallyLoc")&&this.prev<B.finallyLoc){var O=B;break}}O&&(A==="break"||A==="continue")&&O.tryLoc<=C&&C<=O.finallyLoc&&(O=null);var H=O?O.completion:{};return H.type=A,H.arg=C,O?(this.method="next",this.next=O.finallyLoc,v):this.complete(H)},complete:function(A,C){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&C&&(this.next=C),v},finish:function(A){for(var C=this.tryEntries.length-1;C>=0;--C){var j=this.tryEntries[C];if(j.finallyLoc===A)return this.complete(j.completion,j.afterLoc),L(j),v}},catch:function(A){for(var C=this.tryEntries.length-1;C>=0;--C){var j=this.tryEntries[C];if(j.tryLoc===A){var B=j.completion;if(B.type==="throw"){var O=B.arg;L(j)}return O}}throw new Error("illegal catch attempt")},delegateYield:function(A,C,j){return this.delegate={iterator:x(A),resultName:C,nextLoc:j},this.method==="next"&&(this.arg=void 0),v}},a})(typeof r=="object"?r.exports:{});try{regeneratorRuntime=s}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=s:Function("r","regeneratorRuntime = r")(s)}},{}],493:[function(t,r,o){var s=t("buffer").Buffer,a=t("inherits"),u=t("hash-base"),l=new Array(16),i=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],c=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],p=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],h=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],f=[0,1518500249,1859775393,2400959708,2840853838],g=[1352829926,1548603684,1836072691,2053994217,0];function y(){u.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function b(F,G){return F<<G|F>>>32-G}function v(F,G,P,U,q,R,I,T){return b(F+(G^P^U)+R+I|0,T)+q|0}function w(F,G,P,U,q,R,I,T){return b(F+(G&P|~G&U)+R+I|0,T)+q|0}function S(F,G,P,U,q,R,I,T){return b(F+((G|~P)^U)+R+I|0,T)+q|0}function N(F,G,P,U,q,R,I,T){return b(F+(G&U|P&~U)+R+I|0,T)+q|0}function D(F,G,P,U,q,R,I,T){return b(F+(G^(P|~U))+R+I|0,T)+q|0}a(y,u),y.prototype._update=function(){for(var F=l,G=0;G<16;++G)F[G]=this._block.readInt32LE(4*G);for(var P=0|this._a,U=0|this._b,q=0|this._c,R=0|this._d,I=0|this._e,T=0|this._a,L=0|this._b,E=0|this._c,x=0|this._d,k=0|this._e,A=0;A<80;A+=1){var C,j;A<16?(C=v(P,U,q,R,I,F[i[A]],f[0],p[A]),j=D(T,L,E,x,k,F[c[A]],g[0],h[A])):A<32?(C=w(P,U,q,R,I,F[i[A]],f[1],p[A]),j=N(T,L,E,x,k,F[c[A]],g[1],h[A])):A<48?(C=S(P,U,q,R,I,F[i[A]],f[2],p[A]),j=S(T,L,E,x,k,F[c[A]],g[2],h[A])):A<64?(C=N(P,U,q,R,I,F[i[A]],f[3],p[A]),j=w(T,L,E,x,k,F[c[A]],g[3],h[A])):(C=D(P,U,q,R,I,F[i[A]],f[4],p[A]),j=v(T,L,E,x,k,F[c[A]],g[4],h[A])),P=I,I=R,R=b(q,10),q=U,U=C,T=k,k=x,x=b(E,10),E=L,L=j}var B=this._b+q+x|0;this._b=this._c+R+k|0,this._c=this._d+I+T|0,this._d=this._e+P+L|0,this._e=this._a+U+E|0,this._a=B},y.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var F=s.alloc?s.alloc(20):new s(20);return F.writeInt32LE(this._a,0),F.writeInt32LE(this._b,4),F.writeInt32LE(this._c,8),F.writeInt32LE(this._d,12),F.writeInt32LE(this._e,16),F},r.exports=y},{buffer:220,"hash-base":425,inherits:440}],494:[function(t,r,o){var s=t("buffer"),a=s.Buffer;function u(i,c){for(var p in i)c[p]=i[p]}function l(i,c,p){return a(i,c,p)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?r.exports=s:(u(s,o),o.Buffer=l),l.prototype=Object.create(a.prototype),u(a,l),l.from=function(i,c,p){if(typeof i=="number")throw new TypeError("Argument must not be a number");return a(i,c,p)},l.alloc=function(i,c,p){if(typeof i!="number")throw new TypeError("Argument must be a number");var h=a(i);return c!==void 0?typeof p=="string"?h.fill(c,p):h.fill(c):h.fill(0),h},l.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return a(i)},l.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s.SlowBuffer(i)}},{buffer:220}],495:[function(t,r,o){(function(s){(function(){var a,u=t("buffer"),l=u.Buffer,i={};for(a in u)u.hasOwnProperty(a)&&a!=="SlowBuffer"&&a!=="Buffer"&&(i[a]=u[a]);var c=i.Buffer={};for(a in l)l.hasOwnProperty(a)&&a!=="allocUnsafe"&&a!=="allocUnsafeSlow"&&(c[a]=l[a]);if(i.Buffer.prototype=l.prototype,c.from&&c.from!==Uint8Array.from||(c.from=function(p,h,f){if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof p);if(p&&p.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);return l(p,h,f)}),c.alloc||(c.alloc=function(p,h,f){if(typeof p!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof p);if(p<0||p>=2*(1<<30))throw new RangeError('The value "'+p+'" is invalid for option "size"');var g=l(p);return h&&h.length!==0?typeof f=="string"?g.fill(h,f):g.fill(h):g.fill(0),g}),!i.kStringMaxLength)try{i.kStringMaxLength=s.binding("buffer").kStringMaxLength}catch{}i.constants||(i.constants={MAX_LENGTH:i.kMaxLength},i.kStringMaxLength&&(i.constants.MAX_STRING_LENGTH=i.kStringMaxLength)),r.exports=i}).call(this)}).call(this,t("_process"))},{_process:467,buffer:220}],496:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0});const s=t("xmlchars/xml/1.0/ed5"),a=t("xmlchars/xml/1.1/ed2"),u=t("xmlchars/xmlns/1.0/ed3");var l=s.isS,i=s.isChar,c=s.isNameStartChar,p=s.isNameChar,h=s.S_LIST,f=s.NAME_RE,g=a.isChar,y=u.isNCNameStartChar,b=u.isNCNameChar,v=u.NC_NAME_RE;const w="http://www.w3.org/XML/1998/namespace",S="http://www.w3.org/2000/xmlns/",N={__proto__:null,xml:w,xmlns:S},D={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},F=x=>x===34||x===39,G=[34,39],P=[...G,91,62],U=[...G,60,93],q=[61,63,...h],R=[...h,62,38,60];function I(x,k,A){switch(k){case"xml":A!==w&&x.fail(`xml prefix must be bound to ${w}.`);break;case"xmlns":A!==S&&x.fail(`xmlns prefix must be bound to ${S}.`)}switch(A){case S:x.fail(k===""?`the default namespace may not be set to ${A}.`:`may not assign a prefix (even "xmlns") to the URI ${S}.`);break;case w:switch(k){case"xml":break;case"":x.fail(`the default namespace may not be set to ${A}.`);break;default:x.fail("may not assign the xml namespace to another prefix.")}}}const T=x=>v.test(x),L=x=>f.test(x);o.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const E={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};o.SaxesParser=class{constructor(x){this.opt=x??{},this.fragmentOpt=!!this.opt.fragment;const k=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,k){this.nameStartCheck=y,this.nameCheck=b,this.isName=T,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},N);const A=this.opt.additionalNamespaces;A!=null&&((function(C,j){for(const B of Object.keys(j))I(C,B,j[B])})(this,A),Object.assign(this.ns,A))}else this.nameStartCheck=c,this.nameCheck=p,this.isName=L,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var x;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:k}=this;this.state=k?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=k,this.xmlDeclPossible=!k,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:A}=this.opt;if(A===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");A="1.0"}this.setXMLVersion(A),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(D),(x=this.readyHandler)===null||x===void 0||x.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(x,k){this[E[x]]=k}off(x){this[E[x]]=void 0}makeError(x){var k;let A=(k=this.fileName)!==null&&k!==void 0?k:"";return this.trackPosition&&(A.length>0&&(A+=":"),A+=`${this.line}:${this.column}`),A.length>0&&(A+=": "),new Error(A+x)}fail(x){const k=this.makeError(x),A=this.errorHandler;if(A===void 0)throw k;return A(k),this}write(x){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let k=!1;x===null?(k=!0,x=""):typeof x=="object"&&(x=x.toString()),this.carriedFromPrevious!==void 0&&(x=`${this.carriedFromPrevious}${x}`,this.carriedFromPrevious=void 0);let A=x.length;const C=x.charCodeAt(A-1);!k&&(C===13||C>=55296&&C<=56319)&&(this.carriedFromPrevious=x[A-1],A--,x=x.slice(0,A));const{stateTable:j}=this;for(this.chunk=x,this.i=0;this.i<A;)j[this.state].call(this);return this.chunkPosition+=A,k?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:x,i:k}=this;if(this.prevI=k,this.i=k+1,k>=x.length)return-1;const A=x.charCodeAt(k);if(this.column++,A<55296){if(A>=32||A===9)return A;switch(A){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return x.charCodeAt(k+1)===10&&(this.i=k+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),A}}if(A>56319)return A>=57344&&A<=65533||this.fail("disallowed character."),A;const C=65536+1024*(A-55296)+(x.charCodeAt(k+1)-56320);return this.i=k+2,C>1114111&&this.fail("disallowed character."),C}getCode11(){const{chunk:x,i:k}=this;if(this.prevI=k,this.i=k+1,k>=x.length)return-1;const A=x.charCodeAt(k);if(this.column++,A<55296){if(A>31&&A<127||A>159&&A!==8232||A===9)return A;switch(A){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const j=x.charCodeAt(k+1);j!==10&&j!==133||(this.i=k+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),A}}if(A>56319)return A>=57344&&A<=65533||this.fail("disallowed character."),A;const C=65536+1024*(A-55296)+(x.charCodeAt(k+1)-56320);return this.i=k+2,C>1114111&&this.fail("disallowed character."),C}getCodeNorm(){const x=this.getCode();return x===-2?10:x}unget(){this.i=this.prevI,this.column--}captureTo(x){let{i:k}=this;const{chunk:A}=this;for(;;){const C=this.getCode(),j=C===-2,B=j?10:C;if(B===-1||x.includes(B))return this.text+=A.slice(k,this.prevI),B;j&&(this.text+=A.slice(k,this.prevI)+`
`,k=this.i)}}captureToChar(x){let{i:k}=this;const{chunk:A}=this;for(;;){let C=this.getCode();switch(C){case-2:this.text+=A.slice(k,this.prevI)+`
`,k=this.i,C=10;break;case-1:return this.text+=A.slice(k),!1}if(C===x)return this.text+=A.slice(k,this.prevI),!0}}captureNameChars(){const{chunk:x,i:k}=this;for(;;){const A=this.getCode();if(A===-1)return this.name+=x.slice(k),-1;if(!p(A))return this.name+=x.slice(k,this.prevI),A===-2?10:A}}skipSpaces(){for(;;){const x=this.getCodeNorm();if(x===-1||!l(x))return x}}setXMLVersion(x){this.currentXMLVersion=x,x==="1.0"?(this.isChar=i,this.getCode=this.getCode10):(this.isChar=g,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const x=this.i,k=this.skipSpaces();switch(this.prevI!==x&&(this.xmlDeclPossible=!1),k){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var x;const k=this.captureTo(P);switch(k){case 62:(x=this.doctypeHandler)===null||x===void 0||x.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(k),k===91?this.state=4:F(k)&&(this.state=3,this.q=k)}}sDoctypeQuote(){const x=this.q;this.captureToChar(x)&&(this.text+=String.fromCodePoint(x),this.q=null,this.state=2)}sDTD(){const x=this.captureTo(U);x!==-1&&(this.text+=String.fromCodePoint(x),x===93?this.state=2:x===60?this.state=6:F(x)&&(this.state=5,this.q=x))}sDTDQuoted(){const x=this.q;this.captureToChar(x)&&(this.text+=String.fromCodePoint(x),this.state=4,this.q=null)}sDTDOpenWaka(){const x=this.getCodeNorm();switch(this.text+=String.fromCodePoint(x),x){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const x=String.fromCodePoint(this.getCodeNorm()),k=this.openWakaBang+=x;this.text+=x,k!=="-"&&(this.state=k==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const x=this.getCodeNorm();this.text+=String.fromCodePoint(x),this.state=x===45?10:8}sDTDCommentEnded(){const x=this.getCodeNorm();this.text+=String.fromCodePoint(x),x===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const x=this.getCodeNorm();this.text+=String.fromCodePoint(x),x===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:x}=this;const{chunk:k}=this;t:for(;;)switch(this.getCode()){case-2:this.entity+=k.slice(x,this.prevI)+`
`,x=this.i;break;case 59:{const{entityReturnState:A}=this,C=this.entity+k.slice(x,this.prevI);let j;this.state=A,C===""?(this.fail("empty entity name."),j="&;"):(j=this.parseEntity(C),this.entity=""),A===13&&this.textHandler===void 0||(this.text+=j);break t}case-1:this.entity+=k.slice(x);break t}}sOpenWaka(){const x=this.getCode();if(c(x))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(x){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var x;const k=this.getCodeNorm();k===45?(this.state=19,(x=this.commentHandler)===null||x===void 0||x.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(k),this.state=17)}sCommentEnded(){const x=this.getCodeNorm();x!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(x),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const x=this.getCodeNorm();x===93?this.state=22:(this.text+="]"+String.fromCodePoint(x),this.state=20)}sCDataEnding2(){var x;const k=this.getCodeNorm();switch(k){case 62:(x=this.cdataHandler)===null||x===void 0||x.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(k),this.state=20}}sPIFirstChar(){const x=this.getCodeNorm();this.nameStartCheck(x)?(this.piTarget+=String.fromCodePoint(x),this.state=24):x===63||l(x)?(this.fail("processing instruction without a target."),this.state=x===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(x),this.state=24)}sPIRest(){const{chunk:x,i:k}=this;for(;;){const A=this.getCodeNorm();if(A===-1)return void(this.piTarget+=x.slice(k));if(!this.nameCheck(A)){this.piTarget+=x.slice(k,this.prevI);const C=A===63;C||l(A)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=C?33:27):this.state=C?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(A));break}}}sPIBody(){if(this.text.length===0){const x=this.getCodeNorm();x===63?this.state=26:l(x)||(this.text=String.fromCodePoint(x))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var x;const k=this.getCodeNorm();if(k===62){const{piTarget:A}=this;A.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(x=this.piHandler)===null||x===void 0||x.call(this,{target:A,body:this.text}),this.piTarget=this.text="",this.state=13}else k===63?this.text+="?":(this.text+="?"+String.fromCodePoint(k),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const x=this.skipSpaces();x!==63?x!==-1&&(this.state=28,this.name=String.fromCodePoint(x)):this.state=33}sXMLDeclName(){const x=this.captureTo(q);if(x===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(l(x)||x===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=x===61?30:29}}sXMLDeclEq(){const x=this.getCodeNorm();if(x===63)return this.state=33,void this.fail("XML declaration is incomplete.");l(x)||(x!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const x=this.getCodeNorm();if(x===63)return this.state=33,void this.fail("XML declaration is incomplete.");l(x)||(F(x)?this.q=x:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const x=this.captureTo([this.q,63]);if(x===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(x===-1)return;const k=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const A=k;this.xmlDecl.version=A,/^1\.[0-9]+$/.test(A)?this.opt.forceXMLVersion||this.setXMLVersion(A):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(k)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=k;break;case"standalone":k!=="yes"&&k!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=k}this.name="",this.state=32}sXMLDeclSeparator(){const x=this.getCodeNorm();x!==63?(l(x)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var x;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(x=this.xmldeclHandler)===null||x===void 0||x.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var x;const k=this.captureNameChars();if(k===-1)return;const A=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=A.ns=Object.create(null)),(x=this.openTagStartHandler)===null||x===void 0||x.call(this,A),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),k){case 62:this.openTag();break;case 47:this.state=35;break;default:l(k)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const x=this.skipSpaces();x!==-1&&(c(x)?(this.unget(),this.state=37):x===62?this.openTag():x===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const x=this.captureNameChars();x===61?this.state=39:l(x)?this.state=38:x===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):x!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const x=this.skipSpaces();switch(x){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",x===62?this.openTag():c(x)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const x=this.getCodeNorm();F(x)?(this.q=x,this.state=40):l(x)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:x,chunk:k}=this;let{i:A}=this;for(;;)switch(this.getCode()){case x:return this.pushAttrib(this.name,this.text+k.slice(A,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=k.slice(A,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=k.slice(A,this.prevI)+" ",A=this.i;break;case 60:return this.text+=k.slice(A,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=k.slice(A))}}sAttribValueClosed(){const x=this.getCodeNorm();l(x)?this.state=36:x===62?this.openTag():x===47?this.state=35:c(x)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const x=this.captureTo(R);switch(x){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",x===62?this.openTag():this.state=36}}sCloseTag(){const x=this.captureNameChars();x===62?this.closeTag():l(x)?this.state=44:x!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:x,forbiddenState:k}=this;const{chunk:A,textHandler:C}=this;t:for(;;)switch(this.getCode()){case 60:if(this.state=15,C!==void 0){const{text:j}=this,B=A.slice(x,this.prevI);j.length!==0?(C(j+B),this.text=""):B.length!==0&&C(B)}k=0;break t;case 38:this.state=14,this.entityReturnState=13,C!==void 0&&(this.text+=A.slice(x,this.prevI)),k=0;break t;case 93:switch(k){case 0:k=1;break;case 1:k=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:k===2&&this.fail('the string "]]>" is disallowed in char data.'),k=0;break;case-2:C!==void 0&&(this.text+=A.slice(x,this.prevI)+`
`),x=this.i,k=0;break;case-1:C!==void 0&&(this.text+=A.slice(x));break t;default:k=0}this.forbiddenState=k}handleTextOutsideRoot(){let{i:x}=this;const{chunk:k,textHandler:A}=this;let C=!1;t:for(;;){const j=this.getCode();switch(j){case 60:if(this.state=15,A!==void 0){const{text:B}=this,O=k.slice(x,this.prevI);B.length!==0?(A(B+O),this.text=""):O.length!==0&&A(O)}break t;case 38:this.state=14,this.entityReturnState=13,A!==void 0&&(this.text+=k.slice(x,this.prevI)),C=!0;break t;case-2:A!==void 0&&(this.text+=k.slice(x,this.prevI)+`
`),x=this.i;break;case-1:A!==void 0&&(this.text+=k.slice(x));break t;default:l(j)||(C=!0)}}C&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(x,k){var A;const{prefix:C,local:j}=this.qname(x),B={name:x,prefix:C,local:j,value:k};if(this.attribList.push(B),(A=this.attributeHandler)===null||A===void 0||A.call(this,B),C==="xmlns"){const O=k.trim();this.currentXMLVersion==="1.0"&&O===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[j]=O,I(this,j,O)}else if(x==="xmlns"){const O=k.trim();this.topNS[""]=O,I(this,"",O)}}pushAttribPlain(x,k){var A;const C={name:x,value:k};this.attribList.push(C),(A=this.attributeHandler)===null||A===void 0||A.call(this,C)}end(){var x,k;this.sawRoot||this.fail("document must contain a root element.");const{tags:A}=this;for(;A.length>0;){const j=A.pop();this.fail("unclosed tag: "+j.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:C}=this;return C.length!==0&&((x=this.textHandler)===null||x===void 0||x.call(this,C),this.text=""),this._closed=!0,(k=this.endHandler)===null||k===void 0||k.call(this),this._init(),this}resolve(x){var k,A;let C=this.topNS[x];if(C!==void 0)return C;const{tags:j}=this;for(let B=j.length-1;B>=0;B--)if(C=j[B].ns[x],C!==void 0)return C;return C=this.ns[x],C!==void 0?C:(A=(k=this.opt).resolvePrefix)===null||A===void 0?void 0:A.call(k,x)}qname(x){const k=x.indexOf(":");if(k===-1)return{prefix:"",local:x};const A=x.slice(k+1),C=x.slice(0,k);return(C===""||A===""||A.includes(":"))&&this.fail(`malformed name: ${x}.`),{prefix:C,local:A}}processAttribsNS(){var x;const{attribList:k}=this,A=this.tag;{const{prefix:B,local:O}=this.qname(A.name);A.prefix=B,A.local=O;const H=A.uri=(x=this.resolve(B))!==null&&x!==void 0?x:"";B!==""&&(B==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),H===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(B)}.`),A.uri=B))}if(k.length===0)return;const{attributes:C}=A,j=new Set;for(const B of k){const{name:O,prefix:H,local:X}=B;let et,V;H===""?(et=O==="xmlns"?S:"",V=O):(et=this.resolve(H),et===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(H)}.`),et=H),V=`{${et}}${X}`),j.has(V)&&this.fail(`duplicate attribute: ${V}.`),j.add(V),B.uri=et,C[O]=B}this.attribList=[]}processAttribsPlain(){const{attribList:x}=this,k=this.tag.attributes;for(const{name:A,value:C}of x)k[A]!==void 0&&this.fail(`duplicate attribute: ${A}.`),k[A]=C;this.attribList=[]}openTag(){var x;this.processAttribs();const{tags:k}=this,A=this.tag;A.isSelfClosing=!1,(x=this.openTagHandler)===null||x===void 0||x.call(this,A),k.push(A),this.state=13,this.name=""}openSelfClosingTag(){var x,k,A;this.processAttribs();const{tags:C}=this,j=this.tag;j.isSelfClosing=!0,(x=this.openTagHandler)===null||x===void 0||x.call(this,j),(k=this.closeTagHandler)===null||k===void 0||k.call(this,j),(this.tag=(A=C[C.length-1])!==null&&A!==void 0?A:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:x,name:k}=this;if(this.state=13,this.name="",k==="")return this.fail("weird empty close tag."),void(this.text+="</>");const A=this.closeTagHandler;let C=x.length;for(;C-- >0;){const j=this.tag=x.pop();if(this.topNS=j.ns,A?.(j),j.name===k)break;this.fail("unexpected close tag.")}C===0?this.closedRoot=!0:C<0&&(this.fail(`unmatched closing tag: ${k}.`),this.text+=`</${k}>`)}parseEntity(x){if(x[0]!=="#"){const A=this.ENTITIES[x];return A!==void 0?A:(this.fail(this.isName(x)?"undefined entity.":"disallowed character in entity name."),`&${x};`)}let k=NaN;return x[1]==="x"&&/^#x[0-9a-f]+$/i.test(x)?k=parseInt(x.slice(2),16):/^#[0-9]+$/.test(x)&&(k=parseInt(x.slice(1),10)),this.isChar(k)?String.fromCodePoint(k):(this.fail("malformed character entity."),`&${x};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(t,r,o){var s=t("safe-buffer").Buffer;function a(u,l){this._block=s.alloc(u),this._finalSize=l,this._blockSize=u,this._len=0}a.prototype.update=function(u,l){typeof u=="string"&&(l=l||"utf8",u=s.from(u,l));for(var i=this._block,c=this._blockSize,p=u.length,h=this._len,f=0;f<p;){for(var g=h%c,y=Math.min(p-f,c-g),b=0;b<y;b++)i[g+b]=u[f+b];f+=y,(h+=y)%c==0&&this._update(i)}return this._len+=p,this},a.prototype.digest=function(u){var l=this._len%this._blockSize;this._block[l]=128,this._block.fill(0,l+1),l>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=8*this._len;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var c=(4294967295&i)>>>0,p=(i-c)/4294967296;this._block.writeUInt32BE(p,this._blockSize-8),this._block.writeUInt32BE(c,this._blockSize-4)}this._update(this._block);var h=this._hash();return u?h.toString(u):h},a.prototype._update=function(){throw new Error("_update must be implemented by subclass")},r.exports=a},{"safe-buffer":494}],498:[function(t,r,o){var s=r.exports=function(a){a=a.toLowerCase();var u=s[a];if(!u)throw new Error(a+" is not supported (we accept pull requests)");return new u};s.sha=t("./sha"),s.sha1=t("./sha1"),s.sha224=t("./sha224"),s.sha256=t("./sha256"),s.sha384=t("./sha384"),s.sha512=t("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(t,r,o){var s=t("inherits"),a=t("./hash"),u=t("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function c(){this.init(),this._w=i,a.call(this,64,56)}function p(f){return f<<30|f>>>2}function h(f,g,y,b){return f===0?g&y|~g&b:f===2?g&y|g&b|y&b:g^y^b}s(c,a),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(f){for(var g,y=this._w,b=0|this._a,v=0|this._b,w=0|this._c,S=0|this._d,N=0|this._e,D=0;D<16;++D)y[D]=f.readInt32BE(4*D);for(;D<80;++D)y[D]=y[D-3]^y[D-8]^y[D-14]^y[D-16];for(var F=0;F<80;++F){var G=~~(F/20),P=0|((g=b)<<5|g>>>27)+h(G,v,w,S)+N+y[F]+l[G];N=S,S=w,w=p(v),v=b,b=P}this._a=b+this._a|0,this._b=v+this._b|0,this._c=w+this._c|0,this._d=S+this._d|0,this._e=N+this._e|0},c.prototype._hash=function(){var f=u.allocUnsafe(20);return f.writeInt32BE(0|this._a,0),f.writeInt32BE(0|this._b,4),f.writeInt32BE(0|this._c,8),f.writeInt32BE(0|this._d,12),f.writeInt32BE(0|this._e,16),f},r.exports=c},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(t,r,o){var s=t("inherits"),a=t("./hash"),u=t("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function c(){this.init(),this._w=i,a.call(this,64,56)}function p(g){return g<<5|g>>>27}function h(g){return g<<30|g>>>2}function f(g,y,b,v){return g===0?y&b|~y&v:g===2?y&b|y&v|b&v:y^b^v}s(c,a),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(g){for(var y,b=this._w,v=0|this._a,w=0|this._b,S=0|this._c,N=0|this._d,D=0|this._e,F=0;F<16;++F)b[F]=g.readInt32BE(4*F);for(;F<80;++F)b[F]=(y=b[F-3]^b[F-8]^b[F-14]^b[F-16])<<1|y>>>31;for(var G=0;G<80;++G){var P=~~(G/20),U=p(v)+f(P,w,S,N)+D+b[G]+l[P]|0;D=N,N=S,S=h(w),w=v,v=U}this._a=v+this._a|0,this._b=w+this._b|0,this._c=S+this._c|0,this._d=N+this._d|0,this._e=D+this._e|0},c.prototype._hash=function(){var g=u.allocUnsafe(20);return g.writeInt32BE(0|this._a,0),g.writeInt32BE(0|this._b,4),g.writeInt32BE(0|this._c,8),g.writeInt32BE(0|this._d,12),g.writeInt32BE(0|this._e,16),g},r.exports=c},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(t,r,o){var s=t("inherits"),a=t("./sha256"),u=t("./hash"),l=t("safe-buffer").Buffer,i=new Array(64);function c(){this.init(),this._w=i,u.call(this,64,56)}s(c,a),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var p=l.allocUnsafe(28);return p.writeInt32BE(this._a,0),p.writeInt32BE(this._b,4),p.writeInt32BE(this._c,8),p.writeInt32BE(this._d,12),p.writeInt32BE(this._e,16),p.writeInt32BE(this._f,20),p.writeInt32BE(this._g,24),p},r.exports=c},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(t,r,o){var s=t("inherits"),a=t("./hash"),u=t("safe-buffer").Buffer,l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=new Array(64);function c(){this.init(),this._w=i,a.call(this,64,56)}function p(b,v,w){return w^b&(v^w)}function h(b,v,w){return b&v|w&(b|v)}function f(b){return(b>>>2|b<<30)^(b>>>13|b<<19)^(b>>>22|b<<10)}function g(b){return(b>>>6|b<<26)^(b>>>11|b<<21)^(b>>>25|b<<7)}function y(b){return(b>>>7|b<<25)^(b>>>18|b<<14)^b>>>3}s(c,a),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(b){for(var v,w=this._w,S=0|this._a,N=0|this._b,D=0|this._c,F=0|this._d,G=0|this._e,P=0|this._f,U=0|this._g,q=0|this._h,R=0;R<16;++R)w[R]=b.readInt32BE(4*R);for(;R<64;++R)w[R]=0|(((v=w[R-2])>>>17|v<<15)^(v>>>19|v<<13)^v>>>10)+w[R-7]+y(w[R-15])+w[R-16];for(var I=0;I<64;++I){var T=q+g(G)+p(G,P,U)+l[I]+w[I]|0,L=f(S)+h(S,N,D)|0;q=U,U=P,P=G,G=F+T|0,F=D,D=N,N=S,S=T+L|0}this._a=S+this._a|0,this._b=N+this._b|0,this._c=D+this._c|0,this._d=F+this._d|0,this._e=G+this._e|0,this._f=P+this._f|0,this._g=U+this._g|0,this._h=q+this._h|0},c.prototype._hash=function(){var b=u.allocUnsafe(32);return b.writeInt32BE(this._a,0),b.writeInt32BE(this._b,4),b.writeInt32BE(this._c,8),b.writeInt32BE(this._d,12),b.writeInt32BE(this._e,16),b.writeInt32BE(this._f,20),b.writeInt32BE(this._g,24),b.writeInt32BE(this._h,28),b},r.exports=c},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(t,r,o){var s=t("inherits"),a=t("./sha512"),u=t("./hash"),l=t("safe-buffer").Buffer,i=new Array(160);function c(){this.init(),this._w=i,u.call(this,128,112)}s(c,a),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var p=l.allocUnsafe(48);function h(f,g,y){p.writeInt32BE(f,y),p.writeInt32BE(g,y+4)}return h(this._ah,this._al,0),h(this._bh,this._bl,8),h(this._ch,this._cl,16),h(this._dh,this._dl,24),h(this._eh,this._el,32),h(this._fh,this._fl,40),p},r.exports=c},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(t,r,o){var s=t("inherits"),a=t("./hash"),u=t("safe-buffer").Buffer,l=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],i=new Array(160);function c(){this.init(),this._w=i,a.call(this,128,112)}function p(N,D,F){return F^N&(D^F)}function h(N,D,F){return N&D|F&(N|D)}function f(N,D){return(N>>>28|D<<4)^(D>>>2|N<<30)^(D>>>7|N<<25)}function g(N,D){return(N>>>14|D<<18)^(N>>>18|D<<14)^(D>>>9|N<<23)}function y(N,D){return(N>>>1|D<<31)^(N>>>8|D<<24)^N>>>7}function b(N,D){return(N>>>1|D<<31)^(N>>>8|D<<24)^(N>>>7|D<<25)}function v(N,D){return(N>>>19|D<<13)^(D>>>29|N<<3)^N>>>6}function w(N,D){return(N>>>19|D<<13)^(D>>>29|N<<3)^(N>>>6|D<<26)}function S(N,D){return N>>>0<D>>>0?1:0}s(c,a),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(N){for(var D=this._w,F=0|this._ah,G=0|this._bh,P=0|this._ch,U=0|this._dh,q=0|this._eh,R=0|this._fh,I=0|this._gh,T=0|this._hh,L=0|this._al,E=0|this._bl,x=0|this._cl,k=0|this._dl,A=0|this._el,C=0|this._fl,j=0|this._gl,B=0|this._hl,O=0;O<32;O+=2)D[O]=N.readInt32BE(4*O),D[O+1]=N.readInt32BE(4*O+4);for(;O<160;O+=2){var H=D[O-30],X=D[O-30+1],et=y(H,X),V=b(X,H),tt=v(H=D[O-4],X=D[O-4+1]),$=w(X,H),z=D[O-14],Z=D[O-14+1],it=D[O-32],mt=D[O-32+1],lt=V+Z|0,at=et+z+S(lt,V)|0;at=(at=at+tt+S(lt=lt+$|0,$)|0)+it+S(lt=lt+mt|0,mt)|0,D[O]=at,D[O+1]=lt}for(var rt=0;rt<160;rt+=2){at=D[rt],lt=D[rt+1];var ct=h(F,G,P),ot=h(L,E,x),dt=f(F,L),ft=f(L,F),gt=g(q,A),wt=g(A,q),yt=l[rt],Et=l[rt+1],Mt=p(q,R,I),qt=p(A,C,j),Tt=B+wt|0,It=T+gt+S(Tt,B)|0;It=(It=(It=It+Mt+S(Tt=Tt+qt|0,qt)|0)+yt+S(Tt=Tt+Et|0,Et)|0)+at+S(Tt=Tt+lt|0,lt)|0;var Vt=ft+ot|0,Kt=dt+ct+S(Vt,ft)|0;T=I,B=j,I=R,j=C,R=q,C=A,q=U+It+S(A=k+Tt|0,k)|0,U=P,k=x,P=G,x=E,G=F,E=L,F=It+Kt+S(L=Tt+Vt|0,Tt)|0}this._al=this._al+L|0,this._bl=this._bl+E|0,this._cl=this._cl+x|0,this._dl=this._dl+k|0,this._el=this._el+A|0,this._fl=this._fl+C|0,this._gl=this._gl+j|0,this._hl=this._hl+B|0,this._ah=this._ah+F+S(this._al,L)|0,this._bh=this._bh+G+S(this._bl,E)|0,this._ch=this._ch+P+S(this._cl,x)|0,this._dh=this._dh+U+S(this._dl,k)|0,this._eh=this._eh+q+S(this._el,A)|0,this._fh=this._fh+R+S(this._fl,C)|0,this._gh=this._gh+I+S(this._gl,j)|0,this._hh=this._hh+T+S(this._hl,B)|0},c.prototype._hash=function(){var N=u.allocUnsafe(64);function D(F,G,P){N.writeInt32BE(F,P),N.writeInt32BE(G,P+4)}return D(this._ah,this._al,0),D(this._bh,this._bl,8),D(this._ch,this._cl,16),D(this._dh,this._dl,24),D(this._eh,this._el,32),D(this._fh,this._fl,40),D(this._gh,this._gl,48),D(this._hh,this._hl,56),N},r.exports=c},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(t,r,o){r.exports=a;var s=t("events").EventEmitter;function a(){s.call(this)}t("inherits")(a,s),a.Readable=t("readable-stream/readable.js"),a.Writable=t("readable-stream/writable.js"),a.Duplex=t("readable-stream/duplex.js"),a.Transform=t("readable-stream/transform.js"),a.PassThrough=t("readable-stream/passthrough.js"),a.Stream=a,a.prototype.pipe=function(u,l){var i=this;function c(v){u.writable&&u.write(v)===!1&&i.pause&&i.pause()}function p(){i.readable&&i.resume&&i.resume()}i.on("data",c),u.on("drain",p),u._isStdio||l&&l.end===!1||(i.on("end",f),i.on("close",g));var h=!1;function f(){h||(h=!0,u.end())}function g(){h||(h=!0,typeof u.destroy=="function"&&u.destroy())}function y(v){if(b(),s.listenerCount(this,"error")===0)throw v}function b(){i.removeListener("data",c),u.removeListener("drain",p),i.removeListener("end",f),i.removeListener("close",g),i.removeListener("error",y),u.removeListener("error",y),i.removeListener("end",b),i.removeListener("close",b),u.removeListener("close",b)}return i.on("error",y),u.on("error",y),i.on("end",b),i.on("close",b),u.on("close",b),u.emit("pipe",i),u}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(t,r,o){var s={}.toString;r.exports=Array.isArray||function(a){return s.call(a)=="[object Array]"}},{}],507:[function(t,r,o){r.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(t,r,o){var s=t("process-nextick-args"),a=Object.keys||function(b){var v=[];for(var w in b)v.push(w);return v};r.exports=f;var u=Object.create(t("core-util-is"));u.inherits=t("inherits");var l=t("./_stream_readable"),i=t("./_stream_writable");u.inherits(f,l);for(var c=a(i.prototype),p=0;p<c.length;p++){var h=c[p];f.prototype[h]||(f.prototype[h]=i.prototype[h])}function f(b){if(!(this instanceof f))return new f(b);l.call(this,b),i.call(this,b),b&&b.readable===!1&&(this.readable=!1),b&&b.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,b&&b.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",g)}function g(){this.allowHalfOpen||this._writableState.ended||s.nextTick(y,this)}function y(b){b.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=b,this._writableState.destroyed=b)}}),f.prototype._destroy=function(b,v){this.push(null),this.end(),s.nextTick(v,b)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(t,r,o){r.exports=u;var s=t("./_stream_transform"),a=Object.create(t("core-util-is"));function u(l){if(!(this instanceof u))return new u(l);s.call(this,l)}a.inherits=t("inherits"),a.inherits(u,s),u.prototype._transform=function(l,i,c){c(null,l)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(t,r,o){(function(s,a){(function(){var u=t("process-nextick-args");r.exports=F;var l,i=t("isarray");F.ReadableState=D,t("events").EventEmitter;var c=function(B,O){return B.listeners(O).length},p=t("./internal/streams/stream"),h=t("safe-buffer").Buffer,f=(a!==void 0?a:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},g=Object.create(t("core-util-is"));g.inherits=t("inherits");var y=t("util"),b=void 0;b=y&&y.debuglog?y.debuglog("stream"):function(){};var v,w=t("./internal/streams/BufferList"),S=t("./internal/streams/destroy");g.inherits(F,p);var N=["error","close","destroy","pause","resume"];function D(B,O){B=B||{};var H=O instanceof(l=l||t("./_stream_duplex"));this.objectMode=!!B.objectMode,H&&(this.objectMode=this.objectMode||!!B.readableObjectMode);var X=B.highWaterMark,et=B.readableHighWaterMark,V=this.objectMode?16:16384;this.highWaterMark=X||X===0?X:H&&(et||et===0)?et:V,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new w,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=B.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,B.encoding&&(v||(v=t("string_decoder/").StringDecoder),this.decoder=new v(B.encoding),this.encoding=B.encoding)}function F(B){if(l=l||t("./_stream_duplex"),!(this instanceof F))return new F(B);this._readableState=new D(B,this),this.readable=!0,B&&(typeof B.read=="function"&&(this._read=B.read),typeof B.destroy=="function"&&(this._destroy=B.destroy)),p.call(this)}function G(B,O,H,X,et){var V,tt=B._readableState;return O===null?(tt.reading=!1,(function($,z){if(!z.ended){if(z.decoder){var Z=z.decoder.end();Z&&Z.length&&(z.buffer.push(Z),z.length+=z.objectMode?1:Z.length)}z.ended=!0,q($)}})(B,tt)):(et||(V=(function($,z){var Z;it=z,h.isBuffer(it)||it instanceof f||typeof z=="string"||z===void 0||$.objectMode||(Z=new TypeError("Invalid non-string/buffer chunk"));var it;return Z})(tt,O)),V?B.emit("error",V):tt.objectMode||O&&O.length>0?(typeof O=="string"||tt.objectMode||Object.getPrototypeOf(O)===h.prototype||(O=(function($){return h.from($)})(O)),X?tt.endEmitted?B.emit("error",new Error("stream.unshift() after end event")):P(B,tt,O,!0):tt.ended?B.emit("error",new Error("stream.push() after EOF")):(tt.reading=!1,tt.decoder&&!H?(O=tt.decoder.write(O),tt.objectMode||O.length!==0?P(B,tt,O,!1):I(B,tt)):P(B,tt,O,!1))):X||(tt.reading=!1)),(function($){return!$.ended&&($.needReadable||$.length<$.highWaterMark||$.length===0)})(tt)}function P(B,O,H,X){O.flowing&&O.length===0&&!O.sync?(B.emit("data",H),B.read(0)):(O.length+=O.objectMode?1:H.length,X?O.buffer.unshift(H):O.buffer.push(H),O.needReadable&&q(B)),I(B,O)}Object.defineProperty(F.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),F.prototype.destroy=S.destroy,F.prototype._undestroy=S.undestroy,F.prototype._destroy=function(B,O){this.push(null),O(B)},F.prototype.push=function(B,O){var H,X=this._readableState;return X.objectMode?H=!0:typeof B=="string"&&((O=O||X.defaultEncoding)!==X.encoding&&(B=h.from(B,O),O=""),H=!0),G(this,B,O,!1,H)},F.prototype.unshift=function(B){return G(this,B,null,!0,!1)},F.prototype.isPaused=function(){return this._readableState.flowing===!1},F.prototype.setEncoding=function(B){return v||(v=t("string_decoder/").StringDecoder),this._readableState.decoder=new v(B),this._readableState.encoding=B,this};function U(B,O){return B<=0||O.length===0&&O.ended?0:O.objectMode?1:B!=B?O.flowing&&O.length?O.buffer.head.data.length:O.length:(B>O.highWaterMark&&(O.highWaterMark=(function(H){return H>=8388608?H=8388608:(H--,H|=H>>>1,H|=H>>>2,H|=H>>>4,H|=H>>>8,H|=H>>>16,H++),H})(B)),B<=O.length?B:O.ended?O.length:(O.needReadable=!0,0))}function q(B){var O=B._readableState;O.needReadable=!1,O.emittedReadable||(b("emitReadable",O.flowing),O.emittedReadable=!0,O.sync?u.nextTick(R,B):R(B))}function R(B){b("emit readable"),B.emit("readable"),x(B)}function I(B,O){O.readingMore||(O.readingMore=!0,u.nextTick(T,B,O))}function T(B,O){for(var H=O.length;!O.reading&&!O.flowing&&!O.ended&&O.length<O.highWaterMark&&(b("maybeReadMore read 0"),B.read(0),H!==O.length);)H=O.length;O.readingMore=!1}function L(B){b("readable nexttick read 0"),B.read(0)}function E(B,O){O.reading||(b("resume read 0"),B.read(0)),O.resumeScheduled=!1,O.awaitDrain=0,B.emit("resume"),x(B),O.flowing&&!O.reading&&B.read(0)}function x(B){var O=B._readableState;for(b("flow",O.flowing);O.flowing&&B.read()!==null;);}function k(B,O){return O.length===0?null:(O.objectMode?H=O.buffer.shift():!B||B>=O.length?(H=O.decoder?O.buffer.join(""):O.buffer.length===1?O.buffer.head.data:O.buffer.concat(O.length),O.buffer.clear()):H=(function(X,et,V){var tt;return X<et.head.data.length?(tt=et.head.data.slice(0,X),et.head.data=et.head.data.slice(X)):tt=X===et.head.data.length?et.shift():V?(function($,z){var Z=z.head,it=1,mt=Z.data;for($-=mt.length;Z=Z.next;){var lt=Z.data,at=$>lt.length?lt.length:$;if(at===lt.length?mt+=lt:mt+=lt.slice(0,$),($-=at)===0){at===lt.length?(++it,Z.next?z.head=Z.next:z.head=z.tail=null):(z.head=Z,Z.data=lt.slice(at));break}++it}return z.length-=it,mt})(X,et):(function($,z){var Z=h.allocUnsafe($),it=z.head,mt=1;for(it.data.copy(Z),$-=it.data.length;it=it.next;){var lt=it.data,at=$>lt.length?lt.length:$;if(lt.copy(Z,Z.length-$,0,at),($-=at)===0){at===lt.length?(++mt,it.next?z.head=it.next:z.head=z.tail=null):(z.head=it,it.data=lt.slice(at));break}++mt}return z.length-=mt,Z})(X,et),tt})(B,O.buffer,O.decoder),H);var H}function A(B){var O=B._readableState;if(O.length>0)throw new Error('"endReadable()" called on non-empty stream');O.endEmitted||(O.ended=!0,u.nextTick(C,O,B))}function C(B,O){B.endEmitted||B.length!==0||(B.endEmitted=!0,O.readable=!1,O.emit("end"))}function j(B,O){for(var H=0,X=B.length;H<X;H++)if(B[H]===O)return H;return-1}F.prototype.read=function(B){b("read",B),B=parseInt(B,10);var O=this._readableState,H=B;if(B!==0&&(O.emittedReadable=!1),B===0&&O.needReadable&&(O.length>=O.highWaterMark||O.ended))return b("read: emitReadable",O.length,O.ended),O.length===0&&O.ended?A(this):q(this),null;if((B=U(B,O))===0&&O.ended)return O.length===0&&A(this),null;var X,et=O.needReadable;return b("need readable",et),(O.length===0||O.length-B<O.highWaterMark)&&b("length less than watermark",et=!0),O.ended||O.reading?b("reading or ended",et=!1):et&&(b("do read"),O.reading=!0,O.sync=!0,O.length===0&&(O.needReadable=!0),this._read(O.highWaterMark),O.sync=!1,O.reading||(B=U(H,O))),(X=B>0?k(B,O):null)===null?(O.needReadable=!0,B=0):O.length-=B,O.length===0&&(O.ended||(O.needReadable=!0),H!==B&&O.ended&&A(this)),X!==null&&this.emit("data",X),X},F.prototype._read=function(B){this.emit("error",new Error("_read() is not implemented"))},F.prototype.pipe=function(B,O){var H=this,X=this._readableState;switch(X.pipesCount){case 0:X.pipes=B;break;case 1:X.pipes=[X.pipes,B];break;default:X.pipes.push(B)}X.pipesCount+=1,b("pipe count=%d opts=%j",X.pipesCount,O);var et=(!O||O.end!==!1)&&B!==s.stdout&&B!==s.stderr?tt:rt;function V(ct,ot){b("onunpipe"),ct===H&&ot&&ot.hasUnpiped===!1&&(ot.hasUnpiped=!0,b("cleanup"),B.removeListener("close",lt),B.removeListener("finish",at),B.removeListener("drain",$),B.removeListener("error",mt),B.removeListener("unpipe",V),H.removeListener("end",tt),H.removeListener("end",rt),H.removeListener("data",it),z=!0,!X.awaitDrain||B._writableState&&!B._writableState.needDrain||$())}function tt(){b("onend"),B.end()}X.endEmitted?u.nextTick(et):H.once("end",et),B.on("unpipe",V);var $=(function(ct){return function(){var ot=ct._readableState;b("pipeOnDrain",ot.awaitDrain),ot.awaitDrain&&ot.awaitDrain--,ot.awaitDrain===0&&c(ct,"data")&&(ot.flowing=!0,x(ct))}})(H);B.on("drain",$);var z=!1,Z=!1;function it(ct){b("ondata"),Z=!1,B.write(ct)!==!1||Z||((X.pipesCount===1&&X.pipes===B||X.pipesCount>1&&j(X.pipes,B)!==-1)&&!z&&(b("false write response, pause",X.awaitDrain),X.awaitDrain++,Z=!0),H.pause())}function mt(ct){b("onerror",ct),rt(),B.removeListener("error",mt),c(B,"error")===0&&B.emit("error",ct)}function lt(){B.removeListener("finish",at),rt()}function at(){b("onfinish"),B.removeListener("close",lt),rt()}function rt(){b("unpipe"),H.unpipe(B)}return H.on("data",it),(function(ct,ot,dt){if(typeof ct.prependListener=="function")return ct.prependListener(ot,dt);ct._events&&ct._events[ot]?i(ct._events[ot])?ct._events[ot].unshift(dt):ct._events[ot]=[dt,ct._events[ot]]:ct.on(ot,dt)})(B,"error",mt),B.once("close",lt),B.once("finish",at),B.emit("pipe",H),X.flowing||(b("pipe resume"),H.resume()),B},F.prototype.unpipe=function(B){var O=this._readableState,H={hasUnpiped:!1};if(O.pipesCount===0)return this;if(O.pipesCount===1)return B&&B!==O.pipes||(B||(B=O.pipes),O.pipes=null,O.pipesCount=0,O.flowing=!1,B&&B.emit("unpipe",this,H)),this;if(!B){var X=O.pipes,et=O.pipesCount;O.pipes=null,O.pipesCount=0,O.flowing=!1;for(var V=0;V<et;V++)X[V].emit("unpipe",this,{hasUnpiped:!1});return this}var tt=j(O.pipes,B);return tt===-1||(O.pipes.splice(tt,1),O.pipesCount-=1,O.pipesCount===1&&(O.pipes=O.pipes[0]),B.emit("unpipe",this,H)),this},F.prototype.on=function(B,O){var H=p.prototype.on.call(this,B,O);if(B==="data")this._readableState.flowing!==!1&&this.resume();else if(B==="readable"){var X=this._readableState;X.endEmitted||X.readableListening||(X.readableListening=X.needReadable=!0,X.emittedReadable=!1,X.reading?X.length&&q(this):u.nextTick(L,this))}return H},F.prototype.addListener=F.prototype.on,F.prototype.resume=function(){var B=this._readableState;return B.flowing||(b("resume"),B.flowing=!0,(function(O,H){H.resumeScheduled||(H.resumeScheduled=!0,u.nextTick(E,O,H))})(this,B)),this},F.prototype.pause=function(){return b("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(b("pause"),this._readableState.flowing=!1,this.emit("pause")),this},F.prototype.wrap=function(B){var O=this,H=this._readableState,X=!1;for(var et in B.on("end",(function(){if(b("wrapped end"),H.decoder&&!H.ended){var tt=H.decoder.end();tt&&tt.length&&O.push(tt)}O.push(null)})),B.on("data",(function(tt){b("wrapped data"),H.decoder&&(tt=H.decoder.write(tt)),H.objectMode&&tt==null||(H.objectMode||tt&&tt.length)&&(O.push(tt)||(X=!0,B.pause()))})),B)this[et]===void 0&&typeof B[et]=="function"&&(this[et]=(function(tt){return function(){return B[tt].apply(B,arguments)}})(et));for(var V=0;V<N.length;V++)B.on(N[V],this.emit.bind(this,N[V]));return this._read=function(tt){b("wrapped _read",tt),X&&(X=!1,B.resume())},this},Object.defineProperty(F.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),F._fromList=k}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(t,r,o){r.exports=l;var s=t("./_stream_duplex"),a=Object.create(t("core-util-is"));function u(p,h){var f=this._transformState;f.transforming=!1;var g=f.writecb;if(!g)return this.emit("error",new Error("write callback called multiple times"));f.writechunk=null,f.writecb=null,h!=null&&this.push(h),g(p);var y=this._readableState;y.reading=!1,(y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}function l(p){if(!(this instanceof l))return new l(p);s.call(this,p),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&(typeof p.transform=="function"&&(this._transform=p.transform),typeof p.flush=="function"&&(this._flush=p.flush)),this.on("prefinish",i)}function i(){var p=this;typeof this._flush=="function"?this._flush((function(h,f){c(p,h,f)})):c(this,null,null)}function c(p,h,f){if(h)return p.emit("error",h);if(f!=null&&p.push(f),p._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(p._transformState.transforming)throw new Error("Calling transform done when still transforming");return p.push(null)}a.inherits=t("inherits"),a.inherits(l,s),l.prototype.push=function(p,h){return this._transformState.needTransform=!1,s.prototype.push.call(this,p,h)},l.prototype._transform=function(p,h,f){throw new Error("_transform() is not implemented")},l.prototype._write=function(p,h,f){var g=this._transformState;if(g.writecb=f,g.writechunk=p,g.writeencoding=h,!g.transforming){var y=this._readableState;(g.needTransform||y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}},l.prototype._read=function(p){var h=this._transformState;h.writechunk!==null&&h.writecb&&!h.transforming?(h.transforming=!0,this._transform(h.writechunk,h.writeencoding,h.afterTransform)):h.needTransform=!0},l.prototype._destroy=function(p,h){var f=this;s.prototype._destroy.call(this,p,(function(g){h(g),f.emit("close")}))}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(t,r,o){(function(s,a,u){(function(){var l=t("process-nextick-args");function i(I){var T=this;this.next=null,this.entry=null,this.finish=function(){(function(L,E,x){var k=L.entry;for(L.entry=null;k;){var A=k.callback;E.pendingcb--,A(x),k=k.next}E.corkedRequestsFree.next=L})(T,I)}}r.exports=D;var c,p=!s.browser&&["v0.10","v0.9."].indexOf(s.version.slice(0,5))>-1?u:l.nextTick;D.WritableState=N;var h=Object.create(t("core-util-is"));h.inherits=t("inherits");var f={deprecate:t("util-deprecate")},g=t("./internal/streams/stream"),y=t("safe-buffer").Buffer,b=(a!==void 0?a:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v,w=t("./internal/streams/destroy");function S(){}function N(I,T){c=c||t("./_stream_duplex"),I=I||{};var L=T instanceof c;this.objectMode=!!I.objectMode,L&&(this.objectMode=this.objectMode||!!I.writableObjectMode);var E=I.highWaterMark,x=I.writableHighWaterMark,k=this.objectMode?16:16384;this.highWaterMark=E||E===0?E:L&&(x||x===0)?x:k,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var A=I.decodeStrings===!1;this.decodeStrings=!A,this.defaultEncoding=I.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(C){(function(j,B){var O=j._writableState,H=O.sync,X=O.writecb;if((function(V){V.writing=!1,V.writecb=null,V.length-=V.writelen,V.writelen=0})(O),B)(function(V,tt,$,z,Z){--tt.pendingcb,$?(l.nextTick(Z,z),l.nextTick(R,V,tt),V._writableState.errorEmitted=!0,V.emit("error",z)):(Z(z),V._writableState.errorEmitted=!0,V.emit("error",z),R(V,tt))})(j,O,H,B,X);else{var et=U(O);et||O.corked||O.bufferProcessing||!O.bufferedRequest||P(j,O),H?p(G,j,O,et,X):G(j,O,et,X)}})(T,C)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function D(I){if(c=c||t("./_stream_duplex"),!(v.call(D,this)||this instanceof c))return new D(I);this._writableState=new N(I,this),this.writable=!0,I&&(typeof I.write=="function"&&(this._write=I.write),typeof I.writev=="function"&&(this._writev=I.writev),typeof I.destroy=="function"&&(this._destroy=I.destroy),typeof I.final=="function"&&(this._final=I.final)),g.call(this)}function F(I,T,L,E,x,k,A){T.writelen=E,T.writecb=A,T.writing=!0,T.sync=!0,L?I._writev(x,T.onwrite):I._write(x,k,T.onwrite),T.sync=!1}function G(I,T,L,E){L||(function(x,k){k.length===0&&k.needDrain&&(k.needDrain=!1,x.emit("drain"))})(I,T),T.pendingcb--,E(),R(I,T)}function P(I,T){T.bufferProcessing=!0;var L=T.bufferedRequest;if(I._writev&&L&&L.next){var E=T.bufferedRequestCount,x=new Array(E),k=T.corkedRequestsFree;k.entry=L;for(var A=0,C=!0;L;)x[A]=L,L.isBuf||(C=!1),L=L.next,A+=1;x.allBuffers=C,F(I,T,!0,T.length,x,"",k.finish),T.pendingcb++,T.lastBufferedRequest=null,k.next?(T.corkedRequestsFree=k.next,k.next=null):T.corkedRequestsFree=new i(T),T.bufferedRequestCount=0}else{for(;L;){var j=L.chunk,B=L.encoding,O=L.callback;if(F(I,T,!1,T.objectMode?1:j.length,j,B,O),L=L.next,T.bufferedRequestCount--,T.writing)break}L===null&&(T.lastBufferedRequest=null)}T.bufferedRequest=L,T.bufferProcessing=!1}function U(I){return I.ending&&I.length===0&&I.bufferedRequest===null&&!I.finished&&!I.writing}function q(I,T){I._final((function(L){T.pendingcb--,L&&I.emit("error",L),T.prefinished=!0,I.emit("prefinish"),R(I,T)}))}function R(I,T){var L=U(T);return L&&((function(E,x){x.prefinished||x.finalCalled||(typeof E._final=="function"?(x.pendingcb++,x.finalCalled=!0,l.nextTick(q,E,x)):(x.prefinished=!0,E.emit("prefinish")))})(I,T),T.pendingcb===0&&(T.finished=!0,I.emit("finish"))),L}h.inherits(D,g),N.prototype.getBuffer=function(){for(var I=this.bufferedRequest,T=[];I;)T.push(I),I=I.next;return T},(function(){try{Object.defineProperty(N.prototype,"buffer",{get:f.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(D,Symbol.hasInstance,{value:function(I){return!!v.call(this,I)||this===D&&I&&I._writableState instanceof N}})):v=function(I){return I instanceof this},D.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},D.prototype.write=function(I,T,L){var E,x=this._writableState,k=!1,A=!x.objectMode&&(E=I,y.isBuffer(E)||E instanceof b);return A&&!y.isBuffer(I)&&(I=(function(C){return y.from(C)})(I)),typeof T=="function"&&(L=T,T=null),A?T="buffer":T||(T=x.defaultEncoding),typeof L!="function"&&(L=S),x.ended?(function(C,j){var B=new Error("write after end");C.emit("error",B),l.nextTick(j,B)})(this,L):(A||(function(C,j,B,O){var H=!0,X=!1;return B===null?X=new TypeError("May not write null values to stream"):typeof B=="string"||B===void 0||j.objectMode||(X=new TypeError("Invalid non-string/buffer chunk")),X&&(C.emit("error",X),l.nextTick(O,X),H=!1),H})(this,x,I,L))&&(x.pendingcb++,k=(function(C,j,B,O,H,X){if(!B){var et=(function(z,Z,it){return z.objectMode||z.decodeStrings===!1||typeof Z!="string"||(Z=y.from(Z,it)),Z})(j,O,H);O!==et&&(B=!0,H="buffer",O=et)}var V=j.objectMode?1:O.length;j.length+=V;var tt=j.length<j.highWaterMark;if(tt||(j.needDrain=!0),j.writing||j.corked){var $=j.lastBufferedRequest;j.lastBufferedRequest={chunk:O,encoding:H,isBuf:B,callback:X,next:null},$?$.next=j.lastBufferedRequest:j.bufferedRequest=j.lastBufferedRequest,j.bufferedRequestCount+=1}else F(C,j,!1,V,O,H,X);return tt})(this,x,A,I,T,L)),k},D.prototype.cork=function(){this._writableState.corked++},D.prototype.uncork=function(){var I=this._writableState;I.corked&&(I.corked--,I.writing||I.corked||I.bufferProcessing||!I.bufferedRequest||P(this,I))},D.prototype.setDefaultEncoding=function(I){if(typeof I=="string"&&(I=I.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((I+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+I);return this._writableState.defaultEncoding=I,this},Object.defineProperty(D.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),D.prototype._write=function(I,T,L){L(new Error("_write() is not implemented"))},D.prototype._writev=null,D.prototype.end=function(I,T,L){var E=this._writableState;typeof I=="function"?(L=I,I=null,T=null):typeof T=="function"&&(L=T,T=null),I!=null&&this.write(I,T),E.corked&&(E.corked=1,this.uncork()),E.ending||(function(x,k,A){k.ending=!0,R(x,k),A&&(k.finished?l.nextTick(A):x.once("finish",A)),k.ended=!0,x.writable=!1})(this,E,L)},Object.defineProperty(D.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(I){this._writableState&&(this._writableState.destroyed=I)}}),D.prototype.destroy=w.destroy,D.prototype._undestroy=w.undestroy,D.prototype._destroy=function(I,T){this.end(),T(I)}}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(t,r,o){var s=t("safe-buffer").Buffer,a=t("util");r.exports=(function(){function u(){(function(l,i){if(!(l instanceof i))throw new TypeError("Cannot call a class as a function")})(this,u),this.head=null,this.tail=null,this.length=0}return u.prototype.push=function(l){var i={data:l,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length},u.prototype.unshift=function(l){var i={data:l,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length},u.prototype.shift=function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}},u.prototype.clear=function(){this.head=this.tail=null,this.length=0},u.prototype.join=function(l){if(this.length===0)return"";for(var i=this.head,c=""+i.data;i=i.next;)c+=l+i.data;return c},u.prototype.concat=function(l){if(this.length===0)return s.alloc(0);for(var i,c,p,h=s.allocUnsafe(l>>>0),f=this.head,g=0;f;)i=f.data,c=h,p=g,i.copy(c,p),g+=f.data.length,f=f.next;return h},u})(),a&&a.inspect&&a.inspect.custom&&(r.exports.prototype[a.inspect.custom]=function(){var u=a.inspect({length:this.length});return this.constructor.name+" "+u})},{"safe-buffer":520,util:188}],514:[function(t,r,o){var s=t("process-nextick-args");function a(u,l){u.emit("error",l)}r.exports={destroy:function(u,l){var i=this,c=this._readableState&&this._readableState.destroyed,p=this._writableState&&this._writableState.destroyed;return c||p?(l?l(u):u&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,s.nextTick(a,this,u)):s.nextTick(a,this,u)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(u||null,(function(h){!l&&h?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,s.nextTick(a,i,h)):s.nextTick(a,i,h):l&&l(h)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(t,r,o){arguments[4][490][0].apply(o,arguments)},{dup:490,events:422}],516:[function(t,r,o){r.exports=t("./readable").PassThrough},{"./readable":517}],517:[function(t,r,o){(o=r.exports=t("./lib/_stream_readable.js")).Stream=o,o.Readable=o,o.Writable=t("./lib/_stream_writable.js"),o.Duplex=t("./lib/_stream_duplex.js"),o.Transform=t("./lib/_stream_transform.js"),o.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(t,r,o){r.exports=t("./readable").Transform},{"./readable":517}],519:[function(t,r,o){r.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(t,r,o){arguments[4][217][0].apply(o,arguments)},{buffer:220,dup:217}],521:[function(t,r,o){arguments[4][218][0].apply(o,arguments)},{dup:218,"safe-buffer":520}],522:[function(t,r,o){arguments[4][218][0].apply(o,arguments)},{dup:218,"safe-buffer":494}],523:[function(t,r,o){(function(s,a){(function(){var u=t("process/browser.js").nextTick,l=Function.prototype.apply,i=Array.prototype.slice,c={},p=0;function h(f,g){this._id=f,this._clearFn=g}o.setTimeout=function(){return new h(l.call(setTimeout,window,arguments),clearTimeout)},o.setInterval=function(){return new h(l.call(setInterval,window,arguments),clearInterval)},o.clearTimeout=o.clearInterval=function(f){f.close()},h.prototype.unref=h.prototype.ref=function(){},h.prototype.close=function(){this._clearFn.call(window,this._id)},o.enroll=function(f,g){clearTimeout(f._idleTimeoutId),f._idleTimeout=g},o.unenroll=function(f){clearTimeout(f._idleTimeoutId),f._idleTimeout=-1},o._unrefActive=o.active=function(f){clearTimeout(f._idleTimeoutId);var g=f._idleTimeout;g>=0&&(f._idleTimeoutId=setTimeout((function(){f._onTimeout&&f._onTimeout()}),g))},o.setImmediate=typeof s=="function"?s:function(f){var g=p++,y=!(arguments.length<2)&&i.call(arguments,1);return c[g]=!0,u((function(){c[g]&&(y?f.apply(null,y):f.call(null),o.clearImmediate(g))})),g},o.clearImmediate=typeof a=="function"?a:function(f){delete c[f]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(t,r,o){(function(s){(function(){function a(u){try{if(!s.localStorage)return!1}catch{return!1}var l=s.localStorage[u];return l!=null&&String(l).toLowerCase()==="true"}r.exports=function(u,l){if(a("noDeprecation"))return u;var i=!1;return function(){if(!i){if(a("throwDeprecation"))throw new Error(l);a("traceDeprecation")?console.trace(l):console.warn(l),i=!0}return u.apply(this,arguments)}}}).call(this)}).call(this,typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(t,r,o){typeof Object.create=="function"?r.exports=function(s,a){s.super_=a,s.prototype=Object.create(a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})}:r.exports=function(s,a){s.super_=a;var u=function(){};u.prototype=a.prototype,s.prototype=new u,s.prototype.constructor=s}},{}],526:[function(t,r,o){r.exports=function(s){return s&&typeof s=="object"&&typeof s.copy=="function"&&typeof s.fill=="function"&&typeof s.readUInt8=="function"}},{}],527:[function(t,r,o){(function(s,a){(function(){var u=/%[sdj%]/g;o.format=function(x){if(!N(x)){for(var k=[],A=0;A<arguments.length;A++)k.push(c(arguments[A]));return k.join(" ")}A=1;for(var C=arguments,j=C.length,B=String(x).replace(u,(function(H){if(H==="%%")return"%";if(A>=j)return H;switch(H){case"%s":return String(C[A++]);case"%d":return Number(C[A++]);case"%j":try{return JSON.stringify(C[A++])}catch{return"[Circular]"}default:return H}})),O=C[A];A<j;O=C[++A])w(O)||!G(O)?B+=" "+O:B+=" "+c(O);return B},o.deprecate=function(x,k){if(D(a.process))return function(){return o.deprecate(x,k).apply(this,arguments)};if(s.noDeprecation===!0)return x;var A=!1;return function(){if(!A){if(s.throwDeprecation)throw new Error(k);s.traceDeprecation?console.trace(k):console.error(k),A=!0}return x.apply(this,arguments)}};var l,i={};function c(x,k){var A={seen:[],stylize:h};return arguments.length>=3&&(A.depth=arguments[2]),arguments.length>=4&&(A.colors=arguments[3]),v(k)?A.showHidden=k:k&&o._extend(A,k),D(A.showHidden)&&(A.showHidden=!1),D(A.depth)&&(A.depth=2),D(A.colors)&&(A.colors=!1),D(A.customInspect)&&(A.customInspect=!0),A.colors&&(A.stylize=p),f(A,x,A.depth)}function p(x,k){var A=c.styles[k];return A?"\x1B["+c.colors[A][0]+"m"+x+"\x1B["+c.colors[A][1]+"m":x}function h(x,k){return x}function f(x,k,A){if(x.customInspect&&k&&q(k.inspect)&&k.inspect!==o.inspect&&(!k.constructor||k.constructor.prototype!==k)){var C=k.inspect(A,x);return N(C)||(C=f(x,C,A)),C}var j=(function($,z){if(D(z))return $.stylize("undefined","undefined");if(N(z)){var Z="'"+JSON.stringify(z).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return $.stylize(Z,"string")}if(S(z))return $.stylize(""+z,"number");if(v(z))return $.stylize(""+z,"boolean");if(w(z))return $.stylize("null","null")})(x,k);if(j)return j;var B=Object.keys(k),O=(function($){var z={};return $.forEach((function(Z,it){z[Z]=!0})),z})(B);if(x.showHidden&&(B=Object.getOwnPropertyNames(k)),U(k)&&(B.indexOf("message")>=0||B.indexOf("description")>=0))return g(k);if(B.length===0){if(q(k)){var H=k.name?": "+k.name:"";return x.stylize("[Function"+H+"]","special")}if(F(k))return x.stylize(RegExp.prototype.toString.call(k),"regexp");if(P(k))return x.stylize(Date.prototype.toString.call(k),"date");if(U(k))return g(k)}var X,et="",V=!1,tt=["{","}"];return b(k)&&(V=!0,tt=["[","]"]),q(k)&&(et=" [Function"+(k.name?": "+k.name:"")+"]"),F(k)&&(et=" "+RegExp.prototype.toString.call(k)),P(k)&&(et=" "+Date.prototype.toUTCString.call(k)),U(k)&&(et=" "+g(k)),B.length!==0||V&&k.length!=0?A<0?F(k)?x.stylize(RegExp.prototype.toString.call(k),"regexp"):x.stylize("[Object]","special"):(x.seen.push(k),X=V?(function($,z,Z,it,mt){for(var lt=[],at=0,rt=z.length;at<rt;++at)E(z,String(at))?lt.push(y($,z,Z,it,String(at),!0)):lt.push("");return mt.forEach((function(ct){ct.match(/^\d+$/)||lt.push(y($,z,Z,it,ct,!0))})),lt})(x,k,A,O,B):B.map((function($){return y(x,k,A,O,$,V)})),x.seen.pop(),(function($,z,Z){return $.reduce((function(it,mt){return mt.indexOf(`
`)>=0,it+mt.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?Z[0]+(z===""?"":z+`
 `)+" "+$.join(`,
  `)+" "+Z[1]:Z[0]+z+" "+$.join(", ")+" "+Z[1]})(X,et,tt)):tt[0]+et+tt[1]}function g(x){return"["+Error.prototype.toString.call(x)+"]"}function y(x,k,A,C,j,B){var O,H,X;if((X=Object.getOwnPropertyDescriptor(k,j)||{value:k[j]}).get?H=X.set?x.stylize("[Getter/Setter]","special"):x.stylize("[Getter]","special"):X.set&&(H=x.stylize("[Setter]","special")),E(C,j)||(O="["+j+"]"),H||(x.seen.indexOf(X.value)<0?(H=w(A)?f(x,X.value,null):f(x,X.value,A-1)).indexOf(`
`)>-1&&(H=B?H.split(`
`).map((function(et){return"  "+et})).join(`
`).substr(2):`
`+H.split(`
`).map((function(et){return"   "+et})).join(`
`)):H=x.stylize("[Circular]","special")),D(O)){if(B&&j.match(/^\d+$/))return H;(O=JSON.stringify(""+j)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(O=O.substr(1,O.length-2),O=x.stylize(O,"name")):(O=O.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),O=x.stylize(O,"string"))}return O+": "+H}function b(x){return Array.isArray(x)}function v(x){return typeof x=="boolean"}function w(x){return x===null}function S(x){return typeof x=="number"}function N(x){return typeof x=="string"}function D(x){return x===void 0}function F(x){return G(x)&&R(x)==="[object RegExp]"}function G(x){return typeof x=="object"&&x!==null}function P(x){return G(x)&&R(x)==="[object Date]"}function U(x){return G(x)&&(R(x)==="[object Error]"||x instanceof Error)}function q(x){return typeof x=="function"}function R(x){return Object.prototype.toString.call(x)}function I(x){return x<10?"0"+x.toString(10):x.toString(10)}o.debuglog=function(x){if(D(l)&&(l=s.env.NODE_DEBUG||""),x=x.toUpperCase(),!i[x])if(new RegExp("\\b"+x+"\\b","i").test(l)){var k=s.pid;i[x]=function(){var A=o.format.apply(o,arguments);console.error("%s %d: %s",x,k,A)}}else i[x]=function(){};return i[x]},o.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},o.isArray=b,o.isBoolean=v,o.isNull=w,o.isNullOrUndefined=function(x){return x==null},o.isNumber=S,o.isString=N,o.isSymbol=function(x){return typeof x=="symbol"},o.isUndefined=D,o.isRegExp=F,o.isObject=G,o.isDate=P,o.isError=U,o.isFunction=q,o.isPrimitive=function(x){return x===null||typeof x=="boolean"||typeof x=="number"||typeof x=="string"||typeof x=="symbol"||x===void 0},o.isBuffer=t("./support/isBuffer");var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function L(){var x=new Date,k=[I(x.getHours()),I(x.getMinutes()),I(x.getSeconds())].join(":");return[x.getDate(),T[x.getMonth()],k].join(" ")}function E(x,k){return Object.prototype.hasOwnProperty.call(x,k)}o.log=function(){console.log("%s - %s",L(),o.format.apply(o,arguments))},o.inherits=t("inherits"),o._extend=function(x,k){if(!k||!G(k))return x;for(var A=Object.keys(k),C=A.length;C--;)x[A[C]]=k[A[C]];return x}}).call(this)}).call(this,t("_process"),typeof Gn<"u"?Gn:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"v1",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(o,"v3",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(o,"v4",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(o,"v5",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(o,"NIL",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(o,"version",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(o,"validate",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(o,"stringify",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(o,"parse",{enumerable:!0,get:function(){return f.default}});var s=g(t("./v1.js")),a=g(t("./v3.js")),u=g(t("./v4.js")),l=g(t("./v5.js")),i=g(t("./nil.js")),c=g(t("./version.js")),p=g(t("./validate.js")),h=g(t("./stringify.js")),f=g(t("./parse.js"));function g(y){return y&&y.__esModule?y:{default:y}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(t,r,o){function s(f){return 14+(f+64>>>9<<4)+1}function a(f,g){const y=(65535&f)+(65535&g);return(f>>16)+(g>>16)+(y>>16)<<16|65535&y}function u(f,g,y,b,v,w){return a((S=a(a(g,f),a(b,w)))<<(N=v)|S>>>32-N,y);var S,N}function l(f,g,y,b,v,w,S){return u(g&y|~g&b,f,g,v,w,S)}function i(f,g,y,b,v,w,S){return u(g&b|y&~b,f,g,v,w,S)}function c(f,g,y,b,v,w,S){return u(g^y^b,f,g,v,w,S)}function p(f,g,y,b,v,w,S){return u(y^(g|~b),f,g,v,w,S)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var h=function(f){if(typeof f=="string"){const g=unescape(encodeURIComponent(f));f=new Uint8Array(g.length);for(let y=0;y<g.length;++y)f[y]=g.charCodeAt(y)}return(function(g){const y=[],b=32*g.length;for(let v=0;v<b;v+=8){const w=g[v>>5]>>>v%32&255,S=parseInt("0123456789abcdef".charAt(w>>>4&15)+"0123456789abcdef".charAt(15&w),16);y.push(S)}return y})((function(g,y){g[y>>5]|=128<<y%32,g[s(y)-1]=y;let b=1732584193,v=-271733879,w=-1732584194,S=271733878;for(let N=0;N<g.length;N+=16){const D=b,F=v,G=w,P=S;b=l(b,v,w,S,g[N],7,-680876936),S=l(S,b,v,w,g[N+1],12,-389564586),w=l(w,S,b,v,g[N+2],17,606105819),v=l(v,w,S,b,g[N+3],22,-1044525330),b=l(b,v,w,S,g[N+4],7,-176418897),S=l(S,b,v,w,g[N+5],12,1200080426),w=l(w,S,b,v,g[N+6],17,-1473231341),v=l(v,w,S,b,g[N+7],22,-45705983),b=l(b,v,w,S,g[N+8],7,1770035416),S=l(S,b,v,w,g[N+9],12,-1958414417),w=l(w,S,b,v,g[N+10],17,-42063),v=l(v,w,S,b,g[N+11],22,-1990404162),b=l(b,v,w,S,g[N+12],7,1804603682),S=l(S,b,v,w,g[N+13],12,-40341101),w=l(w,S,b,v,g[N+14],17,-1502002290),v=l(v,w,S,b,g[N+15],22,1236535329),b=i(b,v,w,S,g[N+1],5,-165796510),S=i(S,b,v,w,g[N+6],9,-1069501632),w=i(w,S,b,v,g[N+11],14,643717713),v=i(v,w,S,b,g[N],20,-373897302),b=i(b,v,w,S,g[N+5],5,-701558691),S=i(S,b,v,w,g[N+10],9,38016083),w=i(w,S,b,v,g[N+15],14,-660478335),v=i(v,w,S,b,g[N+4],20,-405537848),b=i(b,v,w,S,g[N+9],5,568446438),S=i(S,b,v,w,g[N+14],9,-1019803690),w=i(w,S,b,v,g[N+3],14,-187363961),v=i(v,w,S,b,g[N+8],20,1163531501),b=i(b,v,w,S,g[N+13],5,-1444681467),S=i(S,b,v,w,g[N+2],9,-51403784),w=i(w,S,b,v,g[N+7],14,1735328473),v=i(v,w,S,b,g[N+12],20,-1926607734),b=c(b,v,w,S,g[N+5],4,-378558),S=c(S,b,v,w,g[N+8],11,-2022574463),w=c(w,S,b,v,g[N+11],16,1839030562),v=c(v,w,S,b,g[N+14],23,-35309556),b=c(b,v,w,S,g[N+1],4,-1530992060),S=c(S,b,v,w,g[N+4],11,1272893353),w=c(w,S,b,v,g[N+7],16,-155497632),v=c(v,w,S,b,g[N+10],23,-1094730640),b=c(b,v,w,S,g[N+13],4,681279174),S=c(S,b,v,w,g[N],11,-358537222),w=c(w,S,b,v,g[N+3],16,-722521979),v=c(v,w,S,b,g[N+6],23,76029189),b=c(b,v,w,S,g[N+9],4,-640364487),S=c(S,b,v,w,g[N+12],11,-421815835),w=c(w,S,b,v,g[N+15],16,530742520),v=c(v,w,S,b,g[N+2],23,-995338651),b=p(b,v,w,S,g[N],6,-198630844),S=p(S,b,v,w,g[N+7],10,1126891415),w=p(w,S,b,v,g[N+14],15,-1416354905),v=p(v,w,S,b,g[N+5],21,-57434055),b=p(b,v,w,S,g[N+12],6,1700485571),S=p(S,b,v,w,g[N+3],10,-1894986606),w=p(w,S,b,v,g[N+10],15,-1051523),v=p(v,w,S,b,g[N+1],21,-2054922799),b=p(b,v,w,S,g[N+8],6,1873313359),S=p(S,b,v,w,g[N+15],10,-30611744),w=p(w,S,b,v,g[N+6],15,-1560198380),v=p(v,w,S,b,g[N+13],21,1309151649),b=p(b,v,w,S,g[N+4],6,-145523070),S=p(S,b,v,w,g[N+11],10,-1120210379),w=p(w,S,b,v,g[N+2],15,718787259),v=p(v,w,S,b,g[N+9],21,-343485551),b=a(b,D),v=a(v,F),w=a(w,G),S=a(S,P)}return[b,v,w,S]})((function(g){if(g.length===0)return[];const y=8*g.length,b=new Uint32Array(s(y));for(let v=0;v<y;v+=8)b[v>>5]|=(255&g[v/8])<<v%32;return b})(f),8*f.length))};o.default=h},{}],530:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,o.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s,a=(s=t("./validate.js"))&&s.__esModule?s:{default:s},u=function(l){if(!(0,a.default)(l))throw TypeError("Invalid UUID");let i;const c=new Uint8Array(16);return c[0]=(i=parseInt(l.slice(0,8),16))>>>24,c[1]=i>>>16&255,c[2]=i>>>8&255,c[3]=255&i,c[4]=(i=parseInt(l.slice(9,13),16))>>>8,c[5]=255&i,c[6]=(i=parseInt(l.slice(14,18),16))>>>8,c[7]=255&i,c[8]=(i=parseInt(l.slice(19,23),16))>>>8,c[9]=255&i,c[10]=(i=parseInt(l.slice(24,36),16))/1099511627776&255,c[11]=i/4294967296&255,c[12]=i>>>24&255,c[13]=i>>>16&255,c[14]=i>>>8&255,c[15]=255&i,c};o.default=u},{"./validate.js":541}],532:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0,o.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(t,r,o){let s;Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(){if(!s&&(s=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(a)};const a=new Uint8Array(16)},{}],534:[function(t,r,o){function s(l,i,c,p){switch(l){case 0:return i&c^~i&p;case 1:return i^c^p;case 2:return i&c^i&p^c&p;case 3:return i^c^p}}function a(l,i){return l<<i|l>>>32-i}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var u=function(l){const i=[1518500249,1859775393,2400959708,3395469782],c=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof l=="string"){const g=unescape(encodeURIComponent(l));l=[];for(let y=0;y<g.length;++y)l.push(g.charCodeAt(y))}else Array.isArray(l)||(l=Array.prototype.slice.call(l));l.push(128);const p=l.length/4+2,h=Math.ceil(p/16),f=new Array(h);for(let g=0;g<h;++g){const y=new Uint32Array(16);for(let b=0;b<16;++b)y[b]=l[64*g+4*b]<<24|l[64*g+4*b+1]<<16|l[64*g+4*b+2]<<8|l[64*g+4*b+3];f[g]=y}f[h-1][14]=8*(l.length-1)/Math.pow(2,32),f[h-1][14]=Math.floor(f[h-1][14]),f[h-1][15]=8*(l.length-1)&4294967295;for(let g=0;g<h;++g){const y=new Uint32Array(80);for(let D=0;D<16;++D)y[D]=f[g][D];for(let D=16;D<80;++D)y[D]=a(y[D-3]^y[D-8]^y[D-14]^y[D-16],1);let b=c[0],v=c[1],w=c[2],S=c[3],N=c[4];for(let D=0;D<80;++D){const F=Math.floor(D/20),G=a(b,5)+s(F,v,w,S)+N+i[F]+y[D]>>>0;N=S,S=w,w=a(v,30)>>>0,v=b,b=G}c[0]=c[0]+b>>>0,c[1]=c[1]+v>>>0,c[2]=c[2]+w>>>0,c[3]=c[3]+S>>>0,c[4]=c[4]+N>>>0}return[c[0]>>24&255,c[0]>>16&255,c[0]>>8&255,255&c[0],c[1]>>24&255,c[1]>>16&255,c[1]>>8&255,255&c[1],c[2]>>24&255,c[2]>>16&255,c[2]>>8&255,255&c[2],c[3]>>24&255,c[3]>>16&255,c[3]>>8&255,255&c[3],c[4]>>24&255,c[4]>>16&255,c[4]>>8&255,255&c[4]]};o.default=u},{}],535:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s,a=(s=t("./validate.js"))&&s.__esModule?s:{default:s};const u=[];for(let i=0;i<256;++i)u.push((i+256).toString(16).substr(1));var l=function(i){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const p=(u[i[c+0]]+u[i[c+1]]+u[i[c+2]]+u[i[c+3]]+"-"+u[i[c+4]]+u[i[c+5]]+"-"+u[i[c+6]]+u[i[c+7]]+"-"+u[i[c+8]]+u[i[c+9]]+"-"+u[i[c+10]]+u[i[c+11]]+u[i[c+12]]+u[i[c+13]]+u[i[c+14]]+u[i[c+15]]).toLowerCase();if(!(0,a.default)(p))throw TypeError("Stringified UUID is invalid");return p};o.default=l},{"./validate.js":541}],536:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=u(t("./rng.js")),a=u(t("./stringify.js"));function u(f){return f&&f.__esModule?f:{default:f}}let l,i,c=0,p=0;var h=function(f,g,y){let b=g&&y||0;const v=g||new Array(16);let w=(f=f||{}).node||l,S=f.clockseq!==void 0?f.clockseq:i;if(w==null||S==null){const U=f.random||(f.rng||s.default)();w==null&&(w=l=[1|U[0],U[1],U[2],U[3],U[4],U[5]]),S==null&&(S=i=16383&(U[6]<<8|U[7]))}let N=f.msecs!==void 0?f.msecs:Date.now(),D=f.nsecs!==void 0?f.nsecs:p+1;const F=N-c+(D-p)/1e4;if(F<0&&f.clockseq===void 0&&(S=S+1&16383),(F<0||N>c)&&f.nsecs===void 0&&(D=0),D>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=N,p=D,i=S,N+=122192928e5;const G=(1e4*(268435455&N)+D)%4294967296;v[b++]=G>>>24&255,v[b++]=G>>>16&255,v[b++]=G>>>8&255,v[b++]=255&G;const P=N/4294967296*1e4&268435455;v[b++]=P>>>8&255,v[b++]=255&P,v[b++]=P>>>24&15|16,v[b++]=P>>>16&255,v[b++]=S>>>8|128,v[b++]=255&S;for(let U=0;U<6;++U)v[b+U]=w[U];return g||(0,a.default)(v)};o.default=h},{"./rng.js":533,"./stringify.js":535}],537:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=u(t("./v35.js")),a=u(t("./md5.js"));function u(i){return i&&i.__esModule?i:{default:i}}var l=(0,s.default)("v3",48,a.default);o.default=l},{"./md5.js":529,"./v35.js":538}],538:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(c,p,h){function f(g,y,b,v){if(typeof g=="string"&&(g=(function(S){S=unescape(encodeURIComponent(S));const N=[];for(let D=0;D<S.length;++D)N.push(S.charCodeAt(D));return N})(g)),typeof y=="string"&&(y=(0,a.default)(y)),y.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let w=new Uint8Array(16+g.length);if(w.set(y),w.set(g,y.length),w=h(w),w[6]=15&w[6]|p,w[8]=63&w[8]|128,b){v=v||0;for(let S=0;S<16;++S)b[v+S]=w[S];return b}return(0,s.default)(w)}try{f.name=c}catch{}return f.DNS=l,f.URL=i,f},o.URL=o.DNS=void 0;var s=u(t("./stringify.js")),a=u(t("./parse.js"));function u(c){return c&&c.__esModule?c:{default:c}}const l="6ba7b810-9dad-11d1-80b4-00c04fd430c8";o.DNS=l;const i="6ba7b811-9dad-11d1-80b4-00c04fd430c8";o.URL=i},{"./parse.js":531,"./stringify.js":535}],539:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=u(t("./rng.js")),a=u(t("./stringify.js"));function u(i){return i&&i.__esModule?i:{default:i}}var l=function(i,c,p){const h=(i=i||{}).random||(i.rng||s.default)();if(h[6]=15&h[6]|64,h[8]=63&h[8]|128,c){p=p||0;for(let f=0;f<16;++f)c[p+f]=h[f];return c}return(0,a.default)(h)};o.default=l},{"./rng.js":533,"./stringify.js":535}],540:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=u(t("./v35.js")),a=u(t("./sha1.js"));function u(i){return i&&i.__esModule?i:{default:i}}var l=(0,s.default)("v5",80,a.default);o.default=l},{"./sha1.js":534,"./v35.js":538}],541:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s,a=(s=t("./regex.js"))&&s.__esModule?s:{default:s},u=function(l){return typeof l=="string"&&a.default.test(l)};o.default=u},{"./regex.js":532}],542:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s,a=(s=t("./validate.js"))&&s.__esModule?s:{default:s},u=function(l){if(!(0,a.default)(l))throw TypeError("Invalid UUID");return parseInt(l.substr(14,1),16)};o.default=u},{"./validate.js":541}],543:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.CHAR=`	
\r ---`,o.S=` 	\r
`,o.NAME_START_CHAR=":A-Z_a-z-----------",o.NAME_CHAR="-"+o.NAME_START_CHAR+".0-9--",o.CHAR_RE=new RegExp("^["+o.CHAR+"]$","u"),o.S_RE=new RegExp("^["+o.S+"]+$","u"),o.NAME_START_CHAR_RE=new RegExp("^["+o.NAME_START_CHAR+"]$","u"),o.NAME_CHAR_RE=new RegExp("^["+o.NAME_CHAR+"]$","u"),o.NAME_RE=new RegExp("^["+o.NAME_START_CHAR+"]["+o.NAME_CHAR+"]*$","u"),o.NMTOKEN_RE=new RegExp("^["+o.NAME_CHAR+"]+$","u");function s(a){return a>=65&&a<=90||a>=97&&a<=122||a===58||a===95||a===8204||a===8205||a>=192&&a<=214||a>=216&&a<=246||a>=248&&a<=767||a>=880&&a<=893||a>=895&&a<=8191||a>=8304&&a<=8591||a>=11264&&a<=12271||a>=12289&&a<=55295||a>=63744&&a<=64975||a>=65008&&a<=65533||a>=65536&&a<=983039}o.S_LIST=[32,10,13,9],o.isChar=function(a){return a>=32&&a<=55295||a===10||a===13||a===9||a>=57344&&a<=65533||a>=65536&&a<=1114111},o.isS=function(a){return a===32||a===10||a===13||a===9},o.isNameStartChar=s,o.isNameChar=function(a){return s(a)||a>=48&&a<=57||a===45||a===46||a===183||a>=768&&a<=879||a>=8255&&a<=8256}},{}],544:[function(t,r,o){Object.defineProperty(o,"__esModule",{value:!0}),o.CHAR="---",o.RESTRICTED_CHAR="-\b\v\f---",o.S=` 	\r
`,o.NAME_START_CHAR=":A-Z_a-z-----------",o.NAME_CHAR="-"+o.NAME_START_CHAR+".0-9--",o.CHAR_RE=new RegExp("^["+o.CHAR+"]$","u"),o.RESTRICTED_CHAR_RE=new RegExp("^["+o.RESTRICTED_CHAR+"]$","u"),o.S_RE=new RegExp("^["+o.S+"]+$","u"),o.NAME_START_CHAR_RE=new RegExp("^["+o.NAME_START_CHAR+"]$","u"),o.NAME_CHAR_RE=new RegExp("^["+o.NAME_CHAR+"]$","u"),o.NAME_RE=new RegExp("^["+o.NAME_START_CHAR+"]["+o.NAME_CHAR+"]*$","u"),o.NMTOKEN_RE=new RegExp("^["+o.NAME_CHAR+"]+$","u");function s(a){return a>=65&&a<=90||a>=97&&a<=122||a===58||a===95||a===8204||a===8205||a>=192&&a<=214||a>=216&&a<=246||a>=248&&a<=767||a>=880&&a<=893||a>=895&&a<=8191||a>=8304&&a<=8591||a>=11264&&a<=12271||a>=12289&&a<=55295||a>=63744&&a<=64975||a>=65008&&a<=65533||a>=65536&&a<=983039}o.S_LIST=[32,10,13,9],o.isChar=function(a){return a>=1&&a<=55295||a>=57344&&a<=65533||a>=65536&&a<=1114111},o.isRestrictedChar=function(a){return a>=1&&a<=8||a===11||a===12||a>=14&&a<=31||a>=127&&a<=132||a>=134&&a<=159},o.isCharAndNotRestricted=function(a){return a===9||a===10||a===13||a>31&&a<127||a===133||a>159&&a<=55295||a>=57344&&a<=65533||a>=65536&&a<=1114111},o.isS=function(a){return a===32||a===10||a===13||a===9},o.isNameStartChar=s,o.isNameChar=function(a){return s(a)||a>=48&&a<=57||a===45||a===46||a===183||a>=768&&a<=879||a>=8255&&a<=8256}},{}],545:[function(t,r,o){function s(a){return a>=65&&a<=90||a===95||a>=97&&a<=122||a>=192&&a<=214||a>=216&&a<=246||a>=248&&a<=767||a>=880&&a<=893||a>=895&&a<=8191||a>=8204&&a<=8205||a>=8304&&a<=8591||a>=11264&&a<=12271||a>=12289&&a<=55295||a>=63744&&a<=64975||a>=65008&&a<=65533||a>=65536&&a<=983039}Object.defineProperty(o,"__esModule",{value:!0}),o.NC_NAME_START_CHAR="A-Z_a-z------------",o.NC_NAME_CHAR="-"+o.NC_NAME_START_CHAR+".0-9--",o.NC_NAME_START_CHAR_RE=new RegExp("^["+o.NC_NAME_START_CHAR+"]$","u"),o.NC_NAME_CHAR_RE=new RegExp("^["+o.NC_NAME_CHAR+"]$","u"),o.NC_NAME_RE=new RegExp("^["+o.NC_NAME_START_CHAR+"]["+o.NC_NAME_CHAR+"]*$","u"),o.isNCNameStartChar=s,o.isNCNameChar=function(a){return s(a)||a===45||a===46||a>=48&&a<=57||a===183||a>=768&&a<=879||a>=8255&&a<=8256}},{}]},{},[15])(15)}))})(v1)),v1.exports}var OM=LM();const RM=Eu(OM);async function w6(n){try{const e=new RM.Workbook;await e.xlsx.load(n);const t=e.worksheets[0];if(!t)return[];const r=[];let o=[];return t.eachRow({includeEmpty:!1},(s,a)=>{const u=Array.isArray(s.values)?s.values:[];if(a===1)o=u.map(l=>l==null?"":String(l).trim());else{const l={};o.forEach((i,c)=>{if(i){let p=u[c];p&&typeof p=="object"&&(p.result!==void 0?p=p.result:p.richText?p=p.richText.map(h=>h.text).join(""):p.text&&(p=p.text)),l[i]=p==null?"":String(p)}}),Object.keys(l).length>0&&r.push(l)}}),r}catch(e){throw console.error("Error parsing Excel file with ExcelJS:",e),e}}const X5=new Map;function Ir(n){if(n==null)return"";const e=String(n).trim(),t=X5.get(e);if(t!==void 0)return t;const r=e.toLowerCase().replace(/\s+/g,"");return X5.set(e,r),r}function El(n=[]){const e=new Map;for(let t=0;t<(n||[]).length;t++){const r=n[t];e.set(Ir(r==null?"":String(r).trim()),t)}return e}function Wh(n){if(!n)return{url:null,display:null};if(typeof n!="string")return{url:null,display:null};const e=n.trim(),t=e.match(/=\s*HYPERLINK\s*\(\s*["']([^"']+)["']\s*,\s*["']([^"']*)["']\s*\)/i);return t?{url:t[1].trim(),display:t[2].trim()}:/^https?:\/\//i.test(e)?{url:e,display:e}:{url:null,display:null}}function K5(n){const e=Wh(n);return e&&e.url?e.url:null}function IM(n,e){const t=String(n).replace(/"/g,'""'),r=e==null?t:String(e).replace(/"/g,'""');return`=HYPERLINK("${t}","${r}")`}function x6(n=[],e={}){if(!Array.isArray(n)||n.length===0||!e)return-1;const t=El(n);if(e.name){const r=Ir(e.name);if(t.has(r))return t.get(r)}if(e.alias)if(Array.isArray(e.alias))for(const r of e.alias){const o=Ir(r);if(t.has(o))return t.get(o)}else{const r=Ir(e.alias);if(t.has(r))return t.get(r)}return-1}function hp(n=[],e=[]){const t=new Set((e||[]).map(Ir)),r=new Map;return(n||[]).forEach(o=>{if(!o)return;const s=o.name?String(o.name).trim():null;if(!s)return;const a=new Set;a.add(Ir(s)),o.alias&&(Array.isArray(o.alias)?o.alias.forEach(u=>a.add(Ir(u))):a.add(Ir(o.alias)));for(const u of a)t.has(u)&&r.set(u,s)}),r}function Ig(n=[],e=new Map){return(n||[]).map(t=>{const r=Ir(t);return e.has(r)?e.get(r):t})}function DM(n=[]){const e=Array.isArray(n)?n:[];return!e||e.length===0?null:e.find(r=>{if(!r||typeof r!="object")return!1;const o=r.identifier,s=r.identifer;return o===!0||o==="true"||s===!0||s==="true"})||null}function Z5(n=[],e=new Map){return!e||e.size===0?n.slice():n.map(t=>{if(!t||typeof t!="object"||Array.isArray(t))return t;const r={};return Object.keys(t).forEach(o=>{const s=Ir(o),a=e.get(s);a?r[a]=t[o]:r[o]=t[o]}),r})}function Q5(n=[],e=new Map){if(!Array.isArray(n)||n.length===0||e.size===0)return n.slice();const t=n[0];return[Ig(t,e),...n.slice(1)]}function BM(n=[],e=[],t=[],r=null,o=[],s=[]){if(!Array.isArray(t)||t.length===0||!r||!r.name||!Array.isArray(n)||n.length===0)return null;console.log("[Utility] computeSavedStaticFromValues started. Rows:",n.length,"Static Cols:",t);const a=Array.isArray(e)&&e.length>0?e.map(g=>g==null?"":String(g).trim()):Array.isArray(n[0])?n[0].map(g=>g==null?"":String(g).trim()):[],u=x6(a,r);if(u===-1)return console.warn("[Utility] Identifier column not found in header row:",a),null;const l=El(a),i=t.map(g=>l.has(Ir(g))?l.get(Ir(g)):-1);console.log("[Utility] Static Indices mapped:",i);const c=new Map,p=new Map;t.forEach(g=>p.set(g,new Map));const h=Array.isArray(o),f=Array.isArray(s)&&s.length>0;f?console.log(`[Utility] Processing cellProps. Length: ${s.length}`):console.warn("[Utility] No cellProps (formatting) provided to computeSavedStaticFromValues.");for(let g=1;g<n.length;g++){const y=Array.isArray(n[g])?n[g]:[];let b=y[u],v=b==null?"":String(b).trim();if(h&&o[g]&&typeof o[g][u]=="string"&&o[g][u].trim().startsWith("=")){const S=Wh(o[g][u]);S.url&&(v=S.url)}const w={};for(let S=0;S<t.length;S++){const N=t[S],D=i[S];if(D<0)continue;let F=D>=0&&y.length>D?y[D]:null;if(D>=0&&h&&o[g]&&typeof o[g][D]=="string"&&o[g][D].trim().startsWith("=")){const G=Wh(o[g][D]);G.url&&(F=IM(G.url,G.display))}if(F!=null){const G=String(F).trim();if(G!==""&&(w[N]=F,f&&s[g]&&s[g][D])){const P=s[g][D].format.fill;if(P&&P.color){const U=P.color.toUpperCase();U!=="#FFFFFF"&&U!=="#ADD8E6"&&(p.get(N).size<5&&console.log(`[Utility] Stored color ${P.color} for value "${G}" in col "${N}" (Row ${g})`),p.get(N).set(G,P.color))}}}}Object.keys(w).length>0&&c.set(String(v),w)}return t.forEach(g=>{console.log(`[Utility] Final Color Map for "${g}": ${p.get(g).size} unique value-color pairs.`)}),{identifierIndex:u,staticCols:t,staticIndices:i,savedMap:c,colorMap:p}}function J5(n=[],e=[],t=null,r=[]){if(!t||!t.name)return{identifierIndex:-1,identifiers:new Set};if(!Array.isArray(n)||n.length===0)return{identifierIndex:-1,identifiers:new Set};const o=Array.isArray(e)&&e.length>0?e.map(l=>l==null?"":String(l).trim()):Array.isArray(n[0])?n[0].map(l=>l==null?"":String(l).trim()):[],s=x6(o,t);if(s===-1)return{identifierIndex:-1,identifiers:new Set};const a=new Set,u=Array.isArray(r);for(let l=1;l<n.length;l++){const i=Array.isArray(n[l])?n[l]:[];let c=i.length>s?i[s]:null;if(u&&r[l]&&typeof r[l][s]=="string"&&r[l][s].trim().startsWith("=")){const h=Wh(r[l][s]);h.url&&(c=h.url)}const p=c==null?"":String(c).trim();p!==""&&a.add(String(p))}return{identifierIndex:s,identifiers:a}}async function PM(n,e,t,r=0,o=0,s=""){if(!t||!t.savedMap||t.savedMap.size===0||!e||o<=0)return;console.log(`[Utility] applyStaticColumnsWithContext started. WriteStartRow: ${r}, Count: ${o}`);const a=e.getRangeByIndexes(r,t.identifierIndex,o,1);a.load("values"),await n.sync();const u=a.values||[],l=t.savedMap,i=t.colorMap,c=t.staticCols||[],p=t.staticIndices||[];for(let h=0;h<c.length;h++){const f=c[h],g=p[h];if(g===-1)continue;const y=i?i.get(f):null;y&&y.size>0&&console.log(`[Utility] Applying static col "${f}" with color map size: ${y.size}`);const b=new Array(o),v=new Array(o),w=new Array(o);let S=0;for(let G=0;G<o;G++){const P=u[G]&&u[G][0]!=null?String(u[G][0]).trim():"",U=l.get(String(P)),q=U&&Object.prototype.hasOwnProperty.call(U,f)?U[f]:"";if(b[G]=q,v[G]=typeof q=="string"&&q.startsWith("="),y&&q!==""){const R=String(q).trim();if(y.has(R)){const I=y.get(R);w[G]=I,S++}}}S>0&&console.log(`[Utility] Col "${f}": Matched ${S} rows with colors.`);let N=0,D=v[0]||!1,F=w[0];for(let G=0;G<=o;G++){const P=G<o?v[G]:null,U=G<o?w[G]:null;if(G===o||P!==D||U!==F){const q=G-N;if(q>0){const R=r+N,I=e.getRangeByIndexes(R,g,q,1),T=[];for(let L=N;L<N+q;L++)T.push([b[L]]);D?I.formulas=T:I.values=T,F&&(I.format.fill.color=F)}N=G,D=P,F=U}}}}function w1({data:n,sheetName:e,refreshSheetName:t,settingsColumns:r,matched:o,onComplete:s,onStatus:a,action:u,conditionalFormat:l}){const i=w=>{if(typeof s=="function")try{s(w)}catch{}},c=w=>{if(typeof a=="function")try{a(String(w))}catch{}},p=w=>{const N=Math.floor(w-25569)*86400;return new Date(N*1e3)},h=(w,S)=>{const N=w??"",D=S??"";if(N===D||N==D)return!0;const F=U=>{if(typeof U=="number"&&U>2e4&&U<6e4){const q=p(U);if(!isNaN(q.getTime())){const R=String(q.getUTCMonth()+1).padStart(2,"0"),I=String(q.getUTCDate()).padStart(2,"0"),T=String(q.getUTCFullYear()).slice(-2);return`${R}/${I}/${T}`}}if(typeof U=="string"&&(U.match(/^\d{1,2}[\/-]\d{1,2}[\/-]\d{2,4}$/)||U.match(/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/))){const q=new Date(U);if(!isNaN(q.getTime())){const R=String(q.getUTCMonth()+1).padStart(2,"0"),I=String(q.getUTCDate()).padStart(2,"0"),T=String(q.getUTCFullYear()).slice(-2);return`${R}/${I}/${T}`}}return null},G=F(N),P=F(D);return G&&P?G===P:String(N).trim()===String(D).trim()};function f(w,S,N){if(!S||S.length===0)return;const D=1e3;for(let F=0;F<S.length;F+=D)S.slice(F,F+D).forEach(P=>{try{const U=w.getRange(P);N?U.format.fill.color=N:U.format.fill.clear()}catch{console.warn("Skipping invalid range address:",P)}})}function g(w,S,N){if(console.log("[DataProcessor] Applying Conditional Format: Rule=",N,` Index=${S}`),!N||!N.column||S<0){console.warn("[DataProcessor] Skipped CF: Invalid rule or index");return}try{const D=w.getRangeByIndexes(0,S,1,1).getEntireColumn();if(D.conditionalFormats.clearAll(),N.condition==="Color Scales"&&N.format==="G-Y-R Color Scale"){const F=D.conditionalFormats.add(Excel.ConditionalFormatType.colorScale);F.colorScale.criteria={minimum:{formula:null,type:Excel.ConditionalFormatColorCriterionType.lowestValue,color:"#F8696B"},midpoint:{formula:null,type:Excel.ConditionalFormatColorCriterionType.percentile,value:50,color:"#FFEB84"},maximum:{formula:null,type:Excel.ConditionalFormatColorCriterionType.highestValue,color:"#63BE7B"}},N.column.toLowerCase().includes("missing")&&(F.colorScale.criteria={minimum:{formula:null,type:Excel.ConditionalFormatColorCriterionType.lowestValue,color:"#63BE7B"},midpoint:{formula:null,type:Excel.ConditionalFormatColorCriterionType.percentile,value:50,color:"#FFEB84"},maximum:{formula:null,type:Excel.ConditionalFormatColorCriterionType.highestValue,color:"#F8696B"}})}else if(N.condition==="Highlight Cells with"&&Array.isArray(N.format)){const F=N.format[0],G=N.format[1],P=N.format[2],U=N.format[3];if(F==="Specific text"&&G==="Beginning with"){const q=D.conditionalFormats.add(Excel.ConditionalFormatType.containsText);q.textComparison.format.font.color="#006100",q.textComparison.format.fill.color="#C6EFCE",U.includes("Red")?(q.textComparison.format.font.color="#9C0006",q.textComparison.format.fill.color="#FFC7CE"):U.includes("Yellow")&&(q.textComparison.format.font.color="#9C6500",q.textComparison.format.fill.color="#FFEB9C"),q.textComparison.rule={operator:Excel.ConditionalTextOperator.beginsWith,text:P}}}}catch(D){console.error("[DataProcessor] Error queuing conditional formatting",D)}}async function y(w,S=e,N=!1){if(c(`Starting refresh on ${S}...`),!w||!w.length){c("No data to write.");const F={success:!1,reason:"no-data"};return N||i(F),F}if(!S){c("Missing sheet name.");const F={success:!1,reason:"missing-sheetName"};return N||i(F),F}if(!window.Excel||!window.Excel.run){c("Excel JS API not available.");const F={success:!1,reason:"no-excel-api"};return N||i(F),F}let D=0;try{c("Reading existing worksheet...");let F=[],G=[],P=[],U=!1;await Excel.run(async dt=>{const gt=dt.workbook.worksheets.getItemOrNullObject(S);if(await dt.sync(),!gt.isNullObject){U=!0;const wt=gt.getUsedRangeOrNullObject();wt.load(["values","formulas"]);const yt=wt.getCellProperties({format:{fill:{color:!0}}});await dt.sync(),wt.isNullObject||(F=wt.values||[],G=wt.formulas||[],P=yt.value||[])}}),c("Processing data structure...");let q=U&&F.length>0?F[0].map(dt=>dt==null?"":String(dt).trim()):[];const R=w[0],I=R&&typeof R=="object"&&!Array.isArray(R);let T=I?Object.keys(R).map(dt=>dt==null?"":String(dt).trim()):Array.isArray(R)?R.map(dt=>dt==null?"":String(dt).trim()):[];const L=El(T);q.length===0&&T.length>0&&(q=[...T]);const E=q.some(dt=>dt!==""),x=El(q),k=Array.isArray(r)?r:[],A=DM(k),C=new Set,j=new Map;if(A&&F.length>0){const dt=J5(F,q,A,G);if(dt.identifierIndex!==-1){dt.identifiers.forEach(ft=>C.add(ft));for(let ft=1;ft<F.length;ft++){const gt=F[ft];let wt=gt[dt.identifierIndex];if(G[ft]&&typeof G[ft][dt.identifierIndex]=="string"&&G[ft][dt.identifierIndex].startsWith("=")){const Et=Wh(G[ft][dt.identifierIndex]);Et.url&&(wt=Et.url)}const yt=wt==null?"":String(wt).trim();yt&&j.set(yt,gt)}}}const B=new Map;for(const dt of k){if(!dt||!dt.name)continue;const ft=Ir(dt.name);x.has(ft)&&L.has(ft)&&B.set(ft,String(dt.name).trim())}const O=k.filter(dt=>dt&&dt.name&&!B.has(Ir(dt.name))),H=hp(O,q),X=hp(O,T);B.size>0&&(q=q.map(dt=>{const ft=Ir(dt);return B.has(ft)?B.get(ft):dt}),Object.assign(x,El(q))),H.size>0&&(q=Ig(q,H));const et=new Map([...B,...X]);if(et.size>0){const dt=w[0];dt&&typeof dt=="object"&&!Array.isArray(dt)?w=Z5(w,et):Array.isArray(dt)&&(w=Q5(w,et))}let V=new Set;const tt=w[0];tt&&typeof tt=="object"&&!Array.isArray(tt)?w.forEach(dt=>Object.keys(dt||{}).forEach(ft=>V.add(Ir(ft)))):Array.isArray(tt)&&tt.forEach(dt=>V.add(Ir(dt)));const $=new Set;q.forEach((dt,ft)=>{const gt=Ir(dt);gt&&V.has(gt)&&$.add(ft)});const z=[];q.forEach(dt=>{const ft=Ir(dt);ft&&!V.has(ft)&&z.push(dt)});let Z=null;z.length>0&&A&&(Z=BM(F,q,z,A,G,P)),c("Constructing write matrix...");let it,mt=0;if(E){const dt=q.map((ft,gt)=>ft?{name:ft,index:gt}:null).filter(Boolean);it=new Array(w.length);for(let ft=0;ft<w.length;ft++){const gt=w[ft],wt=new Array(dt.length);for(let yt=0;yt<dt.length;yt++){const Et=dt[yt];I?wt[yt]=gt&&Object.prototype.hasOwnProperty.call(gt,Et.name)?gt[Et.name]:"":wt[yt]=Array.isArray(gt)&&gt.length>Et.index?gt[Et.index]:""}it[ft]=wt}mt=1}else if(I){const dt=Object.keys(tt||{});it=new Array(w.length+1),it[0]=dt;for(let ft=0;ft<w.length;ft++)it[ft+1]=dt.map(gt=>w[ft][gt]??"");mt=0}else it=w.slice(),mt=0;D=it.length;let lt=it[0]?it[0].length:0;if(D===0){const dt={success:!1,reason:"nothing-to-write"};return N||i(dt),dt}const at=[],rt=[],ct=[];if(A){const dt=El(q).get(Ir(A.name));if(dt!==void 0&&dt>=0){const ft=qt=>{let Tt="";for(;qt>=0;)Tt=String.fromCharCode(qt%26+65)+Tt,qt=Math.floor(qt/26)-1;return Tt},gt=ft(0),wt=ft(Math.max(lt,1)-1);let yt=null,Et=-1;const Mt=qt=>{if(yt&&Et>=0){const Tt=Et+1,It=qt+1,Vt=`${gt}${Tt}:${wt}${It}`;yt==="highlight"?at.push(Vt):yt==="clear"&&ct.push(Vt)}yt=null,Et=-1};for(let qt=0;qt<it.length;qt++){const Tt=it[qt];let It=Tt[dt];if(typeof It=="string"&&It.startsWith("=")){const Oe=K5(It);Oe&&(It=Oe)}const Vt=It==null?"":String(It).trim();if(!Vt){Mt(mt+qt-1);continue}const Kt=C.has(Vt),ne=Kt?"clear":"highlight",ae=mt+qt;if(ne!==yt&&(Mt(ae-1),yt=ne,Et=ae),Kt){const Oe=j.get(Vt);if(Oe)for(let le=0;le<Tt.length;le++){if(!$.has(le))continue;const Jt=Tt[le];let ue="";if(le<Oe.length&&(ue=Oe[le]),!h(Jt,ue)){const ge=`${ft(le)}${ae+1}`;rt.push(ge)}}}}Mt(mt+it.length-1)}}c("Writing to Excel..."),await Excel.run(async dt=>{const ft=dt.workbook.worksheets;let gt=ft.getItemOrNullObject(S);await dt.sync(),gt.isNullObject&&(gt=ft.add(S));const wt=gt.getUsedRangeOrNullObject();if(wt.load(["rowCount","columnCount"]),await dt.sync(),!wt.isNullObject){const yt=wt.rowCount||0,Et=wt.columnCount||0,Mt=Math.max(0,yt-mt),qt=Math.max(lt,Et,1);Mt>0&&gt.getRangeByIndexes(mt,0,Mt,qt).clear(Excel.ClearApplyTo.contents)}if(E&&q.length>0){const yt=gt.getRangeByIndexes(0,0,1,q.length);yt.values=[q]}if(it.length>0){const yt=gt.getRangeByIndexes(mt,0,it.length,lt);yt.values=it}if(at.length>0&&f(gt,at,"#ADD8E6"),ct.length>0&&f(gt,ct,null),rt.length>0&&f(gt,rt,"#ADD8E6"),Z&&Z.savedMap&&Z.savedMap.size>0&&await PM(dt,gt,Z,mt,D,S),l&&l.column){const yt=Ir(l.column),Et=El(q).get(yt);Et!==void 0&&Et>=0&&g(gt,Et,l)}await dt.sync()}),c(`Refresh completed (${D} rows) on ${S}.`);const ot={success:!0,rowsWritten:D};return N||i(ot),ot}catch(F){console.error("Refresh error",F),c(`Refresh error: ${String(F)}`);const G={success:!1,error:String(F)};return N||i(G),G}}async function b(w,S=!1){if(c("Starting DataProcessor update..."),!w||!w.length){const N={success:!1,reason:"no-data"};return S||i(N),N}if(!e||!window.Excel||!window.Excel.run){const N={success:!1,reason:"missing-requirements"};return S||i(N),N}try{c("Reading current sheet state...");let N=[],D=[],F=0,G=0;if(await Excel.run(async it=>{const lt=it.workbook.worksheets.getItemOrNullObject(e);if(await it.sync(),lt.isNullObject)throw new Error("Sheet not found");const at=lt.getUsedRangeOrNullObject();at.load(["values","formulas","rowIndex","columnIndex","rowCount","columnCount"]),await it.sync(),at.isNullObject||(N=at.values,D=at.formulas,F=at.rowIndex,G=at.columnIndex||0)}),!N||N.length===0){c("Sheet empty, nothing to update.");const it={success:!1,reason:"empty-sheet"};return S||i(it),it}let P=N[0].map(it=>it==null?"":String(it).trim());const U=El(P),q=w[0],R=q&&typeof q=="object"&&!Array.isArray(q);let I=R?Object.keys(q):Array.isArray(q)?q:[];const T=Array.isArray(r)?r:[],L=hp(T,P);L.size>0&&(P=Ig(P,L));const E=El(P),x=hp(T,I);x.size>0&&(R?w=Z5(w,x):Array.isArray(q)&&(w=Q5(w,x)));const k=new Set((R?Object.keys(w[0]||{}):I).map(it=>Ir(it))),A=T.filter(it=>it.identifier?!!(k.has(Ir(it.name))||it.alias&&(Array.isArray(it.alias)?it.alias:[it.alias]).some(lt=>k.has(Ir(lt)))||it.aliases&&it.aliases.some(mt=>k.has(Ir(mt)))):!1);let C=-1,j=null;for(const it of A){const mt=J5(N,P,it,D);if(mt.identifierIndex!==-1){C=mt.identifierIndex,j=it;break}}if(C===-1){c("Could not match identifier between file and sheet.");const it={success:!1,reason:"no-identifier-match"};return S||i(it),it}const B=new Map;R&&w.length>0?Object.keys(w[0]).forEach(it=>B.set(Ir(it),it)):!R&&w.length>0&&w[0].forEach((it,mt)=>B.set(Ir(it),mt));let O=Array.isArray(o)?o:[];const H=[];if(O.forEach(it=>{let mt=it;const lt=Ir(it);x.has(lt)?mt=x.get(lt):L.has(lt)&&(mt=L.get(lt));const at=Ir(mt),rt=E.get(at),ct=B.get(at);if(rt!==void 0&&ct!==void 0){if(rt===C)return;H.push({index:rt,dataLookup:ct,name:mt})}}),H.length===0){const it={success:!1,reason:"no-update-columns"};return S||i(it),it}const X=new Map;for(const it of H){const mt=D.map(lt=>lt[it.index]);X.set(it.index,mt)}const et=new Map;for(let it=1;it<N.length;it++){let mt=N[it][C];if(D[it][C]&&String(D[it][C]).startsWith("=")){const at=K5(D[it][C]);at&&(mt=at)}const lt=String(mt||"").trim();lt&&et.set(lt,it)}let V=0,tt=0;const $=Ir(j.name);let z=B.get($);if(z===void 0&&j.alias){const it=Array.isArray(j.alias)?j.alias:[j.alias];for(const mt of it){const lt=B.get(Ir(mt));if(lt!==void 0){z=lt;break}}}for(const it of w){let mt="";if(z!==void 0&&(mt=String(it[z]||"").trim()),!mt||!et.has(mt)){tt++;continue}const lt=et.get(mt);V++;for(const at of H){const rt=X.get(at.index),ct=it[at.dataLookup]!==void 0?it[at.dataLookup]:"";rt[lt]=ct}}if(V===0){c(`Update finished but 0 rows matched. Checked ${w.length} rows, skipped ${tt}.`);const it={success:!0,rowsUpdated:0,rowsSkipped:tt,warning:"No rows matched"};return S||i(it),it}c(`Applying ${V} row updates across ${H.length} columns...`),await Excel.run(async it=>{const lt=it.workbook.worksheets.getItemOrNullObject(e);await it.sync();for(const[at,rt]of X.entries()){const ct=rt.map(ft=>[ft]),ot=G+at,dt=lt.getRangeByIndexes(F,ot,ct.length,1);dt.formulas=ct}if(l&&l.column){const at=Ir(l.column),rt=E.get(at);if(rt!==void 0&&rt>=0){const ct=G+rt;g(lt,ct,l)}}await it.sync()}),c("Update complete.");const Z={success:!0,rowsUpdated:V,rowsSkipped:tt};return S||i(Z),Z}catch(N){console.error("Update error",N),c(`Update error: ${String(N)}`);const D={success:!1,error:String(N)};return S||i(D),D}}async function v(w){if(!t){c("Hybrid action failed: No refresh sheet specified."),i({success:!1,reason:"missing-refresh-sheet"});return}c(`Hybrid Step 1: Refreshing "${t}"...`);const S=await y(w,t,!0);if(!S||!S.success){c(`Hybrid failed during Refresh phase: ${S?.error||S?.reason}`),i(S);return}c(`Hybrid Step 2: Updating "${e}"...`);const N=await b(w,!0),D={success:N.success,refreshResult:S,updateResult:N,rowsWritten:S.rowsWritten,rowsUpdated:N.rowsUpdated,rowsSkipped:N.rowsSkipped};N.success?c("Hybrid action completed successfully."):c(`Hybrid failed during Update phase: ${N.error||N.reason}`),i(D)}return jt.useEffect(()=>{u==="Refresh"?y(n,e,!1):u==="Update"?b(n,!1):u==="Hybrid"?v(n):u&&u!=="None"&&c(`Unknown action: ${u}`)},[n,e,t,u]),null}const FM="/Student-Retention-Add-in/react/dist/assets/AnthologyLogo-Bqd-hqnO.png",zM="/Student-Retention-Add-in/react/dist/assets/CanvasLogo-C1qrkPB_.png",qM="/Student-Retention-Add-in/react/dist/assets/DropoutDetectiveLogo-BnQffZy5.png",UM="/Student-Retention-Add-in/react/dist/assets/MyNUC-icon-CFBmu_CY.png",HM="/Student-Retention-Add-in/react/dist/assets/MissingAssignmentsLogo-DTiCgqfJ.png",Dg="canvas id",x1="course id",$M="days out",VM={"student id":Dg},fc=[{id:"anthology",name:"Anthology Student List",type:"Student List",priority:1,matchColumns:["studentname","studentnumber"],action:"Refresh",icon:FM,customFunction:{column:$M,function:WM,parameter:["LDA"]}},{id:"canvas",name:"Canvas Gradebook",type:"Gradebook Link",priority:2,matchColumns:["student sis","course",x1],action:"Update",icon:zM,rename:VM,excludeFilter:{column:"course",value:"CAPV"},hyperLink:{column:"Grade Book",friendlyName:"Grade Book",linkLocation:"https://nuc.instructure.com/courses/"+x1+"/grades/"+Dg,parameter:[x1,Dg]}},{id:"dropout",name:"Dropout Detective",type:"Grade",priority:3,matchColumns:["email","risk trend","course grade","course missing assignments","course zero assignments"],action:"Update",icon:qM},{id:"missingassignments",name:"Missing Assignments Report",type:"Missing Assignments",priority:4,matchColumns:["current grade","total missing","grade book"],action:"Hybrid",refreshSheet:"Missing Assignments",icon:HM,conditionalFormat:{column:"Missing Assignments",condition:"Highlight Cells with",format:["Specific text","Beginning with","0","Green Fill with Dark Green Text"]},conditionalFormat:{column:"Grade",condition:"Color Scales",format:"G-Y-R Color Scale"}},{id:"attendance",name:"MyNUC Attendance",type:"LDA",priority:5,matchColumns:["issued id","date of attendance"],action:"Update",icon:UM}];fc.find(n=>n.id==="canvas").matchColumns;fc.find(n=>n.id==="anthology").matchColumns;fc.find(n=>n.id==="dropout").matchColumns;fc.find(n=>n.id==="attendance").matchColumns;fc.find(n=>n.id==="missingassignments").matchColumns;function Bg(n=[]){const e=(n||[]).map(t=>String(t||"").toLowerCase().trim());for(const t of fc)if(t.matchColumns.every(o=>e.includes(o)))return{type:t.type,matched:t.matchColumns,action:t.action,icon:t.icon,priority:t.priority||99,hyperLink:t.hyperLink||null,rename:t.rename||null,excludeFilter:t.excludeFilter||null,refreshSheet:t.refreshSheet||null,conditionalFormat:t.conditionalFormat||null,customFunction:t.customFunction||null};return{type:"Standard",matched:[],action:"Refresh",icon:null,priority:99,hyperLink:null,rename:null,excludeFilter:null,refreshSheet:null,conditionalFormat:null,customFunction:null}}function WM(n){if(!n)return null;const e=new Date,t=new Date(n);if(isNaN(t.getTime()))return null;const r=e-t;return Math.floor(r/(1e3*60*60*24))}function tw(n=[],e="workbookSettings"){try{if(typeof window<"u"&&window.Office&&Office.context&&Office.context.document&&Office.context.document.settings){const r=Office.context.document.settings.get(e);if(r&&typeof r=="object")return(!Array.isArray(r.columns)||r.columns.length===0)&&(r.columns=Array.isArray(n)?[...n]:[]),r}}catch(r){console.warn("getWorkbookSettings: failed to read document settings",r)}const t={columns:Array.isArray(n)?[...n]:[]};return console.log("getWorkbookSettings: fallback columns ->",t.columns),t}const GM='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="none" stroke="%23f97316" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="24" height="24" rx="4" fill="%23fff7ed"/><path d="M10 10h12"/><path d="M10 16h12"/><path d="M10 22h8"/></svg>';function YM({file:n,rows:e,type:t,action:r,icon:o,status:s="normal"}={}){const a=n&&(n.name||n.filename)||"Unknown.csv",u=n&&n.size?Math.round(n.size/1024):null,l={normal:"bg-white border-slate-100 shadow-sm hover:shadow-md hover:border-slate-200",completed:"bg-emerald-50/60 border-emerald-200 shadow-sm",pending:"bg-slate-50 border-slate-100 opacity-60 grayscale pointer-events-none",loading:"bg-slate-50 border-slate-100 relative cursor-wait"},i={normal:"bg-slate-50 border-slate-100",completed:"bg-white border-emerald-100",pending:"bg-slate-100 border-slate-200",loading:"bg-slate-100 border-slate-200"};return W.jsxs("div",{title:a,className:`
                w-full group relative
                p-3 rounded-xl border
                transition-all duration-300 ease-in-out
                ${l[s]||l.normal}
            `,children:[W.jsx("style",{children:`
                    @keyframes dot-scale {
                        0%, 100% { transform: scale(0.75); opacity: 0.5; }
                        50% { transform: scale(1.5); opacity: 1; }
                    }
                `}),s==="loading"&&W.jsx("div",{className:"absolute inset-0 z-20 flex items-center justify-center",children:W.jsxs("div",{className:"bg-white px-3 py-2 rounded-full shadow-sm ring-1 ring-purple-100 animate-in fade-in zoom-in duration-200 flex items-center gap-1",children:[W.jsx("div",{className:"w-2 h-2 bg-purple-600 rounded-full",style:{animation:"dot-scale 1.2s infinite ease-in-out both",animationDelay:"0s"}}),W.jsx("div",{className:"w-2 h-2 bg-purple-600 rounded-full",style:{animation:"dot-scale 1.2s infinite ease-in-out both",animationDelay:"0.2s"}}),W.jsx("div",{className:"w-2 h-2 bg-purple-600 rounded-full",style:{animation:"dot-scale 1.2s infinite ease-in-out both",animationDelay:"0.4s"}})]})}),W.jsxs("div",{className:`flex items-center gap-3 ${s==="loading"?"opacity-50 grayscale blur-[0.5px]":""}`,children:[W.jsx("div",{className:`
                    w-11 h-11 flex-none flex items-center justify-center 
                    rounded-lg border overflow-hidden relative
                    ${i[s]||i.normal}
                `,children:o?W.jsx("img",{src:o,alt:"import type",className:"w-8 h-8 object-contain rounded-md"}):/\.csv$/i.test(a)?W.jsx("img",{src:GM,alt:"CSV",className:"w-8 h-8 object-contain rounded-md"}):W.jsx(L7,{size:20,className:"text-slate-400 rounded-md bg-transparent p-1"})}),W.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[W.jsx("div",{className:`text-sm font-semibold truncate pr-2 ${s==="completed"?"text-emerald-900":"text-slate-700"}`,children:a}),W.jsxs("div",{className:"flex items-center justify-between mt-0.5 w-full",children:[W.jsxs("div",{className:`text-xs font-medium whitespace-nowrap truncate min-w-0 ${s==="completed"?"text-emerald-600":"text-slate-400"}`,children:[u!==null?`${u} KB`:"",e!==void 0&&W.jsxs(W.Fragment,{children:[W.jsx("span",{className:`mx-1.5 ${s==="completed"?"text-emerald-400":"text-slate-300"}`,children:""}),W.jsxs("span",{children:[e," rows"]})]})]}),(t||r)&&W.jsxs("div",{className:"flex items-center gap-1.5 ml-2 flex-none",children:[t&&W.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[9px] font-bold border uppercase tracking-wide whitespace-nowrap ${s==="completed"?"bg-white text-emerald-600 border-emerald-100":"bg-indigo-50 text-indigo-600 border-indigo-100"}`,children:t}),r&&W.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[9px] font-bold border uppercase tracking-wide whitespace-nowrap ${s==="completed"?"bg-white text-emerald-600 border-emerald-100":"bg-orange-50 text-orange-600 border-orange-100"}`,children:r})]})]})]})]})]})}const XM="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAADHJJREFUeJztXc2PHEcVf69n9oB27eXDcXJAJLHxR1hOXBBhwu5iZ/2FD6CIAzlwQ5NEXBLEEa5w4cLBw18AAilGsdfrcYgQYiUOwAXkj92NEwskLEVBeD/igHe6ivfqo7uqu+fL657eWs9P8nZP93R39e/36tWrV1XjOoxRKepVF+Bxx1iAijEWoGKMBagYYwEqxliAihGMAG/97b8znVi2YgkgJDTSMxKQ/mIEECEs1yNs1mj/G1/8xPXKCjsEghGAyX8goNEh9qXUxxCSHUDBAmBD1GRrQkkCL1RV1mEQjABs+Ux+TERLqa1egXek3giU6kAtkpWVc1gEIwC7Hbb8HPkG0vyh+tGIBeZvsEsRjAAahvxu/KIRAsY1oAT0Jh8x/Z7sqtDuQ0ACQOLvc4cd8kNDOAIMYPn9vrsbEY4ABehGfkD8hytAjnz0NsEgOAHQYzhs8hlBCYBeI9yD/ICUCEaAgS0fnfMBIBgBUvQnHwOqAoEJMAj5YSEgAfYe+YyABAAd42fde8DkM8IRoKiDlSU/QBWCEWAvks8IRgAPfcjHgMQIT4CByB/3A8qB6gkPQn44VSAcAXpYPjrnQ0M4AgxDfjgVIBwBhiE/IP7DESCLvUA+I0gB9gr5jOAEKCI/F/fn8hW7F0EJMCj543R0CdDkS9/rFJIfFoIRIOtW9gL5jHAEcNCX/ICUCE6AvUQ+IygB/FkR0JX8kDQIRoBBLV9vxmFouehHfkADAuEJ0Jf8kZdoRxiZAJeu3z8bC9kQeoHXD4mn5ShCqEfQPPeFyVv97yA1+V4b4G6GJ//a7fWZjpAtu+ivhrBcM4v8Tjw7PZJFfqULcOXG/Zc6AuBBR/wmVkuM9D+MYDaSvOAOW1dufNSs1QBOHeshRDbXk5DvT1dRu32EeOf9zRkhBGzHsrUt2Sj05TFCowayVadP77y/3hyFCKULsC14haNQW8ErHO0JtaoRkiWm/LkXHhX56tFEPi/468h00Z+6NqLymfVl0YhcWakCkNt56X9k+R1LPlu/fTGTVYilnIUYWlQTYPHGFrmjqd7uaCDyu0dB7XfXF8jyGx36TswL/8AYhUlzCF7kJ5XhtK69d+/lOtXMrz/9yX8M//aDoVQBOuzzi8gHM7yrSSCrg1ljhK3LN7eadTK/00XuyPQD+pOfN9/27Y0XYyrMg1i2Y/oOux1dKEjSHPZKbqfIaBp0vIW6RpzdAQ09UaoAVLVfFXple8FIlnlpe57X9gqcJVFa7BKurmw1Tx9zakMXy0dn31p+1g21391YIDfYVuuM9VLWpAbactj72OWuAgUZDjbikl1R+VEQah8vXd6y+XrU52ORfinKtAne8tMe5CckOogdny/dkxny3eOjimZLFYDCzOVIyHlR8NLJR/Om2vKUhc5ytd+mmrB4c7PJ4p09tu/WMJZvSV5aW1/g2rQtyO1IGJx8VD97ADUuf8mtcakCUFxN/pwaWHpDagfmkwbPILvogtsITGoCzrIPjkiMt25sNLeldNoA6Ol2uPJcWrl3aluIq6pm6cbVPNS5xrsPqIdzQBbRwRpim3/4Y6LkXnWpAtQjO5mEqj+CCvms782teMGEX/UnVo0DEhlCfdd3Yc51mXuphl43ogpMfGL5PchHa/lMPpW7XuNOot4vE6UKcOa5ydWlWx81FUEUatJrzrN1+0nNlHwFtyEUYlZG6oBqmP0Ap6DBVTVIsm5szFel+6A+lm/dTp0tn8ifIOsvM/y0KL0RPnN8cpW3lyjGJwJaSC9JIsyDjUYy5KfQ7sp0kmbRC2O7kG9dnBHKeq1B3Y4hv0nkc+x/51G8fz+MLBdUN40Zmpg0liKT23d3pVcTlCEPQL77OaksQ7qdiRG4HRcjE4BrwtUV445QtMhPzBd30GRGDIC+bqdgWuIglp+4nUg1uNbt3NnZmw6HkaajqXer3NFlDi/JHXVUTbDuaLTkJ24nMtHOCN2Oi0rGAyZqlikd6aiGWcpcqqJM8rkt4gwsu5tRux0XlQhw6ujUant1q4kqVKSGGWA+Vi1u1ncD5KIkc+5hyEfTw2UhmXCO9atwOy4qGxFjEXh75RZ1shBb3Hvi6CgX7ZRCPrZrxuefePpTdx75yw2ByockOfKQJjJSvWC0ibIdkJ/pvKbka1djyFcdxapRuQALR/atXlvbbEZEnqoJMbmjotGZHZOv3Q43umz5TP7c56q1fkblAjBYBN4urW68wr1e9kFCyjnb+X005Keh5slnqifeYlcIYFGLTCNMkRHncuKE9G7kp8f7uZ16hOZfeeV/GCgBLl+/P9OJoRXrxFXD+91B1VNUHZZlnsHAQ3Snj0+WMli98Pn9K2/f3mgaMqkmwJygHrNbE5LNQOQnYeYSkf9q2W7nj3c/nKEefssM+jSyCUc2BiqCnnlB+88ffOK6EoDJ3xay0VHZAVHQ8HF6VjbUaJW+a2k/C/zi4f0rvF16d6MJ/FvR3E9AOeeHqIOSr91OXbud0hNrTD7zGDupc3DKy7NASAT+AdqWOfWCEoAtX1V5Nz9jX0xyDSDq9ZDhyCadTUTcOTNhkHVHEna124lNGl16KXCZ5LOEKXNsOGUoAbTbKSDf7Eo7Y4C+J7xhpfJw8tD0yu/eW2+yCNvkjqjTNhdj6o6y5EcojbvUPdy6GVAxbqd062ew27FZWIXM0KYdq+DviUhbRd1e6vp8b9eZMaBj8xFVAdAi8Pba7XXqrJH7EzgnIDueAGlWUw8jtuva+kfeycKM28m6cg3DoXRqAGGL/k11I987NpoK4GHh8PRK+/a9Ju22TDWfS0YY3axmDX82gfjzWkWJtULL9zhNko0bdqeefMdRr5B8tLWgGrAv5zJw/kjl8KQ0lVEvyatxLh9HM4zYE+781QLy7SHrSOrmw7/o89Hkmh7rsVjlSzc3v33+uX2/LqH4XXHi2emV399ZPxHpRoyjiIaxuE2efcEJVop03hhlmVz84e4HLz8oCmLAs3wFaqfuZgX4C/09qqKdXuSDbpClxMbVla232deePDL1nxLepxDzz0zbHMX3RvXMfvjTB//+NM872paikc48Ts+75POGXSVG8Gf7FSMAqihCRNLzMYW/1Sl1/r6DuS88lmDydQfWzjFNzxUNMGHSsdXHlAA8Lz6K5HcwdmpQlnzzWagZxfh9clNq8trirY3lc8f3/6qMl9vtYLfDli/VhDLZlE4IWkh+hLYWLEfoNMLnZyYvvPn3zR/wQbrZISggP+mXmZQxhYSvcZqgA/DaxRvrv8w2Lt0SZF6KOXeuWycrH9Kl93Dy/96O9O+RXCMzn+01XSIX1yWba6SZLaB9vpm9gckMjkLy7TOI47WvHXzqF/Zckozj3IQi1iTE7EOyOflEZXq4mn/DJ2N9LhqA/Ox+lsjcdQXxNDpl8941ieRkJiZ3rvE+Q8Jo/h6G/Nw9/Gdbn9/L8m02lzuJ2amOqQARLE/wjsBDsZBdB0TsQ5I8ZVJY3cX2yJf+tehOb3PTJc6LurPgbEgnvXukgzX+PexnnxDvGu+zvUYW3EM/O3+PlPxeoWby2eGLvQuTXwNcdilNBJioYVMVHOSH9ODXc/G+czP/s1uIXm6n4Drzovn7QLHl22fk7uGUbYdux5Kfv0f67EJX1YN81OT/pI5qzumP3ddyawCYSbQQR8rDFKSBx+QPQ77N37LX0eRHEGUISgQ4eWTyY94u3tpcpoOv84V2vr6ELiT2Ir+XaM6LVkp+zlc/avJBrY2oactXkc+XP3Pwgft6uRGxc8f3XVy8ufktkzR6c9RzdgYivwcBu4V83uWw01j++a8eeGoRClA4JMkzFdQdhJ7ExEM0QvqNUlI478G28I8v+dbnqwEhbfnqXzcUCnDq6NRF3i6tbH6T2oOGXluFb9hlpqljqor8gv/UreDZVZDvRDs/ZbfD5H/lwJOXoQt6DsqfObbvt+21zbZKgAl4ooPQ0IvuxCFpyuSFiHuF/C6du6LVmTasN7Os1zgxaNzOj54/8KTn74vQd1YEp3fVgmqEZPmQMEOF1iXppUVOU11IPnYh32clJR8z99DH0TdTh3z0n+s8O3tNSj4690jLBG6pXPKd6q58vPM8zZH2+WZgCAZBXwFOHJ762Ox+1x5bWlt/JfnfTQG+RH8/a0o6lSWnK/ngkO9tKiQfJOS/XEj+FiqLhH/Sub/yMyLqyDYOpCmGQfFQ84LOHJm+QJsLD3PtGD521cSsxxFjASrGWICKMRagYowFqBhjASrG/wH92anvmnWdmwAAAABJRU5ErkJggg==",ew=n=>{if(Object.prototype.toString.call(n)==="[object Date]"&&!isNaN(n)){const e=String(n.getUTCMonth()+1).padStart(2,"0"),t=String(n.getUTCDate()).padStart(2,"0"),r=String(n.getUTCFullYear()).slice(-2);return`${e}/${t}/${r}`}if(typeof n=="string"&&n.length>20&&(n.includes("GMT")||n.includes("Standard Time")||n.includes("T"))&&!isNaN(Date.parse(n))){const e=new Date(n);if(!isNaN(e.getTime())){const t=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),o=String(e.getUTCFullYear()).slice(-2);return`${t}/${r}/${o}`}}return n},nw=n=>Array.isArray(n)?n.map(e=>{if(Array.isArray(e))return e.map(ew);if(typeof e=="object"&&e!==null){const t={...e};return Object.keys(t).forEach(r=>{t[r]=ew(t[r])}),t}return e}):n,KM=(n,e,t)=>{if(!t||typeof t!="object")return{data:n,headers:e};const r=u=>u==null?"":String(u).toLowerCase().trim(),o={};Object.keys(t).forEach(u=>{o[r(u)]=t[u]});const s=Array.isArray(e)?e.map(u=>o[r(u)]?o[r(u)]:u):e;let a=n;if(Array.isArray(n)&&n.length>0){const u=n[0];u&&typeof u=="object"&&!Array.isArray(u)&&(a=n.map(l=>{const i={};return Object.keys(l).forEach(c=>{const p=o[r(c)];i[p||c]=l[c]}),i}))}return{data:a,headers:s}},ZM=(n,e)=>{if(!e||!e.column)return n;const t=e.column,r=e.linkLocation||"",o=Array.isArray(e.parameter)?e.parameter:[],s=Array.isArray(n.headers)?[...n.headers]:[],a=n.data;let u=s.findIndex(y=>String(y).toLowerCase().trim()===String(t).toLowerCase().trim());if(u===-1&&(s.push(t),u=s.length-1),!Array.isArray(a)||a.length===0)return{data:a,headers:s};const l=a[0],i=l&&typeof l=="object"&&!Array.isArray(l);let c=[];i||(c=o.map(y=>{const b=String(y).toLowerCase().trim();return s.findIndex(v=>String(v).toLowerCase().trim()===b)}));const p=y=>String(y||"").replace(/"/g,'""'),h=(y,b)=>`=HYPERLINK("${p(y)}","${p(b||y)}")`,f=y=>String(y||"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{data:a.map(y=>{let b=i?{...y}:[...y],v=[];i?v=o.map(D=>{const F=String(D).toLowerCase().trim();if(y[D]!==void 0)return y[D];const G=Object.keys(y).find(P=>String(P).toLowerCase().trim()===F);return G?y[G]:""}):v=c.map(D=>D!==-1&&y[D]!==void 0?y[D]:"");let w=r;if(w&&o.length>0){let D=!1;if(o.forEach((F,G)=>{const P=v[G]==null?"":String(v[G]),U=new RegExp(f(String(F)),"g");U.test(w)&&(w=w.replace(U,encodeURIComponent(P)),D=!0)}),!D||w===r){const F=v.map(G=>encodeURIComponent(String(G||""))).join("/");w=r.endsWith("/")?r+F:r+(r.includes("?")?"&":"/")+F}}else w=o.map((D,F)=>encodeURIComponent(String(v[F]||""))).join("/");const S=e.friendlyName||t||w,N=h(w,S);if(i)b[t]=N;else{for(;b.length<u;)b.push("");b[u]=N}return b}),headers:s}},QM=(n,e)=>{if(!e||!e.column||typeof e.function!="function")return n;const t=e.column,r=e.function,o=Array.isArray(e.parameter)?e.parameter:[],s=Array.isArray(n.headers)?[...n.headers]:[],a=n.data;let u=s.findIndex(h=>String(h).toLowerCase().trim()===String(t).toLowerCase().trim());if(u===-1&&(s.push(t),u=s.length-1),!Array.isArray(a)||a.length===0)return{data:a,headers:s};const l=a[0],i=l&&typeof l=="object"&&!Array.isArray(l);let c=[];return i||(c=o.map(h=>{const f=String(h).toLowerCase().trim();return s.findIndex(g=>String(g).toLowerCase().trim()===f)})),{data:a.map(h=>{let f=i?{...h}:[...h],g=[];i?g=o.map(b=>{const v=String(b).toLowerCase().trim();if(h[b]!==void 0)return h[b];const w=Object.keys(h).find(S=>String(S).toLowerCase().trim()===v);return w?h[w]:null}):g=c.map(b=>b!==-1&&h[b]!==void 0?h[b]:null);let y="";try{y=r(...g),y==null&&(y="")}catch(b){console.warn(`Custom function error for column ${t}:`,b),y="#ERROR"}if(i)f[t]=y;else{for(;f.length<u;)f.push("");f[u]=y}return f}),headers:s}},JM=(n,e,t)=>{if(!t||!t.column||t.value==null||String(t.value).trim()==="")return n;const r=String(t.column).toLowerCase().trim(),o=String(t.value).toLowerCase();if(!Array.isArray(n)||n.length===0)return n;const s=n[0],a=s&&typeof s=="object"&&!Array.isArray(s);let u=n;if(a)u=n.filter(l=>{let i;if(l[t.column]!==void 0)i=l[t.column];else{const c=Object.keys(l).find(p=>String(p).toLowerCase().trim()===r);c&&(i=l[c])}return i==null?!0:String(i).toLowerCase().indexOf(o)===-1});else{let l=-1;Array.isArray(e)&&(l=e.findIndex(i=>String(i).toLowerCase().trim()===r)),l===-1&&Array.isArray(n[0])&&(l=n[0].findIndex(i=>String(i).toLowerCase().trim()===r)),l!==-1&&(u=n.filter(i=>{const c=i[l];return c==null?!0:String(c).toLowerCase().indexOf(o)===-1}))}return u},S1=(n,e)=>{const t=/\.csv$/i.test(n.name),r=/\.xlsx?$/i.test(n.name);if(!t&&!r){e(null);return}const o=new FileReader;o.onload=async s=>{try{let a=[];if(t){const u=s.target.result,l=v6(u);if(Array.isArray(l)&&l.length>0){const i=l[0];a=i&&typeof i=="object"&&!Array.isArray(i)?Object.keys(i):Array.isArray(i)?i:[]}}else{const u=s.target.result,l=await w6(u);if(Array.isArray(l)&&l.length>0){const i=l[0];a=Object.keys(i)}}e(Bg(a))}catch(a){console.error("Error in detectFileInfo:",a),e(null)}},o.onerror=()=>e(null),t?o.readAsText(n.slice(0,64*1024)):o.readAsArrayBuffer(n)};function tL({onImport:n,excludeFilter:e,hyperLink:t,onReady:r}={}){const[o,s]=jt.useState(""),[a,u]=jt.useState(""),[l,i]=jt.useState(null),[c,p]=jt.useState([]),[h,f]=jt.useState([]),[g,y]=jt.useState(-1),[b,v]=jt.useState([]),[w,S]=jt.useState(!1),[N,D]=jt.useState([]),[F,G]=jt.useState(-1),[P,U]=jt.useState(-1),[q,R]=jt.useState(!1),[I,T]=jt.useState(!1),L=jt.useRef(null),[E,x]=jt.useState(!1),k=jt.useCallback((ct,ot)=>{if(!ct)return;s(ct.name),u("Reading file...");const dt=/\.csv$/i.test(ct.name),ft=/\.xlsx?$/i.test(ct.name);if(!dt&&!ft){u("Unsupported file type. Please select .csv or .xlsx");return}const gt=new FileReader;gt.onerror=()=>u("Failed to read file."),gt.onload=async wt=>{try{let yt=[],Et=[];if(dt){const Mt=wt.target.result;yt=nw(v6(Mt))}else{const Mt=wt.target.result,qt=await w6(Mt);yt=nw(qt)}if(Array.isArray(yt)&&yt.length>0){const Mt=yt[0];Mt&&typeof Mt=="object"&&!Array.isArray(Mt)?Et=Object.keys(Mt):Array.isArray(Mt)&&(Et=Mt)}p(Et);try{const Mt=tw(Et);D(Array.isArray(Mt.columns)?[...Mt.columns]:[]),typeof w1.logStaticColumns=="function"&&w1.logStaticColumns(Mt.columns)}catch{}u(`Parsed ${Array.isArray(yt)?yt.length:0} rows`),i(yt),y(ot);try{const Mt=Bg(Et);v(qt=>{const Tt=[...qt];return Tt[ot]=Mt,Tt})}catch{}}catch(yt){u("Error parsing file."),console.error(yt)}},dt?gt.readAsText(ct):gt.readAsArrayBuffer(ct)},[]),A=jt.useCallback(ct=>{if(!ct||ct.length===0)return;const ot=Array.from(ct),dt=/\.(csv|xlsx?)$/i;if(w||q){const ft=new Set,gt=[];ot.forEach(yt=>{yt&&dt.test(yt.name)&&!ft.has(yt.name)&&(gt.push(yt),ft.add(yt.name))}),f(gt),v(gt.map(()=>null)),i(null),p([]),y(-1),S(!1),R(!1),gt.forEach((yt,Et)=>{S1(yt,Mt=>{v(qt=>{const Tt=[...qt];return Tt[Et]=Mt,Tt})})});const wt=gt.findIndex(yt=>dt.test(yt.name));wt!==-1&&k(gt[wt],wt);return}f(ft=>{const gt=[...ft];let wt=!1;return ot.forEach(yt=>{if(!dt.test(yt.name))return;const Et=gt.findIndex(Mt=>Mt.name===yt.name);if(Et!==-1)gt[Et]=yt,v(Mt=>{const qt=[...Mt];return qt[Et]=null,qt}),S1(yt,Mt=>{v(qt=>{const Tt=[...qt];return Tt[Et]=Mt,Tt})}),k(yt,Et);else{const Mt=gt.length;gt.push(yt),v(qt=>[...qt,null]),S1(yt,qt=>{v(Tt=>{const It=[...Tt];return It[Mt]=qt,It})}),wt||(wt=!0,k(yt,Mt))}}),gt})},[w,q,k]),C=c,j=jt.useMemo(()=>Bg(C),[Array.isArray(C)?C.join("|"):String(C)]),B=jt.useMemo(()=>e&&e.column?e:j&&j.excludeFilter,[e,j]),O=jt.useMemo(()=>t&&t.column?t:j&&j.hyperLink,[t,j]),H=jt.useMemo(()=>j&&j.customFunction,[j]),X=jt.useMemo(()=>KM(l,c,j&&j.rename),[l,c,j]),et=jt.useMemo(()=>ZM(X,O),[X,O]),V=jt.useMemo(()=>QM(et,H),[et,H]),tt=jt.useMemo(()=>JM(V.data,V.headers,B),[V,B]),$=jt.useMemo(()=>{const ct=Array.isArray(j&&j.matched)?[...j.matched]:[],ot=j&&j.rename;ot&&Object.values(ot).forEach(gt=>{gt&&!ct.includes(gt)&&ct.push(gt)});const dt=O&&O.column;dt&&!ct.includes(String(dt))&&ct.push(String(dt));const ft=H&&H.column;return ft&&!ct.includes(String(ft))&&ct.push(String(ft)),ct},[j,O,H]),z=()=>{if(!h||h.length===0){u("No file/data to import.");return}const ct=h.map((gt,wt)=>({file:gt,info:b[wt]}));ct.sort((gt,wt)=>{const yt=gt.info&&gt.info.priority?gt.info.priority:99,Et=wt.info&&wt.info.priority?wt.info.priority:99;return yt-Et});const ot=ct.map(gt=>gt.file),dt=ct.map(gt=>gt.info);f(ot),v(dt);const ft=ot.findIndex(gt=>gt&&/\.(csv|xlsx?)$/i.test(gt.name));if(ft===-1){u("No supported files found.");return}G(ft),U(-1),S(!0),R(!1),u(`Starting import 1 of ${ot.length}...`),k(ot[ft],ft)},Z=jt.useCallback(ct=>{if(ct&&ct.success)u(`Import ${F+1} completed.`);else{const ft=ct?.error||ct?.reason||"Unknown error";u(`Import ${F+1} failed: ${ft}`)}const ot=h.length;let dt=F+1;for(;dt<ot&&!/\.(csv|xlsx?)$/i.test(h[dt]?.name);)dt++;dt<ot?(G(dt),U(-1),k(h[dt],dt)):(S(!1),G(-1),y(-1),R(!0),console.log("ImportManager: all files processed."),u("All imports completed."))},[h,F,k]);jt.useEffect(()=>{if(!w||F===-1||g!==F||P===F)return;const ct=tw(c);try{if(ct){const dt=gt=>(gt||"").replace(/\s/g,"").toLowerCase(),ft=ct.columns?.filter(gt=>gt.identifier||gt.identifer)||[];if(ft.length>0){const gt=new Set(c.map(dt));if(!ft.some(yt=>yt.name&&gt.has(dt(yt.name))?!0:[].concat(yt.alias||[]).some(Mt=>Mt&&gt.has(dt(Mt))))){const Et=`Import aborted: Identifier "${ft[0].name||"identifier"}" not found in file.`;console.warn(Et),u(Et),S(!1),G(-1);return}}}}catch{}const ot={file:h[F],data:tt,type:j.type||"csv",matched:$,headers:V.headers||X.headers};typeof n=="function"?n(ot):console.log("Imported data",ot),U(F),u(`Processing import ${F+1} of ${h.length}...`)},[w,F,g,c,tt,j,$,V,X,h,P,n]),jt.useEffect(()=>{r&&r()},[r]);const it=()=>L.current&&(L.current.value=null,L.current.click()),mt=ct=>{ct.preventDefault(),E||x(!0)},lt=ct=>{ct.preventDefault(),x(!1)},at=ct=>{ct.preventDefault(),x(!1),ct.dataTransfer.files?.length>0&&A(ct.dataTransfer.files)},rt=h&&h.length>0;return W.jsxs("div",{className:"w-full max-w-2xl mx-auto bg-white rounded-2xl shadow-xl shadow-slate-200/60 border border-white overflow-hidden p-6 transition-all duration-300",children:[W.jsxs("div",{className:"mb-6",children:[W.jsxs("div",{children:[W.jsx("h2",{className:"text-2xl text-slate-800 font-bold tracking-tight",children:"Import Data"}),W.jsx("p",{className:"text-slate-400 text-sm mt-1",children:rt?"Review your files below":"Upload CSV or Excel files to begin"})]}),a&&W.jsx("div",{className:"mt-3 animate-in fade-in slide-in-from-top-2 duration-300",children:W.jsx("div",{className:"inline-block text-xs font-medium px-3 py-1 bg-slate-100 text-slate-500 rounded-full animate-pulse",children:a})})]}),W.jsxs("div",{role:"button",tabIndex:0,onClick:it,onDragOver:mt,onDragEnter:mt,onDragLeave:lt,onDrop:at,className:`
                    relative group transition-all duration-300 ease-out
                    border-2 border-dashed rounded-2xl cursor-pointer
                    min-h-[320px] flex flex-col
                    ${E?"border-indigo-500 bg-indigo-50/40 scale-[0.99]":"border-slate-200 hover:border-slate-300 hover:bg-slate-50/50"}
                    ${rt?"justify-start p-4":"items-center justify-center p-10"}
                `,children:[rt?W.jsxs("div",{className:"w-full space-y-3 animate-in fade-in slide-in-from-bottom-2 duration-300",children:[h.map((ct,ot)=>{let dt="normal";return q?dt="completed":w&&(ot<F?dt="completed":ot===F?dt="loading":dt="pending"),W.jsx("div",{onClick:ft=>ft.stopPropagation(),children:W.jsx(YM,{file:ct,rows:ot===g&&Array.isArray(l)?l.length:void 0,type:b[ot]&&b[ot].type,action:b[ot]&&b[ot].action,icon:b[ot]&&b[ot].icon,status:dt})},`${ct.name}-${ot}`)}),W.jsx("div",{className:"flex items-center justify-center pt-4 pb-2 opacity-60 group-hover:opacity-100 transition-opacity",children:W.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400 font-medium bg-white/50 px-4 py-2 rounded-full",children:[W.jsx(X7,{size:16}),W.jsx("span",{children:"Drop or click to add more files"})]})})]}):W.jsxs(W.Fragment,{children:[W.jsxs("div",{className:"relative mb-6 pointer-events-none transition-transform duration-300 group-hover:scale-110",children:[W.jsx("div",{className:`transition-colors duration-300 ${E?"text-indigo-500":"text-slate-300"}`,children:W.jsx(T7,{size:64,strokeWidth:1.5})}),W.jsxs("div",{className:"absolute -top-4 -left-12 bg-white p-2.5 rounded-xl shadow-lg border border-slate-50 transform -rotate-12 transition-transform duration-500 group-hover:-translate-x-2 group-hover:-rotate-12",children:[W.jsx(Fv,{size:24,className:"text-emerald-500"}),W.jsx("span",{className:"text-[8px] font-bold text-slate-400 absolute bottom-0.5 right-1",children:"CSV"})]}),W.jsxs("div",{className:"absolute -top-2 -right-10 bg-white p-2.5 rounded-xl shadow-lg border border-slate-50 transform rotate-12 transition-transform duration-500 group-hover:translate-x-2 group-hover:rotate-6",children:[W.jsx(Z7,{size:24,className:"text-green-600"}),W.jsx("span",{className:"text-[8px] font-bold text-slate-400 absolute bottom-0.5 right-1",children:"XLSX"})]})]}),W.jsxs("div",{className:"text-center space-y-2 pointer-events-none",children:[W.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:"Drag & drop"}),W.jsxs("p",{className:"text-sm text-slate-400 font-medium",children:["files here (.csv, .xlsx), or ",W.jsx("span",{className:"text-indigo-500 hover:text-indigo-600 underline decoration-indigo-200 underline-offset-2",children:"browse"})]})]})]}),W.jsx("input",{ref:L,type:"file",accept:".csv, .xlsx, .xls",multiple:!0,className:"hidden",onChange:ct=>ct.target.files?.length&&A(ct.target.files)})]}),W.jsxs("div",{className:"mt-8 border-t border-slate-100 pt-4",children:[W.jsxs("button",{onClick:()=>T(!I),className:"flex items-center gap-2 text-sm font-medium text-slate-500 hover:text-indigo-600 transition-colors w-full justify-between group outline-none",children:[W.jsxs("span",{className:"flex items-center gap-2",children:[W.jsx(bf,{size:16,className:"group-hover:text-indigo-500 transition-colors"}),"Supported Import Types"]}),I?W.jsx(w7,{size:16}):W.jsx(m7,{size:16})]}),W.jsx("div",{className:`grid transition-[grid-template-rows,opacity,margin] duration-300 ease-in-out ${I?"grid-rows-[1fr] opacity-100 mt-4":"grid-rows-[0fr] opacity-0 mt-0"}`,children:W.jsx("div",{className:"overflow-hidden",children:W.jsx("div",{className:"grid gap-3",children:fc.map(ct=>W.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50/80 rounded-xl border border-slate-100 hover:border-indigo-100 transition-colors",children:[ct.icon?W.jsx("img",{src:ct.icon,alt:"",className:"w-8 h-8 object-contain opacity-90 mt-1 rounded-lg"}):W.jsx("div",{className:"w-8 h-8 bg-white rounded-lg border border-slate-100 flex items-center justify-center mt-1 shadow-sm",children:W.jsx(Fv,{size:16,className:"text-slate-400"})}),W.jsxs("div",{className:"min-w-0 flex-1",children:[W.jsx("div",{className:"flex justify-between items-start",children:W.jsx("h4",{className:"text-sm font-semibold text-slate-700 truncate",children:ct.name})}),W.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-1.5",children:[W.jsxs("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full border ${ct.action==="Update"?"bg-amber-50 text-amber-700 border-amber-100":ct.action==="Hybrid"?"bg-purple-50 text-purple-700 border-purple-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,children:[ct.action," Mode"]}),W.jsx("span",{className:"text-[10px] font-medium px-2 py-0.5 rounded-full bg-white border border-slate-200 text-slate-500",children:ct.type})]}),W.jsxs("p",{className:"text-xs text-slate-500 mt-2 leading-relaxed",children:[W.jsx("span",{className:"font-medium text-slate-600",children:"Required Columns:"})," ",W.jsx("span",{className:"font-mono text-indigo-500/90",children:ct.matchColumns.join(", ")})]})]})]},ct.id))})})})]}),l&&!w&&!q&&W.jsx("div",{className:"mt-6 flex justify-center animate-in fade-in slide-in-from-bottom-4 duration-500 fill-mode-forwards",children:W.jsxs("button",{type:"button",onClick:z,className:"group relative flex items-center justify-center gap-3 bg-slate-900 hover:bg-slate-800 text-white px-8 py-3.5 rounded-full shadow-xl shadow-slate-200 hover:shadow-2xl hover:shadow-slate-300 transform transition-all duration-200 hover:-translate-y-0.5 active:translate-y-0 w-full sm:w-auto sm:min-w-[200px]",children:[W.jsx("span",{className:"font-semibold tracking-wide text-sm",children:"Import Data"}),W.jsx("img",{src:XM,alt:"",className:"w-5 h-5 object-contain opacity-90 group-hover:opacity-100 transition-opacity"})]})}),w&&l&&g!==-1&&g===F&&W.jsx("div",{className:"mt-6",children:W.jsx(w1,{data:tt,sheetName:"Master List",refreshSheetName:j.refreshSheet,headers:V.headers||X.headers,settingsColumns:N,matched:$,action:j.action,conditionalFormat:j.conditionalFormat,onComplete:Z,onStatus:ct=>ct&&u(ct)})})]})}const Zu={MASTER_LIST:"Master List",HISTORY:"Student History"},Wa=500,_1=50;function eL(n){if(!n||isNaN(n))return n;const e=new Date(Math.round((n-25569)*86400*1e3)),t=new Date(e.valueOf()+e.getTimezoneOffset()*6e4),r=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),s=String(t.getFullYear()).slice(-2);return`${r}-${o}-${s}`}function nL(n){const e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];if(typeof n=="string"){const l=n.trim().toLowerCase();if(l==="today")return"today";if(l==="tomorrow")return"tomorrow"}let t=null;if(typeof n=="number"){const l=new Date(Math.round((n-25569)*86400*1e3));t=new Date(l.valueOf()+l.getTimezoneOffset()*6e4)}else if(typeof n=="string"){const l=n.trim().match(/^(\d{2})-(\d{2})-(\d{2})$/);if(l){const i=2e3+parseInt(l[3],10),c=parseInt(l[1],10)-1,p=parseInt(l[2],10);t=new Date(i,c,p)}}if(!t||isNaN(t.getTime()))return typeof n=="number"?eL(n):n;const r=new Date;r.setHours(0,0,0,0),t.setHours(0,0,0,0);const o=Math.round((t-r)/(1e3*60*60*24));if(o===0)return"today";if(o===1)return"tomorrow";if(o>=2&&o<=6)return`this ${e[t.getDay()]}`;if(o>=7&&o<=13)return`next ${e[t.getDay()]}`;const s=["January","February","March","April","May","June","July","August","September","October","November","December"],a=t.getDate(),u=a===1||a===21||a===31?"st":a===2||a===22?"nd":a===3||a===23?"rd":"th";return`${s[t.getMonth()]} ${a}${u}`}function rw(n,e,t,r,o,s){if(n&&o.has(n)){const a=o.get(n);if(a&&a.split(",").map(i=>i.trim()).some(i=>i.includes("dnc")&&i!=="dnc - phone"&&i!=="dnc - other phone"))return"Do not contact"}if(n&&e.has(n)){const a=e.get(n);if(a&&a.date){const u=["January","February","March","April","May","June","July","August","September","October","November","December"],l=a.date.getDate(),i=l===1||l===21||l===31?"st":l===2||l===22?"nd":l===3||l===23?"rd":"th";return`[Follow up] Student will engage on ${`${u[a.date.getMonth()]} ${l}${i}`}`}}return typeof t=="number"&&t===0&&s?`Student's next assignment is due ${nL(s)}.`:null}async function rL(n,e,t=null,r=null){try{e&&e("validate","active");let o={};if(typeof Office<"u"&&Office.context&&Office.context.document){const a=Office.context.document.settings.get("workbookSettings");a&&typeof a=="object"&&(o=a)}const s={daysOut:n.daysOut??5,includeFailingList:n.includeFailingList??!1,includeLDATag:n.includeLDATag??!0,includeDNCTag:n.includeDNCTag??!0,sheetNameMode:n.sheetNameMode??"date",columns:o.columns||[]};if(s.columns.length===0)throw new Error("No column settings found. Please configure columns in the Settings tab first.");await Excel.run(async a=>{const u=a.workbook.worksheets;if(u.load("items/name"),await a.sync(),!u.items.some(X=>X.name===Zu.MASTER_LIST))throw new Error(`Workbook missing "${Zu.MASTER_LIST}" sheet.`);e&&e("validate","completed"),e&&e("read","active");const i=u.getItem(Zu.MASTER_LIST),c=i.getUsedRange();c.load("rowCount, columnCount"),await a.sync();const p=c.rowCount,h=c.columnCount;let f=[],g=[];for(let X=0;X<p;X+=Wa){const et=Math.min(Wa,p-X),V=i.getRangeByIndexes(X,0,et,h);if(V.load("values, formulas"),await a.sync(),f=f.concat(V.values),g=g.concat(V.formulas),t&&p>Wa){const tt=Math.floor(X/Wa)+1,$=Math.ceil(p/Wa);t(tt,$,"reading","Master_List")}}const y=f[0],v=Math.min(Math.max(50,Math.floor(12e3/h)),500,p),w=i.getRangeByIndexes(0,0,v,h);let S;try{S=w.getCellProperties({format:{fill:{color:!0}}})}catch(X){console.warn("getCellProperties failed, skipping color mapping",X),S=null}let N=null;if(u.items.some(X=>X.name===Zu.HISTORY)){const et=u.getItem(Zu.HISTORY).getUsedRange();et.load("values"),N=et}await a.sync();let F=null;try{S&&S.value&&(F=S.value)}catch(X){console.warn("Color sample resolution failed, skipping color mapping",X),F=null}const G=X=>{const et=it=>String(it||"").trim().toLowerCase(),V=it=>et(it).replace(/\s+/g,""),tt=V(X),$=s.columns.find(it=>V(it.name)===tt);let z=[];$&&(Array.isArray($.alias)?z=$.alias:$.alias&&(z=[$.alias]));const Z=[X,...z];for(const it of Z){const mt=V(it),lt=y.findIndex(at=>V(at)===mt);if(lt!==-1)return lt}return-1},P=s.columns.filter(X=>G(X.name)!==-1),U=new Set;P.forEach(X=>{const et=G(X.name);et!==-1&&U.add(et)});const q=[...P];y.forEach((X,et)=>{!U.has(et)&&X&&String(X).trim()!==""&&q.push({name:X,hidden:!0})});const R=G("Days Out"),I=G("Grade"),T=G("Student Number");let L=G("Missing Assignments");L===-1&&(L=y.findIndex(X=>String(X).trim().toLowerCase().includes("missing")));let E=G("Next Assignment Due");if(E===-1&&(E=y.findIndex(X=>String(X).trim().toLowerCase().replace(/\s+/g,"")==="nextassignmentdue")),R===-1)throw new Error("Could not find 'Days Out' column in Master List. Check Settings.");e&&e("read","completed");const x=new Map,k=q.map(X=>G(X.name)).filter(X=>X!==-1),A=new Set(["#ffffff","#add8e6"]);if(F){const X=Math.min(F.length,f.length);for(let et=1;et<X;et++)k.forEach(V=>{const tt=f[et][V],$=F[et]?.[V]?.format?.fill?.color,z=String($||"").toLowerCase();tt&&$&&!A.has(z)&&(x.has(V)||x.set(V,new Map),x.get(V).set(String(tt),$))})}e&&e("filter","active");const C=[];for(let X=1;X<f.length;X++){const et=f[X][R];typeof et=="number"&&et>=s.daysOut&&C.push({values:f[X],formulas:g[X],originalIndex:X})}C.sort((X,et)=>(et.values[R]||0)-(X.values[R]||0)),e&&e("filter","completed"),e&&e("failing","active");let j=[];if(s.includeFailingList&&I!==-1){for(let X=1;X<f.length;X++){const et=f[X][I],V=f[X][R],tt=typeof et=="number"&&(et<.6||et>=1&&et<60),$=typeof V=="number"&&V<=4;tt&&$&&j.push({values:f[X],formulas:g[X],originalIndex:X})}j.sort((X,et)=>(X.values[I]||0)-(et.values[I]||0))}e&&e("failing","completed");let B=!1,O=[];const H=G("Campus");if(s.sheetNameMode==="campus"&&H!==-1){const X=new Set;for(let et=1;et<f.length;et++){const V=String(f[et][H]||"").trim();V&&X.add(V)}O=Array.from(X).sort(),B=O.length>1}if(B){e&&e("tags","active");const X=new Map,et=new Map;if(N&&T!==-1){const z=N.values;if(z.length>0){const Z=z[0].map(lt=>String(lt).toLowerCase().trim()),it=Z.findIndex(lt=>lt.includes("student")&&lt.includes("id")||lt.includes("number")),mt=Z.indexOf("tag");if(it!==-1&&mt!==-1){const lt=new Date().setHours(0,0,0,0),at=/\blda\b.*?(\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4})/i;for(let rt=z.length-1;rt>0;rt--){const ct=z[rt][it],ot=String(z[rt][mt]||""),dt=ot.toLowerCase().trim();if(s.includeDNCTag&&ct&&dt.includes("dnc")&&X.set(ct,X.has(ct)?X.get(ct)+", "+dt:dt),s.includeLDATag&&ct&&!et.has(ct)){const ft=ot.match(at);if(ft){const gt=new Date(ft[1]);isNaN(gt.getTime())||(gt.setHours(0,0,0,0),gt>=lt&&et.set(ct,{date:gt,text:ot}))}}}}}}e&&e("tags","completed");const V=new Set;q.forEach(z=>{const Z=G(z.name);if(Z===-1)return;const it=String(f[0][Z]||"").toLowerCase();if(/id|no\.|num|code|zip|postal|social|ssn|phone|grade|score|credit|fee|days|count/i.test(it))return;let lt=0,at=0;const rt=Math.min(f.length,100);for(let ct=1;ct<rt;ct++){const ot=f[ct][Z];typeof ot=="number"&&(at++,ot>10958&&ot<73051&&lt++)}at>0&&lt/at>.5&&V.add(z.name)});const tt=q.findIndex(z=>z.name==="Outreach"),$=(z,Z)=>{const it=[],mt=[];let lt=null,at=[];const rt=z.values[T],ct=L!==-1?z.values[L]:null,ot=E!==-1?z.values[E]:null,dt=rw(rt,et,ct,Z,X,ot),ft=!!dt,gt=dt&&dt.startsWith("Student's next assignment is due");let wt="#FFEDD5";return dt&&dt.includes("DNC")?wt="#FFC7CE":gt&&(wt="#e2efda"),ft&&tt===-1&&(lt=wt),q.forEach((yt,Et)=>{const Mt=G(yt.name);let qt=Mt!==-1?z.values[Mt]:"",Tt=Mt!==-1?z.formulas[Mt]:null;if(yt.name==="Gradebook"&&Tt&&String(Tt).startsWith("=HYPERLINK")||yt.name==="Gradebook"&&qt&&String(qt).startsWith("http")&&(Tt=`=HYPERLINK("${qt}", "Link")`,qt="Link"),ft&&tt!==-1&&Et<=tt&&at.push({colIndex:Et,color:wt}),Mt!==-1&&qt){const It=x.get(Mt);It&&It.has(String(qt))&&at.push({colIndex:Et,color:It.get(String(qt))})}if(yt.name==="Outreach"&&dt&&(qt=dt),s.includeDNCTag&&X.has(rt)){const It=X.get(rt).split(",").map(ae=>ae.trim()),Vt=It.some(ae=>ae==="dnc"),Kt=It.some(ae=>ae==="dnc - phone"),ne=It.some(ae=>ae==="dnc - other phone");yt.name==="Phone"&&(Vt||Kt)&&at.push({colIndex:Et,color:"#FFC7CE",strikethrough:!0}),yt.name==="Other Phone"&&(Vt||ne)&&at.push({colIndex:Et,color:"#FFC7CE",strikethrough:!0})}it.push(qt),mt.push(Tt)}),{cells:it,formulas:mt,rowColor:lt,cellHighlights:at}};e&&e("createSheet","active");for(let z=0;z<O.length;z++){const Z=O[z];r&&r(Z,z,O.length,"active");const it=C.filter(gt=>String(gt.values[H]||"").trim()===Z),mt=j.filter(gt=>String(gt.values[H]||"").trim()===Z);let lt=Z,at=2;u.load("items/name"),await a.sync();const rt=u.items.map(gt=>gt.name);for(;rt.includes(lt);)lt=`${Z} (${at++})`;const ct=u.add(lt);if(z===0&&ct.activate(),await a.sync(),it.length>0)await dp(a,ct,0,`LDA_${z}`,q,it.map(gt=>$(gt,"LDA_Table")),i,G,V,null);else{const gt=ct.getRangeByIndexes(0,0,1,q.length);gt.values=[q.map(wt=>wt.name)]}let ot=it.length+4;if(s.includeFailingList&&mt.length>0){const gt=ct.getRangeByIndexes(ot-1,0,1,1);gt.values=[["Failing Students (Active)"]],gt.format.font.bold=!0,await dp(a,ct,ot,`Failing_${z}`,q,mt.map(wt=>$(wt,"Failing_Table")),i,G,V,null)}ct.getUsedRange().getEntireColumn().format.autofitColumns(),await a.sync();const dt=q.map((gt,wt)=>gt.hidden?wt:-1).filter(gt=>gt!==-1),ft=50;for(let gt=0;gt<dt.length;gt+=ft)dt.slice(gt,gt+ft).forEach(yt=>{ct.getRangeByIndexes(0,yt,1,1).getEntireColumn().columnHidden=!0}),await a.sync();r&&r(Z,z,O.length,"completed")}e&&e("createSheet","completed"),e&&e("format","completed"),e&&e("finalize","completed")}else{e&&e("createSheet","active");let X;if(s.sheetNameMode==="campus"){let ot="";if(H!==-1)for(let dt=1;dt<f.length;dt++){const ft=String(f[dt][H]||"").trim();if(ft){ot=ft;break}}X=ot||"Campus"}else{const ot=new Date;X=`LDA ${`${ot.getMonth()+1}-${ot.getDate()}-${ot.getFullYear()}`}`}let et=X,V=2;const tt=u.items.map(ot=>ot.name);for(;tt.includes(et);)et=`${X} (${V++})`;const $=u.add(et);$.activate(),await a.sync(),e&&e("createSheet","completed"),e&&e("tags","active");const z=new Map,Z=new Map;if(N&&T!==-1){const ot=N.values;if(ot.length>0){const dt=ot[0].map(wt=>String(wt).toLowerCase().trim()),ft=dt.findIndex(wt=>wt.includes("student")&&wt.includes("id")||wt.includes("number")),gt=dt.indexOf("tag");if(ft!==-1&&gt!==-1){const wt=new Date().setHours(0,0,0,0),yt=/\blda\b.*?(\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4})/i;for(let Et=ot.length-1;Et>0;Et--){const Mt=ot[Et][ft],qt=String(ot[Et][gt]||""),Tt=qt.toLowerCase().trim();if(s.includeDNCTag&&Mt&&Tt.includes("dnc")&&z.set(Mt,z.has(Mt)?z.get(Mt)+", "+Tt:Tt),s.includeLDATag&&Mt&&!Z.has(Mt)){const It=qt.match(yt);if(It){const Vt=It[1],Kt=new Date(Vt);isNaN(Kt.getTime())||(Kt.setHours(0,0,0,0),Kt>=wt&&Z.set(Mt,{date:Kt,text:qt}))}}}}}}e&&e("tags","completed"),e&&e("format","active");const it=new Set;q.forEach(ot=>{const dt=G(ot.name);if(dt===-1)return;const ft=String(f[0][dt]||"").toLowerCase();if(/id|no\.|num|code|zip|postal|social|ssn|phone|grade|score|credit|fee|days|count/i.test(ft))return;let wt=0,yt=0;const Et=Math.min(f.length,100);for(let Mt=1;Mt<Et;Mt++){const qt=f[Mt][dt];typeof qt=="number"&&(yt++,qt>10958&&qt<73051&&wt++)}yt>0&&wt/yt>.5&&it.add(ot.name)});const mt=q.findIndex(ot=>ot.name==="Outreach"),lt=(ot,dt)=>{const ft=[],gt=[];let wt=null,yt=[];const Et=ot.values[T],Mt=L!==-1?ot.values[L]:null,qt=E!==-1?ot.values[E]:null,Tt=rw(Et,Z,Mt,dt,z,qt),It=Et&&Z.has(Et),Vt=!!Tt,Kt=Tt&&Tt.startsWith("Student's next assignment is due");let ne="#FFEDD5";return Tt&&Tt.includes("DNC")?ne="#FFC7CE":Kt&&(ne="#e2efda"),Vt&&mt===-1&&(wt=ne),q.forEach((ae,Oe)=>{const le=G(ae.name);let Jt=le!==-1?ot.values[le]:"",ue=le!==-1?ot.formulas[le]:null;if(ae.name==="Gradebook"&&ue&&String(ue).startsWith("=HYPERLINK")||ae.name==="Gradebook"&&Jt&&String(Jt).startsWith("http")&&(ue=`=HYPERLINK("${Jt}", "Link")`,Jt="Link"),Vt&&mt!==-1&&Oe<=mt&&yt.push({colIndex:Oe,color:ne}),le!==-1&&Jt){const ge=x.get(le);ge&&ge.has(String(Jt))&&yt.push({colIndex:Oe,color:ge.get(String(Jt))})}if(ae.name==="Outreach"&&Tt&&(Jt=Tt),s.includeDNCTag&&z.has(Et)){const ge=z.get(Et).split(",").map(ke=>ke.trim()),fe=ge.some(ke=>ke==="dnc"),qe=ge.some(ke=>ke==="dnc - phone"),Be=ge.some(ke=>ke==="dnc - other phone");ae.name==="Phone"&&(fe||qe)&&yt.push({colIndex:Oe,color:"#FFC7CE",strikethrough:!0}),ae.name==="Other Phone"&&(fe||Be)&&yt.push({colIndex:Oe,color:"#FFC7CE",strikethrough:!0})}ft.push(Jt),gt.push(ue)}),{cells:ft,formulas:gt,rowColor:wt,cellHighlights:yt}};if(C.length>0){const ot=t?(dt,ft,gt)=>t(dt,ft,gt,"LDA_Table"):null;await dp(a,$,0,"LDA_Table",q,C.map(dt=>lt(dt,"LDA_Table")),i,G,it,ot)}else{const ot=$.getRangeByIndexes(0,0,1,q.length);ot.values=[q.map(dt=>dt.name)]}let at=C.length+4;if(s.includeFailingList&&j.length>0){const ot=$.getRangeByIndexes(at-1,0,1,1);ot.values=[["Failing Students (Active)"]],ot.format.font.bold=!0;const dt=t?(ft,gt,wt)=>t(ft,gt,wt,"Failing_Table"):null;await dp(a,$,at,"Failing_Table",q,j.map(ft=>lt(ft,"Failing_Table")),i,G,it,dt)}$.getUsedRange().getEntireColumn().format.autofitColumns();const rt=50,ct=q.map((ot,dt)=>ot.hidden?dt:-1).filter(ot=>ot!==-1);for(let ot=0;ot<ct.length;ot+=rt)ct.slice(ot,ot+rt).forEach(ft=>{$.getRangeByIndexes(0,ft,1,1).getEntireColumn().columnHidden=!0}),await a.sync();e&&e("format","completed"),e&&e("finalize","active"),await a.sync(),e&&e("finalize","completed")}})}catch(o){throw console.error("LDA Generation Error:",o),o}}async function dp(n,e,t,r,o,s,a,u,l,i=null){if(s.length===0)return;const c=s.length,p=o.length,h=o.map(F=>F.name),f=e.getRangeByIndexes(t,0,1,p);f.values=[h],await n.sync();const g=Math.ceil(c/Wa);let y=0;for(let F=0;F<c;F+=Wa){const G=Math.min(F+Wa,c),U=s.slice(F,G).map(R=>R.cells),q=e.getRangeByIndexes(t+1+F,0,U.length,p);q.values=U,await n.sync(),y++,i&&i(y,g,"writing")}const b=e.getRangeByIndexes(t,0,c+1,p),v=e.tables.add(b,!0);v.name=r+"_"+Math.floor(Math.random()*1e3),v.style="TableStyleLight9";try{await n.sync()}catch(F){throw console.error(`Table creation sync failed for "${r}" (startRow=${t}, rows=${c}, cols=${p})`,F),F}const w=[];o.forEach((F,G)=>{const P=u(F.name);if(P!==-1){const U=a.getCell(1,P);w.push({sourceCell:U,targetIndex:G,colName:F.name})}});for(let F=0;F<w.length;F+=Wa){const G=w.slice(F,F+Wa);G.forEach(P=>{const U=v.columns.getItemAt(P.targetIndex).getDataBodyRange();U.copyFrom(P.sourceCell,Excel.RangeCopyType.formats),U.format.fill.clear(),l.has(P.colName)&&(U.numberFormat=[["mm-dd-yy;@"]])});try{await n.sync()}catch(P){const U=G.map(q=>q.colName).join(", ");throw console.error(`CF copy sync failed on columns: [${U}]`,P),P}}const S=v.getDataBodyRange(),N=Math.ceil(c/_1);let D=0;for(let F=0;F<c;F+=_1){const G=Math.min(F+_1,c),P=[],U=[],q=[];for(let R=F;R<G;R++){const I=s[R];if(I.rowColor&&P.push({rowIdx:R,color:I.rowColor}),I.cellHighlights.length>0){const T=[...I.cellHighlights].sort((E,x)=>E.colIndex-x.colIndex);let L=null;for(const E of T)L&&L.color===E.color&&L.endCol===E.colIndex-1&&!E.strikethrough&&!L.strikethrough?L.endCol=E.colIndex:(L&&U.push(L),L={rowIdx:R,startCol:E.colIndex,endCol:E.colIndex,color:E.color,strikethrough:E.strikethrough||!1});L&&U.push(L)}I.formulas.forEach((T,L)=>{T&&q.push({rowIdx:R,colIdx:L,formula:T})})}for(const R of P)S.getRow(R.rowIdx).format.fill.color=R.color;for(const R of U){const I=t+1+R.rowIdx,T=e.getRangeByIndexes(I,R.startCol,1,R.endCol-R.startCol+1);T.format.fill.color=R.color,R.strikethrough&&(T.format.font.strikethrough=!0,T.format.font.color="#9C0006")}for(const R of q)S.getCell(R.rowIdx,R.colIdx).formulas=[[R.formula]];try{await n.sync()}catch(R){throw console.error(`Formatting sync failed on batch ${D+1}/${N} (rows ${F}-${G-1}). Ops: ${P.length} rowColor, ${U.length} cellColor, ${q.length} formula.`,R),R}D++,i&&i(D,N,"formatting")}}async function iL(){try{return await Excel.run(async n=>{const e=n.workbook.worksheets;if(e.load("items/name"),await n.sync(),!e.items.some(p=>p.name===Zu.MASTER_LIST))return[];const r=e.getItem(Zu.MASTER_LIST),o=r.getUsedRange();o.load("rowCount, columnCount"),await n.sync();const s=o.rowCount,a=o.columnCount,u=r.getRangeByIndexes(0,0,1,a);u.load("values"),await n.sync();const i=u.values[0].findIndex(p=>String(p||"").trim().toLowerCase().replace(/\s+/g,"")==="campus");if(i===-1)return[];const c=new Set;for(let p=1;p<s;p+=Wa){const h=Math.min(Wa,s-p),f=r.getRangeByIndexes(p,i,h,1);f.load("values"),await n.sync();for(const g of f.values){const y=String(g[0]||"").trim();y&&c.add(y)}}return Array.from(c).sort()})}catch(n){return console.error("Campus detection error:",n),[]}}const k1=[{id:"validate",label:"Validating Workbook Settings"},{id:"read",label:"Reading Master List"},{id:"filter",label:"Filtering by Days Out"},{id:"failing",label:"Filtering by Grades"},{id:"createSheet",label:"Creating Sheet"},{id:"tags",label:"Applying LDA & DNC Tags"},{id:"format",label:"Formatting LDA Table"},{id:"finalize",label:"Finalizing Report"}];function sL({onReady:n}={}){const[e,t]=jt.useState({daysOut:5,includeFailingList:!1,includeLDATag:!0,includeDNCTag:!0,sheetNameMode:"date"}),[r,o]=jt.useState("settings"),[s,a]=jt.useState("main"),[u,l]=jt.useState(""),[i,c]=jt.useState({}),[p,h]=jt.useState(null),[f,g]=jt.useState([]),[y,b]=jt.useState(!1),[v,w]=jt.useState({}),[S,N]=jt.useState(!1);jt.useEffect(()=>{let P=!0;const U=()=>{typeof window<"u"&&window.Office&&Office.context&&Office.context.document&&Office.context.document.settings&&Office.context.document.settings.refreshAsync(q=>{if(q.status===Office.AsyncResultStatus.Succeeded&&P){const R=Office.context.document.settings.get("workbookSettings");R&&typeof R=="object"&&t(I=>({daysOut:R.daysOut!==void 0&&R.daysOut!==null?Number(R.daysOut):I.daysOut,includeFailingList:R.includeFailingList!==void 0?!!R.includeFailingList:I.includeFailingList,includeLDATag:R.includeLDATag!==void 0?!!R.includeLDATag:R.includeLdatTag!==void 0?!!R.includeLdatTag:I.includeLDATag,includeDNCTag:R.includeDNCTag!==void 0?!!R.includeDNCTag:R.includeDncTag!==void 0?!!R.includeDncTag:I.includeDNCTag,sheetNameMode:R.sheetNameMode||I.sheetNameMode}))}})};return U(),typeof window<"u"&&window.Office&&Office.context&&Office.context.document&&Office.context.document.settings&&Office.context.document.settings.addHandlerAsync(Office.EventType.SettingsChanged,U),()=>{P=!1,typeof window<"u"&&window.Office&&Office.context&&Office.context.document&&Office.context.document.settings&&Office.context.document.settings.removeHandlerAsync(Office.EventType.SettingsChanged,U)}},[]),jt.useEffect(()=>{n&&n()},[n]),jt.useEffect(()=>{e.sheetNameMode==="campus"?(b(!0),iL().then(P=>{g(P),b(!1)}).catch(()=>{g([]),b(!1)})):g([])},[e.sheetNameMode]);const D=(P,U)=>{t(q=>({...q,[P]:U}))},F=async()=>{console.log("Starting LDA Creation Process with:",e);const P=e.sheetNameMode==="campus"&&f.length>1;o("processing"),l(""),h(null),N(P);const U={};if(k1.forEach(q=>U[q.id]="pending"),c(U),P){const q={};f.forEach(R=>q[R]="pending"),w(q)}else w({});try{await rL(e,(q,R)=>{c(I=>({...I,[q]:R})),R==="active"&&h(null)},(q,R,I,T)=>{h({current:q,total:R,phase:I,tableName:T})},P?(q,R,I,T)=>{w(L=>({...L,[q]:T}))}:null),h(null),o("done")}catch(q){console.error("LDA Failed:",q),l(q.message||"An unexpected error occurred."),h(null),o("error")}},G=()=>{o("settings"),c({}),l(""),h(null),w({}),N(!1)};return W.jsxs("div",{className:"w-full max-w-2xl mx-auto bg-white rounded-2xl shadow-xl shadow-slate-200/60 border border-white overflow-hidden p-6 transition-all duration-300 min-h-[400px]",children:[W.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[W.jsxs("div",{children:[W.jsx("h2",{className:`text-2xl font-bold tracking-tight ${r==="error"?"text-red-600":"text-slate-800"}`,children:r==="settings"?"Create LDA":r==="done"?"Complete":r==="error"?"Error":"Processing..."}),W.jsx("p",{className:"text-slate-400 text-sm mt-1",children:r==="settings"?"Configure your settings below to generate the report":r==="done"?"Your LDA report has been generated.":r==="error"?"Something went wrong.":"Please wait while we generate your report."})]}),r!=="settings"&&W.jsx("button",{onClick:G,className:"text-slate-400 hover:text-slate-600 transition-colors",title:"Back to Settings",children:W.jsx(gb,{className:"w-5 h-5"})})]}),W.jsxs("div",{className:"relative",children:[r==="settings"&&W.jsxs("section",{className:"flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[W.jsx(aL,{settings:e,onSettingChange:D,settingsView:s,setSettingsView:a}),s==="main"&&W.jsxs("div",{className:"pt-4 border-t border-slate-100 mt-2",children:[W.jsx("button",{type:"button",className:"w-full sm:w-auto bg-[#145F82] hover:bg-[#0f4b66] text-white font-medium px-6 py-2.5 rounded-full shadow-lg shadow-[#145F82]/20 transition-all duration-200 hover:-translate-y-0.5 flex items-center justify-center gap-2",onClick:F,children:"Create LDA"}),W.jsx("div",{className:`transition-all duration-500 ease-in-out overflow-hidden ${e.sheetNameMode==="campus"?"opacity-100 max-h-96 mt-4":"opacity-0 max-h-0 mt-0"}`,children:y?W.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm p-3",children:[W.jsx(Gm,{className:"w-4 h-4 animate-spin"}),W.jsx("span",{children:"Scanning for campuses..."})]}):f.length>1?W.jsxs("div",{className:"bg-slate-50/80 rounded-xl border border-slate-100/80 p-4",children:[W.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[W.jsx("div",{className:"w-5 h-5 rounded-md bg-[#145F82]/10 flex items-center justify-center",children:W.jsx("span",{className:"text-[#145F82] text-xs font-bold",children:f.length})}),W.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Campuses Detected"})]}),W.jsx("div",{className:"space-y-1.5",children:f.map(P=>W.jsxs("div",{className:"flex items-center gap-2.5 text-sm text-slate-600 pl-1",children:[W.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[#145F82]/50"}),W.jsx("span",{children:P})]},P))}),W.jsxs("p",{className:"text-xs text-slate-400 mt-3 pt-3 border-t border-slate-100",children:[f.length," separate LDA sheets will be created"]})]}):f.length===1?W.jsxs("div",{className:"text-sm text-slate-500 p-3 bg-slate-50/80 rounded-xl border border-slate-100/80",children:["1 campus found: ",W.jsx("span",{className:"font-medium text-slate-700",children:f[0]})]}):e.sheetNameMode==="campus"&&!y?W.jsx("div",{className:"text-sm text-slate-400 italic p-3",children:"No Campus column found in Master List"}):null})]})]}),(r==="processing"||r==="done"||r==="error")&&W.jsxs("section",{className:"flex flex-col gap-4 animate-in fade-in slide-in-from-right-8 duration-500",children:[W.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-100 p-4 space-y-3",children:[(S?k1.filter(P=>["validate","read","filter","failing","tags"].includes(P.id)):k1).map(P=>{const U=i[P.id]||"pending",q=(P.id==="format"||P.id==="read")&&U==="active"&&p&&p.total>1;return W.jsxs("div",{children:[W.jsxs("div",{className:"flex items-center gap-3",children:[W.jsxs("div",{className:"w-6 flex justify-center shrink-0",children:[U==="pending"&&W.jsx(Pv,{className:"w-4 h-4 text-slate-300"}),U==="active"&&W.jsx(Gm,{className:"w-5 h-5 text-[#145F82] animate-spin"}),U==="completed"&&W.jsx(Bv,{className:"w-5 h-5 text-emerald-500 animate-in zoom-in duration-300"})]}),W.jsx("div",{className:`flex-1 text-sm font-medium transition-colors duration-300 ${U==="pending"?"text-slate-400":U==="active"?"text-slate-800":"text-emerald-700"}`,children:P.label})]}),q&&W.jsxs("div",{className:"ml-9 mt-2 animate-in fade-in slide-in-from-top-2 duration-300",children:[W.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-1",children:[W.jsxs("span",{children:[p.phase==="reading"?"Reading":p.phase==="writing"?"Writing":"Formatting"," ",p.tableName==="Master_List"?"Master List":p.tableName==="LDA_Table"?"LDA":"Failing"," data"]}),W.jsxs("span",{className:"font-medium",children:[p.current," / ",p.total]})]}),W.jsx("div",{className:"h-1.5 bg-slate-200 rounded-full overflow-hidden",children:W.jsx("div",{className:"h-full bg-[#145F82] rounded-full transition-all duration-300 ease-out",style:{width:`${p.current/p.total*100}%`}})})]})]},P.id)}),S&&Object.keys(v).length>0&&W.jsxs("div",{className:"mt-1 pt-3 border-t border-slate-200/60",children:[W.jsxs("div",{className:"flex items-center gap-2 mb-2.5",children:[W.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Campus Reports"}),W.jsxs("span",{className:"text-xs text-slate-400",children:["(",Object.values(v).filter(P=>P==="completed").length," / ",Object.keys(v).length,")"]})]}),W.jsx("div",{className:"space-y-2",children:Object.entries(v).map(([P,U])=>W.jsxs("div",{className:"flex items-center gap-3 animate-in fade-in duration-300",children:[W.jsxs("div",{className:"w-6 flex justify-center shrink-0",children:[U==="pending"&&W.jsx(Pv,{className:"w-3.5 h-3.5 text-slate-300"}),U==="active"&&W.jsx(Gm,{className:"w-4 h-4 text-[#145F82] animate-spin"}),U==="completed"&&W.jsx(Bv,{className:"w-4 h-4 text-emerald-500 animate-in zoom-in duration-300"})]}),W.jsx("div",{className:`flex-1 text-sm transition-colors duration-300 ${U==="pending"?"text-slate-400":U==="active"?"text-slate-700 font-medium":"text-emerald-600"}`,children:P})]},P))})]})]}),r==="error"&&W.jsxs("div",{className:"pt-2 animate-in fade-in slide-in-from-bottom-2 duration-500",children:[W.jsxs("div",{className:"bg-red-50 text-red-700 px-4 py-3 rounded-lg text-sm font-medium flex items-center gap-3 border border-red-100",children:[W.jsx(S7,{className:"w-5 h-5 shrink-0"}),W.jsx("span",{children:u})]}),W.jsx("button",{onClick:G,className:"mt-4 w-full text-slate-500 hover:text-slate-700 text-sm font-medium hover:underline",children:"Try Again"})]}),r==="done"&&W.jsxs("div",{className:"pt-2 animate-in fade-in slide-in-from-bottom-2 duration-500",children:[W.jsx("div",{className:"bg-emerald-50 text-emerald-700 px-4 py-3 rounded-lg text-sm font-medium flex items-center justify-center border border-emerald-100",children:S?`${Object.keys(v).length} LDA Sheets Generated Successfully!`:"LDA Generated Successfully!"}),W.jsx("button",{onClick:G,className:"mt-4 w-full text-slate-500 hover:text-slate-700 text-sm font-medium hover:underline",children:"Start Over"})]})]})]})]})}function aL({settings:n,onSettingChange:e,settingsView:t,setSettingsView:r}){const o=a=>{e(a,!n[a])},s=(a,u)=>{e(a,u)};return t==="tags"?W.jsxs("div",{className:"flex flex-col gap-4 w-full animate-in fade-in slide-in-from-right-4 duration-300",children:[W.jsxs("button",{type:"button",onClick:()=>r("main"),className:"flex items-center gap-1 text-slate-400 hover:text-slate-600 text-sm font-medium transition-colors w-fit",children:[W.jsx(gb,{className:"w-4 h-4"}),"Back"]}),W.jsx(A1,{label:"Include LDA Tag",isOn:n.includeLDATag,onToggle:()=>o("includeLDATag")},"toggle-lda-tag"),W.jsx(A1,{label:"Include DNC Tag",isOn:n.includeDNCTag,onToggle:()=>o("includeDNCTag")},"toggle-dnc-tag")]}):W.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[W.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50/50 rounded-xl border border-slate-100/50 hover:border-slate-200 transition-colors",children:[W.jsxs("div",{className:"flex items-center gap-2",children:[W.jsx("span",{className:"text-slate-700 font-medium text-sm",children:"Sheet Name"}),W.jsx(bf,{className:"w-4 h-4 text-slate-400 cursor-help hover:text-slate-600"})]}),W.jsxs("div",{className:"relative flex bg-slate-200 rounded-full p-0.5",style:{width:130},children:[W.jsx("button",{type:"button",onClick:()=>s("sheetNameMode","date"),className:`relative z-10 flex-1 py-1 text-xs font-medium rounded-full text-center transition-colors duration-200 ${n.sheetNameMode==="date"?"text-white":"text-slate-500 hover:text-slate-700"}`,children:"Date"}),W.jsx("button",{type:"button",onClick:()=>s("sheetNameMode","campus"),className:`relative z-10 flex-1 py-1 text-xs font-medium rounded-full text-center transition-colors duration-200 ${n.sheetNameMode==="campus"?"text-white":"text-slate-500 hover:text-slate-700"}`,children:"Campus"}),W.jsx("span",{className:"absolute top-0.5 bottom-0.5 rounded-full bg-[#145F82] transition-all duration-200",style:{width:"calc(50% - 2px)",left:n.sheetNameMode==="date"?"2px":"calc(50%)"}})]})]}),W.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50/50 rounded-xl border border-slate-100/50 hover:border-slate-200 transition-colors",children:[W.jsxs("div",{className:"flex items-center gap-2",children:[W.jsx("label",{htmlFor:"daysOut",className:"text-slate-700 font-medium text-sm",children:"Days Out"}),W.jsx("div",{className:"group relative",children:W.jsx(bf,{className:"w-4 h-4 text-slate-400 cursor-help hover:text-slate-600"})})]}),W.jsx("input",{id:"daysOut",type:"number",value:n.daysOut,onChange:a=>s("daysOut",Number(a.target.value)),className:"w-24 border border-slate-200 bg-white rounded-lg px-3 py-1.5 text-right text-sm focus:outline-none focus:ring-2 focus:ring-[#145F82]/20 focus:border-[#145F82] transition-all"})]}),W.jsx(A1,{label:"Include Failing List",isOn:n.includeFailingList,onToggle:()=>o("includeFailingList")},"toggle-failing-list"),W.jsxs("button",{type:"button",onClick:()=>r("tags"),className:"flex items-center justify-between p-3 bg-slate-50/50 rounded-xl border border-slate-100/50 hover:border-slate-200 transition-colors",children:[W.jsxs("div",{className:"flex items-center gap-2",children:[W.jsx("span",{className:"text-slate-700 font-medium text-sm",children:"Tags"}),W.jsx(bf,{className:"w-4 h-4 text-slate-400 cursor-help hover:text-slate-600"})]}),W.jsx(F3,{className:"w-4 h-4 text-slate-400"})]})]})}function A1({label:n,isOn:e,onToggle:t}){return W.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50/50 rounded-xl border border-slate-100/50 hover:border-slate-200 transition-colors",children:[W.jsxs("div",{className:"flex items-center gap-2",children:[W.jsx("span",{className:"text-slate-700 font-medium text-sm",children:n}),W.jsx(bf,{className:"w-4 h-4 text-slate-400 cursor-help hover:text-slate-600"})]}),W.jsx("button",{type:"button",onClick:t,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#145F82]/20 focus:ring-offset-1 ${e?"bg-[#145F82]":"bg-slate-200"}`,children:W.jsx("span",{className:`${e?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white shadow-sm transition-transform duration-200`})})]})}var S6=typeof global=="object"&&global&&global.Object===Object&&global,oL=typeof self=="object"&&self&&self.Object===Object&&self,el=S6||oL||Function("return this")(),Au=el.Symbol,_6=Object.prototype,lL=_6.hasOwnProperty,uL=_6.toString,Sh=Au?Au.toStringTag:void 0;function cL(n){var e=lL.call(n,Sh),t=n[Sh];try{n[Sh]=void 0;var r=!0}catch{}var o=uL.call(n);return r&&(e?n[Sh]=t:delete n[Sh]),o}var fL=Object.prototype,hL=fL.toString;function dL(n){return hL.call(n)}var pL="[object Null]",mL="[object Undefined]",iw=Au?Au.toStringTag:void 0;function Lf(n){return n==null?n===void 0?mL:pL:iw&&iw in Object(n)?cL(n):dL(n)}function Rl(n){return n!=null&&typeof n=="object"}var ic=Array.isArray;function Tu(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}function k6(n){return n}var gL="[object AsyncFunction]",bL="[object Function]",yL="[object GeneratorFunction]",vL="[object Proxy]";function Db(n){if(!Tu(n))return!1;var e=Lf(n);return e==bL||e==yL||e==gL||e==vL}var C1=el["__core-js_shared__"],sw=(function(){var n=/[^.]+$/.exec(C1&&C1.keys&&C1.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function wL(n){return!!sw&&sw in n}var xL=Function.prototype,SL=xL.toString;function hc(n){if(n!=null){try{return SL.call(n)}catch{}try{return n+""}catch{}}return""}var _L=/[\\^$.*+?()[\]{}|]/g,kL=/^\[object .+?Constructor\]$/,AL=Function.prototype,CL=Object.prototype,EL=AL.toString,NL=CL.hasOwnProperty,TL=RegExp("^"+EL.call(NL).replace(_L,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function jL(n){if(!Tu(n)||wL(n))return!1;var e=Db(n)?TL:kL;return e.test(hc(n))}function ML(n,e){return n?.[e]}function dc(n,e){var t=ML(n,e);return jL(t)?t:void 0}var Pg=dc(el,"WeakMap"),aw=Object.create,LL=(function(){function n(){}return function(e){if(!Tu(e))return{};if(aw)return aw(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}})();function OL(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}function RL(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}var IL=800,DL=16,BL=Date.now;function PL(n){var e=0,t=0;return function(){var r=BL(),o=DL-(r-t);if(t=r,o>0){if(++e>=IL)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}function FL(n){return function(){return n}}var Xp=(function(){try{var n=dc(Object,"defineProperty");return n({},"",{}),n}catch{}})(),zL=Xp?function(n,e){return Xp(n,"toString",{configurable:!0,enumerable:!1,value:FL(e),writable:!0})}:k6,qL=PL(zL);function UL(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}var HL=9007199254740991,$L=/^(?:0|[1-9]\d*)$/;function A6(n,e){var t=typeof n;return e=e??HL,!!e&&(t=="number"||t!="symbol"&&$L.test(n))&&n>-1&&n%1==0&&n<e}function Bb(n,e,t){e=="__proto__"&&Xp?Xp(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}function ad(n,e){return n===e||n!==n&&e!==e}var VL=Object.prototype,WL=VL.hasOwnProperty;function C6(n,e,t){var r=n[e];(!(WL.call(n,e)&&ad(r,t))||t===void 0&&!(e in n))&&Bb(n,e,t)}function GL(n,e,t,r){var o=!t;t||(t={});for(var s=-1,a=e.length;++s<a;){var u=e[s],l=void 0;l===void 0&&(l=n[u]),o?Bb(t,u,l):C6(t,u,l)}return t}var ow=Math.max;function YL(n,e,t){return e=ow(e===void 0?n.length-1:e,0),function(){for(var r=arguments,o=-1,s=ow(r.length-e,0),a=Array(s);++o<s;)a[o]=r[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=r[o];return u[e]=t(a),OL(n,this,u)}}function XL(n,e){return qL(YL(n,e,k6),n+"")}var KL=9007199254740991;function E6(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=KL}function b0(n){return n!=null&&E6(n.length)&&!Db(n)}function ZL(n,e,t){if(!Tu(t))return!1;var r=typeof e;return(r=="number"?b0(t)&&A6(e,t.length):r=="string"&&e in t)?ad(t[e],n):!1}function QL(n){return XL(function(e,t){var r=-1,o=t.length,s=o>1?t[o-1]:void 0,a=o>2?t[2]:void 0;for(s=n.length>3&&typeof s=="function"?(o--,s):void 0,a&&ZL(t[0],t[1],a)&&(s=o<3?void 0:s,o=1),e=Object(e);++r<o;){var u=t[r];u&&n(e,u,r,s)}return e})}var JL=Object.prototype;function Pb(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||JL;return n===t}function tO(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var eO="[object Arguments]";function lw(n){return Rl(n)&&Lf(n)==eO}var N6=Object.prototype,nO=N6.hasOwnProperty,rO=N6.propertyIsEnumerable,Fg=lw((function(){return arguments})())?lw:function(n){return Rl(n)&&nO.call(n,"callee")&&!rO.call(n,"callee")};function iO(){return!1}var T6=typeof exports=="object"&&exports&&!exports.nodeType&&exports,uw=T6&&typeof module=="object"&&module&&!module.nodeType&&module,sO=uw&&uw.exports===T6,cw=sO?el.Buffer:void 0,aO=cw?cw.isBuffer:void 0,Gh=aO||iO,oO="[object Arguments]",lO="[object Array]",uO="[object Boolean]",cO="[object Date]",fO="[object Error]",hO="[object Function]",dO="[object Map]",pO="[object Number]",mO="[object Object]",gO="[object RegExp]",bO="[object Set]",yO="[object String]",vO="[object WeakMap]",wO="[object ArrayBuffer]",xO="[object DataView]",SO="[object Float32Array]",_O="[object Float64Array]",kO="[object Int8Array]",AO="[object Int16Array]",CO="[object Int32Array]",EO="[object Uint8Array]",NO="[object Uint8ClampedArray]",TO="[object Uint16Array]",jO="[object Uint32Array]",vi={};vi[SO]=vi[_O]=vi[kO]=vi[AO]=vi[CO]=vi[EO]=vi[NO]=vi[TO]=vi[jO]=!0;vi[oO]=vi[lO]=vi[wO]=vi[uO]=vi[xO]=vi[cO]=vi[fO]=vi[hO]=vi[dO]=vi[pO]=vi[mO]=vi[gO]=vi[bO]=vi[yO]=vi[vO]=!1;function MO(n){return Rl(n)&&E6(n.length)&&!!vi[Lf(n)]}function Fb(n){return function(e){return n(e)}}var j6=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Dh=j6&&typeof module=="object"&&module&&!module.nodeType&&module,LO=Dh&&Dh.exports===j6,E1=LO&&S6.process,Nf=(function(){try{var n=Dh&&Dh.require&&Dh.require("util").types;return n||E1&&E1.binding&&E1.binding("util")}catch{}})(),fw=Nf&&Nf.isTypedArray,zb=fw?Fb(fw):MO,OO=Object.prototype,RO=OO.hasOwnProperty;function M6(n,e){var t=ic(n),r=!t&&Fg(n),o=!t&&!r&&Gh(n),s=!t&&!r&&!o&&zb(n),a=t||r||o||s,u=a?tO(n.length,String):[],l=u.length;for(var i in n)(e||RO.call(n,i))&&!(a&&(i=="length"||o&&(i=="offset"||i=="parent")||s&&(i=="buffer"||i=="byteLength"||i=="byteOffset")||A6(i,l)))&&u.push(i);return u}function L6(n,e){return function(t){return n(e(t))}}var IO=L6(Object.keys,Object),DO=Object.prototype,BO=DO.hasOwnProperty;function PO(n){if(!Pb(n))return IO(n);var e=[];for(var t in Object(n))BO.call(n,t)&&t!="constructor"&&e.push(t);return e}function FO(n){return b0(n)?M6(n):PO(n)}function zO(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var qO=Object.prototype,UO=qO.hasOwnProperty;function HO(n){if(!Tu(n))return zO(n);var e=Pb(n),t=[];for(var r in n)r=="constructor"&&(e||!UO.call(n,r))||t.push(r);return t}function O6(n){return b0(n)?M6(n,!0):HO(n)}var Yh=dc(Object,"create");function $O(){this.__data__=Yh?Yh(null):{},this.size=0}function VO(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var WO="__lodash_hash_undefined__",GO=Object.prototype,YO=GO.hasOwnProperty;function XO(n){var e=this.__data__;if(Yh){var t=e[n];return t===WO?void 0:t}return YO.call(e,n)?e[n]:void 0}var KO=Object.prototype,ZO=KO.hasOwnProperty;function QO(n){var e=this.__data__;return Yh?e[n]!==void 0:ZO.call(e,n)}var JO="__lodash_hash_undefined__";function tR(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Yh&&e===void 0?JO:e,this}function sc(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}sc.prototype.clear=$O;sc.prototype.delete=VO;sc.prototype.get=XO;sc.prototype.has=QO;sc.prototype.set=tR;function eR(){this.__data__=[],this.size=0}function y0(n,e){for(var t=n.length;t--;)if(ad(n[t][0],e))return t;return-1}var nR=Array.prototype,rR=nR.splice;function iR(n){var e=this.__data__,t=y0(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():rR.call(e,t,1),--this.size,!0}function sR(n){var e=this.__data__,t=y0(e,n);return t<0?void 0:e[t][1]}function aR(n){return y0(this.__data__,n)>-1}function oR(n,e){var t=this.__data__,r=y0(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}function Pl(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Pl.prototype.clear=eR;Pl.prototype.delete=iR;Pl.prototype.get=sR;Pl.prototype.has=aR;Pl.prototype.set=oR;var Xh=dc(el,"Map");function lR(){this.size=0,this.__data__={hash:new sc,map:new(Xh||Pl),string:new sc}}function uR(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function v0(n,e){var t=n.__data__;return uR(e)?t[typeof e=="string"?"string":"hash"]:t.map}function cR(n){var e=v0(this,n).delete(n);return this.size-=e?1:0,e}function fR(n){return v0(this,n).get(n)}function hR(n){return v0(this,n).has(n)}function dR(n,e){var t=v0(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}function pc(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}pc.prototype.clear=lR;pc.prototype.delete=cR;pc.prototype.get=fR;pc.prototype.has=hR;pc.prototype.set=dR;function pR(n,e){for(var t=-1,r=e.length,o=n.length;++t<r;)n[o+t]=e[t];return n}var R6=L6(Object.getPrototypeOf,Object),mR="[object Object]",gR=Function.prototype,bR=Object.prototype,I6=gR.toString,yR=bR.hasOwnProperty,vR=I6.call(Object);function wR(n){if(!Rl(n)||Lf(n)!=mR)return!1;var e=R6(n);if(e===null)return!0;var t=yR.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&I6.call(t)==vR}function xR(){this.__data__=new Pl,this.size=0}function SR(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function _R(n){return this.__data__.get(n)}function kR(n){return this.__data__.has(n)}var AR=200;function CR(n,e){var t=this.__data__;if(t instanceof Pl){var r=t.__data__;if(!Xh||r.length<AR-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new pc(r)}return t.set(n,e),this.size=t.size,this}function Qo(n){var e=this.__data__=new Pl(n);this.size=e.size}Qo.prototype.clear=xR;Qo.prototype.delete=SR;Qo.prototype.get=_R;Qo.prototype.has=kR;Qo.prototype.set=CR;var D6=typeof exports=="object"&&exports&&!exports.nodeType&&exports,hw=D6&&typeof module=="object"&&module&&!module.nodeType&&module,ER=hw&&hw.exports===D6,dw=ER?el.Buffer:void 0,pw=dw?dw.allocUnsafe:void 0;function B6(n,e){if(e)return n.slice();var t=n.length,r=pw?pw(t):new n.constructor(t);return n.copy(r),r}function NR(n,e){for(var t=-1,r=n==null?0:n.length,o=0,s=[];++t<r;){var a=n[t];e(a,t,n)&&(s[o++]=a)}return s}function TR(){return[]}var jR=Object.prototype,MR=jR.propertyIsEnumerable,mw=Object.getOwnPropertySymbols,LR=mw?function(n){return n==null?[]:(n=Object(n),NR(mw(n),function(e){return MR.call(n,e)}))}:TR;function OR(n,e,t){var r=e(n);return ic(n)?r:pR(r,t(n))}function zg(n){return OR(n,FO,LR)}var qg=dc(el,"DataView"),Ug=dc(el,"Promise"),Hg=dc(el,"Set"),gw="[object Map]",RR="[object Object]",bw="[object Promise]",yw="[object Set]",vw="[object WeakMap]",ww="[object DataView]",IR=hc(qg),DR=hc(Xh),BR=hc(Ug),PR=hc(Hg),FR=hc(Pg),bo=Lf;(qg&&bo(new qg(new ArrayBuffer(1)))!=ww||Xh&&bo(new Xh)!=gw||Ug&&bo(Ug.resolve())!=bw||Hg&&bo(new Hg)!=yw||Pg&&bo(new Pg)!=vw)&&(bo=function(n){var e=Lf(n),t=e==RR?n.constructor:void 0,r=t?hc(t):"";if(r)switch(r){case IR:return ww;case DR:return gw;case BR:return bw;case PR:return yw;case FR:return vw}return e});var zR=Object.prototype,qR=zR.hasOwnProperty;function UR(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&qR.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var Kp=el.Uint8Array;function qb(n){var e=new n.constructor(n.byteLength);return new Kp(e).set(new Kp(n)),e}function HR(n,e){var t=qb(n.buffer);return new n.constructor(t,n.byteOffset,n.byteLength)}var $R=/\w*$/;function VR(n){var e=new n.constructor(n.source,$R.exec(n));return e.lastIndex=n.lastIndex,e}var xw=Au?Au.prototype:void 0,Sw=xw?xw.valueOf:void 0;function WR(n){return Sw?Object(Sw.call(n)):{}}function P6(n,e){var t=e?qb(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var GR="[object Boolean]",YR="[object Date]",XR="[object Map]",KR="[object Number]",ZR="[object RegExp]",QR="[object Set]",JR="[object String]",tI="[object Symbol]",eI="[object ArrayBuffer]",nI="[object DataView]",rI="[object Float32Array]",iI="[object Float64Array]",sI="[object Int8Array]",aI="[object Int16Array]",oI="[object Int32Array]",lI="[object Uint8Array]",uI="[object Uint8ClampedArray]",cI="[object Uint16Array]",fI="[object Uint32Array]";function hI(n,e,t){var r=n.constructor;switch(e){case eI:return qb(n);case GR:case YR:return new r(+n);case nI:return HR(n);case rI:case iI:case sI:case aI:case oI:case lI:case uI:case cI:case fI:return P6(n,t);case XR:return new r;case KR:case JR:return new r(n);case ZR:return VR(n);case QR:return new r;case tI:return WR(n)}}function F6(n){return typeof n.constructor=="function"&&!Pb(n)?LL(R6(n)):{}}var dI="[object Map]";function pI(n){return Rl(n)&&bo(n)==dI}var _w=Nf&&Nf.isMap,mI=_w?Fb(_w):pI,gI="[object Set]";function bI(n){return Rl(n)&&bo(n)==gI}var kw=Nf&&Nf.isSet,yI=kw?Fb(kw):bI,vI=1,z6="[object Arguments]",wI="[object Array]",xI="[object Boolean]",SI="[object Date]",_I="[object Error]",q6="[object Function]",kI="[object GeneratorFunction]",AI="[object Map]",CI="[object Number]",U6="[object Object]",EI="[object RegExp]",NI="[object Set]",TI="[object String]",jI="[object Symbol]",MI="[object WeakMap]",LI="[object ArrayBuffer]",OI="[object DataView]",RI="[object Float32Array]",II="[object Float64Array]",DI="[object Int8Array]",BI="[object Int16Array]",PI="[object Int32Array]",FI="[object Uint8Array]",zI="[object Uint8ClampedArray]",qI="[object Uint16Array]",UI="[object Uint32Array]",ci={};ci[z6]=ci[wI]=ci[LI]=ci[OI]=ci[xI]=ci[SI]=ci[RI]=ci[II]=ci[DI]=ci[BI]=ci[PI]=ci[AI]=ci[CI]=ci[U6]=ci[EI]=ci[NI]=ci[TI]=ci[jI]=ci[FI]=ci[zI]=ci[qI]=ci[UI]=!0;ci[_I]=ci[q6]=ci[MI]=!1;function Bp(n,e,t,r,o,s){var a,u=e&vI;if(a!==void 0)return a;if(!Tu(n))return n;var l=ic(n);if(l)a=UR(n);else{var i=bo(n),c=i==q6||i==kI;if(Gh(n))return B6(n,u);if(i==U6||i==z6||c&&!o)a=c?{}:F6(n);else{if(!ci[i])return o?n:{};a=hI(n,i,u)}}s||(s=new Qo);var p=s.get(n);if(p)return p;s.set(n,a),yI(n)?n.forEach(function(g){a.add(Bp(g,e,t,g,n,s))}):mI(n)&&n.forEach(function(g,y){a.set(y,Bp(g,e,t,y,n,s))});var h=zg,f=l?void 0:h(n);return UL(f||n,function(g,y){f&&(y=g,g=n[y]),C6(a,y,Bp(g,e,t,y,n,s))}),a}var HI=1,$I=4;function vf(n){return Bp(n,HI|$I)}var VI="__lodash_hash_undefined__";function WI(n){return this.__data__.set(n,VI),this}function GI(n){return this.__data__.has(n)}function Zp(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new pc;++e<t;)this.add(n[e])}Zp.prototype.add=Zp.prototype.push=WI;Zp.prototype.has=GI;function YI(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}function XI(n,e){return n.has(e)}var KI=1,ZI=2;function H6(n,e,t,r,o,s){var a=t&KI,u=n.length,l=e.length;if(u!=l&&!(a&&l>u))return!1;var i=s.get(n),c=s.get(e);if(i&&c)return i==e&&c==n;var p=-1,h=!0,f=t&ZI?new Zp:void 0;for(s.set(n,e),s.set(e,n);++p<u;){var g=n[p],y=e[p];if(r)var b=a?r(y,g,p,e,n,s):r(g,y,p,n,e,s);if(b!==void 0){if(b)continue;h=!1;break}if(f){if(!YI(e,function(v,w){if(!XI(f,w)&&(g===v||o(g,v,t,r,s)))return f.push(w)})){h=!1;break}}else if(!(g===y||o(g,y,t,r,s))){h=!1;break}}return s.delete(n),s.delete(e),h}function QI(n){var e=-1,t=Array(n.size);return n.forEach(function(r,o){t[++e]=[o,r]}),t}function JI(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var tD=1,eD=2,nD="[object Boolean]",rD="[object Date]",iD="[object Error]",sD="[object Map]",aD="[object Number]",oD="[object RegExp]",lD="[object Set]",uD="[object String]",cD="[object Symbol]",fD="[object ArrayBuffer]",hD="[object DataView]",Aw=Au?Au.prototype:void 0,N1=Aw?Aw.valueOf:void 0;function dD(n,e,t,r,o,s,a){switch(t){case hD:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case fD:return!(n.byteLength!=e.byteLength||!s(new Kp(n),new Kp(e)));case nD:case rD:case aD:return ad(+n,+e);case iD:return n.name==e.name&&n.message==e.message;case oD:case uD:return n==e+"";case sD:var u=QI;case lD:var l=r&tD;if(u||(u=JI),n.size!=e.size&&!l)return!1;var i=a.get(n);if(i)return i==e;r|=eD,a.set(n,e);var c=H6(u(n),u(e),r,o,s,a);return a.delete(n),c;case cD:if(N1)return N1.call(n)==N1.call(e)}return!1}var pD=1,mD=Object.prototype,gD=mD.hasOwnProperty;function bD(n,e,t,r,o,s){var a=t&pD,u=zg(n),l=u.length,i=zg(e),c=i.length;if(l!=c&&!a)return!1;for(var p=l;p--;){var h=u[p];if(!(a?h in e:gD.call(e,h)))return!1}var f=s.get(n),g=s.get(e);if(f&&g)return f==e&&g==n;var y=!0;s.set(n,e),s.set(e,n);for(var b=a;++p<l;){h=u[p];var v=n[h],w=e[h];if(r)var S=a?r(w,v,h,e,n,s):r(v,w,h,n,e,s);if(!(S===void 0?v===w||o(v,w,t,r,s):S)){y=!1;break}b||(b=h=="constructor")}if(y&&!b){var N=n.constructor,D=e.constructor;N!=D&&"constructor"in n&&"constructor"in e&&!(typeof N=="function"&&N instanceof N&&typeof D=="function"&&D instanceof D)&&(y=!1)}return s.delete(n),s.delete(e),y}var yD=1,Cw="[object Arguments]",Ew="[object Array]",pp="[object Object]",vD=Object.prototype,Nw=vD.hasOwnProperty;function wD(n,e,t,r,o,s){var a=ic(n),u=ic(e),l=a?Ew:bo(n),i=u?Ew:bo(e);l=l==Cw?pp:l,i=i==Cw?pp:i;var c=l==pp,p=i==pp,h=l==i;if(h&&Gh(n)){if(!Gh(e))return!1;a=!0,c=!1}if(h&&!c)return s||(s=new Qo),a||zb(n)?H6(n,e,t,r,o,s):dD(n,e,l,t,r,o,s);if(!(t&yD)){var f=c&&Nw.call(n,"__wrapped__"),g=p&&Nw.call(e,"__wrapped__");if(f||g){var y=f?n.value():n,b=g?e.value():e;return s||(s=new Qo),o(y,b,t,r,s)}}return h?(s||(s=new Qo),bD(n,e,t,r,o,s)):!1}function $6(n,e,t,r,o){return n===e?!0:n==null||e==null||!Rl(n)&&!Rl(e)?n!==n&&e!==e:wD(n,e,t,r,$6,o)}function xD(n){return function(e,t,r){for(var o=-1,s=Object(e),a=r(e),u=a.length;u--;){var l=a[++o];if(t(s[l],l,s)===!1)break}return e}}var SD=xD();function $g(n,e,t){(t!==void 0&&!ad(n[e],t)||t===void 0&&!(e in n))&&Bb(n,e,t)}function _D(n){return Rl(n)&&b0(n)}function Vg(n,e){if(!(e==="constructor"&&typeof n[e]=="function")&&e!="__proto__")return n[e]}function kD(n){return GL(n,O6(n))}function AD(n,e,t,r,o,s,a){var u=Vg(n,t),l=Vg(e,t),i=a.get(l);if(i){$g(n,t,i);return}var c=s?s(u,l,t+"",n,e,a):void 0,p=c===void 0;if(p){var h=ic(l),f=!h&&Gh(l),g=!h&&!f&&zb(l);c=l,h||f||g?ic(u)?c=u:_D(u)?c=RL(u):f?(p=!1,c=B6(l,!0)):g?(p=!1,c=P6(l,!0)):c=[]:wR(l)||Fg(l)?(c=u,Fg(u)?c=kD(u):(!Tu(u)||Db(u))&&(c=F6(l))):p=!1}p&&(a.set(l,c),o(c,l,r,s,a),a.delete(l)),$g(n,t,c)}function V6(n,e,t,r,o){n!==e&&SD(e,function(s,a){if(o||(o=new Qo),Tu(s))AD(n,e,a,t,V6,r,o);else{var u=r?r(Vg(n,a),s,a+"",n,e,o):void 0;u===void 0&&(u=s),$g(n,a,u)}},O6)}function wu(n,e){return $6(n,e)}var _u=QL(function(n,e,t){V6(n,e,t)}),wn=(n=>(n[n.TYPE=3]="TYPE",n[n.LEVEL=12]="LEVEL",n[n.ATTRIBUTE=13]="ATTRIBUTE",n[n.BLOT=14]="BLOT",n[n.INLINE=7]="INLINE",n[n.BLOCK=11]="BLOCK",n[n.BLOCK_BLOT=10]="BLOCK_BLOT",n[n.INLINE_BLOT=6]="INLINE_BLOT",n[n.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",n[n.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",n[n.ANY=15]="ANY",n))(wn||{});class Jo{constructor(e,t,r={}){this.attrName=e,this.keyName=t;const o=wn.TYPE&wn.ATTRIBUTE;this.scope=r.scope!=null?r.scope&wn.LEVEL|o:wn.ATTRIBUTE,r.whitelist!=null&&(this.whitelist=r.whitelist)}static keys(e){return Array.from(e.attributes).map(t=>t.name)}add(e,t){return this.canAdd(e,t)?(e.setAttribute(this.keyName,t),!0):!1}canAdd(e,t){return this.whitelist==null?!0:typeof t=="string"?this.whitelist.indexOf(t.replace(/["']/g,""))>-1:this.whitelist.indexOf(t)>-1}remove(e){e.removeAttribute(this.keyName)}value(e){const t=e.getAttribute(this.keyName);return this.canAdd(e,t)&&t?t:""}}class wf extends Error{constructor(e){e="[Parchment] "+e,super(e),this.message=e,this.name=this.constructor.name}}const W6=class Wg{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,t=!1){if(e==null)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(t){let r=null;try{r=e.parentNode}catch{return null}return this.find(r,t)}return null}create(e,t,r){const o=this.query(t);if(o==null)throw new wf(`Unable to create ${t} blot`);const s=o,a=t instanceof Node||t.nodeType===Node.TEXT_NODE?t:s.create(r),u=new s(e,a,r);return Wg.blots.set(u.domNode,u),u}find(e,t=!1){return Wg.find(e,t)}query(e,t=wn.ANY){let r;return typeof e=="string"?r=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?r=this.types.text:typeof e=="number"?e&wn.LEVEL&wn.BLOCK?r=this.types.block:e&wn.LEVEL&wn.INLINE&&(r=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some(o=>(r=this.classes[o],!!r)),r=r||this.tags[e.tagName]),r==null?null:"scope"in r&&t&wn.LEVEL&r.scope&&t&wn.TYPE&r.scope?r:null}register(...e){return e.map(t=>{const r="blotName"in t,o="attrName"in t;if(!r&&!o)throw new wf("Invalid definition");if(r&&t.blotName==="abstract")throw new wf("Cannot register abstract class");const s=r?t.blotName:o?t.attrName:void 0;return this.types[s]=t,o?typeof t.keyName=="string"&&(this.attributes[t.keyName]=t):r&&(t.className&&(this.classes[t.className]=t),t.tagName&&(Array.isArray(t.tagName)?t.tagName=t.tagName.map(a=>a.toUpperCase()):t.tagName=t.tagName.toUpperCase(),(Array.isArray(t.tagName)?t.tagName:[t.tagName]).forEach(a=>{(this.tags[a]==null||t.className==null)&&(this.tags[a]=t)}))),t})}};W6.blots=new WeakMap;let Tf=W6;function Tw(n,e){return(n.getAttribute("class")||"").split(/\s+/).filter(t=>t.indexOf(`${e}-`)===0)}class CD extends Jo{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map(t=>t.split("-").slice(0,-1).join("-"))}add(e,t){return this.canAdd(e,t)?(this.remove(e),e.classList.add(`${this.keyName}-${t}`),!0):!1}remove(e){Tw(e,this.keyName).forEach(t=>{e.classList.remove(t)}),e.classList.length===0&&e.removeAttribute("class")}value(e){const t=(Tw(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,t)?t:""}}const ko=CD;function T1(n){const e=n.split("-"),t=e.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("");return e[0]+t}class ED extends Jo{static keys(e){return(e.getAttribute("style")||"").split(";").map(t=>t.split(":")[0].trim())}add(e,t){return this.canAdd(e,t)?(e.style[T1(this.keyName)]=t,!0):!1}remove(e){e.style[T1(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){const t=e.style[T1(this.keyName)];return this.canAdd(e,t)?t:""}}const ju=ED;class ND{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,t){t?e.add(this.domNode,t)&&(e.value(this.domNode)!=null?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};const e=Tf.find(this.domNode);if(e==null)return;const t=Jo.keys(this.domNode),r=ko.keys(this.domNode),o=ju.keys(this.domNode);t.concat(r).concat(o).forEach(s=>{const a=e.scroll.query(s,wn.ATTRIBUTE);a instanceof Jo&&(this.attributes[a.attrName]=a)})}copy(e){Object.keys(this.attributes).forEach(t=>{const r=this.attributes[t].value(this.domNode);e.format(t,r)})}move(e){this.copy(e),Object.keys(this.attributes).forEach(t=>{this.attributes[t].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((e,t)=>(e[t]=this.attributes[t].value(this.domNode),e),{})}}const w0=ND,G6=class{constructor(e,t){this.scroll=e,this.domNode=t,Tf.blots.set(t,this),this.prev=null,this.next=null}static create(e){if(this.tagName==null)throw new wf("Blot definition missing tagName");let t,r;return Array.isArray(this.tagName)?(typeof e=="string"?(r=e.toUpperCase(),parseInt(r,10).toString()===r&&(r=parseInt(r,10))):typeof e=="number"&&(r=e),typeof r=="number"?t=document.createElement(this.tagName[r-1]):r&&this.tagName.indexOf(r)>-1?t=document.createElement(r):t=document.createElement(this.tagName[0])):t=document.createElement(this.tagName),this.className&&t.classList.add(this.className),t}get statics(){return this.constructor}attach(){}clone(){const e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){this.parent!=null&&this.parent.removeChild(this),Tf.blots.delete(this.domNode)}deleteAt(e,t){this.isolate(e,t).remove()}formatAt(e,t,r,o){const s=this.isolate(e,t);if(this.scroll.query(r,wn.BLOT)!=null&&o)s.wrap(r,o);else if(this.scroll.query(r,wn.ATTRIBUTE)!=null){const a=this.scroll.create(this.statics.scope);s.wrap(a),a.format(r,o)}}insertAt(e,t,r){const o=r==null?this.scroll.create("text",t):this.scroll.create(t,r),s=this.split(e);this.parent.insertBefore(o,s||void 0)}isolate(e,t){const r=this.split(e);if(r==null)throw new Error("Attempt to isolate at end");return r.split(t),r}length(){return 1}offset(e=this.parent){return this.parent==null||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,t){const r=typeof e=="string"?this.scroll.create(e,t):e;return this.parent!=null&&(this.parent.insertBefore(r,this.next||void 0),this.remove()),r}split(e,t){return e===0?this:this.next}update(e,t){}wrap(e,t){const r=typeof e=="string"?this.scroll.create(e,t):e;if(this.parent!=null&&this.parent.insertBefore(r,this.next||void 0),typeof r.appendChild!="function")throw new wf(`Cannot wrap ${e}`);return r.appendChild(this),r}};G6.blotName="abstract";let Y6=G6;const X6=class extends Y6{static value(e){return!0}index(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1}position(e,t){let r=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(r+=1),[this.parent.domNode,r]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};X6.scope=wn.INLINE_BLOT;let TD=X6;const Ds=TD;class jD{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){const t=e.slice(1);this.append(...t)}}at(e){const t=this.iterator();let r=t();for(;r&&e>0;)e-=1,r=t();return r}contains(e){const t=this.iterator();let r=t();for(;r;){if(r===e)return!0;r=t()}return!1}indexOf(e){const t=this.iterator();let r=t(),o=0;for(;r;){if(r===e)return o;o+=1,r=t()}return-1}insertBefore(e,t){e!=null&&(this.remove(e),e.next=t,t!=null?(e.prev=t.prev,t.prev!=null&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e)):this.tail!=null?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let t=0,r=this.head;for(;r!=null;){if(r===e)return t;t+=r.length(),r=r.next}return-1}remove(e){this.contains(e)&&(e.prev!=null&&(e.prev.next=e.next),e.next!=null&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{const t=e;return e!=null&&(e=e.next),t}}find(e,t=!1){const r=this.iterator();let o=r();for(;o;){const s=o.length();if(e<s||t&&e===s&&(o.next==null||o.next.length()!==0))return[o,e];e-=s,o=r()}return[null,0]}forEach(e){const t=this.iterator();let r=t();for(;r;)e(r),r=t()}forEachAt(e,t,r){if(t<=0)return;const[o,s]=this.find(e);let a=e-s;const u=this.iterator(o);let l=u();for(;l&&a<e+t;){const i=l.length();e>a?r(l,e-a,Math.min(t,a+i-e)):r(l,0,Math.min(i,e+t-a)),a+=i,l=u()}}map(e){return this.reduce((t,r)=>(t.push(e(r)),t),[])}reduce(e,t){const r=this.iterator();let o=r();for(;o;)t=e(t,o),o=r();return t}}function jw(n,e){const t=e.find(n);if(t)return t;try{return e.create(n)}catch{const r=e.create(wn.INLINE);return Array.from(n.childNodes).forEach(o=>{r.domNode.appendChild(o)}),n.parentNode&&n.parentNode.replaceChild(r.domNode,n),r.attach(),r}}const K6=class vu extends Y6{constructor(e,t){super(e,t),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach(e=>{e.attach()})}attachUI(e){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=e,vu.uiClass&&this.uiNode.classList.add(vu.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new jD,Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode).reverse().forEach(e=>{try{const t=jw(e,this.scroll);this.insertBefore(t,this.children.head||void 0)}catch(t){if(t instanceof wf)return;throw t}})}deleteAt(e,t){if(e===0&&t===this.length())return this.remove();this.children.forEachAt(e,t,(r,o,s)=>{r.deleteAt(o,s)})}descendant(e,t=0){const[r,o]=this.children.find(t);return e.blotName==null&&e(r)||e.blotName!=null&&r instanceof e?[r,o]:r instanceof vu?r.descendant(e,o):[null,-1]}descendants(e,t=0,r=Number.MAX_VALUE){let o=[],s=r;return this.children.forEachAt(t,r,(a,u,l)=>{(e.blotName==null&&e(a)||e.blotName!=null&&a instanceof e)&&o.push(a),a instanceof vu&&(o=o.concat(a.descendants(e,u,s))),s-=l}),o}detach(){this.children.forEach(e=>{e.detach()}),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach(t=>{e||this.statics.allowedChildren.some(r=>t instanceof r)||(t.statics.scope===wn.BLOCK_BLOT?(t.next!=null&&this.splitAfter(t),t.prev!=null&&this.splitAfter(t.prev),t.parent.unwrap(),e=!0):t instanceof vu?t.unwrap():t.remove())})}formatAt(e,t,r,o){this.children.forEachAt(e,t,(s,a,u)=>{s.formatAt(a,u,r,o)})}insertAt(e,t,r){const[o,s]=this.children.find(e);if(o)o.insertAt(s,t,r);else{const a=r==null?this.scroll.create("text",t):this.scroll.create(t,r);this.appendChild(a)}}insertBefore(e,t){e.parent!=null&&e.parent.children.remove(e);let r=null;this.children.insertBefore(e,t||null),e.parent=this,t!=null&&(r=t.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==r)&&this.domNode.insertBefore(e.domNode,r),e.attach()}length(){return this.children.reduce((e,t)=>e+t.length(),0)}moveChildren(e,t){this.children.forEach(r=>{e.insertBefore(r,t)})}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t)}else this.remove()}path(e,t=!1){const[r,o]=this.children.find(e,t),s=[[this,e]];return r instanceof vu?s.concat(r.path(o,t)):(r!=null&&s.push([r,o]),s)}removeChild(e){this.children.remove(e)}replaceWith(e,t){const r=typeof e=="string"?this.scroll.create(e,t):e;return r instanceof vu&&this.moveChildren(r),super.replaceWith(r)}split(e,t=!1){if(!t){if(e===0)return this;if(e===this.length())return this.next}const r=this.clone();return this.parent&&this.parent.insertBefore(r,this.next||void 0),this.children.forEachAt(e,this.length(),(o,s,a)=>{const u=o.split(s,t);u!=null&&r.appendChild(u)}),r}splitAfter(e){const t=this.clone();for(;e.next!=null;)t.appendChild(e.next);return this.parent&&this.parent.insertBefore(t,this.next||void 0),t}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,t){const r=[],o=[];e.forEach(s=>{s.target===this.domNode&&s.type==="childList"&&(r.push(...s.addedNodes),o.push(...s.removedNodes))}),o.forEach(s=>{if(s.parentNode!=null&&s.tagName!=="IFRAME"&&document.body.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const a=this.scroll.find(s);a!=null&&(a.domNode.parentNode==null||a.domNode.parentNode===this.domNode)&&a.detach()}),r.filter(s=>s.parentNode===this.domNode&&s!==this.uiNode).sort((s,a)=>s===a?0:s.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(s=>{let a=null;s.nextSibling!=null&&(a=this.scroll.find(s.nextSibling));const u=jw(s,this.scroll);(u.next!==a||u.next==null)&&(u.parent!=null&&u.parent.removeChild(this),this.insertBefore(u,a||void 0))}),this.enforceAllowedChildren()}};K6.uiClass="";let MD=K6;const xo=MD;function LD(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(n[t]!==e[t])return!1;return!0}const lf=class uf extends xo{static create(e){return super.create(e)}static formats(e,t){const r=t.query(uf.blotName);if(!(r!=null&&e.tagName===r.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new w0(this.domNode)}format(e,t){if(e===this.statics.blotName&&!t)this.children.forEach(r=>{r instanceof uf||(r=r.wrap(uf.blotName,!0)),this.attributes.copy(r)}),this.unwrap();else{const r=this.scroll.query(e,wn.INLINE);if(r==null)return;r instanceof Jo?this.attributes.attribute(r,t):t&&(e!==this.statics.blotName||this.formats()[e]!==t)&&this.replaceWith(e,t)}}formats(){const e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return t!=null&&(e[this.statics.blotName]=t),e}formatAt(e,t,r,o){this.formats()[r]!=null||this.scroll.query(r,wn.ATTRIBUTE)?this.isolate(e,t).format(r,o):super.formatAt(e,t,r,o)}optimize(e){super.optimize(e);const t=this.formats();if(Object.keys(t).length===0)return this.unwrap();const r=this.next;r instanceof uf&&r.prev===this&&LD(t,r.formats())&&(r.moveChildren(this),r.remove())}replaceWith(e,t){const r=super.replaceWith(e,t);return this.attributes.copy(r),r}update(e,t){super.update(e,t),e.some(r=>r.target===this.domNode&&r.type==="attributes")&&this.attributes.build()}wrap(e,t){const r=super.wrap(e,t);return r instanceof uf&&this.attributes.move(r),r}};lf.allowedChildren=[lf,Ds],lf.blotName="inline",lf.scope=wn.INLINE_BLOT,lf.tagName="SPAN";let OD=lf;const Ub=OD,cf=class Gg extends xo{static create(e){return super.create(e)}static formats(e,t){const r=t.query(Gg.blotName);if(!(r!=null&&e.tagName===r.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new w0(this.domNode)}format(e,t){const r=this.scroll.query(e,wn.BLOCK);r!=null&&(r instanceof Jo?this.attributes.attribute(r,t):e===this.statics.blotName&&!t?this.replaceWith(Gg.blotName):t&&(e!==this.statics.blotName||this.formats()[e]!==t)&&this.replaceWith(e,t))}formats(){const e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return t!=null&&(e[this.statics.blotName]=t),e}formatAt(e,t,r,o){this.scroll.query(r,wn.BLOCK)!=null?this.format(r,o):super.formatAt(e,t,r,o)}insertAt(e,t,r){if(r==null||this.scroll.query(t,wn.INLINE)!=null)super.insertAt(e,t,r);else{const o=this.split(e);if(o!=null){const s=this.scroll.create(t,r);o.parent.insertBefore(s,o)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(e,t){const r=super.replaceWith(e,t);return this.attributes.copy(r),r}update(e,t){super.update(e,t),e.some(r=>r.target===this.domNode&&r.type==="attributes")&&this.attributes.build()}};cf.blotName="block",cf.scope=wn.BLOCK_BLOT,cf.tagName="P",cf.allowedChildren=[Ub,cf,Ds];let RD=cf;const Kh=RD,Yg=class extends xo{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,t){super.deleteAt(e,t),this.enforceAllowedChildren()}formatAt(e,t,r,o){super.formatAt(e,t,r,o),this.enforceAllowedChildren()}insertAt(e,t,r){super.insertAt(e,t,r),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Yg.blotName="container",Yg.scope=wn.BLOCK_BLOT;let ID=Yg;const x0=ID;class DD extends Ds{static formats(e,t){}format(e,t){super.formatAt(0,this.length(),e,t)}formatAt(e,t,r,o){e===0&&t===this.length()?this.format(r,o):super.formatAt(e,t,r,o)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Na=DD,BD={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},PD=100,ff=class extends xo{constructor(e,t){super(null,t),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver(r=>{this.update(r)}),this.observer.observe(this.domNode,BD),this.attach()}create(e,t){return this.registry.create(this,e,t)}find(e,t=!1){const r=this.registry.find(e,t);return r?r.scroll===this?r:t?this.find(r.scroll.domNode.parentNode,!0):null:null}query(e,t=wn.ANY){return this.registry.query(e,t)}register(...e){return this.registry.register(...e)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,t){this.update(),e===0&&t===this.length()?this.children.forEach(r=>{r.remove()}):super.deleteAt(e,t)}formatAt(e,t,r,o){this.update(),super.formatAt(e,t,r,o)}insertAt(e,t,r){this.update(),super.insertAt(e,t,r)}optimize(e=[],t={}){super.optimize(t);const r=t.mutationsMap||new WeakMap;let o=Array.from(this.observer.takeRecords());for(;o.length>0;)e.push(o.pop());const s=(l,i=!0)=>{l==null||l===this||l.domNode.parentNode!=null&&(r.has(l.domNode)||r.set(l.domNode,[]),i&&s(l.parent))},a=l=>{r.has(l.domNode)&&(l instanceof xo&&l.children.forEach(a),r.delete(l.domNode),l.optimize(t))};let u=e;for(let l=0;u.length>0;l+=1){if(l>=PD)throw new Error("[Parchment] Maximum optimize iterations reached");for(u.forEach(i=>{const c=this.find(i.target,!0);c!=null&&(c.domNode===i.target&&(i.type==="childList"?(s(this.find(i.previousSibling,!1)),Array.from(i.addedNodes).forEach(p=>{const h=this.find(p,!1);s(h,!1),h instanceof xo&&h.children.forEach(f=>{s(f,!1)})})):i.type==="attributes"&&s(c.prev)),s(c))}),this.children.forEach(a),u=Array.from(this.observer.takeRecords()),o=u.slice();o.length>0;)e.push(o.pop())}}update(e,t={}){e=e||this.observer.takeRecords();const r=new WeakMap;e.map(o=>{const s=this.find(o.target,!0);return s==null?null:r.has(s.domNode)?(r.get(s.domNode).push(o),null):(r.set(s.domNode,[o]),s)}).forEach(o=>{o!=null&&o!==this&&r.has(o.domNode)&&o.update(r.get(o.domNode)||[],t)}),t.mutationsMap=r,r.has(this.domNode)&&super.update(r.get(this.domNode),t),this.optimize(e,t)}};ff.blotName="scroll",ff.defaultChild=Kh,ff.allowedChildren=[Kh,x0],ff.scope=wn.BLOCK_BLOT,ff.tagName="DIV";let FD=ff;const Hb=FD,Xg=class Z6 extends Ds{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,t){super(e,t),this.text=this.statics.value(this.domNode)}deleteAt(e,t){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+t)}index(e,t){return this.domNode===e?t:-1}insertAt(e,t,r){r==null?(this.text=this.text.slice(0,e)+t+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,t,r)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof Z6&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,t=!1){return[this.domNode,e]}split(e,t=!1){if(!t){if(e===0)return this;if(e===this.length())return this.next}const r=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(r,this.next||void 0),this.text=this.statics.value(this.domNode),r}update(e,t){e.some(r=>r.type==="characterData"&&r.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Xg.blotName="text",Xg.scope=wn.INLINE_BLOT;let zD=Xg;const Qp=zD,qD=Object.freeze(Object.defineProperty({__proto__:null,Attributor:Jo,AttributorStore:w0,BlockBlot:Kh,ClassAttributor:ko,ContainerBlot:x0,EmbedBlot:Na,InlineBlot:Ub,LeafBlot:Ds,ParentBlot:xo,Registry:Tf,Scope:wn,ScrollBlot:Hb,StyleAttributor:ju,TextBlot:Qp},Symbol.toStringTag,{value:"Module"}));var mp={exports:{}},j1,Mw;function UD(){if(Mw)return j1;Mw=1;var n=-1,e=1,t=0;function r(R,I,T,L,E){if(R===I)return R?[[t,R]]:[];if(T!=null){var x=U(R,I,T);if(x)return x}var k=u(R,I),A=R.substring(0,k);R=R.substring(k),I=I.substring(k),k=i(R,I);var C=R.substring(R.length-k);R=R.substring(0,R.length-k),I=I.substring(0,I.length-k);var j=o(R,I);return A&&j.unshift([t,A]),C&&j.push([t,C]),w(j,E),L&&p(j),j}function o(R,I){var T;if(!R)return[[e,I]];if(!I)return[[n,R]];var L=R.length>I.length?R:I,E=R.length>I.length?I:R,x=L.indexOf(E);if(x!==-1)return T=[[e,L.substring(0,x)],[t,E],[e,L.substring(x+E.length)]],R.length>I.length&&(T[0][0]=T[2][0]=n),T;if(E.length===1)return[[n,R],[e,I]];var k=c(R,I);if(k){var A=k[0],C=k[1],j=k[2],B=k[3],O=k[4],H=r(A,j),X=r(C,B);return H.concat([[t,O]],X)}return s(R,I)}function s(R,I){for(var T=R.length,L=I.length,E=Math.ceil((T+L)/2),x=E,k=2*E,A=new Array(k),C=new Array(k),j=0;j<k;j++)A[j]=-1,C[j]=-1;A[x+1]=0,C[x+1]=0;for(var B=T-L,O=B%2!==0,H=0,X=0,et=0,V=0,tt=0;tt<E;tt++){for(var $=-tt+H;$<=tt-X;$+=2){var z=x+$,Z;$===-tt||$!==tt&&A[z-1]<A[z+1]?Z=A[z+1]:Z=A[z-1]+1;for(var it=Z-$;Z<T&&it<L&&R.charAt(Z)===I.charAt(it);)Z++,it++;if(A[z]=Z,Z>T)X+=2;else if(it>L)H+=2;else if(O){var mt=x+B-$;if(mt>=0&&mt<k&&C[mt]!==-1){var lt=T-C[mt];if(Z>=lt)return a(R,I,Z,it)}}}for(var at=-tt+et;at<=tt-V;at+=2){var mt=x+at,lt;at===-tt||at!==tt&&C[mt-1]<C[mt+1]?lt=C[mt+1]:lt=C[mt-1]+1;for(var rt=lt-at;lt<T&&rt<L&&R.charAt(T-lt-1)===I.charAt(L-rt-1);)lt++,rt++;if(C[mt]=lt,lt>T)V+=2;else if(rt>L)et+=2;else if(!O){var z=x+B-at;if(z>=0&&z<k&&A[z]!==-1){var Z=A[z],it=x+Z-z;if(lt=T-lt,Z>=lt)return a(R,I,Z,it)}}}}return[[n,R],[e,I]]}function a(R,I,T,L){var E=R.substring(0,T),x=I.substring(0,L),k=R.substring(T),A=I.substring(L),C=r(E,x),j=r(k,A);return C.concat(j)}function u(R,I){if(!R||!I||R.charAt(0)!==I.charAt(0))return 0;for(var T=0,L=Math.min(R.length,I.length),E=L,x=0;T<E;)R.substring(x,E)==I.substring(x,E)?(T=E,x=T):L=E,E=Math.floor((L-T)/2+T);return S(R.charCodeAt(E-1))&&E--,E}function l(R,I){var T=R.length,L=I.length;if(T==0||L==0)return 0;T>L?R=R.substring(T-L):T<L&&(I=I.substring(0,T));var E=Math.min(T,L);if(R==I)return E;for(var x=0,k=1;;){var A=R.substring(E-k),C=I.indexOf(A);if(C==-1)return x;k+=C,(C==0||R.substring(E-k)==I.substring(0,k))&&(x=k,k++)}}function i(R,I){if(!R||!I||R.slice(-1)!==I.slice(-1))return 0;for(var T=0,L=Math.min(R.length,I.length),E=L,x=0;T<E;)R.substring(R.length-E,R.length-x)==I.substring(I.length-E,I.length-x)?(T=E,x=T):L=E,E=Math.floor((L-T)/2+T);return N(R.charCodeAt(R.length-E))&&E--,E}function c(R,I){var T=R.length>I.length?R:I,L=R.length>I.length?I:R;if(T.length<4||L.length*2<T.length)return null;function E(X,et,V){for(var tt=X.substring(V,V+Math.floor(X.length/4)),$=-1,z="",Z,it,mt,lt;($=et.indexOf(tt,$+1))!==-1;){var at=u(X.substring(V),et.substring($)),rt=i(X.substring(0,V),et.substring(0,$));z.length<rt+at&&(z=et.substring($-rt,$)+et.substring($,$+at),Z=X.substring(0,V-rt),it=X.substring(V+at),mt=et.substring(0,$-rt),lt=et.substring($+at))}return z.length*2>=X.length?[Z,it,mt,lt,z]:null}var x=E(T,L,Math.ceil(T.length/4)),k=E(T,L,Math.ceil(T.length/2)),A;if(!x&&!k)return null;k?x?A=x[4].length>k[4].length?x:k:A=k:A=x;var C,j,B,O;R.length>I.length?(C=A[0],j=A[1],B=A[2],O=A[3]):(B=A[0],O=A[1],C=A[2],j=A[3]);var H=A[4];return[C,j,B,O,H]}function p(R){for(var I=!1,T=[],L=0,E=null,x=0,k=0,A=0,C=0,j=0;x<R.length;)R[x][0]==t?(T[L++]=x,k=C,A=j,C=0,j=0,E=R[x][1]):(R[x][0]==e?C+=R[x][1].length:j+=R[x][1].length,E&&E.length<=Math.max(k,A)&&E.length<=Math.max(C,j)&&(R.splice(T[L-1],0,[n,E]),R[T[L-1]+1][0]=e,L--,L--,x=L>0?T[L-1]:-1,k=0,A=0,C=0,j=0,E=null,I=!0)),x++;for(I&&w(R),v(R),x=1;x<R.length;){if(R[x-1][0]==n&&R[x][0]==e){var B=R[x-1][1],O=R[x][1],H=l(B,O),X=l(O,B);H>=X?(H>=B.length/2||H>=O.length/2)&&(R.splice(x,0,[t,O.substring(0,H)]),R[x-1][1]=B.substring(0,B.length-H),R[x+1][1]=O.substring(H),x++):(X>=B.length/2||X>=O.length/2)&&(R.splice(x,0,[t,B.substring(0,X)]),R[x-1][0]=e,R[x-1][1]=O.substring(0,O.length-X),R[x+1][0]=n,R[x+1][1]=B.substring(X),x++),x++}x++}}var h=/[^a-zA-Z0-9]/,f=/\s/,g=/[\r\n]/,y=/\n\r?\n$/,b=/^\r?\n\r?\n/;function v(R){function I(X,et){if(!X||!et)return 6;var V=X.charAt(X.length-1),tt=et.charAt(0),$=V.match(h),z=tt.match(h),Z=$&&V.match(f),it=z&&tt.match(f),mt=Z&&V.match(g),lt=it&&tt.match(g),at=mt&&X.match(y),rt=lt&&et.match(b);return at||rt?5:mt||lt?4:$&&!Z&&it?3:Z||it?2:$||z?1:0}for(var T=1;T<R.length-1;){if(R[T-1][0]==t&&R[T+1][0]==t){var L=R[T-1][1],E=R[T][1],x=R[T+1][1],k=i(L,E);if(k){var A=E.substring(E.length-k);L=L.substring(0,L.length-k),E=A+E.substring(0,E.length-k),x=A+x}for(var C=L,j=E,B=x,O=I(L,E)+I(E,x);E.charAt(0)===x.charAt(0);){L+=E.charAt(0),E=E.substring(1)+x.charAt(0),x=x.substring(1);var H=I(L,E)+I(E,x);H>=O&&(O=H,C=L,j=E,B=x)}R[T-1][1]!=C&&(C?R[T-1][1]=C:(R.splice(T-1,1),T--),R[T][1]=j,B?R[T+1][1]=B:(R.splice(T+1,1),T--))}T++}}function w(R,I){R.push([t,""]);for(var T=0,L=0,E=0,x="",k="",A;T<R.length;){if(T<R.length-1&&!R[T][1]){R.splice(T,1);continue}switch(R[T][0]){case e:E++,k+=R[T][1],T++;break;case n:L++,x+=R[T][1],T++;break;case t:var C=T-E-L-1;if(I){if(C>=0&&F(R[C][1])){var j=R[C][1].slice(-1);if(R[C][1]=R[C][1].slice(0,-1),x=j+x,k=j+k,!R[C][1]){R.splice(C,1),T--;var B=C-1;R[B]&&R[B][0]===e&&(E++,k=R[B][1]+k,B--),R[B]&&R[B][0]===n&&(L++,x=R[B][1]+x,B--),C=B}}if(D(R[T][1])){var j=R[T][1].charAt(0);R[T][1]=R[T][1].slice(1),x+=j,k+=j}}if(T<R.length-1&&!R[T][1]){R.splice(T,1);break}if(x.length>0||k.length>0){x.length>0&&k.length>0&&(A=u(k,x),A!==0&&(C>=0?R[C][1]+=k.substring(0,A):(R.splice(0,0,[t,k.substring(0,A)]),T++),k=k.substring(A),x=x.substring(A)),A=i(k,x),A!==0&&(R[T][1]=k.substring(k.length-A)+R[T][1],k=k.substring(0,k.length-A),x=x.substring(0,x.length-A)));var O=E+L;x.length===0&&k.length===0?(R.splice(T-O,O),T=T-O):x.length===0?(R.splice(T-O,O,[e,k]),T=T-O+1):k.length===0?(R.splice(T-O,O,[n,x]),T=T-O+1):(R.splice(T-O,O,[n,x],[e,k]),T=T-O+2)}T!==0&&R[T-1][0]===t?(R[T-1][1]+=R[T][1],R.splice(T,1)):T++,E=0,L=0,x="",k="";break}}R[R.length-1][1]===""&&R.pop();var H=!1;for(T=1;T<R.length-1;)R[T-1][0]===t&&R[T+1][0]===t&&(R[T][1].substring(R[T][1].length-R[T-1][1].length)===R[T-1][1]?(R[T][1]=R[T-1][1]+R[T][1].substring(0,R[T][1].length-R[T-1][1].length),R[T+1][1]=R[T-1][1]+R[T+1][1],R.splice(T-1,1),H=!0):R[T][1].substring(0,R[T+1][1].length)==R[T+1][1]&&(R[T-1][1]+=R[T+1][1],R[T][1]=R[T][1].substring(R[T+1][1].length)+R[T+1][1],R.splice(T+1,1),H=!0)),T++;H&&w(R,I)}function S(R){return R>=55296&&R<=56319}function N(R){return R>=56320&&R<=57343}function D(R){return N(R.charCodeAt(0))}function F(R){return S(R.charCodeAt(R.length-1))}function G(R){for(var I=[],T=0;T<R.length;T++)R[T][1].length>0&&I.push(R[T]);return I}function P(R,I,T,L){return F(R)||D(L)?null:G([[t,R],[n,I],[e,T],[t,L]])}function U(R,I,T){var L=typeof T=="number"?{index:T,length:0}:T.oldRange,E=typeof T=="number"?null:T.newRange,x=R.length,k=I.length;if(L.length===0&&(E===null||E.length===0)){var A=L.index,C=R.slice(0,A),j=R.slice(A),B=E?E.index:null;t:{var O=A+k-x;if(B!==null&&B!==O||O<0||O>k)break t;var H=I.slice(0,O),X=I.slice(O);if(X!==j)break t;var et=Math.min(A,O),V=C.slice(0,et),tt=H.slice(0,et);if(V!==tt)break t;var $=C.slice(et),z=H.slice(et);return P(V,$,z,j)}t:{if(B!==null&&B!==A)break t;var Z=A,H=I.slice(0,Z),X=I.slice(Z);if(H!==C)break t;var it=Math.min(x-Z,k-Z),mt=j.slice(j.length-it),lt=X.slice(X.length-it);if(mt!==lt)break t;var $=j.slice(0,j.length-it),z=X.slice(0,X.length-it);return P(C,$,z,mt)}}if(L.length>0&&E&&E.length===0)t:{var V=R.slice(0,L.index),mt=R.slice(L.index+L.length),et=V.length,it=mt.length;if(k<et+it)break t;var tt=I.slice(0,et),lt=I.slice(k-it);if(V!==tt||mt!==lt)break t;var $=R.slice(et,x-it),z=I.slice(et,k-it);return P(V,$,z,mt)}return null}function q(R,I,T,L){return r(R,I,T,L,!0)}return q.INSERT=e,q.DELETE=n,q.EQUAL=t,j1=q,j1}var Nh={exports:{}};Nh.exports;var Lw;function Q6(){return Lw||(Lw=1,(function(n,e){var t=200,r="__lodash_hash_undefined__",o=9007199254740991,s="[object Arguments]",a="[object Array]",u="[object Boolean]",l="[object Date]",i="[object Error]",c="[object Function]",p="[object GeneratorFunction]",h="[object Map]",f="[object Number]",g="[object Object]",y="[object Promise]",b="[object RegExp]",v="[object Set]",w="[object String]",S="[object Symbol]",N="[object WeakMap]",D="[object ArrayBuffer]",F="[object DataView]",G="[object Float32Array]",P="[object Float64Array]",U="[object Int8Array]",q="[object Int16Array]",R="[object Int32Array]",I="[object Uint8Array]",T="[object Uint8ClampedArray]",L="[object Uint16Array]",E="[object Uint32Array]",x=/[\\^$.*+?()[\]{}|]/g,k=/\w*$/,A=/^\[object .+?Constructor\]$/,C=/^(?:0|[1-9]\d*)$/,j={};j[s]=j[a]=j[D]=j[F]=j[u]=j[l]=j[G]=j[P]=j[U]=j[q]=j[R]=j[h]=j[f]=j[g]=j[b]=j[v]=j[w]=j[S]=j[I]=j[T]=j[L]=j[E]=!0,j[i]=j[c]=j[N]=!1;var B=typeof Gn=="object"&&Gn&&Gn.Object===Object&&Gn,O=typeof self=="object"&&self&&self.Object===Object&&self,H=B||O||Function("return this")(),X=e&&!e.nodeType&&e,et=X&&!0&&n&&!n.nodeType&&n,V=et&&et.exports===X;function tt(ut,At){return ut.set(At[0],At[1]),ut}function $(ut,At){return ut.add(At),ut}function z(ut,At){for(var Ft=-1,ce=ut?ut.length:0;++Ft<ce&&At(ut[Ft],Ft,ut)!==!1;);return ut}function Z(ut,At){for(var Ft=-1,ce=At.length,An=ut.length;++Ft<ce;)ut[An+Ft]=At[Ft];return ut}function it(ut,At,Ft,ce){for(var An=-1,en=ut?ut.length:0;++An<en;)Ft=At(Ft,ut[An],An,ut);return Ft}function mt(ut,At){for(var Ft=-1,ce=Array(ut);++Ft<ut;)ce[Ft]=At(Ft);return ce}function lt(ut,At){return ut?.[At]}function at(ut){var At=!1;if(ut!=null&&typeof ut.toString!="function")try{At=!!(ut+"")}catch{}return At}function rt(ut){var At=-1,Ft=Array(ut.size);return ut.forEach(function(ce,An){Ft[++At]=[An,ce]}),Ft}function ct(ut,At){return function(Ft){return ut(At(Ft))}}function ot(ut){var At=-1,Ft=Array(ut.size);return ut.forEach(function(ce){Ft[++At]=ce}),Ft}var dt=Array.prototype,ft=Function.prototype,gt=Object.prototype,wt=H["__core-js_shared__"],yt=(function(){var ut=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||"");return ut?"Symbol(src)_1."+ut:""})(),Et=ft.toString,Mt=gt.hasOwnProperty,qt=gt.toString,Tt=RegExp("^"+Et.call(Mt).replace(x,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),It=V?H.Buffer:void 0,Vt=H.Symbol,Kt=H.Uint8Array,ne=ct(Object.getPrototypeOf,Object),ae=Object.create,Oe=gt.propertyIsEnumerable,le=dt.splice,Jt=Object.getOwnPropertySymbols,ue=It?It.isBuffer:void 0,ge=ct(Object.keys,Object),fe=Kn(H,"DataView"),qe=Kn(H,"Map"),Be=Kn(H,"Promise"),ke=Kn(H,"Set"),Je=Kn(H,"WeakMap"),Fe=Kn(Object,"create"),Me=Lr(fe),Ke=Lr(qe),En=Lr(Be),Xe=Lr(ke),Sn=Lr(Je),Nn=Vt?Vt.prototype:void 0,Te=Nn?Nn.valueOf:void 0;function _n(ut){var At=-1,Ft=ut?ut.length:0;for(this.clear();++At<Ft;){var ce=ut[At];this.set(ce[0],ce[1])}}function Pn(){this.__data__=Fe?Fe(null):{}}function on(ut){return this.has(ut)&&delete this.__data__[ut]}function Dt(ut){var At=this.__data__;if(Fe){var Ft=At[ut];return Ft===r?void 0:Ft}return Mt.call(At,ut)?At[ut]:void 0}function Ht(ut){var At=this.__data__;return Fe?At[ut]!==void 0:Mt.call(At,ut)}function re(ut,At){var Ft=this.__data__;return Ft[ut]=Fe&&At===void 0?r:At,this}_n.prototype.clear=Pn,_n.prototype.delete=on,_n.prototype.get=Dt,_n.prototype.has=Ht,_n.prototype.set=re;function we(ut){var At=-1,Ft=ut?ut.length:0;for(this.clear();++At<Ft;){var ce=ut[At];this.set(ce[0],ce[1])}}function nn(){this.__data__=[]}function Ie(ut){var At=this.__data__,Ft=xe(At,ut);if(Ft<0)return!1;var ce=At.length-1;return Ft==ce?At.pop():le.call(At,Ft,1),!0}function Ue(ut){var At=this.__data__,Ft=xe(At,ut);return Ft<0?void 0:At[Ft][1]}function He(ut){return xe(this.__data__,ut)>-1}function Ge(ut,At){var Ft=this.__data__,ce=xe(Ft,ut);return ce<0?Ft.push([ut,At]):Ft[ce][1]=At,this}we.prototype.clear=nn,we.prototype.delete=Ie,we.prototype.get=Ue,we.prototype.has=He,we.prototype.set=Ge;function Ve(ut){var At=-1,Ft=ut?ut.length:0;for(this.clear();++At<Ft;){var ce=ut[At];this.set(ce[0],ce[1])}}function an(){this.__data__={hash:new _n,map:new(qe||we),string:new _n}}function kn(ut){return Ur(this,ut).delete(ut)}function qn(ut){return Ur(this,ut).get(ut)}function Qt(ut){return Ur(this,ut).has(ut)}function de(ut,At){return Ur(this,ut).set(ut,At),this}Ve.prototype.clear=an,Ve.prototype.delete=kn,Ve.prototype.get=qn,Ve.prototype.has=Qt,Ve.prototype.set=de;function Ee(ut){this.__data__=new we(ut)}function Pe(){this.__data__=new we}function _t(ut){return this.__data__.delete(ut)}function Bt(ut){return this.__data__.get(ut)}function Gt(ut){return this.__data__.has(ut)}function pe(ut,At){var Ft=this.__data__;if(Ft instanceof we){var ce=Ft.__data__;if(!qe||ce.length<t-1)return ce.push([ut,At]),this;Ft=this.__data__=new Ve(ce)}return Ft.set(ut,At),this}Ee.prototype.clear=Pe,Ee.prototype.delete=_t,Ee.prototype.get=Bt,Ee.prototype.has=Gt,Ee.prototype.set=pe;function Ne(ut,At){var Ft=vs(ut)||fn(ut)?mt(ut.length,String):[],ce=Ft.length,An=!!ce;for(var en in ut)Mt.call(ut,en)&&!(An&&(en=="length"||Sr(en,ce)))&&Ft.push(en);return Ft}function ye(ut,At,Ft){var ce=ut[At];(!(Mt.call(ut,At)&&fs(ce,Ft))||Ft===void 0&&!(At in ut))&&(ut[At]=Ft)}function xe(ut,At){for(var Ft=ut.length;Ft--;)if(fs(ut[Ft][0],At))return Ft;return-1}function mn(ut,At){return ut&&tn(At,Fs(At),ut)}function $e(ut,At,Ft,ce,An,en,Hn){var Qn;if(ce&&(Qn=en?ce(ut,An,en,Hn):ce(ut)),Qn!==void 0)return Qn;if(!Xi(ut))return ut;var qr=vs(ut);if(qr){if(Qn=ri(ut),!At)return Un(ut,Qn)}else{var Jn=cr(ut),Xr=Jn==c||Jn==p;if(Yi(ut))return Qe(ut,At);if(Jn==g||Jn==s||Xr&&!en){if(at(ut))return en?ut:{};if(Qn=or(Xr?{}:ut),!At)return ar(ut,mn(Qn,ut))}else{if(!j[Jn])return en?ut:{};Qn=Mr(ut,Jn,$e,At)}}Hn||(Hn=new Ee);var Si=Hn.get(ut);if(Si)return Si;if(Hn.set(ut,Qn),!qr)var ii=Ft?tr(ut):Fs(ut);return z(ii||ut,function(Kr,$r){ii&&($r=Kr,Kr=ut[$r]),ye(Qn,$r,$e(Kr,At,Ft,ce,$r,ut,Hn))}),Qn}function vn(ut){return Xi(ut)?ae(ut):{}}function Ze(ut,At,Ft){var ce=At(ut);return vs(ut)?ce:Z(ce,Ft(ut))}function Tn(ut){return qt.call(ut)}function Bn(ut){if(!Xi(ut)||Br(ut))return!1;var At=di(ut)||at(ut)?Tt:A;return At.test(Lr(ut))}function In(ut){if(!hi(ut))return ge(ut);var At=[];for(var Ft in Object(ut))Mt.call(ut,Ft)&&Ft!="constructor"&&At.push(Ft);return At}function Qe(ut,At){if(At)return ut.slice();var Ft=new ut.constructor(ut.length);return ut.copy(Ft),Ft}function mr(ut){var At=new ut.constructor(ut.byteLength);return new Kt(At).set(new Kt(ut)),At}function sr(ut,At){var Ft=At?mr(ut.buffer):ut.buffer;return new ut.constructor(Ft,ut.byteOffset,ut.byteLength)}function Dr(ut,At,Ft){var ce=At?Ft(rt(ut),!0):rt(ut);return it(ce,tt,new ut.constructor)}function xi(ut){var At=new ut.constructor(ut.source,k.exec(ut));return At.lastIndex=ut.lastIndex,At}function ir(ut,At,Ft){var ce=At?Ft(ot(ut),!0):ot(ut);return it(ce,$,new ut.constructor)}function yr(ut){return Te?Object(Te.call(ut)):{}}function ur(ut,At){var Ft=At?mr(ut.buffer):ut.buffer;return new ut.constructor(Ft,ut.byteOffset,ut.length)}function Un(ut,At){var Ft=-1,ce=ut.length;for(At||(At=Array(ce));++Ft<ce;)At[Ft]=ut[Ft];return At}function tn(ut,At,Ft,ce){Ft||(Ft={});for(var An=-1,en=At.length;++An<en;){var Hn=At[An],Qn=void 0;ye(Ft,Hn,Qn===void 0?ut[Hn]:Qn)}return Ft}function ar(ut,At){return tn(ut,Zn(ut),At)}function tr(ut){return Ze(ut,Fs,Zn)}function Ur(ut,At){var Ft=ut.__data__;return Hr(At)?Ft[typeof At=="string"?"string":"hash"]:Ft.map}function Kn(ut,At){var Ft=lt(ut,At);return Bn(Ft)?Ft:void 0}var Zn=Jt?ct(Jt,Object):Es,cr=Tn;(fe&&cr(new fe(new ArrayBuffer(1)))!=F||qe&&cr(new qe)!=h||Be&&cr(Be.resolve())!=y||ke&&cr(new ke)!=v||Je&&cr(new Je)!=N)&&(cr=function(ut){var At=qt.call(ut),Ft=At==g?ut.constructor:void 0,ce=Ft?Lr(Ft):void 0;if(ce)switch(ce){case Me:return F;case Ke:return h;case En:return y;case Xe:return v;case Sn:return N}return At});function ri(ut){var At=ut.length,Ft=ut.constructor(At);return At&&typeof ut[0]=="string"&&Mt.call(ut,"index")&&(Ft.index=ut.index,Ft.input=ut.input),Ft}function or(ut){return typeof ut.constructor=="function"&&!hi(ut)?vn(ne(ut)):{}}function Mr(ut,At,Ft,ce){var An=ut.constructor;switch(At){case D:return mr(ut);case u:case l:return new An(+ut);case F:return sr(ut,ce);case G:case P:case U:case q:case R:case I:case T:case L:case E:return ur(ut,ce);case h:return Dr(ut,ce,Ft);case f:case w:return new An(ut);case b:return xi(ut);case v:return ir(ut,ce,Ft);case S:return yr(ut)}}function Sr(ut,At){return At=At??o,!!At&&(typeof ut=="number"||C.test(ut))&&ut>-1&&ut%1==0&&ut<At}function Hr(ut){var At=typeof ut;return At=="string"||At=="number"||At=="symbol"||At=="boolean"?ut!=="__proto__":ut===null}function Br(ut){return!!yt&&yt in ut}function hi(ut){var At=ut&&ut.constructor,Ft=typeof At=="function"&&At.prototype||gt;return ut===Ft}function Lr(ut){if(ut!=null){try{return Et.call(ut)}catch{}try{return ut+""}catch{}}return""}function ns(ut){return $e(ut,!0,!0)}function fs(ut,At){return ut===At||ut!==ut&&At!==At}function fn(ut){return No(ut)&&Mt.call(ut,"callee")&&(!Oe.call(ut,"callee")||qt.call(ut)==s)}var vs=Array.isArray;function Xs(ut){return ut!=null&&Ta(ut.length)&&!di(ut)}function No(ut){return Ki(ut)&&Xs(ut)}var Yi=ue||To;function di(ut){var At=Xi(ut)?qt.call(ut):"";return At==c||At==p}function Ta(ut){return typeof ut=="number"&&ut>-1&&ut%1==0&&ut<=o}function Xi(ut){var At=typeof ut;return!!ut&&(At=="object"||At=="function")}function Ki(ut){return!!ut&&typeof ut=="object"}function Fs(ut){return Xs(ut)?Ne(ut):In(ut)}function Es(){return[]}function To(){return!1}n.exports=ns})(Nh,Nh.exports)),Nh.exports}var Th={exports:{}};Th.exports;var Ow;function J6(){return Ow||(Ow=1,(function(n,e){var t=200,r="__lodash_hash_undefined__",o=1,s=2,a=9007199254740991,u="[object Arguments]",l="[object Array]",i="[object AsyncFunction]",c="[object Boolean]",p="[object Date]",h="[object Error]",f="[object Function]",g="[object GeneratorFunction]",y="[object Map]",b="[object Number]",v="[object Null]",w="[object Object]",S="[object Promise]",N="[object Proxy]",D="[object RegExp]",F="[object Set]",G="[object String]",P="[object Symbol]",U="[object Undefined]",q="[object WeakMap]",R="[object ArrayBuffer]",I="[object DataView]",T="[object Float32Array]",L="[object Float64Array]",E="[object Int8Array]",x="[object Int16Array]",k="[object Int32Array]",A="[object Uint8Array]",C="[object Uint8ClampedArray]",j="[object Uint16Array]",B="[object Uint32Array]",O=/[\\^$.*+?()[\]{}|]/g,H=/^\[object .+?Constructor\]$/,X=/^(?:0|[1-9]\d*)$/,et={};et[T]=et[L]=et[E]=et[x]=et[k]=et[A]=et[C]=et[j]=et[B]=!0,et[u]=et[l]=et[R]=et[c]=et[I]=et[p]=et[h]=et[f]=et[y]=et[b]=et[w]=et[D]=et[F]=et[G]=et[q]=!1;var V=typeof Gn=="object"&&Gn&&Gn.Object===Object&&Gn,tt=typeof self=="object"&&self&&self.Object===Object&&self,$=V||tt||Function("return this")(),z=e&&!e.nodeType&&e,Z=z&&!0&&n&&!n.nodeType&&n,it=Z&&Z.exports===z,mt=it&&V.process,lt=(function(){try{return mt&&mt.binding&&mt.binding("util")}catch{}})(),at=lt&&lt.isTypedArray;function rt(ut,At){for(var Ft=-1,ce=ut==null?0:ut.length,An=0,en=[];++Ft<ce;){var Hn=ut[Ft];At(Hn,Ft,ut)&&(en[An++]=Hn)}return en}function ct(ut,At){for(var Ft=-1,ce=At.length,An=ut.length;++Ft<ce;)ut[An+Ft]=At[Ft];return ut}function ot(ut,At){for(var Ft=-1,ce=ut==null?0:ut.length;++Ft<ce;)if(At(ut[Ft],Ft,ut))return!0;return!1}function dt(ut,At){for(var Ft=-1,ce=Array(ut);++Ft<ut;)ce[Ft]=At(Ft);return ce}function ft(ut){return function(At){return ut(At)}}function gt(ut,At){return ut.has(At)}function wt(ut,At){return ut?.[At]}function yt(ut){var At=-1,Ft=Array(ut.size);return ut.forEach(function(ce,An){Ft[++At]=[An,ce]}),Ft}function Et(ut,At){return function(Ft){return ut(At(Ft))}}function Mt(ut){var At=-1,Ft=Array(ut.size);return ut.forEach(function(ce){Ft[++At]=ce}),Ft}var qt=Array.prototype,Tt=Function.prototype,It=Object.prototype,Vt=$["__core-js_shared__"],Kt=Tt.toString,ne=It.hasOwnProperty,ae=(function(){var ut=/[^.]+$/.exec(Vt&&Vt.keys&&Vt.keys.IE_PROTO||"");return ut?"Symbol(src)_1."+ut:""})(),Oe=It.toString,le=RegExp("^"+Kt.call(ne).replace(O,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Jt=it?$.Buffer:void 0,ue=$.Symbol,ge=$.Uint8Array,fe=It.propertyIsEnumerable,qe=qt.splice,Be=ue?ue.toStringTag:void 0,ke=Object.getOwnPropertySymbols,Je=Jt?Jt.isBuffer:void 0,Fe=Et(Object.keys,Object),Me=Zn($,"DataView"),Ke=Zn($,"Map"),En=Zn($,"Promise"),Xe=Zn($,"Set"),Sn=Zn($,"WeakMap"),Nn=Zn(Object,"create"),Te=Lr(Me),_n=Lr(Ke),Pn=Lr(En),on=Lr(Xe),Dt=Lr(Sn),Ht=ue?ue.prototype:void 0,re=Ht?Ht.valueOf:void 0;function we(ut){var At=-1,Ft=ut==null?0:ut.length;for(this.clear();++At<Ft;){var ce=ut[At];this.set(ce[0],ce[1])}}function nn(){this.__data__=Nn?Nn(null):{},this.size=0}function Ie(ut){var At=this.has(ut)&&delete this.__data__[ut];return this.size-=At?1:0,At}function Ue(ut){var At=this.__data__;if(Nn){var Ft=At[ut];return Ft===r?void 0:Ft}return ne.call(At,ut)?At[ut]:void 0}function He(ut){var At=this.__data__;return Nn?At[ut]!==void 0:ne.call(At,ut)}function Ge(ut,At){var Ft=this.__data__;return this.size+=this.has(ut)?0:1,Ft[ut]=Nn&&At===void 0?r:At,this}we.prototype.clear=nn,we.prototype.delete=Ie,we.prototype.get=Ue,we.prototype.has=He,we.prototype.set=Ge;function Ve(ut){var At=-1,Ft=ut==null?0:ut.length;for(this.clear();++At<Ft;){var ce=ut[At];this.set(ce[0],ce[1])}}function an(){this.__data__=[],this.size=0}function kn(ut){var At=this.__data__,Ft=Qe(At,ut);if(Ft<0)return!1;var ce=At.length-1;return Ft==ce?At.pop():qe.call(At,Ft,1),--this.size,!0}function qn(ut){var At=this.__data__,Ft=Qe(At,ut);return Ft<0?void 0:At[Ft][1]}function Qt(ut){return Qe(this.__data__,ut)>-1}function de(ut,At){var Ft=this.__data__,ce=Qe(Ft,ut);return ce<0?(++this.size,Ft.push([ut,At])):Ft[ce][1]=At,this}Ve.prototype.clear=an,Ve.prototype.delete=kn,Ve.prototype.get=qn,Ve.prototype.has=Qt,Ve.prototype.set=de;function Ee(ut){var At=-1,Ft=ut==null?0:ut.length;for(this.clear();++At<Ft;){var ce=ut[At];this.set(ce[0],ce[1])}}function Pe(){this.size=0,this.__data__={hash:new we,map:new(Ke||Ve),string:new we}}function _t(ut){var At=Kn(this,ut).delete(ut);return this.size-=At?1:0,At}function Bt(ut){return Kn(this,ut).get(ut)}function Gt(ut){return Kn(this,ut).has(ut)}function pe(ut,At){var Ft=Kn(this,ut),ce=Ft.size;return Ft.set(ut,At),this.size+=Ft.size==ce?0:1,this}Ee.prototype.clear=Pe,Ee.prototype.delete=_t,Ee.prototype.get=Bt,Ee.prototype.has=Gt,Ee.prototype.set=pe;function Ne(ut){var At=-1,Ft=ut==null?0:ut.length;for(this.__data__=new Ee;++At<Ft;)this.add(ut[At])}function ye(ut){return this.__data__.set(ut,r),this}function xe(ut){return this.__data__.has(ut)}Ne.prototype.add=Ne.prototype.push=ye,Ne.prototype.has=xe;function mn(ut){var At=this.__data__=new Ve(ut);this.size=At.size}function $e(){this.__data__=new Ve,this.size=0}function vn(ut){var At=this.__data__,Ft=At.delete(ut);return this.size=At.size,Ft}function Ze(ut){return this.__data__.get(ut)}function Tn(ut){return this.__data__.has(ut)}function Bn(ut,At){var Ft=this.__data__;if(Ft instanceof Ve){var ce=Ft.__data__;if(!Ke||ce.length<t-1)return ce.push([ut,At]),this.size=++Ft.size,this;Ft=this.__data__=new Ee(ce)}return Ft.set(ut,At),this.size=Ft.size,this}mn.prototype.clear=$e,mn.prototype.delete=vn,mn.prototype.get=Ze,mn.prototype.has=Tn,mn.prototype.set=Bn;function In(ut,At){var Ft=fn(ut),ce=!Ft&&fs(ut),An=!Ft&&!ce&&Xs(ut),en=!Ft&&!ce&&!An&&Ki(ut),Hn=Ft||ce||An||en,Qn=Hn?dt(ut.length,String):[],qr=Qn.length;for(var Jn in ut)ne.call(ut,Jn)&&!(Hn&&(Jn=="length"||An&&(Jn=="offset"||Jn=="parent")||en&&(Jn=="buffer"||Jn=="byteLength"||Jn=="byteOffset")||Mr(Jn,qr)))&&Qn.push(Jn);return Qn}function Qe(ut,At){for(var Ft=ut.length;Ft--;)if(ns(ut[Ft][0],At))return Ft;return-1}function mr(ut,At,Ft){var ce=At(ut);return fn(ut)?ce:ct(ce,Ft(ut))}function sr(ut){return ut==null?ut===void 0?U:v:Be&&Be in Object(ut)?cr(ut):hi(ut)}function Dr(ut){return Xi(ut)&&sr(ut)==u}function xi(ut,At,Ft,ce,An){return ut===At?!0:ut==null||At==null||!Xi(ut)&&!Xi(At)?ut!==ut&&At!==At:ir(ut,At,Ft,ce,xi,An)}function ir(ut,At,Ft,ce,An,en){var Hn=fn(ut),Qn=fn(At),qr=Hn?l:or(ut),Jn=Qn?l:or(At);qr=qr==u?w:qr,Jn=Jn==u?w:Jn;var Xr=qr==w,Si=Jn==w,ii=qr==Jn;if(ii&&Xs(ut)){if(!Xs(At))return!1;Hn=!0,Xr=!1}if(ii&&!Xr)return en||(en=new mn),Hn||Ki(ut)?tn(ut,At,Ft,ce,An,en):ar(ut,At,qr,Ft,ce,An,en);if(!(Ft&o)){var Kr=Xr&&ne.call(ut,"__wrapped__"),$r=Si&&ne.call(At,"__wrapped__");if(Kr||$r){var zs=Kr?ut.value():ut,qi=$r?At.value():At;return en||(en=new mn),An(zs,qi,Ft,ce,en)}}return ii?(en||(en=new mn),tr(ut,At,Ft,ce,An,en)):!1}function yr(ut){if(!Ta(ut)||Hr(ut))return!1;var At=Yi(ut)?le:H;return At.test(Lr(ut))}function ur(ut){return Xi(ut)&&di(ut.length)&&!!et[sr(ut)]}function Un(ut){if(!Br(ut))return Fe(ut);var At=[];for(var Ft in Object(ut))ne.call(ut,Ft)&&Ft!="constructor"&&At.push(Ft);return At}function tn(ut,At,Ft,ce,An,en){var Hn=Ft&o,Qn=ut.length,qr=At.length;if(Qn!=qr&&!(Hn&&qr>Qn))return!1;var Jn=en.get(ut);if(Jn&&en.get(At))return Jn==At;var Xr=-1,Si=!0,ii=Ft&s?new Ne:void 0;for(en.set(ut,At),en.set(At,ut);++Xr<Qn;){var Kr=ut[Xr],$r=At[Xr];if(ce)var zs=Hn?ce($r,Kr,Xr,At,ut,en):ce(Kr,$r,Xr,ut,At,en);if(zs!==void 0){if(zs)continue;Si=!1;break}if(ii){if(!ot(At,function(qi,Ks){if(!gt(ii,Ks)&&(Kr===qi||An(Kr,qi,Ft,ce,en)))return ii.push(Ks)})){Si=!1;break}}else if(!(Kr===$r||An(Kr,$r,Ft,ce,en))){Si=!1;break}}return en.delete(ut),en.delete(At),Si}function ar(ut,At,Ft,ce,An,en,Hn){switch(Ft){case I:if(ut.byteLength!=At.byteLength||ut.byteOffset!=At.byteOffset)return!1;ut=ut.buffer,At=At.buffer;case R:return!(ut.byteLength!=At.byteLength||!en(new ge(ut),new ge(At)));case c:case p:case b:return ns(+ut,+At);case h:return ut.name==At.name&&ut.message==At.message;case D:case G:return ut==At+"";case y:var Qn=yt;case F:var qr=ce&o;if(Qn||(Qn=Mt),ut.size!=At.size&&!qr)return!1;var Jn=Hn.get(ut);if(Jn)return Jn==At;ce|=s,Hn.set(ut,At);var Xr=tn(Qn(ut),Qn(At),ce,An,en,Hn);return Hn.delete(ut),Xr;case P:if(re)return re.call(ut)==re.call(At)}return!1}function tr(ut,At,Ft,ce,An,en){var Hn=Ft&o,Qn=Ur(ut),qr=Qn.length,Jn=Ur(At),Xr=Jn.length;if(qr!=Xr&&!Hn)return!1;for(var Si=qr;Si--;){var ii=Qn[Si];if(!(Hn?ii in At:ne.call(At,ii)))return!1}var Kr=en.get(ut);if(Kr&&en.get(At))return Kr==At;var $r=!0;en.set(ut,At),en.set(At,ut);for(var zs=Hn;++Si<qr;){ii=Qn[Si];var qi=ut[ii],Ks=At[ii];if(ce)var nt=Hn?ce(Ks,qi,ii,At,ut,en):ce(qi,Ks,ii,ut,At,en);if(!(nt===void 0?qi===Ks||An(qi,Ks,Ft,ce,en):nt)){$r=!1;break}zs||(zs=ii=="constructor")}if($r&&!zs){var bt=ut.constructor,Lt=At.constructor;bt!=Lt&&"constructor"in ut&&"constructor"in At&&!(typeof bt=="function"&&bt instanceof bt&&typeof Lt=="function"&&Lt instanceof Lt)&&($r=!1)}return en.delete(ut),en.delete(At),$r}function Ur(ut){return mr(ut,Fs,ri)}function Kn(ut,At){var Ft=ut.__data__;return Sr(At)?Ft[typeof At=="string"?"string":"hash"]:Ft.map}function Zn(ut,At){var Ft=wt(ut,At);return yr(Ft)?Ft:void 0}function cr(ut){var At=ne.call(ut,Be),Ft=ut[Be];try{ut[Be]=void 0;var ce=!0}catch{}var An=Oe.call(ut);return ce&&(At?ut[Be]=Ft:delete ut[Be]),An}var ri=ke?function(ut){return ut==null?[]:(ut=Object(ut),rt(ke(ut),function(At){return fe.call(ut,At)}))}:Es,or=sr;(Me&&or(new Me(new ArrayBuffer(1)))!=I||Ke&&or(new Ke)!=y||En&&or(En.resolve())!=S||Xe&&or(new Xe)!=F||Sn&&or(new Sn)!=q)&&(or=function(ut){var At=sr(ut),Ft=At==w?ut.constructor:void 0,ce=Ft?Lr(Ft):"";if(ce)switch(ce){case Te:return I;case _n:return y;case Pn:return S;case on:return F;case Dt:return q}return At});function Mr(ut,At){return At=At??a,!!At&&(typeof ut=="number"||X.test(ut))&&ut>-1&&ut%1==0&&ut<At}function Sr(ut){var At=typeof ut;return At=="string"||At=="number"||At=="symbol"||At=="boolean"?ut!=="__proto__":ut===null}function Hr(ut){return!!ae&&ae in ut}function Br(ut){var At=ut&&ut.constructor,Ft=typeof At=="function"&&At.prototype||It;return ut===Ft}function hi(ut){return Oe.call(ut)}function Lr(ut){if(ut!=null){try{return Kt.call(ut)}catch{}try{return ut+""}catch{}}return""}function ns(ut,At){return ut===At||ut!==ut&&At!==At}var fs=Dr((function(){return arguments})())?Dr:function(ut){return Xi(ut)&&ne.call(ut,"callee")&&!fe.call(ut,"callee")},fn=Array.isArray;function vs(ut){return ut!=null&&di(ut.length)&&!Yi(ut)}var Xs=Je||To;function No(ut,At){return xi(ut,At)}function Yi(ut){if(!Ta(ut))return!1;var At=sr(ut);return At==f||At==g||At==i||At==N}function di(ut){return typeof ut=="number"&&ut>-1&&ut%1==0&&ut<=a}function Ta(ut){var At=typeof ut;return ut!=null&&(At=="object"||At=="function")}function Xi(ut){return ut!=null&&typeof ut=="object"}var Ki=at?ft(at):ur;function Fs(ut){return vs(ut)?In(ut):Un(ut)}function Es(){return[]}function To(){return!1}n.exports=No})(Th,Th.exports)),Th.exports}var gp={},Rw;function HD(){if(Rw)return gp;Rw=1,Object.defineProperty(gp,"__esModule",{value:!0});const n=Q6(),e=J6();var t;return(function(r){function o(l={},i={},c=!1){typeof l!="object"&&(l={}),typeof i!="object"&&(i={});let p=n(i);c||(p=Object.keys(p).reduce((h,f)=>(p[f]!=null&&(h[f]=p[f]),h),{}));for(const h in l)l[h]!==void 0&&i[h]===void 0&&(p[h]=l[h]);return Object.keys(p).length>0?p:void 0}r.compose=o;function s(l={},i={}){typeof l!="object"&&(l={}),typeof i!="object"&&(i={});const c=Object.keys(l).concat(Object.keys(i)).reduce((p,h)=>(e(l[h],i[h])||(p[h]=i[h]===void 0?null:i[h]),p),{});return Object.keys(c).length>0?c:void 0}r.diff=s;function a(l={},i={}){l=l||{};const c=Object.keys(i).reduce((p,h)=>(i[h]!==l[h]&&l[h]!==void 0&&(p[h]=i[h]),p),{});return Object.keys(l).reduce((p,h)=>(l[h]!==i[h]&&i[h]===void 0&&(p[h]=null),p),c)}r.invert=a;function u(l,i,c=!1){if(typeof l!="object")return i;if(typeof i!="object")return;if(!c)return i;const p=Object.keys(i).reduce((h,f)=>(l[f]===void 0&&(h[f]=i[f]),h),{});return Object.keys(p).length>0?p:void 0}r.transform=u})(t||(t={})),gp.default=t,gp}var bp={},Iw;function t8(){if(Iw)return bp;Iw=1,Object.defineProperty(bp,"__esModule",{value:!0});var n;return(function(e){function t(r){return typeof r.delete=="number"?r.delete:typeof r.retain=="number"?r.retain:typeof r.retain=="object"&&r.retain!==null?1:typeof r.insert=="string"?r.insert.length:1}e.length=t})(n||(n={})),bp.default=n,bp}var yp={},Dw;function $D(){if(Dw)return yp;Dw=1,Object.defineProperty(yp,"__esModule",{value:!0});const n=t8();class e{constructor(r){this.ops=r,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(r){r||(r=1/0);const o=this.ops[this.index];if(o){const s=this.offset,a=n.default.length(o);if(r>=a-s?(r=a-s,this.index+=1,this.offset=0):this.offset+=r,typeof o.delete=="number")return{delete:r};{const u={};return o.attributes&&(u.attributes=o.attributes),typeof o.retain=="number"?u.retain=r:typeof o.retain=="object"&&o.retain!==null?u.retain=o.retain:typeof o.insert=="string"?u.insert=o.insert.substr(s,r):u.insert=o.insert,u}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?n.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const r=this.ops[this.index];return r?typeof r.delete=="number"?"delete":typeof r.retain=="number"||typeof r.retain=="object"&&r.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const r=this.offset,o=this.index,s=this.next(),a=this.ops.slice(this.index);return this.offset=r,this.index=o,[s].concat(a)}}else return[]}}return yp.default=e,yp}var Bw;function VD(){return Bw||(Bw=1,(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const t=UD(),r=Q6(),o=J6(),s=HD();e.AttributeMap=s.default;const a=t8();e.Op=a.default;const u=$D();e.OpIterator=u.default;const l="\0",i=(p,h)=>{if(typeof p!="object"||p===null)throw new Error(`cannot retain a ${typeof p}`);if(typeof h!="object"||h===null)throw new Error(`cannot retain a ${typeof h}`);const f=Object.keys(p)[0];if(!f||f!==Object.keys(h)[0])throw new Error(`embed types not matched: ${f} != ${Object.keys(h)[0]}`);return[f,p[f],h[f]]};class c{constructor(h){Array.isArray(h)?this.ops=h:h!=null&&Array.isArray(h.ops)?this.ops=h.ops:this.ops=[]}static registerEmbed(h,f){this.handlers[h]=f}static unregisterEmbed(h){delete this.handlers[h]}static getHandler(h){const f=this.handlers[h];if(!f)throw new Error(`no handlers for embed type "${h}"`);return f}insert(h,f){const g={};return typeof h=="string"&&h.length===0?this:(g.insert=h,f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(g.attributes=f),this.push(g))}delete(h){return h<=0?this:this.push({delete:h})}retain(h,f){if(typeof h=="number"&&h<=0)return this;const g={retain:h};return f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(g.attributes=f),this.push(g)}push(h){let f=this.ops.length,g=this.ops[f-1];if(h=r(h),typeof g=="object"){if(typeof h.delete=="number"&&typeof g.delete=="number")return this.ops[f-1]={delete:g.delete+h.delete},this;if(typeof g.delete=="number"&&h.insert!=null&&(f-=1,g=this.ops[f-1],typeof g!="object"))return this.ops.unshift(h),this;if(o(h.attributes,g.attributes)){if(typeof h.insert=="string"&&typeof g.insert=="string")return this.ops[f-1]={insert:g.insert+h.insert},typeof h.attributes=="object"&&(this.ops[f-1].attributes=h.attributes),this;if(typeof h.retain=="number"&&typeof g.retain=="number")return this.ops[f-1]={retain:g.retain+h.retain},typeof h.attributes=="object"&&(this.ops[f-1].attributes=h.attributes),this}}return f===this.ops.length?this.ops.push(h):this.ops.splice(f,0,h),this}chop(){const h=this.ops[this.ops.length-1];return h&&typeof h.retain=="number"&&!h.attributes&&this.ops.pop(),this}filter(h){return this.ops.filter(h)}forEach(h){this.ops.forEach(h)}map(h){return this.ops.map(h)}partition(h){const f=[],g=[];return this.forEach(y=>{(h(y)?f:g).push(y)}),[f,g]}reduce(h,f){return this.ops.reduce(h,f)}changeLength(){return this.reduce((h,f)=>f.insert?h+a.default.length(f):f.delete?h-f.delete:h,0)}length(){return this.reduce((h,f)=>h+a.default.length(f),0)}slice(h=0,f=1/0){const g=[],y=new u.default(this.ops);let b=0;for(;b<f&&y.hasNext();){let v;b<h?v=y.next(h-b):(v=y.next(f-b),g.push(v)),b+=a.default.length(v)}return new c(g)}compose(h){const f=new u.default(this.ops),g=new u.default(h.ops),y=[],b=g.peek();if(b!=null&&typeof b.retain=="number"&&b.attributes==null){let w=b.retain;for(;f.peekType()==="insert"&&f.peekLength()<=w;)w-=f.peekLength(),y.push(f.next());b.retain-w>0&&g.next(b.retain-w)}const v=new c(y);for(;f.hasNext()||g.hasNext();)if(g.peekType()==="insert")v.push(g.next());else if(f.peekType()==="delete")v.push(f.next());else{const w=Math.min(f.peekLength(),g.peekLength()),S=f.next(w),N=g.next(w);if(N.retain){const D={};if(typeof S.retain=="number")D.retain=typeof N.retain=="number"?w:N.retain;else if(typeof N.retain=="number")S.retain==null?D.insert=S.insert:D.retain=S.retain;else{const G=S.retain==null?"insert":"retain",[P,U,q]=i(S[G],N.retain),R=c.getHandler(P);D[G]={[P]:R.compose(U,q,G==="retain")}}const F=s.default.compose(S.attributes,N.attributes,typeof S.retain=="number");if(F&&(D.attributes=F),v.push(D),!g.hasNext()&&o(v.ops[v.ops.length-1],D)){const G=new c(f.rest());return v.concat(G).chop()}}else typeof N.delete=="number"&&(typeof S.retain=="number"||typeof S.retain=="object"&&S.retain!==null)&&v.push(N)}return v.chop()}concat(h){const f=new c(this.ops.slice());return h.ops.length>0&&(f.push(h.ops[0]),f.ops=f.ops.concat(h.ops.slice(1))),f}diff(h,f){if(this.ops===h.ops)return new c;const g=[this,h].map(S=>S.map(N=>{if(N.insert!=null)return typeof N.insert=="string"?N.insert:l;const D=S===h?"on":"with";throw new Error("diff() called "+D+" non-document")}).join("")),y=new c,b=t(g[0],g[1],f,!0),v=new u.default(this.ops),w=new u.default(h.ops);return b.forEach(S=>{let N=S[1].length;for(;N>0;){let D=0;switch(S[0]){case t.INSERT:D=Math.min(w.peekLength(),N),y.push(w.next(D));break;case t.DELETE:D=Math.min(N,v.peekLength()),v.next(D),y.delete(D);break;case t.EQUAL:D=Math.min(v.peekLength(),w.peekLength(),N);const F=v.next(D),G=w.next(D);o(F.insert,G.insert)?y.retain(D,s.default.diff(F.attributes,G.attributes)):y.push(G).delete(D);break}N-=D}}),y.chop()}eachLine(h,f=`
`){const g=new u.default(this.ops);let y=new c,b=0;for(;g.hasNext();){if(g.peekType()!=="insert")return;const v=g.peek(),w=a.default.length(v)-g.peekLength(),S=typeof v.insert=="string"?v.insert.indexOf(f,w)-w:-1;if(S<0)y.push(g.next());else if(S>0)y.push(g.next(S));else{if(h(y,g.next(1).attributes||{},b)===!1)return;b+=1,y=new c}}y.length()>0&&h(y,{},b)}invert(h){const f=new c;return this.reduce((g,y)=>{if(y.insert)f.delete(a.default.length(y));else{if(typeof y.retain=="number"&&y.attributes==null)return f.retain(y.retain),g+y.retain;if(y.delete||typeof y.retain=="number"){const b=y.delete||y.retain;return h.slice(g,g+b).forEach(w=>{y.delete?f.push(w):y.retain&&y.attributes&&f.retain(a.default.length(w),s.default.invert(y.attributes,w.attributes))}),g+b}else if(typeof y.retain=="object"&&y.retain!==null){const b=h.slice(g,g+1),v=new u.default(b.ops).next(),[w,S,N]=i(y.retain,v.insert),D=c.getHandler(w);return f.retain({[w]:D.invert(S,N)},s.default.invert(y.attributes,v.attributes)),g+1}}return g},0),f.chop()}transform(h,f=!1){if(f=!!f,typeof h=="number")return this.transformPosition(h,f);const g=h,y=new u.default(this.ops),b=new u.default(g.ops),v=new c;for(;y.hasNext()||b.hasNext();)if(y.peekType()==="insert"&&(f||b.peekType()!=="insert"))v.retain(a.default.length(y.next()));else if(b.peekType()==="insert")v.push(b.next());else{const w=Math.min(y.peekLength(),b.peekLength()),S=y.next(w),N=b.next(w);if(S.delete)continue;if(N.delete)v.push(N);else{const D=S.retain,F=N.retain;let G=typeof F=="object"&&F!==null?F:w;if(typeof D=="object"&&D!==null&&typeof F=="object"&&F!==null){const P=Object.keys(D)[0];if(P===Object.keys(F)[0]){const U=c.getHandler(P);U&&(G={[P]:U.transform(D[P],F[P],f)})}}v.retain(G,s.default.transform(S.attributes,N.attributes,f))}}return v.chop()}transformPosition(h,f=!1){f=!!f;const g=new u.default(this.ops);let y=0;for(;g.hasNext()&&y<=h;){const b=g.peekLength(),v=g.peekType();if(g.next(),v==="delete"){h-=Math.min(b,h-y);continue}else v==="insert"&&(y<h||!f)&&(h+=b);y+=b}return h}}c.Op=a.default,c.OpIterator=u.default,c.AttributeMap=s.default,c.handlers={},e.default=c,n.exports=c,n.exports.default=c})(mp,mp.exports)),mp.exports}var Ya=VD();const yn=Eu(Ya);class Ao extends Na{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}Ao.blotName="break";Ao.tagName="BR";let So=class extends Qp{};function S0(n){return n.replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e])}class Vs extends Ub{static allowedChildren=[Vs,Ao,Na,So];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(e,t){const r=Vs.order.indexOf(e),o=Vs.order.indexOf(t);return r>=0||o>=0?r-o:e===t?0:e<t?-1:1}formatAt(e,t,r,o){if(Vs.compare(this.statics.blotName,r)<0&&this.scroll.query(r,wn.BLOT)){const s=this.isolate(e,t);o&&s.wrap(r,o)}else super.formatAt(e,t,r,o)}optimize(e){if(super.optimize(e),this.parent instanceof Vs&&Vs.compare(this.statics.blotName,this.parent.statics.blotName)>0){const t=this.parent.isolate(this.offset(),this.length());this.moveChildren(t),t.wrap(this)}}}const Pw=1;class Cs extends Kh{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=e8(this)),this.cache.delta}deleteAt(e,t){super.deleteAt(e,t),this.cache={}}formatAt(e,t,r,o){t<=0||(this.scroll.query(r,wn.BLOCK)?e+t===this.length()&&this.format(r,o):super.formatAt(e,Math.min(t,this.length()-e-1),r,o),this.cache={})}insertAt(e,t,r){if(r!=null){super.insertAt(e,t,r),this.cache={};return}if(t.length===0)return;const o=t.split(`
`),s=o.shift();s.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),s):this.children.tail.insertAt(this.children.tail.length(),s),this.cache={});let a=this;o.reduce((u,l)=>(a=a.split(u,!0),a.insertAt(0,l),l.length),e+s.length)}insertBefore(e,t){const{head:r}=this.children;super.insertBefore(e,t),r instanceof Ao&&r.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Pw),this.cache.length}moveChildren(e,t){super.moveChildren(e,t),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t&&(e===0||e>=this.length()-Pw)){const o=this.clone();return e===0?(this.parent.insertBefore(o,this),this):(this.parent.insertBefore(o,this.next),o)}const r=super.split(e,t);return this.cache={},r}}Cs.blotName="block";Cs.tagName="P";Cs.defaultChild=Ao;Cs.allowedChildren=[Ao,Vs,Na,So];class Ga extends Na{attach(){super.attach(),this.attributes=new w0(this.domNode)}delta(){return new yn().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,t){const r=this.scroll.query(e,wn.BLOCK_ATTRIBUTE);r!=null&&this.attributes.attribute(r,t)}formatAt(e,t,r,o){this.format(r,o)}insertAt(e,t,r){if(r!=null){super.insertAt(e,t,r);return}const o=t.split(`
`),s=o.pop(),a=o.map(l=>{const i=this.scroll.create(Cs.blotName);return i.insertAt(0,l),i}),u=this.split(e);a.forEach(l=>{this.parent.insertBefore(l,u)}),s&&this.parent.insertBefore(this.scroll.create("text",s),u)}}Ga.scope=wn.BLOCK_BLOT;function e8(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.descendants(Ds).reduce((t,r)=>r.length()===0?t:t.insert(r.value(),$a(r,{},e)),new yn).insert(`
`,$a(n))}function $a(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return n==null||("formats"in n&&typeof n.formats=="function"&&(e={...e,...n.formats()},t&&delete e["code-token"]),n.parent==null||n.parent.statics.blotName==="scroll"||n.parent.statics.scope!==n.statics.scope)?e:$a(n.parent,e,t)}class yo extends Na{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(e,t,r){super(e,t),this.selection=r,this.textNode=document.createTextNode(yo.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(e,t){if(this.savedLength!==0){super.format(e,t);return}let r=this,o=0;for(;r!=null&&r.statics.scope!==wn.BLOCK_BLOT;)o+=r.offset(r.parent),r=r.parent;r!=null&&(this.savedLength=yo.CONTENTS.length,r.optimize(),r.formatAt(o,yo.CONTENTS.length,e,t),this.savedLength=0)}index(e,t){return e===this.textNode?0:super.index(e,t)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const e=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const t=this.prev instanceof So?this.prev:null,r=t?t.length():0,o=this.next instanceof So?this.next:null,s=o?o.text:"",{textNode:a}=this,u=a.data.split(yo.CONTENTS).join("");a.data=yo.CONTENTS;let l;if(t)l=t,(u||o)&&(t.insertAt(t.length(),u+s),o&&o.remove());else if(o)l=o,o.insertAt(0,u);else{const i=document.createTextNode(u);l=this.scroll.create(i),this.parent.insertBefore(l,this)}if(this.remove(),e){const i=(h,f)=>t&&h===t.domNode?f:h===a?r+f-1:o&&h===o.domNode?r+u.length+f:null,c=i(e.start.node,e.start.offset),p=i(e.end.node,e.end.offset);if(c!==null&&p!==null)return{startNode:l.domNode,startOffset:c,endNode:l.domNode,endOffset:p}}return null}update(e,t){if(e.some(r=>r.type==="characterData"&&r.target===this.textNode)){const r=this.restore();r&&(t.range=r)}}optimize(e){super.optimize(e);let{parent:t}=this;for(;t;){if(t.domNode.tagName==="A"){this.savedLength=yo.CONTENTS.length,t.isolate(this.offset(t),this.length()).unwrap(),this.savedLength=0;break}t=t.parent}}value(){return""}}var M1={exports:{}},Fw;function WD(){return Fw||(Fw=1,(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function o(l,i,c){this.fn=l,this.context=i,this.once=c||!1}function s(l,i,c,p,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new o(c,p||l,h),g=t?t+i:i;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],f]:l._events[g].push(f):(l._events[g]=f,l._eventsCount++),l}function a(l,i){--l._eventsCount===0?l._events=new r:delete l._events[i]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var i=[],c,p;if(this._eventsCount===0)return i;for(p in c=this._events)e.call(c,p)&&i.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(c)):i},u.prototype.listeners=function(i){var c=t?t+i:i,p=this._events[c];if(!p)return[];if(p.fn)return[p.fn];for(var h=0,f=p.length,g=new Array(f);h<f;h++)g[h]=p[h].fn;return g},u.prototype.listenerCount=function(i){var c=t?t+i:i,p=this._events[c];return p?p.fn?1:p.length:0},u.prototype.emit=function(i,c,p,h,f,g){var y=t?t+i:i;if(!this._events[y])return!1;var b=this._events[y],v=arguments.length,w,S;if(b.fn){switch(b.once&&this.removeListener(i,b.fn,void 0,!0),v){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,c),!0;case 3:return b.fn.call(b.context,c,p),!0;case 4:return b.fn.call(b.context,c,p,h),!0;case 5:return b.fn.call(b.context,c,p,h,f),!0;case 6:return b.fn.call(b.context,c,p,h,f,g),!0}for(S=1,w=new Array(v-1);S<v;S++)w[S-1]=arguments[S];b.fn.apply(b.context,w)}else{var N=b.length,D;for(S=0;S<N;S++)switch(b[S].once&&this.removeListener(i,b[S].fn,void 0,!0),v){case 1:b[S].fn.call(b[S].context);break;case 2:b[S].fn.call(b[S].context,c);break;case 3:b[S].fn.call(b[S].context,c,p);break;case 4:b[S].fn.call(b[S].context,c,p,h);break;default:if(!w)for(D=1,w=new Array(v-1);D<v;D++)w[D-1]=arguments[D];b[S].fn.apply(b[S].context,w)}}return!0},u.prototype.on=function(i,c,p){return s(this,i,c,p,!1)},u.prototype.once=function(i,c,p){return s(this,i,c,p,!0)},u.prototype.removeListener=function(i,c,p,h){var f=t?t+i:i;if(!this._events[f])return this;if(!c)return a(this,f),this;var g=this._events[f];if(g.fn)g.fn===c&&(!h||g.once)&&(!p||g.context===p)&&a(this,f);else{for(var y=0,b=[],v=g.length;y<v;y++)(g[y].fn!==c||h&&!g[y].once||p&&g[y].context!==p)&&b.push(g[y]);b.length?this._events[f]=b.length===1?b[0]:b:a(this,f)}return this},u.prototype.removeAllListeners=function(i){var c;return i?(c=t?t+i:i,this._events[c]&&a(this,c)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,n.exports=u})(M1)),M1.exports}var GD=WD();const YD=Eu(GD),Kg=new WeakMap,Zg=["error","warn","log","info"];let Qg="warn";function n8(n){if(Qg&&Zg.indexOf(n)<=Zg.indexOf(Qg)){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];console[n](...t)}}function Fl(n){return Zg.reduce((e,t)=>(e[t]=n8.bind(console,t,n),e),{})}Fl.level=n=>{Qg=n};n8.level=Fl.level;const L1=Fl("quill:events"),XD=["selectionchange","mousedown","mouseup","click"];XD.forEach(n=>{document.addEventListener(n,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Array.from(document.querySelectorAll(".ql-container")).forEach(o=>{const s=Kg.get(o);s&&s.emitter&&s.emitter.handleDOM(...t)})})});class pn extends YD{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",L1.error)}emit(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return L1.log.call(L1,...t),super.emit(...t)}handleDOM(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];(this.domListeners[e.type]||[]).forEach(s=>{let{node:a,handler:u}=s;(e.target===a||a.contains(e.target))&&u(e,...r)})}listenDOM(e,t,r){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:t,handler:r})}}const O1=Fl("quill:selection");class ac{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=e,this.length=t}}class KD{constructor(e,t){this.emitter=t,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new ac(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,pn.sources.USER),1)}),this.emitter.on(pn.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const r=this.getNativeRange();r!=null&&r.start.node!==this.cursor.textNode&&this.emitter.once(pn.events.SCROLL_UPDATE,(o,s)=>{try{this.root.contains(r.start.node)&&this.root.contains(r.end.node)&&this.setNativeRange(r.start.node,r.start.offset,r.end.node,r.end.offset);const a=s.some(u=>u.type==="characterData"||u.type==="childList"||u.type==="attributes"&&u.target===this.root);this.update(a?pn.sources.SILENT:o)}catch{}})}),this.emitter.on(pn.events.SCROLL_OPTIMIZE,(r,o)=>{if(o.range){const{startNode:s,startOffset:a,endNode:u,endOffset:l}=o.range;this.setNativeRange(s,a,u,l),this.update(pn.sources.SILENT)}}),this.update(pn.sources.SILENT)}handleComposition(){this.emitter.on(pn.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(pn.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const e=this.cursor.restore();if(!e)return;setTimeout(()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(pn.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,t){this.scroll.update();const r=this.getNativeRange();if(!(r==null||!r.native.collapsed||this.scroll.query(e,wn.BLOCK))){if(r.start.node!==this.cursor.textNode){const o=this.scroll.find(r.start.node,!1);if(o==null)return;if(o instanceof Ds){const s=o.split(r.start.offset);o.parent.insertBefore(this.cursor,s)}else o.insertBefore(this.cursor,r.start.node);this.cursor.attach()}this.cursor.format(e,t),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.scroll.length();e=Math.min(e,r-1),t=Math.min(e+t,r-1)-e;let o,[s,a]=this.scroll.leaf(e);if(s==null)return null;if(t>0&&a===s.length()){const[c]=this.scroll.leaf(e+1);if(c){const[p]=this.scroll.line(e),[h]=this.scroll.line(e+1);p===h&&(s=c,a=0)}}[o,a]=s.position(a,!0);const u=document.createRange();if(t>0)return u.setStart(o,a),[s,a]=this.scroll.leaf(e+t),s==null?null:([o,a]=s.position(a,!0),u.setEnd(o,a),u.getBoundingClientRect());let l="left",i;if(o instanceof Text){if(!o.data.length)return null;a<o.data.length?(u.setStart(o,a),u.setEnd(o,a+1)):(u.setStart(o,a-1),u.setEnd(o,a),l="right"),i=u.getBoundingClientRect()}else{if(!(s.domNode instanceof Element))return null;i=s.domNode.getBoundingClientRect(),a>0&&(l="right")}return{bottom:i.top+i.height,height:i.height,left:i[l],right:i[l],top:i.top,width:0}}getNativeRange(){const e=document.getSelection();if(e==null||e.rangeCount<=0)return null;const t=e.getRangeAt(0);if(t==null)return null;const r=this.normalizeNative(t);return O1.info("getNativeRange",r),r}getRange(){const e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];const t=this.getNativeRange();return t==null?[null,null]:[this.normalizedToRange(t),t]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&R1(this.root,document.activeElement)}normalizedToRange(e){const t=[[e.start.node,e.start.offset]];e.native.collapsed||t.push([e.end.node,e.end.offset]);const r=t.map(a=>{const[u,l]=a,i=this.scroll.find(u,!0),c=i.offset(this.scroll);return l===0?c:i instanceof Ds?c+i.index(u,l):c+i.length()}),o=Math.min(Math.max(...r),this.scroll.length()-1),s=Math.min(o,...r);return new ac(s,o-s)}normalizeNative(e){if(!R1(this.root,e.startContainer)||!e.collapsed&&!R1(this.root,e.endContainer))return null;const t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach(r=>{let{node:o,offset:s}=r;for(;!(o instanceof Text)&&o.childNodes.length>0;)if(o.childNodes.length>s)o=o.childNodes[s],s=0;else if(o.childNodes.length===s)o=o.lastChild,o instanceof Text?s=o.data.length:o.childNodes.length>0?s=o.childNodes.length:s=o.childNodes.length+1;else break;r.node=o,r.offset=s}),t}rangeToNative(e){const t=this.scroll.length(),r=(o,s)=>{o=Math.min(t-1,o);const[a,u]=this.scroll.leaf(o);return a?a.position(u,s):[null,-1]};return[...r(e.index,!1),...r(e.index+e.length,!0)]}setNativeRange(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(O1.info("setNativeRange",e,t,r,o),e!=null&&(this.root.parentNode==null||e.parentNode==null||r.parentNode==null))return;const a=document.getSelection();if(a!=null)if(e!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:u}=this.getNativeRange()||{};if(u==null||s||e!==u.startContainer||t!==u.startOffset||r!==u.endContainer||o!==u.endOffset){e instanceof Element&&e.tagName==="BR"&&(t=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),r instanceof Element&&r.tagName==="BR"&&(o=Array.from(r.parentNode.childNodes).indexOf(r),r=r.parentNode);const l=document.createRange();l.setStart(e,t),l.setEnd(r,o),a.removeAllRanges(),a.addRange(l)}}else a.removeAllRanges(),this.root.blur()}setRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pn.sources.API;if(typeof t=="string"&&(r=t,t=!1),O1.info("setRange",e),e!=null){const o=this.rangeToNative(e);this.setNativeRange(...o,t)}else this.setNativeRange(null);this.update(r)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pn.sources.USER;const t=this.lastRange,[r,o]=this.getRange();if(this.lastRange=r,this.lastNative=o,this.lastRange!=null&&(this.savedRange=this.lastRange),!wu(t,this.lastRange)){if(!this.composing&&o!=null&&o.native.collapsed&&o.start.node!==this.cursor.textNode){const a=this.cursor.restore();a&&this.setNativeRange(a.startNode,a.startOffset,a.endNode,a.endOffset)}const s=[pn.events.SELECTION_CHANGE,vf(this.lastRange),vf(t),e];this.emitter.emit(pn.events.EDITOR_CHANGE,...s),e!==pn.sources.SILENT&&this.emitter.emit(...s)}}}function R1(n,e){try{e.parentNode}catch{return!1}return n.contains(e)}const ZD=/^[ -~]*$/;class QD{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let t=this.scroll.length();this.scroll.batchStart();const r=zw(e),o=new yn;return tB(r.ops.slice()).reduce((a,u)=>{const l=Ya.Op.length(u);let i=u.attributes||{},c=!1,p=!1;if(u.insert!=null){if(o.retain(l),typeof u.insert=="string"){const g=u.insert;p=!g.endsWith(`
`)&&(t<=a||!!this.scroll.descendant(Ga,a)[0]),this.scroll.insertAt(a,g);const[y,b]=this.scroll.line(a);let v=_u({},$a(y));if(y instanceof Cs){const[w]=y.descendant(Ds,b);w&&(v=_u(v,$a(w)))}i=Ya.AttributeMap.diff(v,i)||{}}else if(typeof u.insert=="object"){const g=Object.keys(u.insert)[0];if(g==null)return a;const y=this.scroll.query(g,wn.INLINE)!=null;if(y)(t<=a||this.scroll.descendant(Ga,a)[0])&&(p=!0);else if(a>0){const[b,v]=this.scroll.descendant(Ds,a-1);b instanceof So?b.value()[v]!==`
`&&(c=!0):b instanceof Na&&b.statics.scope===wn.INLINE_BLOT&&(c=!0)}if(this.scroll.insertAt(a,g,u.insert[g]),y){const[b]=this.scroll.descendant(Ds,a);if(b){const v=_u({},$a(b));i=Ya.AttributeMap.diff(v,i)||{}}}}t+=l}else if(o.push(u),u.retain!==null&&typeof u.retain=="object"){const g=Object.keys(u.retain)[0];if(g==null)return a;this.scroll.updateEmbedAt(a,g,u.retain[g])}Object.keys(i).forEach(g=>{this.scroll.formatAt(a,l,g,i[g])});const h=c?1:0,f=p?1:0;return t+=h+f,o.retain(h),o.delete(f),a+l+h+f},0),o.reduce((a,u)=>typeof u.delete=="number"?(this.scroll.deleteAt(a,u.delete),a):a+Ya.Op.length(u),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(r)}deleteText(e,t){return this.scroll.deleteAt(e,t),this.update(new yn().retain(e).delete(t))}formatLine(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(r).forEach(s=>{this.scroll.lines(e,Math.max(t,1)).forEach(a=>{a.format(s,r[s])})}),this.scroll.optimize();const o=new yn().retain(e).retain(t,vf(r));return this.update(o)}formatText(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(r).forEach(s=>{this.scroll.formatAt(e,t,s,r[s])});const o=new yn().retain(e).retain(t,vf(r));return this.update(o)}getContents(e,t){return this.delta.slice(e,e+t)}getDelta(){return this.scroll.lines().reduce((e,t)=>e.concat(t.delta()),new yn)}getFormat(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=[],o=[];t===0?this.scroll.path(e).forEach(u=>{const[l]=u;l instanceof Cs?r.push(l):l instanceof Ds&&o.push(l)}):(r=this.scroll.lines(e,t),o=this.scroll.descendants(Ds,e,t));const[s,a]=[r,o].map(u=>{const l=u.shift();if(l==null)return{};let i=$a(l);for(;Object.keys(i).length>0;){const c=u.shift();if(c==null)return i;i=JD($a(c),i)}return i});return{...s,...a}}getHTML(e,t){const[r,o]=this.scroll.line(e);if(r){const s=r.length();return r.length()>=o+t&&!(o===0&&t===s)?Zh(r,o,t,!0):Zh(this.scroll,e,t,!0)}return""}getText(e,t){return this.getContents(e,t).filter(r=>typeof r.insert=="string").map(r=>r.insert).join("")}insertContents(e,t){const r=zw(t),o=new yn().retain(e).concat(r);return this.scroll.insertContents(e,r),this.update(o)}insertEmbed(e,t,r){return this.scroll.insertAt(e,t,r),this.update(new yn().retain(e).insert({[t]:r}))}insertText(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t=t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(e,t),Object.keys(r).forEach(o=>{this.scroll.formatAt(e,t.length,o,r[o])}),this.update(new yn().retain(e).insert(t,vf(r)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const e=this.scroll.children.head;if(e?.statics.blotName!==Cs.blotName)return!1;const t=e;return t.children.length>1?!1:t.children.head instanceof Ao}removeFormat(e,t){const r=this.getText(e,t),[o,s]=this.scroll.line(e+t);let a=0,u=new yn;o!=null&&(a=o.length()-s,u=o.delta().slice(s,s+a-1).insert(`
`));const i=this.getContents(e,t+a).diff(new yn().insert(r).concat(u)),c=new yn().retain(e).concat(i);return this.applyDelta(c)}update(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const o=this.delta;if(t.length===1&&t[0].type==="characterData"&&t[0].target.data.match(ZD)&&this.scroll.find(t[0].target)){const s=this.scroll.find(t[0].target),a=$a(s),u=s.offset(this.scroll),l=t[0].oldValue.replace(yo.CONTENTS,""),i=new yn().insert(l),c=new yn().insert(s.value()),p=r&&{oldRange:qw(r.oldRange,-u),newRange:qw(r.newRange,-u)};e=new yn().retain(u).concat(i.diff(c,p)).reduce((f,g)=>g.insert?f.insert(g.insert,a):f.push(g),new yn),this.delta=o.compose(e)}else this.delta=this.getDelta(),(!e||!wu(o.compose(e),this.delta))&&(e=o.diff(this.delta,r));return e}}function hf(n,e,t){if(n.length===0){const[f]=I1(t.pop());return e<=0?`</li></${f}>`:`</li></${f}>${hf([],e-1,t)}`}const[{child:r,offset:o,length:s,indent:a,type:u},...l]=n,[i,c]=I1(u);if(a>e)return t.push(u),a===e+1?`<${i}><li${c}>${Zh(r,o,s)}${hf(l,a,t)}`:`<${i}><li>${hf(n,e+1,t)}`;const p=t[t.length-1];if(a===e&&u===p)return`</li><li${c}>${Zh(r,o,s)}${hf(l,a,t)}`;const[h]=I1(t.pop());return`</li></${h}>${hf(n,e-1,t)}`}function Zh(n,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in n&&typeof n.html=="function")return n.html(e,t);if(n instanceof So)return S0(n.value().slice(e,e+t));if(n instanceof xo){if(n.statics.blotName==="list-container"){const i=[];return n.children.forEachAt(e,t,(c,p,h)=>{const f="formats"in c&&typeof c.formats=="function"?c.formats():{};i.push({child:c,offset:p,length:h,indent:f.indent||0,type:f.list})}),hf(i,-1,[])}const o=[];if(n.children.forEachAt(e,t,(i,c,p)=>{o.push(Zh(i,c,p))}),r||n.statics.blotName==="list")return o.join("");const{outerHTML:s,innerHTML:a}=n.domNode,[u,l]=s.split(`>${a}<`);return u==="<table"?`<table style="border: 1px solid #000;">${o.join("")}<${l}`:`${u}>${o.join("")}<${l}`}return n.domNode instanceof Element?n.domNode.outerHTML:""}function JD(n,e){return Object.keys(e).reduce((t,r)=>{if(n[r]==null)return t;const o=e[r];return o===n[r]?t[r]=o:Array.isArray(o)?o.indexOf(n[r])<0?t[r]=o.concat([n[r]]):t[r]=o:t[r]=[o,n[r]],t},{})}function I1(n){const e=n==="ordered"?"ol":"ul";switch(n){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function zw(n){return n.reduce((e,t)=>{if(typeof t.insert=="string"){const r=t.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return e.insert(r,t.attributes)}return e.push(t)},new yn)}function qw(n,e){let{index:t,length:r}=n;return new ac(t+e,r)}function tB(n){const e=[];return n.forEach(t=>{typeof t.insert=="string"?t.insert.split(`
`).forEach((o,s)=>{s&&e.push({insert:`
`,attributes:t.attributes}),o&&e.push({insert:o,attributes:t.attributes})}):e.push(t)}),e}class nl{static DEFAULTS={};constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=e,this.options=t}}const vp="\uFEFF";class $b extends Na{constructor(e,t){super(e,t),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(r=>{this.contentNode.appendChild(r)}),this.leftGuard=document.createTextNode(vp),this.rightGuard=document.createTextNode(vp),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,t){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,t)}restore(e){let t=null,r;const o=e.data.split(vp).join("");if(e===this.leftGuard)if(this.prev instanceof So){const s=this.prev.length();this.prev.insertAt(s,o),t={startNode:this.prev.domNode,startOffset:s+o.length}}else r=document.createTextNode(o),this.parent.insertBefore(this.scroll.create(r),this),t={startNode:r,startOffset:o.length};else e===this.rightGuard&&(this.next instanceof So?(this.next.insertAt(0,o),t={startNode:this.next.domNode,startOffset:o.length}):(r=document.createTextNode(o),this.parent.insertBefore(this.scroll.create(r),this.next),t={startNode:r,startOffset:o.length}));return e.data=vp,t}update(e,t){e.forEach(r=>{if(r.type==="characterData"&&(r.target===this.leftGuard||r.target===this.rightGuard)){const o=this.restore(r.target);o&&(t.range=o)}})}}class eB{isComposing=!1;constructor(e,t){this.scroll=e,this.emitter=t,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",e=>{this.isComposing||this.handleCompositionStart(e)}),this.scroll.domNode.addEventListener("compositionend",e=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(e)})})}handleCompositionStart(e){const t=e.target instanceof Node?this.scroll.find(e.target,!0):null;t&&!(t instanceof $b)&&(this.emitter.emit(pn.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(pn.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(pn.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(pn.events.COMPOSITION_END,e),this.isComposing=!1}}class Of{static DEFAULTS={modules:{}};static themes={default:Of};modules={};constructor(e,t){this.quill=e,this.options=t}init(){Object.keys(this.options.modules).forEach(e=>{this.modules[e]==null&&this.addModule(e)})}addModule(e){const t=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new t(this.quill,this.options.modules[e]||{}),this.modules[e]}}const nB=n=>n.parentElement||n.getRootNode().host||null,rB=n=>{const e=n.getBoundingClientRect(),t="offsetWidth"in n&&Math.abs(e.width)/n.offsetWidth||1,r="offsetHeight"in n&&Math.abs(e.height)/n.offsetHeight||1;return{top:e.top,right:e.left+n.clientWidth*t,bottom:e.top+n.clientHeight*r,left:e.left}},wp=n=>{const e=parseInt(n,10);return Number.isNaN(e)?0:e},Uw=(n,e,t,r,o,s)=>n<t&&e>r?0:n<t?-(t-n+o):e>r?e-n>r-t?n+o-t:e-r+s:0,iB=(n,e)=>{const t=n.ownerDocument;let r=e,o=n;for(;o;){const s=o===t.body,a=s?{top:0,right:window.visualViewport?.width??t.documentElement.clientWidth,bottom:window.visualViewport?.height??t.documentElement.clientHeight,left:0}:rB(o),u=getComputedStyle(o),l=Uw(r.left,r.right,a.left,a.right,wp(u.scrollPaddingLeft),wp(u.scrollPaddingRight)),i=Uw(r.top,r.bottom,a.top,a.bottom,wp(u.scrollPaddingTop),wp(u.scrollPaddingBottom));if(l||i)if(s)t.defaultView?.scrollBy(l,i);else{const{scrollLeft:c,scrollTop:p}=o;i&&(o.scrollTop+=i),l&&(o.scrollLeft+=l);const h=o.scrollLeft-c,f=o.scrollTop-p;r={left:r.left-h,top:r.top-f,right:r.right-h,bottom:r.bottom-f}}o=s||u.position==="fixed"?null:nB(o)}},sB=100,aB=["block","break","cursor","inline","scroll","text"],oB=(n,e,t)=>{const r=new Tf;return aB.forEach(o=>{const s=e.query(o);s&&r.register(s)}),n.forEach(o=>{let s=e.query(o);s||t.error(`Cannot register "${o}" specified in "formats" config. Are you sure it was registered?`);let a=0;for(;s;)if(r.register(s),s="blotName"in s?s.requiredContainer??null:null,a+=1,a>sB){t.error(`Cycle detected in registering blot requiredContainer: "${o}"`);break}}),r},xf=Fl("quill"),xp=new Tf;xo.uiClass="ql-ui";class Ce{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:xp,theme:"default"};static events=pn.events;static sources=pn.sources;static version="2.0.2";static imports={delta:yn,parchment:qD,"core/module":nl,"core/theme":Of};static debug(e){e===!0&&(e="log"),Fl.level(e)}static find(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Kg.get(e)||xp.find(e,t)}static import(e){return this.imports[e]==null&&xf.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const e=arguments.length<=0?void 0:arguments[0],t=!!(!(arguments.length<=1)&&arguments[1]),r="attrName"in e?e.attrName:e.blotName;typeof r=="string"?this.register(`formats/${r}`,e,t):Object.keys(e).forEach(o=>{this.register(o,e[o],t)})}else{const e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],r=!!(!(arguments.length<=2)&&arguments[2]);this.imports[e]!=null&&!r&&xf.warn(`Overwriting ${e} with`,t),this.imports[e]=t,(e.startsWith("blots/")||e.startsWith("formats/"))&&t&&typeof t!="boolean"&&t.blotName!=="abstract"&&xp.register(t),typeof t.register=="function"&&t.register(xp)}}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=lB(e,t),this.container=this.options.container,this.container==null){xf.error("Invalid Quill container",e);return}this.options.debug&&Ce.debug(this.options.debug);const r=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",Kg.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new pn;const o=Hb.blotName,s=this.options.registry.query(o);if(!s||!("blotName"in s))throw new Error(`Cannot initialize Quill without "${o}" blot`);if(this.scroll=new s(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new QD(this.scroll),this.selection=new KD(this.scroll,this.emitter),this.composition=new eB(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(pn.events.EDITOR_CHANGE,a=>{a===pn.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(pn.events.SCROLL_UPDATE,(a,u)=>{const l=this.selection.lastRange,[i]=this.selection.getRange(),c=l&&i?{oldRange:l,newRange:i}:void 0;mo.call(this,()=>this.editor.update(null,u,c),a)}),this.emitter.on(pn.events.SCROLL_EMBED_UPDATE,(a,u)=>{const l=this.selection.lastRange,[i]=this.selection.getRange(),c=l&&i?{oldRange:l,newRange:i}:void 0;mo.call(this,()=>{const p=new yn().retain(a.offset(this)).retain({[a.statics.blotName]:u});return this.editor.update(p,[],c)},Ce.sources.USER)}),r){const a=this.clipboard.convert({html:`${r}<p><br></p>`,text:`
`});this.setContents(a)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string"){const r=e;e=document.createElement("div"),e.classList.add(r)}return this.container.insertBefore(e,t),e}blur(){this.selection.setRange(null)}deleteText(e,t,r){return[e,t,,r]=kl(e,t,r),mo.call(this,()=>this.editor.deleteText(e,t),r,e,-1*t)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;const t=e();return this.allowReadOnlyEdits=!1,t}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pn.sources.API;return mo.call(this,()=>{const o=this.getSelection(!0);let s=new yn;if(o==null)return s;if(this.scroll.query(e,wn.BLOCK))s=this.editor.formatLine(o.index,o.length,{[e]:t});else{if(o.length===0)return this.selection.format(e,t),s;s=this.editor.formatText(o.index,o.length,{[e]:t})}return this.setSelection(o,pn.sources.SILENT),s},r)}formatLine(e,t,r,o,s){let a;return[e,t,a,s]=kl(e,t,r,o,s),mo.call(this,()=>this.editor.formatLine(e,t,a),s,e,0)}formatText(e,t,r,o,s){let a;return[e,t,a,s]=kl(e,t,r,o,s),mo.call(this,()=>this.editor.formatText(e,t,a),s,e,0)}getBounds(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=null;if(typeof e=="number"?r=this.selection.getBounds(e,t):r=this.selection.getBounds(e.index,e.length),!r)return null;const o=this.container.getBoundingClientRect();return{bottom:r.bottom-o.top,height:r.height,left:r.left-o.left,right:r.right-o.left,top:r.top-o.top,width:r.width}}getContents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-e;return[e,t]=kl(e,t),this.editor.getContents(e,t)}getFormat(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof e=="number"?this.editor.getFormat(e,t):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof e!="number"?this.scroll.lines(e.index,e.length):this.scroll.lines(e,t)}getModule(e){return this.theme.modules[e]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(t=t??this.getLength()-e),[e,t]=kl(e,t),this.editor.getHTML(e,t)}getText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(t=t??this.getLength()-e),[e,t]=kl(e,t),this.editor.getText(e,t)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,t,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ce.sources.API;return mo.call(this,()=>this.editor.insertEmbed(e,t,r),o,e)}insertText(e,t,r,o,s){let a;return[e,,a,s]=kl(e,0,r,o,s),mo.call(this,()=>this.editor.insertText(e,t,a),s,e,t.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,t,r){return[e,t,,r]=kl(e,t,r),mo.call(this,()=>this.editor.removeFormat(e,t),r,e)}scrollRectIntoView(e){iB(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const e=this.selection.lastRange,t=e&&this.selection.getBounds(e.index,e.length);t&&this.scrollRectIntoView(t)}setContents(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pn.sources.API;return mo.call(this,()=>{e=new yn(e);const r=this.getLength(),o=this.editor.deleteText(0,r),s=this.editor.insertContents(0,e),a=this.editor.deleteText(this.getLength()-1,1);return o.compose(s).compose(a)},t)}setSelection(e,t,r){e==null?this.selection.setRange(null,t||Ce.sources.API):([e,t,,r]=kl(e,t,r),this.selection.setRange(new ac(Math.max(0,e),t),r),r!==pn.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pn.sources.API;const r=new yn().insert(e);return this.setContents(r,t)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pn.sources.USER;const t=this.scroll.update(e);return this.selection.update(e),t}updateContents(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pn.sources.API;return mo.call(this,()=>(e=new yn(e),this.editor.applyDelta(e)),t,!0)}}function Hw(n){return typeof n=="string"?document.querySelector(n):n}function D1(n){return Object.entries(n??{}).reduce((e,t)=>{let[r,o]=t;return{...e,[r]:o===!0?{}:o}},{})}function $w(n){return Object.fromEntries(Object.entries(n).filter(e=>e[1]!==void 0))}function lB(n,e){const t=Hw(n);if(!t)throw new Error("Invalid Quill container");const o=!e.theme||e.theme===Ce.DEFAULTS.theme?Of:Ce.import(`themes/${e.theme}`);if(!o)throw new Error(`Invalid theme ${e.theme}. Did you register it?`);const{modules:s,...a}=Ce.DEFAULTS,{modules:u,...l}=o.DEFAULTS;let i=D1(e.modules);i!=null&&i.toolbar&&i.toolbar.constructor!==Object&&(i={...i,toolbar:{container:i.toolbar}});const c=_u({},D1(s),D1(u),i),p={...a,...$w(l),...$w(e)};let h=e.registry;return h?e.formats&&xf.warn('Ignoring "formats" option because "registry" is specified'):h=e.formats?oB(e.formats,p.registry,xf):p.registry,{...p,registry:h,container:t,theme:o,modules:Object.entries(c).reduce((f,g)=>{let[y,b]=g;if(!b)return f;const v=Ce.import(`modules/${y}`);return v==null?(xf.error(`Cannot load ${y} module. Are you sure you registered it?`),f):{...f,[y]:_u({},v.DEFAULTS||{},b)}},{}),bounds:Hw(p.bounds)}}function mo(n,e,t,r){if(!this.isEnabled()&&e===pn.sources.USER&&!this.allowReadOnlyEdits)return new yn;let o=t==null?null:this.getSelection();const s=this.editor.delta,a=n();if(o!=null&&(t===!0&&(t=o.index),r==null?o=Vw(o,a,e):r!==0&&(o=Vw(o,t,r,e)),this.setSelection(o,pn.sources.SILENT)),a.length()>0){const u=[pn.events.TEXT_CHANGE,a,s,e];this.emitter.emit(pn.events.EDITOR_CHANGE,...u),e!==pn.sources.SILENT&&this.emitter.emit(...u)}return a}function kl(n,e,t,r,o){let s={};return typeof n.index=="number"&&typeof n.length=="number"?typeof e!="number"?(o=r,r=t,t=e,e=n.length,n=n.index):(e=n.length,n=n.index):typeof e!="number"&&(o=r,r=t,t=e,e=0),typeof t=="object"?(s=t,o=r):typeof t=="string"&&(r!=null?s[t]=r:o=t),o=o||pn.sources.API,[n,e,s,o]}function Vw(n,e,t,r){const o=typeof t=="number"?t:0;if(n==null)return null;let s,a;return e&&typeof e.transformPosition=="function"?[s,a]=[n.index,n.index+n.length].map(u=>e.transformPosition(u,r!==pn.sources.USER)):[s,a]=[n.index,n.index+n.length].map(u=>u<e||u===e&&r===pn.sources.USER?u:o>=0?u+o:Math.max(e,u+o)),new ac(s,a-s)}class mc extends x0{}function Ww(n){return n instanceof Cs||n instanceof Ga}function Gw(n){return typeof n.updateContent=="function"}class uB extends Hb{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=Cs;static allowedChildren=[Cs,Ga,mc];constructor(e,t,r){let{emitter:o}=r;super(e,t),this.emitter=o,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",s=>this.handleDragStart(s))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(pn.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(pn.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,t){this.emitter.emit(pn.events.SCROLL_EMBED_UPDATE,e,t)}deleteAt(e,t){const[r,o]=this.line(e),[s]=this.line(e+t);if(super.deleteAt(e,t),s!=null&&r!==s&&o>0){if(r instanceof Ga||s instanceof Ga){this.optimize();return}const a=s.children.head instanceof Ao?null:s.children.head;r.moveChildren(s,a),r.remove()}this.optimize()}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,t,r,o){super.formatAt(e,t,r,o),this.optimize()}insertAt(e,t,r){if(e>=this.length())if(r==null||this.scroll.query(t,wn.BLOCK)==null){const o=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(o),r==null&&t.endsWith(`
`)?o.insertAt(0,t.slice(0,-1),r):o.insertAt(0,t,r)}else{const o=this.scroll.create(t,r);this.appendChild(o)}else super.insertAt(e,t,r);this.optimize()}insertBefore(e,t){if(e.statics.scope===wn.INLINE_BLOT){const r=this.scroll.create(this.statics.defaultChild.blotName);r.appendChild(e),super.insertBefore(r,t)}else super.insertBefore(e,t)}insertContents(e,t){const r=this.deltaToRenderBlocks(t.concat(new yn().insert(`
`))),o=r.pop();if(o==null)return;this.batchStart();const s=r.shift();if(s){const l=s.type==="block"&&(s.delta.length()===0||!this.descendant(Ga,e)[0]&&e<this.length()),i=s.type==="block"?s.delta:new yn().insert({[s.key]:s.value});B1(this,e,i);const c=s.type==="block"?1:0,p=e+i.length()+c;l&&this.insertAt(p-1,`
`);const h=$a(this.line(e)[0]),f=Ya.AttributeMap.diff(h,s.attributes)||{};Object.keys(f).forEach(g=>{this.formatAt(p-1,1,g,f[g])}),e=p}let[a,u]=this.children.find(e);if(r.length&&(a&&(a=a.split(u),u=0),r.forEach(l=>{if(l.type==="block"){const i=this.createBlock(l.attributes,a||void 0);B1(i,0,l.delta)}else{const i=this.create(l.key,l.value);this.insertBefore(i,a||void 0),Object.keys(l.attributes).forEach(c=>{i.format(c,l.attributes[c])})}})),o.type==="block"&&o.delta.length()){const l=a?a.offset(a.scroll)+u:this.length();B1(this,l,o.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(e){const t=this.path(e).pop();if(!t)return[null,-1];const[r,o]=t;return r instanceof Ds?[r,o]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(Ww,e)}lines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const r=(o,s,a)=>{let u=[],l=a;return o.children.forEachAt(s,a,(i,c,p)=>{Ww(i)?u.push(i):i instanceof x0&&(u=u.concat(r(i,c,l))),l-=p}),u};return r(this,e,t)}optimize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(e,t),e.length>0&&this.emitter.emit(pn.events.SCROLL_OPTIMIZE,e,t))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch){Array.isArray(e)&&(this.batch=this.batch.concat(e));return}let t=pn.sources.USER;typeof e=="string"&&(t=e),Array.isArray(e)||(e=this.observer.takeRecords()),e=e.filter(r=>{let{target:o}=r;const s=this.find(o,!0);return s&&!Gw(s)}),e.length>0&&this.emitter.emit(pn.events.SCROLL_BEFORE_UPDATE,t,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(pn.events.SCROLL_UPDATE,t,e)}updateEmbedAt(e,t,r){const[o]=this.descendant(s=>s instanceof Ga,e);o&&o.statics.blotName===t&&Gw(o)&&o.updateContent(r)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){const t=[];let r=new yn;return e.forEach(o=>{const s=o?.insert;if(s)if(typeof s=="string"){const a=s.split(`
`);a.slice(0,-1).forEach(l=>{r.insert(l,o.attributes),t.push({type:"block",delta:r,attributes:o.attributes??{}}),r=new yn});const u=a[a.length-1];u&&r.insert(u,o.attributes)}else{const a=Object.keys(s)[0];if(!a)return;this.query(a,wn.INLINE)?r.push(o):(r.length()&&t.push({type:"block",delta:r,attributes:{}}),r=new yn,t.push({type:"blockEmbed",key:a,value:s[a],attributes:o.attributes??{}}))}}),r.length()&&t.push({type:"block",delta:r,attributes:{}}),t}createBlock(e,t){let r;const o={};Object.entries(e).forEach(u=>{let[l,i]=u;this.query(l,wn.BLOCK&wn.BLOT)!=null?r=l:o[l]=i});const s=this.create(r||this.statics.defaultChild.blotName,r?e[r]:void 0);this.insertBefore(s,t||void 0);const a=s.length();return Object.entries(o).forEach(u=>{let[l,i]=u;s.formatAt(0,a,l,i)}),s}}function B1(n,e,t){t.reduce((r,o)=>{const s=Ya.Op.length(o);let a=o.attributes||{};if(o.insert!=null){if(typeof o.insert=="string"){const u=o.insert;n.insertAt(r,u);const[l]=n.descendant(Ds,r),i=$a(l);a=Ya.AttributeMap.diff(i,a)||{}}else if(typeof o.insert=="object"){const u=Object.keys(o.insert)[0];if(u==null)return r;if(n.insertAt(r,u,o.insert[u]),n.scroll.query(u,wn.INLINE)!=null){const[i]=n.descendant(Ds,r),c=$a(i);a=Ya.AttributeMap.diff(c,a)||{}}}}return Object.keys(a).forEach(u=>{n.formatAt(r,s,u,a[u])}),r+s},e)}const Vb={scope:wn.BLOCK,whitelist:["right","center","justify"]},cB=new Jo("align","align",Vb),r8=new ko("align","ql-align",Vb),i8=new ju("align","text-align",Vb);class s8 extends ju{value(e){let t=super.value(e);return t.startsWith("rgb(")?(t=t.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${t.split(",").map(o=>`00${parseInt(o,10).toString(16)}`.slice(-2)).join("")}`):t}}const fB=new ko("color","ql-color",{scope:wn.INLINE}),Wb=new s8("color","color",{scope:wn.INLINE}),hB=new ko("background","ql-bg",{scope:wn.INLINE}),Gb=new s8("background","background-color",{scope:wn.INLINE});class gc extends mc{static create(e){const t=super.create(e);return t.setAttribute("spellcheck","false"),t}code(e,t){return this.children.map(r=>r.length()<=1?"":r.domNode.innerText).join(`
`).slice(e,e+t)}html(e,t){return`<pre>
${S0(this.code(e,t))}
</pre>`}}class Ys extends Cs{static TAB="  ";static register(){Ce.register(gc)}}class Yb extends Vs{}Yb.blotName="code";Yb.tagName="CODE";Ys.blotName="code-block";Ys.className="ql-code-block";Ys.tagName="DIV";gc.blotName="code-block-container";gc.className="ql-code-block-container";gc.tagName="DIV";gc.allowedChildren=[Ys];Ys.allowedChildren=[So,Ao,yo];Ys.requiredContainer=gc;const Xb={scope:wn.BLOCK,whitelist:["rtl"]},a8=new Jo("direction","dir",Xb),o8=new ko("direction","ql-direction",Xb),l8=new ju("direction","direction",Xb),u8={scope:wn.INLINE,whitelist:["serif","monospace"]},c8=new ko("font","ql-font",u8);class dB extends ju{value(e){return super.value(e).replace(/["']/g,"")}}const f8=new dB("font","font-family",u8),h8=new ko("size","ql-size",{scope:wn.INLINE,whitelist:["small","large","huge"]}),d8=new ju("size","font-size",{scope:wn.INLINE,whitelist:["10px","18px","32px"]}),pB=Fl("quill:keyboard"),mB=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class _0 extends nl{static match(e,t){return["altKey","ctrlKey","metaKey","shiftKey"].some(r=>!!t[r]!==e[r]&&t[r]!==null)?!1:t.key===e.key||t.key===e.which}constructor(e,t){super(e,t),this.bindings={},Object.keys(this.options.bindings).forEach(r=>{this.options.bindings[r]&&this.addBinding(this.options.bindings[r])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=bB(e);if(o==null){pB.warn("Attempted to add invalid keyboard binding",o);return}typeof t=="function"&&(t={handler:t}),typeof r=="function"&&(r={handler:r}),(Array.isArray(o.key)?o.key:[o.key]).forEach(a=>{const u={...o,key:a,...t,...r};this.bindings[u.key]=this.bindings[u.key]||[],this.bindings[u.key].push(u)})}listen(){this.quill.root.addEventListener("keydown",e=>{if(e.defaultPrevented||e.isComposing||e.keyCode===229&&(e.key==="Enter"||e.key==="Backspace"))return;const o=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter(v=>_0.match(e,v));if(o.length===0)return;const s=Ce.find(e.target,!0);if(s&&s.scroll!==this.quill.scroll)return;const a=this.quill.getSelection();if(a==null||!this.quill.hasFocus())return;const[u,l]=this.quill.getLine(a.index),[i,c]=this.quill.getLeaf(a.index),[p,h]=a.length===0?[i,c]:this.quill.getLeaf(a.index+a.length),f=i instanceof Qp?i.value().slice(0,c):"",g=p instanceof Qp?p.value().slice(h):"",y={collapsed:a.length===0,empty:a.length===0&&u.length()<=1,format:this.quill.getFormat(a),line:u,offset:l,prefix:f,suffix:g,event:e};o.some(v=>{if(v.collapsed!=null&&v.collapsed!==y.collapsed||v.empty!=null&&v.empty!==y.empty||v.offset!=null&&v.offset!==y.offset)return!1;if(Array.isArray(v.format)){if(v.format.every(w=>y.format[w]==null))return!1}else if(typeof v.format=="object"&&!Object.keys(v.format).every(w=>v.format[w]===!0?y.format[w]!=null:v.format[w]===!1?y.format[w]==null:wu(v.format[w],y.format[w])))return!1;return v.prefix!=null&&!v.prefix.test(y.prefix)||v.suffix!=null&&!v.suffix.test(y.suffix)?!1:v.handler.call(this,a,y,v)!==!0})&&e.preventDefault()})}handleBackspace(e,t){const r=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix)?2:1;if(e.index===0||this.quill.getLength()<=1)return;let o={};const[s]=this.quill.getLine(e.index);let a=new yn().retain(e.index-r).delete(r);if(t.offset===0){const[u]=this.quill.getLine(e.index-1);if(u&&!(u.statics.blotName==="block"&&u.length()<=1)){const i=s.formats(),c=this.quill.getFormat(e.index-1,1);if(o=Ya.AttributeMap.diff(i,c)||{},Object.keys(o).length>0){const p=new yn().retain(e.index+s.length()-2).retain(1,o);a=a.compose(p)}}}this.quill.updateContents(a,Ce.sources.USER),this.quill.focus()}handleDelete(e,t){const r=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix)?2:1;if(e.index>=this.quill.getLength()-r)return;let o={};const[s]=this.quill.getLine(e.index);let a=new yn().retain(e.index).delete(r);if(t.offset>=s.length()-1){const[u]=this.quill.getLine(e.index+1);if(u){const l=s.formats(),i=this.quill.getFormat(e.index,1);o=Ya.AttributeMap.diff(l,i)||{},Object.keys(o).length>0&&(a=a.retain(u.length()-1).retain(1,o))}}this.quill.updateContents(a,Ce.sources.USER),this.quill.focus()}handleDeleteRange(e){Kb({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,t){const r=Object.keys(t.format).reduce((s,a)=>(this.quill.scroll.query(a,wn.BLOCK)&&!Array.isArray(t.format[a])&&(s[a]=t.format[a]),s),{}),o=new yn().retain(e.index).delete(e.length).insert(`
`,r);this.quill.updateContents(o,Ce.sources.USER),this.quill.setSelection(e.index+1,Ce.sources.SILENT),this.quill.focus()}}const gB={bindings:{bold:P1("bold"),italic:P1("italic"),underline:P1("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(n,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","+1",Ce.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(n,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","-1",Ce.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(n,e){e.format.indent!=null?this.quill.format("indent","-1",Ce.sources.USER):e.format.list!=null&&this.quill.format("list",!1,Ce.sources.USER)}},"indent code-block":Yw(!0),"outdent code-block":Yw(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(n){this.quill.deleteText(n.index-1,1,Ce.sources.USER)}},tab:{key:"Tab",handler(n,e){if(e.format.table)return!0;this.quill.history.cutoff();const t=new yn().retain(n.index).delete(n.length).insert("	");return this.quill.updateContents(t,Ce.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index+1,Ce.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,Ce.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(n,e){const t={list:!1};e.format.indent&&(t.indent=!1),this.quill.formatLine(n.index,n.length,t,Ce.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(n){const[e,t]=this.quill.getLine(n.index),r={...e.formats(),list:"checked"},o=new yn().retain(n.index).insert(`
`,r).retain(e.length()-t-1).retain(1,{list:"unchecked"});this.quill.updateContents(o,Ce.sources.USER),this.quill.setSelection(n.index+1,Ce.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(n,e){const[t,r]=this.quill.getLine(n.index),o=new yn().retain(n.index).insert(`
`,e.format).retain(t.length()-r-1).retain(1,{header:null});this.quill.updateContents(o,Ce.sources.USER),this.quill.setSelection(n.index+1,Ce.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(n){const e=this.quill.getModule("table");if(e){const[t,r,o,s]=e.getTable(n),a=yB(t,r,o,s);if(a==null)return;let u=t.offset();if(a<0){const l=new yn().retain(u).insert(`
`);this.quill.updateContents(l,Ce.sources.USER),this.quill.setSelection(n.index+1,n.length,Ce.sources.SILENT)}else if(a>0){u+=t.length();const l=new yn().retain(u).insert(`
`);this.quill.updateContents(l,Ce.sources.USER),this.quill.setSelection(u,Ce.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(n,e){const{event:t,line:r}=e,o=r.offset(this.quill.scroll);t.shiftKey?this.quill.setSelection(o-1,Ce.sources.USER):this.quill.setSelection(o+r.length(),Ce.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(n,e){if(this.quill.scroll.query("list")==null)return!0;const{length:t}=e.prefix,[r,o]=this.quill.getLine(n.index);if(o>t)return!0;let s;switch(e.prefix.trim()){case"[]":case"[ ]":s="unchecked";break;case"[x]":s="checked";break;case"-":case"*":s="bullet";break;default:s="ordered"}this.quill.insertText(n.index," ",Ce.sources.USER),this.quill.history.cutoff();const a=new yn().retain(n.index-o).delete(t+1).retain(r.length()-2-o).retain(1,{list:s});return this.quill.updateContents(a,Ce.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index-t,Ce.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(n){const[e,t]=this.quill.getLine(n.index);let r=2,o=e;for(;o!=null&&o.length()<=1&&o.formats()["code-block"];)if(o=o.prev,r-=1,r<=0){const s=new yn().retain(n.index+e.length()-t-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(s,Ce.sources.USER),this.quill.setSelection(n.index-1,Ce.sources.SILENT),!1}return!0}},"embed left":Sp("ArrowLeft",!1),"embed left shift":Sp("ArrowLeft",!0),"embed right":Sp("ArrowRight",!1),"embed right shift":Sp("ArrowRight",!0),"table down":Xw(!1),"table up":Xw(!0)}};_0.DEFAULTS=gB;function Yw(n){return{key:"Tab",shiftKey:!n,format:{"code-block":!0},handler(e,t){let{event:r}=t;const o=this.quill.scroll.query("code-block"),{TAB:s}=o;if(e.length===0&&!r.shiftKey){this.quill.insertText(e.index,s,Ce.sources.USER),this.quill.setSelection(e.index+s.length,Ce.sources.SILENT);return}const a=e.length===0?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:u,length:l}=e;a.forEach((i,c)=>{n?(i.insertAt(0,s),c===0?u+=s.length:l+=s.length):i.domNode.textContent.startsWith(s)&&(i.deleteAt(0,s.length),c===0?u-=s.length:l-=s.length)}),this.quill.update(Ce.sources.USER),this.quill.setSelection(u,l,Ce.sources.SILENT)}}}function Sp(n,e){return{key:n,shiftKey:e,altKey:null,[n==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(r){let{index:o}=r;n==="ArrowRight"&&(o+=r.length+1);const[s]=this.quill.getLeaf(o);return s instanceof Na?(n==="ArrowLeft"?e?this.quill.setSelection(r.index-1,r.length+1,Ce.sources.USER):this.quill.setSelection(r.index-1,Ce.sources.USER):e?this.quill.setSelection(r.index,r.length+1,Ce.sources.USER):this.quill.setSelection(r.index+r.length+1,Ce.sources.USER),!1):!0}}}function P1(n){return{key:n[0],shortKey:!0,handler(e,t){this.quill.format(n,!t.format[n],Ce.sources.USER)}}}function Xw(n){return{key:n?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,t){const r=n?"prev":"next",o=t.line,s=o.parent[r];if(s!=null){if(s.statics.blotName==="table-row"){let a=s.children.head,u=o;for(;u.prev!=null;)u=u.prev,a=a.next;const l=a.offset(this.quill.scroll)+Math.min(t.offset,a.length()-1);this.quill.setSelection(l,0,Ce.sources.USER)}}else{const a=o.table()[r];a!=null&&(n?this.quill.setSelection(a.offset(this.quill.scroll)+a.length()-1,0,Ce.sources.USER):this.quill.setSelection(a.offset(this.quill.scroll),0,Ce.sources.USER))}return!1}}}function bB(n){if(typeof n=="string"||typeof n=="number")n={key:n};else if(typeof n=="object")n=vf(n);else return null;return n.shortKey&&(n[mB]=n.shortKey,delete n.shortKey),n}function Kb(n){let{quill:e,range:t}=n;const r=e.getLines(t);let o={};if(r.length>1){const s=r[0].formats(),a=r[r.length-1].formats();o=Ya.AttributeMap.diff(a,s)||{}}e.deleteText(t,Ce.sources.USER),Object.keys(o).length>0&&e.formatLine(t.index,1,o,Ce.sources.USER),e.setSelection(t.index,Ce.sources.SILENT)}function yB(n,e,t,r){return e.prev==null&&e.next==null?t.prev==null&&t.next==null?r===0?-1:1:t.prev==null?-1:1:e.prev==null?-1:e.next==null?1:null}const vB=/font-weight:\s*normal/,wB=["P","OL","UL"],Kw=n=>n&&wB.includes(n.tagName),xB=n=>{Array.from(n.querySelectorAll("br")).filter(e=>Kw(e.previousElementSibling)&&Kw(e.nextElementSibling)).forEach(e=>{e.parentNode?.removeChild(e)})},SB=n=>{Array.from(n.querySelectorAll('b[style*="font-weight"]')).filter(e=>e.getAttribute("style")?.match(vB)).forEach(e=>{const t=n.createDocumentFragment();t.append(...e.childNodes),e.parentNode?.replaceChild(t,e)})};function _B(n){n.querySelector('[id^="docs-internal-guid-"]')&&(SB(n),xB(n))}const kB=/\bmso-list:[^;]*ignore/i,AB=/\bmso-list:[^;]*\bl(\d+)/i,CB=/\bmso-list:[^;]*\blevel(\d+)/i,EB=(n,e)=>{const t=n.getAttribute("style"),r=t?.match(AB);if(!r)return null;const o=Number(r[1]),s=t?.match(CB),a=s?Number(s[1]):1,u=new RegExp(`@list l${o}:level${a}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),l=e.match(u),i=l&&l[1]==="bullet"?"bullet":"ordered";return{id:o,indent:a,type:i,element:n}},NB=n=>{const e=Array.from(n.querySelectorAll("[style*=mso-list]")),t=[],r=[];e.forEach(a=>{(a.getAttribute("style")||"").match(kB)?t.push(a):r.push(a)}),t.forEach(a=>a.parentNode?.removeChild(a));const o=n.documentElement.innerHTML,s=r.map(a=>EB(a,o)).filter(a=>a);for(;s.length;){const a=[];let u=s.shift();for(;u;)a.push(u),u=s.length&&s[0]?.element===u.element.nextElementSibling&&s[0].id===u.id?s.shift():null;const l=document.createElement("ul");a.forEach(p=>{const h=document.createElement("li");h.setAttribute("data-list",p.type),p.indent>1&&h.setAttribute("class",`ql-indent-${p.indent-1}`),h.innerHTML=p.element.innerHTML,l.appendChild(h)});const i=a[0]?.element,{parentNode:c}=i??{};i&&c?.replaceChild(l,i),a.slice(1).forEach(p=>{let{element:h}=p;c?.removeChild(h)})}};function TB(n){n.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&NB(n)}const jB=[TB,_B],MB=n=>{n.documentElement&&jB.forEach(e=>{e(n)})},LB=Fl("quill:clipboard"),OB=[[Node.TEXT_NODE,WB],[Node.TEXT_NODE,Qw],["br",FB],[Node.ELEMENT_NODE,Qw],[Node.ELEMENT_NODE,PB],[Node.ELEMENT_NODE,BB],[Node.ELEMENT_NODE,$B],["li",UB],["ol, ul",HB],["pre",zB],["tr",VB],["b",F1("bold")],["i",F1("italic")],["strike",F1("strike")],["style",qB]],RB=[cB,a8].reduce((n,e)=>(n[e.keyName]=e,n),{}),Zw=[i8,Gb,Wb,l8,f8,d8].reduce((n,e)=>(n[e.keyName]=e,n),{});class IB extends nl{static DEFAULTS={matchers:[]};constructor(e,t){super(e,t),this.quill.root.addEventListener("copy",r=>this.onCaptureCopy(r,!1)),this.quill.root.addEventListener("cut",r=>this.onCaptureCopy(r,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],OB.concat(this.options.matchers??[]).forEach(r=>{let[o,s]=r;this.addMatcher(o,s)})}addMatcher(e,t){this.matchers.push([e,t])}convert(e){let{html:t,text:r}=e,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(o[Ys.blotName])return new yn().insert(r||"",{[Ys.blotName]:o[Ys.blotName]});if(!t)return new yn().insert(r||"",o);const s=this.convertHTML(t);return od(s,`
`)&&(s.ops[s.ops.length-1].attributes==null||o.table)?s.compose(new yn().retain(s.length()-1).delete(1)):s}normalizeHTML(e){MB(e)}convertHTML(e){const t=new DOMParser().parseFromString(e,"text/html");this.normalizeHTML(t);const r=t.body,o=new WeakMap,[s,a]=this.prepareMatching(r,o);return Zb(this.quill.scroll,r,s,a,o)}dangerouslyPasteHTML(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ce.sources.API;if(typeof e=="string"){const o=this.convert({html:e,text:""});this.quill.setContents(o,t),this.quill.setSelection(0,Ce.sources.SILENT)}else{const o=this.convert({html:t,text:""});this.quill.updateContents(new yn().retain(e).concat(o),r),this.quill.setSelection(e+o.length(),Ce.sources.SILENT)}}onCaptureCopy(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.defaultPrevented)return;e.preventDefault();const[r]=this.quill.selection.getRange();if(r==null)return;const{html:o,text:s}=this.onCopy(r,t);e.clipboardData?.setData("text/plain",s),e.clipboardData?.setData("text/html",o),t&&Kb({range:r,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter(t=>t[0]!=="#").join(`
`)}onCapturePaste(e){if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const t=this.quill.getSelection(!0);if(t==null)return;const r=e.clipboardData?.getData("text/html");let o=e.clipboardData?.getData("text/plain");if(!r&&!o){const a=e.clipboardData?.getData("text/uri-list");a&&(o=this.normalizeURIList(a))}const s=Array.from(e.clipboardData?.files||[]);if(!r&&s.length>0){this.quill.uploader.upload(t,s);return}if(r&&s.length>0){const a=new DOMParser().parseFromString(r,"text/html");if(a.body.childElementCount===1&&a.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(t,s);return}}this.onPaste(t,{html:r,text:o})}onCopy(e){const t=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:t}}onPaste(e,t){let{text:r,html:o}=t;const s=this.quill.getFormat(e.index),a=this.convert({text:r,html:o},s);LB.log("onPaste",a,{text:r,html:o});const u=new yn().retain(e.index).delete(e.length).concat(a);this.quill.updateContents(u,Ce.sources.USER),this.quill.setSelection(u.length()-e.length,Ce.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,t){const r=[],o=[];return this.matchers.forEach(s=>{const[a,u]=s;switch(a){case Node.TEXT_NODE:o.push(u);break;case Node.ELEMENT_NODE:r.push(u);break;default:Array.from(e.querySelectorAll(a)).forEach(l=>{t.has(l)?t.get(l)?.push(u):t.set(l,[u])});break}}),[r,o]}}function bc(n,e,t,r){return r.query(e)?n.reduce((o,s)=>{if(!s.insert)return o;if(s.attributes&&s.attributes[e])return o.push(s);const a=t?{[e]:t}:{};return o.insert(s.insert,{...a,...s.attributes})},new yn):n}function od(n,e){let t="";for(let r=n.ops.length-1;r>=0&&t.length<e.length;--r){const o=n.ops[r];if(typeof o.insert!="string")break;t=o.insert+t}return t.slice(-1*e.length)===e}function xu(n,e){if(!(n instanceof Element))return!1;const t=e.query(n);return t&&t.prototype instanceof Na?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(n.tagName.toLowerCase())}function DB(n,e){return n.previousElementSibling&&n.nextElementSibling&&!xu(n.previousElementSibling,e)&&!xu(n.nextElementSibling,e)}const _p=new WeakMap;function p8(n){return n==null?!1:(_p.has(n)||(n.tagName==="PRE"?_p.set(n,!0):_p.set(n,p8(n.parentNode))),_p.get(n))}function Zb(n,e,t,r,o){return e.nodeType===e.TEXT_NODE?r.reduce((s,a)=>a(e,s,n),new yn):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce((s,a)=>{let u=Zb(n,a,t,r,o);return a.nodeType===e.ELEMENT_NODE&&(u=t.reduce((l,i)=>i(a,l,n),u),u=(o.get(a)||[]).reduce((l,i)=>i(a,l,n),u)),s.concat(u)},new yn):new yn}function F1(n){return(e,t,r)=>bc(t,n,!0,r)}function BB(n,e,t){const r=Jo.keys(n),o=ko.keys(n),s=ju.keys(n),a={};return r.concat(o).concat(s).forEach(u=>{let l=t.query(u,wn.ATTRIBUTE);l!=null&&(a[l.attrName]=l.value(n),a[l.attrName])||(l=RB[u],l!=null&&(l.attrName===u||l.keyName===u)&&(a[l.attrName]=l.value(n)||void 0),l=Zw[u],l!=null&&(l.attrName===u||l.keyName===u)&&(l=Zw[u],a[l.attrName]=l.value(n)||void 0))}),Object.entries(a).reduce((u,l)=>{let[i,c]=l;return bc(u,i,c,t)},e)}function PB(n,e,t){const r=t.query(n);if(r==null)return e;if(r.prototype instanceof Na){const o={},s=r.value(n);if(s!=null)return o[r.blotName]=s,new yn().insert(o,r.formats(n,t))}else if(r.prototype instanceof Kh&&!od(e,`
`)&&e.insert(`
`),"blotName"in r&&"formats"in r&&typeof r.formats=="function")return bc(e,r.blotName,r.formats(n,t),t);return e}function FB(n,e){return od(e,`
`)||e.insert(`
`),e}function zB(n,e,t){const r=t.query("code-block"),o=r&&"formats"in r&&typeof r.formats=="function"?r.formats(n,t):!0;return bc(e,"code-block",o,t)}function qB(){return new yn}function UB(n,e,t){const r=t.query(n);if(r==null||r.blotName!=="list"||!od(e,`
`))return e;let o=-1,s=n.parentNode;for(;s!=null;)["OL","UL"].includes(s.tagName)&&(o+=1),s=s.parentNode;return o<=0?e:e.reduce((a,u)=>u.insert?u.attributes&&typeof u.attributes.indent=="number"?a.push(u):a.insert(u.insert,{indent:o,...u.attributes||{}}):a,new yn)}function HB(n,e,t){const r=n;let o=r.tagName==="OL"?"ordered":"bullet";const s=r.getAttribute("data-checked");return s&&(o=s==="true"?"checked":"unchecked"),bc(e,"list",o,t)}function Qw(n,e,t){if(!od(e,`
`)){if(xu(n,t)&&(n.childNodes.length>0||n instanceof HTMLParagraphElement))return e.insert(`
`);if(e.length()>0&&n.nextSibling){let r=n.nextSibling;for(;r!=null;){if(xu(r,t))return e.insert(`
`);const o=t.query(r);if(o&&o.prototype instanceof Ga)return e.insert(`
`);r=r.firstChild}}}return e}function $B(n,e,t){const r={},o=n.style||{};return o.fontStyle==="italic"&&(r.italic=!0),o.textDecoration==="underline"&&(r.underline=!0),o.textDecoration==="line-through"&&(r.strike=!0),(o.fontWeight?.startsWith("bold")||parseInt(o.fontWeight,10)>=700)&&(r.bold=!0),e=Object.entries(r).reduce((s,a)=>{let[u,l]=a;return bc(s,u,l,t)},e),parseFloat(o.textIndent||0)>0?new yn().insert("	").concat(e):e}function VB(n,e,t){const r=n.parentElement?.tagName==="TABLE"?n.parentElement:n.parentElement?.parentElement;if(r!=null){const s=Array.from(r.querySelectorAll("tr")).indexOf(n)+1;return bc(e,"table",s,t)}return e}function WB(n,e,t){let r=n.data;if(n.parentElement?.tagName==="O:P")return e.insert(r.trim());if(!p8(n)){if(r.trim().length===0&&r.includes(`
`)&&!DB(n,t))return e;const o=(s,a)=>{const u=a.replace(/[^\u00a0]/g,"");return u.length<1&&s?" ":u};r=r.replace(/\r\n/g," ").replace(/\n/g," "),r=r.replace(/\s\s+/g,o.bind(o,!0)),(n.previousSibling==null&&n.parentElement!=null&&xu(n.parentElement,t)||n.previousSibling instanceof Element&&xu(n.previousSibling,t))&&(r=r.replace(/^\s+/,o.bind(o,!1))),(n.nextSibling==null&&n.parentElement!=null&&xu(n.parentElement,t)||n.nextSibling instanceof Element&&xu(n.nextSibling,t))&&(r=r.replace(/\s+$/,o.bind(o,!1)))}return e.insert(r)}class GB extends nl{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(e,t){super(e,t),this.quill.on(Ce.events.EDITOR_CHANGE,(r,o,s,a)=>{r===Ce.events.SELECTION_CHANGE?o&&a!==Ce.sources.SILENT&&(this.currentRange=o):r===Ce.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||a===Ce.sources.USER?this.record(o,s):this.transform(o)),this.currentRange=Jg(this.currentRange,o))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",r=>{r.inputType==="historyUndo"?(this.undo(),r.preventDefault()):r.inputType==="historyRedo"&&(this.redo(),r.preventDefault())})}change(e,t){if(this.stack[e].length===0)return;const r=this.stack[e].pop();if(!r)return;const o=this.quill.getContents(),s=r.delta.invert(o);this.stack[t].push({delta:s,range:Jg(r.range,s)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(r.delta,Ce.sources.USER),this.ignoreChange=!1,this.restoreSelection(r)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,t){if(e.ops.length===0)return;this.stack.redo=[];let r=e.invert(t),o=this.currentRange;const s=Date.now();if(this.lastRecorded+this.options.delay>s&&this.stack.undo.length>0){const a=this.stack.undo.pop();a&&(r=r.compose(a.delta),o=a.range)}else this.lastRecorded=s;r.length()!==0&&(this.stack.undo.push({delta:r,range:o}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){Jw(this.stack.undo,e),Jw(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,Ce.sources.USER);else{const t=XB(this.quill.scroll,e.delta);this.quill.setSelection(t,Ce.sources.USER)}}}function Jw(n,e){let t=e;for(let r=n.length-1;r>=0;r-=1){const o=n[r];n[r]={delta:t.transform(o.delta,!0),range:o.range&&Jg(o.range,t)},t=o.delta.transform(t),n[r].delta.length()===0&&n.splice(r,1)}}function YB(n,e){const t=e.ops[e.ops.length-1];return t==null?!1:t.insert!=null?typeof t.insert=="string"&&t.insert.endsWith(`
`):t.attributes!=null?Object.keys(t.attributes).some(r=>n.query(r,wn.BLOCK)!=null):!1}function XB(n,e){const t=e.reduce((o,s)=>o+(s.delete||0),0);let r=e.length()-t;return YB(n,e)&&(r-=1),r}function Jg(n,e){if(!n)return n;const t=e.transformPosition(n.index),r=e.transformPosition(n.index+n.length);return{index:t,length:r-t}}class m8 extends nl{constructor(e,t){super(e,t),e.root.addEventListener("drop",r=>{r.preventDefault();let o=null;if(document.caretRangeFromPoint)o=document.caretRangeFromPoint(r.clientX,r.clientY);else if(document.caretPositionFromPoint){const a=document.caretPositionFromPoint(r.clientX,r.clientY);o=document.createRange(),o.setStart(a.offsetNode,a.offset),o.setEnd(a.offsetNode,a.offset)}const s=o&&e.selection.normalizeNative(o);if(s){const a=e.selection.normalizedToRange(s);r.dataTransfer?.files&&this.upload(a,r.dataTransfer.files)}})}upload(e,t){const r=[];Array.from(t).forEach(o=>{o&&this.options.mimetypes?.includes(o.type)&&r.push(o)}),r.length>0&&this.options.handler.call(this,e,r)}}m8.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(n,e){if(!this.quill.scroll.query("image"))return;const t=e.map(r=>new Promise(o=>{const s=new FileReader;s.onload=()=>{o(s.result)},s.readAsDataURL(r)}));Promise.all(t).then(r=>{const o=r.reduce((s,a)=>s.insert({image:a}),new yn().retain(n.index).delete(n.length));this.quill.updateContents(o,pn.sources.USER),this.quill.setSelection(n.index+r.length,pn.sources.SILENT)})}};const KB=["insertText","insertReplacementText"];class ZB extends nl{constructor(e,t){super(e,t),e.root.addEventListener("beforeinput",r=>{this.handleBeforeInput(r)}),/Android/i.test(navigator.userAgent)||e.on(Ce.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(e){Kb({range:e,quill:this.quill})}replaceText(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e.length===0)return!1;if(t){const r=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents(new yn().retain(e.index).insert(t,r),Ce.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+t.length,0,Ce.sources.SILENT),!0}handleBeforeInput(e){if(this.quill.composition.isComposing||e.defaultPrevented||!KB.includes(e.inputType))return;const t=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!t||t.collapsed===!0)return;const r=QB(e);if(r==null)return;const o=this.quill.selection.normalizeNative(t),s=o?this.quill.selection.normalizedToRange(o):null;s&&this.replaceText(s,r)&&e.preventDefault()}handleCompositionStart(){const e=this.quill.getSelection();e&&this.replaceText(e)}}function QB(n){return typeof n.data=="string"?n.data:n.dataTransfer?.types.includes("text/plain")?n.dataTransfer.getData("text/plain"):null}const JB=/Mac/i.test(navigator.platform),tP=100,eP=n=>!!(n.key==="ArrowLeft"||n.key==="ArrowRight"||n.key==="ArrowUp"||n.key==="ArrowDown"||n.key==="Home"||JB&&n.key==="a"&&n.ctrlKey===!0);class nP extends nl{isListening=!1;selectionChangeDeadline=0;constructor(e,t){super(e,t),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,t){let{line:r,event:o}=t;if(!(r instanceof xo)||!r.uiNode)return!0;const s=getComputedStyle(r.domNode).direction==="rtl";return s&&o.key!=="ArrowRight"||!s&&o.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(o.shiftKey?1:0),Ce.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&eP(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+tP,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const t=e.getRangeAt(0);if(t.collapsed!==!0||t.startOffset!==0)return;const r=this.quill.scroll.find(t.startContainer);if(!(r instanceof xo)||!r.uiNode)return;const o=document.createRange();o.setStartAfter(r.uiNode),o.setEndAfter(r.uiNode),e.removeAllRanges(),e.addRange(o)}}Ce.register({"blots/block":Cs,"blots/block/embed":Ga,"blots/break":Ao,"blots/container":mc,"blots/cursor":yo,"blots/embed":$b,"blots/inline":Vs,"blots/scroll":uB,"blots/text":So,"modules/clipboard":IB,"modules/history":GB,"modules/keyboard":_0,"modules/uploader":m8,"modules/input":ZB,"modules/uiNode":nP});class rP extends ko{add(e,t){let r=0;if(t==="+1"||t==="-1"){const o=this.value(e)||0;r=t==="+1"?o+1:o-1}else typeof t=="number"&&(r=t);return r===0?(this.remove(e),!0):super.add(e,r.toString())}canAdd(e,t){return super.canAdd(e,t)||super.canAdd(e,parseInt(t,10))}value(e){return parseInt(super.value(e),10)||void 0}}const iP=new rP("indent","ql-indent",{scope:wn.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class sP extends Cs{static blotName="blockquote";static tagName="blockquote"}class aP extends Cs{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(e){return this.tagName.indexOf(e.tagName)+1}}class ld extends mc{}ld.blotName="list-container";ld.tagName="OL";class ud extends Cs{static create(e){const t=super.create();return t.setAttribute("data-list",e),t}static formats(e){return e.getAttribute("data-list")||void 0}static register(){Ce.register(ld)}constructor(e,t){super(e,t);const r=t.ownerDocument.createElement("span"),o=s=>{if(!e.isEnabled())return;const a=this.statics.formats(t,e);a==="checked"?(this.format("list","unchecked"),s.preventDefault()):a==="unchecked"&&(this.format("list","checked"),s.preventDefault())};r.addEventListener("mousedown",o),r.addEventListener("touchstart",o),this.attachUI(r)}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-list",t):super.format(e,t)}}ud.blotName="list";ud.tagName="LI";ld.allowedChildren=[ud];ud.requiredContainer=ld;class Qb extends Vs{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class oP extends Qb{static blotName="italic";static tagName=["EM","I"]}class Jp extends Vs{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(e){const t=super.create(e);return t.setAttribute("href",this.sanitize(e)),t.setAttribute("rel","noopener noreferrer"),t.setAttribute("target","_blank"),t}static formats(e){return e.getAttribute("href")}static sanitize(e){return g8(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,t){e!==this.statics.blotName||!t?super.format(e,t):this.domNode.setAttribute("href",this.constructor.sanitize(t))}}function g8(n,e){const t=document.createElement("a");t.href=n;const r=t.href.slice(0,t.href.indexOf(":"));return e.indexOf(r)>-1}class lP extends Vs{static blotName="script";static tagName=["SUB","SUP"];static create(e){return e==="super"?document.createElement("sup"):e==="sub"?document.createElement("sub"):super.create(e)}static formats(e){if(e.tagName==="SUB")return"sub";if(e.tagName==="SUP")return"super"}}class uP extends Qb{static blotName="strike";static tagName=["S","STRIKE"]}class cP extends Vs{static blotName="underline";static tagName="U"}class fP extends $b{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(e){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const t=super.create(e);return typeof e=="string"&&(window.katex.render(e,t,{throwOnError:!1,errorColor:"#f00"}),t.setAttribute("data-value",e)),t}static value(e){return e.getAttribute("data-value")}html(){const{formula:e}=this.value();return`<span>${e}</span>`}}const tx=["alt","height","width"];class hP extends Na{static blotName="image";static tagName="IMG";static create(e){const t=super.create(e);return typeof e=="string"&&t.setAttribute("src",this.sanitize(e)),t}static formats(e){return tx.reduce((t,r)=>(e.hasAttribute(r)&&(t[r]=e.getAttribute(r)),t),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return g8(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,t){tx.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}}const ex=["height","width"];class dP extends Ga{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(e){const t=super.create(e);return t.setAttribute("frameborder","0"),t.setAttribute("allowfullscreen","true"),t.setAttribute("src",this.sanitize(e)),t}static formats(e){return ex.reduce((t,r)=>(e.hasAttribute(r)&&(t[r]=e.getAttribute(r)),t),{})}static sanitize(e){return Jp.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,t){ex.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}const jh=new ko("code-token","hljs",{scope:wn.INLINE});class Il extends Vs{static formats(e,t){for(;e!=null&&e!==t.domNode;){if(e.classList&&e.classList.contains(Ys.className))return super.formats(e,t);e=e.parentNode}}constructor(e,t,r){super(e,t,r),jh.add(this.domNode,r)}format(e,t){e!==Il.blotName?super.format(e,t):t?jh.add(this.domNode,t):(jh.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),jh.value(this.domNode)||this.unwrap()}}Il.blotName="code-token";Il.className="ql-token";class Va extends Ys{static create(e){const t=super.create(e);return typeof e=="string"&&t.setAttribute("data-language",e),t}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-language",t):super.format(e,t)}replaceWith(e,t){return this.formatAt(0,this.length(),Il.blotName,!1),super.replaceWith(e,t)}}class Bh extends gc{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,t){e===Va.blotName&&(this.forceNext=!0,this.children.forEach(r=>{r.format(e,t)}))}formatAt(e,t,r,o){r===Va.blotName&&(this.forceNext=!0),super.formatAt(e,t,r,o)}highlight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const o=`${Array.from(this.domNode.childNodes).filter(a=>a!==this.uiNode).map(a=>a.textContent).join(`
`)}
`,s=Va.formats(this.children.head.domNode);if(t||this.forceNext||this.cachedText!==o){if(o.trim().length>0||this.cachedText==null){const a=this.children.reduce((l,i)=>l.concat(e8(i,!1)),new yn),u=e(o,s);a.diff(u).reduce((l,i)=>{let{retain:c,attributes:p}=i;return c?(p&&Object.keys(p).forEach(h=>{[Va.blotName,Il.blotName].includes(h)&&this.formatAt(l,c,h,p[h])}),l+c):l},0)}this.cachedText=o,this.forceNext=!1}}html(e,t){const[r]=this.children.find(e);return`<pre data-language="${r?Va.formats(r.domNode):"plain"}">
${S0(this.code(e,t))}
</pre>`}optimize(e){if(super.optimize(e),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const t=Va.formats(this.children.head.domNode);t!==this.uiNode.value&&(this.uiNode.value=t)}}}Bh.allowedChildren=[Va];Va.requiredContainer=Bh;Va.allowedChildren=[Il,yo,So,Ao];const pP=(n,e,t)=>{if(typeof n.versionString=="string"){const r=n.versionString.split(".")[0];if(parseInt(r,10)>=11)return n.highlight(t,{language:e}).value}return n.highlight(e,t).value};class b8 extends nl{static register(){Ce.register(Il,!0),Ce.register(Va,!0),Ce.register(Bh,!0)}constructor(e,t){if(super(e,t),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((r,o)=>{let{key:s}=o;return r[s]=!0,r},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(Ce.events.SCROLL_BLOT_MOUNT,e=>{if(!(e instanceof Bh))return;const t=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(r=>{let{key:o,label:s}=r;const a=t.ownerDocument.createElement("option");a.textContent=s,a.setAttribute("value",o),t.appendChild(a)}),t.addEventListener("change",()=>{e.format(Va.blotName,t.value),this.quill.root.focus(),this.highlight(e,!0)}),e.uiNode==null&&(e.attachUI(t),e.children.head&&(t.value=Va.formats(e.children.head.domNode)))})}initTimer(){let e=null;this.quill.on(Ce.events.SCROLL_OPTIMIZE,()=>{e&&clearTimeout(e),e=setTimeout(()=>{this.highlight(),e=null},this.options.interval)})}highlight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(Ce.sources.USER);const r=this.quill.getSelection();(e==null?this.quill.scroll.descendants(Bh):[e]).forEach(s=>{s.highlight(this.highlightBlot,t)}),this.quill.update(Ce.sources.SILENT),r!=null&&this.quill.setSelection(r,Ce.sources.SILENT)}highlightBlot(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(t=this.languages[t]?t:"plain",t==="plain")return S0(e).split(`
`).reduce((o,s,a)=>(a!==0&&o.insert(`
`,{[Ys.blotName]:t}),o.insert(s)),new yn);const r=this.quill.root.ownerDocument.createElement("div");return r.classList.add(Ys.className),r.innerHTML=pP(this.options.hljs,t,e),Zb(this.quill.scroll,r,[(o,s)=>{const a=jh.value(o);return a?s.compose(new yn().retain(s.length(),{[Il.blotName]:a})):s}],[(o,s)=>o.data.split(`
`).reduce((a,u,l)=>(l!==0&&a.insert(`
`,{[Ys.blotName]:t}),a.insert(u)),s)],new WeakMap)}}b8.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class vo extends Cs{static blotName="table";static tagName="TD";static create(e){const t=super.create();return e?t.setAttribute("data-row",e):t.setAttribute("data-row",Jb()),t}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,t){e===vo.blotName&&t?this.domNode.setAttribute("data-row",t):super.format(e,t)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class oc extends mc{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const e=this.children.head.formats(),t=this.children.tail.formats(),r=this.next.children.head.formats(),o=this.next.children.tail.formats();return e.table===t.table&&e.table===r.table&&e.table===o.table}return!1}optimize(e){super.optimize(e),this.children.forEach(t=>{if(t.next==null)return;const r=t.formats(),o=t.next.formats();if(r.table!==o.table){const s=this.splitAfter(t);s&&s.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class ku extends mc{static blotName="table-body";static tagName="TBODY"}class t0 extends mc{static blotName="table-container";static tagName="TABLE";balanceCells(){const e=this.descendants(oc),t=e.reduce((r,o)=>Math.max(o.children.length,r),0);e.forEach(r=>{new Array(t-r.children.length).fill(0).forEach(()=>{let o;r.children.head!=null&&(o=vo.formats(r.children.head.domNode));const s=this.scroll.create(vo.blotName,o);r.appendChild(s),s.optimize()})})}cells(e){return this.rows().map(t=>t.children.at(e))}deleteColumn(e){const[t]=this.descendant(ku);t==null||t.children.head==null||t.children.forEach(r=>{const o=r.children.at(e);o?.remove()})}insertColumn(e){const[t]=this.descendant(ku);t==null||t.children.head==null||t.children.forEach(r=>{const o=r.children.at(e),s=vo.formats(r.children.head.domNode),a=this.scroll.create(vo.blotName,s);r.insertBefore(a,o)})}insertRow(e){const[t]=this.descendant(ku);if(t==null||t.children.head==null)return;const r=Jb(),o=this.scroll.create(oc.blotName);t.children.head.children.forEach(()=>{const a=this.scroll.create(vo.blotName,r);o.appendChild(a)});const s=t.children.at(e);t.insertBefore(o,s)}rows(){const e=this.children.head;return e==null?[]:e.children.map(t=>t)}}t0.allowedChildren=[ku];ku.requiredContainer=t0;ku.allowedChildren=[oc];oc.requiredContainer=ku;oc.allowedChildren=[vo];vo.requiredContainer=oc;function Jb(){return`row-${Math.random().toString(36).slice(2,6)}`}let mP=class extends nl{static register(){Ce.register(vo),Ce.register(oc),Ce.register(ku),Ce.register(t0)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(t0).forEach(e=>{e.balanceCells()})}deleteColumn(){const[e,,t]=this.getTable();t!=null&&(e.deleteColumn(t.cellOffset()),this.quill.update(Ce.sources.USER))}deleteRow(){const[,e]=this.getTable();e!=null&&(e.remove(),this.quill.update(Ce.sources.USER))}deleteTable(){const[e]=this.getTable();if(e==null)return;const t=e.offset();e.remove(),this.quill.update(Ce.sources.USER),this.quill.setSelection(t,Ce.sources.SILENT)}getTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(e==null)return[null,null,null,-1];const[t,r]=this.quill.getLine(e.index);if(t==null||t.statics.blotName!==vo.blotName)return[null,null,null,-1];const o=t.parent;return[o.parent.parent,o,t,r]}insertColumn(e){const t=this.quill.getSelection();if(!t)return;const[r,o,s]=this.getTable(t);if(s==null)return;const a=s.cellOffset();r.insertColumn(a+e),this.quill.update(Ce.sources.USER);let u=o.rowOffset();e===0&&(u+=1),this.quill.setSelection(t.index+u,t.length,Ce.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const t=this.quill.getSelection();if(!t)return;const[r,o,s]=this.getTable(t);if(s==null)return;const a=o.rowOffset();r.insertRow(a+e),this.quill.update(Ce.sources.USER),e>0?this.quill.setSelection(t,Ce.sources.SILENT):this.quill.setSelection(t.index+o.children.length,t.length,Ce.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,t){const r=this.quill.getSelection();if(r==null)return;const o=new Array(e).fill(0).reduce(s=>{const a=new Array(t).fill(`
`).join("");return s.insert(a,{table:Jb()})},new yn().retain(r.index));this.quill.updateContents(o,Ce.sources.USER),this.quill.setSelection(r.index,Ce.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(Ce.events.SCROLL_OPTIMIZE,e=>{e.some(t=>["TD","TR","TBODY","TABLE"].includes(t.target.tagName)?(this.quill.once(Ce.events.TEXT_CHANGE,(r,o,s)=>{s===Ce.sources.USER&&this.balanceTables()}),!0):!1)})}};const nx=Fl("quill:toolbar");class t2 extends nl{constructor(e,t){if(super(e,t),Array.isArray(this.options.container)){const r=document.createElement("div");r.setAttribute("role","toolbar"),gP(r,this.options.container),e.container?.parentNode?.insertBefore(r,e.container),this.container=r}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){nx.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(r=>{const o=this.options.handlers?.[r];o&&this.addHandler(r,o)}),Array.from(this.container.querySelectorAll("button, select")).forEach(r=>{this.attach(r)}),this.quill.on(Ce.events.EDITOR_CHANGE,()=>{const[r]=this.quill.selection.getRange();this.update(r)})}addHandler(e,t){this.handlers[e]=t}attach(e){let t=Array.from(e.classList).find(o=>o.indexOf("ql-")===0);if(!t)return;if(t=t.slice(3),e.tagName==="BUTTON"&&e.setAttribute("type","button"),this.handlers[t]==null&&this.quill.scroll.query(t)==null){nx.warn("ignoring attaching to nonexistent format",t,e);return}const r=e.tagName==="SELECT"?"change":"click";e.addEventListener(r,o=>{let s;if(e.tagName==="SELECT"){if(e.selectedIndex<0)return;const u=e.options[e.selectedIndex];u.hasAttribute("selected")?s=!1:s=u.value||!1}else e.classList.contains("ql-active")?s=!1:s=e.value||!e.hasAttribute("value"),o.preventDefault();this.quill.focus();const[a]=this.quill.selection.getRange();if(this.handlers[t]!=null)this.handlers[t].call(this,s);else if(this.quill.scroll.query(t).prototype instanceof Na){if(s=prompt(`Enter ${t}`),!s)return;this.quill.updateContents(new yn().retain(a.index).delete(a.length).insert({[t]:s}),Ce.sources.USER)}else this.quill.format(t,s,Ce.sources.USER);this.update(a)}),this.controls.push([t,e])}update(e){const t=e==null?{}:this.quill.getFormat(e);this.controls.forEach(r=>{const[o,s]=r;if(s.tagName==="SELECT"){let a=null;if(e==null)a=null;else if(t[o]==null)a=s.querySelector("option[selected]");else if(!Array.isArray(t[o])){let u=t[o];typeof u=="string"&&(u=u.replace(/"/g,'\\"')),a=s.querySelector(`option[value="${u}"]`)}a==null?(s.value="",s.selectedIndex=-1):a.selected=!0}else if(e==null)s.classList.remove("ql-active"),s.setAttribute("aria-pressed","false");else if(s.hasAttribute("value")){const a=t[o],u=a===s.getAttribute("value")||a!=null&&a.toString()===s.getAttribute("value")||a==null&&!s.getAttribute("value");s.classList.toggle("ql-active",u),s.setAttribute("aria-pressed",u.toString())}else{const a=t[o]!=null;s.classList.toggle("ql-active",a),s.setAttribute("aria-pressed",a.toString())}})}}t2.DEFAULTS={};function rx(n,e,t){const r=document.createElement("button");r.setAttribute("type","button"),r.classList.add(`ql-${e}`),r.setAttribute("aria-pressed","false"),t!=null?(r.value=t,r.setAttribute("aria-label",`${e}: ${t}`)):r.setAttribute("aria-label",e),n.appendChild(r)}function gP(n,e){Array.isArray(e[0])||(e=[e]),e.forEach(t=>{const r=document.createElement("span");r.classList.add("ql-formats"),t.forEach(o=>{if(typeof o=="string")rx(r,o);else{const s=Object.keys(o)[0],a=o[s];Array.isArray(a)?bP(r,s,a):rx(r,s,a)}}),n.appendChild(r)})}function bP(n,e,t){const r=document.createElement("select");r.classList.add(`ql-${e}`),t.forEach(o=>{const s=document.createElement("option");o!==!1?s.setAttribute("value",String(o)):s.setAttribute("selected","selected"),r.appendChild(s)}),n.appendChild(r)}t2.DEFAULTS={container:null,handlers:{clean(){const n=this.quill.getSelection();if(n!=null)if(n.length===0){const e=this.quill.getFormat();Object.keys(e).forEach(t=>{this.quill.scroll.query(t,wn.INLINE)!=null&&this.quill.format(t,!1,Ce.sources.USER)})}else this.quill.removeFormat(n.index,n.length,Ce.sources.USER)},direction(n){const{align:e}=this.quill.getFormat();n==="rtl"&&e==null?this.quill.format("align","right",Ce.sources.USER):!n&&e==="right"&&this.quill.format("align",!1,Ce.sources.USER),this.quill.format("direction",n,Ce.sources.USER)},indent(n){const e=this.quill.getSelection(),t=this.quill.getFormat(e),r=parseInt(t.indent||0,10);if(n==="+1"||n==="-1"){let o=n==="+1"?1:-1;t.direction==="rtl"&&(o*=-1),this.quill.format("indent",r+o,Ce.sources.USER)}},link(n){n===!0&&(n=prompt("Enter link URL:")),this.quill.format("link",n,Ce.sources.USER)},list(n){const e=this.quill.getSelection(),t=this.quill.getFormat(e);n==="check"?t.list==="checked"||t.list==="unchecked"?this.quill.format("list",!1,Ce.sources.USER):this.quill.format("list","unchecked",Ce.sources.USER):this.quill.format("list",n,Ce.sources.USER)}}};const yP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',vP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',wP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',xP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',SP='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',_P='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',kP='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',AP='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',ix='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',CP='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',EP='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',NP='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',TP='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',jP='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',MP='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',LP='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',OP='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',RP='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',IP='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',DP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',BP='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',PP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',FP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',zP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',qP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',UP='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',HP='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',$P='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',VP='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',WP='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',GP='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',YP='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',XP='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',Qh={align:{"":yP,center:vP,right:wP,justify:xP},background:SP,blockquote:_P,bold:kP,clean:AP,code:ix,"code-block":ix,color:CP,direction:{"":EP,rtl:NP},formula:TP,header:{1:jP,2:MP,3:LP,4:OP,5:RP,6:IP},italic:DP,image:BP,indent:{"+1":PP,"-1":FP},link:zP,list:{bullet:qP,check:UP,ordered:HP},script:{sub:$P,super:VP},strike:WP,table:GP,underline:YP,video:XP},KP='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let sx=0;function ax(n,e){n.setAttribute(e,`${n.getAttribute(e)!=="true"}`)}class k0{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",t=>{switch(t.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),t.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),ax(this.label,"aria-expanded"),ax(this.options,"aria-hidden")}buildItem(e){const t=document.createElement("span");t.tabIndex="0",t.setAttribute("role","button"),t.classList.add("ql-picker-item");const r=e.getAttribute("value");return r&&t.setAttribute("data-value",r),e.textContent&&t.setAttribute("data-label",e.textContent),t.addEventListener("click",()=>{this.selectItem(t,!0)}),t.addEventListener("keydown",o=>{switch(o.key){case"Enter":this.selectItem(t,!0),o.preventDefault();break;case"Escape":this.escape(),o.preventDefault();break}}),t}buildLabel(){const e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=KP,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){const e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${sx}`,sx+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach(t=>{const r=this.buildItem(t);e.appendChild(r),t.selected===!0&&this.selectItem(r)}),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.container.querySelector(".ql-selected");e!==r&&(r?.classList.remove("ql-selected"),e!=null&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),t&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){const r=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(r)}else this.selectItem(null);const t=e!=null&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",t)}}class y8 extends k0{constructor(e,t){super(e),this.label.innerHTML=t,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(r=>{r.classList.add("ql-primary")})}buildItem(e){const t=super.buildItem(e);return t.style.backgroundColor=e.getAttribute("value")||"",t}selectItem(e,t){super.selectItem(e,t);const r=this.label.querySelector(".ql-color-label"),o=e&&e.getAttribute("data-value")||"";r&&(r.tagName==="line"?r.style.stroke=o:r.style.fill=o)}}class v8 extends k0{constructor(e,t){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(r=>{r.innerHTML=t[r.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,t){super.selectItem(e,t);const r=e||this.defaultItem;if(r!=null){if(this.label.innerHTML===r.innerHTML)return;this.label.innerHTML=r.innerHTML}}}const ZP=n=>{const{overflowY:e}=getComputedStyle(n,null);return e!=="visible"&&e!=="clip"};class w8{constructor(e,t){this.quill=e,this.boundsContainer=t||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,ZP(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){const t=e.left+e.width/2-this.root.offsetWidth/2,r=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${t}px`,this.root.style.top=`${r}px`,this.root.classList.remove("ql-flip");const o=this.boundsContainer.getBoundingClientRect(),s=this.root.getBoundingClientRect();let a=0;if(s.right>o.right&&(a=o.right-s.right,this.root.style.left=`${t+a}px`),s.left<o.left&&(a=o.left-s.left,this.root.style.left=`${t+a}px`),s.bottom>o.bottom){const u=s.bottom-s.top,l=e.bottom-e.top+u;this.root.style.top=`${r-l}px`,this.root.classList.add("ql-flip")}return a}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const QP=[!1,"center","right","justify"],JP=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],tF=[!1,"serif","monospace"],eF=["1","2","3",!1],nF=["small",!1,"large","huge"];class cd extends Of{constructor(e,t){super(e,t);const r=o=>{if(!document.body.contains(e.root)){document.body.removeEventListener("click",r);return}this.tooltip!=null&&!this.tooltip.root.contains(o.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(s=>{s.container.contains(o.target)||s.close()})};e.emitter.listenDOM("click",document.body,r)}addModule(e){const t=super.addModule(e);return e==="toolbar"&&this.extendToolbar(t),t}buildButtons(e,t){Array.from(e).forEach(r=>{(r.getAttribute("class")||"").split(/\s+/).forEach(s=>{if(s.startsWith("ql-")&&(s=s.slice(3),t[s]!=null))if(s==="direction")r.innerHTML=t[s][""]+t[s].rtl;else if(typeof t[s]=="string")r.innerHTML=t[s];else{const a=r.value||"";a!=null&&t[s][a]&&(r.innerHTML=t[s][a])}})})}buildPickers(e,t){this.pickers=Array.from(e).map(o=>{if(o.classList.contains("ql-align")&&(o.querySelector("option")==null&&_h(o,QP),typeof t.align=="object"))return new v8(o,t.align);if(o.classList.contains("ql-background")||o.classList.contains("ql-color")){const s=o.classList.contains("ql-background")?"background":"color";return o.querySelector("option")==null&&_h(o,JP,s==="background"?"#ffffff":"#000000"),new y8(o,t[s])}return o.querySelector("option")==null&&(o.classList.contains("ql-font")?_h(o,tF):o.classList.contains("ql-header")?_h(o,eF):o.classList.contains("ql-size")&&_h(o,nF)),new k0(o)});const r=()=>{this.pickers.forEach(o=>{o.update()})};this.quill.on(pn.events.EDITOR_CHANGE,r)}}cd.DEFAULTS=_u({},Of.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let n=this.container.querySelector("input.ql-image[type=file]");n==null&&(n=document.createElement("input"),n.setAttribute("type","file"),n.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),n.classList.add("ql-image"),n.addEventListener("change",()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,n.files),n.value=""}),this.container.appendChild(n)),n.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class x8 extends w8{constructor(e,t){super(e,t),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",e=>{e.key==="Enter"?(this.save(),e.preventDefault()):e.key==="Escape"&&(this.cancel(),e.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;t!=null?this.textbox.value=t:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const r=this.quill.getBounds(this.quill.selection.savedRange);r!=null&&this.position(r),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:t}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,pn.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,pn.sources.USER)),this.quill.root.scrollTop=t;break}case"video":e=rF(e);case"formula":{if(!e)break;const t=this.quill.getSelection(!0);if(t!=null){const r=t.index+t.length;this.quill.insertEmbed(r,this.root.getAttribute("data-mode"),e,pn.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(r+1," ",pn.sources.USER),this.quill.setSelection(r+2,pn.sources.USER)}break}}this.textbox.value="",this.hide()}}function rF(n){let e=n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=n.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:n}function _h(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e.forEach(r=>{const o=document.createElement("option");r===t?o.setAttribute("selected","selected"):o.setAttribute("value",String(r)),n.appendChild(o)})}const iF=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class sF extends x8{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(e,t){super(e,t),this.quill.on(pn.events.EDITOR_CHANGE,(r,o,s,a)=>{if(r===pn.events.SELECTION_CHANGE)if(o!=null&&o.length>0&&a===pn.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const u=this.quill.getLines(o.index,o.length);if(u.length===1){const l=this.quill.getBounds(o);l!=null&&this.position(l)}else{const l=u[u.length-1],i=this.quill.getIndex(l),c=Math.min(l.length()-1,o.index+o.length-i),p=this.quill.getBounds(new ac(i,c));p!=null&&this.position(p)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(pn.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const e=this.quill.getSelection();if(e!=null){const t=this.quill.getBounds(e);t!=null&&this.position(t)}},1)})}cancel(){this.show()}position(e){const t=super.position(e),r=this.root.querySelector(".ql-tooltip-arrow");return r.style.marginLeft="",t!==0&&(r.style.marginLeft=`${-1*t-r.offsetWidth/2}px`),t}}class S8 extends cd{constructor(e,t){t.modules.toolbar!=null&&t.modules.toolbar.container==null&&(t.modules.toolbar.container=iF),super(e,t),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new sF(this.quill,this.options.bounds),e.container!=null&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),Qh),this.buildPickers(e.container.querySelectorAll("select"),Qh))}}S8.DEFAULTS=_u({},cd.DEFAULTS,{modules:{toolbar:{handlers:{link(n){n?this.quill.theme.tooltip.edit():this.quill.format("link",!1,Ce.sources.USER)}}}}});const aF=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class oF extends x8{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(this.linkRange!=null){const t=this.linkRange;this.restoreFocus(),this.quill.formatText(t,"link",!1,pn.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(pn.events.SELECTION_CHANGE,(e,t,r)=>{if(e!=null){if(e.length===0&&r===pn.sources.USER){const[o,s]=this.quill.scroll.descendant(Jp,e.index);if(o!=null){this.linkRange=new ac(e.index-s,o.length());const a=Jp.formats(o.domNode);this.preview.textContent=a,this.preview.setAttribute("href",a),this.show();const u=this.quill.getBounds(this.linkRange);u!=null&&this.position(u);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class _8 extends cd{constructor(e,t){t.modules.toolbar!=null&&t.modules.toolbar.container==null&&(t.modules.toolbar.container=aF),super(e,t),this.quill.container.classList.add("ql-snow")}extendToolbar(e){e.container!=null&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),Qh),this.buildPickers(e.container.querySelectorAll("select"),Qh),this.tooltip=new oF(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(t,r)=>{e.handlers.link.call(e,!r.format.link)}))}}_8.DEFAULTS=_u({},cd.DEFAULTS,{modules:{toolbar:{handlers:{link(n){if(n){const e=this.quill.getSelection();if(e==null||e.length===0)return;let t=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(t)&&t.indexOf("mailto:")!==0&&(t=`mailto:${t}`);const{tooltip:r}=this.quill.theme;r.edit("link",t)}else this.quill.format("link",!1,Ce.sources.USER)}}}}});Ce.register({"attributors/attribute/direction":a8,"attributors/class/align":r8,"attributors/class/background":hB,"attributors/class/color":fB,"attributors/class/direction":o8,"attributors/class/font":c8,"attributors/class/size":h8,"attributors/style/align":i8,"attributors/style/background":Gb,"attributors/style/color":Wb,"attributors/style/direction":l8,"attributors/style/font":f8,"attributors/style/size":d8},!0);Ce.register({"formats/align":r8,"formats/direction":o8,"formats/indent":iP,"formats/background":Gb,"formats/color":Wb,"formats/font":c8,"formats/size":h8,"formats/blockquote":sP,"formats/code-block":Ys,"formats/header":aP,"formats/list":ud,"formats/bold":Qb,"formats/code":Yb,"formats/italic":oP,"formats/link":Jp,"formats/script":lP,"formats/strike":uP,"formats/underline":cP,"formats/formula":fP,"formats/image":hP,"formats/video":dP,"modules/syntax":b8,"modules/table":mP,"modules/toolbar":t2,"themes/bubble":S8,"themes/snow":_8,"ui/icons":Qh,"ui/picker":k0,"ui/icon-picker":v8,"ui/color-picker":y8,"ui/tooltip":w8},!0);class fd extends Ye.Component{constructor(e){super(e),this.editingAreaRef=jt.createRef(),this.containerRef=jt.createRef(),this.dirtyProps=["modules","formats","bounds","theme","children"],this.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],this.state={generation:0},this.selection=null,this.onEditorChange=(r,o,s,a)=>{r==="text-change"?this.onEditorChangeText?.(this.editor.getSemanticHTML(),o,a,this.unprivilegedEditor):r==="selection-change"&&this.onEditorChangeSelection?.(o,a,this.unprivilegedEditor)};const t=this.isControlled()?e.value:e.defaultValue;this.value=t??""}validateProps(e){if(Ye.Children.count(e.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Ye.Children.count(e.children)&&Ye.Children.only(e.children)?.type==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.");if(this.lastDeltaChangeSet&&e.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")}shouldComponentUpdate(e,t){if(this.validateProps(e),!this.editor||this.state.generation!==t.generation)return!0;if("value"in e){const r=this.getEditorContents(),o=e.value??"";this.isEqualValue(o,r)||this.setEditorContents(this.editor,o)}return e.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,e.readOnly),[...this.cleanProps,...this.dirtyProps].some(r=>!wu(e[r],this.props[r]))}shouldComponentRegenerate(e){return this.dirtyProps.some(t=>!wu(e[t],this.props[t]))}componentDidMount(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())}componentWillUnmount(){this.destroyEditor()}componentDidUpdate(e,t){if(this.editor&&this.shouldComponentRegenerate(e)){const r=this.editor.getContents(),o=this.editor.getSelection();this.regenerationSnapshot={delta:r,selection:o},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.editor&&e.placeholder!==this.props.placeholder&&(this.editor.root.dataset.placeholder=this.props.placeholder||""),this.state.generation!==t.generation){const{delta:r,selection:o}=this.regenerationSnapshot;delete this.regenerationSnapshot,this.instantiateEditor();const s=this.editor;s.setContents(r),ox(()=>this.setEditorSelection(s,o))}}instantiateEditor(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())}destroyEditor(){if(!this.editor)return;this.unhookEditor(this.editor);const e=this.props.modules?.toolbar;if(!(typeof e=="object"&&e&&"container"in e&&typeof e.container=="string"||typeof e=="string")){const r=this.containerRef.current?.querySelector(".ql-toolbar");r&&r.remove()}delete this.editor}isControlled(){return"value"in this.props}getEditorConfig(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,theme:this.props.theme}}getEditor(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor}createEditor(e,t){const r=new Ce(e,t);return t.tabIndex!=null&&this.setEditorTabIndex(r,t.tabIndex),this.hookEditor(r),r}hookEditor(e){this.unprivilegedEditor=this.makeUnprivilegedEditor(e),e.on("editor-change",this.onEditorChange)}unhookEditor(e){e.off("editor-change",this.onEditorChange)}getEditorContents(){return this.value}getEditorSelection(){return this.selection}isDelta(e){return e&&e.ops}isEqualValue(e,t){return this.isDelta(e)&&this.isDelta(t)?wu(e.ops,t.ops):wu(e,t)}setEditorContents(e,t){this.value=t;const r=this.getEditorSelection();typeof t=="string"?e.setContents(e.clipboard.convert({html:t})):e.setContents(t),ox(()=>this.setEditorSelection(e,r))}setEditorSelection(e,t){if(this.selection=t,t){const r=e.getLength();t.index=Math.max(0,Math.min(t.index,r-1)),t.length=Math.max(0,Math.min(t.length,r-1-t.index)),e.setSelection(t)}}setEditorTabIndex(e,t){e?.scroll?.domNode&&(e.scroll.domNode.tabIndex=t)}setEditorReadOnly(e,t){t?e.disable():e.enable()}makeUnprivilegedEditor(e){const t=e;return{getHTML:()=>t.root.innerHTML,getSemanticHTML:t.getSemanticHTML.bind(t),getLength:t.getLength.bind(t),getText:t.getText.bind(t),getContents:t.getContents.bind(t),getSelection:t.getSelection.bind(t),getBounds:t.getBounds.bind(t)}}getEditingArea(){const e=this.editingAreaRef.current;if(!e)throw new Error("Cannot find element for editing area");if(e.nodeType===3)throw new Error("Editing area cannot be a text node");return e}renderEditingArea(){const{children:e,preserveWhitespace:t}=this.props,{generation:r}=this.state,o={key:r,ref:this.editingAreaRef};return Ye.Children.count(e)?Ye.cloneElement(Ye.Children.only(e),o):t?Ye.createElement("pre",{...o}):Ye.createElement("div",{...o})}render(){return Ye.createElement("div",{ref:this.containerRef,id:this.props.id,style:this.props.style,key:this.state.generation,className:`quill ${this.props.className??""}`,onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())}onEditorChangeText(e,t,r,o){if(!this.editor)return;const s=this.isDelta(this.value)?o.getContents():o.getSemanticHTML();s!==this.getEditorContents()&&(this.lastDeltaChangeSet=t,this.value=s,this.props.onChange?.(e,t,r,o))}onEditorChangeSelection(e,t,r){if(!this.editor)return;const o=this.getEditorSelection(),s=!o&&e,a=o&&!e;wu(e,o)||(this.selection=e,this.props.onChangeSelection?.(e,t,r),s?this.props.onFocus?.(e,t,r):a&&this.props.onBlur?.(o,t,r))}focus(){this.editor&&this.editor.focus()}blur(){this.editor&&(this.selection=null,this.editor.blur())}}fd.displayName="React Quill";fd.Quill=Ce;fd.defaultProps={theme:"snow",modules:{},readOnly:!1};function ox(n){Promise.resolve().then(n)}function lx({pills:n,onPillsChange:e,placeholder:t,singleValue:r=!1,onFocus:o,readOnly:s=!1,noWrap:a=!1}){const u=jt.useRef(null),l=jt.useRef(null),i=g=>{!g||!g.trim()||e(r?[g.trim()]:[...n,g.trim()])},c=g=>{const y=n.filter((b,v)=>v!==g);e(y)},p=g=>{g.key===","||g.key==="Enter"||g.key===";"?(g.preventDefault(),i(u.current.value),u.current.value=""):g.key==="Backspace"&&u.current.value===""&&n.length>0&&c(n.length-1)},h=()=>{i(u.current.value),u.current.value=""},f=()=>{u.current?.focus()};return W.jsxs("div",{ref:l,onClick:s?void 0:f,className:`flex items-center gap-1.5 p-1.5 border border-gray-300 rounded-md ${a?"overflow-x-auto":"flex-wrap"} ${s?"bg-gray-100 cursor-default":"bg-white cursor-text"}`,children:[n.map((g,y)=>{const b=g.startsWith("{")&&g.endsWith("}");return W.jsxs("span",{className:`flex items-center rounded-full px-2 py-0.5 text-sm ${b?"bg-blue-100 text-blue-800":"bg-gray-200 text-gray-700"}`,children:[g,!s&&W.jsx("span",{onClick:v=>{v.stopPropagation(),c(y)},className:"ml-1.5 cursor-pointer font-bold hover:text-red-600",children:""})]},y)}),!s&&W.jsx("input",{ref:u,type:"text",className:`flex-grow border-none outline-none p-1 bg-transparent ${a?"min-w-[80px]":"min-w-[120px]"}`,placeholder:n.length===0?t:"",onKeyDown:p,onBlur:h,onFocus:o})]})}const k8="emailTemplates",ux="customEmailParameters",A8=["FirstName","LastName","StudentEmail","PersonalEmail","Grade","DaysOut","Assigned"],df=["MissingAssignmentsList","DaysLeft","Salutation"],lF={modules:{toolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}],["link"]]}},uF={modules:{toolbar:[["bold","italic","underline","link"]]}},kh={StudentName:["studentname","student name","Student Name","StudentName"],StudentEmail:["student email","school email","email","Student Email","StudentEmail"],PersonalEmail:["personal email","otheremail","Personal Email","PersonalEmail"],Grade:["grade","course grade","Grade","Course Grade","grades","Grades"],DaysOut:["days out","daysout","Days Out"],Assigned:["assigned","advisor","counselor","assigned to","Assigned","Advisor"],Tags:["tag","tags","Tag","Tags","history"],StudentIdentifier:["student identifier","student id","studentnumber","studentid","systudentid","id","Student Identifier","Student ID","SyStudentID","Student Number","StudentID"],Outreach:["outreach","Outreach"],GradeBook:["grade book","gradebook","Grade Book","GradeBook"],Assignment:["assignment","Assignment"]},cF=[{value:"eq",text:"is equal to"},{value:"neq",text:"is not equal to"},{value:"contains",text:"contains"},{value:"does_not_contain",text:"does not contain"},{value:"starts_with",text:"starts with"},{value:"ends_with",text:"ends with"},{value:"gt",text:"is greater than"},{value:"lt",text:"is less than"},{value:"gte",text:"is greater than or equal to"},{value:"lte",text:"is less than or equal to"}],Ah={standard:"px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded hover:bg-gray-300",special:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded hover:bg-orange-200",custom:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded hover:bg-blue-200",mapped:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded hover:bg-purple-200",nested:"px-2 py-1 bg-rose-100 text-rose-800 text-xs rounded hover:bg-rose-200"};function kp(n,e){for(const t of e){const r=n.indexOf(t.toLowerCase());if(r!==-1)return r}return-1}function C8(){const n=new Date;return`LDA ${n.getMonth()+1}-${n.getDate()}-${n.getFullYear()}`}function fF(n){if(!n||typeof n!="string")return{first:"",last:""};const e=n.trim();if(e.includes(",")){const t=e.split(",").map(s=>s.trim()),r=t[0];return{first:t[1]||"",last:r}}else{const t=e.split(" ").filter(s=>s);if(t.length===1)return{first:t[0],last:""};const r=t.pop();return{first:t.join(" "),last:r}}}function hF(n){return typeof n!="string"||!n.trim()?!1:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)}function dF(n,e){const t=String(n).trim().toLowerCase(),r=String(e.if).trim().toLowerCase(),o=parseFloat(n),s=parseFloat(e.if),a=!isNaN(o)&&!isNaN(s);switch(e.operator){case"eq":return t===r;case"neq":return t!==r;case"contains":return t.includes(r);case"does_not_contain":return!t.includes(r);case"starts_with":return t.startsWith(r);case"ends_with":return t.endsWith(r);case"gt":return a&&o>s;case"lt":return a&&o<s;case"gte":return a&&o>=s;case"lte":return a&&o<=s;default:return!1}}const Xo=(n,e)=>{if(!n)return"";let t=n;for(let r=0;r<10&&/\{(\w+)\}/.test(t);r++)t=t.replace(/\{(\w+)\}/g,(o,s)=>{let a=e.hasOwnProperty(s)?e[s]:o;if(typeof a=="string"){const u=a.trim();if(u.startsWith("<p>")&&u.endsWith("</p>")){const l=u.substring(3,u.length-4);!l.includes("<p>")&&!l.includes("<div>")&&(a=l)}}return a});return t},E8=(n,e)=>!n||n.length===0?"":n.map(t=>Xo(t,e)).join(";");function cx(n){if(!n||typeof n!="string")return null;const e=/=HYPERLINK\("([^"]+)",\s*"([^"]+)"\)/i,t=n.match(e);return t?{url:t[1],text:t[2]}:null}async function pF(n){const e=new Map;try{const t=n.workbook.worksheets.getItemOrNullObject("Missing Assignments");if(await n.sync(),t.isNullObject)return e;const r=t.getUsedRangeOrNullObject();if(r.load("values, formulas, isNullObject"),await n.sync(),r.isNullObject)return e;const o=r.values,s=r.formulas,a=o[0].map(c=>String(c??"").toLowerCase()),u=a.findIndex(c=>c.includes("grade book")||c.includes("gradebook")),l=a.findIndex(c=>c.includes("assignment"));if(u===-1||l===-1)return e;const i=new Map;for(let c=1;c<o.length;c++){const p=s[c][u];let h=o[c][u];if(p){const w=cx(p);w&&(h=w.url)}const f=String(h??"").trim();if(!f)continue;const g=s[c][l],y=o[c][l],b=cx(g);let v=null;b?v={url:b.url,title:b.text}:y&&(v={url:null,title:String(y)}),v&&(i.has(f)||i.set(f,[]),i.get(f).push(v))}for(const[c,p]of i){const h=p.map(f=>f.url?`<li><a href="${f.url}" target="_blank">${f.title}</a></li>`:`<li>${f.title}</li>`).join("");e.set(c,`<ul>${h}</ul>`)}}catch(t){console.error("Error building missing assignments cache:",t)}return e}function Yr(n){"@babel/helpers - typeof";return Yr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yr(n)}var _o=Uint8Array,Ca=Uint16Array,e2=Int32Array,n2=new _o([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),r2=new _o([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),fx=new _o([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),N8=function(n,e){for(var t=new Ca(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var o=new e2(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)o[s]=s-t[r]<<5|r;return{b:t,r:o}},T8=N8(n2,2),mF=T8.b,tb=T8.r;mF[28]=258,tb[258]=28;var gF=N8(r2,0),hx=gF.r,eb=new Ca(32768);for(var wi=0;wi<32768;++wi){var bu=(wi&43690)>>1|(wi&21845)<<1;bu=(bu&52428)>>2|(bu&13107)<<2,bu=(bu&61680)>>4|(bu&3855)<<4,eb[wi]=((bu&65280)>>8|(bu&255)<<8)>>1}var Ph=(function(n,e,t){for(var r=n.length,o=0,s=new Ca(e);o<r;++o)n[o]&&++s[n[o]-1];var a=new Ca(e);for(o=1;o<e;++o)a[o]=a[o-1]+s[o-1]<<1;var u;if(t){u=new Ca(1<<e);var l=15-e;for(o=0;o<r;++o)if(n[o])for(var i=o<<4|n[o],c=e-n[o],p=a[n[o]-1]++<<c,h=p|(1<<c)-1;p<=h;++p)u[eb[p]>>l]=i}else for(u=new Ca(r),o=0;o<r;++o)n[o]&&(u[o]=eb[a[n[o]-1]++]>>15-n[o]);return u}),lc=new _o(288);for(var wi=0;wi<144;++wi)lc[wi]=8;for(var wi=144;wi<256;++wi)lc[wi]=9;for(var wi=256;wi<280;++wi)lc[wi]=7;for(var wi=280;wi<288;++wi)lc[wi]=8;var e0=new _o(32);for(var wi=0;wi<32;++wi)e0[wi]=5;var bF=Ph(lc,9,0),yF=Ph(e0,5,0),j8=function(n){return(n+7)/8|0},vF=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new _o(n.subarray(e,t))},Al=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8},Ch=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},z1=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var o=t.length,s=t.slice();if(!o)return{t:L8,l:0};if(o==1){var a=new _o(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(D,F){return D.f-F.f}),t.push({s:-1,f:25001});var u=t[0],l=t[1],i=0,c=1,p=2;for(t[0]={s:-1,f:u.f+l.f,l:u,r:l};c!=o-1;)u=t[t[i].f<t[p].f?i++:p++],l=t[i!=c&&t[i].f<t[p].f?i++:p++],t[c++]={s:-1,f:u.f+l.f,l:u,r:l};for(var h=s[0].s,r=1;r<o;++r)s[r].s>h&&(h=s[r].s);var f=new Ca(h+1),g=nb(t[c-1],f,0);if(g>e){var r=0,y=0,b=g-e,v=1<<b;for(s.sort(function(F,G){return f[G.s]-f[F.s]||F.f-G.f});r<o;++r){var w=s[r].s;if(f[w]>e)y+=v-(1<<g-f[w]),f[w]=e;else break}for(y>>=b;y>0;){var S=s[r].s;f[S]<e?y-=1<<e-f[S]++-1:++r}for(;r>=0&&y;--r){var N=s[r].s;f[N]==e&&(--f[N],++y)}g=e}return{t:new _o(f),l:g}},nb=function(n,e,t){return n.s==-1?Math.max(nb(n.l,e,t+1),nb(n.r,e,t+1)):e[n.s]=t},dx=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Ca(++e),r=0,o=n[0],s=1,a=function(l){t[r++]=l},u=1;u<=e;++u)if(n[u]==o&&u!=e)++s;else{if(!o&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(o),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(o);s=1,o=n[u]}return{c:t.subarray(0,r),n:e}},Eh=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},M8=function(n,e,t){var r=t.length,o=j8(e+2);n[o]=r&255,n[o+1]=r>>8,n[o+2]=n[o]^255,n[o+3]=n[o+1]^255;for(var s=0;s<r;++s)n[o+s+4]=t[s];return(o+4+r)*8},px=function(n,e,t,r,o,s,a,u,l,i,c){Al(e,c++,t),++o[256];for(var p=z1(o,15),h=p.t,f=p.l,g=z1(s,15),y=g.t,b=g.l,v=dx(h),w=v.c,S=v.n,N=dx(y),D=N.c,F=N.n,G=new Ca(19),P=0;P<w.length;++P)++G[w[P]&31];for(var P=0;P<D.length;++P)++G[D[P]&31];for(var U=z1(G,7),q=U.t,R=U.l,I=19;I>4&&!q[fx[I-1]];--I);var T=i+5<<3,L=Eh(o,lc)+Eh(s,e0)+a,E=Eh(o,h)+Eh(s,y)+a+14+3*I+Eh(G,q)+2*G[16]+3*G[17]+7*G[18];if(l>=0&&T<=L&&T<=E)return M8(e,c,n.subarray(l,l+i));var x,k,A,C;if(Al(e,c,1+(E<L)),c+=2,E<L){x=Ph(h,f,0),k=h,A=Ph(y,b,0),C=y;var j=Ph(q,R,0);Al(e,c,S-257),Al(e,c+5,F-1),Al(e,c+10,I-4),c+=14;for(var P=0;P<I;++P)Al(e,c+3*P,q[fx[P]]);c+=3*I;for(var B=[w,D],O=0;O<2;++O)for(var H=B[O],P=0;P<H.length;++P){var X=H[P]&31;Al(e,c,j[X]),c+=q[X],X>15&&(Al(e,c,H[P]>>5&127),c+=H[P]>>12)}}else x=bF,k=lc,A=yF,C=e0;for(var P=0;P<u;++P){var et=r[P];if(et>255){var X=et>>18&31;Ch(e,c,x[X+257]),c+=k[X+257],X>7&&(Al(e,c,et>>23&31),c+=n2[X]);var V=et&31;Ch(e,c,A[V]),c+=C[V],V>3&&(Ch(e,c,et>>5&8191),c+=r2[V])}else Ch(e,c,x[et]),c+=k[et]}return Ch(e,c,x[256]),c+k[256]},wF=new e2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),L8=new _o(0),xF=function(n,e,t,r,o,s){var a=s.z||n.length,u=new _o(r+a+5*(1+Math.ceil(a/7e3))+o),l=u.subarray(r,u.length-o),i=s.l,c=(s.r||0)&7;if(e){c&&(l[0]=s.r>>3);for(var p=wF[e-1],h=p>>13,f=p&8191,g=(1<<t)-1,y=s.p||new Ca(32768),b=s.h||new Ca(g+1),v=Math.ceil(t/3),w=2*v,S=function(at){return(n[at]^n[at+1]<<v^n[at+2]<<w)&g},N=new e2(25e3),D=new Ca(288),F=new Ca(32),G=0,P=0,U=s.i||0,q=0,R=s.w||0,I=0;U+2<a;++U){var T=S(U),L=U&32767,E=b[T];if(y[L]=E,b[T]=L,R<=U){var x=a-U;if((G>7e3||q>24576)&&(x>423||!i)){c=px(n,l,0,N,D,F,P,q,I,U-I,c),q=G=P=0,I=U;for(var k=0;k<286;++k)D[k]=0;for(var k=0;k<30;++k)F[k]=0}var A=2,C=0,j=f,B=L-E&32767;if(x>2&&T==S(U-B))for(var O=Math.min(h,x)-1,H=Math.min(32767,U),X=Math.min(258,x);B<=H&&--j&&L!=E;){if(n[U+A]==n[U+A-B]){for(var et=0;et<X&&n[U+et]==n[U+et-B];++et);if(et>A){if(A=et,C=B,et>O)break;for(var V=Math.min(B,et-2),tt=0,k=0;k<V;++k){var $=U-B+k&32767,z=y[$],Z=$-z&32767;Z>tt&&(tt=Z,E=$)}}}L=E,E=y[L],B+=L-E&32767}if(C){N[q++]=268435456|tb[A]<<18|hx[C];var it=tb[A]&31,mt=hx[C]&31;P+=n2[it]+r2[mt],++D[257+it],++F[mt],R=U+A,++G}else N[q++]=n[U],++D[n[U]]}}for(U=Math.max(U,R);U<a;++U)N[q++]=n[U],++D[n[U]];c=px(n,l,i,N,D,F,P,q,I,U-I,c),i||(s.r=c&7|l[c/8|0]<<3,c-=7,s.h=b,s.p=y,s.i=U,s.w=R)}else{for(var U=s.w||0;U<a+i;U+=65535){var lt=U+65535;lt>=a&&(l[c/8|0]=i,lt=a),c=M8(l,c+1,n.subarray(U,lt))}s.i=a}return vF(u,0,r+j8(c)+o)},O8=function(){var n=1,e=0;return{p:function(t){for(var r=n,o=e,s=t.length|0,a=0;a!=s;){for(var u=Math.min(a+2655,s);a<u;++a)o+=r+=t[a];r=(r&65535)+15*(r>>16),o=(o&65535)+15*(o>>16)}n=r,e=o},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},SF=function(n,e,t,r,o){if(!o&&(o={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new _o(s.length+n.length);a.set(s),a.set(n,s.length),n=a,o.w=s.length}return xF(n,e.level==null?6:e.level,e.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,r,o)},R8=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},_F=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var o=O8();o.p(e.dictionary),R8(n,2,o.d())}};function rb(n,e){e||(e={});var t=O8();t.p(n);var r=SF(n,e,e.dictionary?6:2,4);return _F(r,e),R8(r,r.length-4,t.d()),r}var kF=typeof TextDecoder<"u"&&new TextDecoder,AF=0;try{kF.decode(L8,{stream:!0}),AF=1}catch{}function CF(n){if(Array.isArray(n))return n}function EF(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,o,s,a,u=[],l=!0,i=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(r=s.call(t)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(c){i=!0,o=c}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(i)throw o}}return u}}function mx(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function NF(n,e){if(n){if(typeof n=="string")return mx(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?mx(n,e):void 0}}function TF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gx(n,e){return CF(n)||EF(n,e)||NF(n,e)||TF()}function bx(n,e="utf8"){return new TextDecoder(e).decode(n)}const jF=new TextEncoder;function MF(n){return jF.encode(n)}const LF=1024*8,OF=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),q1={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class i2{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=LF,t={}){let r=!1;typeof e=="number"?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const o=t.offset?t.offset>>>0:0,s=e.byteLength-o;let a=o;(ArrayBuffer.isView(e)||e instanceof i2)&&(e.byteLength!==e.buffer.byteLength&&(a=e.byteOffset+o),e=e.buffer),r?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const r=(this.offset+e)*2,o=new Uint8Array(r);o.set(new Uint8Array(this.buffer)),this.buffer=o.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const r=q1[t].BYTES_PER_ELEMENT*e,o=this.byteOffset+this.offset,s=this.buffer.slice(o,o+r);if(this.littleEndian===OF&&t!=="uint8"&&t!=="int8"){const u=new Uint8Array(this.buffer.slice(o,o+r));u.reverse();const l=new q1[t](u.buffer);return this.offset+=r,l.reverse(),l}const a=new q1[t](s);return this.offset+=r,a}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(e=1){return bx(this.readBytes(e))}decodeText(e=1,t="utf8"){return bx(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(MF(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Rf(n){let e=n.length;for(;--e>=0;)n[e]=0}const RF=3,IF=258,I8=29,DF=256,BF=DF+1+I8,D8=30,PF=512,FF=new Array((BF+2)*2);Rf(FF);const zF=new Array(D8*2);Rf(zF);const qF=new Array(PF);Rf(qF);const UF=new Array(IF-RF+1);Rf(UF);const HF=new Array(I8);Rf(HF);const $F=new Array(D8);Rf($F);const VF=(n,e,t,r)=>{let o=n&65535|0,s=n>>>16&65535|0,a=0;for(;t!==0;){a=t>2e3?2e3:t,t-=a;do o=o+e[r++]|0,s=s+o|0;while(--a);o%=65521,s%=65521}return o|s<<16|0};var ib=VF;const WF=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},GF=new Uint32Array(WF()),YF=(n,e,t,r)=>{const o=GF,s=r+t;n^=-1;for(let a=r;a<s;a++)n=n>>>8^o[(n^e[a])&255];return n^-1};var Wo=YF,sb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},B8={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const XF=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var KF=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const r in t)XF(t,r)&&(n[r]=t[r])}}return n},ZF=n=>{let e=0;for(let r=0,o=n.length;r<o;r++)e+=n[r].length;const t=new Uint8Array(e);for(let r=0,o=0,s=n.length;r<s;r++){let a=n[r];t.set(a,o),o+=a.length}return t},P8={assign:KF,flattenChunks:ZF};let F8=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{F8=!1}const Jh=new Uint8Array(256);for(let n=0;n<256;n++)Jh[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Jh[254]=Jh[254]=1;var QF=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,r,o,s,a=n.length,u=0;for(o=0;o<a;o++)t=n.charCodeAt(o),(t&64512)===55296&&o+1<a&&(r=n.charCodeAt(o+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),o++)),u+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(u),s=0,o=0;s<u;o++)t=n.charCodeAt(o),(t&64512)===55296&&o+1<a&&(r=n.charCodeAt(o+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),o++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const JF=(n,e)=>{if(e<65534&&n.subarray&&F8)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(n[r]);return t};var tz=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let r,o;const s=new Array(t*2);for(o=0,r=0;r<t;){let a=n[r++];if(a<128){s[o++]=a;continue}let u=Jh[a];if(u>4){s[o++]=65533,r+=u-1;continue}for(a&=u===2?31:u===3?15:7;u>1&&r<t;)a=a<<6|n[r++]&63,u--;if(u>1){s[o++]=65533;continue}a<65536?s[o++]=a:(a-=65536,s[o++]=55296|a>>10&1023,s[o++]=56320|a&1023)}return JF(s,o)},ez=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+Jh[n[t]]>e?t:e},ab={string2buf:QF,buf2string:tz,utf8border:ez};function nz(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var rz=nz;const Ap=16209,iz=16191;var sz=function(e,t){let r,o,s,a,u,l,i,c,p,h,f,g,y,b,v,w,S,N,D,F,G,P,U,q;const R=e.state;r=e.next_in,U=e.input,o=r+(e.avail_in-5),s=e.next_out,q=e.output,a=s-(t-e.avail_out),u=s+(e.avail_out-257),l=R.dmax,i=R.wsize,c=R.whave,p=R.wnext,h=R.window,f=R.hold,g=R.bits,y=R.lencode,b=R.distcode,v=(1<<R.lenbits)-1,w=(1<<R.distbits)-1;t:do{g<15&&(f+=U[r++]<<g,g+=8,f+=U[r++]<<g,g+=8),S=y[f&v];e:for(;;){if(N=S>>>24,f>>>=N,g-=N,N=S>>>16&255,N===0)q[s++]=S&65535;else if(N&16){D=S&65535,N&=15,N&&(g<N&&(f+=U[r++]<<g,g+=8),D+=f&(1<<N)-1,f>>>=N,g-=N),g<15&&(f+=U[r++]<<g,g+=8,f+=U[r++]<<g,g+=8),S=b[f&w];n:for(;;){if(N=S>>>24,f>>>=N,g-=N,N=S>>>16&255,N&16){if(F=S&65535,N&=15,g<N&&(f+=U[r++]<<g,g+=8,g<N&&(f+=U[r++]<<g,g+=8)),F+=f&(1<<N)-1,F>l){e.msg="invalid distance too far back",R.mode=Ap;break t}if(f>>>=N,g-=N,N=s-a,F>N){if(N=F-N,N>c&&R.sane){e.msg="invalid distance too far back",R.mode=Ap;break t}if(G=0,P=h,p===0){if(G+=i-N,N<D){D-=N;do q[s++]=h[G++];while(--N);G=s-F,P=q}}else if(p<N){if(G+=i+p-N,N-=p,N<D){D-=N;do q[s++]=h[G++];while(--N);if(G=0,p<D){N=p,D-=N;do q[s++]=h[G++];while(--N);G=s-F,P=q}}}else if(G+=p-N,N<D){D-=N;do q[s++]=h[G++];while(--N);G=s-F,P=q}for(;D>2;)q[s++]=P[G++],q[s++]=P[G++],q[s++]=P[G++],D-=3;D&&(q[s++]=P[G++],D>1&&(q[s++]=P[G++]))}else{G=s-F;do q[s++]=q[G++],q[s++]=q[G++],q[s++]=q[G++],D-=3;while(D>2);D&&(q[s++]=q[G++],D>1&&(q[s++]=q[G++]))}}else if((N&64)===0){S=b[(S&65535)+(f&(1<<N)-1)];continue n}else{e.msg="invalid distance code",R.mode=Ap;break t}break}}else if((N&64)===0){S=y[(S&65535)+(f&(1<<N)-1)];continue e}else if(N&32){R.mode=iz;break t}else{e.msg="invalid literal/length code",R.mode=Ap;break t}break}}while(r<o&&s<u);D=g>>3,r-=D,g-=D<<3,f&=(1<<g)-1,e.next_in=r,e.next_out=s,e.avail_in=r<o?5+(o-r):5-(r-o),e.avail_out=s<u?257+(u-s):257-(s-u),R.hold=f,R.bits=g};const nf=15,yx=852,vx=592,wx=0,U1=1,xx=2,az=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),oz=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),lz=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),uz=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),cz=(n,e,t,r,o,s,a,u)=>{const l=u.bits;let i=0,c=0,p=0,h=0,f=0,g=0,y=0,b=0,v=0,w=0,S,N,D,F,G,P=null,U;const q=new Uint16Array(nf+1),R=new Uint16Array(nf+1);let I=null,T,L,E;for(i=0;i<=nf;i++)q[i]=0;for(c=0;c<r;c++)q[e[t+c]]++;for(f=l,h=nf;h>=1&&q[h]===0;h--);if(f>h&&(f=h),h===0)return o[s++]=1<<24|64<<16|0,o[s++]=1<<24|64<<16|0,u.bits=1,0;for(p=1;p<h&&q[p]===0;p++);for(f<p&&(f=p),b=1,i=1;i<=nf;i++)if(b<<=1,b-=q[i],b<0)return-1;if(b>0&&(n===wx||h!==1))return-1;for(R[1]=0,i=1;i<nf;i++)R[i+1]=R[i]+q[i];for(c=0;c<r;c++)e[t+c]!==0&&(a[R[e[t+c]]++]=c);if(n===wx?(P=I=a,U=20):n===U1?(P=az,I=oz,U=257):(P=lz,I=uz,U=0),w=0,c=0,i=p,G=s,g=f,y=0,D=-1,v=1<<f,F=v-1,n===U1&&v>yx||n===xx&&v>vx)return 1;for(;;){T=i-y,a[c]+1<U?(L=0,E=a[c]):a[c]>=U?(L=I[a[c]-U],E=P[a[c]-U]):(L=96,E=0),S=1<<i-y,N=1<<g,p=N;do N-=S,o[G+(w>>y)+N]=T<<24|L<<16|E|0;while(N!==0);for(S=1<<i-1;w&S;)S>>=1;if(S!==0?(w&=S-1,w+=S):w=0,c++,--q[i]===0){if(i===h)break;i=e[t+a[c]]}if(i>f&&(w&F)!==D){for(y===0&&(y=f),G+=p,g=i-y,b=1<<g;g+y<h&&(b-=q[g+y],!(b<=0));)g++,b<<=1;if(v+=1<<g,n===U1&&v>yx||n===xx&&v>vx)return 1;D=w&F,o[D]=f<<24|g<<16|G-s|0}}return w!==0&&(o[G+w]=i-y<<24|64<<16|0),u.bits=f,0};var Fh=cz;const fz=0,z8=1,q8=2,{Z_FINISH:Sx,Z_BLOCK:hz,Z_TREES:Cp,Z_OK:uc,Z_STREAM_END:dz,Z_NEED_DICT:pz,Z_STREAM_ERROR:Xa,Z_DATA_ERROR:U8,Z_MEM_ERROR:H8,Z_BUF_ERROR:mz,Z_DEFLATED:_x}=B8,A0=16180,kx=16181,Ax=16182,Cx=16183,Ex=16184,Nx=16185,Tx=16186,jx=16187,Mx=16188,Lx=16189,n0=16190,Cl=16191,H1=16192,Ox=16193,$1=16194,Rx=16195,Ix=16196,Dx=16197,Bx=16198,Ep=16199,Np=16200,Px=16201,Fx=16202,zx=16203,qx=16204,Ux=16205,V1=16206,Hx=16207,$x=16208,Ei=16209,$8=16210,V8=16211,gz=852,bz=592,yz=15,vz=yz,Vx=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function wz(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const yc=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<A0||e.mode>V8?1:0},W8=n=>{if(yc(n))return Xa;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=A0,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(gz),e.distcode=e.distdyn=new Int32Array(bz),e.sane=1,e.back=-1,uc},G8=n=>{if(yc(n))return Xa;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,W8(n)},Y8=(n,e)=>{let t;if(yc(n))return Xa;const r=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Xa:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=t,r.wbits=e,G8(n))},X8=(n,e)=>{if(!n)return Xa;const t=new wz;n.state=t,t.strm=n,t.window=null,t.mode=A0;const r=Y8(n,e);return r!==uc&&(n.state=null),r},xz=n=>X8(n,vz);let Wx=!0,W1,G1;const Sz=n=>{if(Wx){W1=new Int32Array(512),G1=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(Fh(z8,n.lens,0,288,W1,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;Fh(q8,n.lens,0,32,G1,0,n.work,{bits:5}),Wx=!1}n.lencode=W1,n.lenbits=9,n.distcode=G1,n.distbits=5},K8=(n,e,t,r)=>{let o;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(o=s.wsize-s.wnext,o>r&&(o=r),s.window.set(e.subarray(t-r,t-r+o),s.wnext),r-=o,r?(s.window.set(e.subarray(t-r,t),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0},_z=(n,e)=>{let t,r,o,s,a,u,l,i,c,p,h,f,g,y,b=0,v,w,S,N,D,F,G,P;const U=new Uint8Array(4);let q,R;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(yc(n)||!n.output||!n.input&&n.avail_in!==0)return Xa;t=n.state,t.mode===Cl&&(t.mode=H1),a=n.next_out,o=n.output,l=n.avail_out,s=n.next_in,r=n.input,u=n.avail_in,i=t.hold,c=t.bits,p=u,h=l,P=uc;t:for(;;)switch(t.mode){case A0:if(t.wrap===0){t.mode=H1;break}for(;c<16;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if(t.wrap&2&&i===35615){t.wbits===0&&(t.wbits=15),t.check=0,U[0]=i&255,U[1]=i>>>8&255,t.check=Wo(t.check,U,2,0),i=0,c=0,t.mode=kx;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((i&255)<<8)+(i>>8))%31){n.msg="incorrect header check",t.mode=Ei;break}if((i&15)!==_x){n.msg="unknown compression method",t.mode=Ei;break}if(i>>>=4,c-=4,G=(i&15)+8,t.wbits===0&&(t.wbits=G),G>15||G>t.wbits){n.msg="invalid window size",t.mode=Ei;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=i&512?Lx:Cl,i=0,c=0;break;case kx:for(;c<16;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if(t.flags=i,(t.flags&255)!==_x){n.msg="unknown compression method",t.mode=Ei;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Ei;break}t.head&&(t.head.text=i>>8&1),t.flags&512&&t.wrap&4&&(U[0]=i&255,U[1]=i>>>8&255,t.check=Wo(t.check,U,2,0)),i=0,c=0,t.mode=Ax;case Ax:for(;c<32;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}t.head&&(t.head.time=i),t.flags&512&&t.wrap&4&&(U[0]=i&255,U[1]=i>>>8&255,U[2]=i>>>16&255,U[3]=i>>>24&255,t.check=Wo(t.check,U,4,0)),i=0,c=0,t.mode=Cx;case Cx:for(;c<16;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}t.head&&(t.head.xflags=i&255,t.head.os=i>>8),t.flags&512&&t.wrap&4&&(U[0]=i&255,U[1]=i>>>8&255,t.check=Wo(t.check,U,2,0)),i=0,c=0,t.mode=Ex;case Ex:if(t.flags&1024){for(;c<16;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}t.length=i,t.head&&(t.head.extra_len=i),t.flags&512&&t.wrap&4&&(U[0]=i&255,U[1]=i>>>8&255,t.check=Wo(t.check,U,2,0)),i=0,c=0}else t.head&&(t.head.extra=null);t.mode=Nx;case Nx:if(t.flags&1024&&(f=t.length,f>u&&(f=u),f&&(t.head&&(G=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(s,s+f),G)),t.flags&512&&t.wrap&4&&(t.check=Wo(t.check,r,f,s)),u-=f,s+=f,t.length-=f),t.length))break t;t.length=0,t.mode=Tx;case Tx:if(t.flags&2048){if(u===0)break t;f=0;do G=r[s+f++],t.head&&G&&t.length<65536&&(t.head.name+=String.fromCharCode(G));while(G&&f<u);if(t.flags&512&&t.wrap&4&&(t.check=Wo(t.check,r,f,s)),u-=f,s+=f,G)break t}else t.head&&(t.head.name=null);t.length=0,t.mode=jx;case jx:if(t.flags&4096){if(u===0)break t;f=0;do G=r[s+f++],t.head&&G&&t.length<65536&&(t.head.comment+=String.fromCharCode(G));while(G&&f<u);if(t.flags&512&&t.wrap&4&&(t.check=Wo(t.check,r,f,s)),u-=f,s+=f,G)break t}else t.head&&(t.head.comment=null);t.mode=Mx;case Mx:if(t.flags&512){for(;c<16;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if(t.wrap&4&&i!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Ei;break}i=0,c=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Cl;break;case Lx:for(;c<32;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}n.adler=t.check=Vx(i),i=0,c=0,t.mode=n0;case n0:if(t.havedict===0)return n.next_out=a,n.avail_out=l,n.next_in=s,n.avail_in=u,t.hold=i,t.bits=c,pz;n.adler=t.check=1,t.mode=Cl;case Cl:if(e===hz||e===Cp)break t;case H1:if(t.last){i>>>=c&7,c-=c&7,t.mode=V1;break}for(;c<3;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}switch(t.last=i&1,i>>>=1,c-=1,i&3){case 0:t.mode=Ox;break;case 1:if(Sz(t),t.mode=Ep,e===Cp){i>>>=2,c-=2;break t}break;case 2:t.mode=Ix;break;case 3:n.msg="invalid block type",t.mode=Ei}i>>>=2,c-=2;break;case Ox:for(i>>>=c&7,c-=c&7;c<32;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if((i&65535)!==(i>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Ei;break}if(t.length=i&65535,i=0,c=0,t.mode=$1,e===Cp)break t;case $1:t.mode=Rx;case Rx:if(f=t.length,f){if(f>u&&(f=u),f>l&&(f=l),f===0)break t;o.set(r.subarray(s,s+f),a),u-=f,s+=f,l-=f,a+=f,t.length-=f;break}t.mode=Cl;break;case Ix:for(;c<14;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if(t.nlen=(i&31)+257,i>>>=5,c-=5,t.ndist=(i&31)+1,i>>>=5,c-=5,t.ncode=(i&15)+4,i>>>=4,c-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Ei;break}t.have=0,t.mode=Dx;case Dx:for(;t.have<t.ncode;){for(;c<3;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}t.lens[I[t.have++]]=i&7,i>>>=3,c-=3}for(;t.have<19;)t.lens[I[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,q={bits:t.lenbits},P=Fh(fz,t.lens,0,19,t.lencode,0,t.work,q),t.lenbits=q.bits,P){n.msg="invalid code lengths set",t.mode=Ei;break}t.have=0,t.mode=Bx;case Bx:for(;t.have<t.nlen+t.ndist;){for(;b=t.lencode[i&(1<<t.lenbits)-1],v=b>>>24,w=b>>>16&255,S=b&65535,!(v<=c);){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if(S<16)i>>>=v,c-=v,t.lens[t.have++]=S;else{if(S===16){for(R=v+2;c<R;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if(i>>>=v,c-=v,t.have===0){n.msg="invalid bit length repeat",t.mode=Ei;break}G=t.lens[t.have-1],f=3+(i&3),i>>>=2,c-=2}else if(S===17){for(R=v+3;c<R;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}i>>>=v,c-=v,G=0,f=3+(i&7),i>>>=3,c-=3}else{for(R=v+7;c<R;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}i>>>=v,c-=v,G=0,f=11+(i&127),i>>>=7,c-=7}if(t.have+f>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Ei;break}for(;f--;)t.lens[t.have++]=G}}if(t.mode===Ei)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Ei;break}if(t.lenbits=9,q={bits:t.lenbits},P=Fh(z8,t.lens,0,t.nlen,t.lencode,0,t.work,q),t.lenbits=q.bits,P){n.msg="invalid literal/lengths set",t.mode=Ei;break}if(t.distbits=6,t.distcode=t.distdyn,q={bits:t.distbits},P=Fh(q8,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,q),t.distbits=q.bits,P){n.msg="invalid distances set",t.mode=Ei;break}if(t.mode=Ep,e===Cp)break t;case Ep:t.mode=Np;case Np:if(u>=6&&l>=258){n.next_out=a,n.avail_out=l,n.next_in=s,n.avail_in=u,t.hold=i,t.bits=c,sz(n,h),a=n.next_out,o=n.output,l=n.avail_out,s=n.next_in,r=n.input,u=n.avail_in,i=t.hold,c=t.bits,t.mode===Cl&&(t.back=-1);break}for(t.back=0;b=t.lencode[i&(1<<t.lenbits)-1],v=b>>>24,w=b>>>16&255,S=b&65535,!(v<=c);){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if(w&&(w&240)===0){for(N=v,D=w,F=S;b=t.lencode[F+((i&(1<<N+D)-1)>>N)],v=b>>>24,w=b>>>16&255,S=b&65535,!(N+v<=c);){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}i>>>=N,c-=N,t.back+=N}if(i>>>=v,c-=v,t.back+=v,t.length=S,w===0){t.mode=Ux;break}if(w&32){t.back=-1,t.mode=Cl;break}if(w&64){n.msg="invalid literal/length code",t.mode=Ei;break}t.extra=w&15,t.mode=Px;case Px:if(t.extra){for(R=t.extra;c<R;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}t.length+=i&(1<<t.extra)-1,i>>>=t.extra,c-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Fx;case Fx:for(;b=t.distcode[i&(1<<t.distbits)-1],v=b>>>24,w=b>>>16&255,S=b&65535,!(v<=c);){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if((w&240)===0){for(N=v,D=w,F=S;b=t.distcode[F+((i&(1<<N+D)-1)>>N)],v=b>>>24,w=b>>>16&255,S=b&65535,!(N+v<=c);){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}i>>>=N,c-=N,t.back+=N}if(i>>>=v,c-=v,t.back+=v,w&64){n.msg="invalid distance code",t.mode=Ei;break}t.offset=S,t.extra=w&15,t.mode=zx;case zx:if(t.extra){for(R=t.extra;c<R;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}t.offset+=i&(1<<t.extra)-1,i>>>=t.extra,c-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Ei;break}t.mode=qx;case qx:if(l===0)break t;if(f=h-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Ei;break}f>t.wnext?(f-=t.wnext,g=t.wsize-f):g=t.wnext-f,f>t.length&&(f=t.length),y=t.window}else y=o,g=a-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do o[a++]=y[g++];while(--f);t.length===0&&(t.mode=Np);break;case Ux:if(l===0)break t;o[a++]=t.length,l--,t.mode=Np;break;case V1:if(t.wrap){for(;c<32;){if(u===0)break t;u--,i|=r[s++]<<c,c+=8}if(h-=l,n.total_out+=h,t.total+=h,t.wrap&4&&h&&(n.adler=t.check=t.flags?Wo(t.check,o,h,a-h):ib(t.check,o,h,a-h)),h=l,t.wrap&4&&(t.flags?i:Vx(i))!==t.check){n.msg="incorrect data check",t.mode=Ei;break}i=0,c=0}t.mode=Hx;case Hx:if(t.wrap&&t.flags){for(;c<32;){if(u===0)break t;u--,i+=r[s++]<<c,c+=8}if(t.wrap&4&&i!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Ei;break}i=0,c=0}t.mode=$x;case $x:P=dz;break t;case Ei:P=U8;break t;case $8:return H8;case V8:default:return Xa}return n.next_out=a,n.avail_out=l,n.next_in=s,n.avail_in=u,t.hold=i,t.bits=c,(t.wsize||h!==n.avail_out&&t.mode<Ei&&(t.mode<V1||e!==Sx))&&K8(n,n.output,n.next_out,h-n.avail_out),p-=n.avail_in,h-=n.avail_out,n.total_in+=p,n.total_out+=h,t.total+=h,t.wrap&4&&h&&(n.adler=t.check=t.flags?Wo(t.check,o,h,n.next_out-h):ib(t.check,o,h,n.next_out-h)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Cl?128:0)+(t.mode===Ep||t.mode===$1?256:0),(p===0&&h===0||e===Sx)&&P===uc&&(P=mz),P},kz=n=>{if(yc(n))return Xa;let e=n.state;return e.window&&(e.window=null),n.state=null,uc},Az=(n,e)=>{if(yc(n))return Xa;const t=n.state;return(t.wrap&2)===0?Xa:(t.head=e,e.done=!1,uc)},Cz=(n,e)=>{const t=e.length;let r,o,s;return yc(n)||(r=n.state,r.wrap!==0&&r.mode!==n0)?Xa:r.mode===n0&&(o=1,o=ib(o,e,t,0),o!==r.check)?U8:(s=K8(n,e,t,t),s?(r.mode=$8,H8):(r.havedict=1,uc))};var Ez=G8,Nz=Y8,Tz=W8,jz=xz,Mz=X8,Lz=_z,Oz=kz,Rz=Az,Iz=Cz,Dz="pako inflate (from Nodeca project)",Nl={inflateReset:Ez,inflateReset2:Nz,inflateResetKeep:Tz,inflateInit:jz,inflateInit2:Mz,inflate:Lz,inflateEnd:Oz,inflateGetHeader:Rz,inflateSetDictionary:Iz,inflateInfo:Dz};function Bz(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Pz=Bz;const Z8=Object.prototype.toString,{Z_NO_FLUSH:Fz,Z_FINISH:zz,Z_OK:td,Z_STREAM_END:Y1,Z_NEED_DICT:X1,Z_STREAM_ERROR:qz,Z_DATA_ERROR:Gx,Z_MEM_ERROR:Uz}=B8;function hd(n){this.options=P8.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new rz,this.strm.avail_out=0;let t=Nl.inflateInit2(this.strm,e.windowBits);if(t!==td)throw new Error(sb[t]);if(this.header=new Pz,Nl.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=ab.string2buf(e.dictionary):Z8.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Nl.inflateSetDictionary(this.strm,e.dictionary),t!==td)))throw new Error(sb[t])}hd.prototype.push=function(n,e){const t=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let s,a,u;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?zz:Fz,Z8.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),s=Nl.inflate(t,a),s===X1&&o&&(s=Nl.inflateSetDictionary(t,o),s===td?s=Nl.inflate(t,a):s===Gx&&(s=X1));t.avail_in>0&&s===Y1&&t.state.wrap>0&&n[t.next_in]!==0;)Nl.inflateReset(t),s=Nl.inflate(t,a);switch(s){case qz:case Gx:case X1:case Uz:return this.onEnd(s),this.ended=!0,!1}if(u=t.avail_out,t.next_out&&(t.avail_out===0||s===Y1))if(this.options.to==="string"){let l=ab.utf8border(t.output,t.next_out),i=t.next_out-l,c=ab.buf2string(t.output,l);t.next_out=i,t.avail_out=r-i,i&&t.output.set(t.output.subarray(l,l+i),0),this.onData(c)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===td&&u===0)){if(s===Y1)return s=Nl.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};hd.prototype.onData=function(n){this.chunks.push(n)};hd.prototype.onEnd=function(n){n===td&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=P8.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Hz(n,e){const t=new hd(e);if(t.push(n),t.err)throw t.msg||sb[t.err];return t.result}var $z=hd,Vz=Hz,Wz={Inflate:$z,inflate:Vz};const{Inflate:Gz,inflate:Yz}=Wz;var Yx=Gz,Xz=Yz;const Q8=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;Q8[n]=e}const Xx=4294967295;function Kz(n,e,t){let r=n;for(let o=0;o<t;o++)r=Q8[(r^e[o])&255]^r>>>8;return r}function Zz(n,e){return(Kz(Xx,n,e)^Xx)>>>0}function Kx(n,e,t){const r=n.readUint32(),o=Zz(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(o!==r)throw new Error(`CRC mismatch for chunk ${t}. Expected ${r}, found ${o}`)}function J8(n,e,t){for(let r=0;r<t;r++)e[r]=n[r]}function tS(n,e,t,r){let o=0;for(;o<r;o++)e[o]=n[o];for(;o<t;o++)e[o]=n[o]+e[o-r]&255}function eS(n,e,t,r){let o=0;if(t.length===0)for(;o<r;o++)e[o]=n[o];else for(;o<r;o++)e[o]=n[o]+t[o]&255}function nS(n,e,t,r,o){let s=0;if(t.length===0){for(;s<o;s++)e[s]=n[s];for(;s<r;s++)e[s]=n[s]+(e[s-o]>>1)&255}else{for(;s<o;s++)e[s]=n[s]+(t[s]>>1)&255;for(;s<r;s++)e[s]=n[s]+(e[s-o]+t[s]>>1)&255}}function rS(n,e,t,r,o){let s=0;if(t.length===0){for(;s<o;s++)e[s]=n[s];for(;s<r;s++)e[s]=n[s]+e[s-o]&255}else{for(;s<o;s++)e[s]=n[s]+t[s]&255;for(;s<r;s++)e[s]=n[s]+Qz(e[s-o],t[s],t[s-o])&255}}function Qz(n,e,t){const r=n+e-t,o=Math.abs(r-n),s=Math.abs(r-e),a=Math.abs(r-t);return o<=s&&o<=a?n:s<=a?e:t}function Jz(n,e,t,r,o,s){switch(n){case 0:J8(e,t,o);break;case 1:tS(e,t,o,s);break;case 2:eS(e,t,r,o);break;case 3:nS(e,t,r,o,s);break;case 4:rS(e,t,r,o,s);break;default:throw new Error(`Unsupported filter: ${n}`)}}const tq=new Uint16Array([255]),eq=new Uint8Array(tq.buffer),nq=eq[0]===255;function rq(n){const{data:e,width:t,height:r,channels:o,depth:s}=n,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],u=Math.ceil(s/8)*o,l=new Uint8Array(r*t*u);let i=0;for(let c=0;c<7;c++){const p=a[c],h=Math.ceil((t-p.x)/p.xStep),f=Math.ceil((r-p.y)/p.yStep);if(h<=0||f<=0)continue;const g=h*u,y=new Uint8Array(g);for(let b=0;b<f;b++){const v=e[i++],w=e.subarray(i,i+g);i+=g;const S=new Uint8Array(g);Jz(v,w,S,y,g,u),y.set(S);for(let N=0;N<h;N++){const D=p.x+N*p.xStep,F=p.y+b*p.yStep;if(!(D>=t||F>=r))for(let G=0;G<u;G++)l[(F*t+D)*u+G]=S[N*u+G]}}}if(s===16){const c=new Uint16Array(l.buffer);if(nq)for(let p=0;p<c.length;p++)c[p]=iq(c[p]);return c}else return l}function iq(n){return(n&255)<<8|n>>8&255}const sq=new Uint16Array([255]),aq=new Uint8Array(sq.buffer),oq=aq[0]===255,lq=new Uint8Array(0);function Zx(n){const{data:e,width:t,height:r,channels:o,depth:s}=n,a=Math.ceil(s/8)*o,u=Math.ceil(s/8*o*t),l=new Uint8Array(r*u);let i=lq,c=0,p,h;for(let f=0;f<r;f++){switch(p=e.subarray(c+1,c+1+u),h=l.subarray(f*u,(f+1)*u),e[c]){case 0:J8(p,h,u);break;case 1:tS(p,h,u,a);break;case 2:eS(p,h,i,u);break;case 3:nS(p,h,i,u,a);break;case 4:rS(p,h,i,u,a);break;default:throw new Error(`Unsupported filter: ${e[c]}`)}i=h,c+=u+1}if(s===16){const f=new Uint16Array(l.buffer);if(oq)for(let g=0;g<f.length;g++)f[g]=uq(f[g]);return f}else return l}function uq(n){return(n&255)<<8|n>>8&255}const Pp=Uint8Array.of(137,80,78,71,13,10,26,10);function Qx(n){if(!cq(n.readBytes(Pp.length)))throw new Error("wrong PNG signature")}function cq(n){if(n.length<Pp.length)return!1;for(let e=0;e<Pp.length;e++)if(n[e]!==Pp[e])return!1;return!0}const fq="tEXt",hq=0,iS=new TextDecoder("latin1");function dq(n){if(mq(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const pq=/^[\u0000-\u00FF]*$/;function mq(n){if(!pq.test(n))throw new Error("invalid latin1 text")}function gq(n,e,t){const r=sS(e);n[r]=bq(e,t-r.length-1)}function sS(n){for(n.mark();n.readByte()!==hq;);const e=n.offset;n.reset();const t=iS.decode(n.readBytes(e-n.offset-1));return n.skip(1),dq(t),t}function bq(n,e){return iS.decode(n.readBytes(e))}const ka={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},K1={UNKNOWN:-1,DEFLATE:0},Jx={UNKNOWN:-1,ADAPTIVE:0},Z1={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Tp={NONE:0,BACKGROUND:1,PREVIOUS:2},Q1={SOURCE:0,OVER:1};class yq extends i2{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:r=!1}=t;this._checkCrc=r,this._inflator=new Yx,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=K1.UNKNOWN,this._filterMethod=Jx.UNKNOWN,this._interlaceMethod=Z1.UNKNOWN,this._colorType=ka.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Qx(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(Qx(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const r=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case fq:gq(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-r!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?Kx(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const r=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=r+e;break}if(this.offset-r!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?Kx(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=vq(this.readUint8());const t=this.readUint8();this._colorType=t;let r;switch(t){case ka.GREYSCALE:r=1;break;case ka.TRUECOLOUR:r=3;break;case ka.INDEXED_COLOUR:r=1;break;case ka.GREYSCALE_ALPHA:r=2;break;case ka.TRUECOLOUR_ALPHA:r=4;break;case ka.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==K1.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const r=[];this._palette=r;for(let o=0;o<t;o++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,r=this.offset+this.byteOffset;if(r+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case ka.GREYSCALE:case ka.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case ka.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const r=this.readByte();this._palette[t].push(r)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case ka.UNKNOWN:case ka.GREYSCALE_ALPHA:case ka.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=sS(this),r=this.readUint8();if(r!==K1.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const o=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:Xz(o)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),r=this.readByte();this._png.resolution={x:e,y:t,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(e);if(r){if(r.data=Zx({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||r.xOffset===0&&r.yOffset===0&&r.width===this._png.width&&r.height===this._png.height)t.data=r.data;else{const o=this._apng.frames.at(e-1);this.disposeFrame(r,o,t),this.addFrameDataToCanvas(t,r)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,r){switch(e.disposeOp){case Tp.NONE:break;case Tp.BACKGROUND:for(let o=0;o<this._png.height;o++)for(let s=0;s<this._png.width;s++){const a=(o*e.width+s)*this._png.channels;for(let u=0;u<this._png.channels;u++)r.data[a+u]=0}break;case Tp.PREVIOUS:r.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const r=1<<this._png.depth,o=(s,a)=>{const u=((s+t.yOffset)*this._png.width+t.xOffset+a)*this._png.channels,l=(s*t.width+a)*this._png.channels;return{index:u,frameIndex:l}};switch(t.blendOp){case Q1.SOURCE:for(let s=0;s<t.height;s++)for(let a=0;a<t.width;a++){const{index:u,frameIndex:l}=o(s,a);for(let i=0;i<this._png.channels;i++)e.data[u+i]=t.data[l+i]}break;case Q1.OVER:for(let s=0;s<t.height;s++)for(let a=0;a<t.width;a++){const{index:u,frameIndex:l}=o(s,a);for(let i=0;i<this._png.channels;i++){const c=t.data[l+this._png.channels-1]/r,p=i%(this._png.channels-1)===0?1:t.data[l+i],h=Math.floor(c*p+(1-c)*e.data[u+i]);e.data[u+i]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Jx.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Z1.NO_INTERLACE)this._png.data=Zx({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Z1.ADAM7)this._png.data=rq({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Tp.NONE,blendOp:Q1.SOURCE,data:e}),this._inflator=new Yx,this._writingDataChunks=!1}}function vq(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var t3;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(t3||(t3={}));function wq(n,e){return new yq(n,e).decode()}var zn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function J1(){zn.console&&typeof zn.console.log=="function"&&zn.console.log.apply(zn.console,arguments)}var li={log:J1,warn:function(n){zn.console&&(typeof zn.console.warn=="function"?zn.console.warn.apply(zn.console,arguments):J1.call(null,arguments))},error:function(n){zn.console&&(typeof zn.console.error=="function"?zn.console.error.apply(zn.console,arguments):J1(n))}};function tg(n,e,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){Ku(r.response,e,t)},r.onerror=function(){li.error("could not download file")},r.send()}function e3(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function jp(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Ku=zn.saveAs||((typeof window>"u"?"undefined":Yr(window))!=="object"||window!==zn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var r=zn.URL||zn.webkitURL,o=document.createElement("a");e=e||n.name||"download",o.download=e,o.rel="noopener",typeof n=="string"?(o.href=n,o.origin!==location.origin?e3(o.href)?tg(n,e,t):jp(o,o.target="_blank"):jp(o)):(o.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(o.href)},4e4),setTimeout(function(){jp(o)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(e3(n))tg(n,e,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){jp(r)})}else navigator.msSaveOrOpenBlob((function(o,s){return s===void 0?s={autoBom:!1}:Yr(s)!=="object"&&(li.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o})(n,t),e)}:function(n,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return tg(n,e,t);var o=n.type==="application/octet-stream",s=/constructor/i.test(zn.HTMLElement)||zn.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||o&&s)&&(typeof FileReader>"u"?"undefined":Yr(FileReader))==="object"){var u=new FileReader;u.onloadend=function(){var c=u.result;c=a?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=c:location=c,r=null},u.readAsDataURL(n)}else{var l=zn.URL||zn.webkitURL,i=l.createObjectURL(n);r?r.location=i:location.href=i,r=null,setTimeout(function(){l.revokeObjectURL(i)},4e4)}});function aS(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(u){return[parseInt(u[1]),parseInt(u[2]),parseInt(u[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(u){return[parseInt(u[1],16),parseInt(u[2],16),parseInt(u[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(u){return[parseInt(u[1]+u[1],16),parseInt(u[2]+u[2],16),parseInt(u[3]+u[3],16)]}}],r=0;r<t.length;r++){var o=t[r].re,s=t[r].process,a=o.exec(n);a&&(e=s(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var u=this.r.toString(16),l=this.g.toString(16),i=this.b.toString(16);return u.length==1&&(u="0"+u),l.length==1&&(l="0"+l),i.length==1&&(i="0"+i),"#"+u+l+i}}var Fp=zn.atob.bind(zn),n3=zn.btoa.bind(zn);function eg(n,e){var t=n[0],r=n[1],o=n[2],s=n[3];t=Ls(t,r,o,s,e[0],7,-680876936),s=Ls(s,t,r,o,e[1],12,-389564586),o=Ls(o,s,t,r,e[2],17,606105819),r=Ls(r,o,s,t,e[3],22,-1044525330),t=Ls(t,r,o,s,e[4],7,-176418897),s=Ls(s,t,r,o,e[5],12,1200080426),o=Ls(o,s,t,r,e[6],17,-1473231341),r=Ls(r,o,s,t,e[7],22,-45705983),t=Ls(t,r,o,s,e[8],7,1770035416),s=Ls(s,t,r,o,e[9],12,-1958414417),o=Ls(o,s,t,r,e[10],17,-42063),r=Ls(r,o,s,t,e[11],22,-1990404162),t=Ls(t,r,o,s,e[12],7,1804603682),s=Ls(s,t,r,o,e[13],12,-40341101),o=Ls(o,s,t,r,e[14],17,-1502002290),t=Os(t,r=Ls(r,o,s,t,e[15],22,1236535329),o,s,e[1],5,-165796510),s=Os(s,t,r,o,e[6],9,-1069501632),o=Os(o,s,t,r,e[11],14,643717713),r=Os(r,o,s,t,e[0],20,-373897302),t=Os(t,r,o,s,e[5],5,-701558691),s=Os(s,t,r,o,e[10],9,38016083),o=Os(o,s,t,r,e[15],14,-660478335),r=Os(r,o,s,t,e[4],20,-405537848),t=Os(t,r,o,s,e[9],5,568446438),s=Os(s,t,r,o,e[14],9,-1019803690),o=Os(o,s,t,r,e[3],14,-187363961),r=Os(r,o,s,t,e[8],20,1163531501),t=Os(t,r,o,s,e[13],5,-1444681467),s=Os(s,t,r,o,e[2],9,-51403784),o=Os(o,s,t,r,e[7],14,1735328473),t=Rs(t,r=Os(r,o,s,t,e[12],20,-1926607734),o,s,e[5],4,-378558),s=Rs(s,t,r,o,e[8],11,-2022574463),o=Rs(o,s,t,r,e[11],16,1839030562),r=Rs(r,o,s,t,e[14],23,-35309556),t=Rs(t,r,o,s,e[1],4,-1530992060),s=Rs(s,t,r,o,e[4],11,1272893353),o=Rs(o,s,t,r,e[7],16,-155497632),r=Rs(r,o,s,t,e[10],23,-1094730640),t=Rs(t,r,o,s,e[13],4,681279174),s=Rs(s,t,r,o,e[0],11,-358537222),o=Rs(o,s,t,r,e[3],16,-722521979),r=Rs(r,o,s,t,e[6],23,76029189),t=Rs(t,r,o,s,e[9],4,-640364487),s=Rs(s,t,r,o,e[12],11,-421815835),o=Rs(o,s,t,r,e[15],16,530742520),t=Is(t,r=Rs(r,o,s,t,e[2],23,-995338651),o,s,e[0],6,-198630844),s=Is(s,t,r,o,e[7],10,1126891415),o=Is(o,s,t,r,e[14],15,-1416354905),r=Is(r,o,s,t,e[5],21,-57434055),t=Is(t,r,o,s,e[12],6,1700485571),s=Is(s,t,r,o,e[3],10,-1894986606),o=Is(o,s,t,r,e[10],15,-1051523),r=Is(r,o,s,t,e[1],21,-2054922799),t=Is(t,r,o,s,e[8],6,1873313359),s=Is(s,t,r,o,e[15],10,-30611744),o=Is(o,s,t,r,e[6],15,-1560198380),r=Is(r,o,s,t,e[13],21,1309151649),t=Is(t,r,o,s,e[4],6,-145523070),s=Is(s,t,r,o,e[11],10,-1120210379),o=Is(o,s,t,r,e[2],15,718787259),r=Is(r,o,s,t,e[9],21,-343485551),n[0]=Su(t,n[0]),n[1]=Su(r,n[1]),n[2]=Su(o,n[2]),n[3]=Su(s,n[3])}function C0(n,e,t,r,o,s){return e=Su(Su(e,n),Su(r,s)),Su(e<<o|e>>>32-o,t)}function Ls(n,e,t,r,o,s,a){return C0(e&t|~e&r,n,e,o,s,a)}function Os(n,e,t,r,o,s,a){return C0(e&r|t&~r,n,e,o,s,a)}function Rs(n,e,t,r,o,s,a){return C0(e^t^r,n,e,o,s,a)}function Is(n,e,t,r,o,s,a){return C0(t^(e|~r),n,e,o,s,a)}function oS(n){var e,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)eg(r,xq(n.substring(e-64,e)));n=n.substring(e-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)o[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(eg(r,o),e=0;e<16;e++)o[e]=0;return o[14]=8*t,eg(r,o),r}function xq(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var r3="0123456789abcdef".split("");function Sq(n){for(var e="",t=0;t<4;t++)e+=r3[n>>8*t+4&15]+r3[n>>8*t&15];return e}function _q(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function ob(n){return oS(n).map(_q).join("")}var kq=(function(n){for(var e=0;e<n.length;e++)n[e]=Sq(n[e]);return n.join("")})(oS("hello"))!="5d41402abc4b2a76b9719d911017c592";function Su(n,e){if(kq){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}function lb(n,e){var t,r,o,s;if(n!==t){for(var a=(o=n,s=1+(256/n.length|0),new Array(s+1).join(o)),u=[],l=0;l<256;l++)u[l]=l;var i=0;for(l=0;l<256;l++){var c=u[l];i=(i+c+a.charCodeAt(l))%256,u[l]=u[i],u[i]=c}t=n,r=u}else u=r;var p=e.length,h=0,f=0,g="";for(l=0;l<p;l++)f=(f+(c=u[h=(h+1)%256]))%256,u[h]=u[f],u[f]=c,a=u[(u[h]+u[f])%256],g+=String.fromCharCode(e.charCodeAt(l)^a);return g}var i3={print:4,modify:8,copy:16,"annot-forms":32};function pf(n,e,t,r){this.v=1,this.r=2;var o=192;n.forEach(function(u){if(i3.perm!==void 0)throw new Error("Invalid permission: "+u);o+=i3[u]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),a=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^o)),this.encryptionKey=ob(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=lb(this.encryptionKey,this.padding)}function mf(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,r=0;r<t;r++){var o=n.charCodeAt(r);e+=o<33||o===35||o===37||o===40||o===41||o===47||o===60||o===62||o===91||o===93||o===123||o===125||o>126?"#"+("0"+o.toString(16)).slice(-2):n[r]}return e}function s3(n){if(Yr(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,o){if(o=o||!1,typeof t!="string"||typeof r!="function"||typeof o!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[r,!!o],s},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),o=[];for(var s in e[t]){var a=e[t][s];try{a[0].apply(n,r)}catch(u){zn.console&&li.error("jsPDF PubSub Error",u.message,u)}a[1]&&o.push(s)}o.length&&o.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function r0(n){if(!(this instanceof r0))return new r0(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function lS(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function Qu(n,e,t,r,o){if(!(this instanceof Qu))return new Qu(n,e,t,r,o);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,lS.call(this,r,o)}function gf(n,e,t,r,o){if(!(this instanceof gf))return new gf(n,e,t,r,o);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,lS.call(this,r,o)}function xn(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],o=arguments[2],s=arguments[3],a=[],u=1,l=16,i="S",c=null;Yr(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,o=n.format||o,s=n.compress||n.compressPdf||s,(c=n.encryption||null)!==null&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),u=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(l=n.floatPrecision),i=n.defaultPathOperation||"S"),a=n.filters||(s===!0?["FlateEncode"]:a),r=r||"mm",t=(""+(t||"P")).toLowerCase();var p=n.putOnlyUsedFonts||!1,h={},f={internal:{},__private__:{}};f.__private__.PubSub=s3;var g="1.3",y=f.__private__.getPdfVersion=function(){return g};f.__private__.setPdfVersion=function(nt){g=nt};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return b};var v=f.__private__.getPageFormat=function(nt){return b[nt]};o=o||"a4";var w="compat",S="advanced",N=w;function D(){this.saveGraphicsState(),rt(new Te(ne,0,0,-ne,0,qi()*ne).toString()+" cm"),this.setFontSize(this.getFontSize()/ne),i="n",N=S}function F(){this.restoreGraphicsState(),i="S",N=w}var G=f.__private__.combineFontStyleAndFontWeight=function(nt,bt){if(nt=="bold"&&bt=="normal"||nt=="bold"&&bt==400||nt=="normal"&&bt=="italic"||nt=="bold"&&bt=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return bt&&(nt=bt==400||bt==="normal"?nt==="italic"?"italic":"normal":bt!=700&&bt!=="bold"||nt!=="normal"?(bt==700?"bold":bt)+""+nt:"bold"),nt};f.advancedAPI=function(nt){var bt=N===w;return bt&&D.call(this),typeof nt!="function"||(nt(this),bt&&F.call(this)),this},f.compatAPI=function(nt){var bt=N===S;return bt&&F.call(this),typeof nt!="function"||(nt(this),bt&&D.call(this)),this},f.isAdvancedAPI=function(){return N===S};var P,U=function(nt){if(N!==S)throw new Error(nt+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},q=f.roundToPrecision=f.__private__.roundToPrecision=function(nt,bt){var Lt=e||bt;if(isNaN(nt)||isNaN(Lt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return nt.toFixed(Lt).replace(/0+$/,"")};P=f.hpf=f.__private__.hpf=typeof l=="number"?function(nt){if(isNaN(nt))throw new Error("Invalid argument passed to jsPDF.hpf");return q(nt,l)}:l==="smart"?function(nt){if(isNaN(nt))throw new Error("Invalid argument passed to jsPDF.hpf");return q(nt,nt>-1&&nt<1?16:5)}:function(nt){if(isNaN(nt))throw new Error("Invalid argument passed to jsPDF.hpf");return q(nt,16)};var R=f.f2=f.__private__.f2=function(nt){if(isNaN(nt))throw new Error("Invalid argument passed to jsPDF.f2");return q(nt,2)},I=f.__private__.f3=function(nt){if(isNaN(nt))throw new Error("Invalid argument passed to jsPDF.f3");return q(nt,3)},T=f.scale=f.__private__.scale=function(nt){if(isNaN(nt))throw new Error("Invalid argument passed to jsPDF.scale");return N===w?nt*ne:N===S?nt:void 0},L=function(nt){return T((function(bt){return N===w?qi()-bt:N===S?bt:void 0})(nt))};f.__private__.setPrecision=f.setPrecision=function(nt){typeof parseInt(nt,10)=="number"&&(e=parseInt(nt,10))};var E,x="00000000000000000000000000000000",k=f.__private__.getFileId=function(){return x},A=f.__private__.setFileId=function(nt){return x=nt!==void 0&&/^[a-fA-F0-9]{32}$/.test(nt)?nt.toUpperCase():x.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),c!==null&&(yr=new pf(c.userPermissions,c.userPassword,c.ownerPassword,x)),x};f.setFileId=function(nt){return A(nt),this},f.getFileId=function(){return k()};var C=f.__private__.convertDateToPDFDate=function(nt){var bt=nt.getTimezoneOffset(),Lt=bt<0?"+":"-",zt=Math.floor(Math.abs(bt/60)),Yt=Math.abs(bt%60),Se=[Lt,X(zt),"'",X(Yt),"'"].join("");return["D:",nt.getFullYear(),X(nt.getMonth()+1),X(nt.getDate()),X(nt.getHours()),X(nt.getMinutes()),X(nt.getSeconds()),Se].join("")},j=f.__private__.convertPDFDateToDate=function(nt){var bt=parseInt(nt.substr(2,4),10),Lt=parseInt(nt.substr(6,2),10)-1,zt=parseInt(nt.substr(8,2),10),Yt=parseInt(nt.substr(10,2),10),Se=parseInt(nt.substr(12,2),10),Re=parseInt(nt.substr(14,2),10);return new Date(bt,Lt,zt,Yt,Se,Re,0)},B=f.__private__.setCreationDate=function(nt){var bt;if(nt===void 0&&(nt=new Date),nt instanceof Date)bt=C(nt);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(nt))throw new Error("Invalid argument passed to jsPDF.setCreationDate");bt=nt}return E=bt},O=f.__private__.getCreationDate=function(nt){var bt=E;return nt==="jsDate"&&(bt=j(E)),bt};f.setCreationDate=function(nt){return B(nt),this},f.getCreationDate=function(nt){return O(nt)};var H,X=f.__private__.padd2=function(nt){return("0"+parseInt(nt)).slice(-2)},et=f.__private__.padd2Hex=function(nt){return("00"+(nt=nt.toString())).substr(nt.length)},V=0,tt=[],$=[],z=0,Z=[],it=[],mt=!1,lt=$;f.__private__.setCustomOutputDestination=function(nt){mt=!0,lt=nt};var at=function(nt){mt||(lt=nt)};f.__private__.resetCustomOutputDestination=function(){mt=!1,lt=$};var rt=f.__private__.out=function(nt){return nt=nt.toString(),z+=nt.length+1,lt.push(nt),lt},ct=f.__private__.write=function(nt){return rt(arguments.length===1?nt.toString():Array.prototype.join.call(arguments," "))},ot=f.__private__.getArrayBuffer=function(nt){for(var bt=nt.length,Lt=new ArrayBuffer(bt),zt=new Uint8Array(Lt);bt--;)zt[bt]=nt.charCodeAt(bt);return Lt},dt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return dt};var ft=n.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(nt){return ft=N===S?nt/ne:nt,this};var gt,wt=f.__private__.getFontSize=f.getFontSize=function(){return N===w?ft:ft*ne},yt=n.R2L||!1;f.__private__.setR2L=f.setR2L=function(nt){return yt=nt,this},f.__private__.getR2L=f.getR2L=function(){return yt};var Et,Mt=f.__private__.setZoomMode=function(nt){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(nt))gt=nt;else if(isNaN(nt)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(nt)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+nt+'" is not recognized.');gt=nt}else gt=parseInt(nt,10)};f.__private__.getZoomMode=function(){return gt};var qt,Tt=f.__private__.setPageMode=function(nt){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(nt)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+nt+'" is not recognized.');Et=nt};f.__private__.getPageMode=function(){return Et};var It=f.__private__.setLayoutMode=function(nt){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(nt)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+nt+'" is not recognized.');qt=nt};f.__private__.getLayoutMode=function(){return qt},f.__private__.setDisplayMode=f.setDisplayMode=function(nt,bt,Lt){return Mt(nt),It(bt),Tt(Lt),this};var Vt={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(nt){if(Object.keys(Vt).indexOf(nt)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Vt[nt]},f.__private__.getDocumentProperties=function(){return Vt},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(nt){for(var bt in Vt)Vt.hasOwnProperty(bt)&&nt[bt]&&(Vt[bt]=nt[bt]);return this},f.__private__.setDocumentProperty=function(nt,bt){if(Object.keys(Vt).indexOf(nt)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Vt[nt]=bt};var Kt,ne,ae,Oe,le,Jt={},ue={},ge=[],fe={},qe={},Be={},ke={},Je=null,Fe=0,Me=[],Ke=new s3(f),En=n.hotfixes||[],Xe={},Sn={},Nn=[],Te=function nt(bt,Lt,zt,Yt,Se,Re){if(!(this instanceof nt))return new nt(bt,Lt,zt,Yt,Se,Re);isNaN(bt)&&(bt=1),isNaN(Lt)&&(Lt=0),isNaN(zt)&&(zt=0),isNaN(Yt)&&(Yt=1),isNaN(Se)&&(Se=0),isNaN(Re)&&(Re=0),this._matrix=[bt,Lt,zt,Yt,Se,Re]};Object.defineProperty(Te.prototype,"sx",{get:function(){return this._matrix[0]},set:function(nt){this._matrix[0]=nt}}),Object.defineProperty(Te.prototype,"shy",{get:function(){return this._matrix[1]},set:function(nt){this._matrix[1]=nt}}),Object.defineProperty(Te.prototype,"shx",{get:function(){return this._matrix[2]},set:function(nt){this._matrix[2]=nt}}),Object.defineProperty(Te.prototype,"sy",{get:function(){return this._matrix[3]},set:function(nt){this._matrix[3]=nt}}),Object.defineProperty(Te.prototype,"tx",{get:function(){return this._matrix[4]},set:function(nt){this._matrix[4]=nt}}),Object.defineProperty(Te.prototype,"ty",{get:function(){return this._matrix[5]},set:function(nt){this._matrix[5]=nt}}),Object.defineProperty(Te.prototype,"a",{get:function(){return this._matrix[0]},set:function(nt){this._matrix[0]=nt}}),Object.defineProperty(Te.prototype,"b",{get:function(){return this._matrix[1]},set:function(nt){this._matrix[1]=nt}}),Object.defineProperty(Te.prototype,"c",{get:function(){return this._matrix[2]},set:function(nt){this._matrix[2]=nt}}),Object.defineProperty(Te.prototype,"d",{get:function(){return this._matrix[3]},set:function(nt){this._matrix[3]=nt}}),Object.defineProperty(Te.prototype,"e",{get:function(){return this._matrix[4]},set:function(nt){this._matrix[4]=nt}}),Object.defineProperty(Te.prototype,"f",{get:function(){return this._matrix[5]},set:function(nt){this._matrix[5]=nt}}),Object.defineProperty(Te.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Te.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Te.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Te.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Te.prototype.join=function(nt){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(P).join(nt)},Te.prototype.multiply=function(nt){var bt=nt.sx*this.sx+nt.shy*this.shx,Lt=nt.sx*this.shy+nt.shy*this.sy,zt=nt.shx*this.sx+nt.sy*this.shx,Yt=nt.shx*this.shy+nt.sy*this.sy,Se=nt.tx*this.sx+nt.ty*this.shx+this.tx,Re=nt.tx*this.shy+nt.ty*this.sy+this.ty;return new Te(bt,Lt,zt,Yt,Se,Re)},Te.prototype.decompose=function(){var nt=this.sx,bt=this.shy,Lt=this.shx,zt=this.sy,Yt=this.tx,Se=this.ty,Re=Math.sqrt(nt*nt+bt*bt),un=(nt/=Re)*Lt+(bt/=Re)*zt;Lt-=nt*un,zt-=bt*un;var gn=Math.sqrt(Lt*Lt+zt*zt);return un/=gn,nt*(zt/=gn)<bt*(Lt/=gn)&&(nt=-nt,bt=-bt,un=-un,Re=-Re),{scale:new Te(Re,0,0,gn,0,0),translate:new Te(1,0,0,1,Yt,Se),rotate:new Te(nt,bt,-bt,nt,0,0),skew:new Te(1,0,un,1,0,0)}},Te.prototype.toString=function(nt){return this.join(" ")},Te.prototype.inversed=function(){var nt=this.sx,bt=this.shy,Lt=this.shx,zt=this.sy,Yt=this.tx,Se=this.ty,Re=1/(nt*zt-bt*Lt),un=zt*Re,gn=-bt*Re,Dn=-Lt*Re,$n=nt*Re;return new Te(un,gn,Dn,$n,-un*Yt-Dn*Se,-gn*Yt-$n*Se)},Te.prototype.applyToPoint=function(nt){var bt=nt.x*this.sx+nt.y*this.shx+this.tx,Lt=nt.x*this.shy+nt.y*this.sy+this.ty;return new en(bt,Lt)},Te.prototype.applyToRectangle=function(nt){var bt=this.applyToPoint(nt),Lt=this.applyToPoint(new en(nt.x+nt.w,nt.y+nt.h));return new Hn(bt.x,bt.y,Lt.x-bt.x,Lt.y-bt.y)},Te.prototype.clone=function(){var nt=this.sx,bt=this.shy,Lt=this.shx,zt=this.sy,Yt=this.tx,Se=this.ty;return new Te(nt,bt,Lt,zt,Yt,Se)},f.Matrix=Te;var _n=f.matrixMult=function(nt,bt){return bt.multiply(nt)},Pn=new Te(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Pn;var on=function(nt,bt){if(!qe[nt]){var Lt=(bt instanceof Qu?"Sh":"P")+(Object.keys(fe).length+1).toString(10);bt.id=Lt,qe[nt]=Lt,fe[Lt]=bt,Ke.publish("addPattern",bt)}};f.ShadingPattern=Qu,f.TilingPattern=gf,f.addShadingPattern=function(nt,bt){return U("addShadingPattern()"),on(nt,bt),this},f.beginTilingPattern=function(nt){U("beginTilingPattern()"),qr(nt.boundingBox[0],nt.boundingBox[1],nt.boundingBox[2]-nt.boundingBox[0],nt.boundingBox[3]-nt.boundingBox[1],nt.matrix)},f.endTilingPattern=function(nt,bt){U("endTilingPattern()"),bt.stream=it[H].join(`
`),on(nt,bt),Ke.publish("endTilingPattern",bt),Nn.pop().restore()};var Dt,Ht=f.__private__.newObject=function(){var nt=re();return we(nt,!0),nt},re=f.__private__.newObjectDeferred=function(){return V++,tt[V]=function(){return z},V},we=function(nt,bt){return bt=typeof bt=="boolean"&&bt,tt[nt]=z,bt&&rt(nt+" 0 obj"),nt},nn=f.__private__.newAdditionalObject=function(){var nt={objId:re(),content:""};return Z.push(nt),nt},Ie=re(),Ue=re(),He=f.__private__.decodeColorString=function(nt){var bt=nt.split(" ");if(bt.length!==2||bt[1]!=="g"&&bt[1]!=="G")bt.length!==5||bt[4]!=="k"&&bt[4]!=="K"||(bt=[(1-bt[0])*(1-bt[3]),(1-bt[1])*(1-bt[3]),(1-bt[2])*(1-bt[3]),"r"]);else{var Lt=parseFloat(bt[0]);bt=[Lt,Lt,Lt,"r"]}for(var zt="#",Yt=0;Yt<3;Yt++)zt+=("0"+Math.floor(255*parseFloat(bt[Yt])).toString(16)).slice(-2);return zt},Ge=f.__private__.encodeColorString=function(nt){var bt;typeof nt=="string"&&(nt={ch1:nt});var Lt=nt.ch1,zt=nt.ch2,Yt=nt.ch3,Se=nt.ch4,Re=nt.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Lt=="string"&&Lt.charAt(0)!=="#"){var un=new aS(Lt);if(un.ok)Lt=un.toHex();else if(!/^\d*\.?\d*$/.test(Lt))throw new Error('Invalid color "'+Lt+'" passed to jsPDF.encodeColorString.')}if(typeof Lt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Lt)&&(Lt="#"+Lt[1]+Lt[1]+Lt[2]+Lt[2]+Lt[3]+Lt[3]),typeof Lt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Lt)){var gn=parseInt(Lt.substr(1),16);Lt=gn>>16&255,zt=gn>>8&255,Yt=255&gn}if(zt===void 0||Se===void 0&&Lt===zt&&zt===Yt)bt=typeof Lt=="string"?Lt+" "+Re[0]:nt.precision===2?R(Lt/255)+" "+Re[0]:I(Lt/255)+" "+Re[0];else if(Se===void 0||Yr(Se)==="object"){if(Se&&!isNaN(Se.a)&&Se.a===0)return["1.","1.","1.",Re[1]].join(" ");bt=typeof Lt=="string"?[Lt,zt,Yt,Re[1]].join(" "):nt.precision===2?[R(Lt/255),R(zt/255),R(Yt/255),Re[1]].join(" "):[I(Lt/255),I(zt/255),I(Yt/255),Re[1]].join(" ")}else bt=typeof Lt=="string"?[Lt,zt,Yt,Se,Re[2]].join(" "):nt.precision===2?[R(Lt),R(zt),R(Yt),R(Se),Re[2]].join(" "):[I(Lt),I(zt),I(Yt),I(Se),Re[2]].join(" ");return bt},Ve=f.__private__.getFilters=function(){return a},an=f.__private__.putStream=function(nt){var bt=(nt=nt||{}).data||"",Lt=nt.filters||Ve(),zt=nt.alreadyAppliedFilters||[],Yt=nt.addLength1||!1,Se=bt.length,Re=nt.objectId,un=function(Ui){return Ui};if(c!==null&&Re===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");c!==null&&(un=yr.encryptor(Re,0));var gn={};Lt===!0&&(Lt=["FlateEncode"]);var Dn=nt.additionalKeyValues||[],$n=(gn=xn.API.processDataByFilters!==void 0?xn.API.processDataByFilters(bt,Lt):{data:bt,reverseChain:[]}).reverseChain+(Array.isArray(zt)?zt.join(" "):zt.toString());if(gn.data.length!==0&&(Dn.push({key:"Length",value:gn.data.length}),Yt===!0&&Dn.push({key:"Length1",value:Se})),$n.length!=0)if($n.split("/").length-1==1)Dn.push({key:"Filter",value:$n});else{Dn.push({key:"Filter",value:"["+$n+"]"});for(var vr=0;vr<Dn.length;vr+=1)if(Dn[vr].key==="DecodeParms"){for(var pi=[],Ni=0;Ni<gn.reverseChain.split("/").length-1;Ni+=1)pi.push("null");pi.push(Dn[vr].value),Dn[vr].value="["+pi.join(" ")+"]"}}rt("<<");for(var Zr=0;Zr<Dn.length;Zr++)rt("/"+Dn[Zr].key+" "+Dn[Zr].value);rt(">>"),gn.data.length!==0&&(rt("stream"),rt(un(gn.data)),rt("endstream"))},kn=f.__private__.putPage=function(nt){var bt=nt.number,Lt=nt.data,zt=nt.objId,Yt=nt.contentsObjId;we(zt,!0),rt("<</Type /Page"),rt("/Parent "+nt.rootDictionaryObjId+" 0 R"),rt("/Resources "+nt.resourceDictionaryObjId+" 0 R"),rt("/MediaBox ["+parseFloat(P(nt.mediaBox.bottomLeftX))+" "+parseFloat(P(nt.mediaBox.bottomLeftY))+" "+P(nt.mediaBox.topRightX)+" "+P(nt.mediaBox.topRightY)+"]"),nt.cropBox!==null&&rt("/CropBox ["+P(nt.cropBox.bottomLeftX)+" "+P(nt.cropBox.bottomLeftY)+" "+P(nt.cropBox.topRightX)+" "+P(nt.cropBox.topRightY)+"]"),nt.bleedBox!==null&&rt("/BleedBox ["+P(nt.bleedBox.bottomLeftX)+" "+P(nt.bleedBox.bottomLeftY)+" "+P(nt.bleedBox.topRightX)+" "+P(nt.bleedBox.topRightY)+"]"),nt.trimBox!==null&&rt("/TrimBox ["+P(nt.trimBox.bottomLeftX)+" "+P(nt.trimBox.bottomLeftY)+" "+P(nt.trimBox.topRightX)+" "+P(nt.trimBox.topRightY)+"]"),nt.artBox!==null&&rt("/ArtBox ["+P(nt.artBox.bottomLeftX)+" "+P(nt.artBox.bottomLeftY)+" "+P(nt.artBox.topRightX)+" "+P(nt.artBox.topRightY)+"]"),typeof nt.userUnit=="number"&&nt.userUnit!==1&&rt("/UserUnit "+nt.userUnit),Ke.publish("putPage",{objId:zt,pageContext:Me[bt],pageNumber:bt,page:Lt}),rt("/Contents "+Yt+" 0 R"),rt(">>"),rt("endobj");var Se=Lt.join(`
`);return N===S&&(Se+=`
Q`),we(Yt,!0),an({data:Se,filters:Ve(),objectId:Yt}),rt("endobj"),zt},qn=f.__private__.putPages=function(){var nt,bt,Lt=[];for(nt=1;nt<=Fe;nt++)Me[nt].objId=re(),Me[nt].contentsObjId=re();for(nt=1;nt<=Fe;nt++)Lt.push(kn({number:nt,data:it[nt],objId:Me[nt].objId,contentsObjId:Me[nt].contentsObjId,mediaBox:Me[nt].mediaBox,cropBox:Me[nt].cropBox,bleedBox:Me[nt].bleedBox,trimBox:Me[nt].trimBox,artBox:Me[nt].artBox,userUnit:Me[nt].userUnit,rootDictionaryObjId:Ie,resourceDictionaryObjId:Ue}));we(Ie,!0),rt("<</Type /Pages");var zt="/Kids [";for(bt=0;bt<Fe;bt++)zt+=Lt[bt]+" 0 R ";rt(zt+"]"),rt("/Count "+Fe),rt(">>"),rt("endobj"),Ke.publish("postPutPages")},Qt=function(nt){Ke.publish("putFont",{font:nt,out:rt,newObject:Ht,putStream:an}),nt.isAlreadyPutted!==!0&&(nt.objectNumber=Ht(),rt("<<"),rt("/Type /Font"),rt("/BaseFont /"+mf(nt.postScriptName)),rt("/Subtype /Type1"),typeof nt.encoding=="string"&&rt("/Encoding /"+nt.encoding),rt("/FirstChar 32"),rt("/LastChar 255"),rt(">>"),rt("endobj"))},de=function(nt){nt.objectNumber=Ht();var bt=[];bt.push({key:"Type",value:"/XObject"}),bt.push({key:"Subtype",value:"/Form"}),bt.push({key:"BBox",value:"["+[P(nt.x),P(nt.y),P(nt.x+nt.width),P(nt.y+nt.height)].join(" ")+"]"}),bt.push({key:"Matrix",value:"["+nt.matrix.toString()+"]"});var Lt=nt.pages[1].join(`
`);an({data:Lt,additionalKeyValues:bt,objectId:nt.objectNumber}),rt("endobj")},Ee=function(nt,bt){bt||(bt=21);var Lt=Ht(),zt=(function(Re,un){var gn,Dn=[],$n=1/(un-1);for(gn=0;gn<1;gn+=$n)Dn.push(gn);if(Dn.push(1),Re[0].offset!=0){var vr={offset:0,color:Re[0].color};Re.unshift(vr)}if(Re[Re.length-1].offset!=1){var pi={offset:1,color:Re[Re.length-1].color};Re.push(pi)}for(var Ni="",Zr=0,Ui=0;Ui<Dn.length;Ui++){for(gn=Dn[Ui];gn>Re[Zr+1].offset;)Zr++;var Oi=Re[Zr].offset,rs=(gn-Oi)/(Re[Zr+1].offset-Oi),Ka=Re[Zr].color,ma=Re[Zr+1].color;Ni+=et(Math.round((1-rs)*Ka[0]+rs*ma[0]).toString(16))+et(Math.round((1-rs)*Ka[1]+rs*ma[1]).toString(16))+et(Math.round((1-rs)*Ka[2]+rs*ma[2]).toString(16))}return Ni.trim()})(nt.colors,bt),Yt=[];Yt.push({key:"FunctionType",value:"0"}),Yt.push({key:"Domain",value:"[0.0 1.0]"}),Yt.push({key:"Size",value:"["+bt+"]"}),Yt.push({key:"BitsPerSample",value:"8"}),Yt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Yt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),an({data:zt,additionalKeyValues:Yt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Lt}),rt("endobj"),nt.objectNumber=Ht(),rt("<< /ShadingType "+nt.type),rt("/ColorSpace /DeviceRGB");var Se="/Coords ["+P(parseFloat(nt.coords[0]))+" "+P(parseFloat(nt.coords[1]))+" ";nt.type===2?Se+=P(parseFloat(nt.coords[2]))+" "+P(parseFloat(nt.coords[3])):Se+=P(parseFloat(nt.coords[2]))+" "+P(parseFloat(nt.coords[3]))+" "+P(parseFloat(nt.coords[4]))+" "+P(parseFloat(nt.coords[5])),rt(Se+="]"),nt.matrix&&rt("/Matrix ["+nt.matrix.toString()+"]"),rt("/Function "+Lt+" 0 R"),rt("/Extend [true true]"),rt(">>"),rt("endobj")},Pe=function(nt,bt){var Lt=re(),zt=Ht();bt.push({resourcesOid:Lt,objectOid:zt}),nt.objectNumber=zt;var Yt=[];Yt.push({key:"Type",value:"/Pattern"}),Yt.push({key:"PatternType",value:"1"}),Yt.push({key:"PaintType",value:"1"}),Yt.push({key:"TilingType",value:"1"}),Yt.push({key:"BBox",value:"["+nt.boundingBox.map(P).join(" ")+"]"}),Yt.push({key:"XStep",value:P(nt.xStep)}),Yt.push({key:"YStep",value:P(nt.yStep)}),Yt.push({key:"Resources",value:Lt+" 0 R"}),nt.matrix&&Yt.push({key:"Matrix",value:"["+nt.matrix.toString()+"]"}),an({data:nt.stream,additionalKeyValues:Yt,objectId:nt.objectNumber}),rt("endobj")},_t=function(nt){for(var bt in nt.objectNumber=Ht(),rt("<<"),nt)switch(bt){case"opacity":rt("/ca "+R(nt[bt]));break;case"stroke-opacity":rt("/CA "+R(nt[bt]))}rt(">>"),rt("endobj")},Bt=function(nt){we(nt.resourcesOid,!0),rt("<<"),rt("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var bt in rt("/Font <<"),Jt)Jt.hasOwnProperty(bt)&&(p===!1||p===!0&&h.hasOwnProperty(bt))&&rt("/"+bt+" "+Jt[bt].objectNumber+" 0 R");rt(">>")})(),(function(){if(Object.keys(fe).length>0){for(var bt in rt("/Shading <<"),fe)fe.hasOwnProperty(bt)&&fe[bt]instanceof Qu&&fe[bt].objectNumber>=0&&rt("/"+bt+" "+fe[bt].objectNumber+" 0 R");Ke.publish("putShadingPatternDict"),rt(">>")}})(),(function(bt){if(Object.keys(fe).length>0){for(var Lt in rt("/Pattern <<"),fe)fe.hasOwnProperty(Lt)&&fe[Lt]instanceof f.TilingPattern&&fe[Lt].objectNumber>=0&&fe[Lt].objectNumber<bt&&rt("/"+Lt+" "+fe[Lt].objectNumber+" 0 R");Ke.publish("putTilingPatternDict"),rt(">>")}})(nt.objectOid),(function(){if(Object.keys(Be).length>0){var bt;for(bt in rt("/ExtGState <<"),Be)Be.hasOwnProperty(bt)&&Be[bt].objectNumber>=0&&rt("/"+bt+" "+Be[bt].objectNumber+" 0 R");Ke.publish("putGStateDict"),rt(">>")}})(),(function(){for(var bt in rt("/XObject <<"),Xe)Xe.hasOwnProperty(bt)&&Xe[bt].objectNumber>=0&&rt("/"+bt+" "+Xe[bt].objectNumber+" 0 R");Ke.publish("putXobjectDict"),rt(">>")})(),rt(">>"),rt("endobj")},Gt=function(nt){ue[nt.fontName]=ue[nt.fontName]||{},ue[nt.fontName][nt.fontStyle]=nt.id},pe=function(nt,bt,Lt,zt,Yt){var Se={id:"F"+(Object.keys(Jt).length+1).toString(10),postScriptName:nt,fontName:bt,fontStyle:Lt,encoding:zt,isStandardFont:Yt||!1,metadata:{}};return Ke.publish("addFont",{font:Se,instance:this}),Jt[Se.id]=Se,Gt(Se),Se.id},Ne=f.__private__.pdfEscape=f.pdfEscape=function(nt,bt){return(function(Lt,zt){var Yt,Se,Re,un,gn,Dn,$n,vr,pi;if(Re=(zt=zt||{}).sourceEncoding||"Unicode",gn=zt.outputEncoding,(zt.autoencode||gn)&&Jt[Kt].metadata&&Jt[Kt].metadata[Re]&&Jt[Kt].metadata[Re].encoding&&(un=Jt[Kt].metadata[Re].encoding,!gn&&Jt[Kt].encoding&&(gn=Jt[Kt].encoding),!gn&&un.codePages&&(gn=un.codePages[0]),typeof gn=="string"&&(gn=un[gn]),gn)){for($n=!1,Dn=[],Yt=0,Se=Lt.length;Yt<Se;Yt++)(vr=gn[Lt.charCodeAt(Yt)])?Dn.push(String.fromCharCode(vr)):Dn.push(Lt[Yt]),Dn[Yt].charCodeAt(0)>>8&&($n=!0);Lt=Dn.join("")}for(Yt=Lt.length;$n===void 0&&Yt!==0;)Lt.charCodeAt(Yt-1)>>8&&($n=!0),Yt--;if(!$n)return Lt;for(Dn=zt.noBOM?[]:[254,255],Yt=0,Se=Lt.length;Yt<Se;Yt++){if((pi=(vr=Lt.charCodeAt(Yt))>>8)>>8)throw new Error("Character at position "+Yt+" of string '"+Lt+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Dn.push(pi),Dn.push(vr-(pi<<8))}return String.fromCharCode.apply(void 0,Dn)})(nt,bt).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ye=f.__private__.beginPage=function(nt){it[++Fe]=[],Me[Fe]={objId:0,contentsObjId:0,userUnit:Number(u),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(nt[0]),topRightY:Number(nt[1])}},$e(Fe),at(it[H])},xe=function(nt,bt){var Lt,zt,Yt;switch(t=bt||t,typeof nt=="string"&&(Lt=v(nt.toLowerCase()),Array.isArray(Lt)&&(zt=Lt[0],Yt=Lt[1])),Array.isArray(nt)&&(zt=nt[0]*ne,Yt=nt[1]*ne),isNaN(zt)&&(zt=o[0],Yt=o[1]),(zt>14400||Yt>14400)&&(li.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),zt=Math.min(14400,zt),Yt=Math.min(14400,Yt)),o=[zt,Yt],t.substr(0,1)){case"l":Yt>zt&&(o=[Yt,zt]);break;case"p":zt>Yt&&(o=[Yt,zt])}ye(o),fn(ns),rt(Ki),Ft!==0&&rt(Ft+" J"),ce!==0&&rt(ce+" j"),Ke.publish("addPage",{pageNumber:Fe})},mn=function(nt){nt>0&&nt<=Fe&&(it.splice(nt,1),Me.splice(nt,1),Fe--,H>Fe&&(H=Fe),this.setPage(H))},$e=function(nt){nt>0&&nt<=Fe&&(H=nt)},vn=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return it.length-1},Ze=function(nt,bt,Lt){var zt,Yt=void 0;return Lt=Lt||{},nt=nt!==void 0?nt:Jt[Kt].fontName,bt=bt!==void 0?bt:Jt[Kt].fontStyle,zt=nt.toLowerCase(),ue[zt]!==void 0&&ue[zt][bt]!==void 0?Yt=ue[zt][bt]:ue[nt]!==void 0&&ue[nt][bt]!==void 0?Yt=ue[nt][bt]:Lt.disableWarning===!1&&li.warn("Unable to look up font label for font '"+nt+"', '"+bt+"'. Refer to getFontList() for available fonts."),Yt||Lt.noFallback||(Yt=ue.times[bt])==null&&(Yt=ue.times.normal),Yt},Tn=f.__private__.putInfo=function(){var nt=Ht(),bt=function(zt){return zt};for(var Lt in c!==null&&(bt=yr.encryptor(nt,0)),rt("<<"),rt("/Producer ("+Ne(bt("jsPDF "+xn.version))+")"),Vt)Vt.hasOwnProperty(Lt)&&Vt[Lt]&&rt("/"+Lt.substr(0,1).toUpperCase()+Lt.substr(1)+" ("+Ne(bt(Vt[Lt]))+")");rt("/CreationDate ("+Ne(bt(E))+")"),rt(">>"),rt("endobj")},Bn=f.__private__.putCatalog=function(nt){var bt=(nt=nt||{}).rootDictionaryObjId||Ie;switch(Ht(),rt("<<"),rt("/Type /Catalog"),rt("/Pages "+bt+" 0 R"),gt||(gt="fullwidth"),gt){case"fullwidth":rt("/OpenAction [3 0 R /FitH null]");break;case"fullheight":rt("/OpenAction [3 0 R /FitV null]");break;case"fullpage":rt("/OpenAction [3 0 R /Fit]");break;case"original":rt("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Lt=""+gt;Lt.substr(Lt.length-1)==="%"&&(gt=parseInt(gt)/100),typeof gt=="number"&&rt("/OpenAction [3 0 R /XYZ null null "+R(gt)+"]")}switch(qt||(qt="continuous"),qt){case"continuous":rt("/PageLayout /OneColumn");break;case"single":rt("/PageLayout /SinglePage");break;case"two":case"twoleft":rt("/PageLayout /TwoColumnLeft");break;case"tworight":rt("/PageLayout /TwoColumnRight")}Et&&rt("/PageMode /"+Et),Ke.publish("putCatalog"),rt(">>"),rt("endobj")},In=f.__private__.putTrailer=function(){rt("trailer"),rt("<<"),rt("/Size "+(V+1)),rt("/Root "+V+" 0 R"),rt("/Info "+(V-1)+" 0 R"),c!==null&&rt("/Encrypt "+yr.oid+" 0 R"),rt("/ID [ <"+x+"> <"+x+"> ]"),rt(">>")},Qe=f.__private__.putHeader=function(){rt("%PDF-"+g),rt("%")},mr=f.__private__.putXRef=function(){var nt="0000000000";rt("xref"),rt("0 "+(V+1)),rt("0000000000 65535 f ");for(var bt=1;bt<=V;bt++)typeof tt[bt]=="function"?rt((nt+tt[bt]()).slice(-10)+" 00000 n "):tt[bt]!==void 0?rt((nt+tt[bt]).slice(-10)+" 00000 n "):rt("0000000000 00000 n ")},sr=f.__private__.buildDocument=function(){var nt;V=0,z=0,$=[],tt=[],Z=[],Ie=re(),Ue=re(),at($),Ke.publish("buildDocument"),Qe(),qn(),(function(){Ke.publish("putAdditionalObjects");for(var Lt=0;Lt<Z.length;Lt++){var zt=Z[Lt];we(zt.objId,!0),rt(zt.content),rt("endobj")}Ke.publish("postPutAdditionalObjects")})(),nt=[],(function(){for(var Lt in Jt)Jt.hasOwnProperty(Lt)&&(p===!1||p===!0&&h.hasOwnProperty(Lt))&&Qt(Jt[Lt])})(),(function(){var Lt;for(Lt in Be)Be.hasOwnProperty(Lt)&&_t(Be[Lt])})(),(function(){for(var Lt in Xe)Xe.hasOwnProperty(Lt)&&de(Xe[Lt])})(),(function(Lt){var zt;for(zt in fe)fe.hasOwnProperty(zt)&&(fe[zt]instanceof Qu?Ee(fe[zt]):fe[zt]instanceof gf&&Pe(fe[zt],Lt))})(nt),Ke.publish("putResources"),nt.forEach(Bt),Bt({resourcesOid:Ue,objectOid:Number.MAX_SAFE_INTEGER}),Ke.publish("postPutResources"),c!==null&&(yr.oid=Ht(),rt("<<"),rt("/Filter /Standard"),rt("/V "+yr.v),rt("/R "+yr.r),rt("/U <"+yr.toHexString(yr.U)+">"),rt("/O <"+yr.toHexString(yr.O)+">"),rt("/P "+yr.P),rt(">>"),rt("endobj")),Tn(),Bn();var bt=z;return mr(),In(),rt("startxref"),rt(""+bt),rt("%%EOF"),at(it[H]),$.join(`
`)},Dr=f.__private__.getBlob=function(nt){return new Blob([ot(nt)],{type:"application/pdf"})},xi=f.output=f.__private__.output=(Dt=function(nt,bt){switch(typeof(bt=bt||{})=="string"?bt={filename:bt}:bt.filename=bt.filename||"generated.pdf",nt){case void 0:return sr();case"save":f.save(bt.filename);break;case"arraybuffer":return ot(sr());case"blob":return Dr(sr());case"bloburi":case"bloburl":if(zn.URL!==void 0&&typeof zn.URL.createObjectURL=="function")return zn.URL&&zn.URL.createObjectURL(Dr(sr()))||void 0;li.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Lt="",zt=sr();try{Lt=n3(zt)}catch{Lt=n3(unescape(encodeURIComponent(zt)))}return"data:application/pdf;filename="+bt.filename+";base64,"+Lt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(zn)==="[object Window]"){var Yt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Se=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';bt.pdfObjectUrl&&(Yt=bt.pdfObjectUrl,Se="");var Re='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Yt+'"'+Se+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(bt)+");<\/script></body></html>",un=zn.open();return un!==null&&un.document.write(Re),un}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(zn)==="[object Window]"){var gn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(bt.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+bt.filename+'" width="500px" height="400px" /></body></html>',Dn=zn.open();if(Dn!==null){Dn.document.write(gn);var $n=this;Dn.document.documentElement.querySelector("#pdfViewer").onload=function(){Dn.document.title=bt.filename,Dn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open($n.output("bloburl"))}}return Dn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(zn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var vr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",bt)+'"></iframe></body></html>',pi=zn.open();if(pi!==null&&(pi.document.write(vr),pi.document.title=bt.filename),pi||typeof safari>"u")return pi;break;case"datauri":case"dataurl":return zn.document.location.href=this.output("datauristring",bt);default:return null}},Dt.foo=function(){try{return Dt.apply(this,arguments)}catch(Lt){var nt=Lt.stack||"";~nt.indexOf(" at ")&&(nt=nt.split(" at ")[1]);var bt="Error in function "+nt.split(`
`)[0].split("<")[0]+": "+Lt.message;if(!zn.console)throw new Error(bt);zn.console.error(bt,Lt),zn.alert&&alert(bt)}},Dt.foo.bar=Dt,Dt.foo),ir=function(nt){return Array.isArray(En)===!0&&En.indexOf(nt)>-1};switch(r){case"pt":ne=1;break;case"mm":ne=72/25.4;break;case"cm":ne=72/2.54;break;case"in":ne=72;break;case"px":ne=ir("px_scaling")==1?.75:96/72;break;case"pc":case"em":ne=12;break;case"ex":ne=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);ne=r}var yr=null;B(),A();var ur=f.__private__.getPageInfo=f.getPageInfo=function(nt){if(isNaN(nt)||nt%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Me[nt].objId,pageNumber:nt,pageContext:Me[nt]}},Un=f.__private__.getPageInfoByObjId=function(nt){if(isNaN(nt)||nt%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var bt in Me)if(Me[bt].objId===nt)break;return ur(bt)},tn=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Me[H].objId,pageNumber:H,pageContext:Me[H]}};f.addPage=function(){return xe.apply(this,arguments),this},f.setPage=function(){return $e.apply(this,arguments),at.call(this,it[H]),this},f.insertPage=function(nt){return this.addPage(),this.movePage(H,nt),this},f.movePage=function(nt,bt){var Lt,zt;if(nt>bt){Lt=it[nt],zt=Me[nt];for(var Yt=nt;Yt>bt;Yt--)it[Yt]=it[Yt-1],Me[Yt]=Me[Yt-1];it[bt]=Lt,Me[bt]=zt,this.setPage(bt)}else if(nt<bt){Lt=it[nt],zt=Me[nt];for(var Se=nt;Se<bt;Se++)it[Se]=it[Se+1],Me[Se]=Me[Se+1];it[bt]=Lt,Me[bt]=zt,this.setPage(bt)}return this},f.deletePage=function(){return mn.apply(this,arguments),this},f.__private__.text=f.text=function(nt,bt,Lt,zt,Yt){var Se,Re,un,gn,Dn,$n,vr,pi,Ni,Zr=(zt=zt||{}).scope||this;if(typeof nt=="number"&&typeof bt=="number"&&(typeof Lt=="string"||Array.isArray(Lt))){var Ui=Lt;Lt=bt,bt=nt,nt=Ui}if(arguments[3]instanceof Te==0?(un=arguments[4],gn=arguments[5],Yr(vr=arguments[3])==="object"&&vr!==null||(typeof un=="string"&&(gn=un,un=null),typeof vr=="string"&&(gn=vr,vr=null),typeof vr=="number"&&(un=vr,vr=null),zt={flags:vr,angle:un,align:gn})):(U("The transform parameter of text() with a Matrix value"),Ni=Yt),isNaN(bt)||isNaN(Lt)||nt==null)throw new Error("Invalid arguments passed to jsPDF.text");if(nt.length===0)return Zr;var Oi,rs="",Ka=typeof zt.lineHeightFactor=="number"?zt.lineHeightFactor:Lr,ma=Zr.internal.scaleFactor;function Za(Nr){return Nr=Nr.split("	").join(Array(zt.TabLen||9).join(" ")),Ne(Nr,vr)}function Mu(Nr){for(var wr,Qr=Nr.concat(),ji=[],Ba=Qr.length;Ba--;)typeof(wr=Qr.shift())=="string"?ji.push(wr):Array.isArray(Nr)&&(wr.length===1||wr[1]===void 0&&wr[2]===void 0)?ji.push(wr[0]):ji.push([wr[0],wr[1],wr[2]]);return ji}function zl(Nr,wr){var Qr;if(typeof Nr=="string")Qr=wr(Nr)[0];else if(Array.isArray(Nr)){for(var ji,Ba,va=Nr.concat(),al=[],Ru=va.length;Ru--;)typeof(ji=va.shift())=="string"?al.push(wr(ji)[0]):Array.isArray(ji)&&typeof ji[0]=="string"&&(Ba=wr(ji[0],ji[1],ji[2]),al.push([Ba[0],Ba[1],Ba[2]]));Qr=al}return Qr}var ja=!1,ga=!0;if(typeof nt=="string")ja=!0;else if(Array.isArray(nt)){var il=nt.concat();Re=[];for(var Qa,Zi=il.length;Zi--;)(typeof(Qa=il.shift())!="string"||Array.isArray(Qa)&&typeof Qa[0]!="string")&&(ga=!1);ja=ga}if(ja===!1)throw new Error('Type of text must be string or Array. "'+nt+'" is not recognized.');typeof nt=="string"&&(nt=nt.match(/[\r?\n]/)?nt.split(/\r\n|\r|\n/g):[nt]);var jo=ft/Zr.internal.scaleFactor,Mo=jo*(Ka-1);switch(zt.baseline){case"bottom":Lt-=Mo;break;case"top":Lt+=jo-Mo;break;case"hanging":Lt+=jo-2*Mo;break;case"middle":Lt+=jo/2-Mo}if(($n=zt.maxWidth||0)>0&&(typeof nt=="string"?nt=Zr.splitTextToSize(nt,$n):Object.prototype.toString.call(nt)==="[object Array]"&&(nt=nt.reduce(function(Nr,wr){return Nr.concat(Zr.splitTextToSize(wr,$n))},[]))),Se={text:nt,x:bt,y:Lt,options:zt,mutex:{pdfEscape:Ne,activeFontKey:Kt,fonts:Jt,activeFontSize:ft}},Ke.publish("preProcessText",Se),nt=Se.text,un=(zt=Se.options).angle,Ni instanceof Te==0&&un&&typeof un=="number"){un*=Math.PI/180,zt.rotationDirection===0&&(un=-un),N===S&&(un=-un);var ql=Math.cos(un),Ma=Math.sin(un);Ni=new Te(ql,Ma,-Ma,ql,0,0)}else un&&un instanceof Te&&(Ni=un);N!==S||Ni||(Ni=Pn),(Dn=zt.charSpace||ut)!==void 0&&(rs+=P(T(Dn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(pi=zt.horizontalScale)!==void 0&&(rs+=P(100*pi)+` Tz
`),zt.lang;var ws=-1,Ja=zt.renderingMode!==void 0?zt.renderingMode:zt.stroke,Ul=Zr.internal.getCurrentPageInfo().pageContext;switch(Ja){case 0:case!1:case"fill":ws=0;break;case 1:case!0:case"stroke":ws=1;break;case 2:case"fillThenStroke":ws=2;break;case 3:case"invisible":ws=3;break;case 4:case"fillAndAddForClipping":ws=4;break;case 5:case"strokeAndAddPathForClipping":ws=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ws=6;break;case 7:case"addToPathForClipping":ws=7}var Lu=Ul.usedRenderingMode!==void 0?Ul.usedRenderingMode:-1;ws!==-1?rs+=ws+` Tr
`:Lu!==-1&&(rs+=`0 Tr
`),ws!==-1&&(Ul.usedRenderingMode=ws),gn=zt.align||"left";var qs,ba=ft*Ka,to=Zr.internal.pageSize.getWidth(),Ou=Jt[Kt];Dn=zt.charSpace||ut,$n=zt.maxWidth||0,vr=Object.assign({autoencode:!0,noBOM:!0},zt.flags);var ya=[],Lo=function(Nr){return Zr.getStringUnitWidth(Nr,{font:Ou,charSpace:Dn,fontSize:ft,doKerning:!1})*ft/ma};if(Object.prototype.toString.call(nt)==="[object Array]"){var Ns;Re=Mu(nt),gn!=="left"&&(qs=Re.map(Lo));var xs,La=0;if(gn==="right"){bt-=qs[0],nt=[],Zi=Re.length;for(var Oa=0;Oa<Zi;Oa++)Oa===0?(xs=Yi(bt),Ns=di(Lt)):(xs=T(La-qs[Oa]),Ns=-ba),nt.push([Re[Oa],xs,Ns]),La=qs[Oa]}else if(gn==="center"){bt-=qs[0]/2,nt=[],Zi=Re.length;for(var eo=0;eo<Zi;eo++)eo===0?(xs=Yi(bt),Ns=di(Lt)):(xs=T((La-qs[eo])/2),Ns=-ba),nt.push([Re[eo],xs,Ns]),La=qs[eo]}else if(gn==="left"){nt=[],Zi=Re.length;for(var Hl=0;Hl<Zi;Hl++)nt.push(Re[Hl])}else if(gn==="justify"&&Ou.encoding==="Identity-H"){nt=[],Zi=Re.length,$n=$n!==0?$n:to;for(var $l=0,Ti=0;Ti<Zi;Ti++)if(Ns=Ti===0?di(Lt):-ba,xs=Ti===0?Yi(bt):$l,Ti<Zi-1){var wc=T(($n-qs[Ti])/(Re[Ti].split(" ").length-1)),Ra=Re[Ti].split(" ");nt.push([Ra[0]+" ",xs,Ns]),$l=0;for(var Ia=1;Ia<Ra.length;Ia++){var is=(Lo(Ra[Ia-1]+" "+Ra[Ia])-Lo(Ra[Ia]))*ma+wc;Ia==Ra.length-1?nt.push([Ra[Ia],is,0]):nt.push([Ra[Ia]+" ",is,0]),$l-=is}}else nt.push([Re[Ti],xs,Ns]);nt.push(["",$l,0])}else{if(gn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(nt=[],Zi=Re.length,$n=$n!==0?$n:to,Ti=0;Ti<Zi;Ti++){Ns=Ti===0?di(Lt):-ba,xs=Ti===0?Yi(bt):0;var no=Re[Ti].split(" ").length-1,Vl=no>0?($n-qs[Ti])/no:0;Ti<Zi-1?ya.push(P(T(Vl))):ya.push(0),nt.push([Re[Ti],xs,Ns])}}}(typeof zt.R2L=="boolean"?zt.R2L:yt)===!0&&(nt=zl(nt,function(Nr,wr,Qr){return[Nr.split("").reverse().join(""),wr,Qr]})),Se={text:nt,x:bt,y:Lt,options:zt,mutex:{pdfEscape:Ne,activeFontKey:Kt,fonts:Jt,activeFontSize:ft}},Ke.publish("postProcessText",Se),nt=Se.text,Oi=Se.mutex.isHex||!1;var Wl=Jt[Kt].encoding;Wl!=="WinAnsiEncoding"&&Wl!=="StandardEncoding"||(nt=zl(nt,function(Nr,wr,Qr){return[Za(Nr),wr,Qr]})),Re=Mu(nt),nt=[];for(var ro,io,Da,sl=Array.isArray(Re[0])?1:0,Us="",so=function(Nr,wr,Qr){var ji="";return Qr instanceof Te?(Qr=typeof zt.angle=="number"?_n(Qr,new Te(1,0,0,1,Nr,wr)):_n(new Te(1,0,0,1,Nr,wr),Qr),N===S&&(Qr=_n(new Te(1,0,0,-1,0,0),Qr)),ji=Qr.join(" ")+` Tm
`):ji=P(Nr)+" "+P(wr)+` Td
`,ji},hs=0;hs<Re.length;hs++){switch(Us="",sl){case 1:Da=(Oi?"<":"(")+Re[hs][0]+(Oi?">":")"),ro=parseFloat(Re[hs][1]),io=parseFloat(Re[hs][2]);break;case 0:Da=(Oi?"<":"(")+Re[hs]+(Oi?">":")"),ro=Yi(bt),io=di(Lt)}ya!==void 0&&ya[hs]!==void 0&&(Us=ya[hs]+` Tw
`),hs===0?nt.push(Us+so(ro,io,Ni)+Da):sl===0?nt.push(Us+Da):sl===1&&nt.push(Us+so(ro,io,Ni)+Da)}nt=sl===0?nt.join(` Tj
T* `):nt.join(` Tj
`),nt+=` Tj
`;var Zs=`BT
/`;return Zs+=Kt+" "+ft+` Tf
`,Zs+=P(ft*Ka)+` TL
`,Zs+=Es+`
`,Zs+=rs,Zs+=nt,rt(Zs+="ET"),h[Kt]=!0,Zr};var ar=f.__private__.clip=f.clip=function(nt){return rt(nt==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return ar("evenodd")},f.__private__.discardPath=f.discardPath=function(){return rt("n"),this};var tr=f.__private__.isValidStyle=function(nt){var bt=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(nt)!==-1&&(bt=!0),bt};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(nt){return tr(nt)&&(i=nt),this};var Ur=f.__private__.getStyle=f.getStyle=function(nt){var bt=i;switch(nt){case"D":case"S":bt="S";break;case"F":bt="f";break;case"FD":case"DF":bt="B";break;case"f":case"f*":case"B":case"B*":bt=nt}return bt},Kn=f.close=function(){return rt("h"),this};f.stroke=function(){return rt("S"),this},f.fill=function(nt){return Zn("f",nt),this},f.fillEvenOdd=function(nt){return Zn("f*",nt),this},f.fillStroke=function(nt){return Zn("B",nt),this},f.fillStrokeEvenOdd=function(nt){return Zn("B*",nt),this};var Zn=function(nt,bt){Yr(bt)==="object"?or(bt,nt):rt(nt)},cr=function(nt){nt===null||N===S&&nt===void 0||(nt=Ur(nt),rt(nt))};function ri(nt,bt,Lt,zt,Yt){var Se=new gf(bt||this.boundingBox,Lt||this.xStep,zt||this.yStep,this.gState,Yt||this.matrix);Se.stream=this.stream;var Re=nt+"$$"+this.cloneIndex+++"$$";return on(Re,Se),Se}var or=function(nt,bt){var Lt=qe[nt.key],zt=fe[Lt];if(zt instanceof Qu)rt("q"),rt(Mr(bt)),zt.gState&&f.setGState(zt.gState),rt(nt.matrix.toString()+" cm"),rt("/"+Lt+" sh"),rt("Q");else if(zt instanceof gf){var Yt=new Te(1,0,0,-1,0,qi());nt.matrix&&(Yt=Yt.multiply(nt.matrix||Pn),Lt=ri.call(zt,nt.key,nt.boundingBox,nt.xStep,nt.yStep,Yt).id),rt("q"),rt("/Pattern cs"),rt("/"+Lt+" scn"),zt.gState&&f.setGState(zt.gState),rt(bt),rt("Q")}},Mr=function(nt){switch(nt){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Sr=f.moveTo=function(nt,bt){return rt(P(T(nt))+" "+P(L(bt))+" m"),this},Hr=f.lineTo=function(nt,bt){return rt(P(T(nt))+" "+P(L(bt))+" l"),this},Br=f.curveTo=function(nt,bt,Lt,zt,Yt,Se){return rt([P(T(nt)),P(L(bt)),P(T(Lt)),P(L(zt)),P(T(Yt)),P(L(Se)),"c"].join(" ")),this};f.__private__.line=f.line=function(nt,bt,Lt,zt,Yt){if(isNaN(nt)||isNaN(bt)||isNaN(Lt)||isNaN(zt)||!tr(Yt))throw new Error("Invalid arguments passed to jsPDF.line");return N===w?this.lines([[Lt-nt,zt-bt]],nt,bt,[1,1],Yt||"S"):this.lines([[Lt-nt,zt-bt]],nt,bt,[1,1]).stroke()},f.__private__.lines=f.lines=function(nt,bt,Lt,zt,Yt,Se){var Re,un,gn,Dn,$n,vr,pi,Ni,Zr,Ui,Oi,rs;if(typeof nt=="number"&&(rs=Lt,Lt=bt,bt=nt,nt=rs),zt=zt||[1,1],Se=Se||!1,isNaN(bt)||isNaN(Lt)||!Array.isArray(nt)||!Array.isArray(zt)||!tr(Yt)||typeof Se!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Sr(bt,Lt),Re=zt[0],un=zt[1],Dn=nt.length,Ui=bt,Oi=Lt,gn=0;gn<Dn;gn++)($n=nt[gn]).length===2?(Ui=$n[0]*Re+Ui,Oi=$n[1]*un+Oi,Hr(Ui,Oi)):(vr=$n[0]*Re+Ui,pi=$n[1]*un+Oi,Ni=$n[2]*Re+Ui,Zr=$n[3]*un+Oi,Ui=$n[4]*Re+Ui,Oi=$n[5]*un+Oi,Br(vr,pi,Ni,Zr,Ui,Oi));return Se&&Kn(),cr(Yt),this},f.path=function(nt){for(var bt=0;bt<nt.length;bt++){var Lt=nt[bt],zt=Lt.c;switch(Lt.op){case"m":Sr(zt[0],zt[1]);break;case"l":Hr(zt[0],zt[1]);break;case"c":Br.apply(this,zt);break;case"h":Kn()}}return this},f.__private__.rect=f.rect=function(nt,bt,Lt,zt,Yt){if(isNaN(nt)||isNaN(bt)||isNaN(Lt)||isNaN(zt)||!tr(Yt))throw new Error("Invalid arguments passed to jsPDF.rect");return N===w&&(zt=-zt),rt([P(T(nt)),P(L(bt)),P(T(Lt)),P(T(zt)),"re"].join(" ")),cr(Yt),this},f.__private__.triangle=f.triangle=function(nt,bt,Lt,zt,Yt,Se,Re){if(isNaN(nt)||isNaN(bt)||isNaN(Lt)||isNaN(zt)||isNaN(Yt)||isNaN(Se)||!tr(Re))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Lt-nt,zt-bt],[Yt-Lt,Se-zt],[nt-Yt,bt-Se]],nt,bt,[1,1],Re,!0),this},f.__private__.roundedRect=f.roundedRect=function(nt,bt,Lt,zt,Yt,Se,Re){if(isNaN(nt)||isNaN(bt)||isNaN(Lt)||isNaN(zt)||isNaN(Yt)||isNaN(Se)||!tr(Re))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var un=4/3*(Math.SQRT2-1);return Yt=Math.min(Yt,.5*Lt),Se=Math.min(Se,.5*zt),this.lines([[Lt-2*Yt,0],[Yt*un,0,Yt,Se-Se*un,Yt,Se],[0,zt-2*Se],[0,Se*un,-Yt*un,Se,-Yt,Se],[2*Yt-Lt,0],[-Yt*un,0,-Yt,-Se*un,-Yt,-Se],[0,2*Se-zt],[0,-Se*un,Yt*un,-Se,Yt,-Se]],nt+Yt,bt,[1,1],Re,!0),this},f.__private__.ellipse=f.ellipse=function(nt,bt,Lt,zt,Yt){if(isNaN(nt)||isNaN(bt)||isNaN(Lt)||isNaN(zt)||!tr(Yt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Se=4/3*(Math.SQRT2-1)*Lt,Re=4/3*(Math.SQRT2-1)*zt;return Sr(nt+Lt,bt),Br(nt+Lt,bt-Re,nt+Se,bt-zt,nt,bt-zt),Br(nt-Se,bt-zt,nt-Lt,bt-Re,nt-Lt,bt),Br(nt-Lt,bt+Re,nt-Se,bt+zt,nt,bt+zt),Br(nt+Se,bt+zt,nt+Lt,bt+Re,nt+Lt,bt),cr(Yt),this},f.__private__.circle=f.circle=function(nt,bt,Lt,zt){if(isNaN(nt)||isNaN(bt)||isNaN(Lt)||!tr(zt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(nt,bt,Lt,Lt,zt)},f.setFont=function(nt,bt,Lt){return Lt&&(bt=G(bt,Lt)),Kt=Ze(nt,bt,{disableWarning:!1}),this};var hi=f.__private__.getFont=f.getFont=function(){return Jt[Ze.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var nt,bt,Lt={};for(nt in ue)if(ue.hasOwnProperty(nt))for(bt in Lt[nt]=[],ue[nt])ue[nt].hasOwnProperty(bt)&&Lt[nt].push(bt);return Lt},f.addFont=function(nt,bt,Lt,zt,Yt){var Se=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Se.indexOf(arguments[3])!==-1?Yt=arguments[3]:arguments[3]&&Se.indexOf(arguments[3])==-1&&(Lt=G(Lt,zt)),pe.call(this,nt,bt,Lt,Yt=Yt||"Identity-H")};var Lr,ns=n.lineWidth||.200025,fs=f.__private__.getLineWidth=f.getLineWidth=function(){return ns},fn=f.__private__.setLineWidth=f.setLineWidth=function(nt){return ns=nt,rt(P(T(nt))+" w"),this};f.__private__.setLineDash=xn.API.setLineDash=xn.API.setLineDashPattern=function(nt,bt){if(nt=nt||[],bt=bt||0,isNaN(bt)||!Array.isArray(nt))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return nt=nt.map(function(Lt){return P(T(Lt))}).join(" "),bt=P(T(bt)),rt("["+nt+"] "+bt+" d"),this};var vs=f.__private__.getLineHeight=f.getLineHeight=function(){return ft*Lr};f.__private__.getLineHeight=f.getLineHeight=function(){return ft*Lr};var Xs=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(nt){return typeof(nt=nt||1.15)=="number"&&(Lr=nt),this},No=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Lr};Xs(n.lineHeight);var Yi=f.__private__.getHorizontalCoordinate=function(nt){return T(nt)},di=f.__private__.getVerticalCoordinate=function(nt){return N===S?nt:Me[H].mediaBox.topRightY-Me[H].mediaBox.bottomLeftY-T(nt)},Ta=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(nt){return P(Yi(nt))},Xi=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(nt){return P(di(nt))},Ki=n.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return He(Ki)},f.__private__.setStrokeColor=f.setDrawColor=function(nt,bt,Lt,zt){return Ki=Ge({ch1:nt,ch2:bt,ch3:Lt,ch4:zt,pdfColorType:"draw",precision:2}),rt(Ki),this};var Fs=n.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return He(Fs)},f.__private__.setFillColor=f.setFillColor=function(nt,bt,Lt,zt){return Fs=Ge({ch1:nt,ch2:bt,ch3:Lt,ch4:zt,pdfColorType:"fill",precision:2}),rt(Fs),this};var Es=n.textColor||"0 g",To=f.__private__.getTextColor=f.getTextColor=function(){return He(Es)};f.__private__.setTextColor=f.setTextColor=function(nt,bt,Lt,zt){return Es=Ge({ch1:nt,ch2:bt,ch3:Lt,ch4:zt,pdfColorType:"text",precision:3}),this};var ut=n.charSpace,At=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(ut||0)};f.__private__.setCharSpace=f.setCharSpace=function(nt){if(isNaN(nt))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ut=nt,this};var Ft=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(nt){var bt=f.CapJoinStyles[nt];if(bt===void 0)throw new Error("Line cap style of '"+nt+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ft=bt,rt(bt+" J"),this};var ce=0;f.__private__.setLineJoin=f.setLineJoin=function(nt){var bt=f.CapJoinStyles[nt];if(bt===void 0)throw new Error("Line join style of '"+nt+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ce=bt,rt(bt+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(nt){if(nt=nt||0,isNaN(nt))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return rt(P(T(nt))+" M"),this},f.GState=r0,f.setGState=function(nt){(nt=typeof nt=="string"?Be[ke[nt]]:An(null,nt)).equals(Je)||(rt("/"+nt.id+" gs"),Je=nt)};var An=function(nt,bt){if(!nt||!ke[nt]){var Lt=!1;for(var zt in Be)if(Be.hasOwnProperty(zt)&&Be[zt].equals(bt)){Lt=!0;break}if(Lt)bt=Be[zt];else{var Yt="GS"+(Object.keys(Be).length+1).toString(10);Be[Yt]=bt,bt.id=Yt}return nt&&(ke[nt]=bt.id),Ke.publish("addGState",bt),bt}};f.addGState=function(nt,bt){return An(nt,bt),this},f.saveGraphicsState=function(){return rt("q"),ge.push({key:Kt,size:ft,color:Es}),this},f.restoreGraphicsState=function(){rt("Q");var nt=ge.pop();return Kt=nt.key,ft=nt.size,Es=nt.color,Je=null,this},f.setCurrentTransformationMatrix=function(nt){return rt(nt.toString()+" cm"),this},f.comment=function(nt){return rt("#"+nt),this};var en=function(nt,bt){var Lt=nt||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Lt},set:function(Se){isNaN(Se)||(Lt=parseFloat(Se))}});var zt=bt||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return zt},set:function(Se){isNaN(Se)||(zt=parseFloat(Se))}});var Yt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Yt},set:function(Se){Yt=Se.toString()}}),this},Hn=function(nt,bt,Lt,zt){en.call(this,nt,bt),this.type="rect";var Yt=Lt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Yt},set:function(Re){isNaN(Re)||(Yt=parseFloat(Re))}});var Se=zt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Se},set:function(Re){isNaN(Re)||(Se=parseFloat(Re))}}),this},Qn=function(){this.page=Fe,this.currentPage=H,this.pages=it.slice(0),this.pagesContext=Me.slice(0),this.x=ae,this.y=Oe,this.matrix=le,this.width=Xr(H),this.height=ii(H),this.outputDestination=lt,this.id="",this.objectNumber=-1};Qn.prototype.restore=function(){Fe=this.page,H=this.currentPage,Me=this.pagesContext,it=this.pages,ae=this.x,Oe=this.y,le=this.matrix,Si(H,this.width),Kr(H,this.height),lt=this.outputDestination};var qr=function(nt,bt,Lt,zt,Yt){Nn.push(new Qn),Fe=H=0,it=[],ae=nt,Oe=bt,le=Yt,ye([Lt,zt])};for(var Jn in f.beginFormObject=function(nt,bt,Lt,zt,Yt){return qr(nt,bt,Lt,zt,Yt),this},f.endFormObject=function(nt){return(function(bt){if(Sn[bt])Nn.pop().restore();else{var Lt=new Qn,zt="Xo"+(Object.keys(Xe).length+1).toString(10);Lt.id=zt,Sn[bt]=zt,Xe[zt]=Lt,Ke.publish("addFormObject",Lt),Nn.pop().restore()}})(nt),this},f.doFormObject=function(nt,bt){var Lt=Xe[Sn[nt]];return rt("q"),rt(bt.toString()+" cm"),rt("/"+Lt.id+" Do"),rt("Q"),this},f.getFormObject=function(nt){var bt=Xe[Sn[nt]];return{x:bt.x,y:bt.y,width:bt.width,height:bt.height,matrix:bt.matrix}},f.save=function(nt,bt){return nt=nt||"generated.pdf",(bt=bt||{}).returnPromise=bt.returnPromise||!1,bt.returnPromise===!1?(Ku(Dr(sr()),nt),typeof Ku.unload=="function"&&zn.setTimeout&&setTimeout(Ku.unload,911),this):new Promise(function(Lt,zt){try{var Yt=Ku(Dr(sr()),nt);typeof Ku.unload=="function"&&zn.setTimeout&&setTimeout(Ku.unload,911),Lt(Yt)}catch(Se){zt(Se.message)}})},xn.API)xn.API.hasOwnProperty(Jn)&&(Jn==="events"&&xn.API.events.length?(function(nt,bt){var Lt,zt,Yt;for(Yt=bt.length-1;Yt!==-1;Yt--)Lt=bt[Yt][0],zt=bt[Yt][1],nt.subscribe.apply(nt,[Lt].concat(typeof zt=="function"?[zt]:zt))})(Ke,xn.API.events):f[Jn]=xn.API[Jn]);function Xr(nt){return Me[nt].mediaBox.topRightX-Me[nt].mediaBox.bottomLeftX}function Si(nt,bt){Me[nt].mediaBox.topRightX=bt+Me[nt].mediaBox.bottomLeftX}function ii(nt){return Me[nt].mediaBox.topRightY-Me[nt].mediaBox.bottomLeftY}function Kr(nt,bt){Me[nt].mediaBox.topRightY=bt+Me[nt].mediaBox.bottomLeftY}var $r=f.getPageWidth=function(nt){return Xr(nt=nt||H)/ne},zs=f.setPageWidth=function(nt,bt){Si(nt,bt*ne)},qi=f.getPageHeight=function(nt){return ii(nt=nt||H)/ne},Ks=f.setPageHeight=function(nt,bt){Kr(nt,bt*ne)};return f.internal={pdfEscape:Ne,getStyle:Ur,getFont:hi,getFontSize:wt,getCharSpace:At,getTextColor:To,getLineHeight:vs,getLineHeightFactor:No,getLineWidth:fs,write:ct,getHorizontalCoordinate:Yi,getVerticalCoordinate:di,getCoordinateString:Ta,getVerticalCoordinateString:Xi,collections:{},newObject:Ht,newAdditionalObject:nn,newObjectDeferred:re,newObjectDeferredBegin:we,getFilters:Ve,putStream:an,events:Ke,scaleFactor:ne,pageSize:{getWidth:function(){return $r(H)},setWidth:function(nt){zs(H,nt)},getHeight:function(){return qi(H)},setHeight:function(nt){Ks(H,nt)}},encryptionOptions:c,encryption:yr,getEncryptor:function(nt){return c!==null?yr.encryptor(nt,0):function(bt){return bt}},output:xi,getNumberOfPages:vn,get pages(){return it},out:rt,f2:R,f3:I,getPageInfo:ur,getPageInfoByObjId:Un,getCurrentPageInfo:tn,getPDFVersion:y,Point:en,Rectangle:Hn,Matrix:Te,hasHotfix:ir},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return $r(H)},set:function(nt){zs(H,nt)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return qi(H)},set:function(nt){Ks(H,nt)},enumerable:!0,configurable:!0}),(function(nt){for(var bt=0,Lt=dt.length;bt<Lt;bt++){var zt=pe.call(this,nt[bt][0],nt[bt][1],nt[bt][2],dt[bt][3],!0);p===!1&&(h[zt]=!0);var Yt=nt[bt][0].split("-");Gt({id:zt,fontName:Yt[0],fontStyle:Yt[1]||""})}Ke.publish("addFonts",{fonts:Jt,dictionary:ue})}).call(f,dt),Kt="F1",xe(o,t),Ke.publish("initialized"),f}pf.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},pf.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},pf.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},pf.prototype.processOwnerPassword=function(n,e){return lb(ob(e).substr(0,5),n)},pf.prototype.encryptor=function(n,e){var t=ob(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return lb(t,r)}},r0.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||Yr(n)!==Yr(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;r++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},xn.API={events:[]},xn.version="3.0.4";var zi=xn.API,s2=1,vc=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rf=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Yn=function(n){return n.toFixed(2)},yu=function(n){return n.toFixed(5)};zi.__acroform__={};var pa=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},a3=function(n){return n*s2},Go=function(n){var e=new cS,t=dn.internal.getHeight(n)||0,r=dn.internal.getWidth(n)||0;return e.BBox=[0,0,Number(Yn(r)),Number(Yn(t))],e},Aq=zi.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},Cq=zi.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},Eq=zi.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},Vi=zi.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Eq(n,e-1)},Wi=zi.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Aq(n,e-1)},Gi=zi.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Cq(n,e-1)},Nq=zi.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,o=n[0],s=n[1],a=n[2],u=n[3],l={};return l.lowerLeft_X=t(o)||0,l.lowerLeft_Y=r(s+u)||0,l.upperRight_X=t(o+a)||0,l.upperRight_Y=r(s)||0,[Number(Yn(l.lowerLeft_X)),Number(Yn(l.lowerLeft_Y)),Number(Yn(l.upperRight_X)),Number(Yn(l.upperRight_Y))]},Tq=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,r=ub(n,t),o=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+o+" "+Yn(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Go(n);return s.scope=n.scope,s.stream=e.join(`
`),s}},ub=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},o=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");o=n.multiline?o.map(function(R){return R.split(`
`)}):o.map(function(R){return[R]});var s=t,a=dn.internal.getHeight(n)||0;a=a<0?-a:a;var u=dn.internal.getWidth(n)||0;u=u<0?-u:u;var l=function(R,I,T){if(R+1<o.length){var L=I+" "+o[R+1][0];return Mp(L,n,T).width<=u-4}return!1};s++;t:for(;s>0;){e="",s--;var i,c,p=Mp("3",n,s).height,h=n.multiline?a-s:(a-p)/2,f=h+=2,g=0,y=0,b=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Mp(e,n,s=12).width+", FieldWidth:"+u+`
`;break}for(var v="",w=0,S=0;S<o.length;S++)if(o.hasOwnProperty(S)){var N=!1;if(o[S].length!==1&&b!==o[S].length-1){if((p+2)*(w+2)+2>a)continue t;v+=o[S][b],N=!0,y=S,S--}else{v=(v+=o[S][b]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var D=parseInt(S),F=l(D,v,s),G=S>=o.length-1;if(F&&!G){v+=" ",b=0;continue}if(F||G){if(G)y=D;else if(n.multiline&&(p+2)*(w+2)+2>a)continue t}else{if(!n.multiline||(p+2)*(w+2)+2>a)continue t;y=D}}for(var P="",U=g;U<=y;U++){var q=o[U];if(n.multiline){if(U===y){P+=q[b]+" ",b=(b+1)%q.length;continue}if(U===g){P+=q[q.length-1]+" ";continue}}P+=q[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,c=Mp(P,n,s).width,n.textAlign){case"right":i=u-c-2;break;case"center":i=(u-c)/2;break;default:i=2}e+=Yn(i)+" "+Yn(f)+` Td
`,e+="("+vc(P)+`) Tj
`,e+=-Yn(i)+` 0 Td
`,f=-(s+2),c=0,g=N?y:y+1,w++,v=""}break}return r.text=e,r.fontSize=s,r},Mp=function(n,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),o=e.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:o}},jq={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Mq=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},Lq=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Co.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(jq)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");s2=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new fS,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var o in r)if(r.hasOwnProperty(o)){var s=r[o];s.objId=void 0,s.hasAnnotation&&Mq(s,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(r,o){var s=!r;for(var a in r||(o.internal.newObjectDeferredBegin(o.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),o.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||o.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(a)){var u=r[a],l=[],i=u.Rect;if(u.Rect&&(u.Rect=Nq(u.Rect,o)),o.internal.newObjectDeferredBegin(u.objId,!0),u.DA=dn.createDefaultAppearanceStream(u),Yr(u)==="object"&&typeof u.getKeyValueListForStream=="function"&&(l=u.getKeyValueListForStream()),u.Rect=i,u.hasAppearanceStream&&!u.appearanceStreamContent){var c=Tq(u);l.push({key:"AP",value:"<</N "+c+">>"}),o.internal.acroformPlugin.xForms.push(c)}if(u.appearanceStreamContent){var p="";for(var h in u.appearanceStreamContent)if(u.appearanceStreamContent.hasOwnProperty(h)){var f=u.appearanceStreamContent[h];if(p+="/"+h+" ",p+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var a in f)if(f.hasOwnProperty(a)){var g=f[a];typeof g=="function"&&(g=g.call(o,u)),p+="/"+a+" "+g+" ",o.internal.acroformPlugin.xForms.indexOf(g)>=0||o.internal.acroformPlugin.xForms.push(g)}}else typeof(g=f)=="function"&&(g=g.call(o,u)),p+="/"+a+" "+g,o.internal.acroformPlugin.xForms.indexOf(g)>=0||o.internal.acroformPlugin.xForms.push(g);p+=">>"}l.push({key:"AP",value:`<<
`+p+">>"})}o.internal.putStream({additionalKeyValues:l,objectId:u.objId}),o.internal.out("endobj")}s&&(function(y,b){for(var v in y)if(y.hasOwnProperty(v)){var w=v,S=y[v];b.internal.newObjectDeferredBegin(S.objId,!0),Yr(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete y[w]}})(o.internal.acroformPlugin.xForms,o)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},uS=zi.__acroform__.arrayToPdfArray=function(n,e,t){var r=function(a){return a};if(Array.isArray(n)){for(var o="[",s=0;s<n.length;s++)switch(s!==0&&(o+=" "),Yr(n[s])){case"boolean":case"number":case"object":o+=n[s].toString();break;case"string":n[s].substr(0,1)!=="/"?(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),o+="("+vc(r(n[s].toString()))+")"):o+=n[s].toString()}return o+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ng=function(n,e,t){var r=function(o){return o};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+vc(r(n))+")"},Ko=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ko.prototype.toString=function(){return this.objId+" 0 R"},Ko.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Ko.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],o=this[r];o&&(Array.isArray(o)?n.push({key:r,value:uS(o,this.objId,this.scope)}):o instanceof Ko?(o.scope=this.scope,n.push({key:r,value:o.objId+" 0 R"})):typeof o!="function"&&n.push({key:r,value:o}))}return n};var cS=function(){Ko.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};pa(cS,Ko);var fS=function(){Ko.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+vc(t(n))+")"}},set:function(t){n=t}})};pa(fS,Ko);var Co=function n(){Ko.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Vi(e,3)},set:function(v){v?this.F=Wi(e,3):this.F=Gi(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');t=v}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(v){r=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(v){r[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(v){r[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(v){r[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(v){r[3]=v}});var o="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return o},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":o=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof i0)return;s="FieldObject"+n.FieldNum++}var v=function(w){return w};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+vc(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(v){a=v}});var u="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return u},set:function(v){u=v}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var i=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return i===void 0?50/s2:i},set:function(v){i=v}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof i0||this instanceof tc))return ng(p,this.objId,this.scope)},set:function(v){v=v.toString(),p=v}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ys==0?ng(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof ys==0?v.substr(0,1)==="("?rf(v.substr(1,v.length-2)):rf(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ys==1?rf(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof ys==1?"/"+v:v}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof ys==0?ng(f,this.objId,this.scope):f},set:function(v){v=v.toString(),f=this instanceof ys==0?v.substr(0,1)==="("?rf(v.substr(1,v.length-2)):rf(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ys==1?rf(f.substr(1,f.length-1)):f},set:function(v){v=v.toString(),f=this instanceof ys==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(v){v=!!v,y=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(v){g=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,1)},set:function(v){v?this.Ff=Wi(this.Ff,1):this.Ff=Gi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,2)},set:function(v){v?this.Ff=Wi(this.Ff,2):this.Ff=Gi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,3)},set:function(v){v?this.Ff=Wi(this.Ff,3):this.Ff=Gi(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');b=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(b){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:b=2;break;case"center":case 1:b=1;break;default:b=0}}})};pa(Co,Ko);var Sf=function(){Co.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return uS(e,this.objId,this.scope)},set:function(t){var r,o;o=[],typeof(r=t)=="string"&&(o=(function(s,a,u){u||(u=1);for(var l,i=[];l=a.exec(s);)i.push(l[u]);return i})(r,/\((.*?)\)/g)),e=o}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,18)},set:function(t){t?this.Ff=Wi(this.Ff,18):this.Ff=Gi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Wi(this.Ff,19):this.Ff=Gi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,20)},set:function(t){t?(this.Ff=Wi(this.Ff,20),e.sort()):this.Ff=Gi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,22)},set:function(t){t?this.Ff=Wi(this.Ff,22):this.Ff=Gi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,23)},set:function(t){t?this.Ff=Wi(this.Ff,23):this.Ff=Gi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,27)},set:function(t){t?this.Ff=Wi(this.Ff,27):this.Ff=Gi(this.Ff,27)}}),this.hasAppearanceStream=!1};pa(Sf,Co);var _f=function(){Sf.call(this),this.fontName="helvetica",this.combo=!1};pa(_f,Sf);var kf=function(){_f.call(this),this.combo=!0};pa(kf,_f);var zp=function(){kf.call(this),this.edit=!0};pa(zp,kf);var ys=function(){Co.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,15)},set:function(t){t?this.Ff=Wi(this.Ff,15):this.Ff=Gi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,16)},set:function(t){t?this.Ff=Wi(this.Ff,16):this.Ff=Gi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,17)},set:function(t){t?this.Ff=Wi(this.Ff,17):this.Ff=Gi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,26)},set:function(t){t?this.Ff=Wi(this.Ff,26):this.Ff=Gi(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,o=[];for(r in o.push("<<"),e)o.push("/"+r+" ("+vc(t(e[r]))+")");return o.push(">>"),o.join(`
`)}},set:function(t){Yr(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};pa(ys,Co);var qp=function(){ys.call(this),this.pushButton=!0};pa(qp,ys);var Af=function(){ys.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};pa(Af,ys);var i0=function(){var n,e;Co.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(o){e=o}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(u){return u};this.scope&&(o=this.scope.internal.getEncryptor(this.objId));var s,a=[];for(s in a.push("<<"),r)a.push("/"+s+" ("+vc(o(r[s]))+")");return a.push(">>"),a.join(`
`)},set:function(o){Yr(o)==="object"&&(r=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(o){typeof o=="string"&&(r.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(o){t=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(o){t="/"+o}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=dn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};pa(i0,Co),Af.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Af.prototype.createOption=function(n){var e=new i0;return e.Parent=this,e.optionName=n,this.Kids.push(e),Oq.call(this.scope,e),e};var Up=function(){ys.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=dn.CheckBox.createAppearanceStream()};pa(Up,ys);var tc=function(){Co.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,13)},set:function(e){e?this.Ff=Wi(this.Ff,13):this.Ff=Gi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,21)},set:function(e){e?this.Ff=Wi(this.Ff,21):this.Ff=Gi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,23)},set:function(e){e?this.Ff=Wi(this.Ff,23):this.Ff=Gi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,24)},set:function(e){e?this.Ff=Wi(this.Ff,24):this.Ff=Gi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,25)},set:function(e){e?this.Ff=Wi(this.Ff,25):this.Ff=Gi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,26)},set:function(e){e?this.Ff=Wi(this.Ff,26):this.Ff=Gi(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};pa(tc,Co);var Hp=function(){tc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Vi(this.Ff,14)},set:function(n){n?this.Ff=Wi(this.Ff,14):this.Ff=Gi(this.Ff,14)}}),this.password=!0};pa(Hp,tc);var dn={CheckBox:{createAppearanceStream:function(){return{N:{On:dn.CheckBox.YesNormal},D:{On:dn.CheckBox.YesPushDown,Off:dn.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=Go(n);e.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,o=n.scope.__private__.encodeColorString(n.color),s=ub(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+Yn(dn.internal.getWidth(n))+" "+Yn(dn.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+Yn(s.fontSize)+" Tf "+o),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=Go(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),o=[],s=dn.internal.getHeight(n),a=dn.internal.getWidth(n),u=ub(n,n.caption);return o.push("1 g"),o.push("0 0 "+Yn(a)+" "+Yn(s)+" re"),o.push("f"),o.push("q"),o.push("0 0 1 rg"),o.push("0 0 "+Yn(a-1)+" "+Yn(s-1)+" re"),o.push("W"),o.push("n"),o.push("0 g"),o.push("BT"),o.push("/"+t+" "+Yn(u.fontSize)+" Tf "+r),o.push(u.text),o.push("ET"),o.push("Q"),e.stream=o.join(`
`),e},OffPushDown:function(n){var e=Go(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Yn(dn.internal.getWidth(n))+" "+Yn(dn.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:dn.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=dn.RadioButton.Circle.YesNormal,e.D[n]=dn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=Go(n);e.scope=n.scope;var t=[],r=dn.internal.getWidth(n)<=dn.internal.getHeight(n)?dn.internal.getWidth(n)/4:dn.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=dn.internal.Bezier_C,s=Number((r*o).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+yu(dn.internal.getWidth(n)/2)+" "+yu(dn.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Go(n);e.scope=n.scope;var t=[],r=dn.internal.getWidth(n)<=dn.internal.getHeight(n)?dn.internal.getWidth(n)/4:dn.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=Number((2*r).toFixed(5)),s=Number((o*dn.internal.Bezier_C).toFixed(5)),a=Number((r*dn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+yu(dn.internal.getWidth(n)/2)+" "+yu(dn.internal.getHeight(n)/2)+" cm"),t.push(o+" 0 m"),t.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),t.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),t.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),t.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+yu(dn.internal.getWidth(n)/2)+" "+yu(dn.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),t.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),t.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),t.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=Go(n);e.scope=n.scope;var t=[],r=dn.internal.getWidth(n)<=dn.internal.getHeight(n)?dn.internal.getWidth(n)/4:dn.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=Number((2*r).toFixed(5)),s=Number((o*dn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+yu(dn.internal.getWidth(n)/2)+" "+yu(dn.internal.getHeight(n)/2)+" cm"),t.push(o+" 0 m"),t.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),t.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),t.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),t.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:dn.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=dn.RadioButton.Cross.YesNormal,e.D[n]=dn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=Go(n);e.scope=n.scope;var t=[],r=dn.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+Yn(dn.internal.getWidth(n)-2)+" "+Yn(dn.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(Yn(r.x1.x)+" "+Yn(r.x1.y)+" m"),t.push(Yn(r.x2.x)+" "+Yn(r.x2.y)+" l"),t.push(Yn(r.x4.x)+" "+Yn(r.x4.y)+" m"),t.push(Yn(r.x3.x)+" "+Yn(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Go(n);e.scope=n.scope;var t=dn.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+Yn(dn.internal.getWidth(n))+" "+Yn(dn.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Yn(dn.internal.getWidth(n)-2)+" "+Yn(dn.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(Yn(t.x1.x)+" "+Yn(t.x1.y)+" m"),r.push(Yn(t.x2.x)+" "+Yn(t.x2.y)+" l"),r.push(Yn(t.x4.x)+" "+Yn(t.x4.y)+" m"),r.push(Yn(t.x3.x)+" "+Yn(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=Go(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Yn(dn.internal.getWidth(n))+" "+Yn(dn.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};dn.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=dn.internal.getWidth(n),t=dn.internal.getHeight(n),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},dn.internal.getWidth=function(n){var e=0;return Yr(n)==="object"&&(e=a3(n.Rect[2])),e},dn.internal.getHeight=function(n){var e=0;return Yr(n)==="object"&&(e=a3(n.Rect[3])),e};var Oq=zi.addField=function(n){if(Lq(this,n),!(n instanceof Co))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};zi.AcroFormChoiceField=Sf,zi.AcroFormListBox=_f,zi.AcroFormComboBox=kf,zi.AcroFormEditBox=zp,zi.AcroFormButton=ys,zi.AcroFormPushButton=qp,zi.AcroFormRadioButton=Af,zi.AcroFormCheckBox=Up,zi.AcroFormTextField=tc,zi.AcroFormPasswordField=Hp,zi.AcroFormAppearance=dn,zi.AcroForm={ChoiceField:Sf,ListBox:_f,ComboBox:kf,EditBox:zp,Button:ys,PushButton:qp,RadioButton:Af,CheckBox:Up,TextField:tc,PasswordField:Hp,Appearance:dn},xn.AcroForm={ChoiceField:Sf,ListBox:_f,ComboBox:kf,EditBox:zp,Button:ys,PushButton:qp,RadioButton:Af,CheckBox:Up,TextField:tc,PasswordField:Hp,Appearance:dn};xn.AcroForm;function hS(n){return n.reduce(function(e,t,r){return e[t]=r,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},o=n.__addimage__.getImageFileTypeByImageData=function(R,I){var T,L,E,x,k,A=t;if((I=I||t)==="RGBA"||R.data!==void 0&&R.data instanceof Uint8ClampedArray&&"height"in R&&"width"in R)return"RGBA";if(F(R))for(k in r)for(E=r[k],T=0;T<E.length;T+=1){for(x=!0,L=0;L<E[T].length;L+=1)if(E[T][L]!==void 0&&E[T][L]!==R[L]){x=!1;break}if(x===!0){A=k;break}}else for(k in r)for(E=r[k],T=0;T<E.length;T+=1){for(x=!0,L=0;L<E[T].length;L+=1)if(E[T][L]!==void 0&&E[T][L]!==R.charCodeAt(L)){x=!1;break}if(x===!0){A=k;break}}return A===t&&I!==t&&(A=I),A},s=function R(I){for(var T=this.internal.write,L=this.internal.putStream,E=(0,this.internal.getFilters)();E.indexOf("FlateEncode")!==-1;)E.splice(E.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var x=[];if(x.push({key:"Type",value:"/XObject"}),x.push({key:"Subtype",value:"/Image"}),x.push({key:"Width",value:I.width}),x.push({key:"Height",value:I.height}),I.colorSpace===v.INDEXED?x.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(x.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===v.DEVICE_CMYK&&x.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),x.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&x.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)&&I.transparency.length>0){for(var k="",A=0,C=I.transparency.length;A<C;A++)k+=I.transparency[A]+" "+I.transparency[A]+" ";x.push({key:"Mask",value:"["+k+"]"})}I.sMask!==void 0&&x.push({key:"SMask",value:I.objectId+1+" 0 R"});var j=I.filter!==void 0?["/"+I.filter]:void 0;if(L({data:I.data,additionalKeyValues:x,alreadyAppliedFilters:j,objectId:I.objectId}),T("endobj"),"sMask"in I&&I.sMask!==void 0){var B,O=(B=I.sMaskBitsPerComponent)!==null&&B!==void 0?B:I.bitsPerComponent,H={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:O,data:I.sMask};"filter"in I&&(H.decodeParameters="/Predictor ".concat(I.predictor," /Colors 1 /BitsPerComponent ").concat(O," /Columns ").concat(I.width),H.filter=I.filter),R.call(this,H)}if(I.colorSpace===v.INDEXED){var X=this.internal.newObject();L({data:P(new Uint8Array(I.palette)),objectId:X}),T("endobj")}},a=function(){var R=this.internal.collections[e+"images"];for(var I in R)s.call(this,R[I])},u=function(){var R,I=this.internal.collections[e+"images"],T=this.internal.write;for(var L in I)T("/I"+(R=I[L]).index,R.objectId,"0","R")},l=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",u))},i=function(){var R=this.internal.collections[e+"images"];return l.call(this),R},c=function(){return Object.keys(this.internal.collections[e+"images"]).length},p=function(R){return typeof n["process"+R.toUpperCase()]=="function"},h=function(R){return Yr(R)==="object"&&R.nodeType===1},f=function(R,I){if(R.nodeName==="IMG"&&R.hasAttribute("src")){var T=""+R.getAttribute("src");if(T.indexOf("data:image/")===0)return Fp(unescape(T).split("base64,").pop());var L=n.loadFile(T,!0);if(L!==void 0)return L}if(R.nodeName==="CANVAS"){if(R.width===0||R.height===0)throw new Error("Given canvas must have data. Canvas width: "+R.width+", height: "+R.height);var E;switch(I){case"PNG":E="image/png";break;case"WEBP":E="image/webp";break;default:E="image/jpeg"}return Fp(R.toDataURL(E,1).split("base64,").pop())}},g=function(R){var I=this.internal.collections[e+"images"];if(I){for(var T in I)if(R===I[T].alias)return I[T]}},y=function(R,I,T){return R||I||(R=-96,I=-96),R<0&&(R=-1*T.width*72/R/this.internal.scaleFactor),I<0&&(I=-1*T.height*72/I/this.internal.scaleFactor),R===0&&(R=I*T.width/T.height),I===0&&(I=R*T.height/T.width),[R,I]},b=function(R,I,T,L,E,x){var k=y.call(this,T,L,E),A=this.internal.getCoordinateString,C=this.internal.getVerticalCoordinateString,j=i.call(this);if(T=k[0],L=k[1],j[E.index]=E,x){x*=Math.PI/180;var B=Math.cos(x),O=Math.sin(x),H=function(et){return et.toFixed(4)},X=[H(B),H(O),H(-1*O),H(B),0,0,"cm"]}this.internal.write("q"),x?(this.internal.write([1,"0","0",1,A(R),C(I+L),"cm"].join(" ")),this.internal.write(X.join(" ")),this.internal.write([A(T),"0","0",A(L),"0","0","cm"].join(" "))):this.internal.write([A(T),"0","0",A(L),A(R),C(I+L),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+E.index+" Do"),this.internal.write("Q")},v=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=n.__addimage__.sHashCode=function(R){var I,T,L=0;if(typeof R=="string")for(T=R.length,I=0;I<T;I++)L=(L<<5)-L+R.charCodeAt(I),L|=0;else if(F(R))for(T=R.byteLength/2,I=0;I<T;I++)L=(L<<5)-L+R[I],L|=0;return L},N=n.__addimage__.validateStringAsBase64=function(R){(R=R||"").toString().trim();var I=!0;return R.length===0&&(I=!1),R.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(R.substr(0,R.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(R.substr(-2))===!1&&(I=!1),I},D=n.__addimage__.extractImageFromDataUrl=function(R){if(R==null||!(R=R.trim()).startsWith("data:"))return null;var I=R.indexOf(",");return I<0?null:R.substring(0,I).trim().endsWith("base64")?R.substring(I+1):null};n.__addimage__.isArrayBuffer=function(R){return R instanceof ArrayBuffer};var F=n.__addimage__.isArrayBufferView=function(R){return R instanceof Int8Array||R instanceof Uint8Array||R instanceof Uint8ClampedArray||R instanceof Int16Array||R instanceof Uint16Array||R instanceof Int32Array||R instanceof Uint32Array||R instanceof Float32Array||R instanceof Float64Array},G=n.__addimage__.binaryStringToUint8Array=function(R){for(var I=R.length,T=new Uint8Array(I),L=0;L<I;L++)T[L]=R.charCodeAt(L);return T},P=n.__addimage__.arrayBufferToBinaryString=function(R){for(var I="",T=F(R)?R:new Uint8Array(R),L=0;L<T.length;L+=8192)I+=String.fromCharCode.apply(null,T.subarray(L,L+8192));return I};n.addImage=function(){var R,I,T,L,E,x,k,A,C;if(typeof arguments[1]=="number"?(I=t,T=arguments[1],L=arguments[2],E=arguments[3],x=arguments[4],k=arguments[5],A=arguments[6],C=arguments[7]):(I=arguments[1],T=arguments[2],L=arguments[3],E=arguments[4],x=arguments[5],k=arguments[6],A=arguments[7],C=arguments[8]),Yr(R=arguments[0])==="object"&&!h(R)&&"imageData"in R){var j=R;R=j.imageData,I=j.format||I||t,T=j.x||T||0,L=j.y||L||0,E=j.w||j.width||E,x=j.h||j.height||x,k=j.alias||k,A=j.compression||A,C=j.rotation||j.angle||C}var B=this.internal.getFilters();if(A===void 0&&B.indexOf("FlateEncode")!==-1&&(A="SLOW"),isNaN(T)||isNaN(L))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var O=U.call(this,R,I,k,A);return b.call(this,T,L,E,x,O,C),this};var U=function(R,I,T,L){var E,x,k;if(typeof R=="string"&&o(R)===t){R=unescape(R);var A=q(R,!1);(A!==""||(A=n.loadFile(R,!0))!==void 0)&&(R=A)}if(h(R)&&(R=f(R,I)),I=o(R,I),!p(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((k=T)==null||k.length===0)&&(T=(function(C){return typeof C=="string"||F(C)?S(C):F(C.data)?S(C.data):null})(R)),(E=g.call(this,T))||(R instanceof Uint8Array||I==="RGBA"||(x=R,R=G(R)),E=this["process"+I.toUpperCase()](R,c.call(this),T,(function(C){return C&&typeof C=="string"&&(C=C.toUpperCase()),C in n.image_compression?C:w.NONE})(L),x)),!E)throw new Error("An unknown error occurred whilst processing the image.");return E},q=n.__addimage__.convertBase64ToBinaryString=function(R,I){I=typeof I!="boolean"||I;var T,L="";if(typeof R=="string"){var E;T=(E=D(R))!==null&&E!==void 0?E:R;try{L=Fp(T)}catch(x){if(I)throw N(T)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+x.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return L};n.getImageProperties=function(R){var I,T,L="";if(h(R)&&(R=f(R)),typeof R=="string"&&o(R)===t&&((L=q(R,!1))===""&&(L=n.loadFile(R)||""),R=L),T=o(R),!p(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(R instanceof Uint8Array||(R=G(R)),!(I=this["process"+T.toUpperCase()](R)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=T,I}})(xn.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};xn.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,o,s,a=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),i=t.pageContext.annotations,c=!1,p=0;p<i.length&&!c;p++)switch((r=i[p]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(c!=0){this.internal.write("/Annots [");for(var h=0;h<i.length;h++){r=i[h];var f=this.internal.pdfEscape,g=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(y.objId),w=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(o="/Rect ["+a(r.bounds.x)+" "+u(r.bounds.y+r.bounds.h)+" "+a(r.bounds.x+r.bounds.w)+" "+u(r.bounds.y)+"] ")+"/Contents ("+f(v(r.contents))+")",s+=" /Popup "+b.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+f(v(w))+") >>",y.content=s;var S=y.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(o="/Rect ["+a(r.bounds.x+30)+" "+u(r.bounds.y+r.bounds.h)+" "+a(r.bounds.x+r.bounds.w+30)+" "+u(r.bounds.y)+"] ")+" /Parent "+S,r.open&&(s+=" /Open true"),s+=" >>",b.content=s,this.internal.write(y.objId,"0 R",b.objId,"0 R");break;case"freetext":o="/Rect ["+a(r.bounds.x)+" "+u(r.bounds.y)+" "+a(r.bounds.x+r.bounds.w)+" "+u(r.bounds.y+r.bounds.h)+"] ";var N=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+o+"/Contents ("+f(g(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var D=this.annotations._nameMap[r.options.name];r.options.pageNumber=D.page,r.options.top=D.y}else r.options.top||(r.options.top=0);if(o="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /A <</S /URI /URI ("+f(g(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;default:var F=u(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+F+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,o,s,a){var u=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString;u.pageContext.annotations.push({finalBounds:{x:l(t),y:i(r),w:l(t+o),h:i(r+s)},options:a,type:"link"})},n.textWithLink=function(t,r,o,s){var a,u,l=this.getTextWidth(t),i=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){u=s.maxWidth;var c=this.splitTextToSize(t,u).length;a=Math.ceil(i*c)}else u=l,a=i;return this.text(t,r,o,s),o+=.2*i,s.align==="center"&&(r-=l/2),s.align==="right"&&(r-=l),this.link(r,o-i,u,a,s),l},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}})(xn.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},o=[1570,1571,1573,1575];n.__arabicParser__={};var s=n.__arabicParser__.isInArabicSubstitutionA=function(y){return e[y.charCodeAt(0)]!==void 0},a=n.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},u=n.__arabicParser__.isArabicEndLetter=function(y){return a(y)&&s(y)&&e[y.charCodeAt(0)].length<=2},l=n.__arabicParser__.isArabicAlfLetter=function(y){return a(y)&&o.indexOf(y.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return a(y)&&s(y)&&e[y.charCodeAt(0)].length>=1};var i=n.__arabicParser__.arabicLetterHasFinalForm=function(y){return a(y)&&s(y)&&e[y.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(y){return a(y)&&s(y)&&e[y.charCodeAt(0)].length>=3};var c=n.__arabicParser__.arabicLetterHasMedialForm=function(y){return a(y)&&s(y)&&e[y.charCodeAt(0)].length==4},p=n.__arabicParser__.resolveLigatures=function(y){var b=0,v=t,w="",S=0;for(b=0;b<y.length;b+=1)v[y.charCodeAt(b)]!==void 0?(S++,typeof(v=v[y.charCodeAt(b)])=="number"&&(w+=String.fromCharCode(v),v=t,S=0),b===y.length-1&&(v=t,w+=y.charAt(b-(S-1)),b-=S-1,S=0)):(v=t,w+=y.charAt(b-S),b-=S,S=0);return w};n.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&r[y.charCodeAt(0)]!==void 0};var h=n.__arabicParser__.getCorrectForm=function(y,b,v){return a(y)?s(y)===!1?-1:!i(y)||!a(b)&&!a(v)||!a(v)&&u(b)||u(y)&&!a(b)||u(y)&&l(b)||u(y)&&u(b)?0:c(y)&&a(b)&&!u(b)&&a(v)&&i(v)?3:u(y)||!a(v)?1:2:-1},f=function(y){var b=0,v=0,w=0,S="",N="",D="",F=(y=y||"").split("\\s+"),G=[];for(b=0;b<F.length;b+=1){for(G.push(""),v=0;v<F[b].length;v+=1)S=F[b][v],N=F[b][v-1],D=F[b][v+1],a(S)?(w=h(S,N,D),G[b]+=w!==-1?String.fromCharCode(e[S.charCodeAt(0)][w]):S):G[b]+=S;G[b]=p(G[b])}return G.join(" ")},g=n.__arabicParser__.processArabic=n.processArabic=function(){var y,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(b)){var w=0;for(v=[],w=0;w<b.length;w+=1)Array.isArray(b[w])?v.push([f(b[w][0]),b[w][1],b[w][2]]):v.push([f(b[w])]);y=v}else y=f(b);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};n.events.push(["preProcessText",g])})(xn.API),xn.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(u){t=u}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(u){r=isNaN(u)||Number.isInteger(u)===!1||u<0?150:u,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var o=300;Object.defineProperty(this,"height",{get:function(){return o},set:function(u){o=isNaN(u)||Number.isInteger(u)===!1||u<0?300:u,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=o+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(u){s=u}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(u){a=u}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var o;if((t=t||"2d")!=="2d")return null;for(o in r)this.pdf.context2d.hasOwnProperty(o)&&(this.pdf.context2d[o]=r[o]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(xn.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),o.call(this))},o=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(y){l=y}});var i=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return i},set:function(y){i=y}});var c=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(y){p=y}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(y){f=y}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(y){g=y}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(l){return r.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},n.getTextDimensions=function(l,i){r.call(this);var c=(i=i||{}).fontSize||this.getFontSize(),p=i.font||this.getFont(),h=i.scaleFactor||this.internal.scaleFactor,f=0,g=0,y=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var v=i.maxWidth;v>0?typeof l=="string"?l=this.splitTextToSize(l,v):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(S,N){return S.concat(b.splitTextToSize(N,v))},[])):l=Array.isArray(l)?l:[l];for(var w=0;w<l.length;w++)f<(y=this.getStringUnitWidth(l[w],{font:p})*c)&&(f=y);return f!==0&&(g=l.length),{w:f/=h,h:Math.max((g*c*this.getLineHeightFactor()-c*(this.getLineHeightFactor()-1))/h,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=n.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),r.call(this);var i=this.internal.__cell__.lastCell,c=this.internal.__cell__.padding,p=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return i.lineNumber!==void 0&&(i.lineNumber===l.lineNumber?(l.x=(i.x||0)+(i.width||0),l.y=i.y||0):i.y+i.height+l.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=p.top,f&&h&&(this.printHeaderRow(l.lineNumber,!0),l.y+=h[0].height)):l.y=i.y+i.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-c,l.y+c,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+c,{align:"center",baseline:"top",maxWidth:l.width-c-c}):this.text(l.text,l.x+c,l.y+c,{align:"left",baseline:"top",maxWidth:l.width-c-c})),this.internal.__cell__.lastCell=l,this};n.table=function(l,i,c,p,h){if(r.call(this),!c)throw new Error("No data for PDF table.");var f,g,y,b,v=[],w=[],S=[],N={},D={},F=[],G=[],P=(h=h||{}).autoSize||!1,U=h.printHeaders!==!1,q=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,R=h.margins||Object.assign({width:this.getPageWidth()},e),I=typeof h.padding=="number"?h.padding:3,T=h.headerBackgroundColor||"#c8c8c8",L=h.headerTextColor||"#000";if(o.call(this),this.internal.__cell__.printHeaders=U,this.internal.__cell__.margins=R,this.internal.__cell__.table_font_size=q,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=T,this.internal.__cell__.headerTextColor=L,this.setFontSize(q),p==null)w=v=Object.keys(c[0]),S=v.map(function(){return"left"});else if(Array.isArray(p)&&Yr(p[0])==="object")for(v=p.map(function(j){return j.name}),w=p.map(function(j){return j.prompt||j.name||""}),S=p.map(function(j){return j.align||"left"}),f=0;f<p.length;f+=1)D[p[f].name]=.7499990551181103*p[f].width;else Array.isArray(p)&&typeof p[0]=="string"&&(w=v=p,S=v.map(function(){return"left"}));if(P||Array.isArray(p)&&typeof p[0]=="string")for(f=0;f<v.length;f+=1){for(N[b=v[f]]=c.map(function(j){return j[b]}),this.setFont(void 0,"bold"),F.push(this.getTextDimensions(w[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=N[b],this.setFont(void 0,"normal"),y=0;y<g.length;y+=1)F.push(this.getTextDimensions(g[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[b]=Math.max.apply(null,F)+I+I,F=[]}if(U){var E={};for(f=0;f<v.length;f+=1)E[v[f]]={},E[v[f]].text=w[f],E[v[f]].align=S[f];var x=u.call(this,E,D);G=v.map(function(j){return new s(l,i,D[j],x,E[j].text,void 0,E[j].align)}),this.setTableHeaderRow(G),this.printHeaderRow(1,!1)}var k=p.reduce(function(j,B){return j[B.name]=B.align,j},{});for(f=0;f<c.length;f+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:f,data:c[f]},this);var A=u.call(this,c[f],D);for(y=0;y<v.length;y+=1){var C=c[f][v[y]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:f,col:y,data:C},this),a.call(this,new s(l,i,D[v[y]],A,C,f+2,k[v[y]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=i,this};var u=function(l,i){var c=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(l).map(function(f){var g=l[f];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,i[f]-c-c)},this).map(function(f){return this.getLineHeightFactor()*f.length*p/h+c+c},this).reduce(function(f,g){return Math.max(f,g)},0)};n.setTableHeaderRow=function(l){r.call(this),this.internal.__cell__.tableHeaderRow=l},n.printHeaderRow=function(l,i){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var c;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){c=this.internal.__cell__.tableHeaderRow[f].clone(),i&&(c.y=this.internal.__cell__.margins.top||0,h.push(c)),c.lineNumber=l;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,c),this.setTextColor(g)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),t=!1}})(xn.API);var dS={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},pS=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],cb=hS(pS),mS=[100,200,300,400,500,600,700,800,900],Rq=hS(mS);function rg(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(s){return dS[s=s||"normal"]?s:"normal"})(n.style),r=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(n.weight),o=(function(s){return typeof cb[s=s||"normal"]=="number"?s:"normal"})(n.stretch);return{family:e,style:t,weight:r,stretch:o,src:n.src||[],ref:n.ref||{name:e,style:[o,t,r].join(" ")}}}function o3(n,e,t,r){var o;for(o=t;o>=0&&o<e.length;o+=r)if(n[e[o]])return n[e[o]];for(o=t;o>=0&&o<e.length;o-=r)if(n[e[o]])return n[e[o]]}var Iq={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},l3={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function u3(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function c3(n){return n.trimLeft()}function Dq(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function Bq(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var Lp,f3,h3,sf,Op,d3,p3,m3,ig=["times"];function g3(n,e,t,r,o){var s=4,a=y3;switch(o){case xn.API.image_compression.FAST:s=1,a=b3;break;case xn.API.image_compression.MEDIUM:s=6,a=v3;break;case xn.API.image_compression.SLOW:s=9,a=w3}n=(function(l,i,c,p){for(var h,f=l.length/i,g=new Uint8Array(l.length+f),y=[Pq,b3,y3,v3,w3],b=0;b<f;b+=1){var v=b*i,w=l.subarray(v,v+i);if(p)g.set(p(w,c,h),v+b);else{for(var S=y.length,N=[],D=0;D<S;D+=1)N[D]=y[D](w,c,h);var F=zq(N.concat());g.set(N[F],v+b)}h=w}return g})(n,e,Math.ceil(t*r/8),a);var u=rb(n,{level:s});return xn.API.__addimage__.arrayBufferToBinaryString(u)}function Pq(n){var e=Array.apply([],n);return e.unshift(0),e}function b3(n,e){var t=n.length,r=[];r[0]=1;for(var o=0;o<t;o+=1){var s=n[o-e]||0;r[o+1]=n[o]-s+256&255}return r}function y3(n,e,t){var r=n.length,o=[];o[0]=2;for(var s=0;s<r;s+=1){var a=t&&t[s]||0;o[s+1]=n[s]-a+256&255}return o}function v3(n,e,t){var r=n.length,o=[];o[0]=3;for(var s=0;s<r;s+=1){var a=n[s-e]||0,u=t&&t[s]||0;o[s+1]=n[s]+256-(a+u>>>1)&255}return o}function w3(n,e,t){var r=n.length,o=[];o[0]=4;for(var s=0;s<r;s+=1){var a=Fq(n[s-e]||0,t&&t[s]||0,t&&t[s-e]||0);o[s+1]=n[s]-a+256&255}return o}function Fq(n,e,t){if(n===e&&e===t)return n;var r=Math.abs(e-t),o=Math.abs(n-t),s=Math.abs(n+e-t-t);return r<=o&&r<=s?n:o<=s?e:t}function zq(n){var e=n.map(function(t){return t.reduce(function(r,o){return r+Math.abs(o)},0)});return e.indexOf(Math.min.apply(null,e))}function sg(n,e,t){var r=e*t,o=Math.floor(r/8),s=16-(r-8*o+t),a=(1<<t)-1;return gS(n,o)>>s&a}function x3(n,e,t,r){var o=t*r,s=Math.floor(o/8),a=16-(o-8*s+r),u=(1<<r)-1,l=(e&u)<<a;(function(i,c,p){if(c+1<i.byteLength)i.setUint16(c,p,!1);else{var h=p>>8&255;i.setUint8(c,h)}})(n,s,gS(n,s)&~(u<<a)&65535|l)}function gS(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function qq(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,r=n[e++]|n[e++]<<8,o=n[e++],s=o>>7,a=1<<1+(7&o);n[e++],n[e++];var u=null,l=null;s&&(u=e,l=a,e+=3*a);var i=!0,c=[],p=0,h=null,f=0,g=null;for(this.width=t,this.height=r;i&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,g=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((R=n[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var y=n[e++];p=n[e++]|n[e++]<<8,h=n[e++],1&y||(h=null),f=y>>2&7,e++;break;case 254:for(;;){if(!((R=n[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var b=n[e++]|n[e++]<<8,v=n[e++]|n[e++]<<8,w=n[e++]|n[e++]<<8,S=n[e++]|n[e++]<<8,N=n[e++],D=N>>6&1,F=1<<1+(7&N),G=u,P=l,U=!1;N>>7&&(U=!0,G=e,P=F,e+=3*F);var q=e;for(e++;;){var R;if(!((R=n[e++])>=0))throw Error("Invalid block size");if(R===0)break;e+=R}c.push({x:b,y:v,width:w,height:S,has_local_palette:U,palette_offset:G,palette_size:P,data_offset:q,data_length:e-q,transparent_index:h,interlaced:!!D,delay:p,disposal:f});break;case 59:i=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return g},this.frameInfo=function(I){if(I<0||I>=c.length)throw new Error("Frame index out of range.");return c[I]},this.decodeAndBlitFrameBGRA=function(I,T){var L=this.frameInfo(I),E=L.width*L.height,x=new Uint8Array(E);S3(n,L.data_offset,x,E);var k=L.palette_offset,A=L.transparent_index;A===null&&(A=256);var C=L.width,j=t-C,B=C,O=4*(L.y*t+L.x),H=4*((L.y+L.height)*t+L.x),X=O,et=4*j;L.interlaced===!0&&(et+=4*t*7);for(var V=8,tt=0,$=x.length;tt<$;++tt){var z=x[tt];if(B===0&&(B=C,(X+=et)>=H&&(et=4*j+4*t*(V-1),X=O+(C+j)*(V<<1),V>>=1)),z===A)X+=4;else{var Z=n[k+3*z],it=n[k+3*z+1],mt=n[k+3*z+2];T[X++]=mt,T[X++]=it,T[X++]=Z,T[X++]=255}--B}},this.decodeAndBlitFrameRGBA=function(I,T){var L=this.frameInfo(I),E=L.width*L.height,x=new Uint8Array(E);S3(n,L.data_offset,x,E);var k=L.palette_offset,A=L.transparent_index;A===null&&(A=256);var C=L.width,j=t-C,B=C,O=4*(L.y*t+L.x),H=4*((L.y+L.height)*t+L.x),X=O,et=4*j;L.interlaced===!0&&(et+=4*t*7);for(var V=8,tt=0,$=x.length;tt<$;++tt){var z=x[tt];if(B===0&&(B=C,(X+=et)>=H&&(et=4*j+4*t*(V-1),X=O+(C+j)*(V<<1),V>>=1)),z===A)X+=4;else{var Z=n[k+3*z],it=n[k+3*z+1],mt=n[k+3*z+2];T[X++]=Z,T[X++]=it,T[X++]=mt,T[X++]=255}--B}}}function S3(n,e,t,r){for(var o=n[e++],s=1<<o,a=s+1,u=a+1,l=o+1,i=(1<<l)-1,c=0,p=0,h=0,f=n[e++],g=new Int32Array(4096),y=null;;){for(;c<16&&f!==0;)p|=n[e++]<<c,c+=8,f===1?f=n[e++]:--f;if(c<l)break;var b=p&i;if(p>>=l,c-=l,b!==s){if(b===a)break;for(var v=b<u?b:y,w=0,S=v;S>s;)S=g[S]>>8,++w;var N=S;if(h+w+(v!==b?1:0)>r)return void li.log("Warning, gif stream longer than expected.");t[h++]=N;var D=h+=w;for(v!==b&&(t[h++]=N),S=v;w--;)S=g[S],t[--D]=255&S,S>>=8;y!==null&&u<4096&&(g[u++]=y<<8|N,u>=i+1&&l<12&&(++l,i=i<<1|1)),y=b}else u=a+1,i=(1<<(l=o+1))-1,y=null}return h!==r&&li.log("Warning, gif stream shorter than expected."),t}function ag(n){var e,t,r,o,s,a=Math.floor,u=new Array(64),l=new Array(64),i=new Array(64),c=new Array(64),p=new Array(65535),h=new Array(65535),f=new Array(64),g=new Array(64),y=[],b=0,v=7,w=new Array(64),S=new Array(64),N=new Array(64),D=new Array(256),F=new Array(2048),G=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],R=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],L=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],E=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function x(O,H){for(var X=0,et=0,V=new Array,tt=1;tt<=16;tt++){for(var $=1;$<=O[tt];$++)V[H[et]]=[],V[H[et]][0]=X,V[H[et]][1]=tt,et++,X++;X*=2}return V}function k(O){for(var H=O[0],X=O[1]-1;X>=0;)H&1<<X&&(b|=1<<v),X--,--v<0&&(b==255?(A(255),A(0)):A(b),v=7,b=0)}function A(O){y.push(O)}function C(O){A(O>>8&255),A(255&O)}function j(O,H,X,et,V){for(var tt,$=V[0],z=V[240],Z=(function(ft,gt){var wt,yt,Et,Mt,qt,Tt,It,Vt,Kt,ne,ae=0;for(Kt=0;Kt<8;++Kt){wt=ft[ae],yt=ft[ae+1],Et=ft[ae+2],Mt=ft[ae+3],qt=ft[ae+4],Tt=ft[ae+5],It=ft[ae+6];var Oe=wt+(Vt=ft[ae+7]),le=wt-Vt,Jt=yt+It,ue=yt-It,ge=Et+Tt,fe=Et-Tt,qe=Mt+qt,Be=Mt-qt,ke=Oe+qe,Je=Oe-qe,Fe=Jt+ge,Me=Jt-ge;ft[ae]=ke+Fe,ft[ae+4]=ke-Fe;var Ke=.707106781*(Me+Je);ft[ae+2]=Je+Ke,ft[ae+6]=Je-Ke;var En=.382683433*((ke=Be+fe)-(Me=ue+le)),Xe=.5411961*ke+En,Sn=1.306562965*Me+En,Nn=.707106781*(Fe=fe+ue),Te=le+Nn,_n=le-Nn;ft[ae+5]=_n+Xe,ft[ae+3]=_n-Xe,ft[ae+1]=Te+Sn,ft[ae+7]=Te-Sn,ae+=8}for(ae=0,Kt=0;Kt<8;++Kt){wt=ft[ae],yt=ft[ae+8],Et=ft[ae+16],Mt=ft[ae+24],qt=ft[ae+32],Tt=ft[ae+40],It=ft[ae+48];var Pn=wt+(Vt=ft[ae+56]),on=wt-Vt,Dt=yt+It,Ht=yt-It,re=Et+Tt,we=Et-Tt,nn=Mt+qt,Ie=Mt-qt,Ue=Pn+nn,He=Pn-nn,Ge=Dt+re,Ve=Dt-re;ft[ae]=Ue+Ge,ft[ae+32]=Ue-Ge;var an=.707106781*(Ve+He);ft[ae+16]=He+an,ft[ae+48]=He-an;var kn=.382683433*((Ue=Ie+we)-(Ve=Ht+on)),qn=.5411961*Ue+kn,Qt=1.306562965*Ve+kn,de=.707106781*(Ge=we+Ht),Ee=on+de,Pe=on-de;ft[ae+40]=Pe+qn,ft[ae+24]=Pe-qn,ft[ae+8]=Ee+Qt,ft[ae+56]=Ee-Qt,ae++}for(Kt=0;Kt<64;++Kt)ne=ft[Kt]*gt[Kt],f[Kt]=ne>0?ne+.5|0:ne-.5|0;return f})(O,H),it=0;it<64;++it)g[G[it]]=Z[it];var mt=g[0]-X;X=g[0],mt==0?k(et[0]):(k(et[h[tt=32767+mt]]),k(p[tt]));for(var lt=63;lt>0&&g[lt]==0;)lt--;if(lt==0)return k($),X;for(var at,rt=1;rt<=lt;){for(var ct=rt;g[rt]==0&&rt<=lt;)++rt;var ot=rt-ct;if(ot>=16){at=ot>>4;for(var dt=1;dt<=at;++dt)k(z);ot&=15}tt=32767+g[rt],k(V[(ot<<4)+h[tt]]),k(p[tt]),rt++}return lt!=63&&k($),X}function B(O){O=Math.min(Math.max(O,1),100),s!=O&&((function(H){for(var X=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],et=0;et<64;et++){var V=a((X[et]*H+50)/100);V=Math.min(Math.max(V,1),255),u[G[et]]=V}for(var tt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],$=0;$<64;$++){var z=a((tt[$]*H+50)/100);z=Math.min(Math.max(z,1),255),l[G[$]]=z}for(var Z=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],it=0,mt=0;mt<8;mt++)for(var lt=0;lt<8;lt++)i[it]=1/(u[G[it]]*Z[mt]*Z[lt]*8),c[it]=1/(l[G[it]]*Z[mt]*Z[lt]*8),it++})(O<50?Math.floor(5e3/O):Math.floor(200-2*O)),s=O)}this.encode=function(O,H){H&&B(H),y=new Array,b=0,v=7,C(65496),C(65504),C(16),A(74),A(70),A(73),A(70),A(0),A(1),A(1),A(0),C(1),C(1),A(0),A(0),(function(){C(65499),C(132),A(0);for(var yt=0;yt<64;yt++)A(u[yt]);A(1);for(var Et=0;Et<64;Et++)A(l[Et])})(),(function(yt,Et){C(65472),C(17),A(8),C(Et),C(yt),A(3),A(1),A(17),A(0),A(2),A(17),A(1),A(3),A(17),A(1)})(O.width,O.height),(function(){C(65476),C(418),A(0);for(var yt=0;yt<16;yt++)A(P[yt+1]);for(var Et=0;Et<=11;Et++)A(U[Et]);A(16);for(var Mt=0;Mt<16;Mt++)A(q[Mt+1]);for(var qt=0;qt<=161;qt++)A(R[qt]);A(1);for(var Tt=0;Tt<16;Tt++)A(I[Tt+1]);for(var It=0;It<=11;It++)A(T[It]);A(17);for(var Vt=0;Vt<16;Vt++)A(L[Vt+1]);for(var Kt=0;Kt<=161;Kt++)A(E[Kt])})(),C(65498),C(12),A(3),A(1),A(0),A(2),A(17),A(3),A(17),A(0),A(63),A(0);var X=0,et=0,V=0;b=0,v=7,this.encode.displayName="_encode_";for(var tt,$,z,Z,it,mt,lt,at,rt,ct=O.data,ot=O.width,dt=O.height,ft=4*ot,gt=0;gt<dt;){for(tt=0;tt<ft;){for(it=ft*gt+tt,lt=-1,at=0,rt=0;rt<64;rt++)mt=it+(at=rt>>3)*ft+(lt=4*(7&rt)),gt+at>=dt&&(mt-=ft*(gt+1+at-dt)),tt+lt>=ft&&(mt-=tt+lt-ft+4),$=ct[mt++],z=ct[mt++],Z=ct[mt++],w[rt]=(F[$]+F[z+256|0]+F[Z+512|0]>>16)-128,S[rt]=(F[$+768|0]+F[z+1024|0]+F[Z+1280|0]>>16)-128,N[rt]=(F[$+1280|0]+F[z+1536|0]+F[Z+1792|0]>>16)-128;X=j(w,i,X,e,r),et=j(S,c,et,t,o),V=j(N,c,V,t,o),tt+=32}gt+=8}if(v>=0){var wt=[];wt[1]=v+1,wt[0]=(1<<v+1)-1,k(wt)}return C(65497),new Uint8Array(y)},n=n||50,(function(){for(var O=String.fromCharCode,H=0;H<256;H++)D[H]=O(H)})(),e=x(P,U),t=x(I,T),r=x(q,R),o=x(L,E),(function(){for(var O=1,H=2,X=1;X<=15;X++){for(var et=O;et<H;et++)h[32767+et]=X,p[32767+et]=[],p[32767+et][1]=X,p[32767+et][0]=et;for(var V=-(H-1);V<=-O;V++)h[32767+V]=X,p[32767+V]=[],p[32767+V][1]=X,p[32767+V][0]=H-1+V;O<<=1,H<<=1}})(),(function(){for(var O=0;O<256;O++)F[O]=19595*O,F[O+256|0]=38470*O,F[O+512|0]=7471*O+32768,F[O+768|0]=-11059*O,F[O+1024|0]=-21709*O,F[O+1280|0]=32768*O+8421375,F[O+1536|0]=-27439*O,F[O+1792|0]=-5329*O})(),B(n)}function go(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function _3(n){function e(U){if(!U)throw Error("assert :P")}function t(U,q,R){for(var I=0;4>I;I++)if(U[q+I]!=R.charCodeAt(I))return!0;return!1}function r(U,q,R,I,T){for(var L=0;L<T;L++)U[q+L]=R[I+L]}function o(U,q,R,I){for(var T=0;T<I;T++)U[q+T]=R}function s(U){return new Int32Array(U)}function a(U,q){for(var R=[],I=0;I<U;I++)R.push(new q);return R}function u(U,q){var R=[];return(function I(T,L,E){for(var x=E[L],k=0;k<x&&(T.push(E.length>L+1?[]:new q),!(E.length<L+1));k++)I(T[k],L+1,E)})(R,0,U),R}var l=function(){var U=this;function q(Y,Q){for(var st=1<<Q-1>>>0;Y&st;)st>>>=1;return st?(Y&st-1)+st:Y}function R(Y,Q,st,ht,vt){e(!(ht%st));do Y[Q+(ht-=st)]=vt;while(0<ht)}function I(Y,Q,st,ht,vt){if(e(2328>=vt),512>=vt)var xt=s(512);else if((xt=s(vt))==null)return 0;return(function(St,Ct,Nt,Rt,Ut,ee){var Ot,Wt,Zt=Ct,be=1<<Nt,te=s(16),me=s(16);for(e(Ut!=0),e(Rt!=null),e(St!=null),e(0<Nt),Wt=0;Wt<Ut;++Wt){if(15<Rt[Wt])return 0;++te[Rt[Wt]]}if(te[0]==Ut)return 0;for(me[1]=0,Ot=1;15>Ot;++Ot){if(te[Ot]>1<<Ot)return 0;me[Ot+1]=me[Ot]+te[Ot]}for(Wt=0;Wt<Ut;++Wt)Ot=Rt[Wt],0<Rt[Wt]&&(ee[me[Ot]++]=Wt);if(me[15]==1)return(Rt=new T).g=0,Rt.value=ee[0],R(St,Zt,1,be,Rt),be;var _e,De=-1,Le=be-1,hn=0,rn=1,Fn=1,ln=1<<Nt;for(Wt=0,Ot=1,Ut=2;Ot<=Nt;++Ot,Ut<<=1){if(rn+=Fn<<=1,0>(Fn-=te[Ot]))return 0;for(;0<te[Ot];--te[Ot])(Rt=new T).g=Ot,Rt.value=ee[Wt++],R(St,Zt+hn,Ut,ln,Rt),hn=q(hn,Ot)}for(Ot=Nt+1,Ut=2;15>=Ot;++Ot,Ut<<=1){if(rn+=Fn<<=1,0>(Fn-=te[Ot]))return 0;for(;0<te[Ot];--te[Ot]){if(Rt=new T,(hn&Le)!=De){for(Zt+=ln,_e=1<<(De=Ot)-Nt;15>De&&!(0>=(_e-=te[De]));)++De,_e<<=1;be+=ln=1<<(_e=De-Nt),St[Ct+(De=hn&Le)].g=_e+Nt,St[Ct+De].value=Zt-Ct-De}Rt.g=Ot-Nt,Rt.value=ee[Wt++],R(St,Zt+(hn>>Nt),Ut,ln,Rt),hn=q(hn,Ot)}}return rn!=2*me[15]-1?0:be})(Y,Q,st,ht,vt,xt)}function T(){this.value=this.g=0}function L(){this.value=this.g=0}function E(){this.G=a(5,T),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Lo,L)}function x(Y,Q,st,ht){e(Y!=null),e(Q!=null),e(2147483648>ht),Y.Ca=254,Y.I=0,Y.b=-8,Y.Ka=0,Y.oa=Q,Y.pa=st,Y.Jd=Q,Y.Yc=st+ht,Y.Zc=4<=ht?st+ht-4+1:st,$(Y)}function k(Y,Q){for(var st=0;0<Q--;)st|=Z(Y,128)<<Q;return st}function A(Y,Q){var st=k(Y,Q);return z(Y)?-st:st}function C(Y,Q,st,ht){var vt,xt=0;for(e(Y!=null),e(Q!=null),e(4294967288>ht),Y.Sb=ht,Y.Ra=0,Y.u=0,Y.h=0,4<ht&&(ht=4),vt=0;vt<ht;++vt)xt+=Q[st+vt]<<8*vt;Y.Ra=xt,Y.bb=ht,Y.oa=Q,Y.pa=st}function j(Y){for(;8<=Y.u&&Y.bb<Y.Sb;)Y.Ra>>>=8,Y.Ra+=Y.oa[Y.pa+Y.bb]<<La-8>>>0,++Y.bb,Y.u-=8;et(Y)&&(Y.h=1,Y.u=0)}function B(Y,Q){if(e(0<=Q),!Y.h&&Q<=xs){var st=X(Y)&Ns[Q];return Y.u+=Q,j(Y),st}return Y.h=1,Y.u=0}function O(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function X(Y){return Y.Ra>>>(Y.u&La-1)>>>0}function et(Y){return e(Y.bb<=Y.Sb),Y.h||Y.bb==Y.Sb&&Y.u>La}function V(Y,Q){Y.u=Q,Y.h=et(Y)}function tt(Y){Y.u>=Oa&&(e(Y.u>=Oa),j(Y))}function $(Y){e(Y!=null&&Y.oa!=null),Y.pa<Y.Zc?(Y.I=(Y.oa[Y.pa++]|Y.I<<8)>>>0,Y.b+=8):(e(Y!=null&&Y.oa!=null),Y.pa<Y.Yc?(Y.b+=8,Y.I=Y.oa[Y.pa++]|Y.I<<8):Y.Ka?Y.b=0:(Y.I<<=8,Y.b+=8,Y.Ka=1))}function z(Y){return k(Y,1)}function Z(Y,Q){var st=Y.Ca;0>Y.b&&$(Y);var ht=Y.b,vt=st*Q>>>8,xt=(Y.I>>>ht>vt)+0;for(xt?(st-=vt,Y.I-=vt+1<<ht>>>0):st=vt+1,ht=st,vt=0;256<=ht;)vt+=8,ht>>=8;return ht=7^vt+eo[ht],Y.b-=ht,Y.Ca=(st<<ht)-1,xt}function it(Y,Q,st){Y[Q+0]=st>>24&255,Y[Q+1]=st>>16&255,Y[Q+2]=st>>8&255,Y[Q+3]=255&st}function mt(Y,Q){return Y[Q+0]|Y[Q+1]<<8}function lt(Y,Q){return mt(Y,Q)|Y[Q+2]<<16}function at(Y,Q){return mt(Y,Q)|mt(Y,Q+2)<<16}function rt(Y,Q){var st=1<<Q;return e(Y!=null),e(0<Q),Y.X=s(st),Y.X==null?0:(Y.Mb=32-Q,Y.Xa=Q,1)}function ct(Y,Q){e(Y!=null),e(Q!=null),e(Y.Xa==Q.Xa),r(Q.X,0,Y.X,0,1<<Q.Xa)}function ot(){this.X=[],this.Xa=this.Mb=0}function dt(Y,Q,st,ht){e(st!=null),e(ht!=null);var vt=st[0],xt=ht[0];return vt==0&&(vt=(Y*xt+Q/2)/Q),xt==0&&(xt=(Q*vt+Y/2)/Y),0>=vt||0>=xt?0:(st[0]=vt,ht[0]=xt,1)}function ft(Y,Q){return Y+(1<<Q)-1>>>Q}function gt(Y,Q){return((4278255360&Y)+(4278255360&Q)>>>0&4278255360)+((16711935&Y)+(16711935&Q)>>>0&16711935)>>>0}function wt(Y,Q){U[Q]=function(st,ht,vt,xt,St,Ct,Nt){var Rt;for(Rt=0;Rt<St;++Rt){var Ut=U[Y](Ct[Nt+Rt-1],vt,xt+Rt);Ct[Nt+Rt]=gt(st[ht+Rt],Ut)}}}function yt(){this.ud=this.hd=this.jd=0}function Et(Y,Q){return((4278124286&(Y^Q))>>>1)+(Y&Q)>>>0}function Mt(Y){return 0<=Y&&256>Y?Y:0>Y?0:255<Y?255:void 0}function qt(Y,Q){return Mt(Y+(Y-Q+.5>>1))}function Tt(Y,Q,st){return Math.abs(Q-st)-Math.abs(Y-st)}function It(Y,Q,st,ht,vt,xt,St){for(ht=xt[St-1],st=0;st<vt;++st)xt[St+st]=ht=gt(Y[Q+st],ht)}function Vt(Y,Q,st,ht,vt){var xt;for(xt=0;xt<st;++xt){var St=Y[Q+xt],Ct=St>>8&255,Nt=16711935&(Nt=(Nt=16711935&St)+((Ct<<16)+Ct));ht[vt+xt]=(4278255360&St)+Nt>>>0}}function Kt(Y,Q){Q.jd=255&Y,Q.hd=Y>>8&255,Q.ud=Y>>16&255}function ne(Y,Q,st,ht,vt,xt){var St;for(St=0;St<ht;++St){var Ct=Q[st+St],Nt=Ct>>>8,Rt=Ct,Ut=255&(Ut=(Ut=Ct>>>16)+((Y.jd<<24>>24)*(Nt<<24>>24)>>>5));Rt=255&(Rt=(Rt+=(Y.hd<<24>>24)*(Nt<<24>>24)>>>5)+((Y.ud<<24>>24)*(Ut<<24>>24)>>>5)),vt[xt+St]=(4278255360&Ct)+(Ut<<16)+Rt}}function ae(Y,Q,st,ht,vt){U[Q]=function(xt,St,Ct,Nt,Rt,Ut,ee,Ot,Wt){for(Nt=ee;Nt<Ot;++Nt)for(ee=0;ee<Wt;++ee)Rt[Ut++]=vt(Ct[ht(xt[St++])])},U[Y]=function(xt,St,Ct,Nt,Rt,Ut,ee){var Ot=8>>xt.b,Wt=xt.Ea,Zt=xt.K[0],be=xt.w;if(8>Ot)for(xt=(1<<xt.b)-1,be=(1<<Ot)-1;St<Ct;++St){var te,me=0;for(te=0;te<Wt;++te)te&xt||(me=ht(Nt[Rt++])),Ut[ee++]=vt(Zt[me&be]),me>>=Ot}else U["VP8LMapColor"+st](Nt,Rt,Zt,be,Ut,ee,St,Ct,Wt)}}function Oe(Y,Q,st,ht,vt){for(st=Q+st;Q<st;){var xt=Y[Q++];ht[vt++]=xt>>16&255,ht[vt++]=xt>>8&255,ht[vt++]=255&xt}}function le(Y,Q,st,ht,vt){for(st=Q+st;Q<st;){var xt=Y[Q++];ht[vt++]=xt>>16&255,ht[vt++]=xt>>8&255,ht[vt++]=255&xt,ht[vt++]=xt>>24&255}}function Jt(Y,Q,st,ht,vt){for(st=Q+st;Q<st;){var xt=(St=Y[Q++])>>16&240|St>>12&15,St=240&St|St>>28&15;ht[vt++]=xt,ht[vt++]=St}}function ue(Y,Q,st,ht,vt){for(st=Q+st;Q<st;){var xt=(St=Y[Q++])>>16&248|St>>13&7,St=St>>5&224|St>>3&31;ht[vt++]=xt,ht[vt++]=St}}function ge(Y,Q,st,ht,vt){for(st=Q+st;Q<st;){var xt=Y[Q++];ht[vt++]=255&xt,ht[vt++]=xt>>8&255,ht[vt++]=xt>>16&255}}function fe(Y,Q,st,ht,vt,xt){if(xt==0)for(st=Q+st;Q<st;)it(ht,((xt=Y[Q++])[0]>>24|xt[1]>>8&65280|xt[2]<<8&16711680|xt[3]<<24)>>>0),vt+=32;else r(ht,vt,Y,Q,st)}function qe(Y,Q){U[Q][0]=U[Y+"0"],U[Q][1]=U[Y+"1"],U[Q][2]=U[Y+"2"],U[Q][3]=U[Y+"3"],U[Q][4]=U[Y+"4"],U[Q][5]=U[Y+"5"],U[Q][6]=U[Y+"6"],U[Q][7]=U[Y+"7"],U[Q][8]=U[Y+"8"],U[Q][9]=U[Y+"9"],U[Q][10]=U[Y+"10"],U[Q][11]=U[Y+"11"],U[Q][12]=U[Y+"12"],U[Q][13]=U[Y+"13"],U[Q][14]=U[Y+"0"],U[Q][15]=U[Y+"0"]}function Be(Y){return Y==zu||Y==Ac||Y==Yl||Y==Cc}function ke(){this.eb=[],this.size=this.A=this.fb=0}function Je(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Fe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ke,this.f.kb=new Je,this.sd=null}function Me(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ke(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function En(Y){return alert("todo:WebPSamplerProcessPlane"),Y.T}function Xe(Y,Q){var st=Y.T,ht=Q.ba.f.RGBA,vt=ht.eb,xt=ht.fb+Y.ka*ht.A,St=os[Q.ba.S],Ct=Y.y,Nt=Y.O,Rt=Y.f,Ut=Y.N,ee=Y.ea,Ot=Y.W,Wt=Q.cc,Zt=Q.dc,be=Q.Mc,te=Q.Nc,me=Y.ka,_e=Y.ka+Y.T,De=Y.U,Le=De+1>>1;for(me==0?St(Ct,Nt,null,null,Rt,Ut,ee,Ot,Rt,Ut,ee,Ot,vt,xt,null,null,De):(St(Q.ec,Q.fc,Ct,Nt,Wt,Zt,be,te,Rt,Ut,ee,Ot,vt,xt-ht.A,vt,xt,De),++st);me+2<_e;me+=2)Wt=Rt,Zt=Ut,be=ee,te=Ot,Ut+=Y.Rc,Ot+=Y.Rc,xt+=2*ht.A,St(Ct,(Nt+=2*Y.fa)-Y.fa,Ct,Nt,Wt,Zt,be,te,Rt,Ut,ee,Ot,vt,xt-ht.A,vt,xt,De);return Nt+=Y.fa,Y.j+_e<Y.o?(r(Q.ec,Q.fc,Ct,Nt,De),r(Q.cc,Q.dc,Rt,Ut,Le),r(Q.Mc,Q.Nc,ee,Ot,Le),st--):1&_e||St(Ct,Nt,null,null,Rt,Ut,ee,Ot,Rt,Ut,ee,Ot,vt,xt+ht.A,null,null,De),st}function Sn(Y,Q,st){var ht=Y.F,vt=[Y.J];if(ht!=null){var xt=Y.U,St=Q.ba.S,Ct=St==Fu||St==Yl;Q=Q.ba.f.RGBA;var Nt=[0],Rt=Y.ka;Nt[0]=Y.T,Y.Kb&&(Rt==0?--Nt[0]:(--Rt,vt[0]-=Y.width),Y.j+Y.ka+Y.T==Y.o&&(Nt[0]=Y.o-Y.j-Rt));var Ut=Q.eb;Rt=Q.fb+Rt*Q.A,Y=Iu(ht,vt[0],Y.width,xt,Nt,Ut,Rt+(Ct?0:3),Q.A),e(st==Nt),Y&&Be(St)&&ol(Ut,Rt,Ct,xt,Nt,Q.A)}return 0}function Nn(Y){var Q=Y.ma,st=Q.ba.S,ht=11>st,vt=st==ps||st==Js||st==Fu||st==Gl||st==12||Be(st);if(Q.memory=null,Q.Ib=null,Q.Jb=null,Q.Nd=null,!to(Q.Oa,Y,vt?11:12))return 0;if(vt&&Be(st)&&Mu(),Y.da)alert("todo:use_scaling");else{if(ht){if(Q.Ib=En,Y.Kb){if(st=Y.U+1>>1,Q.memory=s(Y.U+2*st),Q.memory==null)return 0;Q.ec=Q.memory,Q.fc=0,Q.cc=Q.ec,Q.dc=Q.fc+Y.U,Q.Mc=Q.cc,Q.Nc=Q.dc+st,Q.Ib=Xe,Mu()}}else alert("todo:EmitYUV");vt&&(Q.Jb=Sn,ht&&ma())}if(ht&&!Fo){for(Y=0;256>Y;++Y)ls[Y]=89858*(Y-128)+Zl>>sa,N0[Y]=-22014*(Y-128)+Zl,yd[Y]=-45773*(Y-128),Mc[Y]=113618*(Y-128)+Zl>>sa;for(Y=fl;Y<Po;++Y)Q=76283*(Y-16)+Zl>>sa,T0[Y-fl]=Tn(Q,255),j0[Y-fl]=Tn(Q+8>>4,15);Fo=1}return 1}function Te(Y){var Q=Y.ma,st=Y.U,ht=Y.T;return e(!(1&Y.ka)),0>=st||0>=ht?0:(st=Q.Ib(Y,Q),Q.Jb!=null&&Q.Jb(Y,Q,st),Q.Dc+=st,1)}function _n(Y){Y.ma.memory=null}function Pn(Y,Q,st,ht){return B(Y,8)!=47?0:(Q[0]=B(Y,14)+1,st[0]=B(Y,14)+1,ht[0]=B(Y,1),B(Y,3)!=0?0:!Y.h)}function on(Y,Q){if(4>Y)return Y+1;var st=Y-2>>1;return(2+(1&Y)<<st)+B(Q,st)+1}function Dt(Y,Q){return 120<Q?Q-120:1<=(st=((st=ea[Q-1])>>4)*Y+(8-(15&st)))?st:1;var st}function Ht(Y,Q,st){var ht=X(st),vt=Y[Q+=255&ht].g-8;return 0<vt&&(V(st,st.u+8),ht=X(st),Q+=Y[Q].value,Q+=ht&(1<<vt)-1),V(st,st.u+Y[Q].g),Y[Q].value}function re(Y,Q,st){return st.g+=Y.g,st.value+=Y.value<<Q>>>0,e(8>=st.g),Y.g}function we(Y,Q,st){var ht=Y.xc;return e((Q=ht==0?0:Y.vc[Y.md*(st>>ht)+(Q>>ht)])<Y.Wb),Y.Ya[Q]}function nn(Y,Q,st,ht){var vt=Y.ab,xt=Y.c*Q,St=Y.C;Q=St+Q;var Ct=st,Nt=ht;for(ht=Y.Ta,st=Y.Ua;0<vt--;){var Rt=Y.gc[vt],Ut=St,ee=Q,Ot=Ct,Wt=Nt,Zt=(Nt=ht,Ct=st,Rt.Ea);switch(e(Ut<ee),e(ee<=Rt.nc),Rt.hc){case 2:Ti(Ot,Wt,(ee-Ut)*Zt,Nt,Ct);break;case 0:var be=Ut,te=ee,me=Nt,_e=Ct,De=(ln=Rt).Ea;be==0&&(Hl(Ot,Wt,null,null,1,me,_e),It(Ot,Wt+1,0,0,De-1,me,_e+1),Wt+=De,_e+=De,++be);for(var Le=1<<ln.b,hn=Le-1,rn=ft(De,ln.b),Fn=ln.K,ln=ln.w+(be>>ln.b)*rn;be<te;){var lr=Fn,ai=ln,Vn=1;for($l(Ot,Wt,me,_e-De,1,me,_e);Vn<De;){var sn=(Vn&~hn)+Le;sn>De&&(sn=De),(0,no[lr[ai++]>>8&15])(Ot,Wt+ +Vn,me,_e+Vn-De,sn-Vn,me,_e+Vn),Vn=sn}Wt+=De,_e+=De,++be&hn||(ln+=rn)}ee!=Rt.nc&&r(Nt,Ct-Zt,Nt,Ct+(ee-Ut-1)*Zt,Zt);break;case 1:for(Zt=Ot,te=Wt,De=(Ot=Rt.Ea)-(_e=Ot&~(me=(Wt=1<<Rt.b)-1)),be=ft(Ot,Rt.b),Le=Rt.K,Rt=Rt.w+(Ut>>Rt.b)*be;Ut<ee;){for(hn=Le,rn=Rt,Fn=new yt,ln=te+_e,lr=te+Ot;te<ln;)Kt(hn[rn++],Fn),Vl(Fn,Zt,te,Wt,Nt,Ct),te+=Wt,Ct+=Wt;te<lr&&(Kt(hn[rn++],Fn),Vl(Fn,Zt,te,De,Nt,Ct),te+=De,Ct+=De),++Ut&me||(Rt+=be)}break;case 3:if(Ot==Nt&&Wt==Ct&&0<Rt.b){for(te=Nt,Ot=Zt=Ct+(ee-Ut)*Zt-(_e=(ee-Ut)*ft(Rt.Ea,Rt.b)),Wt=Nt,me=Ct,be=[],_e=(De=_e)-1;0<=_e;--_e)be[_e]=Wt[me+_e];for(_e=De-1;0<=_e;--_e)te[Ot+_e]=be[_e];wc(Rt,Ut,ee,Nt,Zt,Nt,Ct)}else wc(Rt,Ut,ee,Ot,Wt,Nt,Ct)}Ct=ht,Nt=st}Nt!=st&&r(ht,st,Ct,Nt,xt)}function Ie(Y,Q){var st=Y.V,ht=Y.Ba+Y.c*Y.C,vt=Q-Y.C;if(e(Q<=Y.l.o),e(16>=vt),0<vt){var xt=Y.l,St=Y.Ta,Ct=Y.Ua,Nt=xt.width;if(nn(Y,vt,st,ht),vt=Ct=[Ct],e((st=Y.C)<(ht=Q)),e(xt.v<xt.va),ht>xt.o&&(ht=xt.o),st<xt.j){var Rt=xt.j-st;st=xt.j,vt[0]+=Rt*Nt}if(st>=ht?st=0:(vt[0]+=4*xt.v,xt.ka=st-xt.j,xt.U=xt.va-xt.v,xt.T=ht-st,st=1),st){if(Ct=Ct[0],11>(st=Y.ca).S){var Ut=st.f.RGBA,ee=(ht=st.S,vt=xt.U,xt=xt.T,Rt=Ut.eb,Ut.A),Ot=xt;for(Ut=Ut.fb+Y.Ma*Ut.A;0<Ot--;){var Wt=St,Zt=Ct,be=vt,te=Rt,me=Ut;switch(ht){case _c:Wl(Wt,Zt,be,te,me);break;case ps:ro(Wt,Zt,be,te,me);break;case zu:ro(Wt,Zt,be,te,me),ol(te,me,0,be,1,0);break;case kc:sl(Wt,Zt,be,te,me);break;case Js:fe(Wt,Zt,be,te,me,1);break;case Ac:fe(Wt,Zt,be,te,me,1),ol(te,me,0,be,1,0);break;case Fu:fe(Wt,Zt,be,te,me,0);break;case Yl:fe(Wt,Zt,be,te,me,0),ol(te,me,1,be,1,0);break;case Gl:io(Wt,Zt,be,te,me);break;case Cc:io(Wt,Zt,be,te,me),Qs(te,me,be,1,0);break;case Oo:Da(Wt,Zt,be,te,me);break;default:e(0)}Ct+=Nt,Ut+=ee}Y.Ma+=xt}else alert("todo:EmitRescaledRowsYUVA");e(Y.Ma<=st.height)}}Y.C=Q,e(Y.C<=Y.i)}function Ue(Y){var Q;if(0<Y.ua)return 0;for(Q=0;Q<Y.Wb;++Q){var st=Y.Ya[Q].G,ht=Y.Ya[Q].H;if(0<st[1][ht[1]+0].g||0<st[2][ht[2]+0].g||0<st[3][ht[3]+0].g)return 0}return 1}function He(Y,Q,st,ht,vt,xt){if(Y.Z!=0){var St=Y.qd,Ct=Y.rd;for(e(oo[Y.Z]!=null);Q<st;++Q)oo[Y.Z](St,Ct,ht,vt,ht,vt,xt),St=ht,Ct=vt,vt+=xt;Y.qd=St,Y.rd=Ct}}function Ge(Y,Q){var st=Y.l.ma,ht=st.Z==0||st.Z==1?Y.l.j:Y.C;if(ht=Y.C<ht?ht:Y.C,e(Q<=Y.l.o),Q>ht){var vt=Y.l.width,xt=st.ca,St=st.tb+vt*ht,Ct=Y.V,Nt=Y.Ba+Y.c*ht,Rt=Y.gc;e(Y.ab==1),e(Rt[0].hc==3),Ia(Rt[0],ht,Q,Ct,Nt,xt,St),He(st,ht,Q,xt,St,vt)}Y.C=Y.Ma=Q}function Ve(Y,Q,st,ht,vt,xt,St){var Ct=Y.$/ht,Nt=Y.$%ht,Rt=Y.m,Ut=Y.s,ee=st+Y.$,Ot=ee;vt=st+ht*vt;var Wt=st+ht*xt,Zt=280+Ut.ua,be=Y.Pb?Ct:16777216,te=0<Ut.ua?Ut.Wa:null,me=Ut.wc,_e=ee<Wt?we(Ut,Nt,Ct):null;e(Y.C<xt),e(Wt<=vt);var De=!1;t:for(;;){for(;De||ee<Wt;){var Le=0;if(Ct>=be){var hn=ee-st;e((be=Y).Pb),be.wd=be.m,be.xd=hn,0<be.s.ua&&ct(be.s.Wa,be.s.vb),be=Ct+Ro}if(Nt&me||(_e=we(Ut,Nt,Ct)),e(_e!=null),_e.Qb&&(Q[ee]=_e.qb,De=!0),!De)if(tt(Rt),_e.jc){Le=Rt,hn=Q;var rn=ee,Fn=_e.pd[X(Le)&Lo-1];e(_e.jc),256>Fn.g?(V(Le,Le.u+Fn.g),hn[rn]=Fn.value,Le=0):(V(Le,Le.u+Fn.g-256),e(256<=Fn.value),Le=Fn.value),Le==0&&(De=!0)}else Le=Ht(_e.G[0],_e.H[0],Rt);if(Rt.h)break;if(De||256>Le){if(!De)if(_e.nd)Q[ee]=(_e.qb|Le<<8)>>>0;else{if(tt(Rt),De=Ht(_e.G[1],_e.H[1],Rt),tt(Rt),hn=Ht(_e.G[2],_e.H[2],Rt),rn=Ht(_e.G[3],_e.H[3],Rt),Rt.h)break;Q[ee]=(rn<<24|De<<16|Le<<8|hn)>>>0}if(De=!1,++ee,++Nt>=ht&&(Nt=0,++Ct,St!=null&&Ct<=xt&&!(Ct%16)&&St(Y,Ct),te!=null))for(;Ot<ee;)Le=Q[Ot++],te.X[(506832829*Le&4294967295)>>>te.Mb]=Le}else if(280>Le){if(Le=on(Le-256,Rt),hn=Ht(_e.G[4],_e.H[4],Rt),tt(Rt),hn=Dt(ht,hn=on(hn,Rt)),Rt.h)break;if(ee-st<hn||vt-ee<Le)break t;for(rn=0;rn<Le;++rn)Q[ee+rn]=Q[ee+rn-hn];for(ee+=Le,Nt+=Le;Nt>=ht;)Nt-=ht,++Ct,St!=null&&Ct<=xt&&!(Ct%16)&&St(Y,Ct);if(e(ee<=vt),Nt&me&&(_e=we(Ut,Nt,Ct)),te!=null)for(;Ot<ee;)Le=Q[Ot++],te.X[(506832829*Le&4294967295)>>>te.Mb]=Le}else{if(!(Le<Zt))break t;for(De=Le-280,e(te!=null);Ot<ee;)Le=Q[Ot++],te.X[(506832829*Le&4294967295)>>>te.Mb]=Le;Le=ee,e(!(De>>>(hn=te).Xa)),Q[Le]=hn.X[De],De=!0}De||e(Rt.h==et(Rt))}if(Y.Pb&&Rt.h&&ee<vt)e(Y.m.h),Y.a=5,Y.m=Y.wd,Y.$=Y.xd,0<Y.s.ua&&ct(Y.s.vb,Y.s.Wa);else{if(Rt.h)break t;St?.(Y,Ct>xt?xt:Ct),Y.a=0,Y.$=ee-st}return 1}return Y.a=3,0}function an(Y){e(Y!=null),Y.vc=null,Y.yc=null,Y.Ya=null;var Q=Y.Wa;Q!=null&&(Q.X=null),Y.vb=null,e(Y!=null)}function kn(){var Y=new Dn;return Y==null?null:(Y.a=0,Y.xb=Ff,qe("Predictor","VP8LPredictors"),qe("Predictor","VP8LPredictors_C"),qe("PredictorAdd","VP8LPredictorsAdd"),qe("PredictorAdd","VP8LPredictorsAdd_C"),Ti=Vt,Vl=ne,Wl=Oe,ro=le,io=Jt,Da=ue,sl=ge,U.VP8LMapColor32b=Ra,U.VP8LMapColor8b=is,Y)}function qn(Y,Q,st,ht,vt){var xt=1,St=[Y],Ct=[Q],Nt=ht.m,Rt=ht.s,Ut=null,ee=0;t:for(;;){if(st)for(;xt&&B(Nt,1);){var Ot=St,Wt=Ct,Zt=ht,be=1,te=Zt.m,me=Zt.gc[Zt.ab],_e=B(te,2);if(Zt.Oc&1<<_e)xt=0;else{switch(Zt.Oc|=1<<_e,me.hc=_e,me.Ea=Ot[0],me.nc=Wt[0],me.K=[null],++Zt.ab,e(4>=Zt.ab),_e){case 0:case 1:me.b=B(te,3)+2,be=qn(ft(me.Ea,me.b),ft(me.nc,me.b),0,Zt,me.K),me.K=me.K[0];break;case 3:var De,Le=B(te,8)+1,hn=16<Le?0:4<Le?1:2<Le?2:3;if(Ot[0]=ft(me.Ea,hn),me.b=hn,De=be=qn(Le,1,0,Zt,me.K)){var rn,Fn=Le,ln=me,lr=1<<(8>>ln.b),ai=s(lr);if(ai==null)De=0;else{var Vn=ln.K[0],sn=ln.w;for(ai[0]=ln.K[0][0],rn=1;rn<1*Fn;++rn)ai[rn]=gt(Vn[sn+rn],ai[rn-1]);for(;rn<4*lr;++rn)ai[rn]=0;ln.K[0]=null,ln.K[0]=ai,De=1}}be=De;break;case 2:break;default:e(0)}xt=be}}if(St=St[0],Ct=Ct[0],xt&&B(Nt,1)&&!(xt=1<=(ee=B(Nt,4))&&11>=ee)){ht.a=3;break t}var We;if(We=xt)e:{var mi,Ln,Xn,Pr=ht,Hi=St,us=Ct,Jr=ee,Ri=st,ms=Pr.m,Ii=Pr.s,rr=[null],_r=1,gi=0,Tr=na[Jr];n:for(;;){if(Ri&&B(ms,1)){var $i=B(ms,3)+2,bi=ft(Hi,$i),kr=ft(us,$i),Li=bi*kr;if(!qn(bi,kr,0,Pr,rr))break n;for(rr=rr[0],Ii.xc=$i,mi=0;mi<Li;++mi){var Fr=rr[mi]>>8&65535;rr[mi]=Fr,Fr>=_r&&(_r=Fr+1)}}if(ms.h)break n;for(Ln=0;5>Ln;++Ln){var Di=ul[Ln];!Ln&&0<Jr&&(Di+=1<<Jr),gi<Di&&(gi=Di)}var Bi=a(_r*Tr,T),Vr=_r,xr=a(Vr,E);if(xr==null)var gs=null;else e(65536>=Vr),gs=xr;var ki=s(gi);if(gs==null||ki==null||Bi==null){Pr.a=1;break n}var Cn=Bi;for(mi=Xn=0;mi<_r;++mi){var jn=gs[mi],Ar=jn.G,Ts=jn.H,aa=0,_s=1,Pi=0;for(Ln=0;5>Ln;++Ln){Di=ul[Ln],Ar[Ln]=Cn,Ts[Ln]=Xn,!Ln&&0<Jr&&(Di+=1<<Jr);i:{var zo,qo=Di,Oc=Pr,ti=ki,qf=Cn,Uf=Xn,Rc=0,lo=Oc.m,M0=B(lo,1);if(o(ti,0,0,qo),M0){var Hf=B(lo,1)+1,$f=B(lo,1),Ic=B(lo,$f==0?1:8);ti[Ic]=1,Hf==2&&(ti[Ic=B(lo,8)]=1);var Qi=1}else{var Ai=s(19),$u=B(lo,4)+4;if(19<$u){Oc.a=3;var Uo=0;break i}for(zo=0;zo<$u;++zo)Ai[qu[zo]]=B(lo,3);var Jl=void 0,hl=void 0,Fa=Oc,Dc=Ai,tu=qo,Bc=ti,Pc=0,uo=Fa.m,Vf=8,Wf=a(128,T);r:for(;I(Wf,0,7,Dc,19);){if(B(uo,1)){var vd=2+2*B(uo,3);if((Jl=2+B(uo,vd))>tu)break r}else Jl=tu;for(hl=0;hl<tu&&Jl--;){tt(uo);var Gf=Wf[0+(127&X(uo))];V(uo,uo.u+Gf.g);var Ho=Gf.value;if(16>Ho)Bc[hl++]=Ho,Ho!=0&&(Vf=Ho);else{var wd=Ho==16,xd=Ho-16,Sd=Xl[xd],Yf=B(uo,ta[xd])+Sd;if(hl+Yf>tu)break r;for(var _d=wd?Vf:0;0<Yf--;)Bc[hl++]=_d}}Pc=1;break r}Pc||(Fa.a=3),Qi=Pc}(Qi=Qi&&!lo.h)&&(Rc=I(qf,Uf,8,ti,qo)),Qi&&Rc!=0?Uo=Rc:(Oc.a=3,Uo=0)}if(Uo==0)break n;if(_s&&Ec[Ln]==1&&(_s=Cn[Xn].g==0),aa+=Cn[Xn].g,Xn+=Uo,3>=Ln){var dl,Fc=ki[0];for(dl=1;dl<Di;++dl)ki[dl]>Fc&&(Fc=ki[dl]);Pi+=Fc}}if(jn.nd=_s,jn.Qb=0,_s&&(jn.qb=(Ar[3][Ts[3]+0].value<<24|Ar[1][Ts[1]+0].value<<16|Ar[2][Ts[2]+0].value)>>>0,aa==0&&256>Ar[0][Ts[0]+0].value&&(jn.Qb=1,jn.qb+=Ar[0][Ts[0]+0].value<<8)),jn.jc=!jn.Qb&&6>Pi,jn.jc){var Vu,za=jn;for(Vu=0;Vu<Lo;++Vu){var co=Vu,fo=za.pd[co],zc=za.G[0][za.H[0]+co];256<=zc.value?(fo.g=zc.g+256,fo.value=zc.value):(fo.g=0,fo.value=0,co>>=re(zc,8,fo),co>>=re(za.G[1][za.H[1]+co],16,fo),co>>=re(za.G[2][za.H[2]+co],0,fo),re(za.G[3][za.H[3]+co],24,fo))}}}Ii.vc=rr,Ii.Wb=_r,Ii.Ya=gs,Ii.yc=Bi,We=1;break e}We=0}if(!(xt=We)){ht.a=3;break t}if(0<ee){if(Rt.ua=1<<ee,!rt(Rt.Wa,ee)){ht.a=1,xt=0;break t}}else Rt.ua=0;var qc=ht,pl=St,kd=Ct,eu=qc.s,nu=eu.xc;if(qc.c=pl,qc.i=kd,eu.md=ft(pl,nu),eu.wc=nu==0?-1:(1<<nu)-1,st){ht.xb=Io;break t}if((Ut=s(St*Ct))==null){ht.a=1,xt=0;break t}xt=(xt=Ve(ht,Ut,0,St,Ct,Ct,null))&&!Nt.h;break t}return xt?(vt!=null?vt[0]=Ut:(e(Ut==null),e(st)),ht.$=0,st||an(Rt)):an(Rt),xt}function Qt(Y,Q){var st=Y.c*Y.i,ht=st+Q+16*Q;return e(Y.c<=Q),Y.V=s(ht),Y.V==null?(Y.Ta=null,Y.Ua=0,Y.a=1,0):(Y.Ta=Y.V,Y.Ua=Y.Ba+st+Q,1)}function de(Y,Q){var st=Y.C,ht=Q-st,vt=Y.V,xt=Y.Ba+Y.c*st;for(e(Q<=Y.l.o);0<ht;){var St=16<ht?16:ht,Ct=Y.l.ma,Nt=Y.l.width,Rt=Nt*St,Ut=Ct.ca,ee=Ct.tb+Nt*st,Ot=Y.Ta,Wt=Y.Ua;nn(Y,St,vt,xt),Hs(Ot,Wt,Ut,ee,Rt),He(Ct,st,st+St,Ut,ee,Nt),ht-=St,vt+=St*Y.c,st+=St}e(st==Q),Y.C=Y.Ma=Q}function Ee(){this.ub=this.yd=this.td=this.Rb=0}function Pe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function _t(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Bt(){this.Yb=(function(){var Y=[];return(function Q(st,ht,vt){for(var xt=vt[ht],St=0;St<xt&&(st.push(vt.length>ht+1?[]:0),!(vt.length<ht+1));St++)Q(st[St],ht+1,vt)})(Y,0,[3,11]),Y})()}function Gt(){this.jb=s(3),this.Wc=u([4,8],Bt),this.Xc=u([4,17],Bt)}function pe(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Ne(){this.ld=this.La=this.dd=this.tc=0}function ye(){this.Na=this.la=0}function xe(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function mn(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function $e(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ne),this.Y=0,this.ya=Array(new mn),this.aa=0,this.l=new Bn}function vn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Ze(){this.cb=this.a=0,this.sc="",this.m=new O,this.Od=new Ee,this.Kc=new Pe,this.ed=new pe,this.Qa=new _t,this.Ic=this.$c=this.Aa=0,this.D=new $e,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,O),this.ia=0,this.pb=a(4,xe),this.Pa=new Gt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new vn),this.Hd=0,this.rb=Array(new ye),this.sb=0,this.wa=Array(new Ne),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new mn),this.L=this.aa=0,this.gd=u([4,2],Ne),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Tn(Y,Q){return 0>Y?0:Y>Q?Q:Y}function Bn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function In(){var Y=new Ze;return Y!=null&&(Y.a=0,Y.sc="OK",Y.cb=0,Y.Xb=0,$s||($s=Dr)),Y}function Qe(Y,Q,st){return Y.a==0&&(Y.a=Q,Y.sc=st,Y.cb=0),0}function mr(Y,Q,st){return 3<=st&&Y[Q+0]==157&&Y[Q+1]==1&&Y[Q+2]==42}function sr(Y,Q){if(Y==null)return 0;if(Y.a=0,Y.sc="OK",Q==null)return Qe(Y,2,"null VP8Io passed to VP8GetHeaders()");var st=Q.data,ht=Q.w,vt=Q.ha;if(4>vt)return Qe(Y,7,"Truncated header.");var xt=st[ht+0]|st[ht+1]<<8|st[ht+2]<<16,St=Y.Od;if(St.Rb=!(1&xt),St.td=xt>>1&7,St.yd=xt>>4&1,St.ub=xt>>5,3<St.td)return Qe(Y,3,"Incorrect keyframe parameters.");if(!St.yd)return Qe(Y,4,"Frame not displayable.");ht+=3,vt-=3;var Ct=Y.Kc;if(St.Rb){if(7>vt)return Qe(Y,7,"cannot parse picture header");if(!mr(st,ht,vt))return Qe(Y,3,"Bad code word");Ct.c=16383&(st[ht+4]<<8|st[ht+3]),Ct.Td=st[ht+4]>>6,Ct.i=16383&(st[ht+6]<<8|st[ht+5]),Ct.Ud=st[ht+6]>>6,ht+=7,vt-=7,Y.za=Ct.c+15>>4,Y.Ub=Ct.i+15>>4,Q.width=Ct.c,Q.height=Ct.i,Q.Da=0,Q.j=0,Q.v=0,Q.va=Q.width,Q.o=Q.height,Q.da=0,Q.ib=Q.width,Q.hb=Q.height,Q.U=Q.width,Q.T=Q.height,o((xt=Y.Pa).jb,0,255,xt.jb.length),e((xt=Y.Qa)!=null),xt.Cb=0,xt.Bb=0,xt.Fb=1,o(xt.Zb,0,0,xt.Zb.length),o(xt.Lb,0,0,xt.Lb)}if(St.ub>vt)return Qe(Y,7,"bad partition length");x(xt=Y.m,st,ht,St.ub),ht+=St.ub,vt-=St.ub,St.Rb&&(Ct.Ld=z(xt),Ct.Kd=z(xt)),Ct=Y.Qa;var Nt,Rt=Y.Pa;if(e(xt!=null),e(Ct!=null),Ct.Cb=z(xt),Ct.Cb){if(Ct.Bb=z(xt),z(xt)){for(Ct.Fb=z(xt),Nt=0;4>Nt;++Nt)Ct.Zb[Nt]=z(xt)?A(xt,7):0;for(Nt=0;4>Nt;++Nt)Ct.Lb[Nt]=z(xt)?A(xt,6):0}if(Ct.Bb)for(Nt=0;3>Nt;++Nt)Rt.jb[Nt]=z(xt)?k(xt,8):255}else Ct.Bb=0;if(xt.Ka)return Qe(Y,3,"cannot parse segment header");if((Ct=Y.ed).zd=z(xt),Ct.Tb=k(xt,6),Ct.wb=k(xt,3),Ct.Pc=z(xt),Ct.Pc&&z(xt)){for(Rt=0;4>Rt;++Rt)z(xt)&&(Ct.vd[Rt]=A(xt,6));for(Rt=0;4>Rt;++Rt)z(xt)&&(Ct.od[Rt]=A(xt,6))}if(Y.L=Ct.Tb==0?0:Ct.zd?1:2,xt.Ka)return Qe(Y,3,"cannot parse filter header");var Ut=vt;if(vt=Nt=ht,ht=Nt+Ut,Ct=Ut,Y.Xb=(1<<k(Y.m,2))-1,Ut<3*(Rt=Y.Xb))st=7;else{for(Nt+=3*Rt,Ct-=3*Rt,Ut=0;Ut<Rt;++Ut){var ee=st[vt+0]|st[vt+1]<<8|st[vt+2]<<16;ee>Ct&&(ee=Ct),x(Y.Jc[+Ut],st,Nt,ee),Nt+=ee,Ct-=ee,vt+=3}x(Y.Jc[+Rt],st,Nt,Ct),st=Nt<ht?0:5}if(st!=0)return Qe(Y,st,"cannot parse partitions");for(st=k(Nt=Y.m,7),vt=z(Nt)?A(Nt,4):0,ht=z(Nt)?A(Nt,4):0,Ct=z(Nt)?A(Nt,4):0,Rt=z(Nt)?A(Nt,4):0,Nt=z(Nt)?A(Nt,4):0,Ut=Y.Qa,ee=0;4>ee;++ee){if(Ut.Cb){var Ot=Ut.Zb[ee];Ut.Fb||(Ot+=st)}else{if(0<ee){Y.pb[ee]=Y.pb[0];continue}Ot=st}var Wt=Y.pb[ee];Wt.Sc[0]=ra[Tn(Ot+vt,127)],Wt.Sc[1]=ia[Tn(Ot+0,127)],Wt.Eb[0]=2*ra[Tn(Ot+ht,127)],Wt.Eb[1]=101581*ia[Tn(Ot+Ct,127)]>>16,8>Wt.Eb[1]&&(Wt.Eb[1]=8),Wt.Qc[0]=ra[Tn(Ot+Rt,117)],Wt.Qc[1]=ia[Tn(Ot+Nt,127)],Wt.lc=Ot+Nt}if(!St.Rb)return Qe(Y,4,"Not a key frame.");for(z(xt),St=Y.Pa,st=0;4>st;++st){for(vt=0;8>vt;++vt)for(ht=0;3>ht;++ht)for(Ct=0;11>Ct;++Ct)Rt=Z(xt,si[st][vt][ht][Ct])?k(xt,8):bd[st][vt][ht][Ct],St.Wc[st][vt].Yb[ht][Ct]=Rt;for(vt=0;17>vt;++vt)St.Xc[st][vt]=St.Wc[st][fr[vt]]}return Y.kc=z(xt),Y.kc&&(Y.Bd=k(xt,8)),Y.cb=1}function Dr(Y,Q,st,ht,vt,xt,St){var Ct=Q[vt].Yb[st];for(st=0;16>vt;++vt){if(!Z(Y,Ct[st+0]))return vt;for(;!Z(Y,Ct[st+1]);)if(Ct=Q[++vt].Yb[0],st=0,vt==16)return 16;var Nt=Q[vt+1].Yb;if(Z(Y,Ct[st+2])){var Rt=Y,Ut=0;if(Z(Rt,(Ot=Ct)[(ee=st)+3]))if(Z(Rt,Ot[ee+6])){for(Ct=0,ee=2*(Ut=Z(Rt,Ot[ee+8]))+(Ot=Z(Rt,Ot[ee+9+Ut])),Ut=0,Ot=gd[ee];Ot[Ct];++Ct)Ut+=Ut+Z(Rt,Ot[Ct]);Ut+=3+(8<<ee)}else Z(Rt,Ot[ee+7])?(Ut=7+2*Z(Rt,165),Ut+=Z(Rt,145)):Ut=5+Z(Rt,159);else Ut=Z(Rt,Ot[ee+4])?3+Z(Rt,Ot[ee+5]):2;Ct=Nt[2]}else Ut=1,Ct=Nt[1];Nt=St+Pf[vt],0>(Rt=Y).b&&$(Rt);var ee,Ot=Rt.b,Wt=(ee=Rt.Ca>>1)-(Rt.I>>Ot)>>31;--Rt.b,Rt.Ca+=Wt,Rt.Ca|=1,Rt.I-=(ee+1&Wt)<<Ot,xt[Nt]=((Ut^Wt)-Wt)*ht[(0<vt)+0]}return 16}function xi(Y){var Q=Y.rb[Y.sb-1];Q.la=0,Q.Na=0,o(Y.zc,0,0,Y.zc.length),Y.ja=0}function ir(Y,Q,st,ht,vt){vt=Y[Q+st+32*ht]+(vt>>3),Y[Q+st+32*ht]=-256&vt?0>vt?0:255:vt}function yr(Y,Q,st,ht,vt,xt){ir(Y,Q,0,st,ht+vt),ir(Y,Q,1,st,ht+xt),ir(Y,Q,2,st,ht-xt),ir(Y,Q,3,st,ht-vt)}function ur(Y){return(20091*Y>>16)+Y}function Un(Y,Q,st,ht){var vt,xt=0,St=s(16);for(vt=0;4>vt;++vt){var Ct=Y[Q+0]+Y[Q+8],Nt=Y[Q+0]-Y[Q+8],Rt=(35468*Y[Q+4]>>16)-ur(Y[Q+12]),Ut=ur(Y[Q+4])+(35468*Y[Q+12]>>16);St[xt+0]=Ct+Ut,St[xt+1]=Nt+Rt,St[xt+2]=Nt-Rt,St[xt+3]=Ct-Ut,xt+=4,Q++}for(vt=xt=0;4>vt;++vt)Ct=(Y=St[xt+0]+4)+St[xt+8],Nt=Y-St[xt+8],Rt=(35468*St[xt+4]>>16)-ur(St[xt+12]),ir(st,ht,0,0,Ct+(Ut=ur(St[xt+4])+(35468*St[xt+12]>>16))),ir(st,ht,1,0,Nt+Rt),ir(st,ht,2,0,Nt-Rt),ir(st,ht,3,0,Ct-Ut),xt++,ht+=32}function tn(Y,Q,st,ht){var vt=Y[Q+0]+4,xt=35468*Y[Q+4]>>16,St=ur(Y[Q+4]),Ct=35468*Y[Q+1]>>16;yr(st,ht,0,vt+St,Y=ur(Y[Q+1]),Ct),yr(st,ht,1,vt+xt,Y,Ct),yr(st,ht,2,vt-xt,Y,Ct),yr(st,ht,3,vt-St,Y,Ct)}function ar(Y,Q,st,ht,vt){Un(Y,Q,st,ht),vt&&Un(Y,Q+16,st,ht+4)}function tr(Y,Q,st,ht){so(Y,Q+0,st,ht,1),so(Y,Q+32,st,ht+128,1)}function Ur(Y,Q,st,ht){var vt;for(Y=Y[Q+0]+4,vt=0;4>vt;++vt)for(Q=0;4>Q;++Q)ir(st,ht,Q,vt,Y)}function Kn(Y,Q,st,ht){Y[Q+0]&&Nr(Y,Q+0,st,ht),Y[Q+16]&&Nr(Y,Q+16,st,ht+4),Y[Q+32]&&Nr(Y,Q+32,st,ht+128),Y[Q+48]&&Nr(Y,Q+48,st,ht+128+4)}function Zn(Y,Q,st,ht){var vt,xt=s(16);for(vt=0;4>vt;++vt){var St=Y[Q+0+vt]+Y[Q+12+vt],Ct=Y[Q+4+vt]+Y[Q+8+vt],Nt=Y[Q+4+vt]-Y[Q+8+vt],Rt=Y[Q+0+vt]-Y[Q+12+vt];xt[0+vt]=St+Ct,xt[8+vt]=St-Ct,xt[4+vt]=Rt+Nt,xt[12+vt]=Rt-Nt}for(vt=0;4>vt;++vt)St=(Y=xt[0+4*vt]+3)+xt[3+4*vt],Ct=xt[1+4*vt]+xt[2+4*vt],Nt=xt[1+4*vt]-xt[2+4*vt],Rt=Y-xt[3+4*vt],st[ht+0]=St+Ct>>3,st[ht+16]=Rt+Nt>>3,st[ht+32]=St-Ct>>3,st[ht+48]=Rt-Nt>>3,ht+=64}function cr(Y,Q,st){var ht,vt=Q-32,xt=ds,St=255-Y[vt-1];for(ht=0;ht<st;++ht){var Ct,Nt=xt,Rt=St+Y[Q-1];for(Ct=0;Ct<st;++Ct)Y[Q+Ct]=Nt[Rt+Y[vt+Ct]];Q+=32}}function ri(Y,Q){cr(Y,Q,4)}function or(Y,Q){cr(Y,Q,8)}function Mr(Y,Q){cr(Y,Q,16)}function Sr(Y,Q){var st;for(st=0;16>st;++st)r(Y,Q+32*st,Y,Q-32,16)}function Hr(Y,Q){var st;for(st=16;0<st;--st)o(Y,Q,Y[Q-1],16),Q+=32}function Br(Y,Q,st){var ht;for(ht=0;16>ht;++ht)o(Q,st+32*ht,Y,16)}function hi(Y,Q){var st,ht=16;for(st=0;16>st;++st)ht+=Y[Q-1+32*st]+Y[Q+st-32];Br(ht>>5,Y,Q)}function Lr(Y,Q){var st,ht=8;for(st=0;16>st;++st)ht+=Y[Q-1+32*st];Br(ht>>4,Y,Q)}function ns(Y,Q){var st,ht=8;for(st=0;16>st;++st)ht+=Y[Q+st-32];Br(ht>>4,Y,Q)}function fs(Y,Q){Br(128,Y,Q)}function fn(Y,Q,st){return Y+2*Q+st+2>>2}function vs(Y,Q){var st,ht=Q-32;for(ht=new Uint8Array([fn(Y[ht-1],Y[ht+0],Y[ht+1]),fn(Y[ht+0],Y[ht+1],Y[ht+2]),fn(Y[ht+1],Y[ht+2],Y[ht+3]),fn(Y[ht+2],Y[ht+3],Y[ht+4])]),st=0;4>st;++st)r(Y,Q+32*st,ht,0,ht.length)}function Xs(Y,Q){var st=Y[Q-1],ht=Y[Q-1+32],vt=Y[Q-1+64],xt=Y[Q-1+96];it(Y,Q+0,16843009*fn(Y[Q-1-32],st,ht)),it(Y,Q+32,16843009*fn(st,ht,vt)),it(Y,Q+64,16843009*fn(ht,vt,xt)),it(Y,Q+96,16843009*fn(vt,xt,xt))}function No(Y,Q){var st,ht=4;for(st=0;4>st;++st)ht+=Y[Q+st-32]+Y[Q-1+32*st];for(ht>>=3,st=0;4>st;++st)o(Y,Q+32*st,ht,4)}function Yi(Y,Q){var st=Y[Q-1+0],ht=Y[Q-1+32],vt=Y[Q-1+64],xt=Y[Q-1-32],St=Y[Q+0-32],Ct=Y[Q+1-32],Nt=Y[Q+2-32],Rt=Y[Q+3-32];Y[Q+0+96]=fn(ht,vt,Y[Q-1+96]),Y[Q+1+96]=Y[Q+0+64]=fn(st,ht,vt),Y[Q+2+96]=Y[Q+1+64]=Y[Q+0+32]=fn(xt,st,ht),Y[Q+3+96]=Y[Q+2+64]=Y[Q+1+32]=Y[Q+0+0]=fn(St,xt,st),Y[Q+3+64]=Y[Q+2+32]=Y[Q+1+0]=fn(Ct,St,xt),Y[Q+3+32]=Y[Q+2+0]=fn(Nt,Ct,St),Y[Q+3+0]=fn(Rt,Nt,Ct)}function di(Y,Q){var st=Y[Q+1-32],ht=Y[Q+2-32],vt=Y[Q+3-32],xt=Y[Q+4-32],St=Y[Q+5-32],Ct=Y[Q+6-32],Nt=Y[Q+7-32];Y[Q+0+0]=fn(Y[Q+0-32],st,ht),Y[Q+1+0]=Y[Q+0+32]=fn(st,ht,vt),Y[Q+2+0]=Y[Q+1+32]=Y[Q+0+64]=fn(ht,vt,xt),Y[Q+3+0]=Y[Q+2+32]=Y[Q+1+64]=Y[Q+0+96]=fn(vt,xt,St),Y[Q+3+32]=Y[Q+2+64]=Y[Q+1+96]=fn(xt,St,Ct),Y[Q+3+64]=Y[Q+2+96]=fn(St,Ct,Nt),Y[Q+3+96]=fn(Ct,Nt,Nt)}function Ta(Y,Q){var st=Y[Q-1+0],ht=Y[Q-1+32],vt=Y[Q-1+64],xt=Y[Q-1-32],St=Y[Q+0-32],Ct=Y[Q+1-32],Nt=Y[Q+2-32],Rt=Y[Q+3-32];Y[Q+0+0]=Y[Q+1+64]=xt+St+1>>1,Y[Q+1+0]=Y[Q+2+64]=St+Ct+1>>1,Y[Q+2+0]=Y[Q+3+64]=Ct+Nt+1>>1,Y[Q+3+0]=Nt+Rt+1>>1,Y[Q+0+96]=fn(vt,ht,st),Y[Q+0+64]=fn(ht,st,xt),Y[Q+0+32]=Y[Q+1+96]=fn(st,xt,St),Y[Q+1+32]=Y[Q+2+96]=fn(xt,St,Ct),Y[Q+2+32]=Y[Q+3+96]=fn(St,Ct,Nt),Y[Q+3+32]=fn(Ct,Nt,Rt)}function Xi(Y,Q){var st=Y[Q+0-32],ht=Y[Q+1-32],vt=Y[Q+2-32],xt=Y[Q+3-32],St=Y[Q+4-32],Ct=Y[Q+5-32],Nt=Y[Q+6-32],Rt=Y[Q+7-32];Y[Q+0+0]=st+ht+1>>1,Y[Q+1+0]=Y[Q+0+64]=ht+vt+1>>1,Y[Q+2+0]=Y[Q+1+64]=vt+xt+1>>1,Y[Q+3+0]=Y[Q+2+64]=xt+St+1>>1,Y[Q+0+32]=fn(st,ht,vt),Y[Q+1+32]=Y[Q+0+96]=fn(ht,vt,xt),Y[Q+2+32]=Y[Q+1+96]=fn(vt,xt,St),Y[Q+3+32]=Y[Q+2+96]=fn(xt,St,Ct),Y[Q+3+64]=fn(St,Ct,Nt),Y[Q+3+96]=fn(Ct,Nt,Rt)}function Ki(Y,Q){var st=Y[Q-1+0],ht=Y[Q-1+32],vt=Y[Q-1+64],xt=Y[Q-1+96];Y[Q+0+0]=st+ht+1>>1,Y[Q+2+0]=Y[Q+0+32]=ht+vt+1>>1,Y[Q+2+32]=Y[Q+0+64]=vt+xt+1>>1,Y[Q+1+0]=fn(st,ht,vt),Y[Q+3+0]=Y[Q+1+32]=fn(ht,vt,xt),Y[Q+3+32]=Y[Q+1+64]=fn(vt,xt,xt),Y[Q+3+64]=Y[Q+2+64]=Y[Q+0+96]=Y[Q+1+96]=Y[Q+2+96]=Y[Q+3+96]=xt}function Fs(Y,Q){var st=Y[Q-1+0],ht=Y[Q-1+32],vt=Y[Q-1+64],xt=Y[Q-1+96],St=Y[Q-1-32],Ct=Y[Q+0-32],Nt=Y[Q+1-32],Rt=Y[Q+2-32];Y[Q+0+0]=Y[Q+2+32]=st+St+1>>1,Y[Q+0+32]=Y[Q+2+64]=ht+st+1>>1,Y[Q+0+64]=Y[Q+2+96]=vt+ht+1>>1,Y[Q+0+96]=xt+vt+1>>1,Y[Q+3+0]=fn(Ct,Nt,Rt),Y[Q+2+0]=fn(St,Ct,Nt),Y[Q+1+0]=Y[Q+3+32]=fn(st,St,Ct),Y[Q+1+32]=Y[Q+3+64]=fn(ht,st,St),Y[Q+1+64]=Y[Q+3+96]=fn(vt,ht,st),Y[Q+1+96]=fn(xt,vt,ht)}function Es(Y,Q){var st;for(st=0;8>st;++st)r(Y,Q+32*st,Y,Q-32,8)}function To(Y,Q){var st;for(st=0;8>st;++st)o(Y,Q,Y[Q-1],8),Q+=32}function ut(Y,Q,st){var ht;for(ht=0;8>ht;++ht)o(Q,st+32*ht,Y,8)}function At(Y,Q){var st,ht=8;for(st=0;8>st;++st)ht+=Y[Q+st-32]+Y[Q-1+32*st];ut(ht>>4,Y,Q)}function Ft(Y,Q){var st,ht=4;for(st=0;8>st;++st)ht+=Y[Q+st-32];ut(ht>>3,Y,Q)}function ce(Y,Q){var st,ht=4;for(st=0;8>st;++st)ht+=Y[Q-1+32*st];ut(ht>>3,Y,Q)}function An(Y,Q){ut(128,Y,Q)}function en(Y,Q,st){var ht=Y[Q-st],vt=Y[Q+0],xt=3*(vt-ht)+ao[1020+Y[Q-2*st]-Y[Q+st]],St=Pu[112+(xt+4>>3)];Y[Q-st]=ds[255+ht+Pu[112+(xt+3>>3)]],Y[Q+0]=ds[255+vt-St]}function Hn(Y,Q,st,ht){var vt=Y[Q+0],xt=Y[Q+st];return ss[255+Y[Q-2*st]-Y[Q-st]]>ht||ss[255+xt-vt]>ht}function Qn(Y,Q,st,ht){return 4*ss[255+Y[Q-st]-Y[Q+0]]+ss[255+Y[Q-2*st]-Y[Q+st]]<=ht}function qr(Y,Q,st,ht,vt){var xt=Y[Q-3*st],St=Y[Q-2*st],Ct=Y[Q-st],Nt=Y[Q+0],Rt=Y[Q+st],Ut=Y[Q+2*st],ee=Y[Q+3*st];return 4*ss[255+Ct-Nt]+ss[255+St-Rt]>ht?0:ss[255+Y[Q-4*st]-xt]<=vt&&ss[255+xt-St]<=vt&&ss[255+St-Ct]<=vt&&ss[255+ee-Ut]<=vt&&ss[255+Ut-Rt]<=vt&&ss[255+Rt-Nt]<=vt}function Jn(Y,Q,st,ht){var vt=2*ht+1;for(ht=0;16>ht;++ht)Qn(Y,Q+ht,st,vt)&&en(Y,Q+ht,st)}function Xr(Y,Q,st,ht){var vt=2*ht+1;for(ht=0;16>ht;++ht)Qn(Y,Q+ht*st,1,vt)&&en(Y,Q+ht*st,1)}function Si(Y,Q,st,ht){var vt;for(vt=3;0<vt;--vt)Jn(Y,Q+=4*st,st,ht)}function ii(Y,Q,st,ht){var vt;for(vt=3;0<vt;--vt)Xr(Y,Q+=4,st,ht)}function Kr(Y,Q,st,ht,vt,xt,St,Ct){for(xt=2*xt+1;0<vt--;){if(qr(Y,Q,st,xt,St))if(Hn(Y,Q,st,Ct))en(Y,Q,st);else{var Nt=Y,Rt=Q,Ut=st,ee=Nt[Rt-2*Ut],Ot=Nt[Rt-Ut],Wt=Nt[Rt+0],Zt=Nt[Rt+Ut],be=Nt[Rt+2*Ut],te=27*(_e=ao[1020+3*(Wt-Ot)+ao[1020+ee-Zt]])+63>>7,me=18*_e+63>>7,_e=9*_e+63>>7;Nt[Rt-3*Ut]=ds[255+Nt[Rt-3*Ut]+_e],Nt[Rt-2*Ut]=ds[255+ee+me],Nt[Rt-Ut]=ds[255+Ot+te],Nt[Rt+0]=ds[255+Wt-te],Nt[Rt+Ut]=ds[255+Zt-me],Nt[Rt+2*Ut]=ds[255+be-_e]}Q+=ht}}function $r(Y,Q,st,ht,vt,xt,St,Ct){for(xt=2*xt+1;0<vt--;){if(qr(Y,Q,st,xt,St))if(Hn(Y,Q,st,Ct))en(Y,Q,st);else{var Nt=Y,Rt=Q,Ut=st,ee=Nt[Rt-Ut],Ot=Nt[Rt+0],Wt=Nt[Rt+Ut],Zt=Pu[112+(4+(be=3*(Ot-ee))>>3)],be=Pu[112+(be+3>>3)],te=Zt+1>>1;Nt[Rt-2*Ut]=ds[255+Nt[Rt-2*Ut]+te],Nt[Rt-Ut]=ds[255+ee+be],Nt[Rt+0]=ds[255+Ot-Zt],Nt[Rt+Ut]=ds[255+Wt-te]}Q+=ht}}function zs(Y,Q,st,ht,vt,xt){Kr(Y,Q,st,1,16,ht,vt,xt)}function qi(Y,Q,st,ht,vt,xt){Kr(Y,Q,1,st,16,ht,vt,xt)}function Ks(Y,Q,st,ht,vt,xt){var St;for(St=3;0<St;--St)$r(Y,Q+=4*st,st,1,16,ht,vt,xt)}function nt(Y,Q,st,ht,vt,xt){var St;for(St=3;0<St;--St)$r(Y,Q+=4,1,st,16,ht,vt,xt)}function bt(Y,Q,st,ht,vt,xt,St,Ct){Kr(Y,Q,vt,1,8,xt,St,Ct),Kr(st,ht,vt,1,8,xt,St,Ct)}function Lt(Y,Q,st,ht,vt,xt,St,Ct){Kr(Y,Q,1,vt,8,xt,St,Ct),Kr(st,ht,1,vt,8,xt,St,Ct)}function zt(Y,Q,st,ht,vt,xt,St,Ct){$r(Y,Q+4*vt,vt,1,8,xt,St,Ct),$r(st,ht+4*vt,vt,1,8,xt,St,Ct)}function Yt(Y,Q,st,ht,vt,xt,St,Ct){$r(Y,Q+4,1,vt,8,xt,St,Ct),$r(st,ht+4,1,vt,8,xt,St,Ct)}function Se(){this.ba=new Fe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ke,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Re(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function un(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function gn(){this.ua=0,this.Wa=new ot,this.vb=new ot,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new E,this.yc=new T}function Dn(){this.xb=this.a=0,this.l=new Bn,this.ca=new Fe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new gn,this.ab=0,this.gc=a(4,un),this.Oc=0}function $n(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Bn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vr(Y,Q,st,ht,vt,xt,St){for(Y=Y==null?0:Y[Q+0],Q=0;Q<St;++Q)vt[xt+Q]=Y+st[ht+Q]&255,Y=vt[xt+Q]}function pi(Y,Q,st,ht,vt,xt,St){var Ct;if(Y==null)vr(null,null,st,ht,vt,xt,St);else for(Ct=0;Ct<St;++Ct)vt[xt+Ct]=Y[Q+Ct]+st[ht+Ct]&255}function Ni(Y,Q,st,ht,vt,xt,St){if(Y==null)vr(null,null,st,ht,vt,xt,St);else{var Ct,Nt=Y[Q+0],Rt=Nt,Ut=Nt;for(Ct=0;Ct<St;++Ct)Rt=Ut+(Nt=Y[Q+Ct])-Rt,Ut=st[ht+Ct]+(-256&Rt?0>Rt?0:255:Rt)&255,Rt=Nt,vt[xt+Ct]=Ut}}function Zr(Y,Q,st,ht){var vt=Q.width,xt=Q.o;if(e(Y!=null&&Q!=null),0>st||0>=ht||st+ht>xt)return null;if(!Y.Cc){if(Y.ga==null){var St;if(Y.ga=new $n,(St=Y.ga==null)||(St=Q.width*Q.o,e(Y.Gb.length==0),Y.Gb=s(St),Y.Uc=0,Y.Gb==null?St=0:(Y.mb=Y.Gb,Y.nb=Y.Uc,Y.rc=null,St=1),St=!St),!St){St=Y.ga;var Ct=Y.Fa,Nt=Y.P,Rt=Y.qc,Ut=Y.mb,ee=Y.nb,Ot=Nt+1,Wt=Rt-1,Zt=St.l;if(e(Ct!=null&&Ut!=null&&Q!=null),oo[0]=null,oo[1]=vr,oo[2]=pi,oo[3]=Ni,St.ca=Ut,St.tb=ee,St.c=Q.width,St.i=Q.height,e(0<St.c&&0<St.i),1>=Rt)Q=0;else if(St.$a=3&Ct[Nt+0],St.Z=Ct[Nt+0]>>2&3,St.Lc=Ct[Nt+0]>>4&3,Nt=Ct[Nt+0]>>6&3,0>St.$a||1<St.$a||4<=St.Z||1<St.Lc||Nt)Q=0;else if(Zt.put=Te,Zt.ac=Nn,Zt.bc=_n,Zt.ma=St,Zt.width=Q.width,Zt.height=Q.height,Zt.Da=Q.Da,Zt.v=Q.v,Zt.va=Q.va,Zt.j=Q.j,Zt.o=Q.o,St.$a)t:{e(St.$a==1),Q=kn();e:for(;;){if(Q==null){Q=0;break t}if(e(St!=null),St.mc=Q,Q.c=St.c,Q.i=St.i,Q.l=St.l,Q.l.ma=St,Q.l.width=St.c,Q.l.height=St.i,Q.a=0,C(Q.m,Ct,Ot,Wt),!qn(St.c,St.i,1,Q,null)||(Q.ab==1&&Q.gc[0].hc==3&&Ue(Q.s)?(St.ic=1,Ct=Q.c*Q.i,Q.Ta=null,Q.Ua=0,Q.V=s(Ct),Q.Ba=0,Q.V==null?(Q.a=1,Q=0):Q=1):(St.ic=0,Q=Qt(Q,St.c)),!Q))break e;Q=1;break t}St.mc=null,Q=0}else Q=Wt>=St.c*St.i;St=!Q}if(St)return null;Y.ga.Lc!=1?Y.Ga=0:ht=xt-st}e(Y.ga!=null),e(st+ht<=xt);t:{if(Q=(Ct=Y.ga).c,xt=Ct.l.o,Ct.$a==0){if(Ot=Y.rc,Wt=Y.Vc,Zt=Y.Fa,Nt=Y.P+1+st*Q,Rt=Y.mb,Ut=Y.nb+st*Q,e(Nt<=Y.P+Y.qc),Ct.Z!=0)for(e(oo[Ct.Z]!=null),St=0;St<ht;++St)oo[Ct.Z](Ot,Wt,Zt,Nt,Rt,Ut,Q),Ot=Rt,Wt=Ut,Ut+=Q,Nt+=Q;else for(St=0;St<ht;++St)r(Rt,Ut,Zt,Nt,Q),Ot=Rt,Wt=Ut,Ut+=Q,Nt+=Q;Y.rc=Ot,Y.Vc=Wt}else{if(e(Ct.mc!=null),Q=st+ht,e((St=Ct.mc)!=null),e(Q<=St.i),St.C>=Q)Q=1;else if(Ct.ic||ma(),Ct.ic){Ct=St.V,Ot=St.Ba,Wt=St.c;var be=St.i,te=(Zt=1,Nt=St.$/Wt,Rt=St.$%Wt,Ut=St.m,ee=St.s,St.$),me=Wt*be,_e=Wt*Q,De=ee.wc,Le=te<_e?we(ee,Rt,Nt):null;e(te<=me),e(Q<=be),e(Ue(ee));e:for(;;){for(;!Ut.h&&te<_e;){if(Rt&De||(Le=we(ee,Rt,Nt)),e(Le!=null),tt(Ut),256>(be=Ht(Le.G[0],Le.H[0],Ut)))Ct[Ot+te]=be,++te,++Rt>=Wt&&(Rt=0,++Nt<=Q&&!(Nt%16)&&Ge(St,Nt));else{if(!(280>be)){Zt=0;break e}be=on(be-256,Ut);var hn,rn=Ht(Le.G[4],Le.H[4],Ut);if(tt(Ut),!(te>=(rn=Dt(Wt,rn=on(rn,Ut)))&&me-te>=be)){Zt=0;break e}for(hn=0;hn<be;++hn)Ct[Ot+te+hn]=Ct[Ot+te+hn-rn];for(te+=be,Rt+=be;Rt>=Wt;)Rt-=Wt,++Nt<=Q&&!(Nt%16)&&Ge(St,Nt);te<_e&&Rt&De&&(Le=we(ee,Rt,Nt))}e(Ut.h==et(Ut))}Ge(St,Nt>Q?Q:Nt);break e}!Zt||Ut.h&&te<me?(Zt=0,St.a=Ut.h?5:3):St.$=te,Q=Zt}else Q=Ve(St,St.V,St.Ba,St.c,St.i,Q,de);if(!Q){ht=0;break t}}st+ht>=xt&&(Y.Cc=1),ht=1}if(!ht)return null;if(Y.Cc&&((ht=Y.ga)!=null&&(ht.mc=null),Y.ga=null,0<Y.Ga))return alert("todo:WebPDequantizeLevels"),null}return Y.nb+st*vt}function Ui(Y,Q,st,ht,vt,xt){for(;0<vt--;){var St,Ct=Y,Nt=Q+(st?1:0),Rt=Y,Ut=Q+(st?0:3);for(St=0;St<ht;++St){var ee=Rt[Ut+4*St];ee!=255&&(ee*=32897,Ct[Nt+4*St+0]=Ct[Nt+4*St+0]*ee>>23,Ct[Nt+4*St+1]=Ct[Nt+4*St+1]*ee>>23,Ct[Nt+4*St+2]=Ct[Nt+4*St+2]*ee>>23)}Q+=xt}}function Oi(Y,Q,st,ht,vt){for(;0<ht--;){var xt;for(xt=0;xt<st;++xt){var St=Y[Q+2*xt+0],Ct=15&(Rt=Y[Q+2*xt+1]),Nt=4369*Ct,Rt=(240&Rt|Rt>>4)*Nt>>16;Y[Q+2*xt+0]=(240&St|St>>4)*Nt>>16&240|(15&St|St<<4)*Nt>>16>>4&15,Y[Q+2*xt+1]=240&Rt|Ct}Q+=vt}}function rs(Y,Q,st,ht,vt,xt,St,Ct){var Nt,Rt,Ut=255;for(Rt=0;Rt<vt;++Rt){for(Nt=0;Nt<ht;++Nt){var ee=Y[Q+Nt];xt[St+4*Nt]=ee,Ut&=ee}Q+=st,St+=Ct}return Ut!=255}function Ka(Y,Q,st,ht,vt){var xt;for(xt=0;xt<vt;++xt)st[ht+xt]=Y[Q+xt]>>8}function ma(){ol=Ui,Qs=Oi,Iu=rs,Hs=Ka}function Za(Y,Q,st){U[Y]=function(ht,vt,xt,St,Ct,Nt,Rt,Ut,ee,Ot,Wt,Zt,be,te,me,_e,De){var Le,hn=De-1>>1,rn=Ct[Nt+0]|Rt[Ut+0]<<16,Fn=ee[Ot+0]|Wt[Zt+0]<<16;e(ht!=null);var ln=3*rn+Fn+131074>>2;for(Q(ht[vt+0],255&ln,ln>>16,be,te),xt!=null&&(ln=3*Fn+rn+131074>>2,Q(xt[St+0],255&ln,ln>>16,me,_e)),Le=1;Le<=hn;++Le){var lr=Ct[Nt+Le]|Rt[Ut+Le]<<16,ai=ee[Ot+Le]|Wt[Zt+Le]<<16,Vn=rn+lr+Fn+ai+524296,sn=Vn+2*(lr+Fn)>>3;ln=sn+rn>>1,rn=(Vn=Vn+2*(rn+ai)>>3)+lr>>1,Q(ht[vt+2*Le-1],255&ln,ln>>16,be,te+(2*Le-1)*st),Q(ht[vt+2*Le-0],255&rn,rn>>16,be,te+(2*Le-0)*st),xt!=null&&(ln=Vn+Fn>>1,rn=sn+ai>>1,Q(xt[St+2*Le-1],255&ln,ln>>16,me,_e+(2*Le-1)*st),Q(xt[St+2*Le+0],255&rn,rn>>16,me,_e+(2*Le+0)*st)),rn=lr,Fn=ai}1&De||(ln=3*rn+Fn+131074>>2,Q(ht[vt+De-1],255&ln,ln>>16,be,te+(De-1)*st),xt!=null&&(ln=3*Fn+rn+131074>>2,Q(xt[St+De-1],255&ln,ln>>16,me,_e+(De-1)*st)))}}function Mu(){os[_c]=cl,os[ps]=Kl,os[kc]=zf,os[Js]=Tc,os[Fu]=Do,os[Gl]=Pa,os[Oo]=Bo,os[zu]=Kl,os[Ac]=Tc,os[Yl]=Do,os[Cc]=Pa}function zl(Y){return Y&-16384?0>Y?0:255:Y>>jc}function ja(Y,Q){return zl((19077*Y>>8)+(26149*Q>>8)-14234)}function ga(Y,Q,st){return zl((19077*Y>>8)-(6419*Q>>8)-(13320*st>>8)+8708)}function il(Y,Q){return zl((19077*Y>>8)+(33050*Q>>8)-17685)}function Qa(Y,Q,st,ht,vt){ht[vt+0]=ja(Y,st),ht[vt+1]=ga(Y,Q,st),ht[vt+2]=il(Y,Q)}function Zi(Y,Q,st,ht,vt){ht[vt+0]=il(Y,Q),ht[vt+1]=ga(Y,Q,st),ht[vt+2]=ja(Y,st)}function jo(Y,Q,st,ht,vt){var xt=ga(Y,Q,st);Q=xt<<3&224|il(Y,Q)>>3,ht[vt+0]=248&ja(Y,st)|xt>>5,ht[vt+1]=Q}function Mo(Y,Q,st,ht,vt){var xt=240&il(Y,Q)|15;ht[vt+0]=240&ja(Y,st)|ga(Y,Q,st)>>4,ht[vt+1]=xt}function ql(Y,Q,st,ht,vt){ht[vt+0]=255,Qa(Y,Q,st,ht,vt+1)}function Ma(Y,Q,st,ht,vt){Zi(Y,Q,st,ht,vt),ht[vt+3]=255}function ws(Y,Q,st,ht,vt){Qa(Y,Q,st,ht,vt),ht[vt+3]=255}function Ja(Y,Q,st){U[Y]=function(ht,vt,xt,St,Ct,Nt,Rt,Ut,ee){for(var Ot=Ut+(-2&ee)*st;Ut!=Ot;)Q(ht[vt+0],xt[St+0],Ct[Nt+0],Rt,Ut),Q(ht[vt+1],xt[St+0],Ct[Nt+0],Rt,Ut+st),vt+=2,++St,++Nt,Ut+=2*st;1&ee&&Q(ht[vt+0],xt[St+0],Ct[Nt+0],Rt,Ut)}}function Ul(Y,Q,st){return st==0?Y==0?Q==0?6:5:Q==0?4:0:st}function Lu(Y,Q,st,ht,vt){switch(Y>>>30){case 3:so(Q,st,ht,vt,0);break;case 2:hs(Q,st,ht,vt);break;case 1:Nr(Q,st,ht,vt)}}function qs(Y,Q){var st,ht,vt=Q.M,xt=Q.Nb,St=Y.oc,Ct=Y.pc+40,Nt=Y.oc,Rt=Y.pc+584,Ut=Y.oc,ee=Y.pc+600;for(st=0;16>st;++st)St[Ct+32*st-1]=129;for(st=0;8>st;++st)Nt[Rt+32*st-1]=129,Ut[ee+32*st-1]=129;for(0<vt?St[Ct-1-32]=Nt[Rt-1-32]=Ut[ee-1-32]=129:(o(St,Ct-32-1,127,21),o(Nt,Rt-32-1,127,9),o(Ut,ee-32-1,127,9)),ht=0;ht<Y.za;++ht){var Ot=Q.ya[Q.aa+ht];if(0<ht){for(st=-1;16>st;++st)r(St,Ct+32*st-4,St,Ct+32*st+12,4);for(st=-1;8>st;++st)r(Nt,Rt+32*st-4,Nt,Rt+32*st+4,4),r(Ut,ee+32*st-4,Ut,ee+32*st+4,4)}var Wt=Y.Gd,Zt=Y.Hd+ht,be=Ot.ad,te=Ot.Hc;if(0<vt&&(r(St,Ct-32,Wt[Zt].y,0,16),r(Nt,Rt-32,Wt[Zt].f,0,8),r(Ut,ee-32,Wt[Zt].ea,0,8)),Ot.Za){var me=St,_e=Ct-32+16;for(0<vt&&(ht>=Y.za-1?o(me,_e,Wt[Zt].y[15],4):r(me,_e,Wt[Zt+1].y,0,4)),st=0;4>st;st++)me[_e+128+st]=me[_e+256+st]=me[_e+384+st]=me[_e+0+st];for(st=0;16>st;++st,te<<=2)me=St,_e=Ct+Mi[st],_i[Ot.Ob[st]](me,_e),Lu(te,be,16*+st,me,_e)}else if(me=Ul(ht,vt,Ot.Ob[0]),Ss[me](St,Ct),te!=0)for(st=0;16>st;++st,te<<=2)Lu(te,be,16*+st,St,Ct+Mi[st]);for(st=Ot.Gc,me=Ul(ht,vt,Ot.Dd),wa[me](Nt,Rt),wa[me](Ut,ee),te=be,me=Nt,_e=Rt,255&(Ot=0|st)&&(170&Ot?Zs(te,256,me,_e):wr(te,256,me,_e)),Ot=Ut,te=ee,255&(st>>=8)&&(170&st?Zs(be,320,Ot,te):wr(be,320,Ot,te)),vt<Y.Ub-1&&(r(Wt[Zt].y,0,St,Ct+480,16),r(Wt[Zt].f,0,Nt,Rt+224,8),r(Wt[Zt].ea,0,Ut,ee+224,8)),st=8*xt*Y.B,Wt=Y.sa,Zt=Y.ta+16*ht+16*xt*Y.R,be=Y.qa,Ot=Y.ra+8*ht+st,te=Y.Ha,me=Y.Ia+8*ht+st,st=0;16>st;++st)r(Wt,Zt+st*Y.R,St,Ct+32*st,16);for(st=0;8>st;++st)r(be,Ot+st*Y.B,Nt,Rt+32*st,8),r(te,me+st*Y.B,Ut,ee+32*st,8)}}function ba(Y,Q,st,ht,vt,xt,St,Ct,Nt){var Rt=[0],Ut=[0],ee=0,Ot=Nt!=null?Nt.kd:0,Wt=Nt??new Re;if(Y==null||12>st)return 7;Wt.data=Y,Wt.w=Q,Wt.ha=st,Q=[Q],st=[st],Wt.gb=[Wt.gb];t:{var Zt=Q,be=st,te=Wt.gb;if(e(Y!=null),e(be!=null),e(te!=null),te[0]=0,12<=be[0]&&!t(Y,Zt[0],"RIFF")){if(t(Y,Zt[0]+8,"WEBP")){te=3;break t}var me=at(Y,Zt[0]+4);if(12>me||4294967286<me){te=3;break t}if(Ot&&me>be[0]-8){te=7;break t}te[0]=me,Zt[0]+=12,be[0]-=12}te=0}if(te!=0)return te;for(me=0<Wt.gb[0],st=st[0];;){t:{var _e=Y;be=Q,te=st;var De=Rt,Le=Ut,hn=Zt=[0];if((ln=ee=[ee])[0]=0,8>te[0])te=7;else{if(!t(_e,be[0],"VP8X")){if(at(_e,be[0]+4)!=10){te=3;break t}if(18>te[0]){te=7;break t}var rn=at(_e,be[0]+8),Fn=1+lt(_e,be[0]+12);if(2147483648<=Fn*(_e=1+lt(_e,be[0]+15))){te=3;break t}hn!=null&&(hn[0]=rn),De!=null&&(De[0]=Fn),Le!=null&&(Le[0]=_e),be[0]+=18,te[0]-=18,ln[0]=1}te=0}}if(ee=ee[0],Zt=Zt[0],te!=0)return te;if(be=!!(2&Zt),!me&&ee)return 3;if(xt!=null&&(xt[0]=!!(16&Zt)),St!=null&&(St[0]=be),Ct!=null&&(Ct[0]=0),St=Rt[0],Zt=Ut[0],ee&&be&&Nt==null){te=0;break}if(4>st){te=7;break}if(me&&ee||!me&&!ee&&!t(Y,Q[0],"ALPH")){st=[st],Wt.na=[Wt.na],Wt.P=[Wt.P],Wt.Sa=[Wt.Sa];t:{rn=Y,te=Q,me=st;var ln=Wt.gb;De=Wt.na,Le=Wt.P,hn=Wt.Sa,Fn=22,e(rn!=null),e(me!=null),_e=te[0];var lr=me[0];for(e(De!=null),e(hn!=null),De[0]=null,Le[0]=null,hn[0]=0;;){if(te[0]=_e,me[0]=lr,8>lr){te=7;break t}var ai=at(rn,_e+4);if(4294967286<ai){te=3;break t}var Vn=8+ai+1&-2;if(Fn+=Vn,0<ln&&Fn>ln){te=3;break t}if(!t(rn,_e,"VP8 ")||!t(rn,_e,"VP8L")){te=0;break t}if(lr[0]<Vn){te=7;break t}t(rn,_e,"ALPH")||(De[0]=rn,Le[0]=_e+8,hn[0]=ai),_e+=Vn,lr-=Vn}}if(st=st[0],Wt.na=Wt.na[0],Wt.P=Wt.P[0],Wt.Sa=Wt.Sa[0],te!=0)break}st=[st],Wt.Ja=[Wt.Ja],Wt.xa=[Wt.xa];t:if(ln=Y,te=Q,me=st,De=Wt.gb[0],Le=Wt.Ja,hn=Wt.xa,rn=te[0],_e=!t(ln,rn,"VP8 "),Fn=!t(ln,rn,"VP8L"),e(ln!=null),e(me!=null),e(Le!=null),e(hn!=null),8>me[0])te=7;else{if(_e||Fn){if(ln=at(ln,rn+4),12<=De&&ln>De-12){te=3;break t}if(Ot&&ln>me[0]-8){te=7;break t}Le[0]=ln,te[0]+=8,me[0]-=8,hn[0]=Fn}else hn[0]=5<=me[0]&&ln[rn+0]==47&&!(ln[rn+4]>>5),Le[0]=me[0];te=0}if(st=st[0],Wt.Ja=Wt.Ja[0],Wt.xa=Wt.xa[0],Q=Q[0],te!=0)break;if(4294967286<Wt.Ja)return 3;if(Ct==null||be||(Ct[0]=Wt.xa?2:1),St=[St],Zt=[Zt],Wt.xa){if(5>st){te=7;break}Ct=St,Ot=Zt,be=xt,Y==null||5>st?Y=0:5<=st&&Y[Q+0]==47&&!(Y[Q+4]>>5)?(me=[0],ln=[0],De=[0],C(Le=new H,Y,Q,st),Pn(Le,me,ln,De)?(Ct!=null&&(Ct[0]=me[0]),Ot!=null&&(Ot[0]=ln[0]),be!=null&&(be[0]=De[0]),Y=1):Y=0):Y=0}else{if(10>st){te=7;break}Ct=Zt,Y==null||10>st||!mr(Y,Q+3,st-3)?Y=0:(Ot=Y[Q+0]|Y[Q+1]<<8|Y[Q+2]<<16,be=16383&(Y[Q+7]<<8|Y[Q+6]),Y=16383&(Y[Q+9]<<8|Y[Q+8]),1&Ot||3<(Ot>>1&7)||!(Ot>>4&1)||Ot>>5>=Wt.Ja||!be||!Y?Y=0:(St&&(St[0]=be),Ct&&(Ct[0]=Y),Y=1))}if(!Y||(St=St[0],Zt=Zt[0],ee&&(Rt[0]!=St||Ut[0]!=Zt)))return 3;Nt!=null&&(Nt[0]=Wt,Nt.offset=Q-Nt.w,e(4294967286>Q-Nt.w),e(Nt.offset==Nt.ha-st));break}return te==0||te==7&&ee&&Nt==null?(xt!=null&&(xt[0]|=Wt.na!=null&&0<Wt.na.length),ht!=null&&(ht[0]=St),vt!=null&&(vt[0]=Zt),0):te}function to(Y,Q,st){var ht=Q.width,vt=Q.height,xt=0,St=0,Ct=ht,Nt=vt;if(Q.Da=Y!=null&&0<Y.Da,Q.Da&&(Ct=Y.cd,Nt=Y.bd,xt=Y.v,St=Y.j,11>st||(xt&=-2,St&=-2),0>xt||0>St||0>=Ct||0>=Nt||xt+Ct>ht||St+Nt>vt))return 0;if(Q.v=xt,Q.j=St,Q.va=xt+Ct,Q.o=St+Nt,Q.U=Ct,Q.T=Nt,Q.da=Y!=null&&0<Y.da,Q.da){if(!dt(Ct,Nt,st=[Y.ib],xt=[Y.hb]))return 0;Q.ib=st[0],Q.hb=xt[0]}return Q.ob=Y!=null&&Y.ob,Q.Kb=Y==null||!Y.Sd,Q.da&&(Q.ob=Q.ib<3*ht/4&&Q.hb<3*vt/4,Q.Kb=0),1}function Ou(Y){if(Y==null)return 2;if(11>Y.S){var Q=Y.f.RGBA;Q.fb+=(Y.height-1)*Q.A,Q.A=-Q.A}else Q=Y.f.kb,Y=Y.height,Q.O+=(Y-1)*Q.fa,Q.fa=-Q.fa,Q.N+=(Y-1>>1)*Q.Ab,Q.Ab=-Q.Ab,Q.W+=(Y-1>>1)*Q.Db,Q.Db=-Q.Db,Q.F!=null&&(Q.J+=(Y-1)*Q.lb,Q.lb=-Q.lb);return 0}function ya(Y,Q,st,ht){if(ht==null||0>=Y||0>=Q)return 2;if(st!=null){if(st.Da){var vt=st.cd,xt=st.bd,St=-2&st.v,Ct=-2&st.j;if(0>St||0>Ct||0>=vt||0>=xt||St+vt>Y||Ct+xt>Q)return 2;Y=vt,Q=xt}if(st.da){if(!dt(Y,Q,vt=[st.ib],xt=[st.hb]))return 2;Y=vt[0],Q=xt[0]}}ht.width=Y,ht.height=Q;t:{var Nt=ht.width,Rt=ht.height;if(Y=ht.S,0>=Nt||0>=Rt||!(Y>=_c&&13>Y))Y=2;else{if(0>=ht.Rd&&ht.sd==null){St=xt=vt=Q=0;var Ut=(Ct=Nt*Lc[Y])*Rt;if(11>Y||(xt=(Rt+1)/2*(Q=(Nt+1)/2),Y==12&&(St=(vt=Nt)*Rt)),(Rt=s(Ut+2*xt+St))==null){Y=1;break t}ht.sd=Rt,11>Y?((Nt=ht.f.RGBA).eb=Rt,Nt.fb=0,Nt.A=Ct,Nt.size=Ut):((Nt=ht.f.kb).y=Rt,Nt.O=0,Nt.fa=Ct,Nt.Fd=Ut,Nt.f=Rt,Nt.N=0+Ut,Nt.Ab=Q,Nt.Cd=xt,Nt.ea=Rt,Nt.W=0+Ut+xt,Nt.Db=Q,Nt.Ed=xt,Y==12&&(Nt.F=Rt,Nt.J=0+Ut+2*xt),Nt.Tc=St,Nt.lb=vt)}if(Q=1,vt=ht.S,xt=ht.width,St=ht.height,vt>=_c&&13>vt)if(11>vt)Y=ht.f.RGBA,Q&=(Ct=Math.abs(Y.A))*(St-1)+xt<=Y.size,Q&=Ct>=xt*Lc[vt],Q&=Y.eb!=null;else{Y=ht.f.kb,Ct=(xt+1)/2,Ut=(St+1)/2,Nt=Math.abs(Y.fa),Rt=Math.abs(Y.Ab);var ee=Math.abs(Y.Db),Ot=Math.abs(Y.lb),Wt=Ot*(St-1)+xt;Q&=Nt*(St-1)+xt<=Y.Fd,Q&=Rt*(Ut-1)+Ct<=Y.Cd,Q=(Q&=ee*(Ut-1)+Ct<=Y.Ed)&Nt>=xt&Rt>=Ct&ee>=Ct,Q&=Y.y!=null,Q&=Y.f!=null,Q&=Y.ea!=null,vt==12&&(Q&=Ot>=xt,Q&=Wt<=Y.Tc,Q&=Y.F!=null)}else Q=0;Y=Q?0:2}}return Y!=0||st!=null&&st.fd&&(Y=Ou(ht)),Y}var Lo=64,Ns=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],xs=24,La=32,Oa=8,eo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];wt("Predictor0","PredictorAdd0"),U.Predictor0=function(){return 4278190080},U.Predictor1=function(Y){return Y},U.Predictor2=function(Y,Q,st){return Q[st+0]},U.Predictor3=function(Y,Q,st){return Q[st+1]},U.Predictor4=function(Y,Q,st){return Q[st-1]},U.Predictor5=function(Y,Q,st){return Et(Et(Y,Q[st+1]),Q[st+0])},U.Predictor6=function(Y,Q,st){return Et(Y,Q[st-1])},U.Predictor7=function(Y,Q,st){return Et(Y,Q[st+0])},U.Predictor8=function(Y,Q,st){return Et(Q[st-1],Q[st+0])},U.Predictor9=function(Y,Q,st){return Et(Q[st+0],Q[st+1])},U.Predictor10=function(Y,Q,st){return Et(Et(Y,Q[st-1]),Et(Q[st+0],Q[st+1]))},U.Predictor11=function(Y,Q,st){var ht=Q[st+0];return 0>=Tt(ht>>24&255,Y>>24&255,(Q=Q[st-1])>>24&255)+Tt(ht>>16&255,Y>>16&255,Q>>16&255)+Tt(ht>>8&255,Y>>8&255,Q>>8&255)+Tt(255&ht,255&Y,255&Q)?ht:Y},U.Predictor12=function(Y,Q,st){var ht=Q[st+0];return(Mt((Y>>24&255)+(ht>>24&255)-((Q=Q[st-1])>>24&255))<<24|Mt((Y>>16&255)+(ht>>16&255)-(Q>>16&255))<<16|Mt((Y>>8&255)+(ht>>8&255)-(Q>>8&255))<<8|Mt((255&Y)+(255&ht)-(255&Q)))>>>0},U.Predictor13=function(Y,Q,st){var ht=Q[st-1];return(qt((Y=Et(Y,Q[st+0]))>>24&255,ht>>24&255)<<24|qt(Y>>16&255,ht>>16&255)<<16|qt(Y>>8&255,ht>>8&255)<<8|qt(255&Y,255&ht))>>>0};var Hl=U.PredictorAdd0;U.PredictorAdd1=It,wt("Predictor2","PredictorAdd2"),wt("Predictor3","PredictorAdd3"),wt("Predictor4","PredictorAdd4"),wt("Predictor5","PredictorAdd5"),wt("Predictor6","PredictorAdd6"),wt("Predictor7","PredictorAdd7"),wt("Predictor8","PredictorAdd8"),wt("Predictor9","PredictorAdd9"),wt("Predictor10","PredictorAdd10"),wt("Predictor11","PredictorAdd11"),wt("Predictor12","PredictorAdd12"),wt("Predictor13","PredictorAdd13");var $l=U.PredictorAdd2;ae("ColorIndexInverseTransform","MapARGB","32b",function(Y){return Y>>8&255},function(Y){return Y}),ae("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(Y){return Y},function(Y){return Y>>8&255});var Ti,wc=U.ColorIndexInverseTransform,Ra=U.MapARGB,Ia=U.VP8LColorIndexInverseTransformAlpha,is=U.MapAlpha,no=U.VP8LPredictorsAdd=[];no.length=16,(U.VP8LPredictors=[]).length=16,(U.VP8LPredictorsAdd_C=[]).length=16,(U.VP8LPredictors_C=[]).length=16;var Vl,Wl,ro,io,Da,sl,Us,so,hs,Zs,Nr,wr,Qr,ji,Ba,va,al,Ru,If,dd,pd,md,Df,Bf,ol,Qs,Iu,Hs,ll=s(511),xc=s(2041),Du=s(225),Bu=s(767),Sc=0,ao=xc,Pu=Du,ds=Bu,ss=ll,_c=0,ps=1,kc=2,Js=3,Fu=4,Gl=5,Oo=6,zu=7,Ac=8,Yl=9,Cc=10,ta=[2,3,7],Xl=[3,3,11],ul=[280,256,256,256,40],Ec=[0,1,1,1,0],qu=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ea=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],na=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Ro=8,ra=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ia=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],$s=null,gd=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Pf=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Nc=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],bd=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],as=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],si=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],fr=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ss=[],_i=[],wa=[],Io=1,Ff=2,oo=[],os=[];Za("UpsampleRgbLinePair",Qa,3),Za("UpsampleBgrLinePair",Zi,3),Za("UpsampleRgbaLinePair",ws,4),Za("UpsampleBgraLinePair",Ma,4),Za("UpsampleArgbLinePair",ql,4),Za("UpsampleRgba4444LinePair",Mo,2),Za("UpsampleRgb565LinePair",jo,2);var cl=U.UpsampleRgbLinePair,zf=U.UpsampleBgrLinePair,Kl=U.UpsampleRgbaLinePair,Tc=U.UpsampleBgraLinePair,Do=U.UpsampleArgbLinePair,Pa=U.UpsampleRgba4444LinePair,Bo=U.UpsampleRgb565LinePair,sa=16,Zl=1<<sa-1,fl=-227,Po=482,jc=6,Fo=0,ls=s(256),Mc=s(256),yd=s(256),N0=s(256),T0=s(Po-fl),j0=s(Po-fl);Ja("YuvToRgbRow",Qa,3),Ja("YuvToBgrRow",Zi,3),Ja("YuvToRgbaRow",ws,4),Ja("YuvToBgraRow",Ma,4),Ja("YuvToArgbRow",ql,4),Ja("YuvToRgba4444Row",Mo,2),Ja("YuvToRgb565Row",jo,2);var Mi=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ql=[0,2,8],Uu=[8,7,6,4,4,2,2,2,1,1,1,1],Hu=1;this.WebPDecodeRGBA=function(Y,Q,st,ht,vt){var xt=ps,St=new Se,Ct=new Fe;St.ba=Ct,Ct.S=xt,Ct.width=[Ct.width],Ct.height=[Ct.height];var Nt=Ct.width,Rt=Ct.height,Ut=new Me;if(Ut==null||Y==null)var ee=2;else e(Ut!=null),ee=ba(Y,Q,st,Ut.width,Ut.height,Ut.Pd,Ut.Qd,Ut.format,null);if(ee!=0?Nt=0:(Nt!=null&&(Nt[0]=Ut.width[0]),Rt!=null&&(Rt[0]=Ut.height[0]),Nt=1),Nt){Ct.width=Ct.width[0],Ct.height=Ct.height[0],ht!=null&&(ht[0]=Ct.width),vt!=null&&(vt[0]=Ct.height);t:{if(ht=new Bn,(vt=new Re).data=Y,vt.w=Q,vt.ha=st,vt.kd=1,Q=[0],e(vt!=null),((Y=ba(vt.data,vt.w,vt.ha,null,null,null,Q,null,vt))==0||Y==7)&&Q[0]&&(Y=4),(Q=Y)==0){if(e(St!=null),ht.data=vt.data,ht.w=vt.w+vt.offset,ht.ha=vt.ha-vt.offset,ht.put=Te,ht.ac=Nn,ht.bc=_n,ht.ma=St,vt.xa){if((Y=kn())==null){St=1;break t}if((function(Ot,Wt){var Zt=[0],be=[0],te=[0];e:for(;;){if(Ot==null)return 0;if(Wt==null)return Ot.a=2,0;if(Ot.l=Wt,Ot.a=0,C(Ot.m,Wt.data,Wt.w,Wt.ha),!Pn(Ot.m,Zt,be,te)){Ot.a=3;break e}if(Ot.xb=Ff,Wt.width=Zt[0],Wt.height=be[0],!qn(Zt[0],be[0],1,Ot,null))break e;return 1}return e(Ot.a!=0),0})(Y,ht)){if(ht=(Q=ya(ht.width,ht.height,St.Oa,St.ba))==0){e:{ht=Y;n:for(;;){if(ht==null){ht=0;break e}if(e(ht.s.yc!=null),e(ht.s.Ya!=null),e(0<ht.s.Wb),e((st=ht.l)!=null),e((vt=st.ma)!=null),ht.xb!=0){if(ht.ca=vt.ba,ht.tb=vt.tb,e(ht.ca!=null),!to(vt.Oa,st,Js)){ht.a=2;break n}if(!Qt(ht,st.width)||st.da)break n;if((st.da||Be(ht.ca.S))&&ma(),11>ht.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ht.ca.f.kb.F!=null&&ma()),ht.Pb&&0<ht.s.ua&&ht.s.vb.X==null&&!rt(ht.s.vb,ht.s.Wa.Xa)){ht.a=1;break n}ht.xb=0}if(!Ve(ht,ht.V,ht.Ba,ht.c,ht.i,st.o,Ie))break n;vt.Dc=ht.Ma,ht=1;break e}e(ht.a!=0),ht=0}ht=!ht}ht&&(Q=Y.a)}else Q=Y.a}else{if((Y=new In)==null){St=1;break t}if(Y.Fa=vt.na,Y.P=vt.P,Y.qc=vt.Sa,sr(Y,ht)){if((Q=ya(ht.width,ht.height,St.Oa,St.ba))==0){if(Y.Aa=0,st=St.Oa,e((vt=Y)!=null),st!=null){if(0<(Nt=0>(Nt=st.Md)?0:100<Nt?255:255*Nt/100)){for(Rt=Ut=0;4>Rt;++Rt)12>(ee=vt.pb[Rt]).lc&&(ee.ia=Nt*Uu[0>ee.lc?0:ee.lc]>>3),Ut|=ee.ia;Ut&&(alert("todo:VP8InitRandom"),vt.ia=1)}vt.Ga=st.Id,100<vt.Ga?vt.Ga=100:0>vt.Ga&&(vt.Ga=0)}(function(Ot,Wt){if(Ot==null)return 0;if(Wt==null)return Qe(Ot,2,"NULL VP8Io parameter in VP8Decode().");if(!Ot.cb&&!sr(Ot,Wt))return 0;if(e(Ot.cb),Wt.ac==null||Wt.ac(Wt)){Wt.ob&&(Ot.L=0);var Zt=Ql[Ot.L];if(Ot.L==2?(Ot.yb=0,Ot.zb=0):(Ot.yb=Wt.v-Zt>>4,Ot.zb=Wt.j-Zt>>4,0>Ot.yb&&(Ot.yb=0),0>Ot.zb&&(Ot.zb=0)),Ot.Va=Wt.o+15+Zt>>4,Ot.Hb=Wt.va+15+Zt>>4,Ot.Hb>Ot.za&&(Ot.Hb=Ot.za),Ot.Va>Ot.Ub&&(Ot.Va=Ot.Ub),0<Ot.L){var be=Ot.ed;for(Zt=0;4>Zt;++Zt){var te;if(Ot.Qa.Cb){var me=Ot.Qa.Lb[Zt];Ot.Qa.Fb||(me+=be.Tb)}else me=be.Tb;for(te=0;1>=te;++te){var _e=Ot.gd[Zt][te],De=me;if(be.Pc&&(De+=be.vd[0],te&&(De+=be.od[0])),0<(De=0>De?0:63<De?63:De)){var Le=De;0<be.wb&&(Le=4<be.wb?Le>>2:Le>>1)>9-be.wb&&(Le=9-be.wb),1>Le&&(Le=1),_e.dd=Le,_e.tc=2*De+Le,_e.ld=40<=De?2:15<=De?1:0}else _e.tc=0;_e.La=te}}}Zt=0}else Qe(Ot,6,"Frame setup failed"),Zt=Ot.a;if(Zt=Zt==0){if(Zt){Ot.$c=0,0<Ot.Aa||(Ot.Ic=Hu);e:{Zt=Ot.Ic,be=4*(Le=Ot.za);var hn=32*Le,rn=Le+1,Fn=0<Ot.L?Le*(0<Ot.Aa?2:1):0,ln=(Ot.Aa==2?2:1)*Le;if((_e=be+832+(te=3*(16*Zt+Ql[Ot.L])/2*hn)+(me=Ot.Fa!=null&&0<Ot.Fa.length?Ot.Kc.c*Ot.Kc.i:0))!=_e)Zt=0;else{if(_e>Ot.Vb){if(Ot.Vb=0,Ot.Ec=s(_e),Ot.Fc=0,Ot.Ec==null){Zt=Qe(Ot,1,"no memory during frame initialization.");break e}Ot.Vb=_e}_e=Ot.Ec,De=Ot.Fc,Ot.Ac=_e,Ot.Bc=De,De+=be,Ot.Gd=a(hn,vn),Ot.Hd=0,Ot.rb=a(rn+1,ye),Ot.sb=1,Ot.wa=Fn?a(Fn,Ne):null,Ot.Y=0,Ot.D.Nb=0,Ot.D.wa=Ot.wa,Ot.D.Y=Ot.Y,0<Ot.Aa&&(Ot.D.Y+=Le),e(!0),Ot.oc=_e,Ot.pc=De,De+=832,Ot.ya=a(ln,mn),Ot.aa=0,Ot.D.ya=Ot.ya,Ot.D.aa=Ot.aa,Ot.Aa==2&&(Ot.D.aa+=Le),Ot.R=16*Le,Ot.B=8*Le,Le=(hn=Ql[Ot.L])*Ot.R,hn=hn/2*Ot.B,Ot.sa=_e,Ot.ta=De+Le,Ot.qa=Ot.sa,Ot.ra=Ot.ta+16*Zt*Ot.R+hn,Ot.Ha=Ot.qa,Ot.Ia=Ot.ra+8*Zt*Ot.B+hn,Ot.$c=0,De+=te,Ot.mb=me?_e:null,Ot.nb=me?De:null,e(De+me<=Ot.Fc+Ot.Vb),xi(Ot),o(Ot.Ac,Ot.Bc,0,be),Zt=1}}if(Zt){if(Wt.ka=0,Wt.y=Ot.sa,Wt.O=Ot.ta,Wt.f=Ot.qa,Wt.N=Ot.ra,Wt.ea=Ot.Ha,Wt.Vd=Ot.Ia,Wt.fa=Ot.R,Wt.Rc=Ot.B,Wt.F=null,Wt.J=0,!Sc){for(Zt=-255;255>=Zt;++Zt)ll[255+Zt]=0>Zt?-Zt:Zt;for(Zt=-1020;1020>=Zt;++Zt)xc[1020+Zt]=-128>Zt?-128:127<Zt?127:Zt;for(Zt=-112;112>=Zt;++Zt)Du[112+Zt]=-16>Zt?-16:15<Zt?15:Zt;for(Zt=-255;510>=Zt;++Zt)Bu[255+Zt]=0>Zt?0:255<Zt?255:Zt;Sc=1}Us=Zn,so=ar,Zs=tr,Nr=Ur,wr=Kn,hs=tn,Qr=zs,ji=qi,Ba=bt,va=Lt,al=Ks,Ru=nt,If=zt,dd=Yt,pd=Jn,md=Xr,Df=Si,Bf=ii,_i[0]=No,_i[1]=ri,_i[2]=vs,_i[3]=Xs,_i[4]=Yi,_i[5]=Ta,_i[6]=di,_i[7]=Xi,_i[8]=Fs,_i[9]=Ki,Ss[0]=hi,Ss[1]=Mr,Ss[2]=Sr,Ss[3]=Hr,Ss[4]=Lr,Ss[5]=ns,Ss[6]=fs,wa[0]=At,wa[1]=or,wa[2]=Es,wa[3]=To,wa[4]=ce,wa[5]=Ft,wa[6]=An,Zt=1}else Zt=0}Zt&&(Zt=(function(lr,ai){for(lr.M=0;lr.M<lr.Va;++lr.M){var Vn,sn=lr.Jc[lr.M&lr.Xb],We=lr.m,mi=lr;for(Vn=0;Vn<mi.za;++Vn){var Ln=We,Xn=mi,Pr=Xn.Ac,Hi=Xn.Bc+4*Vn,us=Xn.zc,Jr=Xn.ya[Xn.aa+Vn];if(Xn.Qa.Bb?Jr.$b=Z(Ln,Xn.Pa.jb[0])?2+Z(Ln,Xn.Pa.jb[2]):Z(Ln,Xn.Pa.jb[1]):Jr.$b=0,Xn.kc&&(Jr.Ad=Z(Ln,Xn.Bd)),Jr.Za=!Z(Ln,145)+0,Jr.Za){var Ri=Jr.Ob,ms=0;for(Xn=0;4>Xn;++Xn){var Ii,rr=us[0+Xn];for(Ii=0;4>Ii;++Ii){rr=as[Pr[Hi+Ii]][rr];for(var _r=Nc[Z(Ln,rr[0])];0<_r;)_r=Nc[2*_r+Z(Ln,rr[_r])];rr=-_r,Pr[Hi+Ii]=rr}r(Ri,ms,Pr,Hi,4),ms+=4,us[0+Xn]=rr}}else rr=Z(Ln,156)?Z(Ln,128)?1:3:Z(Ln,163)?2:0,Jr.Ob[0]=rr,o(Pr,Hi,rr,4),o(us,0,rr,4);Jr.Dd=Z(Ln,142)?Z(Ln,114)?Z(Ln,183)?1:3:2:0}if(mi.m.Ka)return Qe(lr,7,"Premature end-of-partition0 encountered.");for(;lr.ja<lr.za;++lr.ja){if(mi=sn,Ln=(We=lr).rb[We.sb-1],Pr=We.rb[We.sb+We.ja],Vn=We.ya[We.aa+We.ja],Hi=We.kc?Vn.Ad:0)Ln.la=Pr.la=0,Vn.Za||(Ln.Na=Pr.Na=0),Vn.Hc=0,Vn.Gc=0,Vn.ia=0;else{var gi,Tr;if(Ln=Pr,Pr=mi,Hi=We.Pa.Xc,us=We.ya[We.aa+We.ja],Jr=We.pb[us.$b],Xn=us.ad,Ri=0,ms=We.rb[We.sb-1],rr=Ii=0,o(Xn,Ri,0,384),us.Za)var $i=0,bi=Hi[3];else{_r=s(16);var kr=Ln.Na+ms.Na;if(kr=$s(Pr,Hi[1],kr,Jr.Eb,0,_r,0),Ln.Na=ms.Na=(0<kr)+0,1<kr)Us(_r,0,Xn,Ri);else{var Li=_r[0]+3>>3;for(_r=0;256>_r;_r+=16)Xn[Ri+_r]=Li}$i=1,bi=Hi[0]}var Fr=15&Ln.la,Di=15&ms.la;for(_r=0;4>_r;++_r){var Bi=1&Di;for(Li=Tr=0;4>Li;++Li)Fr=Fr>>1|(Bi=(kr=$s(Pr,bi,kr=Bi+(1&Fr),Jr.Sc,$i,Xn,Ri))>$i)<<7,Tr=Tr<<2|(3<kr?3:1<kr?2:Xn[Ri+0]!=0),Ri+=16;Fr>>=4,Di=Di>>1|Bi<<7,Ii=(Ii<<8|Tr)>>>0}for(bi=Fr,$i=Di>>4,gi=0;4>gi;gi+=2){for(Tr=0,Fr=Ln.la>>4+gi,Di=ms.la>>4+gi,_r=0;2>_r;++_r){for(Bi=1&Di,Li=0;2>Li;++Li)kr=Bi+(1&Fr),Fr=Fr>>1|(Bi=0<(kr=$s(Pr,Hi[2],kr,Jr.Qc,0,Xn,Ri)))<<3,Tr=Tr<<2|(3<kr?3:1<kr?2:Xn[Ri+0]!=0),Ri+=16;Fr>>=2,Di=Di>>1|Bi<<5}rr|=Tr<<4*gi,bi|=Fr<<4<<gi,$i|=(240&Di)<<gi}Ln.la=bi,ms.la=$i,us.Hc=Ii,us.Gc=rr,us.ia=43690&rr?0:Jr.ia,Hi=!(Ii|rr)}if(0<We.L&&(We.wa[We.Y+We.ja]=We.gd[Vn.$b][Vn.Za],We.wa[We.Y+We.ja].La|=!Hi),mi.Ka)return Qe(lr,7,"Premature end-of-file encountered.")}if(xi(lr),We=ai,mi=1,Vn=(sn=lr).D,Ln=0<sn.L&&sn.M>=sn.zb&&sn.M<=sn.Va,sn.Aa==0)e:{if(Vn.M=sn.M,Vn.uc=Ln,qs(sn,Vn),mi=1,Vn=(Tr=sn.D).Nb,Ln=(rr=Ql[sn.L])*sn.R,Pr=rr/2*sn.B,_r=16*Vn*sn.R,Li=8*Vn*sn.B,Hi=sn.sa,us=sn.ta-Ln+_r,Jr=sn.qa,Xn=sn.ra-Pr+Li,Ri=sn.Ha,ms=sn.Ia-Pr+Li,Di=(Fr=Tr.M)==0,Ii=Fr>=sn.Va-1,sn.Aa==2&&qs(sn,Tr),Tr.uc)for(Bi=(kr=sn).D.M,e(kr.D.uc),Tr=kr.yb;Tr<kr.Hb;++Tr){$i=Tr,bi=Bi;var Vr=(xr=(Pi=kr).D).Nb;gi=Pi.R;var xr=xr.wa[xr.Y+$i],gs=Pi.sa,ki=Pi.ta+16*Vr*gi+16*$i,Cn=xr.dd,jn=xr.tc;if(jn!=0)if(e(3<=jn),Pi.L==1)0<$i&&md(gs,ki,gi,jn+4),xr.La&&Bf(gs,ki,gi,jn),0<bi&&pd(gs,ki,gi,jn+4),xr.La&&Df(gs,ki,gi,jn);else{var Ar=Pi.B,Ts=Pi.qa,aa=Pi.ra+8*Vr*Ar+8*$i,_s=Pi.Ha,Pi=Pi.Ia+8*Vr*Ar+8*$i;Vr=xr.ld,0<$i&&(ji(gs,ki,gi,jn+4,Cn,Vr),va(Ts,aa,_s,Pi,Ar,jn+4,Cn,Vr)),xr.La&&(Ru(gs,ki,gi,jn,Cn,Vr),dd(Ts,aa,_s,Pi,Ar,jn,Cn,Vr)),0<bi&&(Qr(gs,ki,gi,jn+4,Cn,Vr),Ba(Ts,aa,_s,Pi,Ar,jn+4,Cn,Vr)),xr.La&&(al(gs,ki,gi,jn,Cn,Vr),If(Ts,aa,_s,Pi,Ar,jn,Cn,Vr))}}if(sn.ia&&alert("todo:DitherRow"),We.put!=null){if(Tr=16*Fr,Fr=16*(Fr+1),Di?(We.y=sn.sa,We.O=sn.ta+_r,We.f=sn.qa,We.N=sn.ra+Li,We.ea=sn.Ha,We.W=sn.Ia+Li):(Tr-=rr,We.y=Hi,We.O=us,We.f=Jr,We.N=Xn,We.ea=Ri,We.W=ms),Ii||(Fr-=rr),Fr>We.o&&(Fr=We.o),We.F=null,We.J=null,sn.Fa!=null&&0<sn.Fa.length&&Tr<Fr&&(We.J=Zr(sn,We,Tr,Fr-Tr),We.F=sn.mb,We.F==null&&We.F.length==0)){mi=Qe(sn,3,"Could not decode alpha data.");break e}Tr<We.j&&(rr=We.j-Tr,Tr=We.j,e(!(1&rr)),We.O+=sn.R*rr,We.N+=sn.B*(rr>>1),We.W+=sn.B*(rr>>1),We.F!=null&&(We.J+=We.width*rr)),Tr<Fr&&(We.O+=We.v,We.N+=We.v>>1,We.W+=We.v>>1,We.F!=null&&(We.J+=We.v),We.ka=Tr-We.j,We.U=We.va-We.v,We.T=Fr-Tr,mi=We.put(We))}Vn+1!=sn.Ic||Ii||(r(sn.sa,sn.ta-Ln,Hi,us+16*sn.R,Ln),r(sn.qa,sn.ra-Pr,Jr,Xn+8*sn.B,Pr),r(sn.Ha,sn.Ia-Pr,Ri,ms+8*sn.B,Pr))}if(!mi)return Qe(lr,6,"Output aborted.")}return 1})(Ot,Wt)),Wt.bc!=null&&Wt.bc(Wt),Zt&=1}return Zt?(Ot.cb=0,Zt):0})(Y,ht)||(Q=Y.a)}}else Q=Y.a}Q==0&&St.Oa!=null&&St.Oa.fd&&(Q=Ou(St.ba))}St=Q}xt=St!=0?null:11>xt?Ct.f.RGBA.eb:Ct.f.kb.y}else xt=null;return xt};var Lc=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function i(U,q){for(var R="",I=0;I<4;I++)R+=String.fromCharCode(U[q++]);return R}function c(U,q){return U[q+0]|U[q+1]<<8}function p(U,q){return(U[q+0]|U[q+1]<<8|U[q+2]<<16)>>>0}function h(U,q){return(U[q+0]|U[q+1]<<8|U[q+2]<<16|U[q+3]<<24)>>>0}new l;var f=[0],g=[0],y=[],b=new l,v=n,w=(function(U,q){var R={},I=0,T=!1,L=0,E=0;if(R.frames=[],!(function(O,H){for(var X=0;X<4;X++)if(O[H+X]!="RIFF".charCodeAt(X))return!0;return!1})(U,q)){for(h(U,q+=4),q+=8;q<U.length;){var x=i(U,q),k=h(U,q+=4);q+=4;var A=k+(1&k);switch(x){case"VP8 ":case"VP8L":R.frames[I]===void 0&&(R.frames[I]={}),(B=R.frames[I]).src_off=T?E:q-8,B.src_size=L+k+8,I++,T&&(T=!1,L=0,E=0);break;case"VP8X":(B=R.header={}).feature_flags=U[q];var C=q+4;B.canvas_width=1+p(U,C),C+=3,B.canvas_height=1+p(U,C),C+=3;break;case"ALPH":T=!0,L=A+8,E=q-8;break;case"ANIM":(B=R.header).bgcolor=h(U,q),C=q+4,B.loop_count=c(U,C),C+=2;break;case"ANMF":var j,B;(B=R.frames[I]={}).offset_x=2*p(U,q),q+=3,B.offset_y=2*p(U,q),q+=3,B.width=1+p(U,q),q+=3,B.height=1+p(U,q),q+=3,B.duration=p(U,q),q+=3,j=U[q++],B.dispose=1&j,B.blend=j>>1&1}x!="ANMF"&&(q+=A)}return R}})(v,0);w.response=v,w.rgbaoutput=!0,w.dataurl=!1;var S=w.header?w.header:null,N=w.frames?w.frames:null;if(S){S.loop_counter=S.loop_count,f=[S.canvas_height],g=[S.canvas_width];for(var D=0;D<N.length&&N[D].blend!=0;D++);}var F=N[0],G=b.WebPDecodeRGBA(v,F.src_off,F.src_size,g,f);F.rgba=G,F.imgwidth=g[0],F.imgheight=f[0];for(var P=0;P<g[0]*f[0]*4;P++)y[P]=G[P];return this.width=g,this.height=f,this.data=y,this}(function(n){var e,t,r,o,s,a,u,l,i,c=function(O){return O=O||{},this.isStrokeTransparent=O.isStrokeTransparent||!1,this.strokeOpacity=O.strokeOpacity||1,this.strokeStyle=O.strokeStyle||"#000000",this.fillStyle=O.fillStyle||"#000000",this.isFillTransparent=O.isFillTransparent||!1,this.fillOpacity=O.fillOpacity||1,this.font=O.font||"10px sans-serif",this.textBaseline=O.textBaseline||"alphabetic",this.textAlign=O.textAlign||"left",this.lineWidth=O.lineWidth||1,this.lineJoin=O.lineJoin||"miter",this.lineCap=O.lineCap||"butt",this.path=O.path||[],this.transform=O.transform!==void 0?O.transform.clone():new l,this.globalCompositeOperation=O.globalCompositeOperation||"normal",this.globalAlpha=O.globalAlpha||1,this.clip_path=O.clip_path||[],this.currentPoint=O.currentPoint||new a,this.miterLimit=O.miterLimit||10,this.lastPoint=O.lastPoint||new a,this.lineDashOffset=O.lineDashOffset||0,this.lineDash=O.lineDash||[],this.margin=O.margin||[0,0,0,0],this.prevPageLastElemOffset=O.prevPageLastElemOffset||0,this.ignoreClearRect=typeof O.ignoreClearRect!="boolean"||O.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new p(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,o=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,u=this.internal.Rectangle,l=this.internal.Matrix,i=new c}]);var p=function(O){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=O;Object.defineProperty(this,"pdf",{get:function(){return H}});var X=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return X},set:function(rt){X=!!rt}});var et=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return et},set:function(rt){et=!!rt}});var V=0;Object.defineProperty(this,"posX",{get:function(){return V},set:function(rt){isNaN(rt)||(V=rt)}});var tt=0;Object.defineProperty(this,"posY",{get:function(){return tt},set:function(rt){isNaN(rt)||(tt=rt)}}),Object.defineProperty(this,"margin",{get:function(){return i.margin},set:function(rt){var ct;typeof rt=="number"?ct=[rt,rt,rt,rt]:((ct=new Array(4))[0]=rt[0],ct[1]=rt.length>=2?rt[1]:ct[0],ct[2]=rt.length>=3?rt[2]:ct[0],ct[3]=rt.length>=4?rt[3]:ct[1]),i.margin=ct}});var $=!1;Object.defineProperty(this,"autoPaging",{get:function(){return $},set:function(rt){$=rt}});var z=0;Object.defineProperty(this,"lastBreak",{get:function(){return z},set:function(rt){z=rt}});var Z=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Z},set:function(rt){Z=rt}}),Object.defineProperty(this,"ctx",{get:function(){return i},set:function(rt){rt instanceof c&&(i=rt)}}),Object.defineProperty(this,"path",{get:function(){return i.path},set:function(rt){i.path=rt}});var it=[];Object.defineProperty(this,"ctxStack",{get:function(){return it},set:function(rt){it=rt}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(rt){var ct;ct=h(rt),this.ctx.fillStyle=ct.style,this.ctx.isFillTransparent=ct.a===0,this.ctx.fillOpacity=ct.a,this.pdf.setFillColor(ct.r,ct.g,ct.b,{a:ct.a}),this.pdf.setTextColor(ct.r,ct.g,ct.b,{a:ct.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(rt){var ct=h(rt);this.ctx.strokeStyle=ct.style,this.ctx.isStrokeTransparent=ct.a===0,this.ctx.strokeOpacity=ct.a,ct.a===0?this.pdf.setDrawColor(255,255,255):(ct.a,this.pdf.setDrawColor(ct.r,ct.g,ct.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(rt){["butt","round","square"].indexOf(rt)!==-1&&(this.ctx.lineCap=rt,this.pdf.setLineCap(rt))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(rt){isNaN(rt)||(this.ctx.lineWidth=rt,this.pdf.setLineWidth(rt))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(rt){["bevel","round","miter"].indexOf(rt)!==-1&&(this.ctx.lineJoin=rt,this.pdf.setLineJoin(rt))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(rt){isNaN(rt)||(this.ctx.miterLimit=rt,this.pdf.setMiterLimit(rt))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(rt){this.ctx.textBaseline=rt}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(rt){["right","end","center","left","start"].indexOf(rt)!==-1&&(this.ctx.textAlign=rt)}});var mt=null,lt=null,at=null;Object.defineProperty(this,"fontFaces",{get:function(){return at},set:function(rt){mt=null,lt=null,at=rt}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(rt){var ct;if(this.ctx.font=rt,(ct=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(rt))!==null){var ot=ct[1];ct[2];var dt=ct[3],ft=ct[4];ct[5];var gt=ct[6],wt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ft)[2];ft=Math.floor(wt==="px"?parseFloat(ft)*this.pdf.internal.scaleFactor:wt==="em"?parseFloat(ft)*this.pdf.getFontSize():parseFloat(ft)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ft);var yt=(function(ae){var Oe,le,Jt=[],ue=ae.trim();if(ue==="")return ig;if(ue in l3)return[l3[ue]];for(;ue!=="";){switch(le=null,Oe=(ue=c3(ue)).charAt(0)){case'"':case"'":le=Dq(ue.substring(1),Oe);break;default:le=Bq(ue)}if(le===null||(Jt.push(le[0]),(ue=c3(le[1]))!==""&&ue.charAt(0)!==","))return ig;ue=ue.replace(/^,/,"")}return Jt})(gt);if(this.fontFaces){var Et=(function(ae,Oe){var le=ae.getFontList(),Jt=JSON.stringify(le);if(mt===null||lt!==Jt){var ue=(function(ge){var fe=[];return Object.keys(ge).forEach(function(qe){ge[qe].forEach(function(Be){var ke=null;switch(Be){case"bold":ke={family:qe,weight:"bold"};break;case"italic":ke={family:qe,style:"italic"};break;case"bolditalic":ke={family:qe,weight:"bold",style:"italic"};break;case"":case"normal":ke={family:qe}}ke!==null&&(ke.ref={name:qe,style:Be},fe.push(ke))})}),fe})(le);mt=(function(ge){for(var fe={},qe=0;qe<ge.length;++qe){var Be=rg(ge[qe]),ke=Be.family,Je=Be.stretch,Fe=Be.style,Me=Be.weight;fe[ke]=fe[ke]||{},fe[ke][Je]=fe[ke][Je]||{},fe[ke][Je][Fe]=fe[ke][Je][Fe]||{},fe[ke][Je][Fe][Me]=Be}return fe})(ue.concat(Oe)),lt=Jt}return mt})(this.pdf,this.fontFaces),Mt=yt.map(function(ae){return{family:ae,stretch:"normal",weight:dt,style:ot}}),qt=(function(ae,Oe,le){for(var Jt=(le=le||{}).defaultFontFamily||"times",ue=Object.assign({},Iq,le.genericFontFamilies||{}),ge=null,fe=null,qe=0;qe<Oe.length;++qe)if(ue[(ge=rg(Oe[qe])).family]&&(ge.family=ue[ge.family]),ae.hasOwnProperty(ge.family)){fe=ae[ge.family];break}if(!(fe=fe||ae[Jt]))throw new Error("Could not find a font-family for the rule '"+u3(ge)+"' and default family '"+Jt+"'.");if(fe=(function(Be,ke){if(ke[Be])return ke[Be];var Je=cb[Be],Fe=Je<=cb.normal?-1:1,Me=o3(ke,pS,Je,Fe);if(!Me)throw new Error("Could not find a matching font-stretch value for "+Be);return Me})(ge.stretch,fe),fe=(function(Be,ke){if(ke[Be])return ke[Be];for(var Je=dS[Be],Fe=0;Fe<Je.length;++Fe)if(ke[Je[Fe]])return ke[Je[Fe]];throw new Error("Could not find a matching font-style for "+Be)})(ge.style,fe),!(fe=(function(Be,ke){if(ke[Be])return ke[Be];if(Be===400&&ke[500])return ke[500];if(Be===500&&ke[400])return ke[400];var Je=Rq[Be],Fe=o3(ke,mS,Je,Be<400?-1:1);if(!Fe)throw new Error("Could not find a matching font-weight for value "+Be);return Fe})(ge.weight,fe)))throw new Error("Failed to resolve a font for the rule '"+u3(ge)+"'.");return fe})(Et,Mt);this.pdf.setFont(qt.ref.name,qt.ref.style)}else{var Tt="";(dt==="bold"||parseInt(dt,10)>=700||ot==="bold")&&(Tt="bold"),ot==="italic"&&(Tt+="italic"),Tt.length===0&&(Tt="normal");for(var It="",Vt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Kt=0;Kt<yt.length;Kt++){if(this.pdf.internal.getFont(yt[Kt],Tt,{noFallback:!0,disableWarning:!0})!==void 0){It=yt[Kt];break}if(Tt==="bolditalic"&&this.pdf.internal.getFont(yt[Kt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)It=yt[Kt],Tt="bold";else if(this.pdf.internal.getFont(yt[Kt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){It=yt[Kt],Tt="normal";break}}if(It===""){for(var ne=0;ne<yt.length;ne++)if(Vt[yt[ne]]){It=Vt[yt[ne]];break}}It=It===""?"Times":It,this.pdf.setFont(It,Tt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(rt){this.ctx.globalCompositeOperation=rt}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(rt){this.ctx.globalAlpha=rt}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(rt){this.ctx.lineDashOffset=rt,B.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(rt){this.ctx.lineDash=rt,B.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(rt){this.ctx.ignoreClearRect=!!rt}})};p.prototype.setLineDash=function(O){this.lineDash=O},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){N.call(this,"fill",!1)},p.prototype.stroke=function(){N.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(O,H){if(isNaN(O)||isNaN(H))throw li.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var X=this.ctx.transform.applyToPoint(new a(O,H));this.path.push({type:"mt",x:X.x,y:X.y}),this.ctx.lastPoint=new a(O,H)},p.prototype.closePath=function(){var O=new a(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&Yr(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){O=new a(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(O.x,O.y)},p.prototype.lineTo=function(O,H){if(isNaN(O)||isNaN(H))throw li.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var X=this.ctx.transform.applyToPoint(new a(O,H));this.path.push({type:"lt",x:X.x,y:X.y}),this.ctx.lastPoint=new a(X.x,X.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},p.prototype.quadraticCurveTo=function(O,H,X,et){if(isNaN(X)||isNaN(et)||isNaN(O)||isNaN(H))throw li.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var V=this.ctx.transform.applyToPoint(new a(X,et)),tt=this.ctx.transform.applyToPoint(new a(O,H));this.path.push({type:"qct",x1:tt.x,y1:tt.y,x:V.x,y:V.y}),this.ctx.lastPoint=new a(V.x,V.y)},p.prototype.bezierCurveTo=function(O,H,X,et,V,tt){if(isNaN(V)||isNaN(tt)||isNaN(O)||isNaN(H)||isNaN(X)||isNaN(et))throw li.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var $=this.ctx.transform.applyToPoint(new a(V,tt)),z=this.ctx.transform.applyToPoint(new a(O,H)),Z=this.ctx.transform.applyToPoint(new a(X,et));this.path.push({type:"bct",x1:z.x,y1:z.y,x2:Z.x,y2:Z.y,x:$.x,y:$.y}),this.ctx.lastPoint=new a($.x,$.y)},p.prototype.arc=function(O,H,X,et,V,tt){if(isNaN(O)||isNaN(H)||isNaN(X)||isNaN(et)||isNaN(V))throw li.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(tt=!!tt,!this.ctx.transform.isIdentity){var $=this.ctx.transform.applyToPoint(new a(O,H));O=$.x,H=$.y;var z=this.ctx.transform.applyToPoint(new a(0,X)),Z=this.ctx.transform.applyToPoint(new a(0,0));X=Math.sqrt(Math.pow(z.x-Z.x,2)+Math.pow(z.y-Z.y,2))}Math.abs(V-et)>=2*Math.PI&&(et=0,V=2*Math.PI),this.path.push({type:"arc",x:O,y:H,radius:X,startAngle:et,endAngle:V,counterclockwise:tt})},p.prototype.arcTo=function(O,H,X,et,V){throw new Error("arcTo not implemented.")},p.prototype.rect=function(O,H,X,et){if(isNaN(O)||isNaN(H)||isNaN(X)||isNaN(et))throw li.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(O,H),this.lineTo(O+X,H),this.lineTo(O+X,H+et),this.lineTo(O,H+et),this.lineTo(O,H),this.lineTo(O+X,H),this.lineTo(O,H)},p.prototype.fillRect=function(O,H,X,et){if(isNaN(O)||isNaN(H)||isNaN(X)||isNaN(et))throw li.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var V={};this.lineCap!=="butt"&&(V.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(V.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(O,H,X,et),this.fill(),V.hasOwnProperty("lineCap")&&(this.lineCap=V.lineCap),V.hasOwnProperty("lineJoin")&&(this.lineJoin=V.lineJoin)}},p.prototype.strokeRect=function(O,H,X,et){if(isNaN(O)||isNaN(H)||isNaN(X)||isNaN(et))throw li.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(O,H,X,et),this.stroke())},p.prototype.clearRect=function(O,H,X,et){if(isNaN(O)||isNaN(H)||isNaN(X)||isNaN(et))throw li.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(O,H,X,et))},p.prototype.save=function(O){O=typeof O!="boolean"||O;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,X=0;X<this.pdf.internal.getNumberOfPages();X++)this.pdf.setPage(X+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),O){this.ctx.fontSize=this.pdf.internal.getFontSize();var et=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=et}},p.prototype.restore=function(O){O=typeof O!="boolean"||O;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,X=0;X<this.pdf.internal.getNumberOfPages();X++)this.pdf.setPage(X+1),this.pdf.internal.out("Q");this.pdf.setPage(H),O&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(O){var H,X,et,V;if(O.isCanvasGradient===!0&&(O=O.getColor()),!O)return{r:0,g:0,b:0,a:0,style:O};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(O))H=0,X=0,et=0,V=0;else{var tt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(O);if(tt!==null)H=parseInt(tt[1]),X=parseInt(tt[2]),et=parseInt(tt[3]),V=1;else if((tt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(O))!==null)H=parseInt(tt[1]),X=parseInt(tt[2]),et=parseInt(tt[3]),V=parseFloat(tt[4]);else{if(V=1,typeof O=="string"&&O.charAt(0)!=="#"){var $=new aS(O);O=$.ok?$.toHex():"#000000"}O.length===4?(H=O.substring(1,2),H+=H,X=O.substring(2,3),X+=X,et=O.substring(3,4),et+=et):(H=O.substring(1,3),X=O.substring(3,5),et=O.substring(5,7)),H=parseInt(H,16),X=parseInt(X,16),et=parseInt(et,16)}}return{r:H,g:X,b:et,a:V,style:O}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(O,H,X,et){if(isNaN(H)||isNaN(X)||typeof O!="string")throw li.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(et=isNaN(et)?void 0:et,!f.call(this)){var V=A(this.ctx.transform.rotation),tt=this.ctx.transform.scaleX;I.call(this,{text:O,x:H,y:X,scale:tt,angle:V,align:this.textAlign,maxWidth:et})}},p.prototype.strokeText=function(O,H,X,et){if(isNaN(H)||isNaN(X)||typeof O!="string")throw li.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){et=isNaN(et)?void 0:et;var V=A(this.ctx.transform.rotation),tt=this.ctx.transform.scaleX;I.call(this,{text:O,x:H,y:X,scale:tt,renderingMode:"stroke",angle:V,align:this.textAlign,maxWidth:et})}},p.prototype.measureText=function(O){if(typeof O!="string")throw li.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,X=this.pdf.internal.scaleFactor,et=H.internal.getFontSize(),V=H.getStringUnitWidth(O)*et/H.internal.scaleFactor;return new function(tt){var $=(tt=tt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return $}}),this}({width:V*=Math.round(96*X/72*1e4)/1e4})},p.prototype.scale=function(O,H){if(isNaN(O)||isNaN(H))throw li.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var X=new l(O,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(X)},p.prototype.rotate=function(O){if(isNaN(O))throw li.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new l(Math.cos(O),Math.sin(O),-Math.sin(O),Math.cos(O),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},p.prototype.translate=function(O,H){if(isNaN(O)||isNaN(H))throw li.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var X=new l(1,0,0,1,O,H);this.ctx.transform=this.ctx.transform.multiply(X)},p.prototype.transform=function(O,H,X,et,V,tt){if(isNaN(O)||isNaN(H)||isNaN(X)||isNaN(et)||isNaN(V)||isNaN(tt))throw li.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var $=new l(O,H,X,et,V,tt);this.ctx.transform=this.ctx.transform.multiply($)},p.prototype.setTransform=function(O,H,X,et,V,tt){O=isNaN(O)?1:O,H=isNaN(H)?0:H,X=isNaN(X)?0:X,et=isNaN(et)?1:et,V=isNaN(V)?0:V,tt=isNaN(tt)?0:tt,this.ctx.transform=new l(O,H,X,et,V,tt)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(O,H,X,et,V,tt,$,z,Z){var it=this.pdf.getImageProperties(O),mt=1,lt=1,at=1,rt=1;et!==void 0&&z!==void 0&&(at=z/et,rt=Z/V,mt=it.width/et*z/et,lt=it.height/V*Z/V),tt===void 0&&(tt=H,$=X,H=0,X=0),et!==void 0&&z===void 0&&(z=et,Z=V),et===void 0&&z===void 0&&(z=it.width,Z=it.height);var ct=this.ctx.transform.decompose(),ot=A(ct.rotate.shx),dt=new l,ft=(dt=(dt=(dt=dt.multiply(ct.translate)).multiply(ct.skew)).multiply(ct.scale)).applyToRectangle(new u(tt-H*at,$-X*rt,et*mt,V*lt));if(this.autoPaging){for(var gt,wt=b.call(this,ft),yt=[],Et=0;Et<wt.length;Et+=1)yt.indexOf(wt[Et])===-1&&yt.push(wt[Et]);S(yt);for(var Mt=yt[0],qt=yt[yt.length-1],Tt=Mt;Tt<qt+1;Tt++){this.pdf.setPage(Tt);var It=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Vt=Tt===1?this.posY+this.margin[0]:this.margin[0],Kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ne=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ae=Tt===1?0:Kt+(Tt-2)*ne;if(this.ctx.clip_path.length!==0){var Oe=this.path;gt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(gt,this.posX+this.margin[3],-ae+Vt+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=Oe}var le=JSON.parse(JSON.stringify(ft));le=w([le],this.posX+this.margin[3],-ae+Vt+this.ctx.prevPageLastElemOffset)[0];var Jt=(Tt>Mt||Tt<qt)&&y.call(this);Jt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],It,ne,null).clip().discardPath()),this.pdf.addImage(O,"JPEG",le.x,le.y,le.w,le.h,null,null,ot),Jt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(O,"JPEG",ft.x,ft.y,ft.w,ft.h,null,null,ot)};var b=function(O,H,X){var et=[];H=H||this.pdf.internal.pageSize.width,X=X||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var V=this.posY+this.ctx.prevPageLastElemOffset;switch(O.type){default:case"mt":case"lt":et.push(Math.floor((O.y+V)/X)+1);break;case"arc":et.push(Math.floor((O.y+V-O.radius)/X)+1),et.push(Math.floor((O.y+V+O.radius)/X)+1);break;case"qct":var tt=C(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x,O.y);et.push(Math.floor((tt.y+V)/X)+1),et.push(Math.floor((tt.y+tt.h+V)/X)+1);break;case"bct":var $=j(this.ctx.lastPoint.x,this.ctx.lastPoint.y,O.x1,O.y1,O.x2,O.y2,O.x,O.y);et.push(Math.floor(($.y+V)/X)+1),et.push(Math.floor(($.y+$.h+V)/X)+1);break;case"rect":et.push(Math.floor((O.y+V)/X)+1),et.push(Math.floor((O.y+O.h+V)/X)+1)}for(var z=0;z<et.length;z+=1)for(;this.pdf.internal.getNumberOfPages()<et[z];)v.call(this);return et},v=function(){var O=this.fillStyle,H=this.strokeStyle,X=this.font,et=this.lineCap,V=this.lineWidth,tt=this.lineJoin;this.pdf.addPage(),this.fillStyle=O,this.strokeStyle=H,this.font=X,this.lineCap=et,this.lineWidth=V,this.lineJoin=tt},w=function(O,H,X){for(var et=0;et<O.length;et++)switch(O[et].type){case"bct":O[et].x2+=H,O[et].y2+=X;case"qct":O[et].x1+=H,O[et].y1+=X;default:O[et].x+=H,O[et].y+=X}return O},S=function(O){return O.sort(function(H,X){return H-X})},N=function(O,H){var X=this.fillStyle,et=this.strokeStyle,V=this.lineCap,tt=this.lineWidth,$=Math.abs(tt*this.ctx.transform.scaleX),z=this.lineJoin;if(this.autoPaging){for(var Z,it,mt=JSON.parse(JSON.stringify(this.path)),lt=JSON.parse(JSON.stringify(this.path)),at=[],rt=0;rt<lt.length;rt++)if(lt[rt].x!==void 0)for(var ct=b.call(this,lt[rt]),ot=0;ot<ct.length;ot+=1)at.indexOf(ct[ot])===-1&&at.push(ct[ot]);for(var dt=0;dt<at.length;dt++)for(;this.pdf.internal.getNumberOfPages()<at[dt];)v.call(this);S(at);for(var ft=at[0],gt=at[at.length-1],wt=ft;wt<gt+1;wt++){this.pdf.setPage(wt),this.fillStyle=X,this.strokeStyle=et,this.lineCap=V,this.lineWidth=$,this.lineJoin=z;var yt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Et=wt===1?this.posY+this.margin[0]:this.margin[0],Mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Tt=wt===1?0:Mt+(wt-2)*qt;if(this.ctx.clip_path.length!==0){var It=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(Z,this.posX+this.margin[3],-Tt+Et+this.ctx.prevPageLastElemOffset),D.call(this,O,!0),this.path=It}if(it=JSON.parse(JSON.stringify(mt)),this.path=w(it,this.posX+this.margin[3],-Tt+Et+this.ctx.prevPageLastElemOffset),H===!1||wt===0){var Vt=(wt>ft||wt<gt)&&y.call(this);Vt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],yt,qt,null).clip().discardPath()),D.call(this,O,H),Vt&&this.pdf.restoreGraphicsState()}this.lineWidth=tt}this.path=mt}else this.lineWidth=$,D.call(this,O,H),this.lineWidth=tt},D=function(O,H){if((O!=="stroke"||H||!g.call(this))&&(O==="stroke"||H||!f.call(this))){for(var X,et,V=[],tt=this.path,$=0;$<tt.length;$++){var z=tt[$];switch(z.type){case"begin":V.push({begin:!0});break;case"close":V.push({close:!0});break;case"mt":V.push({start:z,deltas:[],abs:[]});break;case"lt":var Z=V.length;if(tt[$-1]&&!isNaN(tt[$-1].x)&&(X=[z.x-tt[$-1].x,z.y-tt[$-1].y],Z>0)){for(;Z>=0;Z--)if(V[Z-1].close!==!0&&V[Z-1].begin!==!0){V[Z-1].deltas.push(X),V[Z-1].abs.push(z);break}}break;case"bct":X=[z.x1-tt[$-1].x,z.y1-tt[$-1].y,z.x2-tt[$-1].x,z.y2-tt[$-1].y,z.x-tt[$-1].x,z.y-tt[$-1].y],V[V.length-1].deltas.push(X);break;case"qct":var it=tt[$-1].x+2/3*(z.x1-tt[$-1].x),mt=tt[$-1].y+2/3*(z.y1-tt[$-1].y),lt=z.x+2/3*(z.x1-z.x),at=z.y+2/3*(z.y1-z.y),rt=z.x,ct=z.y;X=[it-tt[$-1].x,mt-tt[$-1].y,lt-tt[$-1].x,at-tt[$-1].y,rt-tt[$-1].x,ct-tt[$-1].y],V[V.length-1].deltas.push(X);break;case"arc":V.push({deltas:[],abs:[],arc:!0}),Array.isArray(V[V.length-1].abs)&&V[V.length-1].abs.push(z)}}et=H?null:O==="stroke"?"stroke":"fill";for(var ot=!1,dt=0;dt<V.length;dt++)if(V[dt].arc)for(var ft=V[dt].abs,gt=0;gt<ft.length;gt++){var wt=ft[gt];wt.type==="arc"?P.call(this,wt.x,wt.y,wt.radius,wt.startAngle,wt.endAngle,wt.counterclockwise,void 0,H,!ot):T.call(this,wt.x,wt.y),ot=!0}else if(V[dt].close===!0)this.pdf.internal.out("h"),ot=!1;else if(V[dt].begin!==!0){var yt=V[dt].start.x,Et=V[dt].start.y;L.call(this,V[dt].deltas,yt,Et),ot=!0}et&&U.call(this,et),H&&q.call(this)}},F=function(O){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,X=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return O-X;case"top":return O+H-X;case"hanging":return O+H-2*X;case"middle":return O+H/2-X;default:return O}},G=function(O){return O+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var O=function(){};return O.colorStops=[],O.addColorStop=function(H,X){this.colorStops.push([H,X])},O.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},O.isCanvasGradient=!0,O},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(O,H,X,et,V,tt,$,z,Z){for(var it=x.call(this,X,et,V,tt),mt=0;mt<it.length;mt++){var lt=it[mt];mt===0&&(Z?R.call(this,lt.x1+O,lt.y1+H):T.call(this,lt.x1+O,lt.y1+H)),E.call(this,O,H,lt.x2,lt.y2,lt.x3,lt.y3,lt.x4,lt.y4)}z?q.call(this):U.call(this,$)},U=function(O){switch(O){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},q=function(){this.pdf.clip(),this.pdf.discardPath()},R=function(O,H){this.pdf.internal.out(t(O)+" "+r(H)+" m")},I=function(O){var H;switch(O.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var X,et,V,tt=this.pdf.getTextDimensions(O.text),$=F.call(this,O.y),z=G.call(this,$)-tt.h,Z=this.ctx.transform.applyToPoint(new a(O.x,$));if(this.autoPaging){var it=this.ctx.transform.decompose(),mt=new l;mt=(mt=(mt=mt.multiply(it.translate)).multiply(it.skew)).multiply(it.scale);for(var lt=this.ctx.transform.applyToRectangle(new u(O.x,$,tt.w,tt.h)),at=mt.applyToRectangle(new u(O.x,z,tt.w,tt.h)),rt=b.call(this,at),ct=[],ot=0;ot<rt.length;ot+=1)ct.indexOf(rt[ot])===-1&&ct.push(rt[ot]);S(ct);for(var dt=ct[0],ft=ct[ct.length-1],gt=dt;gt<ft+1;gt++){this.pdf.setPage(gt);var wt=gt===1?this.posY+this.margin[0]:this.margin[0],yt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Et=this.pdf.internal.pageSize.height-this.margin[2],Mt=Et-this.margin[0],qt=this.pdf.internal.pageSize.width-this.margin[1],Tt=qt-this.margin[3],It=gt===1?0:yt+(gt-2)*Mt;if(this.ctx.clip_path.length!==0){var Vt=this.path;X=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(X,this.posX+this.margin[3],-1*It+wt),D.call(this,"fill",!0),this.path=Vt}var Kt=w([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-It+wt+this.ctx.prevPageLastElemOffset)[0];O.scale>=.01&&(et=this.pdf.internal.getFontSize(),this.pdf.setFontSize(et*O.scale),V=this.lineWidth,this.lineWidth=V*O.scale);var ne=this.autoPaging!=="text";if(ne||Kt.y+Kt.h<=Et){if(ne||Kt.y>=wt&&Kt.x<=qt){var ae=ne?O.text:this.pdf.splitTextToSize(O.text,O.maxWidth||qt-Kt.x)[0],Oe=w([JSON.parse(JSON.stringify(lt))],this.posX+this.margin[3],-It+wt+this.ctx.prevPageLastElemOffset)[0],le=ne&&(gt>dt||gt<ft)&&y.call(this);le&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,Mt,null).clip().discardPath()),this.pdf.text(ae,Oe.x,Oe.y,{angle:O.angle,align:H,renderingMode:O.renderingMode}),le&&this.pdf.restoreGraphicsState()}}else Kt.y<Et&&(this.ctx.prevPageLastElemOffset+=Et-Kt.y);O.scale>=.01&&(this.pdf.setFontSize(et),this.lineWidth=V)}}else O.scale>=.01&&(et=this.pdf.internal.getFontSize(),this.pdf.setFontSize(et*O.scale),V=this.lineWidth,this.lineWidth=V*O.scale),this.pdf.text(O.text,Z.x+this.posX,Z.y+this.posY,{angle:O.angle,align:H,renderingMode:O.renderingMode,maxWidth:O.maxWidth}),O.scale>=.01&&(this.pdf.setFontSize(et),this.lineWidth=V)},T=function(O,H,X,et){X=X||0,et=et||0,this.pdf.internal.out(t(O+X)+" "+r(H+et)+" l")},L=function(O,H,X){return this.pdf.lines(O,H,X,null,null)},E=function(O,H,X,et,V,tt,$,z){this.pdf.internal.out([e(o(X+O)),e(s(et+H)),e(o(V+O)),e(s(tt+H)),e(o($+O)),e(s(z+H)),"c"].join(" "))},x=function(O,H,X,et){for(var V=2*Math.PI,tt=Math.PI/2;H>X;)H-=V;var $=Math.abs(X-H);$<V&&et&&($=V-$);for(var z=[],Z=et?-1:1,it=H;$>1e-5;){var mt=it+Z*Math.min($,tt);z.push(k.call(this,O,it,mt)),$-=Math.abs(mt-it),it=mt}return z},k=function(O,H,X){var et=(X-H)/2,V=O*Math.cos(et),tt=O*Math.sin(et),$=V,z=-tt,Z=$*$+z*z,it=Z+$*V+z*tt,mt=4/3*(Math.sqrt(2*Z*it)-it)/($*tt-z*V),lt=$-mt*z,at=z+mt*$,rt=lt,ct=-at,ot=et+H,dt=Math.cos(ot),ft=Math.sin(ot);return{x1:O*Math.cos(H),y1:O*Math.sin(H),x2:lt*dt-at*ft,y2:lt*ft+at*dt,x3:rt*dt-ct*ft,y3:rt*ft+ct*dt,x4:O*Math.cos(X),y4:O*Math.sin(X)}},A=function(O){return 180*O/Math.PI},C=function(O,H,X,et,V,tt){var $=O+.5*(X-O),z=H+.5*(et-H),Z=V+.5*(X-V),it=tt+.5*(et-tt),mt=Math.min(O,V,$,Z),lt=Math.max(O,V,$,Z),at=Math.min(H,tt,z,it),rt=Math.max(H,tt,z,it);return new u(mt,at,lt-mt,rt-at)},j=function(O,H,X,et,V,tt,$,z){var Z,it,mt,lt,at,rt,ct,ot,dt,ft,gt,wt,yt,Et,Mt=X-O,qt=et-H,Tt=V-X,It=tt-et,Vt=$-V,Kt=z-tt;for(it=0;it<41;it++)dt=(ct=(mt=O+(Z=it/40)*Mt)+Z*((at=X+Z*Tt)-mt))+Z*(at+Z*(V+Z*Vt-at)-ct),ft=(ot=(lt=H+Z*qt)+Z*((rt=et+Z*It)-lt))+Z*(rt+Z*(tt+Z*Kt-rt)-ot),it==0?(gt=dt,wt=ft,yt=dt,Et=ft):(gt=Math.min(gt,dt),wt=Math.min(wt,ft),yt=Math.max(yt,dt),Et=Math.max(Et,ft));return new u(Math.round(gt),Math.round(wt),Math.round(yt-gt),Math.round(Et-wt))},B=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var O,H,X=(O=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:O,lineDashOffset:H}));this.prevLineDash!==X&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=X)}}})(xn.API),(function(n){var e=function(a){var u,l,i,c,p,h,f,g,y,b;for(l=[],i=0,c=(a+=u="\0\0\0\0".slice(a.length%4||4)).length;c>i;i+=4)(p=(a.charCodeAt(i)<<24)+(a.charCodeAt(i+1)<<16)+(a.charCodeAt(i+2)<<8)+a.charCodeAt(i+3))!==0?(h=(p=((p=((p=((p=(p-(b=p%85))/85)-(y=p%85))/85)-(g=p%85))/85)-(f=p%85))/85)%85,l.push(h+33,f+33,g+33,y+33,b+33)):l.push(122);return(function(v,w){for(var S=w;S>0;S--)v.pop()})(l,u.length),String.fromCharCode.apply(String,l)+"~>"},t=function(a){var u,l,i,c,p,h=String,f="length",g=255,y="charCodeAt",b="slice",v="replace";for(a[b](-2),a=a[b](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),i=[],c=0,p=(a+=u="uuuuu"[b](a[f]%5||5))[f];p>c;c+=5)l=52200625*(a[y](c)-33)+614125*(a[y](c+1)-33)+7225*(a[y](c+2)-33)+85*(a[y](c+3)-33)+(a[y](c+4)-33),i.push(g&l>>24,g&l>>16,g&l>>8,g&l);return(function(w,S){for(var N=S;N>0;N--)w.pop()})(i,u[f]),h.fromCharCode.apply(h,i)},r=function(a){return a.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">"},o=function(a){var u=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),u.test(a)===!1)return"";for(var l="",i=0;i<a.length;i+=2)l+=String.fromCharCode("0x"+(a[i]+a[i+1]));return l},s=function(a){for(var u=new Uint8Array(a.length),l=a.length;l--;)u[l]=a.charCodeAt(l);return(u=rb(u)).reduce(function(i,c){return i+String.fromCharCode(c)},"")};n.processDataByFilters=function(a,u){var l=0,i=a||"",c=[];for(typeof(u=u||[])=="string"&&(u=[u]),l=0;l<u.length;l+=1)switch(u[l]){case"ASCII85Decode":case"/ASCII85Decode":i=t(i),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":i=e(i),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":i=o(i),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":i=r(i),c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":i=s(i),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+u[l]+'" is not implemented')}return{data:i,reverseChain:c.reverse().join(" ")}}})(xn.API),(function(n){n.loadFile=function(e,t,r){return(function(o,s,a){s=s!==!1,a=typeof a=="function"?a:function(){};var u=void 0;try{u=(function(l,i,c){var p=new XMLHttpRequest,h=0,f=function(g){var y=g.length,b=[],v=String.fromCharCode;for(h=0;h<y;h+=1)b.push(v(255&g.charCodeAt(h)));return b.join("")};if(p.open("GET",l,!i),p.overrideMimeType("text/plain; charset=x-user-defined"),i===!1&&(p.onload=function(){p.status===200?c(f(this.responseText)):c(void 0)}),p.send(null),i&&p.status===200)return f(p.responseText)})(o,s,a)}catch{}return u})(e,t,r)},n.loadImageFile=n.loadFile})(xn.API),(function(n){function e(){return(zn.html2canvas?Promise.resolve(zn.html2canvas):Mh(()=>import("./html2canvas.esm-Ge7aVWlp.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load html2canvas: "+u))}).then(function(u){return u.default?u.default:u})}function t(){return(zn.DOMPurify?Promise.resolve(zn.DOMPurify):Mh(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(u){return Promise.reject(new Error("Could not load dompurify: "+u))}).then(function(u){return u.default?u.default:u})}var r=function(u){var l=Yr(u);return l==="undefined"?"undefined":l==="string"||u instanceof String?"string":l==="number"||u instanceof Number?"number":l==="function"||u instanceof Function?"function":u&&u.constructor===Array?"array":u&&u.nodeType===1?"element":l==="object"?"object":"unknown"},o=function(u,l){var i=document.createElement(u);for(var c in l.className&&(i.className=l.className),l.innerHTML&&l.dompurify&&(i.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)i.style[c]=l.style[c];return i},s=function u(l,i){for(var c=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),p=l.firstChild;p;p=p.nextSibling)i!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||c.appendChild(u(p,i));return l.nodeType===1&&(l.nodeName==="CANVAS"?(c.width=l.width,c.height=l.height,c.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(c.value=l.value),c.addEventListener("load",function(){c.scrollTop=l.scrollTop,c.scrollLeft=l.scrollLeft},!0)),c},a=function u(l){var i=Object.assign(u.convert(Promise.resolve()),JSON.parse(JSON.stringify(u.template))),c=u.convert(Promise.resolve(),i);return(c=c.setProgress(1,u,1,[u])).set(l)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(u,l){return u.__proto__=l||a.prototype,u},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(u,l){return this.then(function(){switch(l=l||(function(i){switch(r(i)){case"string":return"string";case"element":return i.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(u),l){case"string":return this.then(t).then(function(i){return this.set({src:o("div",{innerHTML:u,dompurify:i})})});case"element":return this.set({src:u});case"canvas":return this.set({canvas:u});case"img":return this.set({img:u});default:return this.error("Unknown source type.")}})},a.prototype.to=function(u){switch(u){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var u={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(u.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:u}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(e).then(function(l){var i=Object.assign({},this.opt.html2canvas);return delete i.onrendered,l(this.prop.container,i)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var u=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(u).then(e).then(function(l){var i=this.opt.jsPDF,c=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,i.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,i.context2d.posX=this.opt.x,i.context2d.posY=this.opt.y,i.context2d.margin=this.opt.margin,i.context2d.fontFaces=c,c)for(var f=0;f<c.length;++f){var g=c[f],y=g.src.find(function(b){return b.format==="truetype"});y&&i.addFont(y.url,g.ref.name,g.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,i.context2d.save(!0),l(this.prop.container,h)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var u=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=u})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(u,l,i){return(i=i||"pdf").toLowerCase()==="img"||i.toLowerCase()==="image"?this.outputImg(u,l):this.outputPdf(u,l)},a.prototype.outputPdf=function(u,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(u,l)})},a.prototype.outputImg=function(u){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(u){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+u+'" is not supported.'}})},a.prototype.save=function(u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(u?{filename:u}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(u){if(r(u)!=="object")return this;var l=Object.keys(u||{}).map(function(i){if(i in a.template.prop)return function(){this.prop[i]=u[i]};switch(i){case"margin":return this.setMargin.bind(this,u.margin);case"jsPDF":return function(){return this.opt.jsPDF=u.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,u.pageSize);default:return function(){this.opt[i]=u[i]}}},this);return this.then(function(){return this.thenList(l)})},a.prototype.get=function(u,l){return this.then(function(){var i=u in a.template.prop?this.prop[u]:this.opt[u];return l?l(i):i})},a.prototype.setMargin=function(u){return this.then(function(){switch(r(u)){case"number":u=[u,u,u,u];case"array":if(u.length===2&&(u=[u[0],u[1],u[0],u[1]]),u.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=u}).then(this.setPageSize)},a.prototype.setPageSize=function(u){function l(i,c){return Math.floor(i*c/72*96)}return this.then(function(){(u=u||xn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(u.inner={width:u.width-this.opt.margin[1]-this.opt.margin[3],height:u.height-this.opt.margin[0]-this.opt.margin[2]},u.inner.px={width:l(u.inner.width,u.k),height:l(u.inner.height,u.k)},u.inner.ratio=u.inner.height/u.inner.width),this.prop.pageSize=u})},a.prototype.setProgress=function(u,l,i,c){return u!=null&&(this.progress.val=u),l!=null&&(this.progress.state=l),i!=null&&(this.progress.n=i),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(u,l,i,c){return this.setProgress(u?this.progress.val+u:null,l||null,i?this.progress.n+i:null,c?this.progress.stack.concat(c):null)},a.prototype.then=function(u,l){var i=this;return this.thenCore(u,l,function(c,p){return i.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(h){return i.updateProgress(null,c),h}).then(c,p).then(function(h){return i.updateProgress(1),h})})},a.prototype.thenCore=function(u,l,i){i=i||Promise.prototype.then;var c=this;u&&(u=u.bind(c)),l&&(l=l.bind(c));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?c:a.convert(Object.assign({},c),Promise.prototype),h=i.call(p,u,l);return a.convert(h,c.__proto__)},a.prototype.thenExternal=function(u,l){return Promise.prototype.then.call(this,u,l)},a.prototype.thenList=function(u){var l=this;return u.forEach(function(i){l=l.thenCore(i)}),l},a.prototype.catch=function(u){u&&(u=u.bind(this));var l=Promise.prototype.catch.call(this,u);return a.convert(l,this)},a.prototype.catchExternal=function(u){return Promise.prototype.catch.call(this,u)},a.prototype.error=function(u){return this.then(function(){throw new Error(u)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,xn.getPageSize=function(u,l,i){if(Yr(u)==="object"){var c=u;u=c.orientation,l=c.unit||l,i=c.format||i}l=l||"mm",i=i||"a4",u=(""+(u||"P")).toLowerCase();var p,h=(""+i).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+l}var g,y=0,b=0;if(f.hasOwnProperty(h))y=f[h][1]/p,b=f[h][0]/p;else try{y=i[1],b=i[0]}catch{throw new Error("Invalid format: "+i)}if(u==="p"||u==="portrait")u="p",b>y&&(g=b,b=y,y=g);else{if(u!=="l"&&u!=="landscape")throw"Invalid orientation: "+u;u="l",y>b&&(g=b,b=y,y=g)}return{width:b,height:y,unit:l,k:p,orientation:u}},n.html=function(u,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(rg):null;var i=new a(l);return l.worker?i:i.from(u).doCallback()}})(xn.API),xn.API.addJS=function(n){return h3=n,this.internal.events.subscribe("postPutResources",function(){Lp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Lp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),f3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+h3+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Lp!==void 0&&f3!==void 0&&this.internal.out("/Names <</JavaScript "+Lp+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var o=t.outline.render().split(/\r\n/),s=0;s<o.length;s++){var a=o[s],u=r.exec(a);if(u!=null){var l=u[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var i=this.internal.pages.length,c=[];for(s=0;s<i;s++){var p=t.internal.newObject();c.push(p);var h=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<c.length;s++)t.internal.write("(page_"+(s+1)+")"+c[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,o,s){var a={title:o,options:s,children:[]};return r==null&&(r=this.root),r.children.push(a),a},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var o=0;o<r.children.length;o++)this.genIds_r(r.children[o])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var o=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var a=r.children[s];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var u=this.count=this.count_r({count:0},a);if(u>0&&this.line("/Count "+u),a.options&&a.options.pageNumber){var l=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+o(0)+" 0]")}this.objEnd()}for(var i=0;i<r.children.length;i++)this.renderItems(r.children[i])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,o){for(var s=0;s<o.children.length;s++)r.count++,this.count_r(r,o.children[s]);return r.count}}])})(xn.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,o,s,a,u){var l,i=this.decode.DCT_DECODE,c=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,l=(function(p){for(var h,f=256*p.charCodeAt(4)+p.charCodeAt(5),g=p.length,y={width:0,height:0,numcomponents:1},b=4;b<g;b+=2){if(b+=f,e.indexOf(p.charCodeAt(b+1))!==-1){h=256*p.charCodeAt(b+5)+p.charCodeAt(b+6),y={width:256*p.charCodeAt(b+7)+p.charCodeAt(b+8),height:h,numcomponents:p.charCodeAt(b+9)};break}f=256*p.charCodeAt(b+2)+p.charCodeAt(b+3)}return y})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),l.numcomponents){case 1:u=this.color_spaces.DEVICE_GRAY;break;case 4:u=this.color_spaces.DEVICE_CMYK;break;case 3:u=this.color_spaces.DEVICE_RGB}c={data:t,width:l.width,height:l.height,colorSpace:u,bitsPerComponent:8,filter:i,index:r,alias:o}}return c}})(xn.API),xn.API.processPNG=function(n,e,t,r){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var o,s=wq(n,{checkCrc:!0}),a=s.width,u=s.height,l=s.channels,i=s.palette,c=s.depth;o=i&&l===1?(function(P){for(var U=P.width,q=P.height,R=P.data,I=P.palette,T=P.depth,L=!1,E=[],x=[],k=void 0,A=!1,C=0,j=0;j<I.length;j++){var B=gx(I[j],4),O=B[0],H=B[1],X=B[2],et=B[3];E.push(O,H,X),et!=null&&(et===0?(C++,x.length<1&&x.push(j)):et<255&&(A=!0))}if(A||C>1){L=!0,x=void 0;var V=U*q;k=new Uint8Array(V);for(var tt=new DataView(R.buffer),$=0;$<V;$++){var z=sg(tt,$,T),Z=gx(I[z],4)[3];k[$]=Z}}else C===0&&(x=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:L?8:void 0,colorBytes:R,alphaBytes:k,needSMask:L,palette:E,mask:x}})(s):l===2||l===4?(function(P){for(var U=P.data,q=P.width,R=P.height,I=P.channels,T=P.depth,L=I===2?"DeviceGray":"DeviceRGB",E=I-1,x=q*R,k=E,A=x*k,C=1*x,j=Math.ceil(A*T/8),B=Math.ceil(C*T/8),O=new Uint8Array(j),H=new Uint8Array(B),X=new DataView(U.buffer),et=new DataView(O.buffer),V=new DataView(H.buffer),tt=!1,$=0;$<x;$++){for(var z=$*I,Z=0;Z<k;Z++)x3(et,sg(X,z+Z,T),$*k+Z,T);var it=sg(X,z+k,T);it<(1<<T)-1&&(tt=!0),x3(V,it,1*$,T)}return{colorSpace:L,colorsPerPixel:E,sMaskBitsPerComponent:tt?T:void 0,colorBytes:O,alphaBytes:H,needSMask:tt}})(s):(function(P){var U=P.data,q=P.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:q,colorsPerPixel:q==="DeviceGray"?1:3,colorBytes:U instanceof Uint16Array?(function(R){for(var I=R.length,T=new Uint8Array(2*I),L=new DataView(T.buffer,T.byteOffset,T.byteLength),E=0;E<I;E++)L.setUint16(2*E,R[E],!1);return T})(U):U,needSMask:!1}})(s);var p,h,f,g=o,y=g.colorSpace,b=g.colorsPerPixel,v=g.sMaskBitsPerComponent,w=g.colorBytes,S=g.alphaBytes,N=g.needSMask,D=g.palette,F=g.mask,G=null;return r!==xn.API.image_compression.NONE&&typeof rb=="function"?(G=(function(P){var U;switch(P){case xn.API.image_compression.FAST:U=11;break;case xn.API.image_compression.MEDIUM:U=13;break;case xn.API.image_compression.SLOW:U=14;break;default:U=12}return U})(r),p=this.decode.FLATE_DECODE,h="/Predictor ".concat(G," /Colors ").concat(b," /BitsPerComponent ").concat(c," /Columns ").concat(a),n=g3(w,Math.ceil(a*b*c/8),b,c,r),N&&(f=g3(S,Math.ceil(a*v/8),1,v,r))):(p=void 0,h=void 0,n=w,N&&(f=S)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:t,data:n,index:e,filter:p,decodeParameters:h,transparency:F,palette:D,sMask:f,predictor:G,width:a,height:u,bitsPerComponent:c,sMaskBitsPerComponent:v,colorSpace:y}}},(function(n){n.processGIF89A=function(e,t,r,o){var s=new qq(e),a=s.width,u=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var i={data:l,width:a,height:u},c=new ag(100).encode(i,100);return n.processJPEG.call(this,c,t,r,o)},n.processGIF87A=n.processGIF89A})(xn.API),go.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:o,green:r,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},go.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){li.log("bit decode error:"+t)}},go.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<e;o++)for(var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+8*o*4,u=0;u<8&&8*o+u<this.width;u++){var l=this.palette[s>>7-u&1];this.data[a+4*u]=l.blue,this.data[a+4*u+1]=l.green,this.data[a+4*u+2]=l.red,this.data[a+4*u+3]=255}t!==0&&(this.pos+=4-t)}},go.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,o=0;o<n;o++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+2*o*4,u=s>>4,l=15&s,i=this.palette[u];if(this.data[a]=i.blue,this.data[a+1]=i.green,this.data[a+2]=i.red,this.data[a+3]=255,2*o+1>=this.width)break;i=this.palette[l],this.data[a+4]=i.blue,this.data[a+4+1]=i.green,this.data[a+4+2]=i.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},go.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var o=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;if(o<this.palette.length){var a=this.palette[o];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}n!==0&&(this.pos+=4-n)}},go.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&e)/e*255|0,u=(s>>5&e)/e*255|0,l=(s>>10&e)/e*255|0,i=s>>15?255:0,c=r*this.width*4+4*o;this.data[c]=l,this.data[c+1]=u,this.data[c+2]=a,this.data[c+3]=i}this.pos+=n}},go.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(a&e)/e*255|0,l=(a>>5&t)/t*255|0,i=(a>>11)/e*255|0,c=o*this.width*4+4*s;this.data[c]=i,this.data[c+1]=l,this.data[c+2]=u,this.data[c+3]=255}this.pos+=n}},go.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=s,this.data[a+1]=o,this.data[a+2]=r,this.data[a+3]=255}this.pos+=this.width%4}},go.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),u=e*this.width*4+4*t;this.data[u]=s,this.data[u+1]=o,this.data[u+2]=r,this.data[u+3]=a}},go.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,r,o){var s=new go(e,!1),a=s.width,u=s.height,l={data:s.getData(),width:a,height:u},i=new ag(100).encode(l,100);return n.processJPEG.call(this,i,t,r,o)}})(xn.API),_3.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,r,o){var s=new _3(e),a=s.width,u=s.height,l={data:s.getData(),width:a,height:u},i=new ag(100).encode(l,100);return n.processJPEG.call(this,i,t,r,o)}})(xn.API),xn.API.processRGBA=function(n,e,t){for(var r=n.data,o=r.length,s=new Uint8Array(o/4*3),a=new Uint8Array(o/4),u=0,l=0,i=0;i<o;i+=4){var c=r[i],p=r[i+1],h=r[i+2],f=r[i+3];s[u++]=c,s[u++]=p,s[u++]=h,a[l++]=f}var g=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:g,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},xn.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},sf=xn.API,Op=sf.getCharWidthsArray=function(n,e){var t,r,o=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),u=e.widths?e.widths:o.metadata.Unicode.widths,l=u.fof?u.fof:1,i=e.kerning?e.kerning:o.metadata.Unicode.kerning,c=i.fof?i.fof:1,p=e.doKerning!==!1,h=0,f=n.length,g=0,y=u[0]||l,b=[];for(t=0;t<f;t++)r=n.charCodeAt(t),typeof o.metadata.widthOfString=="function"?b.push((o.metadata.widthOfGlyph(o.metadata.characterToGlyph(r))+a*(1e3/s)||0)/1e3):(h=p&&Yr(i[r])==="object"&&!isNaN(parseInt(i[r][g],10))?i[r][g]/c:0,b.push((u[r]||y)/l+h)),g=r;return b},d3=sf.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),o=e.charSpace||this.internal.getCharSpace();return sf.processArabic&&(n=sf.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,o)/t:Op.apply(this,arguments).reduce(function(s,a){return s+a},0)},p3=function(n,e,t,r){for(var o=[],s=0,a=n.length,u=0;s!==a&&u+e[s]<t;)u+=e[s],s++;o.push(n.slice(0,s));var l=s;for(u=0;s!==a;)u+e[s]>r&&(o.push(n.slice(l,s)),u=0,l=s),u+=e[s],s++;return l!==s&&o.push(n.slice(l,s)),o},m3=function(n,e,t){t||(t={});var r,o,s,a,u,l,i,c=[],p=[c],h=t.textIndent||0,f=0,g=0,y=n.split(" "),b=Op.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?y[0].length+2:t.lineIndent||0){var v=Array(l).join(" "),w=[];y.map(function(N){(N=N.split(/\s*\n/)).length>1?w=w.concat(N.map(function(D,F){return(F&&D.length?`
`:"")+D})):w.push(N[0])}),y=w,l=d3.apply(this,[v,t])}for(s=0,a=y.length;s<a;s++){var S=0;if(r=y[s],l&&r[0]==`
`&&(r=r.substr(1),S=1),h+f+(g=(o=Op.apply(this,[r,t])).reduce(function(N,D){return N+D},0))>e||S){if(g>e){for(u=p3.apply(this,[r,o,e-(h+f),e]),c.push(u.shift()),c=[u.pop()];u.length;)p.push([u.shift()]);g=o.slice(r.length-(c[0]?c[0].length:0)).reduce(function(N,D){return N+D},0)}else c=[r];p.push(c),h=g+l,f=b}else c.push(r),h+=f+g,f=b}return i=l?function(N,D){return(D?v:"")+N.join(" ")}:function(N){return N.join(" ")},p.map(i)},sf.splitTextToSize=function(n,e,t){var r,o=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(c){if(c.widths&&c.kerning)return{widths:c.widths,kerning:c.kerning};var p=this.internal.getFont(c.fontName,c.fontStyle),h="Unicode";return p.metadata[h]?{widths:p.metadata[h].widths||{0:1},kerning:p.metadata[h].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/o;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/o:0,s.lineIndent=t.lineIndent;var u,l,i=[];for(u=0,l=r.length;u<l;u++)i=i.concat(m3.apply(this,[r[u],a,s]));return i},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",r={},o={},s=0;s<16;s++)r[t[s]]=e[s],o[e[s]]=t[s];var a=function(h){return"0x"+parseInt(h,10).toString(16)},u=n.__fontmetrics__.compress=function(h){var f,g,y,b,v=["{"];for(var w in h){if(f=h[w],isNaN(parseInt(w,10))?g="'"+w+"'":(w=parseInt(w,10),g=(g=a(w).slice(2)).slice(0,-1)+o[g.slice(-1)]),typeof f=="number")f<0?(y=a(f).slice(3),b="-"):(y=a(f).slice(2),b=""),y=b+y.slice(0,-1)+o[y.slice(-1)];else{if(Yr(f)!=="object")throw new Error("Don't know what to do with value type "+Yr(f)+".");y=u(f)}v.push(g+y)}return v.push("}"),v.join("")},l=n.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,g,y,b,v={},w=1,S=v,N=[],D="",F="",G=h.length-1,P=1;P<G;P+=1)(b=h[P])=="'"?f?(y=f.join(""),f=void 0):f=[]:f?f.push(b):b=="{"?(N.push([S,y]),S={},y=void 0):b=="}"?((g=N.pop())[0][g[1]]=S,y=void 0,S=g[0]):b=="-"?w=-1:y===void 0?r.hasOwnProperty(b)?(D+=r[b],y=parseInt(D,16)*w,w=1,D=""):D+=b:r.hasOwnProperty(b)?(F+=r[b],S[y]=parseInt(F,16)*w,w=1,y=void 0,F=""):F+=b;return v},i={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:i,"Courier-Bold":i,"Courier-BoldOblique":i,"Courier-Oblique":i,Helvetica:i,"Helvetica-Bold":i,"Helvetica-BoldOblique":i,"Helvetica-Oblique":i,"Times-Roman":i,"Times-Bold":i,"Times-BoldItalic":i,"Times-Italic":i}},p={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(h){var f=h.font,g=p.Unicode[f.postScriptName];g&&(f.metadata.Unicode={},f.metadata.Unicode.widths=g.widths,f.metadata.Unicode.kerning=g.kerning);var y=c.Unicode[f.postScriptName];y&&(f.metadata.Unicode.encoding=y,f.encoding=y.codePages[0])}])})(xn.API),(function(n){var e=function(t){for(var r=t.length,o=new Uint8Array(r),s=0;s<r;s++)o[s]=t.charCodeAt(s);return o};n.API.events.push(["addFont",function(t){var r=void 0,o=t.font,s=t.instance;if(!o.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");if(typeof(r=s.existsFileInVFS(o.postScriptName)===!1?s.loadFile(o.postScriptName):s.getFileFromVFS(o.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");(function(a,u){u=/^\x00\x01\x00\x00/.test(u)?e(u):e(Fp(u)),a.metadata=n.API.TTFFont.open(u),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(o,r)}}])})(xn),xn.API.addSvgAsImage=function(n,e,t,r,o,s,a,u){if(isNaN(e)||isNaN(t))throw li.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(o))throw li.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=r,l.height=o;var i=l.getContext("2d");i.fillStyle="#fff",i.fillRect(0,0,l.width,l.height);var c={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(zn.canvg?Promise.resolve(zn.canvg):Mh(()=>import("./index.es-CQOMoEd0.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(i,n,c)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(c)}).then(function(){p.addImage(l.toDataURL("image/jpeg",1),e,t,r,o,a,u)})},xn.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var o=0;o<this.internal.pages[r].length;o++)this.internal.pages[r][o]=this.internal.pages[r][o].replace(e,t);return this},xn.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var r,o,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},u=Object.keys(a),l=[],i=0,c=0,p=0;function h(g,y){var b,v=!1;for(b=0;b<g.length;b+=1)g[b]===y&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var f=u.length;for(p=0;p<f;p+=1)t[u[p]].value=t[u[p]].defaultValue,t[u[p]].explicitSet=!1}if(Yr(n)==="object"){for(o in n)if(s=n[o],h(u,o)&&s!==void 0){if(t[o].type==="boolean"&&typeof s=="boolean")t[o].value=s;else if(t[o].type==="name"&&h(t[o].valueSet,s))t[o].value=s;else if(t[o].type==="integer"&&Number.isInteger(s))t[o].value=s;else if(t[o].type==="array"){for(i=0;i<s.length;i+=1)if(r=!0,s[i].length===1&&typeof s[i][0]=="number")l.push(String(s[i]-1));else if(s[i].length>1){for(c=0;c<s[i].length;c+=1)typeof s[i][c]!="number"&&(r=!1);r===!0&&l.push([s[i][0]-1,s[i][1]-1].join(" "))}t[o].value="["+l.join(" ")+"]"}else t[o].value=t[o].defaultValue;t[o].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,y=[];for(g in t)t[g].explicitSet===!0&&(t[g].type==="name"?y.push("/"+g+" /"+t[g].value):y.push("/"+g+" "+t[g].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',o=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),u=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),i=s.length+a.length+u.length+o.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+i+" >>"),this.internal.write("stream"),this.internal.write(o+s+a+u+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(r,o){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:o||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(xn.API),(function(n){var e=n.API,t=e.pdfEscape16=function(s,a){for(var u,l=a.metadata.Unicode.widths,i=["","0","00","000","0000"],c=[""],p=0,h=s.length;p<h;++p){if(u=a.metadata.characterToGlyph(s.charCodeAt(p)),a.metadata.glyIdsUsed.push(u),a.metadata.toUnicode[u]=s.charCodeAt(p),l.indexOf(u)==-1&&(l.push(u),l.push([parseInt(a.metadata.widthOfGlyph(u),10)])),u=="0")return c.join("");u=u.toString(16),c.push(i[4-u.length],u)}return c.join("")},r=function(s){var a,u,l,i,c,p,h;for(c=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],p=0,h=(u=Object.keys(s).sort(function(f,g){return f-g})).length;p<h;p++)a=u[p],l.length>=100&&(c+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[a]!==void 0&&s[a]!==null&&typeof s[a].toString=="function"&&(i=("0000"+s[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+i+">"));return l.length&&(c+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),c+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(a){var u=a.font,l=a.out,i=a.newObject,c=a.putStream;if(u.metadata instanceof n.API.TTFFont&&u.encoding==="Identity-H"){for(var p=u.metadata.Unicode.widths,h=u.metadata.subset.encode(u.metadata.glyIdsUsed,1),f="",g=0;g<h.length;g++)f+=String.fromCharCode(h[g]);var y=i();c({data:f,addLength1:!0,objectId:y}),l("endobj");var b=i();c({data:r(u.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var v=i();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+mf(u.fontName)),l("/FontFile2 "+y+" 0 R"),l("/FontBBox "+n.API.PDFObject.convert(u.metadata.bbox)),l("/Flags "+u.metadata.flags),l("/StemV "+u.metadata.stemV),l("/ItalicAngle "+u.metadata.italicAngle),l("/Ascent "+u.metadata.ascender),l("/Descent "+u.metadata.decender),l("/CapHeight "+u.metadata.capHeight),l(">>"),l("endobj");var w=i();l("<<"),l("/Type /Font"),l("/BaseFont /"+mf(u.fontName)),l("/FontDescriptor "+v+" 0 R"),l("/W "+n.API.PDFObject.convert(p)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+u.encoding+")"),l(">>"),l(">>"),l("endobj"),u.objectNumber=i(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+mf(u.fontName)),l("/Encoding /"+u.encoding),l("/DescendantFonts ["+w+" 0 R]"),l(">>"),l("endobj"),u.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(a){var u=a.font,l=a.out,i=a.newObject,c=a.putStream;if(u.metadata instanceof n.API.TTFFont&&u.encoding==="WinAnsiEncoding"){for(var p=u.metadata.rawData,h="",f=0;f<p.length;f++)h+=String.fromCharCode(p[f]);var g=i();c({data:h,addLength1:!0,objectId:g}),l("endobj");var y=i();c({data:r(u.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var b=i();l("<<"),l("/Descent "+u.metadata.decender),l("/CapHeight "+u.metadata.capHeight),l("/StemV "+u.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+g+" 0 R"),l("/Flags 96"),l("/FontBBox "+n.API.PDFObject.convert(u.metadata.bbox)),l("/FontName /"+mf(u.fontName)),l("/ItalicAngle "+u.metadata.italicAngle),l("/Ascent "+u.metadata.ascender),l(">>"),l("endobj"),u.objectNumber=i();for(var v=0;v<u.metadata.hmtx.widths.length;v++)u.metadata.hmtx.widths[v]=parseInt(u.metadata.hmtx.widths[v]*(1e3/u.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+mf(u.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+u.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(u.metadata.hmtx.widths)+">>"),l("endobj"),u.isAlreadyPutted=!0}})(s)}]);var o=function(s){var a,u=s.text||"",l=s.x,i=s.y,c=s.options||{},p=s.mutex||{},h=p.pdfEscape,f=p.activeFontKey,g=p.fonts,y=f,b="",v=0,w="",S=g[y].encoding;if(g[y].encoding!=="Identity-H")return{text:u,x:l,y:i,options:c,mutex:p};for(w=u,y=f,Array.isArray(u)&&(w=u[0]),v=0;v<w.length;v+=1)g[y].metadata.hasOwnProperty("cmap")&&(a=g[y].metadata.cmap.unicode.codeMap[w[v].charCodeAt(0)]),a||w[v].charCodeAt(0)<256&&g[y].metadata.hasOwnProperty("Unicode")?b+=w[v]:b+="";var N="";return parseInt(y.slice(1))<14||S==="WinAnsiEncoding"?N=h(b,y).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(N=t(b,g[y])),p.isHex=!0,{text:N,x:l,y:i,options:c,mutex:p}};e.events.push(["postProcessText",function(s){var a=s.text||"",u=[],l={text:a,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(a)){var i=0;for(i=0;i<a.length;i+=1)Array.isArray(a[i])&&a[i].length===3?u.push([o(Object.assign({},l,{text:a[i][0]})).text,a[i][1],a[i][2]]):u.push(o(Object.assign({},l,{text:a[i]})).text);s.text=u}else s.text=o(Object.assign({},l,{text:a})).text}])})(xn),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(xn.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var o,s,a,u,l,i,c,p=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,S=0;this.__bidiEngine__={};var N=function(R){var I=R.charCodeAt(),T=I>>8,L=y[T];return L!==void 0?p[256*L+(255&I)]:T===252||T===253?"AL":v.test(T)?"L":T===8?"R":"N"},D=function(R){for(var I,T=0;T<R.length;T++){if((I=N(R.charAt(T)))==="L")return!1;if(I==="R")return!0}return!1},F=function(R,I,T,L){var E,x,k,A,C=I[L];switch(C){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"N":case"AN":break;case"EN":w&&(C="AN");break;case"AL":w=!0,C="R";break;case"WS":case"BN":C="N";break;case"CS":L<1||L+1>=I.length||(E=T[L-1])!=="EN"&&E!=="AN"||(x=I[L+1])!=="EN"&&x!=="AN"?C="N":w&&(x="AN"),C=x===E?x:"N";break;case"ES":C=(E=L>0?T[L-1]:"B")==="EN"&&L+1<I.length&&I[L+1]==="EN"?"EN":"N";break;case"ET":if(L>0&&T[L-1]==="EN"){C="EN";break}if(w){C="N";break}for(k=L+1,A=I.length;k<A&&I[k]==="ET";)k++;C=k<A&&I[k]==="EN"?"EN":"N";break;case"NSM":if(a&&!u){for(A=I.length,k=L+1;k<A&&I[k]==="NSM";)k++;if(k<A){var j=R[L],B=j>=1425&&j<=2303||j===64286;if(E=I[k],B&&(E==="R"||E==="AL")){C="R";break}}}C=L<1||(E=I[L-1])==="B"?"N":T[L-1];break;case"B":w=!1,o=!0,C=S;break;case"S":s=!0,C="N"}return C},G=function(R,I,T){var L=R.split("");return T&&P(L,T,{hiLevel:S}),L.reverse(),I&&I.reverse(),L.join("")},P=function(R,I,T){var L,E,x,k,A,C=-1,j=R.length,B=0,O=[],H=S?f:h,X=[];for(w=!1,o=!1,s=!1,E=0;E<j;E++)X[E]=N(R[E]);for(x=0;x<j;x++){if(A=B,O[x]=F(R,X,O,x),L=240&(B=H[A][g[O[x]]]),B&=15,I[x]=k=H[B][5],L>0)if(L===16){for(E=C;E<x;E++)I[E]=1;C=-1}else C=-1;if(H[B][6])C===-1&&(C=x);else if(C>-1){for(E=C;E<x;E++)I[E]=k;C=-1}X[x]==="B"&&(I[x]=0),T.hiLevel|=k}s&&(function(et,V,tt){for(var $=0;$<tt;$++)if(et[$]==="S"){V[$]=S;for(var z=$-1;z>=0&&et[z]==="WS";z--)V[z]=S}})(X,I,j)},U=function(R,I,T,L,E){if(!(E.hiLevel<R)){if(R===1&&S===1&&!o)return I.reverse(),void(T&&T.reverse());for(var x,k,A,C,j=I.length,B=0;B<j;){if(L[B]>=R){for(A=B+1;A<j&&L[A]>=R;)A++;for(C=B,k=A-1;C<k;C++,k--)x=I[C],I[C]=I[k],I[k]=x,T&&(x=T[C],T[C]=T[k],T[k]=x);B=A}B++}}},q=function(R,I,T){var L=R.split(""),E={hiLevel:S};return T||(T=[]),P(L,T,E),(function(x,k,A){if(A.hiLevel!==0&&c)for(var C,j=0;j<x.length;j++)k[j]===1&&(C=b.indexOf(x[j]))>=0&&(x[j]=b[C+1])})(L,T,E),U(2,L,I,T,E),U(1,L,I,T,E),L.join("")};return this.__bidiEngine__.doBidiReorder=function(R,I,T){if((function(E,x){if(x)for(var k=0;k<E.length;k++)x[k]=k;u===void 0&&(u=D(E)),i===void 0&&(i=D(E))})(R,I),a||!l||i)if(a&&l&&u^i)S=u?1:0,R=G(R,I,T);else if(!a&&l&&i)S=u?1:0,R=q(R,I,T),R=G(R,I);else if(!a||u||l||i){if(a&&!l&&u^i)R=G(R,I),u?(S=0,R=q(R,I,T)):(S=1,R=q(R,I,T),R=G(R,I));else if(a&&u&&!l&&i)S=1,R=q(R,I,T),R=G(R,I);else if(!a&&!l&&u^i){var L=c;u?(S=1,R=q(R,I,T),S=0,c=!1,R=q(R,I,T),c=L):(S=0,R=q(R,I,T),R=G(R,I),S=1,c=!1,R=q(R,I,T),c=L,R=G(R,I))}}else S=0,R=q(R,I,T);else S=u?1:0,R=q(R,I,T);return R},this.__bidiEngine__.setOptions=function(R){R&&(a=R.isInputVisual,l=R.isOutputVisual,u=R.isInputRtl,i=R.isOutputRtl,c=R.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var o=r.text;r.x,r.y;var s=r.options||{};r.mutex,s.lang;var a=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(o)==="[object Array]"){var u=0;for(a=[],u=0;u<o.length;u+=1)Object.prototype.toString.call(o[u])==="[object Array]"?a.push([t.doBidiReorder(o[u][0]),o[u][1],o[u][2]]):a.push([t.doBidiReorder(o[u])]);r.text=a}else r.text=t.doBidiReorder(o);t.setOptions({isInputVisual:!0})}])})(xn),xn.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new Cu(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new nU(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new Uq(this.contents),this.head=new $q(this),this.name=new Xq(this),this.cmap=new bS(this),this.toUnicode={},this.hhea=new Vq(this),this.maxp=new Kq(this),this.hmtx=new Zq(this),this.post=new Gq(this),this.os2=new Wq(this),this.loca=new eU(this),this.glyf=new Qq(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,r,o,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,u,l,i;for(i=[],a=0,u=(l=this.bbox).length;a<u;a++)e=l[a],i.push(Math.round(e*this.scaleFactor));return i}).call(this),this.stemV=0,this.post.exists?(r=255&(o=this.post.italic_angle),32768&(t=o>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,r){var o,s,a,u;for(a=0,s=0,u=(e=""+e).length;0<=u?s<u:s>u;s=0<=u?++s:--s)o=e.charCodeAt(s),a+=this.widthOfGlyph(this.characterToGlyph(o))+r*(1e3/t)||0;return a*(t/1e3)},n.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},n})();var Eo,Cu=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(e){var t,r,o;for(o=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)o.push(this.writeByte(e.charCodeAt(t)));return o},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,r,o,s,a,u,l;return e=this.readByte(),t=this.readByte(),r=this.readByte(),o=this.readByte(),s=this.readByte(),a=this.readByte(),u=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^o)+16777216*(255^s)+65536*(255^a)+256*(255^u)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*o+16777216*s+65536*a+256*u+l},n.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(e){var t,r,o,s;for(s=[],r=0,o=e.length;r<o;r++)t=e[r],s.push(this.writeByte(t));return s},n})(),Uq=(function(){var n;function e(t){var r,o,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},o=0,s=this.tableCount;0<=s?o<s:o>s;o=0<=s?++o:--o)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,o,s,a,u,l,i,c,p,h,f,g,y;for(y in f=Object.keys(t).length,l=Math.log(2),p=16*Math.floor(Math.log(f)/l),a=Math.floor(p/l),c=16*f-p,(o=new Cu).writeInt(this.scalarType),o.writeShort(f),o.writeShort(p),o.writeShort(a),o.writeShort(c),s=16*f,i=o.pos+s,u=null,g=[],t)for(h=t[y],o.writeString(y),o.writeInt(n(h)),o.writeInt(i),o.writeInt(h.length),g=g.concat(h),y==="head"&&(u=i),i+=h.length;i%4;)g.push(0),i++;return o.write(g),r=2981146554-n(o.data),o.pos=u+8,o.writeUInt32(r),o.data},n=function(t){var r,o,s,a;for(t=yS.call(t);t.length%4;)t.push(0);for(s=new Cu(t),o=0,r=0,a=t.length;r<a;r=r+=4)o+=s.readUInt32();return 4294967295&o},e})(),Hq={}.hasOwnProperty,rl=function(n,e){for(var t in e)Hq.call(e,t)&&(n[t]=e[t]);function r(){this.constructor=n}return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};Eo=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var $q=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new Cu).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),k3=(function(){function n(e,t){var r,o,s,a,u,l,i,c,p,h,f,g,y,b,v,w,S;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),p=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(f=e.readUInt16(),h=f/2,e.pos+=6,s=(function(){var N,D;for(D=[],l=N=0;0<=h?N<h:N>h;l=0<=h?++N:--N)D.push(e.readUInt16());return D})(),e.pos+=2,y=(function(){var N,D;for(D=[],l=N=0;0<=h?N<h:N>h;l=0<=h?++N:--N)D.push(e.readUInt16());return D})(),i=(function(){var N,D;for(D=[],l=N=0;0<=h?N<h:N>h;l=0<=h?++N:--N)D.push(e.readUInt16());return D})(),c=(function(){var N,D;for(D=[],l=N=0;0<=h?N<h:N>h;l=0<=h?++N:--N)D.push(e.readUInt16());return D})(),o=(this.length-e.pos+this.offset)/2,u=(function(){var N,D;for(D=[],l=N=0;0<=o?N<o:N>o;l=0<=o?++N:--N)D.push(e.readUInt16());return D})(),l=v=0,S=s.length;v<S;l=++v)for(b=s[l],r=w=g=y[l];g<=b?w<=b:w>=b;r=g<=b?++w:--w)c[l]===0?a=r+i[l]:(a=u[c[l]/2+(r-g)-(h-l)]||0)!==0&&(a+=i[l]),this.codeMap[r]=65535&a}e.pos=p}return n.encode=function(e,t){var r,o,s,a,u,l,i,c,p,h,f,g,y,b,v,w,S,N,D,F,G,P,U,q,R,I,T,L,E,x,k,A,C,j,B,O,H,X,et,V,tt,$,z,Z,it,mt;switch(L=new Cu,a=Object.keys(e).sort(function(lt,at){return lt-at}),t){case"macroman":for(y=0,b=(function(){var lt=[];for(g=0;g<256;++g)lt.push(0);return lt})(),w={0:0},s={},E=0,C=a.length;E<C;E++)w[z=e[o=a[E]]]==null&&(w[z]=++y),s[o]={old:e[o],new:w[e[o]]},b[o]=w[e[o]];return L.writeUInt16(1),L.writeUInt16(0),L.writeUInt32(12),L.writeUInt16(0),L.writeUInt16(262),L.writeUInt16(0),L.write(b),{charMap:s,subtable:L.data,maxGlyphID:y+1};case"unicode":for(I=[],p=[],S=0,w={},r={},v=i=null,x=0,j=a.length;x<j;x++)w[D=e[o=a[x]]]==null&&(w[D]=++S),r[o]={old:D,new:w[D]},u=w[D]-o,v!=null&&u===i||(v&&p.push(v),I.push(o),i=u),v=o;for(v&&p.push(v),p.push(65535),I.push(65535),q=2*(U=I.length),P=2*Math.pow(Math.log(U)/Math.LN2,2),h=Math.log(P/2)/Math.LN2,G=2*U-P,l=[],F=[],f=[],g=k=0,B=I.length;k<B;g=++k){if(R=I[g],c=p[g],R===65535){l.push(0),F.push(0);break}if(R-(T=r[R].new)>=32768)for(l.push(0),F.push(2*(f.length+U-g)),o=A=R;R<=c?A<=c:A>=c;o=R<=c?++A:--A)f.push(r[o].new);else l.push(T-R),F.push(0)}for(L.writeUInt16(3),L.writeUInt16(1),L.writeUInt32(12),L.writeUInt16(4),L.writeUInt16(16+8*U+2*f.length),L.writeUInt16(0),L.writeUInt16(q),L.writeUInt16(P),L.writeUInt16(h),L.writeUInt16(G),tt=0,O=p.length;tt<O;tt++)o=p[tt],L.writeUInt16(o);for(L.writeUInt16(0),$=0,H=I.length;$<H;$++)o=I[$],L.writeUInt16(o);for(Z=0,X=l.length;Z<X;Z++)u=l[Z],L.writeUInt16(u);for(it=0,et=F.length;it<et;it++)N=F[it],L.writeUInt16(N);for(mt=0,V=f.length;mt<V;mt++)y=f[mt],L.writeUInt16(y);return{charMap:r,subtable:L.data,maxGlyphID:S+1}}},n})(),bS=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,r,o;for(e.pos=this.offset,this.version=e.readUInt16(),o=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=o?r<o:r>o;r=0<=o?++r:--r)t=new k3(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var r,o;return t==null&&(t="macroman"),r=k3.encode(e,t),(o=new Cu).writeUInt16(0),o.writeUInt16(1),r.table=o.data.concat(r.subtable),r},n})(),Vq=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),Wq=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r})(),this.charRange=(function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),Gq=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="post",n.prototype.parse=function(e){var t,r,o;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(r=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],o=[];e.pos<this.offset+this.length;)t=e.readByte(),o.push(this.names.push(e.readString(t)));return o;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=(function(){var a,u,l;for(l=[],s=a=0,u=this.file.maxp.numGlyphs;0<=u?a<u:a>u;s=0<=u?++a:--a)l.push(e.readUInt32());return l}).call(this)}},n})(),Yq=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Xq=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="name",n.prototype.parse=function(e){var t,r,o,s,a,u,l,i,c,p,h;for(e.pos=this.offset,e.readShort(),t=e.readShort(),u=e.readShort(),r=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+u+e.readShort()});for(l={},s=c=0,p=r.length;c<p;s=++c)o=r[s],e.pos=o.offset,i=e.readString(o.length),a=new Yq(i,o),l[h=o.nameID]==null&&(l[h]=[]),l[o.nameID].push(a);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},n})(),Kq=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),Zq=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,r,o,s,a,u,l;for(e.pos=this.offset,this.metrics=[],t=0,u=this.file.hhea.numberOfMetrics;0<=u?t<u:t>u;t=0<=u?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var i,c;for(c=[],t=i=0;0<=o?i<o:i>o;t=0<=o?++i:--i)c.push(e.readInt16());return c})(),this.widths=(function(){var i,c,p,h;for(h=[],i=0,c=(p=this.metrics).length;i<c;i++)s=p[i],h.push(s.advance);return h}).call(this),r=this.widths[this.widths.length-1],l=[],t=a=0;0<=o?a<o:a>o;t=0<=o?++a:--a)l.push(this.widths.push(r));return l},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),yS=[].slice,Qq=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,r,o,s,a,u,l,i,c,p;return e in this.cache?this.cache[e]:(s=this.file.loca,t=this.file.contents,r=s.indexOf(e),(o=s.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+r,a=(u=new Cu(t.read(o))).readShort(),i=u.readShort(),p=u.readShort(),l=u.readShort(),c=u.readShort(),this.cache[e]=a===-1?new tU(u,i,p,l,c):new Jq(u,a,i,p,l,c),this.cache[e]))},n.prototype.encode=function(e,t,r){var o,s,a,u,l;for(a=[],s=[],u=0,l=t.length;u<l;u++)o=e[t[u]],s.push(a.length),o&&(a=a.concat(o.encode(r)));return s.push(a.length),{table:a,offsets:s}},n})(),Jq=(function(){function n(e,t,r,o,s,a){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=o,this.xMax=s,this.yMax=a,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),tU=(function(){function n(e,t,r,o,s){var a,u;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=o,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;u=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&u;)a.pos+=1&u?4:2,128&u?a.pos+=8:64&u?a.pos+=4:8&u&&(a.pos+=2)}return n.prototype.encode=function(){var e,t,r;for(t=new Cu(yS.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),eU=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return rl(n,Eo),n.prototype.tag="loca",n.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var o,s;for(s=[],r=0,o=this.length;r<o;r+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var o,s;for(s=[],r=0,o=this.length;r<o;r+=4)s.push(e.readUInt32());return s}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),o=0,s=0,a=0;a<r.length;++a)if(r[a]=o,s<t.length&&t[s]==a){++s,r[a]=o;var u=this.offsets[a],l=this.offsets[a+1]-u;l>0&&(o+=l)}for(var i=new Array(4*r.length),c=0;c<r.length;++c)i[4*c+3]=255&r[c],i[4*c+2]=(65280&r[c])>>8,i[4*c+1]=(16711680&r[c])>>16,i[4*c]=(4278190080&r[c])>>24;return i},n})(),nU=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,r,o,s;for(t in o=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[t],e[t]=o[r];return e},n.prototype.glyphsFor=function(e){var t,r,o,s,a,u,l;for(o={},a=0,u=e.length;a<u;a++)o[s=e[a]]=this.font.glyf.glyphFor(s);for(s in t=[],o)(r=o[s])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(s in l=this.glyphsFor(t))r=l[s],o[s]=r;return o},n.prototype.encode=function(e,t){var r,o,s,a,u,l,i,c,p,h,f,g,y,b,v;for(o in r=bS.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),f={0:0},v=r.charMap)f[(l=v[o]).old]=l.new;for(g in h=r.maxGlyphID,a)g in f||(f[g]=h++);return c=(function(w){var S,N;for(S in N={},w)N[w[S]]=S;return N})(f),p=Object.keys(c).sort(function(w,S){return w-S}),y=(function(){var w,S,N;for(N=[],w=0,S=p.length;w<S;w++)u=p[w],N.push(c[u]);return N})(),s=this.font.glyf.encode(a,y,f),i=this.font.loca.encode(s.offsets,y),b={cmap:this.font.cmap.raw(),glyf:s.table,loca:i,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},n})();xn.API.PDFObject=(function(){var n;function e(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,o,s,a;if(Array.isArray(t))return"["+(function(){var u,l,i;for(i=[],u=0,l=t.length;u<l;u++)r=t[u],i.push(e.convert(r));return i})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(o in s=["<<"],t)a=t[o],s.push("/"+o+" "+e.convert(a));return s.push(">>"),s.join(`
`)}return""+t},e})();function vS(n,e,t,r,o){r=r||{};var s=1.15,a=o.internal.scaleFactor,u=o.internal.getFontSize()/a,l=o.getLineHeightFactor?o.getLineHeightFactor():s,i=u*l,c=/\r\n|\r|\n/g,p="",h=1;if((r.valign==="middle"||r.valign==="bottom"||r.halign==="center"||r.halign==="right")&&(p=typeof n=="string"?n.split(c):n,h=p.length||1),t+=u*(2-s),r.valign==="middle"?t-=h/2*i:r.valign==="bottom"&&(t-=h*i),r.halign==="center"||r.halign==="right"){var f=u;if(r.halign==="center"&&(f*=.5),p&&h>=1){for(var g=0;g<p.length;g++)o.text(p[g],e-o.getStringUnitWidth(p[g])*f,t),t+=i;return o}e-=o.getStringUnitWidth(n)*f}return r.halign==="justify"?o.text(n,e,t,{maxWidth:r.maxWidth||100,align:"justify"}):o.text(n,e,t),o}var A3={},Cf=(function(){function n(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return n.setDefaults=function(e,t){t===void 0&&(t=null),t?t.__autoTableDocumentDefaults=e:A3=e},n.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},n.prototype.applyStyles=function(e,t){var r,o,s;t===void 0&&(t=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var a=this.jsPDFDocument.internal.getFont(),u=a.fontStyle,l=a.fontName;if(e.font&&(l=e.font),e.fontStyle){u=e.fontStyle;var i=this.getFontList()[l];i&&i.indexOf(u)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(i[0]),u=i[0])}if(this.jsPDFDocument.setFont(l,u),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!t){var c=n.unifyColor(e.fillColor);c&&(r=this.jsPDFDocument).setFillColor.apply(r,c),c=n.unifyColor(e.textColor),c&&(o=this.jsPDFDocument).setTextColor.apply(o,c),c=n.unifyColor(e.lineColor),c&&(s=this.jsPDFDocument).setDrawColor.apply(s,c),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},n.prototype.splitTextToSize=function(e,t,r){return this.jsPDFDocument.splitTextToSize(e,t,r)},n.prototype.rect=function(e,t,r,o,s){return this.jsPDFDocument.rect(e,t,r,o,s)},n.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},n.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},n.prototype.getDocument=function(){return this.jsPDFDocument},n.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},n.prototype.addPage=function(){return this.jsPDFDocument.addPage()},n.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},n.prototype.getGlobalOptions=function(){return A3||{}},n.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},n.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},n.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},n.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},n.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},n.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},n})(),fb=function(n,e){return fb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},fb(n,e)};function wS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");fb(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xS=(function(n){wS(e,n);function e(t){var r=n.call(this)||this;return r._element=t,r}return e})(Array);function rU(n){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/n,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function iU(n){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[n]}function s0(n,e,t){t.applyStyles(e,!0);var r=Array.isArray(n)?n:[n],o=r.map(function(s){return t.getTextWidth(s)}).reduce(function(s,a){return Math.max(s,a)},0);return o}function SS(n,e,t,r){var o=e.settings.tableLineWidth,s=e.settings.tableLineColor;n.applyStyles({lineWidth:o,lineColor:s});var a=_S(o,!1);a&&n.rect(t.x,t.y,e.getWidth(n.pageSize().width),r.y-t.y,a)}function _S(n,e){var t=n>0,r=e||e===0;return t&&r?"DF":t?"S":r?"F":null}function E0(n,e){var t,r,o,s;if(n=n||e,Array.isArray(n)){if(n.length>=4)return{top:n[0],right:n[1],bottom:n[2],left:n[3]};if(n.length===3)return{top:n[0],right:n[1],bottom:n[2],left:n[1]};if(n.length===2)return{top:n[0],right:n[1],bottom:n[0],left:n[1]};n.length===1?n=n[0]:n=e}return typeof n=="object"?(typeof n.vertical=="number"&&(n.top=n.vertical,n.bottom=n.vertical),typeof n.horizontal=="number"&&(n.right=n.horizontal,n.left=n.horizontal),{left:(t=n.left)!==null&&t!==void 0?t:e,top:(r=n.top)!==null&&r!==void 0?r:e,right:(o=n.right)!==null&&o!==void 0?o:e,bottom:(s=n.bottom)!==null&&s!==void 0?s:e}):(typeof n!="number"&&(n=e),{top:n,right:n,bottom:n,left:n})}function kS(n,e){var t=E0(e.settings.margin,0);return n.pageSize().width-(t.left+t.right)}function sU(n,e,t,r,o){var s={},a=1.3333333333333333,u=og(e,function(S){return o.getComputedStyle(S).backgroundColor});u!=null&&(s.fillColor=u);var l=og(e,function(S){return o.getComputedStyle(S).color});l!=null&&(s.textColor=l);var i=oU(r,t);i&&(s.cellPadding=i);var c="borderTopColor",p=a*t,h=r.borderTopWidth;if(r.borderBottomWidth===h&&r.borderRightWidth===h&&r.borderLeftWidth===h){var f=(parseFloat(h)||0)/p;f&&(s.lineWidth=f)}else s.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/p,right:(parseFloat(r.borderRightWidth)||0)/p,bottom:(parseFloat(r.borderBottomWidth)||0)/p,left:(parseFloat(r.borderLeftWidth)||0)/p},s.lineWidth.top||(s.lineWidth.right?c="borderRightColor":s.lineWidth.bottom?c="borderBottomColor":s.lineWidth.left&&(c="borderLeftColor"));var g=og(e,function(S){return o.getComputedStyle(S)[c]});g!=null&&(s.lineColor=g);var y=["left","right","center","justify"];y.indexOf(r.textAlign)!==-1&&(s.halign=r.textAlign),y=["middle","bottom","top"],y.indexOf(r.verticalAlign)!==-1&&(s.valign=r.verticalAlign);var b=parseInt(r.fontSize||"");isNaN(b)||(s.fontSize=b/a);var v=aU(r);v&&(s.fontStyle=v);var w=(r.fontFamily||"").toLowerCase();return n.indexOf(w)!==-1&&(s.font=w),s}function aU(n){var e="";return(n.fontWeight==="bold"||n.fontWeight==="bolder"||parseInt(n.fontWeight)>=700)&&(e="bold"),(n.fontStyle==="italic"||n.fontStyle==="oblique")&&(e+="italic"),e}function og(n,e){var t=AS(n,e);if(!t)return null;var r=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var o=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],s=parseInt(r[4]);return s===0||isNaN(o[0])||isNaN(o[1])||isNaN(o[2])?null:o}function AS(n,e){var t=e(n);return t==="rgba(0, 0, 0, 0)"||t==="transparent"||t==="initial"||t==="inherit"?n.parentElement==null?null:AS(n.parentElement,e):t}function oU(n,e){var t=[n.paddingTop,n.paddingRight,n.paddingBottom,n.paddingLeft],r=96/(72/e),o=(parseInt(n.lineHeight)-parseInt(n.fontSize))/e/2,s=t.map(function(u){return parseInt(u||"0")/r}),a=E0(s,0);return o>a.top&&(a.top=o),o>a.bottom&&(a.bottom=o),a}function CS(n,e,t,r,o){var s,a;r===void 0&&(r=!1),o===void 0&&(o=!1);var u;typeof e=="string"?u=t.document.querySelector(e):u=e;var l=Object.keys(n.getFontList()),i=n.scaleFactor(),c=[],p=[],h=[];if(!u)return console.error("Html table could not be found with input: ",e),{head:c,body:p,foot:h};for(var f=0;f<u.rows.length;f++){var g=u.rows[f],y=(a=(s=g?.parentElement)===null||s===void 0?void 0:s.tagName)===null||a===void 0?void 0:a.toLowerCase(),b=lU(l,i,t,g,r,o);b&&(y==="thead"?c.push(b):y==="tfoot"?h.push(b):p.push(b))}return{head:c,body:p,foot:h}}function lU(n,e,t,r,o,s){for(var a=new xS(r),u=0;u<r.cells.length;u++){var l=r.cells[u],i=t.getComputedStyle(l);if(o||i.display!=="none"){var c=void 0;s&&(c=sU(n,l,e,i,t)),a.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:c,_element:l,content:uU(l)})}}var p=t.getComputedStyle(r);if(a.length>0&&(o||p.display!=="none"))return a}function uU(n){var e=n.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(t){return t.trim()}).join(`
`),e.innerText||e.textContent||""}function cU(n,e,t){for(var r=0,o=[n,e,t];r<o.length;r++){var s=o[r];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function jl(n,e,t,r,o){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(n),a=1;a<arguments.length;a++){var u=arguments[a];if(u!=null)for(var l in u)Object.prototype.hasOwnProperty.call(u,l)&&(s[l]=u[l])}return s}function ES(n,e){var t=new Cf(n),r=t.getDocumentOptions(),o=t.getGlobalOptions();cU(o,r,e);var s=jl({},o,r,e),a;typeof window<"u"&&(a=window);var u=fU(o,r,e),l=hU(o,r,e),i=dU(t,s),c=mU(t,s,a);return{id:e.tableId,content:c,hooks:l,styles:u,settings:i}}function fU(n,e,t){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},o=function(l){if(l==="columnStyles"){var i=n[l],c=e[l],p=t[l];r.columnStyles=jl({},i,c,p)}else{var h=[n,e,t],f=h.map(function(g){return g[l]||{}});r[l]=jl({},f[0],f[1],f[2])}},s=0,a=Object.keys(r);s<a.length;s++){var u=a[s];o(u)}return r}function hU(n,e,t){for(var r=[n,e,t],o={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,a=r;s<a.length;s++){var u=a[s];u.didParseCell&&o.didParseCell.push(u.didParseCell),u.willDrawCell&&o.willDrawCell.push(u.willDrawCell),u.didDrawCell&&o.didDrawCell.push(u.didDrawCell),u.willDrawPage&&o.willDrawPage.push(u.willDrawPage),u.didDrawPage&&o.didDrawPage.push(u.didDrawPage)}return o}function dU(n,e){var t,r,o,s,a,u,l,i,c,p,h,f,g=E0(e.margin,40/n.scaleFactor()),y=(t=pU(n,e.startY))!==null&&t!==void 0?t:g.top,b;e.showFoot===!0?b="everyPage":e.showFoot===!1?b="never":b=(r=e.showFoot)!==null&&r!==void 0?r:"everyPage";var v;e.showHead===!0?v="everyPage":e.showHead===!1?v="never":v=(o=e.showHead)!==null&&o!==void 0?o:"everyPage";var w=(s=e.useCss)!==null&&s!==void 0?s:!1,S=e.theme||(w?"plain":"striped"),N=!!e.horizontalPageBreak,D=(a=e.horizontalPageBreakRepeat)!==null&&a!==void 0?a:null;return{includeHiddenHtml:(u=e.includeHiddenHtml)!==null&&u!==void 0?u:!1,useCss:w,theme:S,startY:y,margin:g,pageBreak:(l=e.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(i=e.rowPageBreak)!==null&&i!==void 0?i:"auto",tableWidth:(c=e.tableWidth)!==null&&c!==void 0?c:"auto",showHead:v,showFoot:b,tableLineWidth:(p=e.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(h=e.tableLineColor)!==null&&h!==void 0?h:200,horizontalPageBreak:N,horizontalPageBreakRepeat:D,horizontalPageBreakBehaviour:(f=e.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function pU(n,e){var t=n.getLastAutoTable(),r=n.scaleFactor(),o=n.pageNumber(),s=!1;if(t&&t.startPageNumber){var a=t.startPageNumber+t.pageNumber-1;s=a===o}return typeof e=="number"?e:(e==null||e===!1)&&s&&t?.finalY!=null?t.finalY+20/r:null}function mU(n,e,t){var r=e.head||[],o=e.body||[],s=e.foot||[];if(e.html){var a=e.includeHiddenHtml;if(t){var u=CS(n,e.html,t,a,e.useCss)||{};r=u.head||r,o=u.body||r,s=u.foot||r}else console.error("Cannot parse html in non browser environment")}var l=e.columns||gU(r,o,s);return{columns:l,head:r,body:o,foot:s}}function gU(n,e,t){var r=n[0]||e[0]||t[0]||[],o=[];return Object.keys(r).filter(function(s){return s!=="_element"}).forEach(function(s){var a=1,u;Array.isArray(r)?u=r[parseInt(s)]:u=r[s],typeof u=="object"&&!Array.isArray(u)&&(a=u?.colSpan||1);for(var l=0;l<a;l++){var i=void 0;Array.isArray(r)?i=o.length:i=s+(l>0?"_".concat(l):"");var c={dataKey:i};o.push(c)}}),o}var hb=(function(){function n(e,t,r){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=r,this.doc=e.getDocument()}return n})(),bU=(function(n){wS(e,n);function e(t,r,o,s,a,u){var l=n.call(this,t,r,u)||this;return l.cell=o,l.row=s,l.column=a,l.section=s.section,l}return e})(hb),yU=(function(){function n(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return n.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,r){return t+r.getMaxCellHeight(e)},0)},n.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,r){return t+r.getMaxCellHeight(e)},0)},n.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},n.prototype.callCellHooks=function(e,t,r,o,s,a){for(var u=0,l=t;u<l.length;u++){var i=l[u],c=new bU(e,this,r,o,s,a),p=i(c)===!1;if(r.text=Array.isArray(r.text)?r.text:[r.text],p)return!1}return!0},n.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var r=0,o=this.hooks.didDrawPage;r<o.length;r++){var s=o[r];s(new hb(e,this,t))}},n.prototype.callWillDrawPageHooks=function(e,t){for(var r=0,o=this.hooks.willDrawPage;r<o.length;r++){var s=o[r];s(new hb(e,this,t))}},n.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(o,s){return o+s.wrappedWidth},0);return t}else{var r=this.settings.margin;return e-r.left-r.right}},n})(),NS=(function(){function n(e,t,r,o,s){s===void 0&&(s=!1),this.height=0,this.raw=e,e instanceof xS&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=r,this.cells=o,this.spansMultiplePages=s}return n.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(r,o){var s;return Math.max(r,((s=t.cells[o.index])===null||s===void 0?void 0:s.height)||0)},0)},n.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(r){var o=t.cells[r.index];return o?o.rowSpan>1:!1}).length>0},n.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},n.prototype.getMinimumRowHeight=function(e,t){var r=this;return e.reduce(function(o,s){var a=r.cells[s.index];if(!a)return 0;var u=t.getLineHeight(a.styles.fontSize),l=a.padding("vertical"),i=l+u;return i>o?i:o},0)},n})(),TS=(function(){function n(e,t,r){var o;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=r,this.raw=e;var s=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,s=(o=e.content)!==null&&o!==void 0?o:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var a=s!=null?""+s:"",u=/\r\n|\r|\n/g;this.text=a.split(u)}return n.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");e=this.y+t/2+this.padding("top")}var r;if(this.styles.halign==="right")r=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var o=this.width-this.padding("horizontal");r=this.x+o/2+this.padding("left")}else r=this.x+this.padding("left");return{x:r,y:e}},n.prototype.getContentHeight=function(e,t){t===void 0&&(t=1.15);var r=Array.isArray(this.text)?this.text.length:1,o=this.styles.fontSize/e*t,s=r*o+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},n.prototype.padding=function(e){var t=E0(this.styles.cellPadding,0);return e==="vertical"?t.top+t.bottom:e==="horizontal"?t.left+t.right:t[e]},n})(),vU=(function(){function n(e,t,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=r}return n.prototype.getMaxCustomCellWidth=function(e){for(var t=0,r=0,o=e.allRows();r<o.length;r++){var s=o[r],a=s.cells[this.index];a&&typeof a.styles.cellWidth=="number"&&(t=Math.max(t,a.styles.cellWidth))}return t},n})();function wU(n,e){xU(n,e);var t=[],r=0;e.columns.forEach(function(s){var a=s.getMaxCustomCellWidth(e);a?s.width=a:(s.width=s.wrappedWidth,t.push(s)),r+=s.width});var o=e.getWidth(n.pageSize().width)-r;o&&(o=db(t,o,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),o&&(o=db(t,o,function(s){return s.minWidth})),o=Math.abs(o),!e.settings.horizontalPageBreak&&o>.1/n.scaleFactor()&&(o=o<1?o:Math.round(o),console.log("Of the table content, ".concat(o," units width could not fit page"))),_U(e),kU(e,n),SU(e)}function xU(n,e){var t=n.scaleFactor(),r=e.settings.horizontalPageBreak,o=kS(n,e);e.allRows().forEach(function(s){for(var a=0,u=e.columns;a<u.length;a++){var l=u[a],i=s.cells[l.index];if(i){var c=e.hooks.didParseCell;e.callCellHooks(n,c,i,s,l,null);var p=i.padding("horizontal");i.contentWidth=s0(i.text,i.styles,n)+p;var h=s0(i.text.join(" ").split(/[^\S\u00A0]+/),i.styles,n);if(i.minReadableWidth=h+i.padding("horizontal"),typeof i.styles.cellWidth=="number")i.minWidth=i.styles.cellWidth,i.wrappedWidth=i.styles.cellWidth;else if(i.styles.cellWidth==="wrap"||r===!0)i.contentWidth>o?(i.minWidth=o,i.wrappedWidth=o):(i.minWidth=i.contentWidth,i.wrappedWidth=i.contentWidth);else{var f=10/t;i.minWidth=i.styles.minCellWidth||f,i.wrappedWidth=i.contentWidth,i.minWidth>i.wrappedWidth&&(i.wrappedWidth=i.minWidth)}}}}),e.allRows().forEach(function(s){for(var a=0,u=e.columns;a<u.length;a++){var l=u[a],i=s.cells[l.index];if(i&&i.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,i.wrappedWidth),l.minWidth=Math.max(l.minWidth,i.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,i.minReadableWidth);else{var c=e.styles.columnStyles[l.dataKey]||e.styles.columnStyles[l.index]||{},p=c.cellWidth||c.minCellWidth;p&&typeof p=="number"&&(l.minWidth=p,l.wrappedWidth=p)}i&&(i.colSpan>1&&!l.minWidth&&(l.minWidth=i.minWidth),i.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=i.minWidth))}})}function db(n,e,t){for(var r=e,o=n.reduce(function(f,g){return f+g.wrappedWidth},0),s=0;s<n.length;s++){var a=n[s],u=a.wrappedWidth/o,l=r*u,i=a.width+l,c=t(a),p=i<c?c:i;e-=p-a.width,a.width=p}if(e=Math.round(e*1e10)/1e10,e){var h=n.filter(function(f){return e<0?f.width>t(f):!0});h.length&&(e=db(h,e,t))}return e}function SU(n){for(var e={},t=1,r=n.allRows(),o=0;o<r.length;o++)for(var s=r[o],a=0,u=n.columns;a<u.length;a++){var l=u[a],i=e[l.index];if(t>1)t--,delete s.cells[l.index];else if(i)i.cell.height+=s.height,t=i.cell.colSpan,delete s.cells[l.index],i.left--,i.left<=1&&delete e[l.index];else{var c=s.cells[l.index];if(!c)continue;if(c.height=s.height,c.rowSpan>1){var p=r.length-o,h=c.rowSpan>p?p:c.rowSpan;e[l.index]={cell:c,left:h,row:s}}}}}function _U(n){for(var e=n.allRows(),t=0;t<e.length;t++)for(var r=e[t],o=null,s=0,a=0,u=0;u<n.columns.length;u++){var l=n.columns[u];if(a-=1,a>1&&n.columns[u+1])s+=l.width,delete r.cells[l.index];else if(o){var i=o;delete r.cells[l.index],o=null,i.width=l.width+s}else{var i=r.cells[l.index];if(!i)continue;if(a=i.colSpan,s=0,i.colSpan>1){o=i,s+=l.width;continue}i.width=l.width+s}}}function kU(n,e){for(var t={count:0,height:0},r=0,o=n.allRows();r<o.length;r++){for(var s=o[r],a=0,u=n.columns;a<u.length;a++){var l=u[a],i=s.cells[l.index];if(i){e.applyStyles(i.styles,!0);var c=i.width-i.padding("horizontal");if(i.styles.overflow==="linebreak")i.text=e.splitTextToSize(i.text,c+1/e.scaleFactor(),{fontSize:i.styles.fontSize});else if(i.styles.overflow==="ellipsize")i.text=C3(i.text,c,i.styles,e,"...");else if(i.styles.overflow==="hidden")i.text=C3(i.text,c,i.styles,e,"");else if(typeof i.styles.overflow=="function"){var p=i.styles.overflow(i.text,c);typeof p=="string"?i.text=[p]:i.text=p}i.contentHeight=i.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var h=i.contentHeight/i.rowSpan;i.rowSpan>1&&t.count*t.height<h*i.rowSpan?t={height:h,count:i.rowSpan}:t&&t.count>0&&t.height>h&&(h=t.height),h>s.height&&(s.height=h)}}t.count--}}function C3(n,e,t,r,o){return n.map(function(s){return AU(s,e,t,r,o)})}function AU(n,e,t,r,o){var s=1e4*r.scaleFactor();if(e=Math.ceil(e*s)/s,e>=s0(n,t,r))return n;for(;e<s0(n+o,t,r)&&!(n.length<=1);)n=n.substring(0,n.length-1);return n.trim()+o}function jS(n,e){var t=new Cf(n),r=CU(e,t.scaleFactor()),o=new yU(e,r);return wU(t,o),t.applyStyles(t.userStyles),o}function CU(n,e){var t=n.content,r=NU(t.columns);if(t.head.length===0){var o=E3(r,"head");o&&t.head.push(o)}if(t.foot.length===0){var o=E3(r,"foot");o&&t.foot.push(o)}var s=n.settings.theme,a=n.styles;return{columns:r,head:lg("head",t.head,r,a,s,e),body:lg("body",t.body,r,a,s,e),foot:lg("foot",t.foot,r,a,s,e)}}function lg(n,e,t,r,o,s){var a={},u=e.map(function(l,i){for(var c=0,p={},h=0,f=0,g=0,y=t;g<y.length;g++){var b=y[g];if(a[b.index]==null||a[b.index].left===0)if(f===0){var v=void 0;Array.isArray(l)?v=l[b.index-h-c]:v=l[b.dataKey];var w={};typeof v=="object"&&!Array.isArray(v)&&(w=v?.styles||{});var S=TU(n,b,i,o,r,s,w),N=new TS(v,S,n);p[b.dataKey]=N,p[b.index]=N,f=N.colSpan-1,a[b.index]={left:N.rowSpan-1,times:f}}else f--,h++;else a[b.index].left--,f=a[b.index].times,c++}return new NS(l,i,n,p)});return u}function E3(n,e){var t={};return n.forEach(function(r){if(r.raw!=null){var o=EU(e,r.raw);o!=null&&(t[r.dataKey]=o)}}),Object.keys(t).length>0?t:null}function EU(n,e){if(n==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(n==="foot"&&typeof e=="object")return e.footer;return null}function NU(n){return n.map(function(e,t){var r,o;return typeof e=="object"?o=(r=e.dataKey)!==null&&r!==void 0?r:t:o=t,new vU(o,e,t)})}function TU(n,e,t,r,o,s,a){var u=iU(r),l;n==="head"?l=o.headStyles:n==="body"?l=o.bodyStyles:n==="foot"&&(l=o.footStyles);var i=jl({},u.table,u[n],o.styles,l),c=o.columnStyles[e.dataKey]||o.columnStyles[e.index]||{},p=n==="body"?c:{},h=n==="body"&&t%2===0?jl({},u.alternateRow,o.alternateRowStyles):{},f=rU(s),g=jl({},f,i,h,p);return jl(g,a)}function jU(n,e,t){var r;t===void 0&&(t={});var o=kS(n,e),s=new Map,a=[],u=[],l=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?l=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(l=[e.settings.horizontalPageBreakRepeat]),l.forEach(function(h){var f=e.columns.find(function(g){return g.dataKey===h||g.index===h});f&&!s.has(f.index)&&(s.set(f.index,!0),a.push(f.index),u.push(e.columns[f.index]),o-=f.wrappedWidth)});for(var i=!0,c=(r=t?.start)!==null&&r!==void 0?r:0;c<e.columns.length;){if(s.has(c)){c++;continue}var p=e.columns[c].wrappedWidth;if(i||o>=p)i=!1,a.push(c),u.push(e.columns[c]),o-=p;else break;c++}return{colIndexes:a,columns:u,lastIndex:c-1}}function MU(n,e){for(var t=[],r=0;r<e.columns.length;r++){var o=jU(n,e,{start:r});o.columns.length&&(t.push(o),r=o.lastIndex)}return t}function MS(n,e){var t=e.settings,r=t.startY,o=t.margin,s={x:o.left,y:r},a=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),u=r+o.bottom+a;if(t.pageBreak==="avoid"){var l=e.body,i=l.reduce(function(h,f){return h+f.height},0);u+=i}var c=new Cf(n);(t.pageBreak==="always"||t.startY!=null&&u>c.pageSize().height)&&(OS(c),s.y=o.top),e.callWillDrawPageHooks(c,s);var p=jl({},s);e.startPageNumber=c.pageNumber(),t.horizontalPageBreak?LU(c,e,p,s):(c.applyStyles(c.userStyles),(t.showHead==="firstPage"||t.showHead==="everyPage")&&e.head.forEach(function(h){return Dl(c,e,h,s,e.columns)}),c.applyStyles(c.userStyles),e.body.forEach(function(h,f){var g=f===e.body.length-1;a0(c,e,h,g,p,s,e.columns)}),c.applyStyles(c.userStyles),(t.showFoot==="lastPage"||t.showFoot==="everyPage")&&e.foot.forEach(function(h){return Dl(c,e,h,s,e.columns)})),SS(c,e,p,s),e.callEndPageHooks(c,s),e.finalY=s.y,n.lastAutoTable=e,c.applyStyles(c.userStyles)}function LU(n,e,t,r){var o=MU(n,e),s=e.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")o.forEach(function(i,c){n.applyStyles(n.userStyles),c>0?zh(n,e,t,r,i.columns,!0):N3(n,e,r,i.columns),OU(n,e,t,r,i.columns),ug(n,e,r,i.columns)});else for(var a=-1,u=o[0],l=function(){var i=a;if(u){n.applyStyles(n.userStyles);var c=u.columns;a>=0?zh(n,e,t,r,c,!0):N3(n,e,r,c),i=T3(n,e,a+1,r,c),ug(n,e,r,c)}var p=i-a;o.slice(1).forEach(function(h){n.applyStyles(n.userStyles),zh(n,e,t,r,h.columns,!0),T3(n,e,a+1,r,h.columns,p),ug(n,e,r,h.columns)}),a=i};a<e.body.length-1;)l()}function N3(n,e,t,r){var o=e.settings;n.applyStyles(n.userStyles),(o.showHead==="firstPage"||o.showHead==="everyPage")&&e.head.forEach(function(s){return Dl(n,e,s,t,r)})}function OU(n,e,t,r,o){n.applyStyles(n.userStyles),e.body.forEach(function(s,a){var u=a===e.body.length-1;a0(n,e,s,u,t,r,o)})}function T3(n,e,t,r,o,s){n.applyStyles(n.userStyles),s=s??e.body.length;var a=Math.min(t+s,e.body.length),u=-1;return e.body.slice(t,a).forEach(function(l,i){var c=t+i===e.body.length-1,p=LS(n,e,c,r);l.canEntireRowFit(p,o)&&(Dl(n,e,l,r,o),u=t+i)}),u}function ug(n,e,t,r){var o=e.settings;n.applyStyles(n.userStyles),(o.showFoot==="lastPage"||o.showFoot==="everyPage")&&e.foot.forEach(function(s){return Dl(n,e,s,t,r)})}function RU(n,e,t){var r=t.getLineHeight(n.styles.fontSize),o=n.padding("vertical"),s=Math.floor((e-o)/r);return Math.max(0,s)}function IU(n,e,t,r){var o={};n.spansMultiplePages=!0,n.height=0;for(var s=0,a=0,u=t.columns;a<u.length;a++){var l=u[a],i=n.cells[l.index];if(i){Array.isArray(i.text)||(i.text=[i.text]);var c=new TS(i.raw,i.styles,i.section);c=jl(c,i),c.text=[];var p=RU(i,e,r);i.text.length>p&&(c.text=i.text.splice(p,i.text.length));var h=r.scaleFactor(),f=r.getLineHeightFactor();i.contentHeight=i.getContentHeight(h,f),i.contentHeight>=e&&(i.contentHeight=e,c.styles.minCellHeight-=e),i.contentHeight>n.height&&(n.height=i.contentHeight),c.contentHeight=c.getContentHeight(h,f),c.contentHeight>s&&(s=c.contentHeight),o[l.index]=c}}var g=new NS(n.raw,-1,n.section,o,!0);g.height=s;for(var y=0,b=t.columns;y<b.length;y++){var l=b[y],c=g.cells[l.index];c&&(c.height=g.height);var i=n.cells[l.index];i&&(i.height=n.height)}return g}function DU(n,e,t,r){var o=n.pageSize().height,s=r.settings.margin,a=s.top+s.bottom,u=o-a;e.section==="body"&&(u-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var l=e.getMinimumRowHeight(r.columns,n),i=l<t;if(l>u)return console.log("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!i)return!1;var c=e.hasRowSpan(r.columns),p=e.getMaxCellHeight(r.columns)>u;return p?(c&&console.log("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(c||r.settings.rowPageBreak==="avoid")}function a0(n,e,t,r,o,s,a){var u=LS(n,e,r,s);if(t.canEntireRowFit(u,a))Dl(n,e,t,s,a);else if(DU(n,t,u,e)){var l=IU(t,u,e,n);Dl(n,e,t,s,a),zh(n,e,o,s,a),a0(n,e,l,r,o,s,a)}else zh(n,e,o,s,a),a0(n,e,t,r,o,s,a)}function Dl(n,e,t,r,o){r.x=e.settings.margin.left;for(var s=0,a=o;s<a.length;s++){var u=a[s],l=t.cells[u.index];if(!l){r.x+=u.width;continue}n.applyStyles(l.styles),l.x=r.x,l.y=r.y;var i=e.callCellHooks(n,e.hooks.willDrawCell,l,t,u,r);if(i===!1){r.x+=u.width;continue}BU(n,l,r);var c=l.getTextPos();vS(l.text,c.x,c.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},n.getDocument()),e.callCellHooks(n,e.hooks.didDrawCell,l,t,u,r),r.x+=u.width}r.y+=t.height}function BU(n,e,t){var r=e.styles;if(n.getDocument().setFillColor(n.getDocument().getFillColor()),typeof r.lineWidth=="number"){var o=_S(r.lineWidth,r.fillColor);o&&n.rect(e.x,t.y,e.width,e.height,o)}else typeof r.lineWidth=="object"&&(r.fillColor&&n.rect(e.x,t.y,e.width,e.height,"F"),PU(n,e,t,r.lineWidth))}function PU(n,e,t,r){var o,s,a,u;r.top&&(o=t.x,s=t.y,a=t.x+e.width,u=t.y,r.right&&(a+=.5*r.right),r.left&&(o-=.5*r.left),l(r.top,o,s,a,u)),r.bottom&&(o=t.x,s=t.y+e.height,a=t.x+e.width,u=t.y+e.height,r.right&&(a+=.5*r.right),r.left&&(o-=.5*r.left),l(r.bottom,o,s,a,u)),r.left&&(o=t.x,s=t.y,a=t.x,u=t.y+e.height,r.top&&(s-=.5*r.top),r.bottom&&(u+=.5*r.bottom),l(r.left,o,s,a,u)),r.right&&(o=t.x+e.width,s=t.y,a=t.x+e.width,u=t.y+e.height,r.top&&(s-=.5*r.top),r.bottom&&(u+=.5*r.bottom),l(r.right,o,s,a,u));function l(i,c,p,h,f){n.getDocument().setLineWidth(i),n.getDocument().line(c,p,h,f,"S")}}function LS(n,e,t,r){var o=e.settings.margin.bottom,s=e.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&t)&&(o+=e.getFootHeight(e.columns)),n.pageSize().height-r.y-o}function zh(n,e,t,r,o,s){o===void 0&&(o=[]),s===void 0&&(s=!1),n.applyStyles(n.userStyles),e.settings.showFoot==="everyPage"&&!s&&e.foot.forEach(function(u){return Dl(n,e,u,r,o)}),e.callEndPageHooks(n,r);var a=e.settings.margin;SS(n,e,t,r),OS(n),e.pageNumber++,r.x=a.left,r.y=a.top,t.y=a.top,e.callWillDrawPageHooks(n,r),e.settings.showHead==="everyPage"&&(e.head.forEach(function(u){return Dl(n,e,u,r,o)}),n.applyStyles(n.userStyles))}function OS(n){var e=n.pageNumber();n.setPage(e+1);var t=n.pageNumber();return t===e?(n.addPage(),!0):!1}function FU(n){n.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],o=ES(this,r),s=jS(this,o);return MS(this,s),this},n.API.lastAutoTable=!1,n.API.autoTableText=function(e,t,r,o){vS(e,t,r,o,this)},n.API.autoTableSetDefaults=function(e){return Cf.setDefaults(e,this),this},n.autoTableSetDefaults=function(e,t){Cf.setDefaults(e,t)},n.API.autoTableHtmlToJson=function(e,t){var r;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var o=new Cf(this),s=CS(o,e,window,t,!1),a=s.head,u=s.body,l=((r=a[0])===null||r===void 0?void 0:r.map(function(i){return i.content}))||[];return{columns:l,rows:u,data:u}}}var cg;function zU(n,e){var t=ES(n,e),r=jS(n,t);MS(n,r)}try{if(typeof window<"u"&&window){var j3=window,M3=j3.jsPDF||((cg=j3.jspdf)===null||cg===void 0?void 0:cg.jsPDF);M3&&FU(M3)}}catch(n){console.error("Could not apply autoTable plugin",n)}function L3(n,e,t){let{startX:r,startY:o,maxWidth:s,margin:a,pageHeight:u}=t,l=o;const i=12,c=18,p=document.createElement("div");p.style.display="none",p.innerHTML=e,document.body.appendChild(p);const h=(g=i)=>{l+g>u-a&&(n.addPage(),l=a)},f=(g,y,b)=>{const v=b.isBold||g.tagName==="STRONG"||g.tagName==="B",w=b.isItalic||g.tagName==="EM"||g.tagName==="I";let S="normal";if(v&&w?S="bolditalic":v?S="bold":w&&(S="italic"),g.nodeType===3){let N=(g.textContent||"").replace(/\s+/g," ");const D=/(\{[^}]+\})/g,F=N.split(D);for(let G=0;G<F.length;G++){const P=F[G];if(!P)continue;const U=/^\{[^}]+\}$/.test(P);if(n.setFont(void 0,S),U){n.setTextColor(234,88,12);const q=n.getTextWidth(P);y+q>r+s&&(l+=i,y=r,h()),n.text(P,y,l),y+=q}else{n.setTextColor(0);const q=P.split(" ");for(let R=0;R<q.length;R++){const I=q[R];if(!I){if(R>0||G>0){const x=n.getTextWidth(" ");y+=x}continue}const L=R>0&&q[R-1]!==""?" "+I:I,E=n.getTextWidth(L);if(y+E>r+s){l+=i,y=r,h();const x=L.trimStart();n.text(x,y,l),y+=n.getTextWidth(x)}else n.text(L,y,l),y+=E}}}}else for(const N of Array.from(g.childNodes))y=f(N,y,{isBold:v,isItalic:w});return y};return Array.from(p.children).forEach(g=>{switch(h(c),g.tagName){case"P":f(g,r,{}),l+=c;break;case"UL":case"OL":Array.from(g.children).forEach((y,b)=>{h(c);const v=g.tagName==="OL"?`${b+1}. `:" ";n.text(v,r,l),f(y,r+15,{}),l+=c});break;default:f(g,r,{}),l+=c}}),document.body.removeChild(p),l}function qU(n,e,t){let s=0;const a=document.createElement("div");a.style.display="none",a.innerHTML=e,document.body.appendChild(a);const u=(l,i)=>{if(l.nodeType===3){const p=(l.textContent||"").replace(/\s+/g," ").split(" ");for(const h of p){if(!h)continue;const f=h+" ",g=n.getTextWidth(f);i+g>t&&(s+=12,i=0),i+=g}}else for(const c of Array.from(l.childNodes))i=u(c,i);return i};return Array.from(a.children).forEach(l=>{u(l,0),s+=18}),document.body.removeChild(a),s+20}function pb(n,e,t={},r=!1){if(!n||n.length===0){console.error("Emails array is empty. Cannot generate PDF receipt.");return}try{const o=new xn({orientation:"portrait",unit:"px",format:"letter"}),s=o.internal.pageSize.getWidth(),a=o.internal.pageSize.getHeight(),u=30,l=s-u*2;let i=0;o.setFontSize(18),o.text("Email Sending Receipt",s/2,i+40,{align:"center"}),o.setFontSize(10),o.text(`Sent on: ${new Date().toLocaleString()}`,s/2,i+55,{align:"center"}),t.name||t.email?(o.text(`Initiated by: ${t.name||"Unknown"}${t.email?` (${t.email})`:""}`,s/2,i+68,{align:"center"}),i=88):i=75,o.setFontSize(12),o.text("Summary",u,i),o.line(u,i+2,s-u,i+2),i+=15,o.setFontSize(10),o.text(`Total Emails Sent: ${n.length}`,u,i),i+=12;const c=n.reduce((b,v)=>{const w=v.from||"N/A";return b[w]=(b[w]||0)+1,b},{}),p=Object.keys(c);p.length===1?(o.text(`Sent From: ${p[0]}`,u,i),i+=12):(o.setFont(void 0,"bold"),o.text("Sent From (Breakdown):",u,i),o.setFont(void 0,"normal"),i+=12,p.forEach(b=>{const v=c[b];o.text(`- ${b}: ${v} email(s)`,u+10,i),i+=12})),i+=20,o.setFontSize(12),o.text("Message Body",u,i),o.line(u,i+2,s-u,i+2),i+=20;const h=/\{(\w+)\}/.test(e);o.setFontSize(10),o.setFont(void 0,"bold");const f=h?"Template Format:":"Email Body:";if(o.text(f,u,i),o.setFont(void 0,"normal"),i+=15,i=L3(o,e,{startX:u,startY:i,maxWidth:l,margin:u,pageHeight:a}),i+=10,h){const b=n[Math.floor(Math.random()*n.length)],v=qU(o,b.body,l),w=a-u-i;v>w&&(o.addPage(),i=u),o.setFont(void 0,"bold"),o.text("Example:",u,i),o.setFont(void 0,"normal"),i+=15,i=L3(o,b.body,{startX:u,startY:i,maxWidth:l,margin:u,pageHeight:a}),i+=10}o.addPage(),o.setFontSize(12),o.text("Recipient List",u,u),o.line(u,u+2,s-u,u+2);const g=["#","Recipient Email","Subject"],y=n.map((b,v)=>[v+1,b.to,b.subject.substring(0,45)+(b.subject.length>45?"...":"")]);if(zU(o,{head:[g],body:y,startY:u+15,theme:"grid",headStyles:{fillColor:[41,128,185]},styles:{fontSize:8,cellPadding:2},columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:150},2:{cellWidth:"auto"}}}),r)return o.output("datauristring").split(",")[1];{const b=`Email_Receipt_${C8().replace("LDA ","")}.pdf`;o.save(b)}}catch(o){console.error("Failed to generate PDF receipt:",o);return}}function UU({isOpen:n,onClose:e,studentData:t,fromTemplate:r,ccRecipients:o,subjectTemplate:s,bodyTemplate:a}){const[u,l]=jt.useState(0),[i,c]=jt.useState(!1),[p,h]=jt.useState(""),[f,g]=jt.useState([]);if(jt.useEffect(()=>{n&&(l(0),c(!1),h(""),g([]))},[n]),!n||!t||t.length===0)return null;const y=t[u],b=Xo(r,y),v=y.StudentEmail||"[No Email]",w=E8(o,y),S=Xo(s,y),N=Xo(a,y),D=()=>{u>0&&l(u-1)},F=()=>{u<t.length-1&&l(u+1)},G=()=>{const q=Math.floor(Math.random()*t.length);l(q)},P=q=>{if(h(q),!q.trim()){g([]);return}const R=t.map((I,T)=>({student:I,index:T})).filter(I=>I.student.StudentName&&I.student.StudentName.toLowerCase().includes(q.toLowerCase())).slice(0,10);g(R)},U=q=>{l(q),c(!1),h(""),g([])};return W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50",children:W.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-lg",children:[W.jsxs("div",{className:"flex justify-between items-center mb-4",children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Email Preview"}),W.jsxs("div",{className:"flex items-center gap-2",children:[W.jsx("button",{onClick:D,disabled:u===0,className:"p-1 rounded-full hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous Student",children:W.jsx("svg",{className:"h-5 w-5 text-gray-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:W.jsx("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})}),W.jsxs("span",{className:"text-sm text-gray-600 font-medium w-36 text-center",children:["Student: ",u+1," / ",t.length]}),W.jsx("button",{onClick:F,disabled:u===t.length-1,className:"p-1 rounded-full hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Next Student",children:W.jsx("svg",{className:"h-5 w-5 text-gray-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:W.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})}),W.jsx("button",{onClick:G,className:"p-1 rounded-full hover:bg-gray-200",title:"Random Student",children:W.jsx("svg",{className:"h-5 w-5 text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.667 0l3.182-3.182m0-11.667l-3.182 3.182a8.25 8.25 0 00-11.667 0L2.985 19.644z"})})}),W.jsx("button",{onClick:()=>c(!i),className:"p-1 rounded-full hover:bg-gray-200",title:"Search Student",children:W.jsx("svg",{className:"h-5 w-5 text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})})})]})]}),i&&W.jsxs("div",{className:"relative mb-2",children:[W.jsx("input",{type:"text",value:p,onChange:q=>P(q.target.value),className:"w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"Search by student name..."}),f.length>0&&W.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-40 overflow-y-auto",children:f.map(q=>W.jsx("div",{onClick:()=>U(q.index),className:"px-3 py-2 text-sm text-gray-700 cursor-pointer hover:bg-gray-100",children:q.student.StudentName},q.index))})]}),W.jsxs("div",{className:"space-y-3 text-sm border-t border-b py-4",children:[W.jsxs("div",{className:"flex",children:[W.jsx("label",{className:"font-semibold text-gray-600 w-20",children:"From:"}),W.jsx("p",{className:"text-gray-800",children:b})]}),W.jsxs("div",{className:"flex",children:[W.jsx("label",{className:"font-semibold text-gray-600 w-20",children:"Recipient:"}),W.jsx("p",{className:"text-gray-800",children:v})]}),W.jsxs("div",{className:"flex",children:[W.jsx("label",{className:"font-semibold text-gray-600 w-20",children:"CC:"}),W.jsx("p",{className:"text-gray-800",children:w})]}),W.jsxs("div",{className:"flex",children:[W.jsx("label",{className:"font-semibold text-gray-600 w-20",children:"Subject:"}),W.jsx("p",{className:"text-gray-800 font-medium",children:S})]}),W.jsxs("div",{children:[W.jsx("label",{className:"font-semibold text-gray-600",children:"Body:"}),W.jsx("div",{className:"text-gray-800 border rounded-md p-2 bg-gray-50 max-h-64 overflow-y-auto w-full mt-1",dangerouslySetInnerHTML:{__html:N}})]})]}),W.jsx("div",{className:"flex justify-end mt-4",children:W.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Close"})})]})})}function HU({isOpen:n,onClose:e,onLoadTemplate:t,user:r,userEmail:o,currentFrom:s,currentSubject:a,currentBody:u,currentCC:l,templates:i,onTemplatesChange:c}){const[p,h]=jt.useState(new Set),[f,g]=jt.useState(!1),[y,b]=jt.useState(null),[v,w]=jt.useState(""),[S,N]=jt.useState(""),[D,F]=jt.useState(""),[G,P]=jt.useState(null),[U,q]=jt.useState(""),R=r==="Guest",I=o?.toLowerCase()==="vblanco1@ftccollege.edu",T=async j=>{await Excel.run(async B=>{B.workbook.settings.add(k8,JSON.stringify(j)),await B.sync()}),c(j)},L=j=>{const B=new Set(p);B.has(j)?B.delete(j):B.add(j),h(B)},E=j=>{q(j.name),t(j),e()},x=j=>{b(j),w(j.name),N(j.author||r||"Unknown"),g(!0)},k=async j=>{const B=i.filter(O=>O.id!==j.id);await T(B),g(!1)},A=async(j=!1)=>{if(!v.trim()){F("Template name is required.");return}const B=I?S.trim()||r||"Unknown":r||"Unknown";if(!y&&!j){const X=i.find(et=>et.name.toLowerCase()===v.trim().toLowerCase()&&et.author===B);if(X){P(X);return}}const O={name:v.trim(),author:B,from:s,subject:a,body:u,cc:l||[]};let H=[...i];if(y){const X=H.findIndex(et=>et.id===y.id);X!==-1&&(H[X]={...H[X],...O})}else if(j&&G){const X=H.findIndex(et=>et.id===G.id);X!==-1&&(H[X]={...H[X],...O})}else H.push({...O,id:"tpl-"+Date.now(),createdAt:new Date().toISOString()});await T(H),P(null),F("Template saved successfully!"),setTimeout(()=>{g(!1),F("")},1500)};if(!n)return null;const C=i.reduce((j,B)=>{const O=B.author||"Uncategorized";return j[O]||(j[O]=[]),j[O].push(B),j},{});return W.jsxs(W.Fragment,{children:[W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50",children:W.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-xl",children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Email Templates"}),W.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto border-t border-b py-4",children:i.length===0?W.jsx("p",{className:"text-center text-gray-500 text-sm",children:"No saved templates yet."}):Object.keys(C).sort().map(j=>W.jsxs("div",{children:[W.jsxs("div",{onClick:()=>L(j),className:"flex items-center justify-between p-2 rounded-md hover:bg-gray-100 cursor-pointer",children:[W.jsxs("div",{className:"flex items-center space-x-2",children:[W.jsx("svg",{className:"h-5 w-5 text-gray-500",viewBox:"0 0 20 20",fill:"currentColor",children:W.jsx("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})}),W.jsx("span",{className:"font-semibold text-gray-700",children:j})]}),W.jsx("svg",{className:`h-5 w-5 text-gray-500 transition-transform ${p.has(j)?"rotate-90":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:W.jsx("path",{d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"})})]}),p.has(j)&&W.jsx("div",{className:"pl-6 border-l-2 border-gray-200 ml-2",children:C[j].map(B=>W.jsxs("div",{className:"flex items-center justify-between p-2 my-1 rounded-md hover:bg-gray-50",children:[W.jsx("div",{className:"text-sm font-medium text-gray-800",children:B.name}),W.jsxs("div",{className:"flex space-x-2",children:[W.jsx("button",{onClick:()=>E(B),className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded-md hover:bg-blue-200",children:"Load"}),!R&&W.jsx("button",{onClick:()=>x(B),className:"p-1 text-gray-400 hover:text-gray-600 rounded hover:bg-gray-200",title:"Edit template",children:W.jsx("svg",{className:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"})})})]})]},B.id))})]},j))}),W.jsxs("div",{className:`flex ${R||!u?.trim()?"justify-end":"justify-between"} mt-4`,children:[!R&&u?.trim()&&W.jsx("button",{onClick:()=>{b(null),w(U),N(r||"Unknown"),g(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Save"}),W.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Close"})]})]})}),f&&W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-60",children:W.jsx("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:G?W.jsxs(W.Fragment,{children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Overwrite Template?"}),W.jsxs("p",{className:"text-sm text-gray-600",children:['A template named "',W.jsx("span",{className:"font-medium",children:G.name}),'" already exists. Do you want to replace it with your current email?']}),W.jsxs("div",{className:"flex justify-end gap-2 mt-5",children:[W.jsx("button",{onClick:()=>P(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"}),W.jsx("button",{onClick:()=>A(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Overwrite"})]})]}):W.jsxs(W.Fragment,{children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:y?"Edit Template":"Save Template"}),W.jsxs("div",{className:"space-y-4",children:[W.jsxs("div",{children:[W.jsx("label",{htmlFor:"template-name",className:"block text-sm font-medium text-gray-700",children:"Template Name"}),W.jsx("input",{type:"text",id:"template-name",value:v,onChange:j=>w(j.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"e.g., Mid-term Check-in"})]}),W.jsxs("div",{children:[W.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Author"}),I?W.jsx("input",{type:"text",value:S,onChange:j=>N(j.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"Enter author name"}):W.jsx("div",{className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 text-gray-700",children:r||"Unknown"})]})]}),W.jsx("p",{className:"text-xs mt-2 h-4 text-center text-red-600",children:D}),W.jsxs("div",{className:"flex justify-between items-center mt-4",children:[y&&W.jsx("button",{onClick:()=>k(y),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"}),W.jsxs("div",{className:"flex gap-2 ml-auto",children:[W.jsx("button",{onClick:()=>{g(!1),F(""),P(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"}),W.jsx("button",{onClick:()=>A(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Save"})]})]})]})})})]})}function $U({isOpen:n,onClose:e,customParameters:t,onSave:r}){const[o,s]=jt.useState(!1),[a,u]=jt.useState(null),[l,i]=jt.useState(""),[c,p]=jt.useState(""),[h,f]=jt.useState([]),[g,y]=jt.useState(""),[b,v]=jt.useState(null),w=jt.useRef([]);jt.useEffect(()=>{n||S()},[n]);const S=()=>{u(null),i(""),p(""),f([]),y(""),v(null),w.current=[]},N=R=>{if(b===null||!w.current[b])return;const I=w.current[b].getEditor(),T=I.getSelection(!0);I.insertText(T?T.index:I.getLength(),R,"user"),I.setSelection((T?T.index:I.getLength())+R.length)},D=R=>{u(R),i(R.name),p(R.sourceColumn),f(R.mappings||[]),s(!1)},F=()=>{f([...h,{if:"",operator:"eq",then:""}])},G=R=>{f(h.filter((I,T)=>T!==R))},P=(R,I,T)=>{const L=[...h];L[R][I]=T,f(L)},U=async()=>{if(!/^[a-zA-Z0-9_]+$/.test(l)){y("Parameter Name can only contain letters, numbers, and underscores.");return}const R={name:l,sourceColumn:c,mappings:h.filter(L=>L.if)};let I=[...t];if(a&&a.name!==l){if(I.some(L=>L.name===l)){y("A parameter with this name already exists.");return}I=I.filter(L=>L.name!==a.name)}else if(!a&&I.some(L=>L.name===l)){y("A parameter with this name already exists.");return}const T=I.findIndex(L=>L.name===l);T>-1?I[T]=R:I.push(R),await r(I),y("Parameter saved!"),setTimeout(()=>{y(""),s(!0)},1e3)},q=async R=>{const I=t.filter(T=>T.name!==R);await r(I)};return n?o?W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4",children:W.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-3xl my-8",children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Manage Custom Parameters"}),W.jsx("div",{className:"max-h-96 overflow-y-auto border-t border-b py-2",children:t.length===0?W.jsx("p",{className:"text-center text-gray-500 text-sm",children:"No custom parameters created yet."}):t.map(R=>W.jsxs("div",{className:"flex items-center justify-between p-2 my-1 rounded-md hover:bg-gray-50",children:[W.jsxs("div",{children:[W.jsx("span",{className:"text-sm font-medium text-gray-800",children:`{${R.name}}`}),W.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(from: ",R.sourceColumn,")"]})]}),W.jsxs("div",{className:"flex space-x-2",children:[W.jsx("button",{onClick:()=>D(R),className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded-md hover:bg-blue-200",children:"Edit"}),W.jsx("button",{onClick:()=>q(R.name),className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-semibold rounded-md hover:bg-red-200",children:"Delete"})]})]},R.name))}),W.jsx("div",{className:"flex justify-end mt-4",children:W.jsx("button",{onClick:()=>{s(!1),e()},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Close"})})]})}):W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-start justify-center z-50 overflow-y-auto p-4",children:W.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-2xl my-8 max-h-[calc(100vh-4rem)] overflow-y-auto",children:[W.jsxs("div",{className:"flex justify-between items-center mb-4",children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:a?"Edit Custom Parameter":"Create Custom Parameter"}),W.jsx("button",{onClick:()=>s(!0),className:"text-xs text-blue-600 hover:underline",children:"Manage Parameters"})]}),W.jsxs("div",{className:"space-y-4",children:[W.jsxs("div",{children:[W.jsx("label",{htmlFor:"param-name",className:"block text-sm font-medium text-gray-700",children:"Parameter Name"}),W.jsx("input",{type:"text",id:"param-name",value:l,onChange:R=>i(R.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"e.g., AdvisorEmail"}),W.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["No spaces or special characters. It will be used like ","{YourName}","."]})]}),W.jsxs("div",{children:[W.jsx("label",{htmlFor:"param-source-column",className:"block text-sm font-medium text-gray-700",children:"Source Column"}),W.jsx("input",{type:"text",id:"param-source-column",value:c,onChange:R=>p(R.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"e.g., Status"}),W.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The column in your sheet that this parameter will read from."})]}),W.jsxs("div",{className:"border-t pt-4",children:[W.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Value Mappings (Optional)"}),W.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Transform the value from the source column. If a cell's value matches a condition, the parameter will be replaced by the corresponding 'then' value. If no conditions match, the parameter will be left blank."}),W.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto pr-1",children:h.map((R,I)=>W.jsxs("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:[W.jsxs("div",{className:"flex items-center justify-between mb-2",children:[W.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["Mapping ",I+1]}),W.jsx("button",{onClick:()=>G(I),className:"text-red-500 hover:text-red-700 text-xl leading-none",children:""})]}),W.jsxs("div",{className:"space-y-2",children:[W.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[W.jsx("span",{className:"text-sm text-gray-700",children:"If cell"}),W.jsx("select",{value:R.operator,onChange:T=>P(I,"operator",T.target.value),className:"flex-shrink-0 px-2 py-1 border border-gray-300 rounded-md text-sm bg-white",children:cF.map(T=>W.jsx("option",{value:T.value,children:T.text},T.value))}),W.jsx("input",{type:"text",value:R.if,onChange:T=>P(I,"if",T.target.value),className:"flex-1 min-w-[120px] px-2 py-1 border border-gray-300 rounded-md text-sm bg-white",placeholder:"Value..."})]}),W.jsxs("div",{className:"mt-2",children:[W.jsx("span",{className:"text-sm text-gray-700 block mb-1",children:"Then use"}),W.jsx("div",{className:"mapping-quill-editor",children:W.jsx(fd,{ref:T=>{w.current[I]=T},theme:"snow",value:R.then,onChange:T=>P(I,"then",T),onFocus:()=>v(I),modules:uF.modules,placeholder:"Result (with formatting)...",className:"bg-white rounded-md"})}),W.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Tip: Use parameter buttons below to insert nested parameters"})]})]})]},I))}),W.jsx("button",{onClick:F,className:"mt-2 text-xs text-blue-600 hover:underline",children:"+ Add Mapping"}),h.length>0&&W.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-md",children:[W.jsxs("p",{className:"text-xs font-medium text-gray-600 mb-2",children:["Insert Parameter ",b!==null?`(into Mapping ${b+1})`:"(click in a result box first)",":"]}),W.jsxs("div",{className:"flex flex-wrap gap-1",children:[A8.map(R=>W.jsx("button",{onClick:()=>N(`{${R}}`),disabled:b===null,className:`px-2 py-1 text-xs rounded ${b===null?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:`{${R}}`},R)),df.map(R=>W.jsx("button",{onClick:()=>N(`{${R}}`),disabled:b===null,className:`px-2 py-1 text-xs rounded ${b===null?"bg-orange-50 text-orange-300 cursor-not-allowed":"bg-orange-100 text-orange-800 hover:bg-orange-200"}`,children:`{${R}}`},R)),t.filter(R=>R.name!==l).map(R=>W.jsx("button",{onClick:()=>N(`{${R.name}}`),disabled:b===null,className:`px-2 py-1 text-xs rounded ${b===null?"bg-blue-50 text-blue-300 cursor-not-allowed":"bg-blue-100 text-blue-800 hover:bg-blue-200"}`,children:`{${R.name}}`},R.name))]})]})]})]}),W.jsx("p",{className:"text-xs mt-2 h-4 text-center text-red-600",children:g}),W.jsxs("div",{className:"flex justify-end gap-2 mt-6 border-t pt-4",children:[W.jsx("button",{onClick:e,className:"px-3 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 text-sm whitespace-nowrap",children:"Cancel"}),W.jsx("button",{onClick:U,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm whitespace-nowrap",children:"Save"})]})]})}):null}function VU({isOpen:n,onClose:e,currentSelection:t,onConfirm:r,getStudentDataCore:o,recipientDataCache:s}){const[a,u]=jt.useState(t),[l,i]=jt.useState(0),[c,p]=jt.useState([]),[h,f]=jt.useState(""),[g,y]=jt.useState(!1),[b,v]=jt.useState(!1),w=jt.useRef(null);jt.useEffect(()=>()=>{w.current&&clearTimeout(w.current)},[]);const S=q=>q.included.length===1&&q.included[0].StudentName?`${q.included[0].StudentName} found.`:`${q.included.length} student${q.included.length!==1?"s":""} found.`,N=async()=>{try{return await window.Excel.run(async R=>{const I=R.workbook.getSelectedRange(),T=R.workbook.worksheets.getActiveWorksheet();I.load(["rowIndex","rowCount"]),T.load("name"),await R.sync();const L=[];for(let E=0;E<I.rowCount;E++)L.push(I.rowIndex+E);return{sheetName:T.name,selectedRows:L}})}catch(q){return console.error("Failed to capture row selection:",q),null}};jt.useEffect(()=>{n&&(async()=>{let R=t;if(R.type==="selection"){const I=await N();I&&(R={...R,selectionSheetName:I.sheetName,selectedRows:I.selectedRows})}u(R),D(R)})()},[n,t]);const D=async(q=a)=>{f("Counting students..."),y(!0),p([]);const{type:R,excludeDNC:I,excludeFillColor:T}=q;if(R!=="custom"&&I&&T&&s.has(R)){const L=s.get(R);i(L.included.length),p(L.excluded),f(S(L)),y(!1);return}try{const L=await o(q,!0,[],E=>{f(`Counting students... ${E}%`)});i(L.included.length),p(L.excluded),f(S(L)),y(!1)}catch(L){i(0),p([]),f(L.userFacingMessage||(L.userFacing?L.message:"An error occurred.")),y(!1)}},F=async(q,R)=>{let I={...a,[q]:R};if(q==="type"&&R==="selection"){const T=await N();T&&(I={...I,selectionSheetName:T.sheetName,selectedRows:T.selectedRows})}u(I),q==="customSheetName"?(w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{P(I)},500)):setTimeout(()=>{P(I)},100)},G=async()=>{const q=await N();if(q){const R={...a,selectionSheetName:q.sheetName,selectedRows:q.selectedRows};u(R),P(R)}},P=async q=>{f("Counting students..."),y(!0),p([]);try{const R=await o(q,!0,[],I=>{f(`Counting students... ${I}%`)});i(R.included.length),p(R.excluded),f(S(R)),y(!1)}catch(R){i(0),p([]),f(R.userFacingMessage||(R.userFacing?R.message:"An error occurred.")),y(!1)}},U=()=>{r(a,l),e()};return n?W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50",onClick:e,children:W.jsx("div",{className:"bg-white rounded-lg shadow-xl p-4 w-full max-w-sm",onClick:q=>q.stopPropagation(),children:b?W.jsxs(W.Fragment,{children:[W.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[W.jsx("button",{onClick:()=>v(!1),className:"p-1 rounded-md hover:bg-gray-100 text-gray-500 hover:text-gray-700",title:"Back to Select Recipients",children:W.jsx("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),W.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Exclusions"})]}),W.jsxs("div",{className:"space-y-2",children:[W.jsx("div",{className:"bg-gray-50 p-2.5 rounded-md",children:W.jsxs("label",{htmlFor:"exclude-dnc-toggle",className:"flex items-center justify-between cursor-pointer",children:[W.jsx("span",{className:"text-sm text-gray-700 flex-grow pr-4",children:"DNC-tagged students"}),W.jsxs("div",{className:"relative inline-flex items-center flex-shrink-0",children:[W.jsx("input",{type:"checkbox",id:"exclude-dnc-toggle",checked:a.excludeDNC,onChange:q=>F("excludeDNC",q.target.checked),className:"sr-only peer"}),W.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),W.jsx("div",{className:"bg-gray-50 p-2.5 rounded-md",children:W.jsxs("label",{htmlFor:"exclude-fill-color-toggle",className:"flex items-center justify-between cursor-pointer",children:[W.jsx("span",{className:"text-sm text-gray-700 flex-grow pr-4",children:"Outreach Color Filled students"}),W.jsxs("div",{className:"relative inline-flex items-center flex-shrink-0",children:[W.jsx("input",{type:"checkbox",id:"exclude-fill-color-toggle",checked:a.excludeFillColor,onChange:q=>F("excludeFillColor",q.target.checked),className:"sr-only peer"}),W.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})})]}),c.length>0&&W.jsxs("div",{className:"mt-3 border-t pt-2",children:[W.jsxs("p",{className:"text-xs font-medium text-gray-500 mb-2",children:[c.length," student",c.length!==1?"s":""," excluded"]}),W.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-200 rounded-md",children:W.jsx("ul",{className:"divide-y divide-gray-200",children:c.map((q,R)=>W.jsxs("li",{className:"px-3 py-1.5 flex justify-between items-center",children:[W.jsx("span",{className:"text-sm text-gray-700 truncate pr-2",title:q.name,children:q.name}),W.jsx("span",{className:"flex-shrink-0 px-2 py-0.5 rounded-full text-xs",style:q.reason==="DNC Tag"?{backgroundColor:"#FEE2E2",color:"#991B1B"}:q.reason==="Fill Color"&&q.color?{backgroundColor:q.color,color:"#374151"}:{backgroundColor:"#E5E7EB",color:"#4B5563"},children:q.reason})]},R))})})]}),c.length===0&&(a.excludeDNC||a.excludeFillColor)&&W.jsx("div",{className:"mt-3 border-t pt-2",children:W.jsx("p",{className:"text-xs text-gray-400 text-center",children:"No students excluded"})})]}):W.jsxs(W.Fragment,{children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Select Recipients"}),W.jsxs("div",{className:"space-y-3",children:[W.jsxs("div",{children:[W.jsx("label",{htmlFor:"recipient-source",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select students from:"}),W.jsxs("select",{id:"recipient-source",value:a.type,onChange:q=>F("type",q.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500",children:[W.jsx("option",{value:"lda",children:"Today's LDA Sheet"}),W.jsx("option",{value:"master",children:"Master List"}),W.jsx("option",{value:"custom",children:"Custom Sheet"}),W.jsx("option",{value:"selection",children:"Row Selection"})]})]}),a.type==="selection"&&W.jsxs("div",{className:"flex items-center justify-between",children:[a.selectedRows&&W.jsxs("p",{className:"text-xs text-gray-500",children:[a.selectedRows.length," row",a.selectedRows.length!==1?"s":"",' selected from "',a.selectionSheetName,'"']}),W.jsxs("button",{onClick:G,className:"flex items-center gap-1 px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",title:"Re-check selected rows in Excel",children:[W.jsx("svg",{className:"h-3 w-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182"})}),"Recheck"]})]}),a.type==="custom"&&W.jsxs("div",{children:[W.jsx("label",{htmlFor:"recipient-custom-sheet-name",className:"block text-xs font-medium text-gray-600",children:"Custom Sheet Name"}),W.jsx("input",{type:"text",id:"recipient-custom-sheet-name",value:a.customSheetName,onChange:q=>F("customSheetName",q.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm",placeholder:"Enter the exact sheet name"})]})]}),W.jsx("div",{className:"mt-3 border-t pt-3",children:W.jsxs("button",{onClick:()=>v(!0),className:"w-full flex items-center justify-between px-3 py-2 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors",children:[W.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Exclusions"}),W.jsxs("div",{className:"flex items-center gap-2",children:[c.length>0&&W.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium bg-red-100 text-red-700 rounded-full",children:[c.length," excluded"]}),W.jsx("svg",{className:"h-4 w-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]})]})}),W.jsx("div",{className:"mt-4 h-8 flex items-center justify-center",children:W.jsx("p",{className:"text-sm text-gray-600",children:h})}),W.jsxs("div",{className:"flex justify-end gap-2 mt-3 border-t pt-3",children:[W.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"}),W.jsx("button",{onClick:U,disabled:g,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm"})]})]})})}):null}function WU({isOpen:n,onClose:e,onConfirm:t,count:r}){return n?W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50",children:W.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[W.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Confirm Send"}),W.jsxs("p",{className:"text-sm text-gray-600",children:["You are about to send ",r," ",r===1?"email":"emails",". Do you want to proceed?"]}),W.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[W.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"}),W.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Confirm & Send"})]})]})}):null}function GU({isOpen:n,onClose:e,count:t,payload:r,bodyTemplate:o,initiator:s}){if(!n)return null;const a=()=>{const u=r?.emails||r;pb(u,o,s||{})};return W.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50",children:W.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md text-center",children:[W.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:W.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),W.jsx("h3",{className:"text-lg font-semibold text-gray-800 mt-4",children:"Emails Sent Successfully!"}),W.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Your batch of ",t," ",t===1?"email":"emails"," has been successfully sent to Power Automate."]}),W.jsxs("div",{className:"mt-6 flex flex-col space-y-2",children:[W.jsx("button",{onClick:a,className:"w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700",children:"Download PDF Receipt"}),W.jsx("button",{onClick:e,className:"w-full bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300",children:"Close"})]})]})})}function YU({user:n,accessToken:e,onReady:t}){const[r,o]=jt.useState(null),[s,a]=jt.useState(!1),[u,l]=jt.useState(""),[i,c]=jt.useState(""),[p,h]=jt.useState(null),[f,g]=jt.useState(""),[y,b]=jt.useState(e),[v,w]=jt.useState(null),[S,N]=jt.useState([]),[D,F]=jt.useState([]),[G,P]=jt.useState(""),[U,q]=jt.useState(""),[R,I]=jt.useState(""),[T,L]=jt.useState([]),[E,x]=jt.useState([]),[k,A]=jt.useState({type:"lda",customSheetName:"",excludeDNC:!0,excludeFillColor:!0,hasBeenSet:!1}),[C,j]=jt.useState(0),[B,O]=jt.useState(new Map),[H,X]=jt.useState({}),[et,V]=jt.useState(null),[tt,$]=jt.useState(!1),[z,Z]=jt.useState(!1),[it,mt]=jt.useState(!0),[lt,at]=jt.useState(!1),[rt,ct]=jt.useState(!1),ot=jt.useRef(null),dt=jt.useRef(null),ft=jt.useRef(null),gt=jt.useRef(null),[wt,yt]=jt.useState(!1),[Et,Mt]=jt.useState(!1),[qt,Tt]=jt.useState(!1),[It,Vt]=jt.useState(!1),[Kt,ne]=jt.useState(!1),[ae,Oe]=jt.useState(!1),[le,Jt]=jt.useState([]),[ue,ge]=jt.useState(()=>{try{const Qt=localStorage.getItem("lastEmailSent");return Qt?JSON.parse(Qt):null}catch{return null}}),[fe,qe]=jt.useState(null);jt.useEffect(()=>{(async()=>{try{const de=localStorage.getItem("SSO_USER_INFO");if(de){const Ee=JSON.parse(de);g((Ee.email||"").toLowerCase())}}catch(de){console.error("Error loading user email:",de)}await Promise.all([Be(),ke(),Je()]),t&&t()})()},[t]),jt.useEffect(()=>{(async()=>{try{if(typeof Office<"u"&&Office.auth){console.log("Fetching fresh authentication token...");const de=await Office.auth.getAccessToken({allowSignInPrompt:!1,forMSGraphAccess:!0});b(de),console.log("Fresh authentication token obtained")}else console.log("Office.auth not available, using prop token"),b(e)}catch(de){console.error("Failed to get fresh token:",de),b(e)}})()},[]),jt.useEffect(()=>{y&&(async()=>{if(p!==null){if(p!=="individual"){w("granted");return}if(y){w("checking");try{const de=await fetch("https://student-retention-token-exchange-dnfdg0hxhsa3gjb4.canadacentral-01.azurewebsites.net/api/exchange-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:y})}),Ee=await de.json();if(de.ok)console.log("Consent already granted"),w("granted");else{const Pe=Ee.error||Ee.details||"";Pe.includes("AADSTS65001")||Pe.includes("AADSTS70011")||Pe.includes("consent")?(console.log("Consent required for Graph API access"),w("required")):(console.warn("Token exchange check failed:",Pe),w("required"))}}catch(de){console.error("Failed to check consent status:",de),w("required")}}}})()},[p,y]),jt.useEffect(()=>{const Qt=de=>{lt&&ft.current&&!ft.current.parentElement.contains(de.target)&&at(!1)};return document.addEventListener("mousedown",Qt),()=>document.removeEventListener("mousedown",Qt)},[lt]),jt.useEffect(()=>{if(ot.current){const Qt=ot.current.getEditor(),de=()=>{const Ee=Qt.getText(),Pe=/\{([a-zA-Z0-9_]+)\}/g;let _t;const Bt=[];for(;(_t=Pe.exec(Ee))!==null;)Bt.push({start:_t.index,length:_t[0].length,name:_t[1]});Bt.forEach(Ne=>{const ye=Dt(Ne.name),xe=Qt.getFormat(Ne.start,Ne.length);(xe.background!==ye.background||xe.color!==ye.color)&&Qt.formatText(Ne.start,Ne.length,{background:ye.background,color:ye.color},"silent")}),Qt.getText();const Gt=Qt.getContents();let pe=0;Gt.ops.forEach(Ne=>{if(Ne.insert&&typeof Ne.insert=="string"){const ye=Ne.insert;Ne.attributes&&(Ne.attributes.background||Ne.attributes.color)&&(/\{[a-zA-Z0-9_]+\}/.test(ye)||Qt.formatText(pe,ye.length,{background:!1,color:!1},"silent")),pe+=ye.length}})};return Qt.on("text-change",de),()=>{Qt.off("text-change",de)}}},[E]),jt.useEffect(()=>{s&&Xe()},[s]),jt.useEffect(()=>{f&&S.length===0&&N([f])},[f,S.length]);const Be=async()=>{await Excel.run(async Qt=>{const Ee=Qt.workbook.settings.getItemOrNullObject("connections");Ee.load("value"),await Qt.sync();const _t=(Ee.value?JSON.parse(Ee.value):[]).find(Bt=>Bt.type==="power-automate"&&Bt.name==="Send Personalized Email");_t?(o(_t),a(!0),h("powerautomate")):(a(!1),h("individual"))})},ke=async()=>{const Qt=await Fe();x(Qt)},Je=async()=>{try{const Qt=await Excel.run(async de=>{const Pe=de.workbook.settings.getItemOrNullObject(k8);return Pe.load("value"),await de.sync(),Pe.value?JSON.parse(Pe.value):[]});qe(Qt)}catch(Qt){console.error("Error loading templates:",Qt),qe([])}},Fe=async()=>Excel.run(async Qt=>{const Ee=Qt.workbook.settings.getItemOrNullObject(ux);return Ee.load("value"),await Qt.sync(),Ee.value?JSON.parse(Ee.value):[]}),Me=async Qt=>{await Excel.run(async de=>{de.workbook.settings.add(ux,JSON.stringify(Qt)),await de.sync()}),x(Qt)},Ke=async(Qt,de=!1,Ee=[],Pe=null)=>{const{type:_t,customSheetName:Bt,excludeDNC:Gt,excludeFillColor:pe}=Qt;let Ne,ye=null;if(_t==="selection"){if(Ne=Qt.selectionSheetName,!Ne||!Qt.selectedRows||Qt.selectedRows.length===0){const $e=new Error("No rows selected. Please select rows in Excel first.");throw $e.userFacing=!0,$e}ye=new Set(Qt.selectedRows)}else if(_t==="custom"){if(Ne=Bt.trim(),!Ne){const $e=new Error("Custom sheet name is required.");throw $e.userFacing=!0,$e}}else Ne=_t==="lda"?C8():"Master List";const xe=[],mn=[];X({});try{return await Excel.run(async $e=>{let vn=2;Gt&&vn++,pe&&vn++;let Ze=0;const Tn=()=>{Ze++,Pe&&Pe(Math.round(Ze/vn*100))},Bn=new Set;if(Gt){try{const ar=$e.workbook.worksheets.getItem("Student History").getUsedRange();ar.load("values"),await $e.sync();const tr=ar.values;if(tr.length>1){const Ur=tr[0].map(cr=>String(cr??"").toLowerCase()),Kn=kp(Ur,kh.StudentIdentifier),Zn=kp(Ur,kh.Tags);if((Kn===-1||Zn===-1)&&console.warn("DNC exclusion: Could not find required columns in 'Student History' sheet.",{identifierIndex:Kn,tagsIndex:Zn,historyHeaders:Ur}),Kn!==-1&&Zn!==-1)for(let cr=1;cr<tr.length;cr++){const ri=tr[cr];if(String(ri[Zn]||"").toUpperCase().split(",").map(Hr=>Hr.trim()).some(Hr=>Hr.includes("DNC")&&!["DNC - PHONE","DNC - OTHER PHONE"].includes(Hr))){const Hr=ri[Kn];Hr&&Bn.add(String(Hr))}}}}catch(tn){console.error("Could not process 'Student History' sheet for DNC exclusion.",tn)}Tn()}const In=$e.workbook.worksheets.getItem(Ne),Qe=In.getUsedRangeOrNullObject();if(de?Qe.load("values, rowCount, columnCount, rowIndex, isNullObject"):Qe.load("values, formulas, rowCount, columnCount, rowIndex, isNullObject"),await $e.sync(),Tn(),Qe.isNullObject){const tn=new Error(`Sheet "${Ne}" is empty  no data found.`);throw tn.userFacing=!0,tn}const mr=Qe.values,sr=de?null:Qe.formulas,Dr=mr[0].map(tn=>String(tn??"").toLowerCase());let xi=null;if(pe){const tn=kp(Dr,kh.Outreach);if(tn!==-1){const tr=In.getRangeByIndexes(0,tn,Qe.rowCount,1).getCellProperties({format:{fill:{color:!0}}});await $e.sync(),xi=tr.value}Tn()}const ir={};for(const tn in kh)ir[tn]=kp(Dr,kh[tn]);const yr={};E.forEach(tn=>{const ar=Dr.indexOf(tn.sourceColumn.toLowerCase());ar!==-1&&(yr[tn.name]=ar)});let ur=null;!de&&Ee.includes("MissingAssignmentsList")&&(ur=await pF($e));const Un=Qe.rowIndex||0;for(let tn=1;tn<mr.length;tn++){const ar=mr[tn];if(!ar||ye&&!ye.has(Un+tn))continue;const tr=ar[ir.StudentIdentifier],Ur=ar[ir.StudentName],Kn=ar[ir.StudentEmail]??"";if(!tr&&!Ur&&!Kn)continue;const Zn=Ur||`ID: ${tr||"Unknown"}`;if(!hF(Kn)){mn.push({name:Zn,reason:"Invalid Email"});continue}if(Gt&&ir.StudentIdentifier!==-1&&tr&&Bn.has(String(tr))){mn.push({name:Zn,reason:"DNC Tag"});continue}if(pe&&xi){const or=xi[tn]?.[0]?.format?.fill?.color;if(or&&or!=="#FFFFFF"&&or!=="#000000"){mn.push({name:Zn,reason:"Fill Color",color:or});continue}}const cr=fF(Ur||""),ri={StudentName:Ur||"",FirstName:cr.first,LastName:cr.last,StudentEmail:Kn,PersonalEmail:ar[ir.PersonalEmail]??"",Grade:ar[ir.Grade]??"",DaysOut:ar[ir.DaysOut]??"",Assigned:ar[ir.Assigned]??""};for(const or of E){let Mr="";const Sr=yr[or.name];if(Sr!==void 0){const Hr=ar[Sr]??"";if(!or.mappings||or.mappings.length===0)Mr=Hr;else if(Hr!==""){for(const Br of or.mappings)if(dF(Hr,Br)){Mr=Br.then;break}}}ri[or.name]=Mr}if(!de&&Ee.length>0){for(const or of Ee)if(or==="MissingAssignmentsList"){const Mr=ir.GradeBook;if(Mr!==-1&&ur){const Sr=sr[tn][Mr];let Br=ar[Mr];if(Sr){const hi=String(Sr).match(/=HYPERLINK\("([^"]+)"/i);hi&&(Br=hi[1])}ri.MissingAssignmentsList=ur.get(String(Br??"").trim())||""}else ri.MissingAssignmentsList=""}else if(or==="DaysLeft"){const Mr=parseInt(ri.DaysOut,10)||0,Sr=Math.max(0,14-Mr);ri.DaysLeft=Sr.toString()}else if(or==="Salutation"){const Mr=new Date().getHours();let Sr;Mr<12?Sr="Good Morning":Mr<17?Sr="Good Afternoon":Sr="Good Evening";const Hr=["Dear","Hello","Greetings",Sr];ri.Salutation=Hr[Math.floor(Math.random()*Hr.length)]}}xe.push(ri)}Tn()}),{included:xe,excluded:mn}}catch($e){throw $e.code==="ItemNotFound"?$e.userFacingMessage=`Error: Sheet "${Ne}" not found.`:$e.userFacing?$e.userFacingMessage=$e.message:$e.code==="InvalidArgument"||$e.code==="GeneralException"?$e.userFacingMessage=`Error reading "${Ne}": ${$e.message||"The sheet may be too large or empty."}`:$e.userFacingMessage=`Error: ${$e.message||"An unknown error occurred while reading the sheet."}`,console.error(`[PersonalizedEmail] getStudentDataCore error on sheet "${Ne}":`,$e),$e}},En=async()=>{try{const Qt=df.filter(Ee=>Nn(Ee));Qt.includes("MissingAssignmentsList")?I("Fetching students and missing assignments..."):I("Fetching students...");const de=await Ke(k,!1,Qt);return L(de.included),I(`Found ${de.included.length} students.`),setTimeout(()=>I(""),3e3),de.included}catch(Qt){const de=Qt.userFacingMessage||(Qt.userFacing?Qt.message:"An error occurred while fetching data.");throw I(de),Qt}},Xe=async()=>{try{const de=await Ke({type:"lda",customSheetName:"",excludeDNC:!0,excludeFillColor:!0},!0);O(_t=>new Map(_t).set("lda",de));const Pe=await Ke({type:"master",customSheetName:"",excludeDNC:!0,excludeFillColor:!0},!0);O(_t=>new Map(_t).set("master",Pe))}catch(Qt){console.warn("Pre-caching failed. This may happen if sheets are not yet created.",Qt)}},Sn=(Qt,de)=>{A({...Qt,hasBeenSet:!0}),j(de),mt(!1),L([])},Nn=Qt=>`${S[0]||""} ${D.join(" ")} ${G} ${U}`.includes(`{${Qt}}`),Te=async()=>{T.length===0&&k.hasBeenSet&&await En()},_n=async()=>{await Te(),yt(!0)},Pn=async()=>{if(C===0){dt.current?.scrollIntoView({behavior:"smooth",block:"center"}),Z(!0),setTimeout(()=>Z(!1),2e3);return}await _n()},on=async()=>{await Te(),ne(!0)},Dt=Qt=>{if(df.includes(Qt))return{background:"#fed7aa",color:"#9a3412"};const de=E.find(Ee=>Ee.name===Qt);if(de){const Ee=de.mappings&&de.mappings.length>0;return Ee&&de.mappings.some(_t=>/\{(\w+)\}/.test(_t.then))?{background:"#fecdd3",color:"#881337"}:Ee?{background:"#e9d5ff",color:"#581c87"}:{background:"#bfdbfe",color:"#1e3a8a"}}return{background:"#e5e7eb",color:"#374151"}},Ht=Qt=>{if(et==="quill"&&ot.current){const de=ot.current.getEditor(),Ee=de.getSelection(!0),Pe=Qt.replace(/[{}]/g,""),_t=Dt(Pe);de.insertText(Ee.index,Qt,{background:_t.background,color:_t.color});const Bt=Ee.index+Qt.length;de.insertText(Bt,"",{background:!1,color:!1}),de.setSelection(Bt+1)}else if(et==="from")N([Qt]);else if(et==="cc")F(de=>[...de,Qt]);else if(et==="subject"){const de=document.getElementById("email-subject");if(de){const Ee=de.selectionStart||0,Pe=de.selectionEnd||0,_t=G,Bt=_t.substring(0,Ee)+Qt+_t.substring(Pe);P(Bt),setTimeout(()=>{de.focus(),de.selectionStart=de.selectionEnd=Ee+Qt.length},0)}}else if(ot.current){const de=ot.current.getEditor();de.focus();const Ee=Qt.replace(/[{}]/g,""),Pe=Dt(Ee),_t=de.getLength()-1;de.insertText(_t,Qt,{background:Pe.background,color:Pe.color});const Bt=_t+Qt.length;de.insertText(Bt,"",{background:!1,color:!1}),de.setSelection(Bt+1)}},re=Qt=>{const de=document.createElement("div");return de.innerHTML=Qt,de.querySelectorAll('[style*="background"], [style*="color"]').forEach(Pe=>{const _t=Pe.textContent||"";if(/\{[a-zA-Z0-9_]+\}/.test(_t)){const Gt=(Pe.getAttribute("style")||"").replace(/background-color:\s*[^;]+;?/gi,"").replace(/background:\s*[^;]+;?/gi,"").replace(/color:\s*[^;]+;?/gi,"").trim();Gt?Pe.setAttribute("style",Gt):Pe.removeAttribute("style")}}),de.innerHTML},we=()=>{const Qt=S[0]||"",de=re(U),Ee=T.map(Bt=>({from:Xo(Qt,Bt),to:Bt.StudentEmail||"",cc:E8(D,Bt),subject:Xo(G,Bt),body:Xo(de,Bt)})).filter(Bt=>Bt.to&&Bt.from),Pe=Ee.reduce((Bt,Gt)=>{const pe=Gt.from||"Unknown";return Bt[pe]=(Bt[pe]||0)+1,Bt},{}),_t=Object.entries(Pe).map(([Bt,Gt])=>({email:Bt,count:Gt}));return{byName:n||"",byEmail:f||"",totalCount:Ee.length,senders:_t,emails:Ee}},nn=async()=>{ne(!1);const Qt=we();if(Jt(Qt),Qt.emails.length===0){I('No students with valid "To" and "From" email addresses found.');return}if(!y){I("Authentication token not available. Please log in again.");return}let de=0,Ee=0;const Pe=[];try{I("Getting authentication token...");const _t=await Office.auth.getAccessToken({allowSignInPrompt:!1,forMSGraphAccess:!0});I("Exchanging authentication token...");const Bt=await fetch("https://student-retention-token-exchange-dnfdg0hxhsa3gjb4.canadacentral-01.azurewebsites.net/api/exchange-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:_t})}),Gt=await Bt.json();if(!Bt.ok)throw new Error(`Token exchange failed: ${Gt.error||Gt.details||"Unknown error"}`);const{accessToken:pe}=Gt;await Ie(pe,Qt.emails,I,de,Ee,Pe)}catch(_t){I(`Failed to send emails: ${_t.message}`),console.error("Error sending emails:",_t)}},Ie=async(Qt,de,Ee,Pe,_t,Bt)=>{Ee(`Sending ${de.length} emails...`);for(const Gt of de)try{const pe=Gt.cc?Gt.cc.split(",").map(xe=>xe.trim()).filter(xe=>xe).map(xe=>({emailAddress:{address:xe}})):[],Ne={message:{subject:Gt.subject,body:{contentType:"HTML",content:Gt.body},toRecipients:[{emailAddress:{address:Gt.to}}],ccRecipients:pe},saveToSentItems:!0},ye=await fetch("https://graph.microsoft.com/v1.0/me/sendMail",{method:"POST",headers:{Authorization:`Bearer ${Qt}`,"Content-Type":"application/json"},body:JSON.stringify(Ne)});if(!ye.ok){const xe=await ye.text();throw new Error(`HTTP ${ye.status}: ${xe}`)}Pe++,Ee(`Sent ${Pe} of ${de.length} emails...`)}catch(pe){_t++,Bt.push({to:Gt.to,error:pe.message}),console.error(`Failed to send email to ${Gt.to}:`,pe)}if(_t===0){const Gt={count:Pe,timestamp:new Date().toISOString()};ge(Gt);try{localStorage.setItem("lastEmailSent",JSON.stringify(Gt))}catch{}Ee(`Successfully sent ${Pe} emails!`),Oe(!0)}else Ee(`Sent ${Pe} emails. Failed: ${_t}. Check console for details.`),console.error("Email sending errors:",Bt)},Ue=async()=>{ne(!1),I(`Sending ${T.length} emails...`);const Qt=we();if(Qt.emails.length===0){I('No students with valid "To" and "From" email addresses found.');return}const de={name:n,email:f},Ee=pb(Qt.emails,U,de,!0),Pe={...Qt,receipt:Ee||""};Jt(Pe);try{const _t=await fetch(r.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pe)});if(!_t.ok)throw new Error(`HTTP error! status: ${_t.status}`);const Bt={count:Qt.emails.length,timestamp:new Date().toISOString()};ge(Bt);try{localStorage.setItem("lastEmailSent",JSON.stringify(Bt))}catch{}I(`Successfully sent ${Qt.emails.length} emails!`),Oe(!0)}catch(_t){I(`Failed to send emails: ${_t.message}`),console.error("Error sending emails:",_t)}},He=async()=>{p==="individual"?await nn():p==="powerautomate"?await Ue():I("Invalid sending mode. Please refresh and try again.")},Ge=async()=>{if(at(!1),!(S[0]||"").trim()||!G.trim()||!U.trim()){I("Please fill in From, Subject, and Body to send a test email.");return}if(!f){I("Unable to determine your email address. Please sign in again.");return}await Te();let de;if(T.length>0){const Gt=Math.floor(Math.random()*T.length);de=T[Gt]}else de={StudentEmail:f,FirstName:"Test",LastName:"Student",StudentName:"Test Student"};const Ee=S[0]||"",Pe=re(U),_t=Xo(Ee,de),Bt={byName:n||"",byEmail:f||"",totalCount:1,senders:[{email:_t,count:1}],emails:[{from:_t,to:f,cc:"",subject:`[TEST] ${Xo(G,de)}`,body:Xo(Pe,de)}]};Jt(Bt),I("Sending test email to yourself...");try{if(p==="individual"){const Gt=await Office.auth.getAccessToken({allowSignInPrompt:!1,forMSGraphAccess:!0}),pe=await fetch("https://student-retention-token-exchange-dnfdg0hxhsa3gjb4.canadacentral-01.azurewebsites.net/api/exchange-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:Gt})}),Ne=await pe.json();if(!pe.ok)throw new Error(`Token exchange failed: ${Ne.error||Ne.details||"Unknown error"}`);const{accessToken:ye}=Ne,xe=Bt.emails[0],mn=xe.cc?xe.cc.split(",").map(Ze=>Ze.trim()).filter(Ze=>Ze).map(Ze=>({emailAddress:{address:Ze}})):[],$e={message:{subject:xe.subject,body:{contentType:"HTML",content:xe.body},toRecipients:[{emailAddress:{address:xe.to}}],ccRecipients:mn},saveToSentItems:!0},vn=await fetch("https://graph.microsoft.com/v1.0/me/sendMail",{method:"POST",headers:{Authorization:`Bearer ${ye}`,"Content-Type":"application/json"},body:JSON.stringify($e)});if(!vn.ok){const Ze=await vn.text();throw new Error(`HTTP ${vn.status}: ${Ze}`)}I(`Test email sent to ${f}!`)}else if(p==="powerautomate"){const Gt={name:n,email:f},pe=pb(Bt.emails,U,Gt,!0),Ne={...Bt,receipt:pe||""},ye=await fetch(r.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)});if(!ye.ok)throw new Error(`HTTP error! status: ${ye.status}`);I(`Test email sent to ${f}!`)}else I("Invalid sending mode. Please refresh and try again.")}catch(Gt){I(`Failed to send test email: ${Gt.message}`),console.error("Error sending test email:",Gt)}},Ve=()=>{const Qt=S[0]||"",de=Qt&&Qt.trim()!=="",Ee=G&&G.trim()!=="",Pe=U&&U.trim()!=="",_t=k.hasBeenSet&&C>0;return de&&Ee&&Pe&&_t},an=Qt=>{const de=Date.now()-new Date(Qt).getTime(),Ee=Math.floor(de/6e4);if(Ee<1)return"just now";if(Ee<60)return`${Ee}m ago`;const Pe=Math.floor(Ee/60);if(Pe<24)return`${Pe}h ago`;const _t=Math.floor(Pe/24);return _t<7?`${_t}d ago`:new Date(Qt).toLocaleDateString()},kn=()=>{const Qt=[];return(!S[0]||!S[0].trim())&&Qt.push("From address"),(!k.hasBeenSet||C===0)&&Qt.push("Recipients"),(!G||!G.trim())&&Qt.push("Subject"),(!U||!U.trim())&&Qt.push("Body"),Qt.length>0?`Required: ${Qt.join(", ")}.`:""};jt.useEffect(()=>{const Qt=ft.current,de=gt.current;if(!rt||!Qt||!de)return;const Ee=Qt.getBoundingClientRect(),Pe=de.getBoundingClientRect(),_t=8;let Bt=Ee.top-Pe.height-_t;Bt<_t&&(Bt=Ee.bottom+_t);let Gt=Ee.left+Ee.width/2-Pe.width/2;Gt=Math.max(_t,Math.min(Gt,window.innerWidth-Pe.width-_t)),de.style.top=`${Bt}px`,de.style.left=`${Gt}px`,de.style.visibility="visible"},[rt]);const qn=Qt=>{const de=typeof Qt=="object",Ee=de?Qt.name:Qt;let Pe=Ah.standard;if(df.includes(Ee))Pe=Ah.special;else if(de){const _t=Qt.mappings&&Qt.mappings.length>0;_t&&Qt.mappings.some(Gt=>/\{(\w+)\}/.test(Gt.then))?Pe=Ah.nested:_t?Pe=Ah.mapped:Pe=Ah.custom}return W.jsx("button",{className:Pe,onClick:()=>Ht(`{${Ee}}`),children:`{${Ee}}`},Ee)};return p===null||fe===null?W.jsx("div",{className:"max-w-md mx-auto p-4 bg-gray-50 min-h-screen flex items-center justify-center",children:W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),W.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):v==="checking"?W.jsx("div",{className:"max-w-md mx-auto p-4 bg-gray-50 min-h-screen flex items-center justify-center",children:W.jsxs("div",{className:"text-center",children:[W.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),W.jsx("p",{className:"text-gray-600",children:"Checking permissions..."})]})}):v==="required"?W.jsx("div",{className:"max-w-md mx-auto p-4 bg-gray-50 min-h-screen flex items-center justify-center",children:W.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg",children:[W.jsxs("div",{className:"text-center mb-6",children:[W.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4",children:W.jsx("svg",{className:"h-8 w-8 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:W.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),W.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admin Approval Required"}),W.jsx("p",{className:"text-gray-600 mb-6",children:"This feature requires an IT Administrator to enable it before you can send personalized emails using Microsoft Graph API."})]}),W.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-6",children:[W.jsx("p",{className:"text-sm text-blue-800 mb-2",children:W.jsx("strong",{children:"For IT Administrators:"})}),W.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Click the button below to grant consent for this application. This is a one-time setup that will enable all users in your organization to use this feature."}),W.jsx("a",{href:"https://login.microsoftonline.com/common/adminconsent?client_id=71f37f39-a330-413a-be61-0baa5ce03ea3",target:"_blank",rel:"noopener noreferrer",className:"inline-block w-full text-center px-4 py-2 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition-colors",children:"Grant Admin Consent"})]}),W.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[W.jsx("p",{className:"text-xs text-gray-500 text-center mb-3",children:"After consent is granted, refresh this page to start sending emails."}),W.jsxs("p",{className:"text-xs text-gray-500 text-center",children:[W.jsx("strong",{children:"Alternative:"})," You can configure Power Automate in Settings to send emails without requiring admin approval."]})]})]})}):W.jsxs("div",{className:"max-w-md mx-auto p-4 bg-gray-50",children:[W.jsxs("div",{className:"flex justify-between items-center mb-4",children:[W.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Personalized Email"}),W.jsx("button",{onClick:()=>Mt(!0),className:"px-3 py-1 bg-gray-200 text-gray-800 text-sm font-semibold rounded-md hover:bg-gray-300",children:"Templates"})]}),W.jsxs("div",{className:"space-y-4",children:[W.jsxs("div",{children:[W.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["From ",p==="individual"&&W.jsx("span",{className:"text-xs text-gray-500",children:"(Individual Mode)"})]}),W.jsx(lx,{pills:S,onPillsChange:N,placeholder:"sender@example.com",singleValue:!0,onFocus:()=>V("from"),readOnly:p==="individual",noWrap:!0})]}),W.jsxs("div",{children:[W.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Recipient"}),W.jsx("button",{ref:dt,onClick:()=>Vt(!0),className:`mt-1 w-full text-left px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-500 ${k.hasBeenSet&&C>0?"bg-green-100 text-green-800 font-semibold":"bg-white"} ${z?"ring-2 ring-red-300 bg-red-50":""}`,children:k.hasBeenSet&&C>0?`${C} Student${C!==1?"s":""} Selected`:"Select Students"})]})]}),W.jsxs("div",{className:"relative",children:[it&&ue&&W.jsx("div",{className:"absolute inset-0 z-10 flex items-start justify-center pt-6 cursor-pointer",onClick:()=>mt(!1),children:W.jsxs("p",{className:"text-xs text-gray-500 bg-gray-50 px-3 py-1 rounded-full shadow-sm",children:["Last sent ",ue.count," ",ue.count===1?"email":"emails"," ",an(ue.timestamp)]})}),W.jsxs("div",{className:`transition-all duration-500 ${it?"opacity-40 grayscale blur-[2px]":""}`,onClick:()=>{it&&mt(!1)},children:[W.jsxs("div",{className:"space-y-4 mt-4",children:[W.jsxs("div",{children:[W.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CC"}),W.jsx(lx,{pills:D,onPillsChange:F,placeholder:"Add an additional email",onFocus:()=>V("cc"),noWrap:!0})]}),W.jsxs("div",{children:[W.jsx("label",{htmlFor:"email-subject",className:"block text-sm font-medium text-gray-700",children:"Subject"}),W.jsx("input",{type:"text",id:"email-subject",value:G,onChange:Qt=>P(Qt.target.value),onFocus:()=>V("subject"),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm",placeholder:"Email Subject"})]}),W.jsxs("div",{children:[W.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Body"}),W.jsx(fd,{ref:ot,theme:"snow",value:U,onChange:q,onFocus:()=>V("quill"),modules:lF.modules,className:"mt-1 bg-white",style:{height:"192px",marginBottom:"80px"}})]}),W.jsxs("div",{className:"mt-8",children:[W.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Insert Parameter"}),W.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:A8.map(Qt=>qn(Qt))}),df.length>0&&W.jsxs("div",{className:"mt-3",children:[W.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2",children:"Special Parameters"}),W.jsx("div",{className:"flex flex-wrap gap-2",children:df.map(Qt=>qn(Qt))})]}),E.length>0&&W.jsxs("div",{className:"mt-3",children:[W.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2",children:"Custom Parameters"}),W.jsx("div",{className:"flex flex-wrap gap-2",children:E.slice(0,5).map(Qt=>qn(Qt))}),E.length>5&&W.jsxs(W.Fragment,{children:[tt&&W.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:E.slice(5).map(Qt=>qn(Qt))}),W.jsx("button",{onClick:()=>$(!tt),className:"mt-2 text-xs text-blue-600 hover:underline",children:tt?"Show Less":`Show ${E.length-5} More...`})]})]}),W.jsx("button",{onClick:()=>Tt(!0),className:"mt-2 text-xs text-blue-600 hover:underline",children:"+ Create Custom Parameter"})]})]}),W.jsxs("div",{className:"mt-6 flex space-x-2",children:[W.jsx("button",{onClick:Pn,disabled:C===0,className:`${n==="Guest"?"w-full":"w-1/2"} font-bold py-2 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-opacity-50 transition-colors duration-200 ${C===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-400"}`,children:"Example"}),n!=="Guest"&&W.jsxs("div",{className:"relative w-1/2",children:[W.jsx("button",{ref:ft,onClick:on,onContextMenu:Qt=>{Qt.preventDefault(),at(!0)},onMouseEnter:()=>{Ve()||ct(!0)},onMouseLeave:()=>ct(!1),disabled:!Ve(),className:"w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Send Email"}),!Ve()&&rt&&W.jsx("span",{ref:gt,style:{position:"fixed",visibility:"hidden",zIndex:9999},className:"w-56 bg-gray-800 text-white text-xs rounded-md p-2 text-center pointer-events-none",children:kn()}),lt&&W.jsx("div",{className:"absolute bottom-full left-0 mb-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:W.jsx("button",{onClick:Ge,className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 rounded-lg",children:"Send Test Email to myself"})})]})]}),p==="individual"&&n!=="Guest"&&W.jsx("p",{className:"text-xs text-gray-600 mt-2 text-center",children:"Emails will be sent from your mailbox using Microsoft Graph API"}),p==="powerautomate"&&n!=="Guest"&&W.jsx("p",{className:"text-xs text-gray-600 mt-2 text-center",children:"Emails will be sent via Power Automate"}),W.jsx("p",{className:"text-xs text-gray-500 mt-2 h-4 text-center",children:R})]})]}),W.jsx(UU,{isOpen:wt,onClose:()=>yt(!1),studentData:T,fromTemplate:S[0]||"",ccRecipients:D,subjectTemplate:G,bodyTemplate:U}),W.jsx(HU,{isOpen:Et,onClose:()=>Mt(!1),user:n,userEmail:f,currentFrom:S[0]||"",currentSubject:G,currentBody:U,currentCC:D,templates:fe,onTemplatesChange:qe,onLoadTemplate:Qt=>{N([Qt.from]),P(Qt.subject),q(Qt.body),F(Qt.cc||[]),mt(!1)}}),W.jsx($U,{isOpen:qt,onClose:()=>Tt(!1),customParameters:E,onSave:Me}),W.jsx(VU,{isOpen:It,onClose:()=>Vt(!1),currentSelection:k,onConfirm:Sn,getStudentDataCore:Ke,recipientDataCache:B}),W.jsx(WU,{isOpen:Kt,onClose:()=>ne(!1),onConfirm:He,count:T.length}),W.jsx(GU,{isOpen:ae,onClose:()=>Oe(!1),count:le?.emails?.length||0,payload:le,bodyTemplate:U,initiator:{name:n,email:f}})]})}const af={container:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"#ffffff",zIndex:9999,padding:20},card:{background:"#fff",borderRadius:10,padding:"28px 28px",maxWidth:720,width:"100%",boxShadow:"0 8px 30px rgba(0,0,0,0.12)",border:"1px solid #eee"},header:{margin:0,fontSize:24,fontWeight:600,color:"#222"},sub:{marginTop:8,marginBottom:16,color:"#555"},buttonRow:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:8},primaryButton:{background:"#0b5cff",color:"#fff",border:"none",padding:"8px 14px",borderRadius:6,cursor:"pointer"}};function XU({onClose:n=()=>{},user:e=""}){return W.jsx("div",{style:af.container,role:"dialog","aria-modal":"true","aria-label":"Welcome",children:W.jsxs("div",{style:af.card,children:[W.jsx("h2",{style:af.header,children:e?`Welcome, ${e}!`:"Welcome!"}),W.jsx("p",{style:af.sub,children:"Thank you for using the Student Retention Kit."}),W.jsx("div",{style:af.buttonRow,children:W.jsx("button",{type:"button",style:af.primaryButton,onClick:()=>n(),children:"Continue"})})]})})}const KU=jt.lazy(()=>Mh(()=>import("./SSO-OkFHl9PF.js"),[]));function fg(){const[n,e]=jt.useState(null),[t,r]=jt.useState(!0),[o,s]=jt.useState(null),[a,u]=jt.useState(null),[l,i]=jt.useState(!1),c=jt.useRef(!1);jt.useEffect(()=>{(()=>{try{const b=localStorage.getItem("SSO_USER");b?(console.log("App: Auto-logged in as",b),s(b)):(console.log("App: No session found. Showing Login."),r(!1))}catch(b){console.warn("Auth check failed",b),r(!1)}})()},[]),jt.useEffect(()=>{const v=new URLSearchParams(window.location.search).get("page")||"student-view";if(e(v),localStorage.getItem("SRK_HAS_SEEN_WELCOME")||i(!0),o){const S=setTimeout(()=>{!c.current&&t&&(console.warn("Feature took too long. Forcing load."),r(!1))},8e3);return()=>clearTimeout(S)}},[o,t]);const p=()=>{c.current||(c.current=!0,r(!1))},h=(y,b=null)=>{console.log("App: Login Successful ->",y),s(y),u(b),r(!0),c.current=!1,localStorage.setItem("SSO_USER",y)},f=()=>{i(!1),localStorage.setItem("SRK_HAS_SEEN_WELCOME","true")};jt.useEffect(()=>{console.log("App: Initializing Chrome Extension Service (Master Relay)"),Tl.startPinging(),Tl.startKeepAlive();const y=Tl.addListener(b=>{b.type==="installed"&&console.log("App: Chrome Extension is installed and ready!")});return()=>{console.log("App: Cleaning up Chrome Extension Service"),y(),Tl.stopPinging(),Tl.stopKeepAlive()}},[]);const g=()=>{if(!o)return W.jsx(jt.Suspense,{fallback:W.jsx("div",{className:"p-10 text-center",children:"Loading Login..."}),children:W.jsx(KU,{onNameSelect:h})});switch(n){case"settings":return W.jsx(MM,{user:o,accessToken:a,onReady:p});case"import":return W.jsx(tL,{user:o,onReady:p});case"about":return W.jsx(xM,{onReady:p});case"create-lda":return W.jsx(sL,{user:o,onReady:p});case"personalized-email":return W.jsx(YU,{user:o,accessToken:a,onReady:p});case"student-view":default:return W.jsx(c4,{user:o,onReady:p})}};return W.jsxs(W.Fragment,{children:[W.jsx("div",{style:{position:"fixed",inset:0,zIndex:9999,backgroundColor:"#f9fafb",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 0.7s ease-out",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:W.jsxs("div",{className:"flex flex-col items-center gap-4",children:[W.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-blue-600"}),W.jsx("span",{className:"text-gray-500 font-medium text-sm animate-pulse",children:o?"Loading your dashboard...":"Preparing..."})]})}),g(),!t&&o&&l&&W.jsx(XU,{onClose:f,user:o}),W.jsx(Qk,{position:"bottom-left",pauseOnFocusLoss:!1,transition:Kk,limit:3})]})}const ZU={position:"fixed",top:0,right:0,height:"100vh",width:"360px",background:"#fff",boxShadow:"-2px 0 8px rgba(0,0,0,0.15)",zIndex:1e3,transition:"transform 0.3s cubic-bezier(.4,0,.2,1)",display:"flex",flexDirection:"column"},QU={background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#666"};function JU({open:n,onClose:e,header:t,children:r,height:o="100vh"}){const[s,a]=jt.useState(360),u=jt.useRef(!1),l=jt.useRef(0),i=jt.useRef(360),c=f=>{u.current=!0,l.current=f.clientX,i.current=s,document.addEventListener("mousemove",p),document.addEventListener("mouseup",h),f.preventDefault()},p=f=>{if(!u.current)return;const g=l.current-f.clientX;let y=i.current+g;y<240&&(y=240),y>700&&(y=700),a(y)},h=()=>{u.current=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",h)};return W.jsxs("div",{style:{...ZU,width:s+"px",height:o,transform:n?"translateX(0)":"translateX(100%)",pointerEvents:n?"auto":"none",userSelect:u.current?"none":"auto"},"aria-hidden":!n,children:[W.jsx("div",{style:{position:"absolute",left:0,top:0,width:"6px",height:"100%",cursor:"ew-resize",zIndex:1001},onMouseDown:c,title:"Resize"}),W.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 12px",borderBottom:"1px solid #eee",background:"#f3f3f3",minHeight:"40px"},children:[W.jsx("div",{style:{fontWeight:"bold"},children:t}),W.jsx("button",{style:QU,onClick:e,"aria-label":"Close taskpane",children:""})]}),W.jsx("div",{style:{flex:1,overflowY:"auto",padding:"16px",paddingTop:0},children:r})]})}const tH="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAADR5JREFUeJzt3QlwVPUdwHF3kyAoYMGAHKKgOJBBAwmEI8ByyX3Gp3WGoVqrI9oy2KK14DWtRxHFW6QiWEVL0WhBMBQhqOuBmjRETpGhjkEiBQIh15LNZrP9/t3/MjtLNnn/t++93aj/mY8wyf7//9/x9u3Lw92cc06CD03THLGId/wtasiiOZGEFAzGEqzDLpyAD4Eo6nAMRXgTDyNDrpck1/65KeFDFiVZFjxdFm09dqCkiWLr9Q0KZEPuQz+5l9jTGe/84zLk0dgKqbgOudiOgyYUvDn7sQ2rMRUdZCw/7mbI04s46jpiBtbgS9TYUPRoymXjV2IcLhAHR7xrZeoIK3xn/BLvoSKORY9GvHa8jSnyWdHyG6EFz+8XasGxGacToNDNOakFXy/Gor3WEl+0ZeHbIA3LtfieZow6qgUvCC5vMc8GLXi6EVcYvXA/9iZAIWP1GUbIZ0PiNkIWv50WvLLYmACFM5u4aBiG1vGu9VlDC55yxAvX9VrwyiLexbLKIUzCufGu+Zkhi98DD+F4AhTJav/FRC0RXqC14OVlHzxhUbINkvi7H14teCUlXtSrUClVw4NaLXg7okH+2dRti1iJn6q7avH6AU4Wf5AW/DHfzMTqZTFFUUvxFQ5owVsT/9aC5+IVWIoHteCVytNYpQUvH/O14H0j8djPUSYb5pVNNDNWsffFtjchrPhfmFz4Slno1/E3zEFqDHH2x62yYe/KZlab3IjHbG2CLP5AeXSZkYA4VYi7nLu14KlsqEVxi/s947XgbQfxjDqlmXeKEs+EHpY3QQu+4PYxqfgi+SNa8NbEIozRbLjOZo/zME0WTdwHKpfPvljzEafBSyxrgha8zu+Ex2MMVLxAVsrkb7QkWP05iVPUYuzUzLlNImpj/ulIFl9c599swlEv7vG/gAGmBmlwXHPNNU6MwUacgh+BGCzC+WYH2Qa3oSqGwDwowO2mBmfSIK6eeBoH4I0hz70YhmSzAkvGyBiCEkfUCeSKwEwJyqJBfO1xLfJRE0MTdiFNPLtiDUg8PfvgS4OB1OMQ/iqSM6lOlg9ivQpvRz7jc3JyVCxDZxj/aZnJ7bBUceOQBhzGvUjcu4hRBjH3wWpUGMzfi9loZTSAJAxGiYHN63EIS9DB5NrYNoi9G9agXB5QqnX4AJcoPwvEBHSRm6tu6pfFXwjLfjCRz86eUjur9pk1a9blWIYTCBiwAGp3T5mQgt8Y3LAcT8LcS7FgXK1xKTJwE16RxN/T0VXEbsG+HbESlQbqsRdp0Hcw8kAHuuATA5t5sAF9LCiCOCiysQKFOBK2r/j7x1iCTIua0B2bUGugLs/oPiB5YDJ+hXrFTXwogOmXmjNnzkxBBtYi0IQ6rMIVZscg48jBfvibiSPSIQxF888CHpSKDxQ3EAGVYL5FiV+K51GrI5bvRRww/XWBNdviYRxFg2KNlqPp1wIekAQNNYqLn8IzsORan3UnoUghng0YaEUsM2bMaIs34EFAwW70RfQrIr7ZCrmKC9fhI/S2ImEZ12yUKsRUjMkWxpODA/Ar1upeRL9FwTcvwj7FRY9hnlXJyrjmKh5xZfi1hfGIZ8FKVDW2//Tp06N5HY3/YMZEJ+bAq2OhEC+24RKrkhWD9W9BpY54Qkox2+KYRmEn6hXi+gr9cPZpiC+mYIPCYkIZ7rIyURnb9ShRiKsQEyyOyYG/oyZ872nTpjXnAZx9a4bJrbFDYbF6fIkRViYqBntkI19HckItXkGaDXH9HmU64wrJQ0rkQg4MxSGFhSrwqNVJyvg6YC7264irGDkwdhNMLa6e2AxvaP+pU6c2pwRtIhdy4snwRJpZxIf/YJDVSYYGe3XAPBSjPCKeKhyR37sDnWyMay6O6yh8yGFkwxG+SBJyFRbx4FW7kgyLsytm4Flsxy7swCrcjZl2Fl+MKVOmZKIAPgR0egrO8EX6YKfCAtVYbmeiEUl3xRhcixnoGa9YZDwrUaNQvw+QFJrswB0KkxtwGJZe5rWkMXny5KdQhYBOO5AUmuzAcwqTG7APF8Yh0VQMhIZ5EW7DHAzDL2yOS+x/QqGGu5EWmiwasFFhsnDAzgTFmDRpUm8swkZ8g0CEOhzFVsyGbU1gr0wUwtdIXNHMh0NMdmCfwkQ/dtiVnEwwFffguM4Y85Ftc4x58DYWz8SJExuzDGcacEpPYnKiF5vsTI79spAXJZHGHMMNNsf4OeoVYlz/QwPEfxQnnsYam5Nzwa0Qowdz7YxxwoQJH8KHgE7vwyEmOhQmCTVYYXNyLrgVYvTA7gZsQZ1CjJ8ZbUAVltqZ3Pjx411wI6CTB7Y2gP02wqsQYzEcYqJDYZJQiQdtTi7hG3D11VevQy0COu2BQ0x0KEwSKvGwzcm54FaI0QO7G7BesQG7jTagGk/bnNyZBowbN04PD2xtAPttgldnfEIRHGKiAw0KE0Vyq2xOzgW3Yox2NyAfdZGxjB07NppPcaYBtc0lFTaxFm/amRz7ueBuIplIHtjaAPb7GD6FGLf+0ADxH3yvMLEO+TYn12QDxowZE8kDWxvAfkXwNxJLNGvhEBMd+EJhYgN22ZycC26FGOPRgG2o0xPf6NGjhcU404B/KiQnNtliZ3IE6oJbBq6HB7Y1gL2GoBj1OuMrQVZosgN/VkjOh0Jk2pigcgNGjRplWwPY648oR0CnUiSHLzAABxUWOIHf2ZigC26F+OxuwArUKMR3KLIBSfhUYQGx2ct2JegKDjcCOnlgSwPYJwXrUKsQXy6SwhdJwmsKC3jxHto0EZuZSSZsA0aOHDkWe1GPgE6L4AxfxIm7FBbw4wCm2JSkC26F+DywqwFPoFIhtn3oB0f4Ig70xW6FhWqwGpa9Pys0RowY4YIbAZ08sLwB7JGNYtQrxFaAs9/BI76IPIWF/DiIHBsSTcgGDB8+fAHKEFCwGWc3gC8m40XFxSrwuA2JuuBWiMsDSxvA+l2Qh1qFuPy4GWe/VUl8EWNxVGFBHwqQZXGyruzsbDcCOnlgaQNY/2aUokEhrm/RtalF2+NDhQWFCjwLyz7OkbUTqgGs3VfWqa6pOIYNGxZpM6K/T4xJKViuY6FwfnyFqVYlzNouuJuJI5wHljWAte9BmUI8oTrdhOgf28A3nTLZI4qL18rumv7+YBlXwjRg6NChV2A7fAgo2I9uaPpjC3hAO/xDcXGhEi/B9P87mTVdcCvE4oHpDWDN9liNagP1uR/Nv4GcByVhNP6nuEEDvoPpb9gbMmSIC24EdPLA1AawXnssxgmFOEK2oRf0fWiH3GylgY182A5T36PLehl4RyGOIkw0OQYNX8OvWBNxMFwH/Z+gxYOdyMQ30RYePHhwNB68g35mJc9abfFbHG5i33C5uMrE/a/EVtTq3D/cBnSG2kfWMKEVJhvYUKjBWzDtMxtYqxP+pKMJ3+JWnGfSvoNlEWuysrICisoxFcY+P46JHbHLwMZCNd7ClWYUQsbTCbPxEnIjrMXzuA6GP203Yr9+eAcegzVYgwth7GPLmNgadxrcXKjCa+hmRkFkTOejBy6L0AvdYcqRP2jQoP5YhxoEDCiFC8Y/PZHJDlyMFw0GIVTKRIabURirB3G2xjRsiaH4wkLEfqeYRZxIw54YgvGgELb9M6aRMXDgwF54FHtQi4BBYo1uMOf3C7BQMrJlYEaD8qEUy0RwpgRm4iCmvliLk/DHkOd62UhzPy9PNmFUDIGFVCIfN+EiU4M0MDIzMy/DAnyCGgRicByTYPpHpoWCbYuFMQYpePEdcjERln+sQCO5pGIO8nEMPhPymo8LYM2vNhELowv+YkKwDfBgH9biblj2oU9hOWThdryFEnkwGMohIyMj3H3oDGt/rwwbONENj0QEYJQfHpzAVszHYJNjdmC4jLkQx3AaDSbEX41bkGp58cMSCjXhAZOaEOJFGYrwKp7DH6D8L25ijpz7AtZiJyrgMznmRbYWPyxB0YTuWKoa9IABA5rjgwdVOIkibEYB3NiKd7FOykM+PkIh3pNzxNxqnEa9jn1VLUBnxOfXWbGxEz2wxILkwoni1ck/ffLvXtRKXvk18T1/2GOtiucUbkSHuBU/ognd5NFQYHEjEoF4ts1E+/79+yfGb1oVgeA8ZOFzBH6kHkEvtEqY4ocPgkpGbyxGRQIUzCwncQM6IrF/9bkIUAY6HZsSoHixqMT69PT0KWiHxDvqGxsiUKSgO+aiAIEWxIM8zEInmUvLKH74kI1ohd54CAcToLjNEQeLC22R3CILHzlkI1qjP55CcQIUOtK/MB+Xo8X9zhtdg8Sc8hlxBe7Ey9gdx6KXYhtuRdf0lnqqUR3yGZEsm5GGhRAvduIUVWJhwXfJU0x+evC1SbxGnSuO+J9E4RsbshlJ8ugTp6ksPIYtKMROg8Uukb7Ga1iAvnKflJ900ZsasiFOWaAkWbR5eE6ep9/HZ+nB15E98hRWhE+xFW9gsWxkctg6zp8LbnDIpiiJd8x6x/8BBrGABwK6EpAAAAAASUVORK5CYII=",eH="/Student-Retention-Add-in/react/dist/assets/details-icon-BJ3a96Aj.png",nH={display:"flex",flexDirection:"column",background:"#f3f3f3",borderBottom:"1px solid #d4d4d4",fontFamily:"Segoe UI, Arial, sans-serif",fontSize:"14px"},rH={display:"flex",alignItems:"center",height:"36px",padding:"0 8px",borderBottom:"1px solid #e0e0e0",background:"#f8f8f8"},iH=n=>({padding:"0 16px",height:"100%",display:"flex",alignItems:"center",cursor:"pointer",borderBottom:n?"2px solid #217346":"2px solid transparent",color:n?"#217346":"#222",fontWeight:n?"bold":"normal",background:n?"#fff":"transparent",transition:"background 0.2s, border-bottom 0.2s"}),Rp={border:"none",borderRadius:"3px",padding:"6px 10px",margin:"2px 0",cursor:"pointer",fontSize:"13px",minWidth:"40px",transition:"background 0.2s, border 0.2s",background:"#f8f8f8"},O3={background:"#e6f2ec"};function sH({activeTab:n="retention"}){const[e,t]=Ye.useState(null);return W.jsxs("div",{style:nH,children:[W.jsx("div",{style:rH,children:aH.map(r=>W.jsx("div",{style:iH(r.key===n),children:r.label},r.key))}),n==="retention"&&W.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"8px 12px",background:"#fff",minHeight:"48px",gap:"12px"},children:[W.jsxs("button",{style:e==="about"?{...Rp,...O3,display:"flex",alignItems:"center"}:{...Rp,display:"flex",alignItems:"center"},onMouseEnter:()=>t("about"),onMouseLeave:()=>t(null),children:[W.jsx("img",{src:tH,alt:"",style:{width:18,height:18,marginRight:6}}),W.jsx("span",{children:"About"})]}),W.jsxs("button",{style:e==="student"?{...Rp,...O3,display:"flex",alignItems:"center"}:{...Rp,display:"flex",alignItems:"center"},onMouseEnter:()=>t("student"),onMouseLeave:()=>t(null),children:[W.jsx("img",{src:eH,alt:"",style:{width:18,height:18,marginRight:6}}),W.jsx("span",{children:"Student View"})]})]})]})}const aH=[{key:"home",label:"Home"},{key:"insert",label:"Insert"},{key:"draw",label:"Draw"},{key:"data",label:"Data"},{key:"review",label:"Review"},{key:"view",label:"View"},{key:"retention",label:"Retention"}];function hg(n){const e=document.getElementById("root");e?K_.createRoot(e).render(n):document.body.innerHTML='<h1 style="color:red">No #root element found</h1>'}typeof window.Office>"u"?hg(W.jsx(Ye.StrictMode,{children:W.jsx(fg,{})})):Office.onReady(n=>{n.host===Office.HostType.Excel?hg(W.jsx(Ye.StrictMode,{children:W.jsx(fg,{})})):hg(W.jsxs(W.Fragment,{children:[W.jsx(sH,{}),W.jsx(JU,{open:!0,onClose:()=>{},header:W.jsx("div",{children:"Student Retention Add-in"}),children:W.jsx(fg,{})})]}))});const R3=document.getElementById("root");R3?R3.innerHTML=`
    <div style="font-family: Segoe UI, Roboto, Arial, sans-serif; padding: 16px;">
      <h1>Student Retention Settings</h1>
      <p>The app script loaded successfully from ./src/main.jsx</p>
    </div>
  `:console.error("Root element not found");export{Qk as L,Yr as _,Gn as c,Eu as g,W as j,jt as r,jr as y};
