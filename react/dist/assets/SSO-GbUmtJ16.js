import{r,j as e,L as d,y as m}from"./index-CAf_oIca.js";const h=[{name:"Angel Baez",role:"Dean of Academic Affairs",photo:"https://i.natgeofe.com/n/34b9d763-a5ef-434b-8d13-48f4919ca078/green-iguana_thumb_16x9.jpg?w=1200"},{name:"Angel Coronel",role:"Associate Dean of Academic Affairs",photo:"https://play-lh.googleusercontent.com/RHT25lYamggGxosSgW5hUxphFluO4byH-1ZbOuW7nD1AK7QfuqS6ZK_fIoDdb8UIHw"},{name:"Darlen Gutierrez",role:"Student Services Coordinator",photo:"https://i.pinimg.com/736x/28/5e/5e/285e5e923048938dbe93d20d054c0c17.jpg"},{name:"Victor Blanco",role:"Student Services Coordinator",photo:"https://wallpapers.com/images/featured/dolphin-w2b1iptrwaumv8de.jpg"},{name:"Kelvin Saliers",role:"Full Time Instructor",photo:"https://ftccollege.edu/wp-content/uploads/2023/08/mobile_programas_Construction_HVAC_R.jpg"},{name:"Yasser Rojas",role:"Full Time Instructor",photo:"https://assets.streamlinehq.com/image/private/w_512,h_512,ar_1/f_auto/v1/icons/freebies-freemojis/travel-places/travel-places/hospital-4e1hno0dnb9ndwe5yi08v.png?_a=DATAg1AAZAA0"}];function p({onSelect:s,defaultUser:i=null}){const[o,a]=r.useState(i);r.useEffect(()=>{o&&typeof s=="function"&&s(o)},[o,s]);const n=t=>t.split(" ").map(l=>l[0]||"").slice(0,2).join("").toUpperCase();return e.jsxs("div",{className:"relative p-0 flex-1 min-w-0 w-full shadow-xl rounded-lg bg-white overflow-hidden",children:[e.jsx("div",{className:"px-6 py-5 bg-gradient-to-r from-sky-500 via-indigo-500 to-violet-600 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm",children:e.jsxs("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[e.jsx("path",{d:"M12 12c2.761 0 5-2.239 5-5s-2.239-5-5-5-5 2.239-5 5 2.239 5 5 5z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 21c0-2.761-4.03-5-9-5s-9 2.239-9 5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white text-lg font-semibold leading-tight",children:"Select User"}),e.jsx("p",{className:"text-white/85 text-xs mt-0.5",children:"Choose an account to comment as"})]})]})}),e.jsx("div",{className:"p-5",children:e.jsx("div",{id:"user-buttons-container",className:"space-y-3",role:"list",children:h.map((t,l)=>e.jsxs("button",{type:"button",role:"listitem","aria-pressed":o===t.name,className:"relative group overflow-hidden flex items-center gap-3 w-full text-left px-4 py-3 rounded-md transition-shadow duration-200 "+(o===t.name?"bg-blue-50 shadow-sm ring-1 ring-blue-200":"bg-white hover:shadow-lg"),style:{"--delay":`${l*80}ms`},onClick:()=>a(t.name),children:[e.jsx("div",{className:`flex-none w-10 h-10 rounded-full flex items-center justify-center font-semibold text-sm text-white overflow-hidden ${t.photo&&o===t.name?"ring-2 ring-offset-1 ring-blue-400":""}`,style:{background:t.photo?void 0:o===t.name?"linear-gradient(135deg,#2563eb,#7c3aed)":"#e5e7eb"},children:t.photo?e.jsx("img",{src:t.photo,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("span",{style:{color:o===t.name?"#fff":"#374151"},children:n(t.name)})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.role})]}),e.jsx("div",{className:"flex-none w-6 h-6",children:o===t.name?e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:e.jsx("path",{d:"M20 6L9 17l-5-5",stroke:"#2563eb",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round"})}):null}),e.jsx("span",{"aria-hidden":!0,className:"absolute inset-0 rounded-md bg-black opacity-0 transition-opacity duration-200 group-hover:opacity-10 pointer-events-none"})]},t.name))})}),e.jsx("style",{children:`
				#user-buttons-container > button {
					opacity: 0;
					transform: translateY(8px);
					animation: fadeInUp 420ms cubic-bezier(.2,.9,.3,1) both;
					animation-delay: var(--delay, 0ms);
				}
				@keyframes fadeInUp {
					from { opacity: 0; transform: translateY(8px); }
					to   { opacity: 1; transform: translateY(0); }
				}
				/* small responsive tweak */
				@media (max-width: 420px) {
					:root { --container-w: 100%; }
				}
			`})]})}function f(){const[s,i]=r.useState(null),[o,a]=r.useState(null);async function n(){try{if(!window.Office||!Office.auth||!Office.auth.getAccessToken)throw new Error("The identity API is not supported for this add-in.");const t=await Office.auth.getAccessToken({allowSignInPrompt:!0});return i(t),a(null),t}catch(t){return a(`Error code ${t.code}: ${t.message}`),i(null),null}}return{token:s,error:o,getAccessToken:n}}const c="SSO_USER";function x({onNameSelect:s}){const{getAccessToken:i,error:o}=f(),a=n=>{try{typeof window<"u"&&window.localStorage&&localStorage.setItem(c,n)}catch(t){console.warn("Failed to write sso user to localStorage",t)}m.success(`Welcome back ${n}`,{position:"bottom-center"}),s&&s(n)};{const n=typeof window<"u"&&window.localStorage?localStorage.getItem(c):null;return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh]",children:[e.jsx(p,{onSelect:a,defaultUser:n}),e.jsx(d,{})]})}}export{x as default,f as useOfficeSSO};
