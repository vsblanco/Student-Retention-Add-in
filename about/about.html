<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>About - Student Retention Add-in</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #f9fafb;
        }
        .chapter-content h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .chapter-content p, .chapter-content li {
            color: #4b5563;
            line-height: 1.6;
            margin-bottom: 0.75rem;
        }
        .chapter-content ul {
            list-style-type: disc;
            padding-left: 1.5rem;
        }
        .chapter-content code {
            background-color: #f3f4f6;
            color: #4b5563;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-family: monospace;
            font-size: 0.875rem;
        }
        .code-block {
            background-color: #f3f4f6;
            border: 1px solid #e5e7eb;
            padding: 1rem;
            border-radius: 0.5rem;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .table-container {
            overflow-x: auto;
        }
        .table-example {
            width: 100%;
            text-align: left;
            border-collapse: collapse;
        }
        .table-example th, .table-example td {
            padding: 0.75rem;
            border: 1px solid #e5e7eb;
        }
        .table-example th {
            background-color: #dbeafe; /* Light blue */
            color: #1e3a8a; /* Darker blue text */
            font-weight: 600;
        }
        #columns-list code {
            background-color: #e5e7eb; /* Light gray */
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
        }
        /* Styles for collapsible details/summary */
        .collapsible-section summary {
            list-style: none; /* Remove default marker */
            cursor: pointer;
        }
        .collapsible-section summary::-webkit-details-marker {
            display: none; /* Remove default marker for Chrome */
        }
        .collapsible-section summary .chevron {
            transition: transform 0.2s;
        }
        .collapsible-section[open] summary .chevron {
            transform: rotate(90deg);
        }
        .text-highlight {
            color: #9a3412; /* Corresponds to Tailwind's orange-800 */
        }
    </style>
</head>
<body class="p-4">
    <div class="max-w-3xl mx-auto bg-white p-6 rounded-lg shadow-sm">
        <div class="text-center mb-6">
            <h1 class="text-2xl font-bold text-gray-800">About the Student Retention Add-in</h1>
            <p class="text-sm text-gray-500">Version Beta 3.0</p>
        </div>

        <!-- Main Content Area -->
        <div id="main-content">
            <!-- Table of Contents Panel (Visible by default) -->
            <div id="panel-toc" class="p-8">
                <h3 class="text-xl font-semibold text-gray-700 mb-6 text-center">Table of Contents</h3>
                <div class="space-y-6">
                    <!-- Module 1 -->
                    <div>
                        <h4 class="text-lg font-semibold text-blue-800 mb-2">Module 1: Getting Started</h4>
                        <ul class="space-y-2 pl-4">
                            <li><a href="#" class="text-blue-600 hover:underline" data-chapter="1">Creating Your Username</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline" data-chapter="2">Sheet Setup</a></li>
                        </ul>
                    </div>
                    <!-- Module 2 -->
                    <div>
                        <h4 class="text-lg font-semibold text-blue-800 mb-2">Module 2: Features</h4>
                        <ul class="space-y-2 pl-4">
                            <li><a href="#" class="text-blue-600 hover:underline" data-chapter="3">Show Details & Student History</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline" data-chapter="4">Smart Commenting & Tagging</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline" data-chapter="5">Import Data</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline" data-chapter="6">Create LDA Report</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline" data-chapter="7">Mark as Contacted</a></li>
                            <li><a href="#" class="text-blue-600 hover:underline" data-chapter="8">Transfer Data</a></li>
                        </ul>
                    </div>
                    <!-- Module 3 -->
                    <div>
                        <h4 class="text-lg font-semibold text-blue-800 mb-2">Module 3: Settings</h4>
                        <ul class="space-y-2 pl-4">
                             <li><a href="#" class="text-blue-600 hover:underline" data-chapter="9">Settings Pane</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Chapter Panels (Hidden by default) -->
            <div id="chapters-container" class="hidden">
                 <!-- Chapter 1 -->
                <div id="panel-chapter-1" class="chapter-content">
                    <h3>Chapter 1: Creating Your Username</h3>
                    <p>Your username is essential for accountability and clear communication. It's used to automatically sign every comment you add, ensuring that everyone knows who made which note.</p>
                    <p>The first time you open the "Show Details" task pane, a welcome message should appear. If you miss it, or need to add a colleague, you can manually add users at any time in the <strong>Settings</strong> pane by clicking the "+" button in the User Management section. This will open a dialog like the one below:</p>
                    
                    <div class="my-4 p-6 bg-gray-50 border border-gray-200 rounded-lg">
                        <h4 class="text-lg font-semibold text-gray-800 mb-1">Add New User</h4>
                        <p class="text-sm text-gray-500 mb-4">Enter the user's first and last name.</p>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700">First Name:</label>
                                <input type="text" disabled class="mt-1 block w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md shadow-sm cursor-not-allowed">
                            </div>
                             <div>
                                <label class="block text-sm font-medium text-gray-700">Last Name:</label>
                                <input type="text" disabled class="mt-1 block w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md shadow-sm cursor-not-allowed">
                            </div>
                        </div>
                        <div class="mt-5 flex justify-end space-x-3">
                            <button disabled class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm cursor-not-allowed">Cancel</button>
                            <button disabled class="px-4 py-2 text-sm font-medium text-white bg-blue-500 border border-transparent rounded-md shadow-sm cursor-not-allowed">Save User</button>
                        </div>
                    </div>
                </div>
                <!-- Chapter 2 -->
                <div id="panel-chapter-2" class="chapter-content">
                    <h3>Chapter 2: Sheet Setup</h3>
                    <p>The add-in relies on a specific workbook structure to function correctly. You must have two sheets with the exact names and required columns. The column names are flexible, but must match one of the recognized aliases.</p>
                    
                    <div class="my-4">
                        <button id="show-columns-btn" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50">
                            Show All Recognized Columns
                        </button>
                    </div>

                    <div id="columns-list" class="hidden mt-4 p-4 bg-gray-50 border rounded-md">
                        <h4 class="text-md font-semibold text-gray-800 mb-3">Recognized Column Headers</h4>
                        
                        <div class="mb-4">
                            <h5 class="font-semibold text-blue-700">Master List Columns</h5>
                            <div class="pl-2 mt-2 space-y-2">
                                <details class="collapsible-section">
                                    <summary class="flex items-center font-semibold text-red-600"><svg class="chevron w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Required</summary>
                                    <ul class="list-none pl-6 mt-2 space-y-2">
                                        <li><code>StudentNumber</code> (or <code>Student ID</code>, <code>Student Identifier</code>) - The unique ID used to link all student data.</li>
                                    </ul>
                                </details>
                                <details class="collapsible-section">
                                    <summary class="flex items-center font-semibold text-orange-600"><svg class="chevron w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Special</summary>
                                    <ul class="list-none pl-6 mt-2 space-y-2">
                                        <li><code>Grade</code> (or <code>Course Grade</code>) - The task pane display is color-coded based on this value.</li>
                                        <li><code>Days Out</code> (or <code>DaysOut</code>) - Color-coded in the task pane and used as the filter for the LDA Report.</li>
                                        <li><code>Outreach</code> - Typing here automatically logs a comment and can trigger smart LDA tagging.</li>
                                        <li><code>GradeBook</code> (or <code>Gradebook</code>) - If it contains a hyperlink, the grade in the task pane becomes a clickable link.</li>
                                        <li><code>Assigned</code> - The badge in the task pane will match this cell's background color.</li>
                                        <li><code>Phone</code> (or <code>Primary Phone</code>), <code>Other Phone</code> (or <code>Cell Phone</code>) - Selecting these columns can trigger Smart Navigation to the History tab.</li>
                                    </ul>
                                </details>
                                <details class="collapsible-section">
                                    <summary class="flex items-center font-semibold text-gray-600"><svg class="chevron w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Standard</summary>
                                    <ul class="list-none pl-6 mt-2 space-y-2">
                                        <li><code>StudentName</code> (or <code>Student Name</code>), <code>Gender</code>, <code>Status</code>, <code>Last LDA</code>, <code>Student Email</code>, <code>Personal Email</code>.</li>
                                    </ul>
                                </details>
                            </div>
                        </div>

                        <div>
                            <h5 class="font-semibold text-blue-700">Student History Columns</h5>
                            <div class="pl-2 mt-2 space-y-2">
                                <details class="collapsible-section">
                                    <summary class="flex items-center font-semibold text-red-600"><svg class="chevron w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Required</summary>
                                    <ul class="list-none pl-6 mt-2 space-y-2">
                                        <li><code>StudentNumber</code> - Links the comment to the student on the Master List.</li>
                                        <li><code>Comment</code> - The text of the note.</li>
                                        <li><code>Timestamp</code> - The date and time of the entry, used for sorting.</li>
                                    </ul>
                                </details>
                                <details class="collapsible-section">
                                    <summary class="flex items-center font-semibold text-orange-600"><svg class="chevron w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Special</summary>
                                    <ul class="list-none pl-6 mt-2 space-y-2">
                                        <li><code>Tag</code> - Used to categorize comments. An <code>LDA</code> tag with a future date will prioritize the comment at the top of the history list.</li>
                                    </ul>
                                </details>
                                <details class="collapsible-section">
                                    <summary class="flex items-center font-semibold text-gray-600"><svg class="chevron w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Standard</summary>
                                    <ul class="list-none pl-6 mt-2 space-y-2">
                                         <li><code>Student</code>, <code>Created By</code>.</li>
                                    </ul>
                                </details>
                            </div>
                        </div>
                         <button id="hide-columns-btn" class="mt-4 text-sm text-blue-600 hover:underline">Hide List</button>
                    </div>

                    <h4 class="text-md font-semibold text-gray-700 mt-4">Example: Master List</h4>
                    <div class="table-container my-4">
                        <table class="table-example">
                            <thead>
                                <tr>
                                    <th>StudentName</th>
                                    <th>StudentNumber</th>
                                    <th>Grade</th>
                                    <th>Phone</th>
                                    <th>Outreach</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Smith, John</td>
                                    <td>123456</td>
                                    <td>85%</td>
                                    <td>555-123-4567</td>
                                    <td>Left Voicemail</td>
                                </tr>
                                <tr>
                                    <td>Doe, Jane</td>
                                    <td>789012</td>
                                    <td>62%</td>
                                    <td>555-987-6543</td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h4 class="text-md font-semibold text-gray-700 mt-6">Example: Student History</h4>
                     <div class="table-container my-4">
                        <table class="table-example">
                            <thead>
                                <tr>
                                    <th>StudentNumber</th>
                                    <th>Student</th>
                                    <th>Comment</th>
                                    <th>Tag</th>
                                    <th>Timestamp</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>123456</td>
                                    <td>Smith, John</td>
                                    <td>Spoke with student, will submit work tomorrow.</td>
                                    <td>Outreach, LDA 8/8/25</td>
                                    <td>8/7/2025 9:15 AM</td>
                                </tr>
                                <tr>
                                    <td>789012</td>
                                    <td>Doe, Jane</td>
                                    <td>Sent email regarding missing assignments.</td>
                                    <td>Outreach</td>
                                    <td>8/6/2025 2:30 PM</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                 <!-- Chapter 3 -->
                <div id="panel-chapter-3" class="chapter-content">
                    <h3>Chapter 3: Show Details & Student History</h3>
                    <p>This is your command center for student information. When you select a student in the <strong>Master List</strong>, this task pane instantly displays their key data points.</p>
                    <p>The <strong>Student History</strong> tab is now enhanced with a priority system. Any comment that includes a future follow-up date (an LDA) is automatically pushed to the top of the list and highlighted in orange. This ensures that critical tasks are always visible and addressed first. The specific date within the comment text is also bolded for immediate recognition.</p>

                    <div class="my-4 p-4 bg-gray-50 border border-gray-200 rounded-lg shadow-sm">
                        <div class="flex items-center p-3">
                            <div class="flex-shrink-0 bg-blue-600 text-white w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold">
                                SJ
                            </div>
                            <div class="ml-4">
                                <p class="text-lg font-bold text-gray-900">Smith, John</p>
                                <p class="text-sm text-gray-500">ID: 123456</p>
                            </div>
                            <div class="ml-auto px-3 py-1 text-sm font-semibold text-gray-800 bg-gray-200 rounded-full">
                                Victor Blanco
                            </div>
                        </div>
                        <div class="p-3">
                            <div class="flex space-x-3 my-2">
                                <div class="flex-1 p-3 text-center rounded-lg bg-red-200 text-red-800">
                                    <p class="text-2xl font-bold">15</p>
                                    <p class="text-xs font-medium uppercase tracking-wider">Days Out</p>
                                </div>
                                <div class="flex-1 p-3 text-center rounded-lg bg-green-200 text-green-800">
                                    <p class="text-2xl font-bold">85%</p>
                                    <p class="text-xs font-medium uppercase tracking-wider">Grade</p>
                                </div>
                            </div>
                        </div>
                        <div class="border-b border-gray-200">
                             <nav class="-mb-px flex space-x-4 px-3" aria-label="Tabs">
                                <button class="whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500">Details</button>
                                <button class="whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm border-blue-500 text-blue-600">History</button>
                             </nav>
                        </div>
                        <div class="p-3 mt-2 space-y-4">
                            <!-- Priority Comment -->
                            <div class="p-3 bg-orange-100 rounded-lg shadow-sm">
                                <p class="text-sm text-gray-800">Spoke with student, they will submit the assignment by <strong>Friday</strong>.</p>
                                <div class="text-xs text-gray-500 mt-2 pt-2 border-t border-orange-200 flex justify-between items-center">
                                    <div class="flex items-center gap-2">
                                        <span class="px-2 py-0.5 font-semibold rounded-full bg-orange-200 text-orange-800">LDA 8/8/25</span>
                                        <span class="font-medium">Victor Blanco</span>
                                    </div>
                                    <span>8/7/2025 9:15 AM</span>
                                </div>
                            </div>
                             <!-- Standard Comment -->
                            <div class="p-3 bg-gray-100 rounded-lg shadow-sm">
                                <p class="text-sm text-gray-800">Initial outreach call, left voicemail.</p>
                                <div class="text-xs text-gray-500 mt-2 pt-2 border-t border-gray-200 flex justify-between items-center">
                                    <div class="flex items-center gap-2">
                                        <span class="px-2 py-0.5 font-semibold rounded-full bg-blue-100 text-blue-800">Outreach</span>
                                        <span class="font-medium">Victor Blanco</span>
                                    </div>
                                    <span>8/5/2025 11:42 AM</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h4 class="text-md font-semibold text-gray-700 mt-6">Conditional Formatting</h4>
                    <p>The 'Days Out' and 'Grade' stat blocks are color-coded to give you an at-a-glance understanding of the student's status. The grade block follows this logic:</p>
                    <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 my-4">
                        <div class="flex-1 p-3 text-center rounded-lg bg-green-200 text-green-800">
                            <p class="text-xl font-bold">70%+</p>
                            <p class="text-xs font-medium uppercase tracking-wider">Passing</p>
                        </div>
                        <div class="flex-1 p-3 text-center rounded-lg bg-yellow-200 text-yellow-800">
                            <p class="text-xl font-bold">60-69%</p>
                            <p class="text-xs font-medium uppercase tracking-wider">At-Risk</p>
                        </div>
                        <div class="flex-1 p-3 text-center rounded-lg bg-red-200 text-red-800">
                            <p class="text-xl font-bold">&lt;60%</p>
                            <p class="text-xs font-medium uppercase tracking-wider">Failing</p>
                        </div>
                    </div>
                </div>
                 <!-- Chapter 4 -->
                <div id="panel-chapter-4" class="chapter-content">
                    <h3>Chapter 4: Smart Commenting & Tagging</h3>
                    <p>The add-in provides both manual and automatic tagging to save you time and improve consistency. The system intelligently analyzes what you type and can automatically tag comments for you.</p>
                    
                    <details class="collapsible-section mt-4">
                        <summary class="flex items-center font-semibold text-blue-700 cursor-pointer"><svg class="chevron w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>Available Tags</summary>
                        <div class="pl-6 mt-2 space-y-3 border-l-2 ml-2">
                            <p><strong><span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">Urgent</span></strong> - Manually added for high-priority items that need immediate attention.</p>
                            <p><strong><span class="px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800">LDA</span></strong> - Can be added manually with a date picker or automatically. This tag is crucial for the priority sorting system in the Student History view.</p>
                            <p><strong><span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">Outreach</span></strong> - Automatically added when you log a comment by typing in the <code>Outreach</code> column of your Master List.</p>
                            <p><strong><span class="px-2 py-1 text-xs font-semibold rounded-full bg-sky-100 text-sky-800">Quote</span></strong> - Automatically added if you paste text into the comment box, useful for logging communications from emails or messages.</p>
                        </div>
                    </details>

                    <p class="mt-4"><strong>Example Scenario:</strong></p>
                    <p>Imagine you type the following comment into the task pane:</p>
                    <div class="my-4 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                        <div class="bg-white p-2 border rounded-md">
                            <p class="text-sm text-gray-800">Spoke with the student, they <strong class="text-highlight">will submit</strong> the assignment by <strong class="text-highlight">Friday</strong>.</p>
                        </div>
                        <div class="mt-2 flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <span class="px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800">LDA 8/8/25</span>
                            </div>
                            <button disabled class="px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm cursor-not-allowed">Submit</button>
                        </div>
                    </div>
                    <p>The add-in recognizes the trigger phrase and the date, automatically adding the correct <span class="px-2 py-0.5 text-xs font-semibold rounded-full bg-orange-100 text-orange-800">LDA</span> tag. When you submit, the comment will be prioritized in the history view.</p>
                </div>
                 <!-- Chapter 5 -->
                <div id="panel-chapter-5" class="chapter-content">
                    <h3>Chapter 5: Import Data</h3>
                    <p>This feature is designed for efficient bulk updates. You can import data from external <code>.csv</code> or <code>.xlsx</code> files to update your master list or student grades without manual entry. After clicking the "Import Data" button on the ribbon, you'll see this dialog:</p>
                    
                    <div class="my-4 p-6 bg-gray-50 border border-gray-200 rounded-lg">
                        <h4 class="text-lg font-semibold text-gray-800 mb-1">Import Data</h4>
                        <p class="text-sm text-gray-500 mb-4">Select a .csv or .xlsx file to import.</p>
                        <div class="mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
                            <div class="space-y-1 text-center">
                                <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                                <div class="flex text-sm text-gray-600">
                                    <label class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none"><span>Upload a file</span></label>
                                    <p class="pl-1">or drag and drop</p>
                                </div>
                                <p class="text-xs text-gray-500">CSV, XLSX up to 10MB</p>
                            </div>
                        </div>
                        <div class="mt-4 text-center">
                             <button disabled class="px-4 py-2 text-sm font-medium text-white bg-gray-400 border border-transparent rounded-md shadow-sm cursor-not-allowed">No file selected</button>
                        </div>
                    </div>

                    <p>The add-in is smart enough to analyze the headers of the file you select and will automatically enable the correct action button.</p>
                    
                    <details class="collapsible-section mt-4">
                        <summary class="flex items-center font-semibold text-blue-700 cursor-pointer"><svg class="chevron w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>How the Add-in Detects Import Type</summary>
                        <div class="pl-6 mt-2 space-y-2 border-l-2 ml-2">
                            <p><strong>If the file contains <code>StudentNumber</code> AND <code>Grade</code> headers:</strong> The "Update Grades" button will be enabled. This allows you to quickly update student grades from an external file.</p>
                            <p><strong>If the file contains <code>StudentNumber</code> AND other recognized headers (like <code>Phone</code>, <code>Email</code>, etc.) but NOT <code>Grade</code>:</strong> The "Update Master List" button will be enabled. This is for updating student demographic or contact information.</p>
                        </div>
                    </details>
                </div>
                 <!-- Chapter 6 -->
                <div id="panel-chapter-6" class="chapter-content">
                    <h3>Chapter 6: Create LDA Report</h3>
                    <p>LDA stands for "Last Date of Attendance." This powerful feature generates a new, focused worksheet with two critical tables for your retention efforts:</p>
                    <ul>
                        <li><strong>At-Risk Students:</strong> A list of students who have not attended recently, based on the "Days Out" filter you configure in the Settings. This is your primary list for immediate outreach.</li>
                        <li><strong>Failing Students:</strong> A supplementary list of students who may be attending but are currently failing. This allows you to proactively intervene before they become an attendance risk.</li>
                    </ul>
                    <p class="mt-4">The generated report will look similar to this, formatted as an Excel table:</p>
                    <div class="my-4 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                        <div class="mb-4">
                            <h4 class="text-lg font-bold text-gray-800">LDA Report for 8/7/2025</h4>
                        </div>
                        <div class="space-y-6">
                             <div>
                                <h5 class="text-md font-semibold text-gray-700 mb-2">At-Risk Students (6+ Days Out)</h5>
                                <div class="table-container">
                                    <table class="table-example">
                                        <thead>
                                            <tr><th>Assigned</th><th>StudentName</th><th>StudentNumber</th><th>Days Out</th><th>Grade</th><th>Phone</th></tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>Davis, Angela</td><td>Miller, Robert</td><td>112233</td><td>15</td><td class="bg-green-200 text-green-800">72%</td><td>555-111-2222</td></tr>
                                            <tr><td>Jones, Brian</td><td>Wilson, Patricia</td><td>445566</td><td>9</td><td class="bg-green-200 text-green-800">88%</td><td>555-333-4444</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div>
                                <h5 class="text-md font-semibold text-gray-700 mb-2">Failing Students (Active in Last 4 Days)</h5>
                                <div class="table-container">
                                    <table class="table-example">
                                         <thead>
                                            <tr><th>Assigned</th><th>StudentName</th><th>StudentNumber</th><th>Days Out</th><th>Grade</th><th>Phone</th></tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>Smith, Carol</td><td>Garcia, Maria</td><td>778899</td><td>2</td><td class="bg-red-200 text-red-800">58%</td><td>555-555-6666</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                 <!-- Chapter 7 -->
                <div id="panel-chapter-7" class="chapter-content">
                    <h3>Chapter 7: Mark as Contacted</h3>
                    <p>This is a simple but effective visual tool for tracking daily tasks. When you've finished reaching out to a student, select their row and click the <strong>Contacted</strong> button.</p>
                    <p>This toggles a yellow highlight across the student's main columns, giving you and your team a clear, at-a-glance indicator of who has been contacted for the day. Clicking the button again will remove the highlight.</p>
                    <div class="table-container my-4">
                        <table class="table-example">
                            <thead>
                                <tr>
                                    <th>StudentName</th>
                                    <th>StudentNumber</th>
                                    <th>Grade</th>
                                    <th>Phone</th>
                                    <th>Outreach</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="bg-yellow-200">
                                    <td>Smith, John</td>
                                    <td>123456</td>
                                    <td>85%</td>
                                    <td>555-123-4567</td>
                                    <td>Called - Will Engage Today</td>
                                </tr>
                                <tr>
                                    <td>Doe, Jane</td>
                                    <td>789012</td>
                                    <td>62%</td>
                                    <td>555-987-6543</td>
                                    <td>Left Voicemail</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                 <!-- Chapter 8 -->
                <div id="panel-chapter-8" class="chapter-content">
                    <h3>Chapter 8: Transfer Data</h3>
                    <p>This utility feature allows you to quickly export a single student's data for use in other applications. When you have a student selected, clicking <strong>Transfer Data</strong> copies their key information to your clipboard in a structured JSON format.</p>
                    <p>This is useful for pasting into other reporting tools, sending a summary to a colleague, or using the data in an email template. The copied data will look like this:</p>
                    <div class="code-block">
                        <pre><code>{
  "StudentName": "Smith, John",
  "StudentNumber": 123456,
  "Grade": "85%",
  "Days Out": 3,
  "GradeBookLink": "https://example.com/grades/123456"
}</code></pre>
                    </div>
                </div>
                 <!-- Chapter 9 -->
                <div id="panel-chapter-9" class="chapter-content">
                    <h3>Chapter 9: Settings Pane</h3>
                    <p>The Settings pane allows you to customize the add-in to fit your team's workflow. Here you can manage:</p>
                    <ul>
                        <li><strong>User Management:</strong> Add, edit, or remove users who can sign comments. The active user is selected in the "Show Details" task pane.</li>
                        <li><strong>LDA Report Settings:</strong> Fine-tune the criteria for your generated reports, including the "Days Out" threshold and whether to include the failing students list.</li>
                        <li><strong>Import Settings:</strong> Choose whether to treat blank cells as a zero when importing grade files.</li>
                        <li><strong>Column Management:</strong> Customize the LDA report by dragging and dropping to include, exclude, and reorder columns.</li>
                    </ul>
                </div>

                <button id="back-to-toc" class="mt-6 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    &larr; Back to Table of Contents
                </button>
            </div>
        </div>
        
        <div class="text-center mt-8 pt-4 border-t border-gray-200">
            <p class="text-xs text-gray-400">Created by Victor Blanco</p>
        </div>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const tocPanel = document.getElementById('panel-toc');
            const chaptersContainer = document.getElementById('chapters-container');
            const allChapterPanels = chaptersContainer.querySelectorAll('.chapter-content');
            const tocLinks = tocPanel.querySelectorAll('a');
            const backButton = document.getElementById('back-to-toc');
            const showColumnsBtn = document.getElementById('show-columns-btn');
            const hideColumnsBtn = document.getElementById('hide-columns-btn');
            const columnsList = document.getElementById('columns-list');

            const showToc = () => {
                chaptersContainer.classList.add('hidden');
                allChapterPanels.forEach(panel => panel.classList.add('hidden'));
                tocPanel.classList.remove('hidden');
            };

            const showChapter = (chapterNumber) => {
                tocPanel.classList.add('hidden');
                allChapterPanels.forEach(panel => panel.classList.add('hidden'));
                
                const chapterToShow = document.getElementById(`panel-chapter-${chapterNumber}`);
                if (chapterToShow) {
                    chapterToShow.classList.remove('hidden');
                    chaptersContainer.classList.remove('hidden');
                }
            };

            tocLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    const chapterNumber = link.getAttribute('data-chapter');
                    showChapter(chapterNumber);
                });
            });

            backButton.addEventListener('click', (event) => {
                event.preventDefault();
                showToc();
            });

            showColumnsBtn.addEventListener('click', () => {
                columnsList.classList.remove('hidden');
                showColumnsBtn.classList.add('hidden');
            });

            hideColumnsBtn.addEventListener('click', () => {
                columnsList.classList.add('hidden');
                showColumnsBtn.classList.remove('hidden');
            });
        });
    </script>
</body>
</html>
